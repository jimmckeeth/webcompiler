rtl.module("System",[],function(){"use strict";var e=this,t=e.$impl,s=null;this.LineEnding="\n",this.sLineBreak=this.LineEnding,this.PathDelim="/",this.AllowDirectorySeparators=rtl.createSet(47),this.AllowDriveSeparators=rtl.createSet(58),this.ExtensionSeparator=".",this.MaxLongint=2147483647,this.Maxint=2147483647,this.TTextLineBreakStyle={0:"tlbsLF",tlbsLF:0,1:"tlbsCRLF",tlbsCRLF:1,2:"tlbsCR",tlbsCR:2},rtl.recNewT(this,"TGuid",function(){this.D1=0,this.D2=0,this.D3=0,this.$new=function(){var e=Object.create(this);return e.D4=rtl.arraySetLength(null,0,8),e},this.$eq=function(e){return this.D1===e.D1&&this.D2===e.D2&&this.D3===e.D3&&rtl.arrayEq(this.D4,e.D4)},this.$assign=function(e){return this.D1=e.D1,this.D2=e.D2,this.D3=e.D3,this.D4=e.D4.slice(0),this}}),rtl.createClass(this,"TObject",null,function(){this.$init=function(){},this.$final=function(){},this.Create=function(){return this},this.Destroy=function(){},this.Free=function(){this.$destroy("Destroy")},this.ClassType=function(){return this},this.InheritsFrom=function(e){return null!=e&&(this==e||e.isPrototypeOf(this))},this.FieldAddress=function(e){if(""===e)return null;for(var t=this.$class,s=null,i=e.toLowerCase(),r=null;null!==t;){for(var n=0,l=(s=t.$rtti).fields.length-1;n<=l;n++)if((r=s.getField(n)).name.toLowerCase()===i)return r;t=t.$ancestor?t.$ancestor:null}return null},this.AfterConstruction=function(){},this.BeforeDestruction=function(){}}),this.vtInteger=0,this.vtExtended=3,this.vtWideChar=9,this.vtCurrency=12,this.vtUnicodeString=18,this.vtNativeInt=19,rtl.recNewT(this,"TVarRec",function(){s=this,this.VType=0,this.VJSValue=void 0,this.$eq=function(e){return this.VType===e.VType&&this.VJSValue===e.VJSValue&&this.VJSValue===e.VJSValue&&this.VJSValue===e.VJSValue&&this.VJSValue===e.VJSValue&&this.VJSValue===e.VJSValue&&this.VJSValue===e.VJSValue&&this.VJSValue===e.VJSValue},this.$assign=function(e){return this.VType=e.VType,this.VJSValue=e.VJSValue,this.VJSValue=e.VJSValue,this.VJSValue=e.VJSValue,this.VJSValue=e.VJSValue,this.VJSValue=e.VJSValue,this.VJSValue=e.VJSValue,this.VJSValue=e.VJSValue,this}}),this.VarRecs=function(){var e=[],t=0,i=null;for(e=[];t<arguments.length;)(i=s.$new()).VType=rtl.trunc(arguments[t]),t+=1,i.VJSValue=arguments[t],t+=1,e.push(s.$clone(i));return e},this.FirstDotAtFileNameStartIsExtension=!1,this.Frac=function(e){return e%1},this.Random=function(e){return Math.floor(Math.random()*e)},this.Trunc=function(t){return Math.trunc||(Math.trunc=function(e){return e=+e,isFinite(e)?e-e%1||(e<0?-0:0===e?e:0):e}),e.Trunc=Math.trunc,Math.trunc(t)},this.DefaultTextLineBreakStyle=0,this.Int=function(t){return e.Trunc(t)},this.Copy=function(e,t,s){return t<1&&(t=1),s>0?e.substring(t-1,t+s-1):""},this.Copy$1=function(e,t){return t<1&&(t=1),e.substr(t-1)},this.Delete=function(t,s,i){var r;s<1||s>t.get().length||i<=0||(r=t.get(),t.set(e.Copy(r,1,s-1)+e.Copy$1(r,s+i)))},this.Pos=function(e,t){return t.indexOf(e)+1},this.Insert=function(t,s,i){var r;""!==t&&(r=s.get(),i<1?s.set(t+r):i>r.length?s.set(r+t):s.set(e.Copy(r,1,i-1)+t+e.Copy(r,i,r.length)))},this.upcase=function(e){return e.toUpperCase()},this.val=function(e,s,i){s.set(t.valint(e,-9007199254740991,9007199254740991,i))},this.val$1=function(t,s,i){var r;""!==t?(r=Number(t),isNaN(r)||r!==e.Int(r)||r<0?i.set(1):(i.set(0),s.set(e.Trunc(r)))):i.set(1)},this.val$6=function(e,s,i){s.set(t.valint(e,-2147483648,2147483647,i))},this.val$8=function(e,t,s){var i;""!==e?(i=Number(e),isNaN(i)?s.set(1):(s.set(0),t.set(i))):s.set(1)},this.StringOfChar=function(e,t){var s="";if(t>0&&e.repeat)return e.repeat(t);s="";for(var i=1,r=t;i<=r;i++)s+=e;return s},this.Writeln=function(){var e,s=0,i="";if(e=arguments.length-1,null!=t.WriteCallBack)for(var r=0,n=e;r<=n;r++)s=r,t.WriteCallBack(arguments[s],s===e);else{i=t.WriteBuf;for(var l=0,a=e;l<=a;l++)i=i+""+arguments[s=l];console.log(i),t.WriteBuf=""}},this.SetWriteCallBack=function(e){var s;return s=t.WriteCallBack,t.WriteCallBack=e,s},this.Assigned=function(e){return null!=e&&null!=e&&(!rtl.isArray(e)||e.length>0)},e.$implcode=function(){t.WriteBuf="",t.WriteCallBack=null,t.valint=function(t,s,i,r){var n=0,l=0;if(""===t)return r.set(1),n;if(l=Number(t),isNaN(l)){var a=e.Copy(t,1,1);if("$"===a)l=Number("0x"+e.Copy$1(t,2));else if("&"===a)l=Number("0o"+e.Copy$1(t,2));else{if("%"!==a)return r.set(1),n;l=Number("0b"+e.Copy$1(t,2))}}return isNaN(l)||l!==e.Int(l)?r.set(1):l<s||l>i?r.set(2):(n=e.Trunc(l),r.set(0)),n}},e.$init=function(){rtl.exitcode=0}},[]),rtl.module("RTLConsts",["System"],function(){"use strict";this.$resourcestrings={SArgumentMissing:{org:'Missing argument in format "%s"'},SInvalidFormat:{org:'Invalid format specifier : "%s"'},SInvalidArgIndex:{org:'Invalid argument index in format: "%s"'},SListCapacityError:{org:"List capacity (%s) exceeded."},SListCountError:{org:"List count (%s) out of bounds."},SListIndexError:{org:"List index (%s) out of bounds"},SSortedListError:{org:"Operation not allowed on sorted list"},SDuplicateString:{org:"String list does not allow duplicates"},SErrFindNeedsSortedList:{org:"Cannot use find on unsorted list"},SInvalidName:{org:'Invalid component name: "%s"'},SDuplicateName:{org:'Duplicate component name: "%s"'},SErrInvalidInteger:{org:'Invalid integer value: "%s"'}}}),rtl.module("Math",["System"],function(){"use strict";var e=pas.System.Trunc;this.IsInfinite=function(e){return e==1/0||e==-1/0},this.Floor=function(t){return e(Math.floor(t))}}),rtl.module("Types",["System"],function(){"use strict";this.TDirection={0:"FromBeginning",FromBeginning:0,1:"FromEnd",FromEnd:1},this.TDuplicates={0:"dupIgnore",dupIgnore:0,1:"dupAccept",dupAccept:1,2:"dupError",dupError:2}},["Math"]),rtl.module("JS",["System","Types"],function(){"use strict";this.$rtti.$DynArray("TJSStringDynArray",{eltype:rtl.string}),this.JSDelete=function(e,t){return delete e[t]},this.isBoolean=function(e){return"boolean"==typeof e},this.isInteger=function(e){return Math.floor(e)===e}}),rtl.module("SysUtils",["System","RTLConsts","JS"],function(){"use strict";var e=this,t=e.$impl,s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=pas.System,d=f.TObject,F=f.Writeln,m=f.val,C=f.Copy,S=f.upcase,T=f.StringOfChar,y=f.Insert,g=pas.RTLConsts,E=f.VarRecs,P=f.val$6,I=f.Trunc,R=f.Random,v=f.Pos,A=f.Delete;this.FreeAndNil=function(e){var t=null;null!==(t=e.get())&&(e.set(null),t.$destroy("Destroy"))},this.FloatRecDigits=19,rtl.recNewT(this,"TFloatRec",function(){s=this,this.Exponent=0,this.Negative=!1,this.$new=function(){var e=Object.create(this);return e.Digits=rtl.arraySetLength(null,"\0",19),e},this.$eq=function(e){return this.Exponent===e.Exponent&&this.Negative===e.Negative&&rtl.arrayEq(this.Digits,e.Digits)},this.$assign=function(e){return this.Exponent=e.Exponent,this.Negative=e.Negative,this.Digits=e.Digits.slice(0),this}}),rtl.recNewT(this,"TFormatSettings",function(){i=this,this.CurrencyDecimals=0,this.CurrencyFormat=0,this.CurrencyString="",this.DateSeparator="\0",this.DecimalSeparator="",this.LongDateFormat="",this.LongTimeFormat="",this.NegCurrFormat=0,this.ShortDateFormat="",this.ShortTimeFormat="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.TimeSeparator="\0",this.TwoDigitYearCenturyWindow=0,this.InitLocaleHandler=null,this.$new=function(){var e=Object.create(this);return e.DateTimeToStrFormat=rtl.arraySetLength(null,"",2),e.LongDayNames=rtl.arraySetLength(null,"",7),e.LongMonthNames=rtl.arraySetLength(null,"",12),e.ShortDayNames=rtl.arraySetLength(null,"",7),e.ShortMonthNames=rtl.arraySetLength(null,"",12),e},this.$eq=function(e){return this.CurrencyDecimals===e.CurrencyDecimals&&this.CurrencyFormat===e.CurrencyFormat&&this.CurrencyString===e.CurrencyString&&this.DateSeparator===e.DateSeparator&&rtl.arrayEq(this.DateTimeToStrFormat,e.DateTimeToStrFormat)&&this.DecimalSeparator===e.DecimalSeparator&&this.LongDateFormat===e.LongDateFormat&&rtl.arrayEq(this.LongDayNames,e.LongDayNames)&&rtl.arrayEq(this.LongMonthNames,e.LongMonthNames)&&this.LongTimeFormat===e.LongTimeFormat&&this.NegCurrFormat===e.NegCurrFormat&&this.ShortDateFormat===e.ShortDateFormat&&rtl.arrayEq(this.ShortDayNames,e.ShortDayNames)&&rtl.arrayEq(this.ShortMonthNames,e.ShortMonthNames)&&this.ShortTimeFormat===e.ShortTimeFormat&&this.ThousandSeparator===e.ThousandSeparator&&this.TimeAMString===e.TimeAMString&&this.TimePMString===e.TimePMString&&this.TimeSeparator===e.TimeSeparator&&this.TwoDigitYearCenturyWindow===e.TwoDigitYearCenturyWindow},this.$assign=function(e){return this.CurrencyDecimals=e.CurrencyDecimals,this.CurrencyFormat=e.CurrencyFormat,this.CurrencyString=e.CurrencyString,this.DateSeparator=e.DateSeparator,this.DateTimeToStrFormat=e.DateTimeToStrFormat.slice(0),this.DecimalSeparator=e.DecimalSeparator,this.LongDateFormat=e.LongDateFormat,this.LongDayNames=e.LongDayNames.slice(0),this.LongMonthNames=e.LongMonthNames.slice(0),this.LongTimeFormat=e.LongTimeFormat,this.NegCurrFormat=e.NegCurrFormat,this.ShortDateFormat=e.ShortDateFormat,this.ShortDayNames=e.ShortDayNames.slice(0),this.ShortMonthNames=e.ShortMonthNames.slice(0),this.ShortTimeFormat=e.ShortTimeFormat,this.ThousandSeparator=e.ThousandSeparator,this.TimeAMString=e.TimeAMString,this.TimePMString=e.TimePMString,this.TimeSeparator=e.TimeSeparator,this.TwoDigitYearCenturyWindow=e.TwoDigitYearCenturyWindow,this},this.GetJSLocale=function(){return Intl.DateTimeFormat().resolvedOptions().locale},this.Create=function(){var e=i.$new();return e.$assign(i.Create$1(i.GetJSLocale())),e},this.Create$1=function(s){var r=i.$new();return r.LongDayNames=t.DefaultLongDayNames.slice(0),r.ShortDayNames=t.DefaultShortDayNames.slice(0),r.ShortMonthNames=t.DefaultShortMonthNames.slice(0),r.LongMonthNames=t.DefaultLongMonthNames.slice(0),r.DateTimeToStrFormat[0]="c",r.DateTimeToStrFormat[1]="f",r.DateSeparator="-",r.TimeSeparator=":",r.ShortDateFormat="yyyy-mm-dd",r.LongDateFormat="ddd, yyyy-mm-dd",r.ShortTimeFormat="hh:nn",r.LongTimeFormat="hh:nn:ss",r.DecimalSeparator=".",r.ThousandSeparator=",",r.TimeAMString="AM",r.TimePMString="PM",r.TwoDigitYearCenturyWindow=50,r.CurrencyFormat=0,r.NegCurrFormat=0,r.CurrencyDecimals=2,r.CurrencyString="$",null!=i.InitLocaleHandler&&i.InitLocaleHandler(e.UpperCase(s),i.$clone(r)),r}},!0),rtl.createClass(this,"Exception",d,function(){r=this,this.LogMessageOnCreate=!1,this.$init=function(){d.$init.call(this),this.fMessage="",this.FJSError=null},this.$final=function(){this.FJSError=void 0,d.$final.call(this)},this.Create$1=function(e){return this.fMessage=e,this.FJSError=new Error,this.LogMessageOnCreate&&F("Created exception ",this.$classname," with message: ",e),this},this.CreateFmt=function(t,s){return this.Create$1(e.Format(t,s)),this}}),rtl.createClass(this,"EExternal",r,function(){n=this}),rtl.createClass(this,"EMathError",n,function(){l=this}),rtl.createClass(this,"EZeroDivide",l,function(){0}),rtl.createClass(this,"EOverflow",l,function(){0}),rtl.createClass(this,"EInvalidCast",r,function(){a=this}),rtl.createClass(this,"EConvertError",r,function(){o=this}),rtl.createClass(this,"EIntError",n,function(){h=this}),rtl.createClass(this,"EDivByZero",h,function(){0}),rtl.createClass(this,"ERangeError",h,function(){u=this}),rtl.createClass(this,"EAbstractError",r,function(){c=this}),this.LeftStr=function(e,t){return t>0?e.substr(0,t):""},this.RightStr=function(e,t){var s=e.length;return t<1?"":t>=s?e:e.substr(s-t)},this.Trim=function(e){return e.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"").replace(/[\s\uFEFF\xA0\x00-\x1f]+$/,"")},this.TrimLeft=function(e){return e.replace(/^[\s\uFEFF\xA0\x00-\x1f]+/,"")},this.TrimRight=function(e){return e.replace(/[\s\uFEFF\xA0\x00-\x1f]+$/,"")},this.UpperCase=function(e){return e.toUpperCase()},this.LowerCase=function(e){return e.toLowerCase()},this.CompareStr=function(e,t){var s,i=e.length,r=t.length;return i<=r?e<(s=t.substr(0,i))?-1:e>s?1:i<r?-1:0:(s=e.substr(0,r))<t?-1:1},this.CompareText=function(e,t){var s=e.toLowerCase(),i=t.toLowerCase();return s>i?1:s<i?-1:0},this.SameText=function(e,t){return e.toLowerCase()==t.toLowerCase()},this.Format=function(t,s){return e.Format$1(t,s,e.FormatSettings)},this.Format$1=function(s,i,r){var n="",l=0,a=0,o=0,h=0,u=0,c="",p="",f=0,d=0,F=0,g=!1,E=0;function P(){var e=0;function r(){var r=0,n=0;if(-1===e){for(a=l;l<=u&&s.charAt(l-1)<="9"&&s.charAt(l-1)>="0";)l+=1;if(l>u&&t.DoFormatError(1,s),"*"===s.charAt(l-1)){255===f?n=o:(n=f,f+=1),(l>a||n>rtl.length(i)-1)&&t.DoFormatError(1,s),o=n+1;var h=i[n].VType;0===h||19===h?e=i[n].VJSValue:t.DoFormatError(1,s),l+=1}else a<l?(m(C(s,a,l-a),{get:function(){return e},set:function(t){e=t}},{get:function(){return r},set:function(e){r=e}}),r>0&&t.DoFormatError(1,s)):e=-1}}return f=255,d=-1,F=-1,e=-1,l+=1,"%"===s.charAt(l-1)?"%":(":"!==s.charAt(l-1)?r():e=0,":"===s.charAt(l-1)&&(-1===e&&t.DoFormatError(2,s),f=e,e=-1,l+=1),"-"===s.charAt(l-1)?(g=!0,l+=1):g=!1,r(),-1!==e&&(d=e,e=-1),"."===s.charAt(l-1)&&(l+=1,r(),-1===e&&(e=0),F=e),S(s.charAt(l-1)))}function I(e,r){var n=!1;return n=!1,o=(h=255===f?o:f)+1,h>rtl.length(i)-1||i[h].VType!==e?(r&&t.DoFormatError(3,s),o-=1,n):n=!0}for(n="",u=s.length,l=1,a=1,o=0;l<=u;){for(;l<=u&&"%"!==s.charAt(l-1);)l+=1;if(l>a&&(n+=C(s,a,l-a)),l<u){var R=P();if("D"===R)(I(0,!1)||I(19,!0))&&(p=e.IntToStr(i[h].VJSValue)),d=Math.abs(d),f=F-p.length,"-"!==p.charAt(0)?p=T("0",f)+p:y(T("0",f+1),{get:function(){return p},set:function(e){p=e}},2);else if("U"===R)I(0,!1)?p=e.IntToStr(i[h].VJSValue>>>0):I(19,!0)&&(p=e.IntToStr(i[h].VJSValue)),d=Math.abs(d),f=F-p.length,p=T("0",f)+p;else if("E"===R)I(12,!1)?p=e.FloatToStrF$1(i[h].VJSValue/1e4,2,3,F,r):I(3,!0)&&(p=e.FloatToStrF$1(i[h].VJSValue,2,3,F,r));else if("F"===R)I(12,!1)?p=e.FloatToStrF$1(i[h].VJSValue/1e4,0,9999,F,r):I(3,!0)&&(p=e.FloatToStrF$1(i[h].VJSValue,0,9999,F,r));else if("G"===R)I(12,!1)?p=e.FloatToStrF$1(i[h].VJSValue/1e4,1,F,3,r):I(3,!0)&&(p=e.FloatToStrF$1(i[h].VJSValue,1,F,3,r));else if("N"===R)I(12,!1)?p=e.FloatToStrF$1(i[h].VJSValue/1e4,3,9999,F,r):I(3,!0)&&(p=e.FloatToStrF$1(i[h].VJSValue,3,9999,F,r));else if("M"===R)I(12,!1)?p=e.FloatToStrF$1(i[h].VJSValue/1e4,4,9999,F,r):I(3,!0)&&(p=e.FloatToStrF$1(i[h].VJSValue,4,9999,F,r));else if("S"===R)(I(18,!1)||I(9,!0))&&(c=i[h].VJSValue),f=c.length,-1!==F&&f>F&&(f=F),p=C(c,1,f);else if("P"===R)I(0,!1)?p=e.IntToHex(i[h].VJSValue,8):I(0,!0)&&(p=e.IntToHex(i[h].VJSValue,16));else if("X"===R)if(I(0,!1)?(E=i[h].VJSValue,f=16):I(19,!0)&&(E=i[h].VJSValue,f=31),F>f)p=e.IntToHex(E,f);else{for(f=1;rtl.shl(1,4*f)<=E&&f<16;)f+=1;f>F&&(F=f),p=e.IntToHex(E,F)}else"%"===R&&(p="%");-1!==d&&p.length<d&&(g?p+=T(" ",d-p.length):p=T(" ",d-p.length)+p),n+=p}a=l+=1}return n};var N=rtl.createSet(null,65,90,null,97,122,95),x=rtl.unionSet(N,rtl.createSet(null,48,57));this.IsValidIdent=function(e,t,s){var i,r=!1,n=!1,l=0;if((i=e.length)<1)return!1;for(n=!0,r=!1,l=1;l<=i;){if(n){if(!(e.charCodeAt(l-1)in N))return r;n=!1}else if(t&&"."===e.charAt(l-1)){if(s){if(l>=i)return r;n=!0}}else if(!(e.charCodeAt(l-1)in x))return r;l+=1}return r=!0},this.TStringReplaceFlag={0:"rfReplaceAll",rfReplaceAll:0,1:"rfIgnoreCase",rfIgnoreCase:1},this.StringReplace=function(e,s,i,r){var n,l="";return l="",0 in r&&(l="g"),1 in r&&(l+="i"),n=s.replace(new RegExp(t.RESpecials,"g"),"\\$1"),e.replace(new RegExp(n,l),i)},this.QuoteString=function(t,s){return s+e.StringReplace(t,s,s+s,rtl.createSet(0))+s},this.QuotedStr=function(t,s){return e.QuoteString(t,s)},this.DeQuoteString=function(e,t){var s="",i=0;if((s=e).substring(0,1)!==t)return s;for(s=s.slice(1),i=1;i<=s.length;)if(s.charAt(i-1)===t){if(i===s.length||s.charAt(i+1-1)!==t)return s=s.slice(0,i-1);s=s.slice(0,i-1)+s.slice(i)}else i+=1;return s},this.IntToStr=function(e){return""+e},this.TryStrToInt=function(t,s){var i=!1,r=0;return(i=(i=e.TryStrToInt$2(t,{get:function(){return r},set:function(e){r=e}}))&&-2147483648<=r&&r<=2147483647)&&s.set(r),i},this.TryStrToInt$2=function(s,i){return t.IntTryStrToInt(s,i,e.FormatSettings.DecimalSeparator)},this.StrToIntDef=function(t,s){var i=0;return e.TryStrToInt$2(t,{get:function(){return i},set:function(e){i=e}})?i:s},this.StrToInt=function(t){var s=0;if(!e.TryStrToInt$2(t,{get:function(){return s},set:function(e){s=e}}))throw o.$create("CreateFmt",[rtl.getResStr(g,"SErrInvalidInteger"),E(18,t)]);return s},this.StrToInt64Def=function(t,s){var i=0;return e.TryStrToInt64(t,{get:function(){return i},set:function(e){i=e}})||(i=s),i},this.TryStrToInt64=function(t,s){var i,r=0;return(i=e.TryStrToInt$2(t,{get:function(){return r},set:function(e){r=e}}))&&s.set(r),i},this.IntToHex=function(t,s){var i="";for(i="",t<0&&t<0&&(t=4294967295+t+1),i=t.toString(16),i=e.UpperCase(i);i.length<s;)i="0"+i;return i},this.TFloatFormat={0:"ffFixed",ffFixed:0,1:"ffGeneral",ffGeneral:1,2:"ffExponent",ffExponent:2,3:"ffNumber",ffNumber:3,4:"ffCurrency",ffCurrency:4};this.FloatToDecimal=function(t,i,r){var n=s.$new(),l="",a="",o=0,h=0,u=0,c=0,p=0,f=!1,d=!1;for(n.Negative=!1,n.Exponent=0,p=0;p<=19;p++)n.Digits[p]="0";if(0===t)return n;for(u=1,c=(l=rtl.floatToStr(t,24)).length;" "===l.charAt(u-1);)u+=1;if(n.Negative="-"===l.charAt(u-1),(n.Negative||"+"===l.charAt(u-1))&&(u+=1),c>=u+2){if("Inf"===(a=C(l,u,3)))return n.Digits[0]="\0",n.Exponent=32767,n;if("Nan"===a)return n.Digits[0]="\0",n.Exponent=-32768,n}for(o=0,n.Exponent=0,d=!0,f=!1;c>=u&&"E"!==l.charAt(u-1);)"."===l.charAt(u-1)?d=!1:(d?(n.Exponent+=1,n.Digits[o]=l.charAt(u-1),"0"!==l.charAt(u-1)&&(f=!0)):n.Digits[o]=l.charAt(u-1),o+=1),u+=1;for((u+=1)<=c&&(P(C(l,u,c-u+1),{get:function(){return p},set:function(e){p=e}},{get:function(){return h},set:function(e){h=e}}),n.Exponent+=p),u=o,c=19;u<c;)n.Digits[u]="0",u+=1;if((u=r+n.Exponent<i?r+n.Exponent:i)>=c&&(u=c-1),0===u)n.Digits[0]>="5"?(n.Digits[0]="1",n.Digits[1]="\0",n.Exponent+=1):n.Digits[0]="\0";else if(u>0)if(n.Digits[u]>="5"){do{n.Digits[u]="\0",u-=1,n.Digits[u]="123456789:".charAt(e.StrToInt(n.Digits[u])+1-1)}while(!(0===u||n.Digits[u]<":"));":"===n.Digits[0]&&(n.Digits[0]="1",n.Exponent+=1)}else for(n.Digits[u]="0";u>-1&&"0"===n.Digits[u];)n.Digits[u]="\0",u-=1;else n.Digits[0]="\0";return"\0"!==n.Digits[0]||f||(n.Exponent=0,n.Negative=!1),n},this.FloatToStr=function(t){return e.FloatToStr$1(t,e.FormatSettings)},this.FloatToStr$1=function(t,s){return e.FloatToStrF$1(t,1,15,0,s)},this.FloatToStrF$1=function(e,s,i,r,n){var l,a,o="";a=n.DecimalSeparator,l=n.ThousandSeparator;var h=s;return 1===h?o=t.FormatGeneralFloat(e,i,a):2===h?o=t.FormatExponentFloat(e,i,r,a):0===h?o=t.FormatFixedFloat(e,r,a):3===h?o=t.FormatNumberFloat(e,r,a,l):4===h&&(o=t.FormatNumberCurrency(1e4*e,r,n)),4!==s&&o.length>1&&"-"===o.charAt(0)&&t.RemoveLeadingNegativeSign({get:function(){return o},set:function(e){o=e}},a,l),o},this.FormatFloat=function(t,s){return e.FormatFloat$1(t,s,i.$clone(e.FormatSettings))};this.FormatFloat$1=function(t,i,n){var l="",a=0,o=s.$new(),h="",u=0,c=!1,p=!1,f=0,d=0,F=0,m=0,S=0,y=0,g=0,E=0,P=0;function I(e){l+=e}function R(e){l+=e}function v(e){"\0"!==e&&(-1===(P-=1)?(R(n.DecimalSeparator),I(e)):(I(e),c&&P%3==0&&P>1&&R(n.ThousandSeparator)))}function A(){var e="\0";return e="\0",g<=y?(e=o.Digits[g],g+=1):P<=F?P-=1:e="0",e}function N(){if(0===E)v(A());else if(E<0)E+=1,P<=d?v("0"):P-=1;else{for(;E>0;)v(A()),E-=1;v(A())}}function x(t,s){var i="";return i=e.IntToStr(s),i=T("0",S-i.length)+i,s<0?i="-"+i:s>0&&"+"===t&&(i=t+i),i}var b=0,O=0,k="\0",$="\0",D=[],L=!1;for(D=rtl.arraySetLength(D,0,4),l="",h="",u=0,c=!1,p=!1,f=0,d=2147483647,F=0,m=0,S=0,y=-1,O=(a=i)>0?1:a<0?2:3,D[0]=0,b=function(e){var s,i=0,n=0,l="\0",a="\0",o=!1;for(i=1,e.get()[1]=-1,e.get()[2]=-1,e.get()[3]=-1,o=!1,a="\0",n=1,s=t.length;n<=s;){var h=l=t.charAt(n-1);if(";"===h){if(!o){if(i>3)throw r.$create("Create$1",["Invalid float format"]);e.get()[i]=n,i+=1}}else'"'!==h&&"'"!==h||(o?o=l!==a:(o=!0,a=l));n+=1}return-1===e.get()[i]&&(e.get()[i]=s+1),i}({get:function(){return D},set:function(e){D=e}}),(b<O||D[O]-D[O-1]===0)&&(O=1),u=D[O]-D[O-1]-1,h=C(t,D[O-1]+1,u),h=rtl.strSetLength(h,u),function(){var e,t=0,s="\0",i="\0",r=!1;for(e=h.length,t=1,r=!1,s="\0";t<=e;){if((i=h.charAt(t-1)).charCodeAt()in rtl.createSet(34,39))r?r=i!==s:(r=!0,s=i);else if(!r){var l=i;if("."===l)0===f&&(f=m+1);else if(","===l)c="\0"!==n.ThousandSeparator;else if("e"===l||"E"===l){if((t+=1)<e){if(i=h.charAt(t-1),p=i.charCodeAt()in rtl.createSet(45,43))for(;t<e&&"0"===h.charAt(t+1-1);)S+=1,t+=1;S>4&&(S=4)}}else"#"===l?m+=1:"0"===l&&(m<d&&(d=m+1),F=(m+=1)+1)}t+=1}0===f&&(f=m+1),(F=f-F)>0&&(F=0),(d=f-d)<0&&(d=0)}(),function(){var t=0,s=0;for(p?(s=m,t=9999):(s=18,t=m-f+1),o.$assign(e.FloatToDecimal(i,s,t)),P=f-1,p?E=0:(E=o.Exponent-(f-1))>=0&&(P=o.Exponent),y=-1;y<18&&"\0"!==o.Digits[y+1];)y+=1}(),(0===u||o.Exponent>=18&&!p||2047===o.Exponent||2048===o.Exponent)&&(h=a.toPrecision(15),l=h),b=1,g=0,$=" ",L=!1,o.Negative&&1===O&&I("-");b<=u;){if((k=h.charAt(b-1)).charCodeAt()in rtl.createSet(34,39))L?L=k!==$:(L=!0,$=k);else if(L)I(k);else{var B=k;if("0"===B||"#"===B)N();else if("."===B||","===B);else if("e"===B||"E"===B){if(I(k),(b+=1)<=h.length&&(k=h.charAt(b-1)).charCodeAt()in rtl.createSet(43,45))for(R(x(k,o.Exponent-f+1));b<u&&"0"===h.charAt(b+1-1);)b+=1}else I(k)}b+=1}return l},this.TrueBoolStrs=[],this.FalseBoolStrs=[],this.BoolToStr=function(s,i){var r="";return i?(t.CheckBoolStrs(),r=s?e.TrueBoolStrs[0]:e.FalseBoolStrs[0]):r=s?"-1":"0",r},this.BoolToStr$1=function(e,t,s){return e?t:s},this.OnGetEnvironmentVariable=null,this.GetEnvironmentVariable=function(t){return null!=e.OnGetEnvironmentVariable?e.OnGetEnvironmentVariable(t):""},rtl.recNewT(this,"TTimeStamp",function(){p=this,this.Time=0,this.Date=0,this.$eq=function(e){return this.Time===e.Time&&this.Date===e.Date},this.$assign=function(e){return this.Time=e.Time,this.Date=e.Date,this}}),this.TimeSeparator="\0",this.DateSeparator="\0",this.ShortDateFormat="",this.LongDateFormat="",this.ShortTimeFormat="",this.LongTimeFormat="",this.DecimalSeparator="",this.ThousandSeparator="",this.TimeAMString="",this.TimePMString="",this.HoursPerDay=24,this.MinsPerHour=60,this.SecsPerMin=60,this.MSecsPerSec=1e3,this.MinsPerDay=1440,this.SecsPerDay=86400,this.MSecsPerDay=864e5,this.MaxDateTime=2958465.99999999,this.DateDelta=693594,this.MonthDays$a$clone=function(e){var t=[];t.length=2;for(var s=0;s<2;s++)t[s]=e[s].slice(0);return t},this.MonthDays=[[31,28,31,30,31,30,31,31,30,31,30,31],[31,29,31,30,31,30,31,31,30,31,30,31]],this.ShortMonthNames=rtl.arraySetLength(null,"",12),this.LongMonthNames=rtl.arraySetLength(null,"",12),this.ShortDayNames=rtl.arraySetLength(null,"",7),this.LongDayNames=rtl.arraySetLength(null,"",7),this.FormatSettings=i.$new(),this.JSDateToDateTime=function(t,s){return s?e.EncodeDate(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate())+e.EncodeTime(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()):e.EncodeDate(t.getFullYear(),t.getMonth()+1,t.getDate())+e.EncodeTime(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())},this.DateTimeToTimeStamp=function(e){var t=p.$new(),s=0;return(s=864e5*e)<0?s-=.5:s+=.5,t.Time=I(Math.abs(I(s))%864e5),t.Date=693594+rtl.trunc(I(s)/864e5),t},this.TryEncodeDate=function(t,s,i,r){var n,l=0,a=0;return(n=t>0&&t<1e4&&s>=1&&s<=12&&i>0&&i<=e.MonthDays[+e.IsLeapYear(t)][s-1])&&(s>2?s-=3:(s+=9,t-=1),a=t-100*(l=rtl.trunc(t/100)),r.set((146097*l>>>2)+(1461*a>>>2)+rtl.trunc((153*s+2)/5)+i),r.set(r.get()-693900)),n},this.TryEncodeTime=function(e,t,s,i,r){var n;return(n=e<24&&t<60&&s<60&&i<1e3)&&r.set((36e5*e+6e4*t+1e3*s+i)/864e5),n},this.EncodeDate=function(t,s,i){var r=0;if(!e.TryEncodeDate(t,s,i,{get:function(){return r},set:function(e){r=e}}))throw o.$create("CreateFmt",["%s-%s-%s is not a valid date specification",E(18,e.IntToStr(t),18,e.IntToStr(s),18,e.IntToStr(i))]);return r},this.EncodeTime=function(t,s,i,r){var n=0;if(!e.TryEncodeTime(t,s,i,r,{get:function(){return n},set:function(e){n=e}}))throw o.$create("CreateFmt",["%s:%s:%s.%s is not a valid time specification",E(18,e.IntToStr(t),18,e.IntToStr(s),18,e.IntToStr(i),18,e.IntToStr(r))]);return n},this.DecodeDate=function(t,s,i,r){var n=0,l=0,a=0,o=0;t<=-693594?(s.set(0),i.set(0),r.set(0)):(t>0?t+=1/1728e5:t-=1/1728e5,t>e.MaxDateTime&&(t=e.MaxDateTime),o=rtl.shl(I(t)+693900,2)-1,o-=146097*(n=rtl.trunc(o/146097)),l=rtl.lw(o>>>2),o=rtl.trunc((rtl.lw(l<<2)+3)/1461),l=rtl.lw(rtl.lw(l<<2)+7-1461*o>>>2),a=rtl.trunc((5*l-3)/153),l=rtl.trunc((5*l+2-153*a)/5),n=100*n+o,a<10?a+=3:(a-=9,n+=1),s.set(n),i.set(a),r.set(l))},this.DecodeTime=function(t,s,i,r,n){var l=0;l=e.DateTimeToTimeStamp(t).Time,s.set(rtl.trunc(l/36e5)),l%=36e5,i.set(rtl.trunc(l/6e4)),l%=6e4,r.set(rtl.trunc(l/1e3)),l%=1e3,n.set(l)},this.Now=function(){return e.JSDateToDateTime(new Date,!1)},this.IsLeapYear=function(e){return e%4==0&&(e%100!=0||e%400==0)},this.CurrencyFormat=0,this.NegCurrFormat=0,this.CurrencyDecimals=0,this.CurrencyString="",this.ChangeFileExt=function(e,t){var s,i=0;for(i=e.length,s=rtl.unionSet(rtl.unionSet(f.AllowDirectorySeparators,f.AllowDriveSeparators),rtl.createSet(f.ExtensionSeparator.charCodeAt()));i>0&&!(e.charCodeAt(i-1)in s);)i-=1;return(0===i||e.charAt(i-1)!==f.ExtensionSeparator||(1===i||e.charCodeAt(i-1-1)in f.AllowDirectorySeparators)&&!f.FirstDotAtFileNameStartIsExtension)&&(i=e.length+1),C(e,1,i-1)+t},this.ExtractFilePath=function(e){var s,i=0;for(i=e.length,s=rtl.unionSet(f.AllowDirectorySeparators,f.AllowDriveSeparators);i>0&&!t.CharInSet$1(e.charAt(i-1),s);)i-=1;return i>0?C(e,1,i):""},this.ExtractFileName=function(e){var s,i=0;for(i=e.length,s=rtl.unionSet(f.AllowDirectorySeparators,f.AllowDriveSeparators);i>0&&!t.CharInSet$1(e.charAt(i-1),s);)i-=1;return C(e,i+1,2147483647)},this.ExtractFileExt=function(e){var s,i="",r=0;for(i="",r=e.length,s=rtl.unionSet(rtl.unionSet(f.AllowDirectorySeparators,f.AllowDriveSeparators),rtl.createSet(f.ExtensionSeparator.charCodeAt()));r>0&&!t.CharInSet$1(e.charAt(r-1),s);)r-=1;return r>0&&e.charAt(r-1)===f.ExtensionSeparator?(1===r||e.charCodeAt(r-1-1)in f.AllowDirectorySeparators)&&!f.FirstDotAtFileNameStartIsExtension||(i=C(e,r,2147483647)):i="",i},this.IncludeTrailingPathDelimiter=function(e){var s,i="";return 0!==(s=(i=e).length)&&t.CharInSet$1(i.charAt(s-1),f.AllowDirectorySeparators)||(i+=f.PathDelim),i},this.TryStringToGUID=function(e,t){var s=!1;return 38===e.length&&((s=new RegExp("^\\{[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}\\}$").test(e))?(rtl.strToGUIDR(e,t),s=!0):(t.D1=0,s))},this.CreateGUID=function(e){function t(e){var t=0;for(t=R(256);e>1;)t=256*t+R(256),e-=1;return t}var s=0;for(e.D1=t(4),e.D2=t(2),e.D3=t(2),s=0;s<=7;s++)e.D4[s]=t(1);return 0},e.$implcode=function(){t.DefaultShortMonthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.DefaultLongMonthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],t.DefaultShortDayNames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.DefaultLongDayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.CharInSet$1=function(e,t){return e.charCodeAt()in t},t.CheckBoolStrs=function(){0===rtl.length(e.TrueBoolStrs)&&(e.TrueBoolStrs=rtl.arraySetLength(e.TrueBoolStrs,"",1),e.TrueBoolStrs[0]="True"),0===rtl.length(e.FalseBoolStrs)&&(e.FalseBoolStrs=rtl.arraySetLength(e.FalseBoolStrs,"",1),e.FalseBoolStrs[0]="False")},t.feInvalidFormat=1,t.feMissingArgument=2,t.feInvalidArgIndex=3,t.DoFormatError=function(e,t){var s=e;if(1===s)throw o.$create("CreateFmt",[rtl.getResStr(g,"SInvalidFormat"),E(18,t)]);if(2===s)throw o.$create("CreateFmt",[rtl.getResStr(g,"SArgumentMissing"),E(18,t)]);if(3===s)throw o.$create("CreateFmt",[rtl.getResStr(g,"SInvalidArgIndex"),E(18,t)])},t.maxdigits=15,t.ReplaceDecimalSep=function(e,t){var s;return(s=v(".",e))>0?C(e,1,s-1)+t+C(e,s+1,e.length-s):e},t.FormatGeneralFloat=function(s,i,r){var n="",l=0,a=0,o=0,h=0;if((-1===i||i>15)&&(i=15),n=rtl.floatToStr(s,i+7),n=e.TrimLeft(n),0===(l=v(".",n)))return n;if(0===(a=v("E",n)))return n=t.ReplaceDecimalSep(n,r);for(o=a+2,h=0;o<=n.length;)h=10*h+n.charCodeAt(o-1)-48,o+=1;if("-"===n.charAt(a+1-1)&&(h=-h),l+h<a&&h>-6){if(n=rtl.strSetLength(n,a-1),h>=0){for(var u=0,c=h-1;u<=c;u++)o=u,n=rtl.setCharAt(n,l-1,n.charAt(l+1-1)),l+=1;for(n=rtl.setCharAt(n,l-1,"."),l=1,"-"===n.charAt(l-1)&&(l+=1);"0"===n.charAt(l-1)&&l<n.length&&C(n,l+1,r.length)!==r;)A({get:function(){return n},set:function(e){n=e}},l,1)}else y(C("00000",1,-h),{get:function(){return n},set:function(e){n=e}},l-1),n=rtl.setCharAt(n,l-h-1,n.charAt(l-h-1-1)),n=rtl.setCharAt(n,l-1,"."),-1!==h&&(n=rtl.setCharAt(n,l-h-1-1,"0"));for(o=n.length;o>0&&"0"===n.charAt(o-1);)o-=1;"."===n.charAt(o-1)&&(o-=1),n=0===o||1===o&&"-"===n.charAt(0)?"0":rtl.strSetLength(n,o)}else{for(;"0"===n.charAt(a-1-1);)A({get:function(){return n},set:function(e){n=e}},a-1,1),a-=1;for(n.charAt(a-1-1)===r&&(A({get:function(){return n},set:function(e){n=e}},a-1,1),a-=1),"+"===n.charAt(a+1-1)?A({get:function(){return n},set:function(e){n=e}},a+1,1):a+=1;"0"===n.charAt(a+1-1);)A({get:function(){return n},set:function(e){n=e}},a+1,1)}return n=t.ReplaceDecimalSep(n,r)},t.FormatExponentFloat=function(s,i,r,n){var l="",a=0;for(n=e.FormatSettings.DecimalSeparator,(-1===i||i>15)&&(i=15),l=rtl.floatToStr(s,i+7);" "===l.charAt(0);)A({get:function(){return l},set:function(e){l=e}},1,1);if(0===(a=v("E",l)))return l=t.ReplaceDecimalSep(l,n);if(a+=2,r>4&&(r=4),(r=l.length-a-r+1)<0)y(C("0000",1,-r),{get:function(){return l},set:function(e){l=e}},a);else for(;r>0&&"0"===l.charAt(a-1);){if(A({get:function(){return l},set:function(e){l=e}},a,1),a>l.length){A({get:function(){return l},set:function(e){l=e}},a-2,2);break}r-=1}return l=t.ReplaceDecimalSep(l,n)},t.FormatFixedFloat=function(e,s,i){var r="";return-1===s?s=2:s>18&&(s=18),""!==(r=rtl.floatToStr(e,0,s))&&" "===r.charAt(0)&&A({get:function(){return r},set:function(e){r=e}},1,1),r=t.ReplaceDecimalSep(r,i)},t.FormatNumberFloat=function(e,s,i,r){var n="",l=0;if(-1===s?s=2:s>15&&(s=15),""!==(n=rtl.floatToStr(e,0,s))&&" "===n.charAt(0)&&A({get:function(){return n},set:function(e){n=e}},1,1),(l=v(".",n))<=0&&(l=n.length+1),n=t.ReplaceDecimalSep(n,i),l-=3,""!==r&&"\0"!==r)for(;l>1;)"-"!==n.charAt(l-1-1)&&y(r,{get:function(){return n},set:function(e){n=e}},l),l-=3;return n},t.RemoveLeadingNegativeSign=function(e,t,s){var i,r=!1,n=0;r=!1,i=s;for(var l=2,a=e.get().length;l<=a&&(n=l,r=e.get().charCodeAt(n-1)in rtl.createSet(48,t.charCodeAt(),69,43)||e.get().charAt(n-1)===i);l++);return r&&"-"===e.get().charAt(0)&&A(e,1,1),r},t.FormatNumberCurrency=function(e,s,i){var r,n,l,a,o="",h=0;if(l=i.DecimalSeparator,a=i.ThousandSeparator,n=i.CurrencyString,-1===s?s=i.CurrencyDecimals:s>18&&(s=18),(r="-"===(o=rtl.floatToStr(e/1e4,0,s)).charAt(0))&&A({get:function(){return o},set:function(e){o=e}},1,1),h=v(".",o),""!==a)for(0!==h?o=t.ReplaceDecimalSep(o,l):h=o.length+1,h-=3;h>1;)y(a,{get:function(){return o},set:function(e){o=e}},h),h-=3;if(r&&t.RemoveLeadingNegativeSign({get:function(){return o},set:function(e){o=e}},l,a),r){var u=i.NegCurrFormat;0===u?o="("+n+o+")":1===u?o="-"+n+o:2===u?o=n+"-"+o:3===u?o=n+o+"-":4===u?o="("+o+n+")":5===u?o="-"+o+n:6===u?o=o+"-"+n:7===u?o=o+n+"-":8===u?o="-"+o+" "+n:9===u?o="-"+n+" "+o:10===u?o=o+" "+n+"-":11===u?o=n+" "+o+"-":12===u?o=n+" -"+o:13===u?o=o+"- "+n:14===u?o="("+n+" "+o+")":15===u&&(o="("+o+" "+n+")")}else{var c=i.CurrencyFormat;0===c?o=n+o:1===c?o+=n:2===c?o=n+" "+o:3===c&&(o=o+" "+n)}return o},t.RESpecials="([\\$\\+\\[\\]\\(\\)\\\\\\.\\*\\^\\?\\|])",t.IntTryStrToInt=function(t,s,i){var r,n,l=10,a="";if(0!==v(i,a=t)||0!==v(".",a))return!1;var o=C(a,1,1);return"$"===o?l=16:"&"===o?l=8:"%"===o&&(l=2),(16===l||0===v("e",e.LowerCase(a)))&&(10!==l&&A({get:function(){return a},set:function(e){a=e}},1,1),n=parseInt(a,l),(r=!isNaN(n))&&s.set(rtl.trunc(n)),r)},t.InitGlobalFormatSettings=function(){e.FormatSettings.$assign(i.Create()),e.TimeSeparator=e.FormatSettings.TimeSeparator,e.DateSeparator=e.FormatSettings.DateSeparator,e.ShortDateFormat=e.FormatSettings.ShortDateFormat,e.LongDateFormat=e.FormatSettings.LongDateFormat,e.ShortTimeFormat=e.FormatSettings.ShortTimeFormat,e.LongTimeFormat=e.FormatSettings.LongTimeFormat,e.DecimalSeparator=e.FormatSettings.DecimalSeparator,e.ThousandSeparator=e.FormatSettings.ThousandSeparator,e.TimeAMString=e.FormatSettings.TimeAMString,e.TimePMString=e.FormatSettings.TimePMString,e.CurrencyFormat=e.FormatSettings.CurrencyFormat,e.NegCurrFormat=e.FormatSettings.NegCurrFormat,e.CurrencyDecimals=e.FormatSettings.CurrencyDecimals,e.CurrencyString=e.FormatSettings.CurrencyString},t.DoClassRef=function(e){}},e.$init=function(){t.InitGlobalFormatSettings(),t.DoClassRef(a),t.DoClassRef(c),t.DoClassRef(u),e.ShortMonthNames=t.DefaultShortMonthNames.slice(0),e.LongMonthNames=t.DefaultLongMonthNames.slice(0),e.ShortDayNames=t.DefaultShortDayNames.slice(0),e.LongDayNames=t.DefaultLongDayNames.slice(0)}},[]),rtl.module("Classes",["System","RTLConsts","Types","SysUtils","JS"],function(){"use strict";var e=this,t=e.$impl,s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=pas.SysUtils,p=c.Exception,f=pas.System,d=f.TObject,F=pas.RTLConsts,m=f.VarRecs,C=f.Assigned,S=c.FreeAndNil,T=c.EConvertError,y=c.IntToStr,g=c.CompareText,E=c.StringReplace,P=f.Copy,I=f.Pos,R=f.Random,v=c.CompareStr,A=c.IsValidIdent;rtl.createClass(this,"EListError",p,function(){s=this}),rtl.createClass(this,"EStringListError",s,function(){i=this}),rtl.createClass(this,"EComponentError",p,function(){r=this}),this.TListAssignOp={0:"laCopy",laCopy:0,1:"laAnd",laAnd:1,2:"laOr",laOr:2,3:"laXor",laXor:3,4:"laSrcUnique",laSrcUnique:4,5:"laDestUnique",laDestUnique:5},rtl.createClass(this,"TFPList",d,function(){n=this,this.$init=function(){d.$init.call(this),this.FList=[],this.FCount=0,this.FCapacity=0},this.$final=function(){this.FList=void 0,d.$final.call(this)},this.CopyMove=function(e){var t=0;this.Clear();for(var s=0,i=e.FCount-1;s<=i;s++)t=s,this.Add(e.Get(t))},this.MergeMove=function(e){for(var t=0,s=0,i=e.FCount-1;s<=i;s++)t=s,this.IndexOf(e.Get(t))<0&&this.Add(e.Get(t))},this.DoCopy=function(e,t){null!=t?this.CopyMove(t):this.CopyMove(e)},this.DoSrcUnique=function(e,t){var s=0;if(null!=t){this.Clear();for(var i=0,r=e.FCount-1;i<=r;i++)s=i,t.IndexOf(e.Get(s))<0&&this.Add(e.Get(s))}else for(var n=this.FCount-1;n>=0;n--)s=n,e.IndexOf(this.Get(s))>=0&&this.Delete(s)},this.DoAnd=function(e,t){var s=0;if(null!=t){this.Clear();for(var i=0,r=e.FCount-1;i<=r;i++)s=i,t.IndexOf(e.Get(s))>=0&&this.Add(e.Get(s))}else for(var n=this.FCount-1;n>=0;n--)s=n,e.IndexOf(this.Get(s))<0&&this.Delete(s)},this.DoDestUnique=function(e,t){var s=this;function i(e,t){var i=0;s.Clear();for(var r=0,n=e.FCount-1;r<=n;r++)i=r,t.IndexOf(e.Get(i))<0&&s.Add(e.Get(i))}var r=null;null!=t?i(t,e):r=n.$create("Create");try{r.CopyMove(s),i(e,r)}finally{r.$destroy("Destroy")}},this.DoOr=function(e,t){null!=t?(this.CopyMove(e),this.MergeMove(t)):this.MergeMove(e)},this.DoXOr=function(e,t){var s=0,i=null;if(null!=t){this.Clear();for(var r=0,l=e.FCount-1;r<=l;r++)s=r,t.IndexOf(e.Get(s))<0&&this.Add(e.Get(s));for(var a=0,o=t.FCount-1;a<=o;a++)s=a,e.IndexOf(t.Get(s))<0&&this.Add(t.Get(s))}else{i=n.$create("Create");try{i.CopyMove(this);for(var h=this.FCount-1;h>=0;h--)s=h,e.IndexOf(this.Get(s))>=0&&this.Delete(s);for(var u=0,c=e.FCount-1;u<=c;u++)s=u,i.IndexOf(e.Get(s))<0&&this.Add(e.Get(s))}finally{i.$destroy("Destroy")}}},this.Get=function(e){return(e<0||e>=this.FCount)&&this.RaiseIndexError(e),this.FList[e]},this.Put=function(e,t){(e<0||e>=this.FCount)&&this.RaiseIndexError(e),this.FList[e]=t},this.SetCapacity=function(e){e<this.FCount&&this.$class.Error(rtl.getResStr(F,"SListCapacityError"),""+e),e!==this.FCapacity&&(this.FList=rtl.arraySetLength(this.FList,void 0,e),this.FCapacity=e)},this.SetCount=function(e){e<0&&this.$class.Error(rtl.getResStr(F,"SListCountError"),""+e),e>this.FCount&&e>this.FCapacity&&this.SetCapacity(e),this.FCount=e},this.RaiseIndexError=function(e){this.$class.Error(rtl.getResStr(F,"SListIndexError"),""+e)},this.Destroy=function(){this.Clear(),d.Destroy.call(this)},this.Add=function(e){var t;return this.FCount===this.FCapacity&&this.Expand(),this.FList[this.FCount]=e,t=this.FCount,this.FCount+=1,t},this.Clear=function(){rtl.length(this.FList)>0&&(this.SetCount(0),this.SetCapacity(0))},this.Delete=function(e){(e<0||e>=this.FCount)&&this.$class.Error(rtl.getResStr(F,"SListIndexError"),""+e),this.FCount=this.FCount-1,this.FList.splice(e,1),this.FCapacity-=1},this.Error=function(e,t){throw s.$create("CreateFmt",[e,m(18,t)])},this.Expand=function(){var e=0;return this.FCount<this.FCapacity||(e=4,this.FCapacity>3&&(e+=4),this.FCapacity>8&&(e+=8),this.FCapacity>127&&(e+=this.FCapacity>>>2),this.SetCapacity(this.FCapacity+e),this),this},this.IndexOf=function(e){var t,s=0;for(s=0,t=this.FCount;s<t&&this.FList[s]!=e;)s+=1;return s>=t&&(s=-1),s},this.IndexOfItem=function(e,t){var s=0;if(0===t)s=this.IndexOf(e);else for(s=this.FCount-1;s>=0&&this.FList[s]!=e;)s-=1;return s},this.Insert=function(e,t){(e<0||e>this.FCount)&&this.$class.Error(rtl.getResStr(F,"SListIndexError"),""+e),this.FList.splice(e,0,t),this.FCapacity+=1,this.FCount+=1},this.Last=function(){return 0===this.FCount?null:this.Get(this.FCount-1)},this.Move=function(e,t){var s;(e<0||e>this.FCount-1)&&this.$class.Error(rtl.getResStr(F,"SListIndexError"),""+e),(t<0||t>this.FCount-1)&&this.$class.Error(rtl.getResStr(F,"SListIndexError"),""+t),e!==t&&(s=this.FList[e],this.FList.splice(e,1),this.FList.splice(t,0,s))},this.Assign=function(e,t,s){var i=t;0===i?this.DoCopy(e,s):4===i?this.DoSrcUnique(e,s):1===i?this.DoAnd(e,s):5===i?this.DoDestUnique(e,s):2===i?this.DoOr(e,s):3===i&&this.DoXOr(e,s)},this.Remove=function(e){var t;return-1!==(t=this.IndexOf(e))&&this.Delete(t),t},this.Sort=function(e){rtl.length(this.FList)>0&&!(this.FCount<2)&&t.QuickSort(rtl.arrayRef(this.FList),0,this.FCount-1,function(t,s){return e(t,s)})}}),this.TListNotification={0:"lnAdded",lnAdded:0,1:"lnExtracted",lnExtracted:1,2:"lnDeleted",lnDeleted:2},rtl.createClass(this,"TList",d,function(){this.$init=function(){d.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,d.$final.call(this)},this.Get=function(e){return this.FList.Get(e)},this.Notify=function(e,t){C(e)},this.GetCount=function(){return this.FList.FCount},this.Create$1=function(){return d.Create.call(this),this.FList=n.$create("Create"),this},this.Destroy=function(){null!=this.FList&&this.Clear(),S({p:this,get:function(){return this.p.FList},set:function(e){this.p.FList=e}})},this.Add=function(e){var t;return t=this.FList.Add(e),C(e)&&this.Notify(e,0),t},this.Clear=function(){for(;this.FList.FCount>0;)this.Delete(this.GetCount()-1)},this.Delete=function(e){var t;t=this.FList.Get(e),this.FList.Delete(e),C(t)&&this.Notify(t,2)}}),rtl.createClass(this,"TPersistent",d,function(){l=this,this.AssignError=function(e){var t="";throw t=null!==e?e.$classname:"Nil",T.$create("Create$1",["Cannot assign a "+t+" to a "+this.$classname+"."])},this.AssignTo=function(e){e.AssignError(this)},this.Assign=function(e){null!==e?e.AssignTo(this):this.AssignError(null)}}),rtl.createClass(this,"TStringsEnumerator",d,function(){a=this,this.$init=function(){d.$init.call(this),this.FStrings=null,this.FPosition=0},this.$final=function(){this.FStrings=void 0,d.$final.call(this)},this.Create$1=function(e){return d.Create.call(this),this.FStrings=e,this.FPosition=-1,this},this.GetCurrent=function(){return this.FStrings.Get(this.FPosition)},this.MoveNext=function(){return this.FPosition+=1,this.FPosition<this.FStrings.GetCount()}}),rtl.createClass(this,"TStrings",l,function(){o=this,this.$init=function(){l.$init.call(this),this.FSpecialCharsInited=!1,this.FAlwaysQuote=!1,this.FQuoteChar="\0",this.FDelimiter="\0",this.FNameValueSeparator="\0",this.FUpdateCount=0,this.FLBS=0,this.FSkipLastLineBreak=!1,this.FStrictDelimiter=!1,this.FLineBreak=""},this.GetValue=function(e){var t,s="",i="";return s="",-1!==(t=this.IndexOfName(e))&&this.GetNameValue(t,{get:function(){return i},set:function(e){i=e}},{get:function(){return s},set:function(e){s=e}}),s},this.SetDelimiter=function(e){this.CheckSpecialChars(),this.FDelimiter=e},this.SetNameValueSeparator=function(e){this.CheckSpecialChars(),this.FNameValueSeparator=e},this.GetSkipLastLineBreak=function(){return this.CheckSpecialChars(),this.FSkipLastLineBreak},this.Error=function(e,t){throw i.$create("CreateFmt",[e,m(18,y(t))])},this.GetCapacity=function(){return this.GetCount()},this.GetObject=function(e){return null},this.GetTextStr=function(){var e="",t=0,s="";if(this.CheckSpecialChars(),this.FLineBreak!==f.sLineBreak)s=this.FLineBreak;else{var i=this.FLBS;0===i?s="\n":1===i?s="\r\n":2===i&&(s="\r")}e="";for(var r=0,n=this.GetCount()-1;r<=n;r++)t=r,e+=this.Get(t),(t<this.GetCount()-1||!this.GetSkipLastLineBreak())&&(e+=s);return e},this.PutObject=function(e,t){},this.SetUpdateState=function(e){},this.DoCompareText=function(e,t){return g(e,t)},this.SetDelimitedText=function(e){var t=0,s=0,i=!1;this.CheckSpecialChars(),this.BeginUpdate(),t=1,s=1,i=!1;try{if(this.Clear(),this.FStrictDelimiter)for(;t<=e.length;){if(i&&t<=e.length&&e.charAt(t-1)===this.FDelimiter&&(t+=1),t<=e.length)if(e.charAt(t-1)===this.FQuoteChar){for(s=t+1;s<=e.length&&(e.charAt(s-1)!==this.FQuoteChar||s+1<=e.length&&e.charAt(s+1-1)===this.FQuoteChar);)s<=e.length&&e.charAt(s-1)===this.FQuoteChar?s+=2:s+=1;this.Add(E(P(e,t+1,s-t-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),t=s+1}else{for(s=t;s<=e.length&&e.charAt(s-1)!==this.FDelimiter;)s+=1;this.Add(P(e,t,s-t)),t=s}else i&&this.Add("");i=!0}else for(;t<=e.length;){for(i&&t<=e.length&&e.charAt(t-1)===this.FDelimiter&&(t+=1);t<=e.length&&e.charCodeAt(t-1)<=32;)t+=1;if(t<=e.length)if(e.charAt(t-1)===this.FQuoteChar){for(s=t+1;s<=e.length&&(e.charAt(s-1)!==this.FQuoteChar||s+1<=e.length&&e.charAt(s+1-1)===this.FQuoteChar);)s<=e.length&&e.charAt(s-1)===this.FQuoteChar?s+=2:s+=1;this.Add(E(P(e,t+1,s-t-1),this.FQuoteChar+this.FQuoteChar,this.FQuoteChar,rtl.createSet(0))),t=s+1}else{for(s=t;s<=e.length&&e.charCodeAt(s-1)>32&&e.charAt(s-1)!==this.FDelimiter;)s+=1;this.Add(P(e,t,s-t)),t=s}else i&&this.Add("");for(;t<=e.length&&e.charCodeAt(t-1)<=32;)t+=1;i=!0}}finally{this.EndUpdate()}},this.CheckSpecialChars=function(){this.FSpecialCharsInited||(this.FQuoteChar='"',this.FDelimiter=",",this.FNameValueSeparator="=",this.FLBS=f.DefaultTextLineBreakStyle,this.FSpecialCharsInited=!0,this.FLineBreak=f.sLineBreak)},this.Create$1=function(){return d.Create.call(this),this.FAlwaysQuote=!1,this},this.Destroy=function(){d.Destroy.call(this)},this.Add=function(e){var t;return t=this.GetCount(),this.Insert(this.GetCount(),e),t},this.AddObject=function(e,t){var s;return s=this.Add(e),this.PutObject(s,t),s},this.AddStrings=function(e){for(var t=0,s=0,i=e.GetCount()-1;s<=i;s++)t=s,this.AddObject(e.Get(t),e.GetObject(t))},this.Assign=function(e){var t=null;if(o.isPrototypeOf(e)){t=e,this.BeginUpdate();try{this.Clear(),this.FSpecialCharsInited=t.FSpecialCharsInited,this.FQuoteChar=t.FQuoteChar,this.FDelimiter=t.FDelimiter,this.FNameValueSeparator=t.FNameValueSeparator,this.FLBS=t.FLBS,this.FLineBreak=t.FLineBreak,this.AddStrings(t)}finally{this.EndUpdate()}}else l.Assign.call(this,e)},this.BeginUpdate=function(){0===this.FUpdateCount&&this.SetUpdateState(!0),this.FUpdateCount+=1},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.SetUpdateState(!1)},this.GetEnumerator=function(){return a.$create("Create$1",[this])},this.IndexOf=function(e){var t=0;for(t=0;t<this.GetCount()&&0!==this.DoCompareText(this.Get(t),e);)t+=1;return t===this.GetCount()&&(t=-1),t},this.IndexOfName=function(e){var t=0,s=0,i="";for(this.CheckSpecialChars(),t=0;t<this.GetCount();){if(i=this.Get(t),(s=I(this.FNameValueSeparator,i)-1)>=0&&0===this.DoCompareText(e,P(i,1,s)))return t;t+=1}return t=-1},this.GetNameValue=function(e,t,s){var i;this.CheckSpecialChars(),s.set(this.Get(e)),0!==(i=I(this.FNameValueSeparator,s.get()))?(t.set(P(s.get(),1,i-1)),s.set(P(s.get(),i+1,s.get().length-i))):t.set("")}}),rtl.recNewT(this,"TStringItem",function(){h=this,this.FString="",this.FObject=null,this.$eq=function(e){return this.FString===e.FString&&this.FObject===e.FObject},this.$assign=function(e){return this.FString=e.FString,this.FObject=e.FObject,this}}),this.TStringsSortStyle={0:"sslNone",sslNone:0,1:"sslUser",sslUser:1,2:"sslAuto",sslAuto:2},rtl.createClass(this,"TStringList",o,function(){this.$init=function(){o.$init.call(this),this.FList=[],this.FCount=0,this.FOnChange=null,this.FOnChanging=null,this.FDuplicates=0,this.FCaseSensitive=!1,this.FForceSort=!1,this.FOwnsObjects=!1,this.FSortStyle=0},this.$final=function(){this.FList=void 0,this.FOnChange=void 0,this.FOnChanging=void 0,o.$final.call(this)},this.ExchangeItemsInt=function(e,t){var s,i;s=this.FList[e].FString,i=this.FList[e].FObject,this.FList[e].FString=this.FList[t].FString,this.FList[e].FObject=this.FList[t].FObject,this.FList[t].FString=s,this.FList[t].FObject=i},this.GetSorted=function(){return this.FSortStyle in rtl.createSet(1,2)},this.Grow=function(){var e=0;(e=this.GetCapacity())>=256?e+=rtl.trunc(e/4):0===e?e=4:e*=4,this.SetCapacity(e)},this.InternalClear=function(e,t){var s=0;if(e<this.FCount){if(this.FOwnsObjects)for(var i=e,r=this.FCount-1;i<=r;i++)s=i,this.FList[s].FString="",S({p:this.FList[s],get:function(){return this.p.FObject},set:function(e){this.p.FObject=e}});else for(var n=e,l=this.FCount-1;n<=l;n++)s=n,this.FList[s].FString="";this.FCount=e}t||this.SetCapacity(0)},this.QuickSort=function(e,t,s){var i=0,r=0,n=0;if(t-e<=1)e<t&&s(this,e,t)>0&&this.ExchangeItems(e,t);else{for(r=e,n=t,i=e+R(t-e);r<n;){for(;r<i&&s(this,r,i)<=0;)r+=1;for(;n>i&&s(this,n,i)>0;)n-=1;this.ExchangeItems(r,n),i===r?i=n:i===n&&(i=r)}i-1>=e&&this.QuickSort(e,i-1,s),i+1<=t&&this.QuickSort(i+1,t,s)}},this.SetSorted=function(e){e?this.SetSortStyle(2):this.SetSortStyle(0)},this.SetSortStyle=function(e){this.FSortStyle!==e&&(2===e&&this.Sort(),this.FSortStyle=e)},this.CheckIndex=function(e){(e<0||e>=this.FCount)&&this.Error(rtl.getResStr(F,"SListIndexError"),e)},this.ExchangeItems=function(e,t){this.ExchangeItemsInt(e,t)},this.Changed=function(){0===this.FUpdateCount&&null!=this.FOnChange&&this.FOnChange(this)},this.Changing=function(){0===this.FUpdateCount&&null!=this.FOnChanging&&this.FOnChanging(this)},this.Get=function(e){return this.CheckIndex(e),this.FList[e].FString},this.GetCapacity=function(){return rtl.length(this.FList)},this.GetCount=function(){return this.FCount},this.GetObject=function(e){return this.CheckIndex(e),this.FList[e].FObject},this.PutObject=function(e,t){this.CheckIndex(e),this.Changing(),this.FList[e].FObject=t,this.Changed()},this.SetCapacity=function(e){e<0&&this.Error(rtl.getResStr(F,"SListCapacityError"),e),e!==this.GetCapacity()&&(this.FList=rtl.arraySetLength(this.FList,h,e))},this.SetUpdateState=function(e){e?this.Changing():this.Changed()},this.InsertItem=function(e,t){this.InsertItem$1(e,t,null)},this.InsertItem$1=function(e,t,s){var i=h.$new();this.Changing(),this.FCount===this.GetCapacity()&&this.Grow(),i.FString=t,i.FObject=s,this.FList.splice(e,0,i),this.FCount+=1,this.Changed()},this.DoCompareText=function(e,t){return this.FCaseSensitive?v(e,t):g(e,t)},this.Destroy=function(){this.InternalClear(0,!1),o.Destroy.call(this)},this.Add=function(e){var t=0;if(2!==this.FSortStyle)t=this.FCount;else if(this.Find(e,{get:function(){return t},set:function(e){t=e}})){var s=this.FDuplicates;if(0===s)return t;2===s&&this.Error(rtl.getResStr(F,"SDuplicateString"),0)}return this.InsertItem(t,e),t},this.Clear=function(){0!==this.FCount&&(this.Changing(),this.InternalClear(0,!1),this.Changed())},this.Delete=function(e){this.CheckIndex(e),this.Changing(),this.FOwnsObjects&&S({p:this.FList[e],get:function(){return this.p.FObject},set:function(e){this.p.FObject=e}}),this.FList.splice(e,1),this.FList[this.GetCount()-1].FString="",this.FList[this.GetCount()-1].FObject=null,this.FCount-=1,this.Changed()},this.Find=function(e,t){var i=!1,r=0,n=0,l=0,a=0;if(i=!1,t.set(-1),!this.GetSorted())throw s.$create("Create$1",[rtl.getResStr(F,"SErrFindNeedsSortedList")]);for(r=0,n=this.GetCount()-1;r<=n;)l=r+rtl.trunc((n-r)/2),(a=this.DoCompareText(e,this.FList[l].FString))>0?r=l+1:(n=l-1,0===a&&(i=!0,1!==this.FDuplicates&&(r=l)));return t.set(r),i},this.IndexOf=function(e){var t=0;return this.GetSorted()?this.Find(e,{get:function(){return t},set:function(e){t=e}})||(t=-1):t=o.IndexOf.call(this,e),t},this.Insert=function(e,t){2===this.FSortStyle?this.Error(rtl.getResStr(F,"SSortedListError"),0):((e<0||e>this.FCount)&&this.Error(rtl.getResStr(F,"SListIndexError"),e),this.InsertItem(e,t))},this.Sort=function(){this.CustomSort(t.StringListAnsiCompare)},this.CustomSort=function(e){(this.FForceSort||2!==this.FSortStyle)&&this.FCount>1&&(this.Changing(),this.QuickSort(0,this.FCount-1,e),this.Changed())}}),rtl.createClass(this,"TCollectionItem",l,function(){this.$init=function(){l.$init.call(this),this.FCollection=null,this.FID=0},this.$final=function(){this.FCollection=void 0,l.$final.call(this)},this.GetIndex=function(){return null!=this.FCollection?this.FCollection.FItems.IndexOf(this):-1},this.SetCollection=function(e){e!==this.FCollection&&(null!=this.FCollection&&this.FCollection.RemoveItem(this),null!=e&&e.InsertItem(this))},this.Changed=function(e){null!==this.FCollection&&0===this.FCollection.FUpdateCount&&(e?this.FCollection.Update(null):this.FCollection.Update(this))},this.SetIndex=function(e){var t;(t=this.GetIndex())>-1&&t!==e&&(this.FCollection.FItems.Move(t,e),this.Changed(!0))},this.Create$1=function(e){return d.Create.call(this),this.SetCollection(e),this},this.Destroy=function(){this.SetCollection(null),d.Destroy.call(this)}}),this.TCollectionNotification={0:"cnAdded",cnAdded:0,1:"cnExtracting",cnExtracting:1,2:"cnDeleting",cnDeleting:2},rtl.createClass(this,"TCollection",l,function(){u=this,this.$init=function(){l.$init.call(this),this.FItemClass=null,this.FItems=null,this.FUpdateCount=0,this.FNextID=0},this.$final=function(){this.FItemClass=void 0,this.FItems=void 0,l.$final.call(this)},this.GetCount=function(){return this.FItems.FCount},this.InsertItem=function(e){this.FItemClass.isPrototypeOf(e)&&(this.FItems.Add(e),e.FCollection=this,e.FID=this.FNextID,this.FNextID+=1,this.SetItemName(e),this.Notify(e,0),this.Changed())},this.RemoveItem=function(e){var t;this.Notify(e,1),-1!==(t=this.FItems.IndexOfItem(e,1))&&this.FItems.Delete(t),e.FCollection=null,this.Changed()},this.DoClear=function(){for(var e=null;this.FItems.FCount>0;)null!=(e=rtl.getObject(this.FItems.Last()))&&e.$destroy("Destroy")},this.Changed=function(){0===this.FUpdateCount&&this.Update(null)},this.GetItem=function(e){return rtl.getObject(this.FItems.Get(e))},this.SetItemName=function(e){},this.Update=function(e){},this.Notify=function(e,t){},this.Create$1=function(e){return d.Create.call(this),this.FItemClass=e,this.FItems=n.$create("Create"),this},this.Destroy=function(){this.FUpdateCount=1;try{this.DoClear()}finally{this.FUpdateCount=0}null!=this.FItems&&this.FItems.$destroy("Destroy"),d.Destroy.call(this)},this.Add=function(){return this.FItemClass.$create("Create$1",[this])},this.Assign=function(e){var t=0;if(u.isPrototypeOf(e)){this.Clear();for(var s=0,i=e.GetCount()-1;s<=i;s++)t=s,this.Add().Assign(e.GetItem(t))}else l.Assign.call(this,e)},this.BeginUpdate=function(){this.FUpdateCount+=1},this.Clear=function(){if(0!==this.FItems.FCount){this.BeginUpdate();try{this.DoClear()}finally{this.EndUpdate()}}},this.EndUpdate=function(){this.FUpdateCount>0&&(this.FUpdateCount-=1),0===this.FUpdateCount&&this.Changed()},this.Delete=function(e){var t=null;t=rtl.getObject(this.FItems.Get(e)),this.Notify(t,2),null!=t&&t.$destroy("Destroy")},this.Insert=function(e){var t=null;return(t=this.Add()).SetIndex(e),t}}),this.TOperation={0:"opInsert",opInsert:0,1:"opRemove",opRemove:1},this.TComponentStateItem={0:"csLoading",csLoading:0,1:"csReading",csReading:1,2:"csWriting",csWriting:2,3:"csDestroying",csDestroying:3,4:"csDesigning",csDesigning:4,5:"csAncestor",csAncestor:5,6:"csUpdating",csUpdating:6,7:"csFixups",csFixups:7,8:"csFreeNotification",csFreeNotification:8,9:"csInline",csInline:9,10:"csDesignInstance",csDesignInstance:10},this.TComponentStyleItem={0:"csInheritable",csInheritable:0,1:"csCheckPropAvail",csCheckPropAvail:1,2:"csSubComponent",csSubComponent:2,3:"csTransient",csTransient:3},rtl.createClass(this,"TComponent",l,function(){this.$init=function(){l.$init.call(this),this.FOwner=null,this.FName="",this.FTag=0,this.FComponents=null,this.FFreeNotifies=null,this.FComponentState={},this.FComponentStyle={}},this.$final=function(){this.FOwner=void 0,this.FComponents=void 0,this.FFreeNotifies=void 0,this.FComponentState=void 0,this.FComponentStyle=void 0,l.$final.call(this)},this.Insert=function(e){null==this.FComponents&&(this.FComponents=n.$create("Create")),this.FComponents.Add(e),e.FOwner=this},this.Remove=function(e){e.FOwner=null,null!=this.FComponents&&(this.FComponents.Remove(e),0===this.FComponents.FCount&&(this.FComponents.$destroy("Destroy"),this.FComponents=null))},this.RemoveNotification=function(e){null!==this.FFreeNotifies&&(this.FFreeNotifies.Remove(e),0===this.FFreeNotifies.FCount&&(this.FFreeNotifies.$destroy("Destroy"),this.FFreeNotifies=null,this.FComponentState=rtl.excludeSet(this.FComponentState,8)))},this.SetReference=function(e){var t=null,s=null,i=null;""!==this.FName&&null!=this.FOwner&&(i=this.FOwner,null!=(t=this.FOwner.$class.FieldAddress(this.FName))&&(s=e?this:null,i[""+t.name]=s))},this.ChangeName=function(e){this.FName=e},this.Notification=function(e,t){var s=0;if(1===t&&this.RemoveFreeNotification(e),null!=this.FComponents)for(s=this.FComponents.FCount-1;s>=0;)rtl.getObject(this.FComponents.Get(s)).Notification(e,t),(s-=1)>=this.FComponents.FCount&&(s=this.FComponents.FCount-1)},this.SetDesigning=function(e,t){var s=0;if(this.FComponentState=e?rtl.includeSet(this.FComponentState,4):rtl.excludeSet(this.FComponentState,4),null!=this.FComponents&&t)for(var i=0,r=this.FComponents.FCount-1;i<=r;i++)s=i,rtl.getObject(this.FComponents.Get(s)).SetDesigning(e,!0)},this.SetName=function(e){if(this.FName!==e){if(""!==e&&!A(e,!1,!1))throw r.$create("CreateFmt",[rtl.getResStr(F,"SInvalidName"),m(18,e)]);null!=this.FOwner?this.FOwner.ValidateRename(this,this.FName,e):this.ValidateRename(null,this.FName,e),this.SetReference(!1),this.ChangeName(e),this.SetReference(!0)}},this.ValidateRename=function(e,t,s){if(null!==e&&0!==g(t,s)&&e.FOwner===this&&null!==this.FindComponent(s))throw r.$create("CreateFmt",[rtl.getResStr(F,"SDuplicateName"),m(18,s)]);4 in this.FComponentState&&null!==this.FOwner&&this.FOwner.ValidateRename(e,t,s)},this.ValidateContainer=function(e){e.ValidateInsert(this)},this.ValidateInsert=function(e){},this.Create$1=function(e){return this.FComponentStyle=rtl.createSet(0),null!=e&&e.InsertComponent(this),this},this.Destroy=function(){var e=0,t=null;if(this.Destroying(),null!=this.FFreeNotifies){for(e=this.FFreeNotifies.FCount-1;e>=0;)t=rtl.getObject(this.FFreeNotifies.Get(e)),this.FFreeNotifies.Delete(e),t.Notification(this,1),null===this.FFreeNotifies?e=0:e>this.FFreeNotifies.FCount&&(e=this.FFreeNotifies.FCount),e-=1;S({p:this,get:function(){return this.p.FFreeNotifies},set:function(e){this.p.FFreeNotifies=e}})}this.DestroyComponents(),null!==this.FOwner&&this.FOwner.RemoveComponent(this),d.Destroy.call(this)},this.BeforeDestruction=function(){3 in this.FComponentState||this.Destroying()},this.DestroyComponents=function(){for(var e=null;null!=this.FComponents;)e=rtl.getObject(this.FComponents.Last()),this.Remove(e),e.$destroy("Destroy")},this.Destroying=function(){var e=0;if(!(3 in this.FComponentState)&&(this.FComponentState=rtl.includeSet(this.FComponentState,3),null!=this.FComponents))for(var t=0,s=this.FComponents.FCount-1;t<=s;t++)e=t,rtl.getObject(this.FComponents.Get(e)).Destroying()},this.FindComponent=function(e){var t=null,s=0;if(t=null,""===e||null==this.FComponents)return t;for(var i=0,r=this.FComponents.FCount-1;i<=r;i++)if(s=i,0===g(rtl.getObject(this.FComponents.Get(s)).FName,e))return t=rtl.getObject(this.FComponents.Get(s));return t},this.RemoveFreeNotification=function(e){this.RemoveNotification(e),e.RemoveNotification(this)},this.InsertComponent=function(e){e.ValidateContainer(this),this.ValidateRename(e,"",e.FName),null!==e.FOwner&&e.FOwner.RemoveComponent(e),this.Insert(e),4 in this.FComponentState&&e.SetDesigning(!0,!0),this.Notification(e,0)},this.RemoveComponent=function(e){this.Notification(e,1),this.Remove(e),e.SetDesigning(!1,!0),this.ValidateRename(e,e.FName,"")};var e=this.$rtti;e.addProperty("Name",6,rtl.string,"FName","SetName"),e.addProperty("Tag",0,rtl.nativeint,"FTag","FTag",4,{Default:0})}),rtl.createClass(this,"TLoadHelper",d,function(){0}),this.SetLoadHelperClass=function(e){var s;return s=t.GlobalLoadHelper,t.GlobalLoadHelper=e,s},e.$implcode=function(){t.GlobalLoadHelper=null,t.QuickSort=function(e,s,i,r){var n=0,l=0,a=0,o=void 0,h=void 0;do{n=s,l=i,o=e[a=s+(i-s>>>1)];do{for(;n<a&&r(o,e[n])>0;)n+=1;for(;l>a&&r(o,e[l])<0;)l-=1;n<l&&(h=e[n],e[n]=e[l],e[l]=h,a===n?(a=l,n+=1):a===l?(a=n,l-=1):(n+=1,l-=1))}while(!(n>=l));if(a-s<i-a)s+1<a&&t.QuickSort(rtl.arrayRef(e),s,a-1,r),s=a+1;else{if(a+1<i&&t.QuickSort(rtl.arrayRef(e),a+1,i,r),!(s+1<a))return;i=a-1}}while(!(s>=i))},t.StringListAnsiCompare=function(e,t,s){return e.DoCompareText(e.FList[t].FString,e.FList[s].FString)},t.ClassList=null},e.$init=function(){t.ClassList=new Object}},[]),rtl.module("weborworker",["System","JS","Types"],function(){"use strict"}),rtl.module("Web",["System","Types","JS","weborworker"],function(){"use strict"}),rtl.module("contnrs",["System","SysUtils","Classes"],function(){"use strict";var e=this,t=e.$impl,s=null,i=null,r=null,n=null,l=null,a=null,o=pas.System,h=o.TObject,u=pas.Classes,c=u.TFPList,p=u.TList,f=o.VarRecs,d=pas.SysUtils,F=d.FreeAndNil,m=d.Exception;rtl.createClass(this,"TFPObjectList",h,function(){s=this,this.$init=function(){h.$init.call(this),this.FFreeObjects=!1,this.FList=null},this.$final=function(){this.FList=void 0,h.$final.call(this)},this.GetCount=function(){return this.FList.FCount},this.GetItem=function(e){return rtl.getObject(this.FList.Get(e))},this.SetItem=function(e,t){var s=null;this.FFreeObjects?(s=rtl.getObject(this.FList.Get(e)),this.FList.Put(e,t),s=rtl.freeLoc(s)):this.FList.Put(e,t)},this.Create$1=function(){return h.Create.call(this),this.FList=c.$create("Create"),this.FFreeObjects=!0,this},this.Create$2=function(e){return this.Create$1(),this.FFreeObjects=e,this},this.Destroy=function(){null!==this.FList&&(this.Clear(),this.FList.$destroy("Destroy")),h.Destroy.call(this)},this.Clear=function(){var e=0,t=null;if(this.FFreeObjects)for(var s=this.FList.FCount-1;s>=0;s--)e=s,t=rtl.getObject(this.FList.Get(e)),this.FList.Put(e,null),t=rtl.freeLoc(t);this.FList.Clear()},this.Add=function(e){return this.FList.Add(e)}}),rtl.createClass(this,"TObjectList",p,function(){this.$init=function(){p.$init.call(this),this.FFreeObjects=!1},this.Notify=function(e,t){var s=null;this.FFreeObjects&&2===t&&(s=rtl.getObject(e),s=rtl.freeLoc(s)),p.Notify.call(this,e,t)},this.GetItem=function(e){return rtl.getObject(p.Get.call(this,e))},this.Create$3=function(e){return p.Create$1.call(this),this.FFreeObjects=e,this},this.Add$1=function(e){return p.Add.call(this,e)}}),rtl.createClass(this,"THTCustomNode",h,function(){i=this,this.$init=function(){h.$init.call(this),this.FKey=""},this.CreateWith=function(e){return h.Create.call(this),this.FKey=e,this}}),rtl.createClass(this,"TFPCustomHashTable",h,function(){r=this,this.$init=function(){h.$init.call(this),this.FHashTable=null,this.FHashFunction=null,this.FCount=0,this.FHashTableSize=0},this.$final=function(){this.FHashTable=void 0,this.FHashFunction=void 0,h.$final.call(this)},this.SetHashTableSize=function(e){var s=0,i=0;if(e!==this.FHashTableSize){for(s=0;t.PRIMELIST[s]<e&&s<27;)s+=1;i=t.PRIMELIST[s],0===this.FCount?(this.FHashTableSize=i,this.InitializeHashTable()):this.ChangeTableSize(i)}},this.InitializeHashTable=function(){if(this.FHashTableSize>0)for(var e=0,t=this.FHashTableSize-1;e<=t;e++)this.FHashTable.Add(null);this.FCount=0},this.Chain=function(e){return this.FHashTable.GetItem(e)},this.FindChainForAdd=function(t){var i,r=null,n=0;if(i=this.FHashFunction(t,this.FHashTableSize),null!=(r=this.Chain(i))){if(r.GetCount()>0)for(var l=0,o=r.GetCount()-1;l<=o;l++)if(n=l,r.GetItem(n).FKey===t)throw a.$create("CreateFmt",[rtl.getResStr(e,"DuplicateMsg"),f(18,t)])}else this.FHashTable.SetItem(i,s.$create("Create$2",[!0])),r=this.Chain(i);return this.FCount+=1,r},this.Create$1=function(){return this.CreateWith(196613,e.RSHash),this},this.CreateWith=function(e,t){return h.Create.call(this),this.FHashTable=s.$create("Create$2",[!0]),this.SetHashTableSize(e),this.FHashFunction=t,this},this.Destroy=function(){rtl.free(this,"FHashTable"),h.Destroy.call(this)},this.ChangeTableSize=function(e){var t,i=null,r=null,n=0,l=0,a=null;if(i=this.FHashTable,t=this.FHashTableSize,this.FHashTableSize=e,this.FHashTable=s.$create("Create$2",[!0]),this.InitializeHashTable(),t>0)for(var o=0,h=t-1;o<=h;o++)if(n=o,null!=(r=i.GetItem(n)))for(var u=0,c=r.GetCount()-1;u<=c;u++)l=u,a=r.GetItem(l),this.AddNode(a);i=rtl.freeLoc(i)},this.Find=function(e){var t,s=null,i=0;if(t=this.FHashFunction(e,this.FHashTableSize),null!=(s=this.Chain(t))&&s.GetCount()>0)for(var r=0,n=s.GetCount()-1;r<=n;r++)if(i=r,s.GetItem(i).FKey===e)return s.GetItem(i);return null}}),rtl.createClass(this,"THTObjectNode",i,function(){n=this,this.$init=function(){i.$init.call(this),this.FData=null},this.$final=function(){this.FData=void 0,i.$final.call(this)}}),rtl.createClass(this,"THTOwnedObjectNode",n,function(){l=this,this.Destroy=function(){F({p:this,get:function(){return this.p.FData},set:function(e){this.p.FData=e}}),h.Destroy.call(this)}}),rtl.createClass(this,"TFPObjectHashTable",r,function(){this.$init=function(){r.$init.call(this),this.FOwnsObjects=!1},this.CreateNewNode=function(e){return this.FOwnsObjects?l.$create("CreateWith",[e]):n.$create("CreateWith",[e])},this.AddNode=function(e){this.Add(e.FKey,e.FData)},this.Create$2=function(e){return r.Create$1.call(this),this.FOwnsObjects=e,this},this.Add=function(e,t){var s=null,i=null;s=this.FindChainForAdd(e),(i=this.CreateNewNode(e)).FData=t,s.Add(i)}}),rtl.createClass(this,"EDuplicate",m,function(){a=this});this.RSHash=function(e,t){var s=0,i=0,r=0;if(i=63689,s=0,e.length>0)for(var n=1,l=e.length;n<=l;n++)r=n,s=s*i+e.charCodeAt(r-1),i*=378551;return s=rtl.lw(2147483647&s)%t},e.$implcode=function(){t.NPRIMES=28,t.PRIMELIST=[53,97,193,389,769,1543,3079,6151,12289,24593,49157,98317,196613,393241,786433,1572869,3145739,6291469,12582917,25165843,50331653,100663319,201326611,402653189,805306457,1610612741,3221225473,4294967291],e.$resourcestrings={DuplicateMsg:{org:"An item with key %0:s already exists"}}}},["JS"]),rtl.module("fpjson",["System","JS","RTLConsts","Types","SysUtils","Classes","contnrs"],function(){"use strict";var e=this,t=e.$impl,s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=pas.System,F=d.TObject,m=d.StringOfChar,C=d.Delete,S=pas.SysUtils,T=S.FloatToStr$1,y=S.IntToStr,g=S.BoolToStr$1,E=pas.contnrs.TFPObjectList,P=S.FreeAndNil,I=d.VarRecs,R=pas.RTLConsts,v=d.Copy$1,A=S.CompareText,N=S.Exception,x=S.TFormatSettings,b=pas.JS,O=b.isBoolean,k=b.isInteger;this.TJSONtype={0:"jtUnknown",jtUnknown:0,1:"jtNumber",jtNumber:1,2:"jtString",jtString:2,3:"jtBoolean",jtBoolean:3,4:"jtNull",jtNull:4,5:"jtArray",jtArray:5,6:"jtObject",jtObject:6},this.TJSONInstanceType={0:"jitUnknown",jitUnknown:0,1:"jitNumberInteger",jitNumberInteger:1,2:"jitNumberNativeInt",jitNumberNativeInt:2,3:"jitNumberFloat",jitNumberFloat:3,4:"jitString",jitString:4,5:"jitBoolean",jitBoolean:5,6:"jitNull",jitNull:6,7:"jitArray",jitArray:7,8:"jitObject",jitObject:8},this.TFormatOption={0:"foSingleLineArray",foSingleLineArray:0,1:"foSingleLineObject",foSingleLineObject:1,2:"foDoNotQuoteMembers",foDoNotQuoteMembers:2,3:"foUseTabchar",foUseTabchar:3,4:"foSkipWhiteSpace",foSkipWhiteSpace:4,5:"foSkipWhiteSpaceOnlyLeading",foSkipWhiteSpaceOnlyLeading:5,6:"foForceLF",foForceLF:6,7:"foFormatFloat",foFormatFloat:7},this.DefaultIndentSize=2,this.DefaultFormat={},rtl.createClass(this,"TJSONData",F,function(){s=this,this.ElementSeps=[", ",","],this.FCompressedJSON=!1,this.FElementSep="",rtl.recNewT(this,"TFormatJSONContext",function(){i=this,this.S="",this.IndentSize=0,this.$new=function(){var e=Object.create(this);return e.Options={},e.CachedIndents=[],e},this.$eq=function(e){return rtl.eqSet(this.Options,e.Options)&&this.S===e.S&&this.IndentSize===e.IndentSize&&this.CachedIndents===e.CachedIndents},this.$assign=function(e){return this.Options=rtl.refSet(e.Options),this.S=e.S,this.IndentSize=e.IndentSize,this.CachedIndents=rtl.arrayRef(e.CachedIndents),this},this.Append=function(e){this.S=this.S+e},this.AppendIndent=function(e){e<=0||this.IndentSize<=0||((e>=rtl.length(this.CachedIndents)||""===this.CachedIndents[e])&&this.CreateCachedIndent(e),this.Append(this.CachedIndents[e]))},this.CreateCachedIndent=function(e){var t="\0";e>=rtl.length(this.CachedIndents)&&(this.CachedIndents=rtl.arraySetLength(this.CachedIndents,"",16+e+Math.floor(e/4)+Math.floor(e/8))),t=" ",3 in this.Options&&(t="\t"),this.CachedIndents[e]=m(t,e*this.IndentSize)}}),this.DetermineElementSeparators=function(){s.FElementSep=this.ElementSeps[+this.FCompressedJSON]},this.DoError=function(e){throw f.$create("Create$1",[e])},this.DoError$1=function(e,t){throw f.$create("CreateFmt",[e,t])},this.GetItem=function(e){return null},this.DoFormatJSON=function(e,t){e.Append(this.GetAsJSON())},this.GetCount=function(){return 0},this.JSONType=function(){return 0},this.Create$1=function(){return this.Clear(),this},this.DumpJSON=function(t){function s(e){""!==e&&t.push(e)}var i=0,r=null,n=this.$class.JSONType();if(6===n){r=this,s("{");for(var l=0,a=r.GetCount()-1;l<=a;l++)(i=l)>0&&s(","),s('"'),s(e.StringToJSONString(r.GetNameOf(i),!1)),s('":'),r.GetItem(i).DumpJSON(t);s("}")}else if(5===n){s("[");for(var o=0,h=this.GetCount()-1;o<=h;o++)(i=o)>0&&s(","),this.GetItem(i).DumpJSON(t);s("]")}else s(this.GetAsJSON())},this.FormatJSON=function(e,t){var s=i.$new();return s.Options=rtl.refSet(e),s.IndentSize=t,this.DoFormatJSON(s,0),s.S}}),rtl.createClass(this,"TJSONNumber",s,function(){r=this,this.JSONType=function(){return 1}}),rtl.createClass(this,"TJSONFloatNumber",r,function(){n=this,this.$init=function(){r.$init.call(this),this.FValue=0},this.GetAsJSON=function(){return this.GetAsString()},this.GetAsString=function(){var e="";return""!==(e=rtl.floatToStr(this.FValue))&&" "===e.charAt(0)&&C({get:function(){return e},set:function(t){e=t}},1,1),e},this.DoFormatJSON=function(e,s){7 in e.Options?e.Append(T(this.FValue,t.JSONFormatSettings)):e.Append(this.GetAsJSON())},this.Create$2=function(e){return this.FValue=e,this},this.Clear=function(){this.FValue=0}}),rtl.createClass(this,"TJSONIntegerNumber",r,function(){l=this,this.$init=function(){r.$init.call(this),this.FValue=0},this.GetAsJSON=function(){return this.GetAsString()},this.GetAsString=function(){return y(this.FValue)},this.Create$2=function(e){return this.FValue=e,this},this.Clear=function(){this.FValue=0}}),rtl.createClass(this,"TJSONNativeIntNumber",r,function(){a=this,this.$init=function(){r.$init.call(this),this.FValue=0},this.GetAsJSON=function(){return this.GetAsString()},this.GetAsString=function(){return y(this.FValue)},this.Create$2=function(e){return this.FValue=e,this},this.Clear=function(){this.FValue=0}}),rtl.createClass(this,"TJSONString",s,function(){o=this,this.StrictEscaping=!1,this.$init=function(){s.$init.call(this),this.FValue=""},this.GetAsJSON=function(){return'"'+e.StringToJSONString(this.FValue,this.StrictEscaping)+'"'},this.GetAsString=function(){return this.FValue},this.Create$2=function(e){return this.FValue=e,this},this.JSONType=function(){return 2},this.Clear=function(){this.FValue=""}}),rtl.createClass(this,"TJSONBoolean",s,function(){h=this,this.$init=function(){s.$init.call(this),this.FValue=!1},this.GetAsJSON=function(){return this.FValue?"true":"false"},this.GetAsString=function(){return g(this.FValue,"true","false")},this.Create$2=function(e){return this.FValue=e,this},this.JSONType=function(){return 3},this.Clear=function(){this.FValue=!1}}),rtl.createClass(this,"TJSONNull",s,function(){u=this,this.Converterror=function(t){t?this.$class.DoError(rtl.getResStr(e,"SErrCannotConvertFromNull")):this.$class.DoError(rtl.getResStr(e,"SErrCannotConvertToNull"))},this.GetAsJSON=function(){return"null"},this.GetAsString=function(){return this.Converterror(!0),""},this.JSONType=function(){return 4},this.Clear=function(){}}),rtl.createClass(this,"TJSONArray",s,function(){c=this,this.$init=function(){s.$init.call(this),this.FList=null},this.$final=function(){this.FList=void 0,s.$final.call(this)},this.Converterror=function(t){t?this.$class.DoError(rtl.getResStr(e,"SErrCannotConvertFromArray")):this.$class.DoError(rtl.getResStr(e,"SErrCannotConvertToArray"))},this.GetAsJSON=function(){var e,t="",i=0,r=null;e=s.FElementSep,t="[";for(var n=0,l=this.GetCount()-1;n<=l;n++)i=n,t+=null!==(r=this.GetItem(i))?r.GetAsJSON():"null",i<this.GetCount()-1&&(t+=e);return t+="]"},this.GetAsString=function(){return this.Converterror(!0),""},this.GetCount=function(){return this.FList.GetCount()},this.GetItem=function(e){return rtl.as(this.FList.GetItem(e),s)},this.DoFormatJSON=function(e,t){var s,i,r=0,n="";e.Append("["),s=!(0 in e.Options),n=6 in e.Options?"\n":d.sLineBreak,i=4 in e.Options,s&&e.Append(n);for(var l=0,a=this.GetCount()-1;l<=a;l++)r=l,s&&e.AppendIndent(t+1),null===this.GetItem(r)?e.Append("null"):this.GetItem(r).DoFormatJSON(e,t+1),r<this.GetCount()-1&&e.Append(this.ElementSeps[+(i||s)]),s&&e.Append(n);s&&e.AppendIndent(t),e.Append("]")},this.Create$2=function(){return this.FList=E.$create("Create$2",[!0]),this},this.Destroy=function(){P({p:this,get:function(){return this.p.FList},set:function(e){this.p.FList=e}}),F.Destroy.call(this)},this.JSONType=function(){return 5},this.Clear=function(){this.FList.Clear()},this.Add=function(e){return this.FList.Add(e)},this.Add$3=function(t){return this.Add(e.CreateJSON$5(t))}}),rtl.createClass(this,"TJSONObject",s,function(){p=this,this.ElementStart=['"',""],this.SpacedQuoted=['" : '," : "],this.UnSpacedQuoted=['":',":"],this.ObjStartSeps=["{ ","{"],this.ObjEndSeps=[" }","}"],this.FUnquotedMemberNames=!1,this.FObjStartSep="",this.FObjEndSep="",this.FElementEnd="",this.FElementStart="",this.$init=function(){s.$init.call(this),this.FCount=0,this.FHash=null,this.FNames=[]},this.$final=function(){this.FHash=void 0,this.FNames=void 0,s.$final.call(this)},this.DoAdd=function(t,s,i){return this.FHash.hasOwnProperty("%"+t)&&(i&&P({get:function(){return s},set:function(e){s=e}}),this.$class.DoError$1(rtl.getResStr(e,"SErrDuplicateValue"),I(18,t))),this.FHash["%"+t]=s,this.FNames=[],this.FCount+=1,this.FCount},this.DetermineElementQuotes=function(){p.FObjStartSep=this.ObjStartSeps[+s.FCompressedJSON],p.FObjEndSep=this.ObjEndSeps[+s.FCompressedJSON],s.FCompressedJSON?p.FElementEnd=this.UnSpacedQuoted[+this.FUnquotedMemberNames]:p.FElementEnd=this.SpacedQuoted[+this.FUnquotedMemberNames],p.FElementStart=this.ElementStart[+this.FUnquotedMemberNames]},this.GetElements=function(t){var s=null;return this.FHash.hasOwnProperty("%"+t)?s=rtl.getObject(this.FHash["%"+t]):this.$class.DoError$1(rtl.getResStr(e,"SErrNonexistentElement"),I(18,t)),s},this.GetNameOf=function(e){return 0===rtl.length(this.FNames)&&(this.FNames=Object.getOwnPropertyNames(this.FHash)),(e<0||e>=this.FCount)&&this.$class.DoError$1(rtl.getResStr(R,"SListIndexError"),I(0,e)),v(this.FNames[e],2)},this.Converterror=function(t){t?this.$class.DoError(rtl.getResStr(e,"SErrCannotConvertFromObject")):this.$class.DoError(rtl.getResStr(e,"SErrCannotConvertToObject"))},this.GetAsJSON=function(){var t,i="",r=0,n="";t=s.FElementSep,i="";for(var l=0,a=this.GetCount()-1;l<=a;l++)r=l,""!==i&&(i+=t),n=null!=this.GetItem(r)?this.GetItem(r).GetAsJSON():"null",i=i+this.FElementStart+e.StringToJSONString(this.GetNameOf(r),!1)+this.FElementEnd+n;return i=""!==i?this.FObjStartSep+i+this.FObjEndSep:"{}"},this.GetAsString=function(){return this.Converterror(!0),""},this.GetCount=function(){return this.FCount},this.GetItem=function(e){return this.GetElements(this.GetNameOf(e))},this.DoFormatJSON=function(t,s){var i,r,n,l,a=0,o="",h="",u=null,c="";if(r=!(2 in t.Options),i=!(1 in t.Options),c=6 in t.Options?"\n":d.sLineBreak,n=4 in t.Options,l=5 in t.Options,o=n?l?": ":":":" : ",h=i?","+c:n?",":", ",0!==this.GetCount()){i?(t.Append("{"),t.Append(c)):t.Append(this.ObjStartSeps[+n]);for(var p=0,f=this.GetCount()-1;p<=f;p++)(a=p)>0&&t.Append(h),i&&t.AppendIndent(s+1),r&&t.Append('"'),t.Append(e.StringToJSONString(this.GetNameOf(a),!1)),r&&t.Append('"'),t.Append(o),null===(u=this.GetItem(a))?t.Append("null"):u.DoFormatJSON(t,s+1);i?(t.Append(c),t.AppendIndent(s),t.Append("}")):t.Append(this.ObjEndSeps[+n])}else t.Append("{}")},this.Create$2=function(){return this.FHash=new Object,this},this.Create$3=function(s){var i=0,r="",n=null;for(this.Create$2(),(rtl.length(s)-1-0)%2==0&&this.$class.DoError(rtl.getResStr(e,"SErrOddNumber")),i=0;i<=rtl.length(s)-1;)rtl.isString(s[i])?r=""+s[i]:this.$class.DoError$1(rtl.getResStr(e,"SErrNameMustBeString"),I(0,i+1)),""===r&&this.$class.DoError$1(rtl.getResStr(e,"SErrNameMustBeString"),I(0,i+1)),i+=1,n=t.VarRecToJSON(s[i],"Object"),this.Add(r,n),i+=1;return this},this.Destroy=function(){this.FHash=null,F.Destroy.call(this)},this.JSONType=function(){return 6},this.IndexOfName=function(e,t){var s=0;if(0===rtl.length(this.FNames)&&(this.FNames=Object.getOwnPropertyNames(this.FHash)),(s=this.FNames.indexOf("%"+e))<0&&t)for(s=this.GetCount()-1;s>=0&&0!==A(this.GetNameOf(s),e);)s-=1;return s},this.Clear=function(){this.FCount=0,this.FHash=new Object,this.FNames=[]},this.Add=function(e,t){return this.DoAdd(e,t,!1)},this.Add$3=function(t,s){return this.DoAdd(t,e.CreateJSON$5(s),!0)},this.Add$5=function(t,s){return this.DoAdd(t,e.CreateJSON$2(s),!0)},this.Add$7=function(e,t){return this.DoAdd(e,t,!1)}}),rtl.createClass(this,"EJSON",N,function(){f=this}),this.StringToJSONString=function(e,t){var s="";return s=JSON.stringify(e),t&&(s=s.replaceAll("/","\\\\\\/")),s},this.CreateJSON=function(){return t.DefaultJSONInstanceTypes[6].$create("Create$1")},this.CreateJSON$1=function(e){return t.DefaultJSONInstanceTypes[5].$create("Create$2",[e])},this.CreateJSON$2=function(e){return t.DefaultJSONInstanceTypes[1].$create("Create$2",[e])},this.CreateJSON$3=function(e){return t.DefaultJSONInstanceTypes[2].$create("Create$2",[e])},this.CreateJSON$4=function(e){return t.DefaultJSONInstanceTypes[3].$create("Create$2",[e])},this.CreateJSON$5=function(e){return t.DefaultJSONInstanceTypes[4].$create("Create$2",[e])},e.$implcode=function(){t.JSONFormatSettings=x.$clone({CurrencyFormat:1,NegCurrFormat:5,ThousandSeparator:",",DecimalSeparator:".",CurrencyDecimals:2,DateSeparator:"-",TimeSeparator:":",ListSeparator:",",CurrencyString:"$",ShortDateFormat:"d/m/y",LongDateFormat:'dd" "mmmm" "yyyy',TimeAMString:"AM",TimePMString:"PM",ShortTimeFormat:"hh:nn",LongTimeFormat:"hh:nn:ss",ShortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],LongMonthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],ShortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],LongDayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],TwoDigitYearCenturyWindow:50,DateTimeToStrFormat:rtl.arraySetLength(null,"",2)}),t.DefaultJSONInstanceTypes=[s,l,a,n,o,h,u,c,p],t.VarRecToJSON=function(t,i){var r=null,n=0,l=null;return r=null,null==t?r=e.CreateJSON():O(t)?r=e.CreateJSON$1(!(0==t)):rtl.isString(t)?r=e.CreateJSON$5(""+t):rtl.isNumber(t)?r=k(t)?(n=rtl.trunc(t))>=-2147483648&&n<=2147483647?e.CreateJSON$2(rtl.trunc(t)):e.CreateJSON$3(rtl.trunc(t)):e.CreateJSON$4(rtl.getNumber(t)):rtl.isObject(t)&&rtl.isExt(t,F,1)?(l=rtl.getObject(t),s.isPrototypeOf(l)?r=l:s.DoError$1(rtl.getResStr(e,"SErrNotJSONData"),I(18,l.$classname,18,i))):s.DoError$1(rtl.getResStr(e,"SErrUnknownTypeInConstructor"),I(18,i,18,typeof t)),r},e.$resourcestrings={SErrCannotConvertFromNull:{org:"Cannot convert data from Null value"},SErrCannotConvertToNull:{org:"Cannot convert data to Null value"},SErrCannotConvertFromArray:{org:"Cannot convert data from array value"},SErrCannotConvertToArray:{org:"Cannot convert data to array value"},SErrCannotConvertFromObject:{org:"Cannot convert data from object value"},SErrCannotConvertToObject:{org:"Cannot convert data to object value"},SErrUnknownTypeInConstructor:{org:"Unknown type in JSON%s constructor: %d"},SErrNotJSONData:{org:"Cannot add object of type %s to TJSON%s"},SErrOddNumber:{org:"TJSONObject must be constructed with name,value pairs"},SErrNameMustBeString:{org:"TJSONObject constructor element name at pos %d is not a string"},SErrNonexistentElement:{org:'Unknown object member: "%s"'},SErrDuplicateValue:{org:'Duplicate object member: "%s"'}}},e.$init=function(){s.DetermineElementSeparators(),p.DetermineElementQuotes()}},[]),rtl.module("strutils",["System","SysUtils","Types"],function(){"use strict";var e=this,t=e.$impl,s=pas.System,i=s.Copy,r=s.upcase,n=s.StringOfChar;this.LeftStr=function(e,t){return i(e,1,t)},this.Soundex=function(e,s){var i="",l="\0",a="\0",o=0,h=0;if(i="",a="\0",e.length>0)for(i=r(e.charAt(0)),o=2,h=e.length;o<=h&&i.length<s;)(l=t.SScore.charAt(e.charCodeAt(o-1)-1)).charCodeAt()in rtl.createSet(48,105,a.charCodeAt())||(i+=l),"i"!==l&&(a=l),o+=1;return(h=i.length)<s&&(i+=n("0",s-h)),i},this.SoundexSimilar=function(t,s,i){return e.Soundex(t,i)===e.Soundex(s,i)},this.SoundexSimilar$1=function(t,s){return e.SoundexSimilar(t,s,4)},this.SoundexProc=function(t,s){return e.SoundexSimilar$1(t,s)},this.AnsiResemblesProc=null,this.ResemblesProc=null,e.$implcode=function(){t.SScore="00000000000000000000000000000000000000000000000000000000000000000123012i02245501262301i2i20000000123012i02245501262301i2i20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"},e.$init=function(){e.AnsiResemblesProc=e.SoundexProc,e.ResemblesProc=e.SoundexProc}},["JS"]),rtl.module("PScanner",["System","JS","SysUtils","Classes","Types"],function(){"use strict";var e,t,s,i=this,r=i.$impl,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=pas.System,y=T.TObject,g=T.Copy,E=pas.SysUtils,P=E.IncludeTrailingPathDelimiter,I=pas.Classes,R=I.TStringList,v=T.val,A=T.val$8,N=E.LowerCase,x=E.IntToStr,b=T.VarRecs,O=E.SameText,k=E.StrToInt64Def,$=E.FloatToStr,D=E.EDivByZero,L=E.EZeroDivide,B=E.EMathError,M=E.EIntError,G=E.Exception,w=E.UpperCase,V=E.Trim,U=T.Pos,J=E.CompareText,j=E.IsValidIdent,H=E.Format,W=null,Y=null,z=T.Delete,_=T.upcase,K=E.BoolToStr$1,X=E.TryStrToInt,q=E.ExtractFilePath,Q=E.ExtractFileExt,Z=E.ChangeFileExt,ee=E.ExtractFileName,te=E.TrimRight,se=E.TrimLeft,ie=E.StrToIntDef,re=E.FreeAndNil,ne=I.TFPList,le=pas.JS,ae=le.isBoolean,oe=E.BoolToStr,he=le.isInteger;this.nErrInvalidCharacter=1001,this.nErrOpenString=1002,this.nErrIncludeFileNotFound=1003,this.nErrIfXXXNestingLimitReached=1004,this.nErrInvalidPPElse=1005,this.nErrInvalidPPEndif=1006,this.nLogOpeningFile=1007,this.nLogLineNumber=1008,this.nLogIFDefAccepted=1009,this.nLogIFDefRejected=1010,this.nLogIFNDefAccepted=1011,this.nLogIFNDefRejected=1012,this.nLogIFAccepted=1013,this.nLogIFRejected=1014,this.nLogIFOptAccepted=1015,this.nLogIFOptRejected=1016,this.nLogELSEIFAccepted=1017,this.nLogELSEIFRejected=1018,this.nErrInvalidMode=1019,this.nErrInvalidModeSwitch=1020,this.nErrXExpectedButYFound=1021,this.nErrRangeCheck=1022,this.nErrDivByZero=1023,this.nErrOperandAndOperatorMismatch=1024,this.nUserDefined=1025,this.nLogMacroDefined=1026,this.nLogMacroUnDefined=1027,this.nWarnIllegalCompilerDirectiveX=1028,this.nIllegalStateForWarnDirective=1027,this.nErrIncludeLimitReached=1028,this.nMisplacedGlobalCompilerSwitch=1029,this.nLogMacroXSetToY=1030,this.nInvalidDispatchFieldName=1031,this.nErrWrongSwitchToggle=1032,this.nNoResourceSupport=1033,this.nResourceFileNotFound=1034,this.nErrInvalidMultiLineLineEnding=1035,this.nWarnIgnoringLinkLib=1036,this.nErrInvalidIndent=1037,this.nErrMultilineNonWhiteSpaceBeforeClosing=1038,this.TMessageType={0:"mtFatal",mtFatal:0,1:"mtError",mtError:1,2:"mtWarning",mtWarning:2,3:"mtNote",mtNote:3,4:"mtHint",mtHint:4,5:"mtInfo",mtInfo:5,6:"mtDebug",mtDebug:6},this.TToken={0:"tkEOF",tkEOF:0,1:"tkWhitespace",tkWhitespace:1,2:"tkComment",tkComment:2,3:"tkIdentifier",tkIdentifier:3,4:"tkString",tkString:4,5:"tkStringMultiLine",tkStringMultiLine:5,6:"tkNumber",tkNumber:6,7:"tkChar",tkChar:7,8:"tkBraceOpen",tkBraceOpen:8,9:"tkBraceClose",tkBraceClose:9,10:"tkMul",tkMul:10,11:"tkPlus",tkPlus:11,12:"tkComma",tkComma:12,13:"tkMinus",tkMinus:13,14:"tkDot",tkDot:14,15:"tkDivision",tkDivision:15,16:"tkColon",tkColon:16,17:"tkSemicolon",tkSemicolon:17,18:"tkLessThan",tkLessThan:18,19:"tkEqual",tkEqual:19,20:"tkGreaterThan",tkGreaterThan:20,21:"tkAt",tkAt:21,22:"tkSquaredBraceOpen",tkSquaredBraceOpen:22,23:"tkSquaredBraceClose",tkSquaredBraceClose:23,24:"tkCaret",tkCaret:24,25:"tkBackslash",tkBackslash:25,26:"tkDotDot",tkDotDot:26,27:"tkAssign",tkAssign:27,28:"tkNotEqual",tkNotEqual:28,29:"tkLessEqualThan",tkLessEqualThan:29,30:"tkGreaterEqualThan",tkGreaterEqualThan:30,31:"tkPower",tkPower:31,32:"tkSymmetricalDifference",tkSymmetricalDifference:32,33:"tkAssignPlus",tkAssignPlus:33,34:"tkAssignMinus",tkAssignMinus:34,35:"tkAssignMul",tkAssignMul:35,36:"tkAssignDivision",tkAssignDivision:36,37:"tkAtAt",tkAtAt:37,38:"tkDotDotDot",tkDotDotDot:38,39:"tkabsolute",tkabsolute:39,40:"tkand",tkand:40,41:"tkarray",tkarray:41,42:"tkas",tkas:42,43:"tkasm",tkasm:43,44:"tkbegin",tkbegin:44,45:"tkbitpacked",tkbitpacked:45,46:"tkcase",tkcase:46,47:"tkclass",tkclass:47,48:"tkconst",tkconst:48,49:"tkconstref",tkconstref:49,50:"tkconstructor",tkconstructor:50,51:"tkcontains",tkcontains:51,52:"tkdestructor",tkdestructor:52,53:"tkdispinterface",tkdispinterface:53,54:"tkdiv",tkdiv:54,55:"tkdo",tkdo:55,56:"tkdownto",tkdownto:56,57:"tkelse",tkelse:57,58:"tkend",tkend:58,59:"tkexcept",tkexcept:59,60:"tkexports",tkexports:60,61:"tkfalse",tkfalse:61,62:"tkfile",tkfile:62,63:"tkfinalization",tkfinalization:63,64:"tkfinally",tkfinally:64,65:"tkfor",tkfor:65,66:"tkfunction",tkfunction:66,67:"tkgeneric",tkgeneric:67,68:"tkgoto",tkgoto:68,69:"tkif",tkif:69,70:"tkimplementation",tkimplementation:70,71:"tkin",tkin:71,72:"tkinherited",tkinherited:72,73:"tkinitialization",tkinitialization:73,74:"tkinline",tkinline:74,75:"tkinterface",tkinterface:75,76:"tkis",tkis:76,77:"tklabel",tklabel:77,78:"tklibrary",tklibrary:78,79:"tkmod",tkmod:79,80:"tknil",tknil:80,81:"tknot",tknot:81,82:"tkobjccategory",tkobjccategory:82,83:"tkobjcclass",tkobjcclass:83,84:"tkobjcprotocol",tkobjcprotocol:84,85:"tkobject",tkobject:85,86:"tkof",tkof:86,87:"tkoperator",tkoperator:87,88:"tkor",tkor:88,89:"tkotherwise",tkotherwise:89,90:"tkpacked",tkpacked:90,91:"tkPackage",tkPackage:91,92:"tkprocedure",tkprocedure:92,93:"tkprogram",tkprogram:93,94:"tkproperty",tkproperty:94,95:"tkraise",tkraise:95,96:"tkrecord",tkrecord:96,97:"tkrepeat",tkrepeat:97,98:"tkrequires",tkrequires:98,99:"tkResourceString",tkResourceString:99,100:"tkself",tkself:100,101:"tkset",tkset:101,102:"tkshl",tkshl:102,103:"tkshr",tkshr:103,104:"tkspecialize",tkspecialize:104,105:"tkthen",tkthen:105,106:"tkthreadvar",tkthreadvar:106,107:"tkto",tkto:107,108:"tktrue",tktrue:108,109:"tktry",tktry:109,110:"tktype",tktype:110,111:"tkunit",tkunit:111,112:"tkuntil",tkuntil:112,113:"tkuses",tkuses:113,114:"tkvar",tkvar:114,115:"tkwhile",tkwhile:115,116:"tkwith",tkwith:116,117:"tkxor",tkxor:117,118:"tkLineEnding",tkLineEnding:118,119:"tkTab",tkTab:119},e=this.TModeSwitch={0:"msNone",msNone:0,1:"msFpc",msFpc:1,2:"msObjfpc",msObjfpc:2,3:"msDelphi",msDelphi:3,4:"msDelphiUnicode",msDelphiUnicode:4,5:"msTP7",msTP7:5,6:"msMac",msMac:6,7:"msIso",msIso:7,8:"msExtpas",msExtpas:8,9:"msGPC",msGPC:9,10:"msClass",msClass:10,11:"msObjpas",msObjpas:11,12:"msResult",msResult:12,13:"msStringPchar",msStringPchar:13,14:"msCVarSupport",msCVarSupport:14,15:"msNestedComment",msNestedComment:15,16:"msTPProcVar",msTPProcVar:16,17:"msMacProcVar",msMacProcVar:17,18:"msRepeatForward",msRepeatForward:18,19:"msPointer2Procedure",msPointer2Procedure:19,20:"msAutoDeref",msAutoDeref:20,21:"msInitFinal",msInitFinal:21,22:"msDefaultAnsistring",msDefaultAnsistring:22,23:"msOut",msOut:23,24:"msDefaultPara",msDefaultPara:24,25:"msHintDirective",msHintDirective:25,26:"msDuplicateNames",msDuplicateNames:26,27:"msProperty",msProperty:27,28:"msDefaultInline",msDefaultInline:28,29:"msExcept",msExcept:29,30:"msObjectiveC1",msObjectiveC1:30,31:"msObjectiveC2",msObjectiveC2:31,32:"msNestedProcVars",msNestedProcVars:32,33:"msNonLocalGoto",msNonLocalGoto:33,34:"msAdvancedRecords",msAdvancedRecords:34,35:"msISOLikeUnaryMinus",msISOLikeUnaryMinus:35,36:"msSystemCodePage",msSystemCodePage:36,37:"msFinalFields",msFinalFields:37,38:"msDefaultUnicodestring",msDefaultUnicodestring:38,39:"msTypeHelpers",msTypeHelpers:39,40:"msCBlocks",msCBlocks:40,41:"msISOLikeIO",msISOLikeIO:41,42:"msISOLikeProgramsPara",msISOLikeProgramsPara:42,43:"msISOLikeMod",msISOLikeMod:43,44:"msArrayOperators",msArrayOperators:44,45:"msMultiHelpers",msMultiHelpers:45,46:"msArray2DynArray",msArray2DynArray:46,47:"msPrefixedAttributes",msPrefixedAttributes:47,48:"msUnderscoreIsSeparator",msUnderscoreIsSeparator:48,49:"msImplicitFunctionSpec",msImplicitFunctionSpec:49,50:"msFunctionReferences",msFunctionReferences:50,51:"msAnonymousFunctions",msAnonymousFunctions:51,52:"msExternalClass",msExternalClass:52,53:"msOmitRTTI",msOmitRTTI:53,54:"msMultiLineStrings",msMultiLineStrings:54,55:"msDelphiMultiLineStrings",msDelphiMultiLineStrings:55,56:"msInlineVars",msInlineVars:56},t=this.TBoolSwitch={0:"bsNone",bsNone:0,1:"bsAlign",bsAlign:1,2:"bsBoolEval",bsBoolEval:2,3:"bsAssertions",bsAssertions:3,4:"bsDebugInfo",bsDebugInfo:4,5:"bsExtension",bsExtension:5,6:"bsImportedData",bsImportedData:6,7:"bsLongStrings",bsLongStrings:7,8:"bsIOChecks",bsIOChecks:8,9:"bsWriteableConst",bsWriteableConst:9,10:"bsLocalSymbols",bsLocalSymbols:10,11:"bsTypeInfo",bsTypeInfo:11,12:"bsOptimization",bsOptimization:12,13:"bsOpenStrings",bsOpenStrings:13,14:"bsOverflowChecks",bsOverflowChecks:14,15:"bsRangeChecks",bsRangeChecks:15,16:"bsTypedAddress",bsTypedAddress:16,17:"bsSafeDivide",bsSafeDivide:17,18:"bsVarStringChecks",bsVarStringChecks:18,19:"bsStackframes",bsStackframes:19,20:"bsExtendedSyntax",bsExtendedSyntax:20,21:"bsReferenceInfo",bsReferenceInfo:21,22:"bsHints",bsHints:22,23:"bsNotes",bsNotes:23,24:"bsWarnings",bsWarnings:24,25:"bsMacro",bsMacro:25,26:"bsScopedEnums",bsScopedEnums:26,27:"bsObjectChecks",bsObjectChecks:27,28:"bsPointerMath",bsPointerMath:28,29:"bsGoto",bsGoto:29},this.LetterToBoolSwitch=[1,2,3,4,5,0,6,7,8,9,0,10,11,0,12,13,14,15,0,16,17,18,19,20,21,0],this.bsAll=rtl.createSet(null,t.bsNone,t.bsGoto),this.bsFPCMode=rtl.createSet(28,9),this.bsObjFPCMode=rtl.createSet(28,9),this.bsDelphiMode=rtl.createSet(9,29),this.bsDelphiUnicodeMode=rtl.createSet(9,29),this.bsMacPasMode=rtl.createSet(28,9),s=this.TValueSwitch={0:"vsInterfaces",vsInterfaces:0,1:"vsDispatchField",vsDispatchField:1,2:"vsDispatchStrField",vsDispatchStrField:2},this.vsAllValueSwitches=rtl.createSet(null,s.vsInterfaces,s.vsDispatchStrField),this.DefaultValueSwitches=["com","Msg","MsgStr"],this.DefaultMaxIncludeStackDepth=20,this.TWarnMsgState={0:"wmsDefault",wmsDefault:0,1:"wmsOn",wmsOn:1,2:"wmsOff",wmsOff:2,3:"wmsError",wmsError:3},this.TTokenOption={0:"toForceCaret",toForceCaret:0,1:"toOperatorToken",toOperatorToken:1},rtl.createClass(this,"TMacroDef",y,function(){n=this,this.$init=function(){y.$init.call(this),this.FName="",this.FValue=""},this.Create$1=function(e,t){return this.FName=e,this.FValue=t,this}}),this.TEOLStyle={0:"elPlatform",elPlatform:0,1:"elSource",elSource:1,2:"elLF",elLF:2,3:"elCR",elCR:3,4:"elCRLF",elCRLF:4},rtl.createClass(this,"TLineReader",y,function(){l=this,this.$init=function(){y.$init.call(this),this.FFilename="",this.EOLStyle=0},this.Create$1=function(e){return this.FFilename=e,"\r"===T.LineEnding?this.EOLStyle=3:"\r\n"===T.LineEnding?this.EOLStyle=4:this.EOLStyle=2,this},this.LastEOLStyle=function(){return this.EOLStyle}}),rtl.createClass(this,"TStreamLineReader",l,function(){a=this,this.$init=function(){l.$init.call(this),this.FContent="",this.FPos=0},this.InitFromString=function(e){this.FContent=e,this.FPos=0},this.IsEOF=function(){return this.FPos>=this.FContent.length},this.ReadLine=function(){var e,t="",s=!1;if(this.IsEOF())return"";e=this.FPos+1;do{this.FPos+=1,s=this.FContent.charCodeAt(this.FPos-1)in rtl.createSet(10,13)}while(!this.IsEOF()&&!s);return s?("\n"===this.FContent.charAt(this.FPos-1)?this.EOLStyle=2:this.EOLStyle=3,t=g(this.FContent,e,this.FPos-e)):t=g(this.FContent,e,this.FPos-e+1),this.IsEOF()||"\r"!==this.FContent.charAt(this.FPos-1)||"\n"!==this.FContent.charAt(this.FPos+1-1)||(this.FPos+=1,this.EOLStyle=4),t}}),rtl.createClass(this,"TStringStreamLineReader",a,function(){o=this,this.Create$2=function(e,t){return l.Create$1.call(this,e),this.InitFromString(t),this}}),rtl.createClass(this,"TMacroReader",o,function(){h=this,this.$init=function(){o.$init.call(this),this.FCurCol=0,this.FCurRow=0}}),rtl.createClass(this,"TBaseFileResolver",y,function(){this.$init=function(){y.$init.call(this),this.FBaseDirectory="",this.FMode=0,this.FModuleDirectory="",this.FResourcePaths=null,this.FIncludePaths=null},this.$final=function(){this.FResourcePaths=void 0,this.FIncludePaths=void 0,y.$final.call(this)},this.SetBaseDirectory=function(e){e=P(e),this.FBaseDirectory!==e&&(this.FBaseDirectory=e)},this.Create$1=function(){return y.Create.call(this),this.FIncludePaths=R.$create("Create$1"),this.FResourcePaths=R.$create("Create$1"),this.FMode=1,this},this.Destroy=function(){rtl.free(this,"FResourcePaths"),rtl.free(this,"FIncludePaths"),y.Destroy.call(this)}}),this.CondDirectiveBool=["0","1"],this.MACDirectiveBool=["FALSE","TRUE"],rtl.createClass(this,"TCondDirectiveEvaluator",y,function(){u=this,c=this.TPrecedenceLevel={0:"ceplFirst",ceplFirst:0,1:"ceplSecond",ceplSecond:1,2:"ceplThird",ceplThird:2,3:"ceplFourth",ceplFourth:3},rtl.recNewT(this,"TStackItem",function(){p=this,this.Level=0,this.Operathor=0,this.Operand="",this.OperandPos=0,this.$eq=function(e){return this.Level===e.Level&&this.Operathor===e.Operathor&&this.Operand===e.Operand&&this.OperandPos===e.OperandPos},this.$assign=function(e){return this.Level=e.Level,this.Operathor=e.Operathor,this.Operand=e.Operand,this.OperandPos=e.OperandPos,this}}),this.$init=function(){y.$init.call(this),this.FOnEvalFunction=null,this.FOnEvalVariable=null,this.FOnLog=null,this.FTokenStart=0,this.FTokenEnd=0,this.FToken=0,this.FStack=[],this.FStackTop=0,this.Expression="",this.MsgCurLine=0,this.MsgNumber=0,this.MsgType=0,this.MsgPattern="",this.isMac=!1},this.$final=function(){this.FOnEvalFunction=void 0,this.FOnEvalVariable=void 0,this.FOnLog=void 0,this.FStack=void 0,y.$final.call(this)},this.IsFalse=function(e){var t=!1;return!(t=e===i.CondDirectiveBool[0])&&this.isMac&&(t=e===i.MACDirectiveBool[0]),t},this.IsTrue=function(e){var t=!1;return(t=e!==i.CondDirectiveBool[0])&&this.isMac&&(t=e!==i.MACDirectiveBool[0]),t},this.IsInteger=function(e,t){var s=0;return v(e,t,{get:function(){return s},set:function(e){s=e}}),0===s},this.IsExtended=function(e,t){var s=0;return A(e,t,{get:function(){return s},set:function(e){s=e}}),0===s};var e=rtl.createSet(null,97,122,null,65,90,95,null,48,57),t=rtl.createSet(9,10,13,32),s=rtl.createSet(null,48,57),r=rtl.createSet(null,48,57);this.NextToken=function(){var n=this;var l,a="";for(this.FTokenStart=this.FTokenEnd,l=(a=this.Expression).length;this.FTokenStart<=l&&a.charCodeAt(this.FTokenStart-1)in t;)this.FTokenStart+=1;if(this.FTokenStart>l)return this.FToken=0,void(this.FTokenEnd=this.FTokenStart);this.FTokenEnd=this.FTokenStart;var o=a.charAt(this.FTokenEnd-1);if(o>="a"&&o<="z"||o>="A"&&o<="Z"||"_"===o){for(this.FTokenEnd+=1;this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in e;)this.FTokenEnd+=1;this.FToken=function(){var e=0;e=3;var t=N(g(n.Expression,n.FTokenStart,n.FTokenEnd-n.FTokenStart));return"or"===t?e=88:"not"===t?e=81:"and"===t?e=40:"xor"===t?e=117:"shl"===t?e=102:"shr"===t?e=103:"mod"===t?e=79:"div"===t&&(e=54),e}()}else if(o>="0"&&o<="9"){for(this.FToken=6,this.FTokenEnd+=1;this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in s;)this.FTokenEnd+=1;if(this.FTokenEnd<=l&&"."===a.charAt(this.FTokenEnd-1)&&(this.FTokenEnd===l||"."!==a.charAt(this.FTokenEnd+1-1)))for(this.FTokenEnd+=1;this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in s;)this.FTokenEnd+=1;if(this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in rtl.createSet(101,69)){this.FTokenEnd+=1,this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in rtl.createSet(45,43)&&(this.FTokenEnd+=1);for(;this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in s;)this.FTokenEnd+=1}}else if("$"===o)for(this.FToken=6,this.FTokenEnd+=1;this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in r;)this.FTokenEnd+=1;else if("%"===o)for(this.FToken=6;this.FTokenEnd<=l&&a.charCodeAt(this.FTokenEnd-1)in rtl.createSet(48,49);)this.FTokenEnd+=1;else if("("===o)this.FToken=8,this.FTokenEnd+=1;else if(")"===o)this.FToken=9,this.FTokenEnd+=1;else if("="===o)this.FToken=19,this.FTokenEnd+=1;else if("<"===o){this.FTokenEnd+=1;var h=g(a,this.FTokenEnd,1);"="===h?(this.FToken=29,this.FTokenEnd+=1):"<"===h?(this.FToken=102,this.FTokenEnd+=1):">"===h?(this.FToken=28,this.FTokenEnd+=1):this.FToken=18}else if(">"===o){this.FTokenEnd+=1;var u=g(a,this.FTokenEnd,1);"="===u?(this.FToken=30,this.FTokenEnd+=1):">"===u?(this.FToken=103,this.FTokenEnd+=1):this.FToken=20}else if("+"===o)this.FToken=11,this.FTokenEnd+=1;else if("-"===o)this.FToken=13,this.FTokenEnd+=1;else if("*"===o)this.FToken=10,this.FTokenEnd+=1;else if("/"===o)this.FToken=15,this.FTokenEnd+=1;else if("'"===o)for(this.FToken=4;;){this.FTokenEnd+=1,this.FTokenEnd>l&&this.Log(1,1002,rtl.getResStr(i,"SErrOpenString"),[],0);var c=a.charAt(this.FTokenEnd-1);if("'"===c){if(this.FTokenEnd+=1,this.FTokenEnd>l||"'"!==a.charAt(this.FTokenEnd-1))break}else"\n"!==c&&"\r"!==c||this.Log(1,1002,rtl.getResStr(i,"SErrOpenString"),[],0)}else this.FToken=0},this.Log=function(e,t,s,i,r){if(r<1&&(r=this.FTokenEnd),this.MsgType=e,this.MsgNumber=t,this.MsgPattern=s,null==this.FOnLog||(this.FOnLog(this,i),e in rtl.createSet(1,0)))throw f.$create("CreateFmt",[this.MsgPattern+" at pos "+x(r)+" line "+x(this.MsgCurLine),i])},this.LogXExpectedButTokenFound=function(e,t){var s;s=e,this.Log(1,1021,rtl.getResStr(i,"SErrXExpectedButYFound"),b(18,s,18,i.TokenInfos[this.FToken]),t)},this.ReadOperand=function(e){var t=this;function s(e){return O(e,"DEFINED")||O(e,"UNDEFINED")}var r=0,n=0,l="",a="",o="",h=0,u=0,c=0,p=0,f=this.FToken;if(81===f)this.NextToken(),this.ReadOperand(e),e||(this.FStack[this.FStackTop].Operand=i.CondDirectiveBool[+this.IsFalse(this.FStack[this.FStackTop].Operand)]);else if(13===f)this.NextToken(),this.ReadOperand(e),e||(r=k(this.FStack[this.FStackTop].Operand,0),this.FStack[this.FStackTop].Operand=x(-r));else if(11===f)this.NextToken(),this.ReadOperand(e),e||(r=k(this.FStack[this.FStackTop].Operand,0),this.FStack[this.FStackTop].Operand=x(r));else if(6===f)e||(l=this.GetTokenString(),v(l,{get:function(){return r},set:function(e){r=e}},{get:function(){return h},set:function(e){h=e}}),0===h?this.Push(x(r),this.FTokenStart):(A(l,{get:function(){return n},set:function(e){n=e}},{get:function(){return h},set:function(e){h=e}}),h>0&&this.Log(1,1022,rtl.getResStr(i,"SErrRangeCheck"),[],0),this.Push(l,this.FTokenStart))),this.NextToken();else if(4===f)e||this.Push(this.GetStringLiteralValue(),this.FTokenStart),this.NextToken();else if(3===f)e?(a=this.GetTokenString(),this.NextToken(),8===this.FToken?(this.NextToken(),3===this.FToken&&this.NextToken(),9!==this.FToken&&this.LogXExpectedButTokenFound(")",0),this.NextToken()):this.isMac&&s(a)&&this.NextToken()):(a=this.GetTokenString(),c=this.FTokenStart,this.NextToken(),8===this.FToken?(u=this.FTokenStart,this.NextToken(),o="",3===this.FToken&&(o=this.GetTokenString(),this.NextToken()),9!==this.FToken&&this.LogXExpectedButTokenFound(")",0),this.FOnEvalFunction(t,a,o,{get:function(){return l},set:function(e){l=e}})||(this.FTokenStart=u,this.FTokenEnd=this.FTokenStart+a.length,this.LogXExpectedButTokenFound("function",0)),this.Push(l,c),this.NextToken()):this.isMac&&s(a)?(3!==this.FToken&&this.LogXExpectedButTokenFound("identifier",0),a=this.GetTokenString(),this.Push(i.CondDirectiveBool[+this.FOnEvalVariable(t,a,{get:function(){return l},set:function(e){l=e}})],c),this.NextToken()):this.FOnEvalVariable(t,a,{get:function(){return l},set:function(e){l=e}})?this.Push(l,c):this.Push(i.CondDirectiveBool[0],c));else if(8===f){if(this.NextToken(),e)for(p=1;;){var d=this.FToken;if(0===d)this.LogXExpectedButTokenFound(")",0);else if(8===d)p+=1;else if(9===d&&0===(p-=1))break;this.NextToken()}else this.ReadExpression(),9!==this.FToken&&this.LogXExpectedButTokenFound(")",0);this.NextToken()}else this.LogXExpectedButTokenFound("identifier",0)},this.ReadExpression=function(){var e=this,t=0;function s(s,i){e.ResolveStack(t,s,i),e.NextToken(),e.ReadOperand(!1)}for(t=this.FStackTop,this.ReadOperand(!1);;){var i=this.FToken;if(0===i||9===i)return void this.ResolveStack(t,c.ceplFourth,0);if(40===i)if(this.ResolveStack(t,1,40),this.NextToken(),this.FStackTop===t+1&&this.IsFalse(this.FStack[this.FStackTop].Operand)){for(;;){if(this.ReadOperand(!0),40!==this.FToken)break;this.NextToken()}this.FStack[this.FStackTop].Operathor=0}else this.ReadOperand(!1);else if(10===i||15===i||54===i||79===i||102===i||103===i)s(1,this.FToken);else if(88===i)if(this.ResolveStack(t,2,88),this.NextToken(),this.FStackTop===t+1&&this.IsTrue(this.FStack[this.FStackTop].Operand)){for(;;){if(this.ReadOperand(!0),!(this.FToken in rtl.createSet(40,88)))break;this.NextToken()}this.FStack[this.FStackTop].Operathor=0}else this.ReadOperand(!1);else 11===i||13===i||117===i?s(2,this.FToken):19===i||28===i||18===i||20===i||29===i||30===i?s(3,this.FToken):this.LogXExpectedButTokenFound("operator",0)}},this.ResolveStack=function(e,t,s){for(var r="",n="",l="",a=0,o=0,h=0,u=0,c=0,p=0;this.FStackTop>e+1&&this.FStack[this.FStackTop-1].Level<=t;){n=this.FStack[this.FStackTop].Operand,p=this.FStack[this.FStackTop].OperandPos,this.FStackTop-=1,a=this.FStack[this.FStackTop].Operathor,r=this.FStack[this.FStackTop].Operand;try{var f=a;if(40===f)l=i.CondDirectiveBool[+(this.IsTrue(r)&&this.IsTrue(n))];else if(88===f)l=i.CondDirectiveBool[+(this.IsTrue(r)||this.IsTrue(n))];else if(117===f)l=i.CondDirectiveBool[+(this.IsTrue(r)^this.IsTrue(n))];else if(10===f||54===f||79===f||102===f||103===f||11===f||13===f)if(this.IsInteger(r,{get:function(){return o},set:function(e){o=e}}))if(this.IsInteger(n,{get:function(){return h},set:function(e){h=e}})){var d=a;10===d?l=x(o*h):54===d?l=x(rtl.trunc(o/h)):79===d?l=x(o%h):102===d?l=x(rtl.shl(o,h)):103===d?l=x(rtl.shr(o,h)):11===d?l=x(o+h):13===d&&(l=x(o-h))}else if(this.IsExtended(n,{get:function(){return c},set:function(e){c=e}})){var F=a;10===F?l=$(o*c):11===F?l=$(o+c):13===F?l=$(o-c):this.LogXExpectedButTokenFound("integer",p)}else this.LogXExpectedButTokenFound("integer",p);else if(this.IsExtended(r,{get:function(){return u},set:function(e){u=e}}))if(this.IsExtended(n,{get:function(){return c},set:function(e){c=e}})){var m=a;10===m?l=$(u*c):11===m?l=$(u+c):13===m?l=$(u-c):this.LogXExpectedButTokenFound("float",p)}else this.LogXExpectedButTokenFound("float",p);else this.Log(1,1024,rtl.getResStr(i,"SErrOperandAndOperatorMismatch"),[],0);else if(15===f)this.IsExtended(r,{get:function(){return u},set:function(e){u=e}})?this.IsExtended(n,{get:function(){return c},set:function(e){c=e}})?l=$(u/c):this.LogXExpectedButTokenFound("float",p):this.Log(1,1024,rtl.getResStr(i,"SErrOperandAndOperatorMismatch"),[],0);else if(19===f||28===f||18===f||20===f||29===f||30===f)if(this.IsInteger(r,{get:function(){return o},set:function(e){o=e}})&&this.IsInteger(n,{get:function(){return h},set:function(e){h=e}})){var C=a;19===C?l=i.CondDirectiveBool[+(o===h)]:28===C?l=i.CondDirectiveBool[+(o!==h)]:18===C?l=i.CondDirectiveBool[+(o<h)]:20===C?l=i.CondDirectiveBool[+(o>h)]:29===C?l=i.CondDirectiveBool[+(o<=h)]:30===C&&(l=i.CondDirectiveBool[+(o>=h)])}else if(this.IsExtended(r,{get:function(){return u},set:function(e){u=e}})&&this.IsExtended(n,{get:function(){return c},set:function(e){c=e}})){var S=a;19===S?l=i.CondDirectiveBool[+(u===c)]:28===S?l=i.CondDirectiveBool[+(u!==c)]:18===S?l=i.CondDirectiveBool[+(u<c)]:20===S?l=i.CondDirectiveBool[+(u>c)]:29===S?l=i.CondDirectiveBool[+(u<=c)]:30===S&&(l=i.CondDirectiveBool[+(u>=c)])}else{var T=a;19===T?l=i.CondDirectiveBool[+(r===n)]:28===T?l=i.CondDirectiveBool[+(r!==n)]:18===T?l=i.CondDirectiveBool[+(r<n)]:20===T?l=i.CondDirectiveBool[+(r>n)]:29===T?l=i.CondDirectiveBool[+(r<=n)]:30===T&&(l=i.CondDirectiveBool[+(r>=n)])}else this.Log(1,1024,rtl.getResStr(i,"SErrOperandAndOperatorMismatch"),[],0)}catch(e){if(D.isPrototypeOf(e)){var y=e;this.Log(1,1023,rtl.getResStr(i,"SErrDivByZero"),[],0)}else if(L.isPrototypeOf(e)){y=e;this.Log(1,1023,rtl.getResStr(i,"SErrDivByZero"),[],0)}else if(B.isPrototypeOf(e)){y=e;this.Log(1,1022,rtl.getResStr(i,"SErrRangeCheck")+" "+y.fMessage,[],0)}else{if(!M.isPrototypeOf(e))throw e;y=e;this.Log(1,1022,rtl.getResStr(i,"SErrRangeCheck")+" "+y.fMessage,[],0)}}this.FStack[this.FStackTop].Operand=l,this.FStack[this.FStackTop].OperandPos=p}this.FStack[this.FStackTop].Operathor=s,this.FStack[this.FStackTop].Level=t},this.GetTokenString=function(){return g(this.Expression,this.FTokenStart,this.FTokenEnd-this.FTokenStart)},this.GetStringLiteralValue=function(){var e,t="",s="",r=0,n=0,l="\0";for(t="",r=this.FTokenStart,e=(s=this.Expression).length;;)if(r>e||!(s.charCodeAt(r-1)in rtl.createSet(39,96)))this.Log(1,1001,rtl.getResStr(i,"SErrInvalidCharacter"),b(18,"#0"),0);else{for(l=s.charAt(r-1),n=r+=1;;)if(r>e)this.Log(1,1001,rtl.getResStr(i,"SErrInvalidCharacter"),b(18,"#0"),0);else{if(s.charAt(r-1)===l)break;"'"===l&&s.charCodeAt(r-1)in rtl.createSet(10,13)?this.Log(1,1001,rtl.getResStr(i,"SErrInvalidCharacter"),b(18,"#"+x(s.charCodeAt(r-1))),0):r+=1}r>n&&(t+=g(this.Expression,n,r-n)),r+=1}return t},this.Push=function(e,t){this.FStackTop+=1,this.FStackTop>=rtl.length(this.FStack)&&(this.FStack=rtl.arraySetLength(this.FStack,p,2*rtl.length(this.FStack)+4));var s=this.FStack[this.FStackTop];s.Operand=e,s.OperandPos=t,s.Operathor=0,s.Level=3},this.Create$1=function(e){return this.isMac=e,this},this.Destroy=function(){y.Destroy.call(this)},this.Eval=function(e){return this.Expression=e,this.MsgType=5,this.MsgNumber=0,this.MsgPattern="",""!==e&&(this.FTokenStart=1,this.FTokenEnd=this.FTokenStart,this.FStackTop=-1,this.NextToken(),this.ReadExpression(),this.IsTrue(this.FStack[0].Operand))}}),rtl.createClass(this,"EScannerError",G,function(){f=this}),rtl.createClass(this,"EFileNotFoundError",G,function(){0}),this.TPascalScannerPPSkipMode={0:"ppSkipNone",ppSkipNone:0,1:"ppSkipIfBranch",ppSkipIfBranch:1,2:"ppSkipElseBranch",ppSkipElseBranch:2,3:"ppSkipAll",ppSkipAll:3},this.TPOption={0:"po_delphi",po_delphi:0,1:"po_KeepScannerError",po_KeepScannerError:1,2:"po_CAssignments",po_CAssignments:2,3:"po_ResolveStandardTypes",po_ResolveStandardTypes:3,4:"po_AsmWhole",po_AsmWhole:4,5:"po_NoOverloadedProcs",po_NoOverloadedProcs:5,6:"po_KeepClassForward",po_KeepClassForward:6,7:"po_ArrayRangeExpr",po_ArrayRangeExpr:7,8:"po_SelfToken",po_SelfToken:8,9:"po_CheckModeSwitches",po_CheckModeSwitches:9,10:"po_CheckCondFunction",po_CheckCondFunction:10,11:"po_StopOnErrorDirective",po_StopOnErrorDirective:11,12:"po_ExtConstWithoutExpr",po_ExtConstWithoutExpr:12,13:"po_StopOnUnitInterface",po_StopOnUnitInterface:13,14:"po_IgnoreUnknownResource",po_IgnoreUnknownResource:14,15:"po_AsyncProcs",po_AsyncProcs:15,16:"po_DisableResources",po_DisableResources:16,17:"po_AsmPascalComments",po_AsmPascalComments:17,18:"po_AllowMem",po_AllowMem:18,19:"po_WarnResourceNotFound",po_WarnResourceNotFound:19,20:"po_CheckDirectiveRTTI",po_CheckDirectiveRTTI:20},rtl.recNewT(this,"TPasSourcePos",function(){d=this,this.FileName="",this.Row=0,this.Column=0,this.$eq=function(e){return this.FileName===e.FileName&&this.Row===e.Row&&this.Column===e.Column},this.$assign=function(e){return this.FileName=e.FileName,this.Row=e.Row,this.Column=e.Column,this}}),this.DefPasSourcePos=d.$clone({FileName:"",Row:0,Column:0}),this.TPScannerLogEvent={0:"sleFile",sleFile:0,1:"sleLineNumber",sleLineNumber:1,2:"sleConditionals",sleConditionals:2,3:"sleDirective",sleDirective:3},rtl.createClass(this,"TPascalScanner",y,function(){rtl.recNewT(this,"TResourceHandlerRecord",function(){F=this,this.Ext="",this.Handler=null,this.$eq=function(e){return this.Ext===e.Ext&&rtl.eqCallback(this.Handler,e.Handler)},this.$assign=function(e){return this.Ext=e.Ext,this.Handler=e.Handler,this}}),rtl.recNewT(this,"TDirectiveHandlerRecord",function(){m=this,this.Directive="",this.Handler=null,this.$eq=function(e){return this.Directive===e.Directive&&rtl.eqCallback(this.Handler,e.Handler)},this.$assign=function(e){return this.Directive=e.Directive,this.Handler=e.Handler,this}}),rtl.recNewT(this,"TWarnMsgNumberState",function(){C=this,this.Number=0,this.State=0,this.$eq=function(e){return this.Number===e.Number&&this.State===e.State},this.$assign=function(e){return this.Number=e.Number,this.State=e.State,this}}),this.$init=function(){y.$init.call(this),this.FAllowedBoolSwitches={},this.FAllowedModeSwitches={},this.FAllowedValueSwitches={},this.FConditionEval=null,this.FCurModulename="",this.FCurrentBoolSwitches={},this.FCurrentModeSwitches={},this.FCurrentValueSwitches=rtl.arraySetLength(null,"",3),this.FCurtokenEscaped=!1,this.FCurTokenPos=d.$new(),this.FLastMsg="",this.FLastMsgArgs=[],this.FLastMsgNumber=0,this.FLastMsgPattern="",this.FLastMsgType=0,this.FFileResolver=null,this.FCurSourceFile=null,this.FCurFilename="",this.FCurRow=0,this.FCurColumnOffset=0,this.FCurToken=0,this.FCurTokenString="",this.FCurLine="",this.FMaxIncludeStackDepth=0,this.FModuleRow=0,this.FMacros=null,this.FDefines=null,this.FMultilineStringsEOLStyle=0,this.FMultilineStringsTrimLeft=0,this.FNonTokens={},this.FOnComment=null,this.FOnDirective=null,this.FOnDirectiveForConditionals=!1,this.FOnEvalFunction=null,this.FOnEvalVariable=null,this.FOnFormatPath=null,this.FOnLinkLib=null,this.FOnModeChanged=null,this.FOnWarnDirective=null,this.FOptions={},this.FLogEvents={},this.FOnLog=null,this.FPreviousToken=0,this.FReadOnlyBoolSwitches={},this.FReadOnlyModeSwitches={},this.FReadOnlyValueSwitches={},this.FSkipComments=!1,this.FSkipGlobalSwitches=!1,this.FSkipWhiteSpace=!1,this.FTokenOptions={},this.FTokenPos=0,this.FIncludeStack=null,this.FFiles=null,this.FWarnMsgStates=[],this.FResourceHandlers=[],this.FDirectiveHandles=[],this.PPSkipMode=0,this.PPIsSkipping=!1,this.PPSkipStackIndex=0,this.PPSkipModeStack=rtl.arraySetLength(null,0,256),this.PPIsSkippingStack=rtl.arraySetLength(null,!1,256)},this.$final=function(){this.FAllowedBoolSwitches=void 0,this.FAllowedModeSwitches=void 0,this.FAllowedValueSwitches=void 0,this.FConditionEval=void 0,this.FCurrentBoolSwitches=void 0,this.FCurrentModeSwitches=void 0,this.FCurrentValueSwitches=void 0,this.FCurTokenPos=void 0,this.FLastMsgArgs=void 0,this.FFileResolver=void 0,this.FCurSourceFile=void 0,this.FMacros=void 0,this.FDefines=void 0,this.FNonTokens=void 0,this.FOnComment=void 0,this.FOnDirective=void 0,this.FOnEvalFunction=void 0,this.FOnEvalVariable=void 0,this.FOnFormatPath=void 0,this.FOnLinkLib=void 0,this.FOnModeChanged=void 0,this.FOnWarnDirective=void 0,this.FOptions=void 0,this.FLogEvents=void 0,this.FOnLog=void 0,this.FReadOnlyBoolSwitches=void 0,this.FReadOnlyModeSwitches=void 0,this.FReadOnlyValueSwitches=void 0,this.FTokenOptions=void 0,this.FIncludeStack=void 0,this.FFiles=void 0,this.FWarnMsgStates=void 0,this.FResourceHandlers=void 0,this.FDirectiveHandles=void 0,this.PPSkipModeStack=void 0,this.PPIsSkippingStack=void 0,y.$final.call(this)},this.HandleTextBlock=function(e){var t,s=0,r="";r=w(V(e)),(t=U(" ",r))>1&&(r=g(r,1,t-1));"CR"===r?s=3:"LF"===r?s=2:"CRLF"===r?s=4:"NATIVE"===r?s=0:this.Error(1035,rtl.getResStr(i,"SErrInvalidMultiLineLineEnding")),this.FMultilineStringsEOLStyle=s},this.GetCurColumn=function(){return this.FTokenPos>0?this.FTokenPos-1+this.FCurColumnOffset:this.FCurColumnOffset},this.GetCurrentValueSwitch=function(e){return this.FCurrentValueSwitches[e]},this.GetForceCaret=function(){return 0 in this.FTokenOptions},this.GetMacrosOn=function(){return 25 in this.FCurrentBoolSwitches},this.GetTokenString=function(){return this.FCurTokenString},this.IndexOfWarnMsgState=function(e,t){var s=0,i=0,r=0,n=0;for(s=0,i=rtl.length(this.FWarnMsgStates)-1,r=0;s<=i;)if(r=rtl.trunc((s+i)/2),e>(n=this.FWarnMsgStates[r].Number))s=r+1;else{if(!(e<n))return r;i=r-1}return t?0===rtl.length(this.FWarnMsgStates)?0:(r<rtl.length(this.FWarnMsgStates)&&this.FWarnMsgStates[r].Number<=e&&(r+=1),r):-1},this.OnCondEvalFunction=function(e,t,s,r){var n=!1;return 0===J(t,"defined")?(j(s,!1,!1)||e.Log(1,1021,rtl.getResStr(i,"SErrXExpectedButYFound"),b(18,"identifier",18,s),0),r.set(i.CondDirectiveBool[+this.IsDefined(s)]),!0):0===J(t,"undefined")?(j(s,!1,!1)||e.Log(1,1021,rtl.getResStr(i,"SErrXExpectedButYFound"),b(18,"identifier",18,s),0),r.set(i.CondDirectiveBool[+!this.IsDefined(s)]),!0):0===J(t,"option")?(1===s.length&&s.charCodeAt(0)in rtl.createSet(null,97,122,null,65,90)||e.Log(1,1021,rtl.getResStr(i,"SErrXExpectedButYFound"),b(18,"letter",18,s),0),r.set(i.CondDirectiveBool[+this.IfOpt(s.charAt(0))]),!0):null!=this.FOnEvalFunction?(n=this.FOnEvalFunction(e,t,s,r),10 in this.FOptions||(r.set("0"),n=!0),n):(10 in this.FOptions?(r.set(""),n=!1):(r.set("0"),n=!0),n)},this.OnCondEvalLog=function(e,t){var s="";if(e.MsgType<=1)throw this.SetCurMsg(e.MsgType,e.MsgNumber,e.MsgPattern,t),s=H("%s(%d,%d) : %s",b(18,this.FormatPath(this.FCurFilename),0,this.FCurRow,0,this.GetCurColumn(),18,this.FLastMsg)),f.$create("Create$1",[s]);this.DoLog$1(e.MsgType,e.MsgNumber,e.MsgPattern,t,!0)},this.OnCondEvalVar=function(e,t,s){var i,r=null;return this.FDefines.IndexOf(t)>=0?(s.set("1"),!0):(i=this.FMacros.IndexOf(t))>=0?(r=rtl.as(this.FMacros.GetObject(i),n),s.set(r.FValue),!0):null!=this.FOnEvalVariable?this.FOnEvalVariable(e,t,s):(s.set(""),!1)},this.SetAllowedBoolSwitches=function(e){rtl.eqSet(this.FAllowedBoolSwitches,e)||(this.FAllowedBoolSwitches=rtl.refSet(e))},this.SetAllowedModeSwitches=function(e){rtl.eqSet(this.FAllowedModeSwitches,e)||(this.FAllowedModeSwitches=rtl.refSet(e),this.SetCurrentModeSwitches(rtl.intersectSet(this.FCurrentModeSwitches,this.FAllowedModeSwitches)))},this.SetAllowedValueSwitches=function(e){rtl.eqSet(this.FAllowedValueSwitches,e)||(this.FAllowedValueSwitches=rtl.refSet(e))},this.SetOptions=function(e){var t;rtl.eqSet(this.FOptions,e)||(t=0 in e!=0 in this.FOptions,this.FOptions=rtl.refSet(e),t&&(0 in this.FOptions?this.SetCurrentModeSwitches(rtl.refSet(i.DelphiModeSwitches)):this.SetCurrentModeSwitches(rtl.refSet(i.FPCModeSwitches))))},this.SetReadOnlyBoolSwitches=function(e){rtl.eqSet(this.FReadOnlyBoolSwitches,e)||(this.FReadOnlyBoolSwitches=rtl.refSet(e))},this.SetReadOnlyModeSwitches=function(e){rtl.eqSet(this.FReadOnlyModeSwitches,e)||(this.FReadOnlyModeSwitches=rtl.refSet(e),this.FAllowedModeSwitches=rtl.unionSet(this.FAllowedModeSwitches,this.FReadOnlyModeSwitches),this.FCurrentModeSwitches=rtl.unionSet(this.FCurrentModeSwitches,this.FReadOnlyModeSwitches))},this.SetReadOnlyValueSwitches=function(e){rtl.eqSet(this.FReadOnlyValueSwitches,e)||(this.FReadOnlyValueSwitches=rtl.refSet(e))},this.IndexOfResourceHandler=function(e){var t=0;for(t=rtl.length(this.FResourceHandlers)-1;t>=0&&this.FResourceHandlers[t].Ext!==e;)t-=1;return t},this.FindResourceHandler=function(e){var t;return-1===(t=this.IndexOfResourceHandler(e))?null:this.FResourceHandlers[t].Handler},this.IndexOfDirectiveHandle=function(e,t){var s=0,i=0,r=0,n=0,l=0;for(i=0,r=rtl.length(this.FDirectiveHandles)-1,n=0;i<=r;)if(n=rtl.trunc((i+r)/2),(l=J(e,this.FDirectiveHandles[n].Directive))>0)i=n+1;else{if(!(l<0))return n;r=n-1}return t?(s=n,0===rtl.length(this.FDirectiveHandles)||l>0&&(s+=1),s):-1},this.ReadIdentifier=function(e){var t,s=0;for(s=1,t=e.length;s<=t&&e.charCodeAt(s-1)in r.IdentChars;)s+=1;return Y(e,s-1)},this.FetchLine=function(){var e=!1;return this.FCurSourceFile.IsEOF()?(this.FTokenPos>0&&(this.FCurLine="",this.FTokenPos=-1,this.FCurRow+=1,this.FModuleRow+=1,this.FCurColumnOffset=1),e=!1):(this.FCurLine=this.FCurSourceFile.ReadLine(),this.FTokenPos=1,e=!0,this.FCurRow+=1,this.FModuleRow+=1,this.FCurColumnOffset=1,h.isPrototypeOf(this.FCurSourceFile)&&1===this.FCurRow&&(this.FCurRow=this.FCurSourceFile.FCurRow,this.FCurColumnOffset=this.FCurSourceFile.FCurCol),this.LogEvent(1)&&(this.FCurRow%100==0||this.FCurSourceFile.IsEOF())&&this.DoLog$1(5,1008,rtl.getResStr(i,"SLogLineNumber"),b(0,this.FCurRow),!0)),e},this.AddFile=function(e){for(var t=0,s=0,i=this.FFiles.GetCount()-1;s<=i;s++)if(t=s,this.FFiles.Get(t)===e)return;this.FFiles.Add(e)},this.GetMacroName=function(e){var t="",s=0;for(t=V(e),s=1;s<=t.length&&t.charCodeAt(s-1)in rtl.createSet(null,97,122,null,65,90,null,48,57,95);)s+=1;return t=rtl.strSetLength(t,s-1),t=w(t)},this.SetCurMsg=function(e,t,s,r){this.FLastMsgType=e,this.FLastMsgNumber=t,this.FLastMsgPattern=s,this.FLastMsg=i.SafeFormat(s,r),i.CreateMsgArgs({p:this,get:function(){return this.p.FLastMsgArgs},set:function(e){this.p.FLastMsgArgs=e}},r)},this.DoLog$1=function(e,t,s,r,n){var l="";this.IgnoreMsgType(e)||(this.SetCurMsg(e,t,s,r),null!=this.FOnLog&&(l=i.MessageTypeNames[e]+": ",l+=n?this.FLastMsg:H("%s(%d,%d) : %s",b(18,this.FormatPath(this.FCurFilename),0,this.FCurRow,0,this.GetCurColumn(),18,this.FLastMsg)),this.FOnLog(this,l)))},this.ErrorAt=function(e,t,s,i){throw this.SetCurMsg(1,e,t,[]),f.$create("CreateFmt",["%s(%d,%d) Error: %s",b(18,this.FormatPath(this.FCurFilename),0,s,0,i,18,this.FLastMsg)])},this.Error=function(e,t){this.ErrorAt(e,t,this.FCurRow,this.GetCurColumn())},this.Error$1=function(e,t,s){throw this.SetCurMsg(1,e,t,s),f.$create("CreateFmt",["%s(%d,%d) Error: %s",b(18,this.FormatPath(this.FCurFilename),0,this.FCurRow,0,this.GetCurColumn(),18,this.FLastMsg)])},this.PushSkipMode=function(){255===this.PPSkipStackIndex&&this.Error(1004,rtl.getResStr(i,"SErrIfXXXNestingLimitReached")),this.PPSkipModeStack[this.PPSkipStackIndex]=this.PPSkipMode,this.PPIsSkippingStack[this.PPSkipStackIndex]=this.PPIsSkipping,this.PPSkipStackIndex+=1},this.GetMultiLineStringLineEnd=function(e){var t=0;1===(t=this.FMultilineStringsEOLStyle)&&(t=e.LastEOLStyle());return 3===t?"\r":4===t?"\r\n":2===t?"\n":0===t?T.sLineBreak:"\n"},this.MakeLibAlias=function(e){var t,s="",i=0,r=0;for(i=t=e.length,r=0;i>0&&"/"!==e.charAt(i-1);)"."===e.charAt(i-1)&&0===r&&(r=i),i-=1;0===r&&(r=t+1);for(var n=1,l=(s=N(g(e,i+1,r-i-1))).length;n<=l;n++)i=n,s.charCodeAt(i-1)in rtl.createSet(null,97,122,null,65,90,null,48,57,95)||(s=rtl.setCharAt(s,i-1,"_"));return s},this.HandleDirective=function(e){var t=this,s=0,r="",n="",l=0,a=!1,o=!1;function h(e){e in t.FAllowedBoolSwitches?(o=!0,t.HandleBoolDirective(e,n)):o=!1}s=2,0===(l=U(" ",e))&&0===(l=U("\t",e))&&(l=e.length+1),r=g(e,2,l-2),n=e,z({get:function(){return n},set:function(e){n=e}},1,l),o=!0,a=!0;var u=w(r);if("IFDEF"===u)this.HandleIFDEF(n);else if("IFNDEF"===u)this.HandleIFNDEF(n);else if("IFOPT"===u)this.HandleIFOPT(n);else if("IFC"===u||"IF"===u)this.HandleIF(n,"IFC"===w(r));else if("ELIFC"===u||"ELSEIF"===u)this.HandleELSEIF(n,"ELIFC"===w(r));else if("ELSEC"===u||"ELSE"===u)this.HandleELSE(n);else if("ENDC"===u||"ENDIF"===u)this.HandleENDIF(n);else if("IFEND"===u)this.HandleENDIF(n);else{if(this.PPIsSkipping)return s;if(a=!1,o=!1,2===r.length&&r.charCodeAt(0)in rtl.createSet(null,97,122,null,65,90)&&r.charCodeAt(1)in rtl.createSet(45,43)&&(o=!0,s=this.HandleLetterDirective(r.charAt(0),"+"===r.charAt(1))),!o){o=!0,n=V(n);var c=w(r);"ASSERTIONS"===c?h(3):"DEFINE"===c||"DEFINEC"===c||"SETC"===c?this.HandleDefine(n):"GOTO"===c?h(29):"DISPATCHFIELD"===c?this.HandleDispatchField(n,1):"DISPATCHSTRFIELD"===c?this.HandleDispatchField(n,2):"ERROR"===c?this.HandleError(n):"HINT"===c?this.DoLog$1(4,1025,rtl.getResStr(i,"SUserDefined"),b(18,n),!1):"HINTS"===c?h(22):"I"===c||"INCLUDE"===c?s=this.HandleInclude(n):"INCLUDESTRING"===c||"INCLUDESTRINGFILE"===c?(this.HandleIncludeString(n),s=4):"INTERFACES"===c?this.HandleInterfaces(n):"LONGSTRINGS"===c?h(7):"LINKLIB"===c?this.HandleLinkLib(n):"MACRO"===c?h(25):"MESSAGE"===c?this.HandleMessageDirective(n):"MODE"===c?this.HandleMode(n):"MODESWITCH"===c?this.HandleModeSwitch(n):"MULTILINESTRINGLINEENDING"===c?this.HandleMultilineStringLineEnding(n):"MULTILINESTRINGTRIMLEFT"===c?this.HandleMultilineStringTrimLeft(n):"NOTE"===c?this.DoLog$1(3,1025,rtl.getResStr(i,"SUserDefined"),b(18,n),!1):"NOTES"===c?h(23):"OBJECTCHECKS"===c?h(27):"OPTIMIZATION"===c?this.HandleOptimizations(n):"OVERFLOWCHECKS"===c||"OV"===c?h(14):"POINTERMATH"===c?h(28):"R"===c?16 in this.FOptions||this.HandleResource(n):"RANGECHECKS"===c?h(15):"SCOPEDENUMS"===c?h(26):"TEXTBLOCK"===c?this.HandleTextBlock(n):"TYPEDADDRESS"===c?h(16):"TYPEINFO"===c?h(11):"UNDEF"===c?this.HandleUnDefine(n):"WARN"===c?this.HandleWarn(n):"WARNING"===c?this.DoLog$1(2,1025,rtl.getResStr(i,"SUserDefined"),b(18,n),!1):"WARNINGS"===c?h(24):"WRITEABLECONST"===c?h(9):"ALIGN"===c||"CALLING"===c||"INLINE"===c||"PACKRECORDS"===c||"PACKENUM"===c||(o=!1)}}return a&&!this.FOnDirectiveForConditionals||this.DoHandleDirective(t,r,n,{get:function(){return o},set:function(e){o=e}}),o||a||this.LogEvent(3)&&this.DoLog$1(2,1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,r),!1),s},this.HandleLetterDirective=function(e,t){var s;if(e=_(e),0===(s=i.LetterToBoolSwitch[e.charCodeAt()-65])&&this.DoLog$1(2,1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(9,e),!1),s in this.FAllowedBoolSwitches||this.DoLog$1(2,1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(9,e),!1),s in this.FCurrentBoolSwitches!==t){if(s in this.FReadOnlyBoolSwitches)return this.DoLog$1(2,1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,e+K(t,"+","-")),!1),2;t?(this.AddDefine(i.LetterSwitchNames[e.charCodeAt()-65],!1),this.FCurrentBoolSwitches=rtl.includeSet(this.FCurrentBoolSwitches,s)):(this.UnDefine(i.LetterSwitchNames[e.charCodeAt()-65],!1),this.FCurrentBoolSwitches=rtl.excludeSet(this.FCurrentBoolSwitches,s))}return 2},this.HandleBoolDirective=function(e,t){var s=!1;0===J(t,"on")?s=!0:0===J(t,"off")?s=!1:(s=!0,this.Error$1(1021,rtl.getResStr(i,"SErrXExpectedButYFound"),b(18,"on",18,t))),e in this.FCurrentBoolSwitches!==s&&(e in this.FReadOnlyBoolSwitches?this.DoLog$1(2,1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,i.BoolSwitchNames[e]),!1):s?this.SetCurrentBoolSwitches(rtl.unionSet(this.FCurrentBoolSwitches,rtl.createSet(e))):this.SetCurrentBoolSwitches(rtl.diffSet(this.FCurrentBoolSwitches,rtl.createSet(e))))},this.DoHandleComment=function(e,t){null!=this.FOnComment&&this.FOnComment(e,t)},this.DoHandleDirective=function(e,t,s,i){var r;(r=this.IndexOfDirectiveHandle(t,!1))>=0&&this.FDirectiveHandles[r].Handler(e,t,s,i),null==this.FOnDirective||(this.FOnDirective(e,t,s,i),i.get())},this.HandleMultilineStringTrimLeft=function(e){var t,s=0;t=w(V(e));var i=w(t);"ALL"===i?s=-2:"AUTO"===i?s=-1:"NONE"===i?s=0:X(t,{get:function(){return s},set:function(e){s=e}})||(s=0),this.FMultilineStringsTrimLeft=s},this.HandleMultilineStringLineEnding=function(e){var t=0,s=w(V(e));"CR"===s?t=3:"LF"===s?t=2:"CRLF"===s?t=4:"SOURCE"===s?t=1:"PLATFORM"===s?t=0:this.Error(1035,rtl.getResStr(i,"SErrInvalidMultiLineLineEnding")),this.FMultilineStringsEOLStyle=t},this.HandleMultilineComment=function(){var e=this,t=0,s=0,i="",r=0,n=0,l=0;function a(){var t;return(t=e.FetchLine())?(i=e.FCurLine,r=i.length,t):t}for(this.FTokenPos+=1,s=this.FTokenPos,this.FCurTokenString="",i=this.FCurLine,r=this.FCurLine.length,l=0;;)if(this.FTokenPos>r){if(n=this.FTokenPos-s,this.FCurTokenString=this.FCurTokenString+g(i,s,n)+T.LineEnding,!a())return t=0,this.FCurToken=t,t;s=this.FTokenPos}else if("}"===i.charAt(this.FTokenPos-1)){if((l-=1)<0)break;this.FTokenPos+=1}else"{"===i.charAt(this.FTokenPos-1)&&15 in this.FCurrentModeSwitches?(this.FTokenPos+=1,l+=1):this.FTokenPos+=1;return n=this.FTokenPos-s,this.FCurTokenString=this.FCurTokenString+g(i,s,n),this.FTokenPos+=1,t=2,this.GetTokenString().length>0&&"$"===this.GetTokenString().charAt(0)?t=this.HandleDirective(this.GetTokenString()):this.DoHandleComment(e,this.GetTokenString()),t},this.HandleMultilineCommentOldStyle=function(){var e=this,t=0,s=0,i="",r=0,n=0,l=0;function a(){var t;return(t=e.FetchLine())?(i=e.FCurLine,r=i.length,t):t}for(this.FTokenPos+=1,s=this.FTokenPos,this.FCurTokenString="",l=0;;)if(this.FTokenPos>r){if(n=this.FTokenPos-s,this.FCurTokenString=this.FCurTokenString+g(this.FCurLine,s,n)+T.LineEnding,!a())return t=0,this.FCurToken=t,t;s=this.FTokenPos}else if(this.FTokenPos<r&&"*"===i.charAt(this.FTokenPos-1)&&")"===i.charAt(this.FTokenPos+1-1)){if((l-=1)<0)break;this.FTokenPos+=2}else 15 in this.FCurrentModeSwitches&&this.FTokenPos<r&&"("===i.charAt(this.FTokenPos-1)&&"*"===i.charAt(this.FTokenPos+1-1)?(this.FTokenPos+=2,l+=1):this.FTokenPos+=1;return n=this.FTokenPos-s,this.FCurTokenString=this.FCurTokenString+g(this.FCurLine,s,n),this.FTokenPos+=2,t=2,"$"===g(this.GetTokenString(),1,1)?t=this.HandleDirective(this.GetTokenString()):this.DoHandleComment(e,this.GetTokenString()),t},this.HandleIFDEF=function(e){var t="";this.PushSkipMode(),this.PPIsSkipping?this.PPSkipMode=3:(t=this.ReadIdentifier(e),this.IsDefined(t)?this.PPSkipMode=2:(this.PPSkipMode=1,this.PPIsSkipping=!0),this.LogEvent(2)&&(2===this.PPSkipMode?this.DoLog$1(5,1009,rtl.getResStr(i,"SLogIFDefAccepted"),b(18,t),!1):this.DoLog$1(5,1010,rtl.getResStr(i,"SLogIFDefRejected"),b(18,t),!1)))},this.HandleIFNDEF=function(e){var t="";this.PushSkipMode(),this.PPIsSkipping?this.PPSkipMode=3:(t=this.ReadIdentifier(e),this.IsDefined(t)?(this.PPSkipMode=1,this.PPIsSkipping=!0):this.PPSkipMode=2,this.LogEvent(2)&&(2===this.PPSkipMode?this.DoLog$1(5,1011,rtl.getResStr(i,"SLogIFNDefAccepted"),b(18,t),!1):this.DoLog$1(5,1012,rtl.getResStr(i,"SLogIFNDefRejected"),b(18,t),!1)))},this.HandleIFOPT=function(e){this.PushSkipMode(),this.PPIsSkipping?this.PPSkipMode=3:(2===e.length&&e.charCodeAt(0)in rtl.createSet(null,97,122,null,65,90)&&e.charCodeAt(1)in rtl.createSet(43,45)||this.Error$1(1021,rtl.getResStr(i,"SErrXExpectedButYFound"),b(18,"letter[+|-]",18,e)),this.IfOpt(e.charAt(0))===("+"===e.charAt(1))?this.PPSkipMode=2:(this.PPSkipMode=1,this.PPIsSkipping=!0),this.LogEvent(2)&&(2===this.PPSkipMode?this.DoLog$1(5,1015,rtl.getResStr(i,"SLogIFOptAccepted"),b(18,e),!1):this.DoLog$1(5,1016,rtl.getResStr(i,"SLogIFOptRejected"),b(18,e),!1)))},this.HandleIF=function(e,t){this.PushSkipMode(),this.PPIsSkipping?this.PPSkipMode=3:(this.FConditionEval.MsgCurLine=this.FCurTokenPos.Row,this.FConditionEval.isMac=t,this.FConditionEval.Eval(e)?this.PPSkipMode=2:(this.PPSkipMode=1,this.PPIsSkipping=!0),this.LogEvent(2)&&(2===this.PPSkipMode?this.DoLog$1(5,1013,rtl.getResStr(i,"SLogIFAccepted"),b(18,e),!1):this.DoLog$1(5,1014,rtl.getResStr(i,"SLogIFRejected"),b(18,e),!1)))},this.HandleELSEIF=function(e,t){0===this.PPSkipStackIndex&&this.Error(1005,rtl.getResStr(i,"SErrInvalidPPElse")),1===this.PPSkipMode?(this.FConditionEval.isMac=t,this.FConditionEval.Eval(e)?(this.PPSkipMode=2,this.PPIsSkipping=!1):this.PPIsSkipping=!0,this.LogEvent(2)&&(2===this.PPSkipMode?this.DoLog$1(5,1017,rtl.getResStr(i,"SLogELSEIFAccepted"),b(18,e),!1):this.DoLog$1(5,1018,rtl.getResStr(i,"SLogELSEIFRejected"),b(18,e),!1))):2===this.PPSkipMode&&(this.PPIsSkipping=!0)},this.HandleELSE=function(e){0===this.PPSkipStackIndex&&this.Error(1005,rtl.getResStr(i,"SErrInvalidPPElse")),1===this.PPSkipMode?this.PPIsSkipping=!1:2===this.PPSkipMode&&(this.PPIsSkipping=!0)},this.HandleENDIF=function(e){0===this.PPSkipStackIndex&&this.Error(1006,rtl.getResStr(i,"SErrInvalidPPEndif")),this.PPSkipStackIndex-=1,this.PPSkipMode=this.PPSkipModeStack[this.PPSkipStackIndex],this.PPIsSkipping=this.PPIsSkippingStack[this.PPSkipStackIndex]},this.HandleDefine=function(e){var t,s="",i="";0===(t=U(":=",e))?this.AddDefine(this.GetMacroName(e),!1):(s=w(V(g(i=e,1,t-1))),z({get:function(){return i},set:function(e){i=e}},1,t+1),this.AddMacro(s,V(i),!1))},this.HandleDispatchField=function(e,t){var s="";t in this.FAllowedValueSwitches||this.Error$1(1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,i.ValueSwitchNames[t])),"-"===(s=this.ReadIdentifier(e))?s="":j(s,!1,!1)||this.DoLog$1(2,1031,rtl.getResStr(i,"SInvalidDispatchFieldName"),[],!1),O(s,this.GetCurrentValueSwitch(t))||(t in this.FReadOnlyValueSwitches?this.Error$1(1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,i.ValueSwitchNames[t])):this.SetCurrentValueSwitch(t,s))},this.HandleError=function(e){11 in this.FOptions?this.Error$1(1025,rtl.getResStr(i,"SUserDefined"),b(18,e)):this.DoLog$1(2,1025,rtl.getResStr(i,"SUserDefined")+" error",b(18,e),!1)},this.HandleMessageDirective=function(e){var t,s=0,r=0;if(""!==e){for(s=1;s<=e.length&&e.charCodeAt(s-1)in rtl.createSet(null,97,122,null,65,90);)s+=1;t=Y(e,s-1),r=4;var n=w(t);for("HINT"===n?r=4:"NOTE"===n?r=3:"WARN"===n?r=2:"ERROR"===n?r=1:"FATAL"===n?r=0:s=1;s<=e.length&&e.charCodeAt(s-1)in rtl.createSet(32,9);)s+=1;z({get:function(){return e},set:function(t){e=t}},1,s-1),r in rtl.createSet(0,1)?this.HandleError(e):this.DoLog$1(r,1025,rtl.getResStr(i,"SUserDefined"),b(18,e),!1)}},this.HandleIncludeFile=function(e){var t,s="";(e=V(e)).length>1&&"'"===e.charAt(0)&&("'"!==e.charAt(e.length-1)&&this.Error$1(1002,rtl.getResStr(i,"SErrOpenString"),[]),e=g(e,2,e.length-2)),null==(t=this.FFileResolver.FindIncludeFile(e))&&this.Error$1(1003,rtl.getResStr(i,"SErrIncludeFileNotFound"),b(18,e)),this.PushStackItem(),this.FCurSourceFile=t,this.FCurFilename=e,l.isPrototypeOf(this.FCurSourceFile)&&(s=this.FCurSourceFile.FFilename,this.FFileResolver.SetBaseDirectory(q(s)),this.FCurFilename=s),this.AddFile(this.FCurFilename),this.LogEvent(0)&&this.DoLog$1(5,1007,rtl.getResStr(i,"SLogOpeningFile"),b(18,this.FormatPath(this.FCurFilename)),!0)},this.HandleIncludeString=function(e){var t=null,s="",r="";(e=V(e)).length>1&&"'"===e.charAt(0)&&("'"!==e.charAt(e.length-1)&&this.Error$1(1002,rtl.getResStr(i,"SErrOpenString"),[]),e=g(e,2,e.length-2)),null==(t=this.FFileResolver.FindIncludeFile(e))&&this.Error$1(1003,rtl.getResStr(i,"SErrIncludeFileNotFound"),b(18,e));try{for(s="";!t.IsEOF();)r=t.ReadLine(),""!==s&&(s+=this.GetMultiLineStringLineEnd(t)),s+=r}finally{t=rtl.freeLoc(t)}this.FCurTokenString="'"+s+"'",this.FCurToken=4},this.HandleResource=function(e){var t,s,r="",n="",l="",a=null,o=null;if(n="",l="",0===(s=U(";",e))?n=V(e):(n=V(g(e,1,s-1)),l=g(e,s+1,e.length-s)),r=Q(n),"*"===Z(n,"")&&(n=Z(ee(this.FCurFilename),r)),""===(t=this.FFileResolver.FindResourceFileName(n))&&(19 in this.FOptions?this.DoLog$1(2,1034,rtl.getResStr(i,"SErrResourceFileNotFound"),b(18,n),!1):this.Error$1(1034,rtl.getResStr(i,"SErrResourceFileNotFound"),b(18,n))),""!==r&&(r=g(r,2,r.length-1)),null===(a=this.FindResourceHandler(N(r)))&&(a=this.FindResourceHandler("*")),null!==a){o=R.$create("Create$1");try{o.SetNameValueSeparator(":"),o.SetDelimiter(";"),o.FStrictDelimiter=!0,o.SetDelimitedText(l),a(this,t,o)}finally{o=rtl.freeLoc(o)}}else 14 in this.FOptions||this.Error$1(1033,rtl.getResStr(i,"SNoResourceSupport"),b(18,r))},this.HandleLinkLib=function(e){var t,s,r=0,n=0,l="",a=!1;function o(){var t,s=0;for(s=r;s<=n&&!(e.charCodeAt(s-1)in rtl.createSet(32,9,10,13));)s+=1;return t=g(e,r,s-r),r=s,t}e=V(e),n=e.length,r=1,t=o(),function(){for(;r<=n&&e.charCodeAt(r-1)in rtl.createSet(32,9,10,13);)r+=1}(),l=r<=n?o():this.MakeLibAlias(t),s=V(g(e,r,n-r+1)),a=!1,null!=this.FOnLinkLib&&this.FOnLinkLib(this,t,l,s,{get:function(){return a},set:function(e){a=e}}),a||this.DoLog$1(3,1036,rtl.getResStr(i,"SWarnIgnoringLinkLib"),b(18,t,18,l,18,s),!1)},this.HandleOptimizations=function(e){var t,s=0,r=0,n="",l="";for(s=1,t=e.length;s<=t;){for(;s<=t&&e.charCodeAt(s-1)in rtl.createSet(32,9,10,13);)s+=1;for(r=s;s<=t&&e.charCodeAt(s-1)in rtl.createSet(null,97,122,null,65,90,null,48,57,95);)s+=1;if(s===r&&this.Error$1(1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,"optimization")),n=g(e,r,s-r),"no"===N(Y(n,2)))return z({get:function(){return n},set:function(e){n=e}},1,2),void this.DoHandleOptimization(n,"-");for(;s<=t&&e.charCodeAt(s-1)in rtl.createSet(32,9,10,13);)s+=1;for(r=s;s<=t&&","!==e.charAt(s-1);)s+=1;l=te(g(e,r,s-r)),this.DoHandleOptimization(n,l),s+=1}},this.DoHandleOptimization=function(e,t){},this.HandleUnDefine=function(e){this.UnDefine(this.GetMacroName(e),!1)},this.HandleInclude=function(e){var t=0;return t=2,""!==e&&"%"===e.charAt(0)?(this.FCurTokenString="'"+e+"'",this.FCurToken=4,t=this.FCurToken):this.HandleIncludeFile(e),t},this.HandleMode=function(e){var t=this;function s(s,r,n,l,a,o){var h=!1;s in t.FAllowedModeSwitches||t.Error$1(1019,rtl.getResStr(i,"SErrInvalidMode"),b(18,e)),h=!1,null!=t.FOnModeChanged&&t.FOnModeChanged(t,s,!0,{get:function(){return h},set:function(e){h=e}}),h||(t.SetCurrentModeSwitches(rtl.intersectSet(rtl.unionSet(r,t.FReadOnlyModeSwitches),t.FAllowedModeSwitches)),t.SetCurrentBoolSwitches(rtl.diffSet(rtl.unionSet(t.FCurrentBoolSwitches,rtl.intersectSet(l,t.FAllowedBoolSwitches)),rtl.intersectSet(a,t.FAllowedBoolSwitches))),t.FOptions=n?rtl.unionSet(t.FOptions,rtl.createSet(0)):rtl.diffSet(t.FOptions,rtl.createSet(0)),o?t.UnsetNonToken(89):t.SetNonToken(89)),h=!1,t.FFileResolver.FMode=s,null!=t.FOnModeChanged&&t.FOnModeChanged(t,s,!1,{get:function(){return h},set:function(e){h=e}})}if(this.FSkipGlobalSwitches)this.DoLog$1(2,1029,rtl.getResStr(i,"SMisplacedGlobalCompilerSwitch"),[],!1);else{var r=V(w(e));"FPC"===r||"DEFAULT"===r?(s(1,i.FPCModeSwitches,!1,i.bsFPCMode,{},!0),this.SetNonToken(83),this.SetNonToken(84),this.SetNonToken(82)):"OBJFPC"===r?(s(2,i.OBJFPCModeSwitches,!0,i.bsObjFPCMode,{},!0),this.UnsetNonToken(67),this.UnsetNonToken(104),this.SetNonToken(83),this.SetNonToken(84),this.SetNonToken(82)):"DELPHI"===r?(s(3,i.DelphiModeSwitches,!0,i.bsDelphiMode,rtl.createSet(28),!0),this.SetNonToken(67),this.SetNonToken(104),this.SetNonToken(83),this.SetNonToken(84),this.SetNonToken(82)):"DELPHIUNICODE"===r?(s(4,i.DelphiUnicodeModeSwitches,!0,i.bsDelphiUnicodeMode,rtl.createSet(28),!0),this.SetNonToken(67),this.SetNonToken(104),this.SetNonToken(83),this.SetNonToken(84),this.SetNonToken(82)):"TP"===r?s(5,i.TPModeSwitches,!1,{},{},!0):"MACPAS"===r?s(6,i.MacModeSwitches,!1,i.bsMacPasMode,{},!0):"ISO"===r?s(7,i.ISOModeSwitches,!1,{},{},!1):"EXTENDEDPASCAL"===r?s(8,i.ExtPasModeSwitches,!1,{},{},!0):"GPC"===r?s(9,i.GPCModeSwitches,!1,{},{},!0):this.Error$1(1019,rtl.getResStr(i,"SErrInvalidMode"),b(18,e))}},this.HandleModeSwitch=function(e){var t,s,r="",n=0,l=!1;for(l=!1,r=e,n=1;n<=r.length&&r.charCodeAt(n-1)in rtl.createSet(null,97,122,null,65,90,95,null,48,57);)n+=1;if(s=Y(r,n-1),z({get:function(){return r},set:function(e){r=e}},1,n-1),0!==(t=i.StrToModeSwitch(s))&&t in this.FAllowedModeSwitches){if(""===r)l=!0;else{var a=r.charAt(0);if("+"===a||"-"===a)l="+"===r.charAt(0),(n=2)<=r.length&&!(r.charCodeAt(n-1)in rtl.createSet(32,9))&&this.Error$1(1032,rtl.getResStr(i,"SErrWrongSwitchToggle"),[]);else if(" "===a||"\t"===a){if(""!==(r=se(r))){for(n=1;n<=r.length&&r.charCodeAt(n-1)in rtl.createSet(null,65,90);)n+=1;n<=r.length&&!(r.charCodeAt(n-1)in rtl.createSet(32,9))&&this.Error$1(1032,rtl.getResStr(i,"SErrWrongSwitchToggle"),[]),"ON"===(r=Y(r,n-1))?l=!0:"OFF"===r?l=!1:this.Error$1(1032,rtl.getResStr(i,"SErrWrongSwitchToggle"),[])}}else this.Error$1(1032,rtl.getResStr(i,"SErrWrongSwitchToggle"),[])}t in this.FCurrentModeSwitches!==l&&(t in this.FReadOnlyModeSwitches?this.DoLog$1(2,1020,rtl.getResStr(i,"SErrInvalidModeSwitch"),b(18,s),!1):l?this.SetCurrentModeSwitches(rtl.unionSet(this.FCurrentModeSwitches,rtl.createSet(t))):this.SetCurrentModeSwitches(rtl.diffSet(this.FCurrentModeSwitches,rtl.createSet(t))))}else 9 in this.FOptions?this.Error$1(1020,rtl.getResStr(i,"SErrInvalidModeSwitch"),b(18,s)):this.DoLog$1(2,1020,rtl.getResStr(i,"SErrInvalidModeSwitch"),b(18,s),!1)},this.HandleMacro=function(e){var t,s,i,r=null;return s=this.FCurRow,i=this.GetCurColumn(),this.PushStackItem(),t=rtl.as(this.FMacros.GetObject(e),n),(r=h.$create("Create$2",[this.FCurFilename,t.FValue])).FCurRow=s,r.FCurCol=i-t.FName.length,this.FCurSourceFile=r,this.DoFetchToken()},this.HandleInterfaces=function(e){var t,s="",r="";0 in this.FAllowedValueSwitches||this.Error$1(1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,"interfaces")),s=w(e),(t=U(" ",s))>0&&(s=Y(s,t-1));if("COM"===s||"DEFAULT"===s)r="COM";else{if("CORBA"!==s)return void this.Error$1(1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,"interfaces "+s));r="CORBA"}O(r,this.GetCurrentValueSwitch(0))||(0 in this.FReadOnlyValueSwitches?this.Error$1(1028,rtl.getResStr(i,"SWarnIllegalCompilerDirectiveX"),b(18,"interfaces")):this.SetCurrentValueSwitch(0,r))},this.HandleWarn=function(e){var t,s,i=0,r=0;for(i=1;i<=e.length&&e.charCodeAt(i-1)in rtl.createSet(32,9);)i+=1;for(r=i;i<=e.length&&e.charCodeAt(i-1)in rtl.createSet(null,97,122,null,65,90,null,48,57,95);)i+=1;for(t=g(e,r,i-r);i<=e.length&&e.charCodeAt(i-1)in rtl.createSet(32,9);)i+=1;for(r=i;i<=e.length&&e.charCodeAt(i-1)in rtl.createSet(null,97,122,null,65,90,95);)i+=1;s=g(e,r,i-r),this.HandleWarnIdentifier(t,s)},this.HandleWarnIdentifier=function(e,t){var s=0,r=0,n=!1;if(""===e&&this.Error$1(1027,rtl.getResStr(i,"SIllegalStateForWarnDirective"),b(18,"")),""!==t){var l=N(t);if("on"===l)r=1;else if("off"===l)r=2;else if("default"===l)r=0;else{if("error"!==l)return void this.DoLog$1(2,1027,rtl.getResStr(i,"SIllegalStateForWarnDirective"),b(18,t),!1);r=3}if((null==this.FOnWarnDirective||(n=!1,this.FOnWarnDirective(this,e,r,{get:function(){return n},set:function(e){n=e}}),!n))&&e.charCodeAt(0)in rtl.createSet(null,48,57)){if((s=ie(e,-1))<0)return void this.DoLog$1(2,1027,rtl.getResStr(i,"SIllegalStateForWarnDirective"),b(18,e),!1);this.SetWarnMsgState(s,r)}}else this.DoLog$1(2,1027,rtl.getResStr(i,"SIllegalStateForWarnDirective"),b(18,""),!1)},this.PushStackItem=function(){var e=null;this.FIncludeStack.FCount>=this.FMaxIncludeStackDepth&&this.Error(1028,rtl.getResStr(i,"SErrIncludeLimitReached")),(e=S.$create("Create")).SourceFile=this.FCurSourceFile,e.Filename=this.FCurFilename,e.Token=this.FCurToken,e.TokenString=this.GetTokenString(),e.Line=this.FCurLine,e.Row=this.FCurRow,e.ColumnOffset=this.FCurColumnOffset,e.TokenPos=this.FTokenPos,this.FIncludeStack.Add(e),this.FTokenPos=-1,this.FCurRow=0,this.FCurColumnOffset=1},this.PopStackItem=function(){var e=null;e=rtl.getObject(this.FIncludeStack.Get(this.FIncludeStack.FCount-1)),this.FIncludeStack.Delete(this.FIncludeStack.FCount-1),this.FCurSourceFile.$destroy("Destroy"),this.FCurSourceFile=e.SourceFile,this.FCurFilename=e.Filename,this.FFileResolver.SetBaseDirectory(q(this.FCurFilename)),this.FCurToken=e.Token,this.FCurTokenString=e.TokenString,this.FCurLine=e.Line,this.FCurRow=e.Row,this.FCurColumnOffset=e.ColumnOffset,this.FTokenPos=e.TokenPos,e=rtl.freeLoc(e)},this.DoFetchTextToken=function(){var e,t,s,n=0,l=0,a="";for(n=0,this.FCurTokenString="",s=(a=this.FCurLine).length,e=this.FTokenPos;;){if(this.FTokenPos>s)break;var o=a.charAt(this.FTokenPos-1);if("^"===o)this.FTokenPos+=1,this.FTokenPos<s&&a.charCodeAt(this.FTokenPos-1)in r.Letters&&(this.FTokenPos+=1),n=0===n?7:4;else if("#"===o){if(this.FTokenPos+=1,this.FTokenPos<s&&"$"===a.charAt(this.FTokenPos-1)){this.FTokenPos+=1;do{this.FTokenPos+=1}while(!(this.FTokenPos>s)&&a.charCodeAt(this.FTokenPos-1)in r.HexDigits)}else do{this.FTokenPos+=1}while(!(this.FTokenPos>s)&&a.charCodeAt(this.FTokenPos-1)in r.Digits);n=0===n?7:4}else{if("'"!==o)break;for(l=this.FTokenPos,this.FTokenPos+=1;;){if(this.FTokenPos<=s&&"'"===a.charAt(this.FTokenPos-1)){if(!(this.FTokenPos<s&&"'"===a.charAt(this.FTokenPos+1-1)))break;this.FTokenPos+=1,n=0===n?7:4}this.FTokenPos>s&&this.Error(1002,rtl.getResStr(i,"SErrOpenString")),this.FTokenPos+=1}this.FTokenPos+=1,n=0===n&&this.FTokenPos-l===3?7:4}}return t=this.FTokenPos-e,this.FCurTokenString=this.FCurTokenString+g(this.FCurLine,e,t),n},this.DoFetchMultilineTextToken=function(){var e=this,t=0,s=0,n=0,l="",a=0,o="",h="";function u(t){e.FCurTokenString=e.FCurTokenString+t}function c(t){var i=0;if(1===n)if(-1===(i=e.FMultilineStringsTrimLeft)&&(i=s+1),i>0)for(;e.FCurLine.charCodeAt(n-1)in rtl.createSet(32,9)&&n<=e.FTokenPos&&i>0;)n+=1,i-=1;else if(-2===i)for(;e.FCurLine.charCodeAt(n-1)in rtl.createSet(32,9)&&n<=e.FTokenPos;)n+=1;u(g(e.FCurLine,n,e.FTokenPos-n)),t&&u(h)}function p(){u(o)}for(t=0,this.FCurTokenString="",a=(l=this.FCurLine).length,s=this.FTokenPos,o="'",h=this.GetMultiLineStringLineEnd(this.FCurSourceFile);;){if(this.FTokenPos>a)break;var f=l.charAt(this.FTokenPos-1);if("^"===f)n=this.FTokenPos,this.FTokenPos+=1,this.FTokenPos<a&&l.charCodeAt(this.FTokenPos-1)in r.Letters&&(this.FTokenPos+=1),u(g(this.FCurLine,n,this.FTokenPos-n)),t=0===t?7:4;else if("#"===f){if(n=this.FTokenPos,this.FTokenPos+=1,this.FTokenPos<a&&"$"===l.charAt(this.FTokenPos-1)){this.FTokenPos+=1;do{this.FTokenPos+=1}while(!(this.FTokenPos>a)&&l.charCodeAt(this.FTokenPos-1)in r.HexDigits)}else do{this.FTokenPos+=1}while(!(this.FTokenPos>a)&&l.charCodeAt(this.FTokenPos-1)in r.Digits);u(g(this.FCurLine,n,this.FTokenPos-n)),t=0===t?7:4}else{if("`"!==f)break;for(p(),this.FTokenPos+=1,n=this.FTokenPos;;)if(this.FTokenPos>a)c(!0),e.FetchLine()||this.Error(1002,rtl.getResStr(i,"SErrOpenString")),a=(l=this.FCurLine).length,n=this.FTokenPos;else{var d=l.charAt(this.FTokenPos-1);if("`"===d){if(this.FTokenPos<a&&"`"===l.charAt(this.FTokenPos+1-1)){this.FTokenPos+=1,c(!1),this.FTokenPos+=1,n=this.FTokenPos;continue}c(!1),p();break}"'"===d&&(this.FTokenPos+=1,c(!1),p(),n=this.FTokenPos,this.FTokenPos>a&&(this.FTokenPos-=1)),this.FTokenPos+=1}this.FTokenPos+=1,t=4}}return t},this.DoFetchDelphiMultiLineTextToken=function(e){var t,s=this,n="",l=[],a=0,o=0,h=0,u=0,c=0,p=0,f=!1;function d(){var e;e=rtl.length(l),p===e&&(l=rtl.arraySetLength(l,"",2*e+10)),l[p]=s.FCurLine,p+=1}function F(){var e;return(e=s.FetchLine())||s.Error(1002,rtl.getResStr(i,"SErrOpenString")),n=s.FCurLine,a=n.length,e}for(l=[],p=0,this.FCurTokenString="";;){if(u=0,c=0,!F())return 0;for(;this.FTokenPos<=a&&" "===n.charAt(this.FTokenPos-1);)this.FTokenPos+=1,c+=1;for(f=!1;;){if(this.FTokenPos>a)break;if(n.charAt(this.FTokenPos-1)===r.SingleQuote){do{this.FTokenPos+=1,u+=1}while(!(this.FTokenPos>a||n.charAt(this.FTokenPos-1)!==r.SingleQuote||u===e));if(u===e){f&&this.Error(1038,rtl.getResStr(i,"SErrMultilineNonWhiteSpaceBeforeClosing"));break}f=!0}else f=!0,this.FTokenPos+=1}if(u===e)break;d()}t=this.GetMultiLineStringLineEnd(this.FCurSourceFile);for(var m=0,C=p-1;m<=C;m++){for(n=l[o=m],h=0,a=n.length;h<a&&" "===n.charAt(h+1-1);)h+=1;h===a?n="":h<c?this.ErrorAt(1037,rtl.getResStr(i,"SErrInvalidIndent"),this.FCurRow-p+o,h):n=g(n,c+1,a),l[o]=n,o>0&&t.length,n.length}for(var S=0,T=p-1;S<=T;S++)n=l[o=S],(a=n.length)>0&&(this.FCurTokenString=this.FCurTokenString+n),o<p-1&&(this.FCurTokenString=this.FCurTokenString+t);return 5},this.DoFetchToken=function(){var e=this,t=0,s=0,n=0,l=0,a=0,o=0,u="",c=0;function p(){e.FCurTokenString=g(e.FCurLine,s,a)}function f(){var t;return(t=e.FetchLine())?(u=e.FCurLine,c=u.length,t):t}if(this.FCurtokenEscaped=!1,s=0,t=118,this.FTokenPos<1&&!this.FetchLine())return t=0,this.FCurToken=t,this.FCurTokenString="",t;if(this.FCurTokenString="",this.FCurTokenPos.FileName=this.FCurFilename,this.FCurTokenPos.Row=this.FCurRow,this.FCurTokenPos.Column=this.GetCurColumn(),u=this.FCurLine,c=u.length,this.FTokenPos>c)return this.FetchLine(),t=118,this.FCurToken=t,t;var d=u.charAt(this.FTokenPos-1);if(" "===d){t=1;do{if(this.FTokenPos+=1,this.FTokenPos>c&&!f())return this.FCurToken=t,t}while(" "===u.charAt(this.FTokenPos-1))}else if("\t"===d){t=119;do{if(this.FTokenPos+=1,this.FTokenPos>c&&!f())return this.FCurToken=t,t}while("\t"===u.charAt(this.FTokenPos-1))}else if("#"===d)t=this.DoFetchTextToken();else if("'"===d)t=55 in this.FCurrentModeSwitches&&function(t){var s=0;for(s=e.FTokenPos,t.set(0);s<=c;){if(t.set(t.get()+1),u.charAt(s-1)!==r.SingleQuote)return!1;s+=1}return s>c&&t.get()>2&&t.get()%2==1}({get:function(){return l},set:function(e){l=e}})?this.DoFetchDelphiMultiLineTextToken(l):this.DoFetchTextToken();else if("`"===d)54 in this.FCurrentModeSwitches||this.Error$1(1001,rtl.getResStr(i,"SErrInvalidCharacter"),b(9,u.charAt(this.FTokenPos-1))),t=this.DoFetchMultilineTextToken();else if("&"===d){s=this.FTokenPos;do{this.FTokenPos+=1}while(!(this.FTokenPos>c)&&u.charCodeAt(this.FTokenPos-1)in rtl.createSet(null,48,55));1===(a=this.FTokenPos-s)&&u.charCodeAt(this.FTokenPos-1)in r.IdentChars?(this.DoFetchToken(),t=3,this.FCurtokenEscaped=!0):(p(),t=6)}else if("$"===d){s=this.FTokenPos;do{this.FTokenPos+=1}while(!(this.FTokenPos>c)&&u.charCodeAt(this.FTokenPos-1)in r.HexDigits);a=this.FTokenPos-s,p(),t=6}else if("%"===d){s=this.FTokenPos;do{this.FTokenPos+=1}while(!(this.FTokenPos>c)&&u.charCodeAt(this.FTokenPos-1)in rtl.createSet(48,49));a=this.FTokenPos-s,p(),t=6}else if("("===d)this.FTokenPos+=1,this.FTokenPos<=c&&"."===u.charAt(this.FTokenPos-1)?(this.FTokenPos+=1,t=22):t=this.FTokenPos>c||"*"!==u.charAt(this.FTokenPos-1)?8:this.HandleMultilineCommentOldStyle();else if(")"===d)this.FTokenPos+=1,t=9;else if("*"===d)t=10,this.FTokenPos+=1,this.FTokenPos<=c&&"*"===u.charAt(this.FTokenPos-1)?(this.FTokenPos+=1,t=31):2 in this.FOptions&&this.FTokenPos<=c&&"="===u.charAt(this.FTokenPos-1)&&(this.FTokenPos+=1,t=35);else if("+"===d)t=11,this.FTokenPos+=1,2 in this.FOptions&&this.FTokenPos<=c&&"="===u.charAt(this.FTokenPos-1)&&(this.FTokenPos+=1,t=33);else if(","===d)this.FTokenPos+=1,t=12;else if("-"===d)t=13,this.FTokenPos+=1,2 in this.FOptions&&this.FTokenPos<=c&&"="===u.charAt(this.FTokenPos-1)&&(this.FTokenPos+=1,t=34);else if("."===d)this.FTokenPos+=1,this.FTokenPos<=c&&")"===u.charAt(this.FTokenPos-1)?(this.FTokenPos+=1,t=23):this.FTokenPos<=c&&"."===u.charAt(this.FTokenPos-1)?(this.FTokenPos+=1,this.FTokenPos<=c&&"."===u.charAt(this.FTokenPos-1)?(this.FTokenPos+=1,t=38):t=26):t=14;else if("/"===d)if(t=15,this.FTokenPos+=1,this.FTokenPos<=c&&"/"===u.charAt(this.FTokenPos-1)){for(this.FTokenPos+=1,s=this.FTokenPos,this.FCurTokenString="";this.FTokenPos<=c&&"\0"!==u.charAt(this.FTokenPos-1);)this.FTokenPos+=1;if(a=this.FTokenPos-s,p(),h.isPrototypeOf(this.FCurSourceFile)){do{n=this.FetchToken()}while(118===n);f()}t=2}else 2 in this.FOptions&&this.FTokenPos<=c&&"="===u.charAt(this.FTokenPos-1)&&(this.FTokenPos+=1,t=36);else if(d>="0"&&d<="9"){s=this.FTokenPos;do{this.FTokenPos+=1}while(!(this.FTokenPos>c)&&u.charCodeAt(this.FTokenPos-1)in r.Digits);if(this.FTokenPos<=c&&"."===u.charAt(this.FTokenPos-1)&&(this.FTokenPos===c||"."!==u.charAt(this.FTokenPos+1-1)&&")"!==u.charAt(this.FTokenPos+1-1)))for(this.FTokenPos+=1;this.FTokenPos<=c&&u.charCodeAt(this.FTokenPos-1)in r.Digits;)this.FTokenPos+=1;if(this.FTokenPos<=c&&u.charCodeAt(this.FTokenPos-1)in rtl.createSet(101,69)){this.FTokenPos+=1,this.FTokenPos<=c&&u.charCodeAt(this.FTokenPos-1)in rtl.createSet(45,43)&&(this.FTokenPos+=1);for(;this.FTokenPos<=c&&u.charCodeAt(this.FTokenPos-1)in r.Digits;)this.FTokenPos+=1}a=this.FTokenPos-s,p(),t=6}else if(":"===d)this.FTokenPos+=1,this.FTokenPos<=c&&"="===u.charAt(this.FTokenPos-1)?(this.FTokenPos+=1,t=27):t=16;else if(";"===d)this.FTokenPos+=1,t=17;else if("<"===d)if(this.FTokenPos+=1,this.FTokenPos>c)t=18;else{var F=u.charAt(this.FTokenPos-1);">"===F?(this.FTokenPos+=1,t=28):"="===F?(this.FTokenPos+=1,t=29):"<"===F?(this.FTokenPos+=1,t=102):t=18}else if("="===d)this.FTokenPos+=1,t=19;else if(">"===d)if(this.FTokenPos+=1,this.FTokenPos>c)t=20;else{var m=u.charAt(this.FTokenPos-1);"="===m?(this.FTokenPos+=1,t=30):"<"===m?(this.FTokenPos+=1,t=32):">"===m?(this.FTokenPos+=1,t=103):t=20}else if("@"===d)this.FTokenPos+=1,t=21,this.FTokenPos<=c&&"@"===u.charAt(this.FTokenPos-1)&&(this.FTokenPos+=1,t=37);else if("["===d)this.FTokenPos+=1,t=22;else if("]"===d)this.FTokenPos+=1,t=23;else if("^"===d)this.GetForceCaret()||this.PPIsSkipping||this.FPreviousToken in rtl.createSet(0,119,118,2,3,80,87,9,23,24)?(this.FTokenPos+=1,t=24):t=this.DoFetchTextToken();else if("\\"===d)this.FTokenPos+=1,t=25;else if("{"===d)t=this.HandleMultilineComment();else if(d>="A"&&d<="Z"||d>="a"&&d<="z"||"_"===d){s=this.FTokenPos;do{this.FTokenPos+=1}while(!(this.FTokenPos>c)&&u.charCodeAt(this.FTokenPos-1)in r.IdentChars);for(a=this.FTokenPos-s,p(),t=3,n=39;n<=117;n++)if(0===J(this.GetTokenString(),i.TokenInfos[n])){t=n;break}3!==t&&t in this.FNonTokens&&(t=3),this.FCurToken=t,this.GetMacrosOn()&&(o=this.FMacros.IndexOf(this.GetTokenString()))>=0&&(t=this.HandleMacro(o))}else this.PPIsSkipping?this.FTokenPos+=1:this.Error$1(1001,rtl.getResStr(i,"SErrInvalidCharacter"),b(9,u.charAt(this.FTokenPos-1)));return this.FCurToken=t,t},this.ClearFiles=function(){for(;this.FIncludeStack.FCount>1;)rtl.getObject(this.FIncludeStack.Get(1)).$destroy("Destroy"),this.FIncludeStack.Delete(1);this.FIncludeStack.Clear(),re({p:this,get:function(){return this.p.FCurSourceFile},set:function(e){this.p.FCurSourceFile=e}}),this.FFiles.Clear(),this.FModuleRow=0},this.ClearMacros=function(){for(var e=0,t=0,s=this.FMacros.GetCount()-1;t<=s;t++)e=t,this.FMacros.GetObject(e).$destroy("Destroy");this.FMacros.Clear()},this.SetCurToken=function(e){this.FCurToken=e},this.SetCurTokenString=function(e){this.FCurTokenString=e},this.SetCurrentBoolSwitches=function(e){var t,s;rtl.eqSet(this.FCurrentBoolSwitches,e)||(t=rtl.refSet(this.FCurrentBoolSwitches),this.FCurrentBoolSwitches=rtl.refSet(e),s=rtl.diffSet(t,this.FCurrentBoolSwitches),29 in rtl.diffSet(this.FCurrentBoolSwitches,t)&&(this.UnsetNonToken(77),this.UnsetNonToken(68)),29 in s&&(this.SetNonToken(77),this.SetNonToken(68)))},this.SetCurrentModeSwitches=function(e){var t,s,r;e=rtl.intersectSet(e,this.FAllowedModeSwitches),rtl.eqSet(this.FCurrentModeSwitches,e)||(t=rtl.refSet(this.FCurrentModeSwitches),this.FCurrentModeSwitches=rtl.refSet(e),s=rtl.diffSet(this.FCurrentModeSwitches,t),r=rtl.diffSet(t,this.FCurrentModeSwitches),38 in s?(this.AddDefine("UNICODE",!1),this.AddDefine("FPC_UNICODESTRINGS",!1)):38 in r&&(this.UnDefine("UNICODE",!1),this.UnDefine("FPC_UNICODESTRINGS",!1)),22 in s?(this.AddDefine(i.LetterSwitchNames[7],!0),this.FCurrentBoolSwitches=rtl.includeSet(this.FCurrentBoolSwitches,7)):22 in r&&(this.UnDefine(i.LetterSwitchNames[7],!0),this.FCurrentBoolSwitches=rtl.excludeSet(this.FCurrentBoolSwitches,7)),rtl.eqSet(rtl.intersectSet(rtl.createSet(30,31),this.FCurrentModeSwitches),{})?(this.SetNonToken(83),this.SetNonToken(84),this.SetNonToken(82)):(this.UnsetNonToken(83),this.UnsetNonToken(84),this.UnsetNonToken(82)))},this.SetCurrentValueSwitch=function(e,t){e in this.FAllowedValueSwitches&&this.FCurrentValueSwitches[e]!==t&&(this.FCurrentValueSwitches[e]=t)},this.SetWarnMsgState=function(e,t){var s,i=C.$new();(s=this.IndexOfWarnMsgState(e,!0))<rtl.length(this.FWarnMsgStates)&&this.FWarnMsgStates[s].Number===e?0===t?this.FWarnMsgStates.splice(s,1):this.FWarnMsgStates[s].State=t:0!==t&&(i.Number=e,i.State=t,this.FWarnMsgStates=rtl.arrayInsert(i,this.FWarnMsgStates,s))},this.GetWarnMsgState=function(e){var t;return(t=this.IndexOfWarnMsgState(e,!1))<0?0:this.FWarnMsgStates[t].State},this.LogEvent=function(e){return e in this.FLogEvents},this.Create$1=function(e){var t=this;function s(){var e=null;return(e=R.$create("Create$1")).SetSorted(!0),e.FDuplicates=2,e}var r=0;y.Create.call(this),this.FFileResolver=e,this.FFiles=R.$create("Create$1"),this.FIncludeStack=ne.$create("Create"),this.FDefines=s(),this.FMacros=s(),this.FMaxIncludeStackDepth=20,this.FCurrentModeSwitches=rtl.refSet(i.FPCModeSwitches),this.FAllowedModeSwitches=rtl.refSet(i.msAllModeSwitches),this.FCurrentBoolSwitches=rtl.refSet(i.bsFPCMode),this.FAllowedBoolSwitches=rtl.refSet(i.bsAll),this.FAllowedValueSwitches=rtl.refSet(i.vsAllValueSwitches);for(var n=0;n<=2;n++)r=n,this.FCurrentValueSwitches[r]=i.DefaultValueSwitches[r];return this.FConditionEval=u.$create("Create$1",[!1]),this.FConditionEval.FOnLog=rtl.createCallback(t,"OnCondEvalLog"),this.FConditionEval.FOnEvalVariable=rtl.createCallback(t,"OnCondEvalVar"),this.FConditionEval.FOnEvalFunction=rtl.createCallback(t,"OnCondEvalFunction"),this},this.Destroy=function(){for(;this.FIncludeStack.FCount>0;)this.PopStackItem();re({p:this,get:function(){return this.p.FConditionEval},set:function(e){this.p.FConditionEval=e}}),this.ClearMacros(),re({p:this,get:function(){return this.p.FMacros},set:function(e){this.p.FMacros=e}}),re({p:this,get:function(){return this.p.FDefines},set:function(e){this.p.FDefines=e}}),this.ClearFiles(),re({p:this,get:function(){return this.p.FFiles},set:function(e){this.p.FFiles=e}}),re({p:this,get:function(){return this.p.FIncludeStack},set:function(e){this.p.FIncludeStack=e}}),y.Destroy.call(this)},this.RegisterResourceHandler=function(e,t){var s=0;""!==e&&("."===e.charAt(0)&&(e=g(e,2,e.length-1)),-1===(s=this.IndexOfResourceHandler(N(e)))&&(s=rtl.length(this.FResourceHandlers),this.FResourceHandlers=rtl.arraySetLength(this.FResourceHandlers,F,s+1),this.FResourceHandlers[s].Ext=N(e)),this.FResourceHandlers[s].Handler=t)},this.RegisterDirectiveHandler=function(e,t){var s,i=m.$new();""!==e&&((s=this.IndexOfDirectiveHandle(e,!0))<rtl.length(this.FDirectiveHandles)&&0===J(e,this.FDirectiveHandles[s].Directive)?(this.FDirectiveHandles[s].Directive=e,this.FDirectiveHandles[s].Handler=t):(i.Directive=e,i.Handler=t,this.FDirectiveHandles=rtl.arrayInsert(i,this.FDirectiveHandles,s)))},this.OpenFile=function(e){this.ClearFiles(),this.FCurSourceFile=this.FFileResolver.FindSourceFile(e),this.FCurFilename=e,this.AddFile(this.FCurFilename),this.LogEvent(0)&&this.DoLog$1(5,1007,rtl.getResStr(i,"SLogOpeningFile"),b(18,this.FormatPath(e)),!0)},this.FinishedModule=function(){1 in this.FLogEvents&&!this.FCurSourceFile.IsEOF()&&this.FCurRow%100>0&&this.DoLog$1(5,1008,rtl.getResStr(i,"SLogLineNumber"),b(0,this.FCurRow),!0)},this.FormatPath=function(e){return null!=this.FOnFormatPath?this.FOnFormatPath(e):e},this.FormatSrcPos=function(e){var t="";return t=this.FormatPath(e.FileName)+"("+x(e.Row),e.Column>0&&(t=t+","+x(e.Column)),t+=")"},this.FormatCurrentSrcPos=function(){return this.FormatSrcPos(this.CurSourcePos())},this.DisablePackageTokens=function(){this.FNonTokens=rtl.unionSet(this.FNonTokens,rtl.createSet(51,91,98))},this.SetNonToken=function(e){this.FNonTokens=rtl.includeSet(this.FNonTokens,e)},this.UnsetNonToken=function(e){this.FNonTokens=rtl.excludeSet(this.FNonTokens,e)},this.SetTokenOption=function(e){this.FTokenOptions=rtl.includeSet(this.FTokenOptions,e)},this.UnSetTokenOption=function(e){this.FTokenOptions=rtl.excludeSet(this.FTokenOptions,e)},this.CheckToken=function(e,t){var s=0;return s=e,3===e&&0===J(t,"operator")&&1 in this.FTokenOptions&&(s=87),s},this.FetchToken=function(){var e=0;this.FCurToken in rtl.createSet(1,118)||(this.FPreviousToken=this.FCurToken);for(;;){e=this.DoFetchToken();var t=this.FCurToken;if(0===t){if(!(this.FIncludeStack.FCount>0))break;this.PopStackItem(),e=this.FCurToken}else if(1===t||118===t){if(!this.FSkipWhiteSpace&&!this.PPIsSkipping)break}else if(2===t){if(!this.FSkipComments&&!this.PPIsSkipping)break}else if(100===t){if(8 in this.FOptions||(this.FCurToken=3,e=this.FCurToken),!this.FSkipComments&&!this.PPIsSkipping)break}else if(87===t){if(1 in this.FTokenOptions||(this.FCurToken=3,e=this.FCurToken),!this.FSkipComments&&!this.PPIsSkipping)break}else if(!this.PPIsSkipping)break}return e},this.ReadNonPascalTillEndToken=function(e){var t=this,s=0,n=0,l="",a=0;function o(){var e;0===(e=t.FTokenPos-n)?t.FCurTokenString="":(t.FCurTokenString=t.FCurTokenString+g(t.FCurLine,n,e),n=t.FTokenPos)}function h(){return o(),e?(s=118,t.FCurToken=118,t.FetchLine(),!0):t.FetchLine()?(l=t.FCurLine,a=l.length,n=t.FTokenPos,false):(s=0,t.FCurToken=0,!0)}for(s=0,this.FCurTokenString="",n=this.FTokenPos,l=this.FCurLine,a=l.length;;){if(this.FTokenPos>a&&h())return s;var u=l.charAt(this.FTokenPos-1);if("{"===u){if(17 in this.FOptions){s=this.HandleMultilineComment();break}this.FTokenPos+=1}else if("'"===u)for(this.FTokenPos+=1;;){this.FTokenPos>a&&this.Error(1002,rtl.getResStr(i,"SErrOpenString"));var c=l.charAt(this.FTokenPos-1);if("'"===c){this.FTokenPos+=1;break}if("\n"===c||"\r"===c)break;this.FTokenPos+=1}else if('"'===u)for(this.FTokenPos+=1;;){this.FTokenPos>a&&this.Error(1002,rtl.getResStr(i,"SErrOpenString"));var p=l.charAt(this.FTokenPos-1);if('"'===p){this.FTokenPos+=1;break}if("\n"===p||"\r"===p)break;this.FTokenPos+=1}else if("/"===u){if(this.FTokenPos+=1,this.FTokenPos<=a&&"/"===l.charAt(this.FTokenPos-1))do{this.FTokenPos+=1}while(!(this.FTokenPos>a||l.charCodeAt(this.FTokenPos-1)in rtl.createSet(10,13)))}else if("@"===u||u>="0"&&u<="9"||u>="A"&&u<="Z"||u>="a"&&u<="z"||"_"===u){if("end"===g(l,this.FTokenPos,3).toLowerCase()&&(this.FTokenPos+3>a||!(l.charCodeAt(this.FTokenPos+3-1)in r.IdentChars)))return o(),""!==this.FCurTokenString?(s=1,this.FCurToken=s,s):(s=this.PPIsSkipping?1:58,this.FCurTokenString=g(l,this.FTokenPos,3),this.FTokenPos+=3,this.FCurToken=s,s);for(this.FTokenPos<=a&&"@"===l.charAt(this.FTokenPos-1)&&(this.FTokenPos+=1);this.FTokenPos<=a&&l.charCodeAt(this.FTokenPos-1)in r.IdentChars;)this.FTokenPos+=1}else this.FTokenPos+=1}return s},this.AddDefine=function(e,t){return!(this.FDefines.IndexOf(e)>=0)&&(this.FDefines.Add(e),!t&&this.LogEvent(2)&&this.DoLog$1(5,1026,rtl.getResStr(i,"SLogMacroDefined"),b(18,e),!1),true)},this.RemoveDefine=function(e,t){var s;return!((s=this.FDefines.IndexOf(e))<0)&&(this.FDefines.Delete(s),!t&&this.LogEvent(2)&&this.DoLog$1(5,1027,rtl.getResStr(i,"SLogMacroUnDefined"),b(18,e),!1),true)},this.UnDefine=function(e,t){var s=!1;return s=this.RemoveDefine(e,t),this.RemoveMacro(e,t)&&(s=!0),s},this.IsDefined=function(e){return this.FDefines.IndexOf(e)>=0||this.FMacros.IndexOf(e)>=0},this.IfOpt=function(e){return(e=_(e)).charCodeAt()in rtl.createSet(null,65,90)&&""!==i.LetterSwitchNames[e.charCodeAt()-65]&&this.IsDefined(i.LetterSwitchNames[e.charCodeAt()-65])},this.AddMacro=function(e,t,s){var r;if(-1===(r=this.FMacros.IndexOf(e)))this.FMacros.AddObject(e,n.$create("Create$1",[e,t]));else{if(this.FMacros.GetObject(r).FValue===t)return!1;this.FMacros.GetObject(r).FValue=t}return!s&&this.LogEvent(2)&&this.DoLog$1(5,1030,rtl.getResStr(i,"SLogMacroXSetToY"),b(18,e,18,t),!1),true},this.RemoveMacro=function(e,t){var s;return!((s=this.FMacros.IndexOf(e))<0)&&(this.FMacros.GetObject(s).$destroy("Destroy"),this.FMacros.Delete(s),!t&&this.LogEvent(2)&&this.DoLog$1(5,1027,rtl.getResStr(i,"SLogMacroUnDefined"),b(18,e),!1),true)},this.CurSourcePos=function(){var e=d.$new();return e.FileName=this.FCurFilename,e.Row=this.FCurRow,e.Column=this.GetCurColumn(),e},this.SetForceCaret=function(e){var t;return t=0 in this.FTokenOptions,this.FTokenOptions=e?rtl.includeSet(this.FTokenOptions,0):rtl.excludeSet(this.FTokenOptions,0),t},this.IgnoreMsgType=function(e){var t=e;if(2===t){if(!(24 in this.FCurrentBoolSwitches))return!0}else if(3===t){if(!(23 in this.FCurrentBoolSwitches))return!0}else if(4===t&&!(22 in this.FCurrentBoolSwitches))return!0;return false}}),this.TokenInfos=["EOF","Whitespace","Comment","Identifier","String","StringMultiLine","Number","Character","(",")","*","+",",","-",".","/",":",";","<","=",">","@","[","]","^","\\","..",":=","<>","<=",">=","**","><","+=","-=","*=","/=","@@","...","absolute","and","array","as","asm","begin","bitpacked","case","class","const","constref","constructor","contains","destructor","dispinterface","div","do","downto","else","end","except","exports","false","file","finalization","finally","for","function","generic","goto","if","implementation","in","inherited","initialization","inline","interface","is","label","library","mod","nil","not","objccategory","objcclass","objcprotocol","object","of","operator","or","otherwise","packed","package","procedure","program","property","raise","record","repeat","requires","resourcestring","self","set","shl","shr","specialize","then","threadvar","to","true","try","type","unit","until","uses","var","while","with","xor","LineEnding","Tab"],this.SModeSwitchNames=["","","","","","","","","","","CLASS","OBJPAS","RESULT","PCHARTOSTRING","CVAR","NESTEDCOMMENTS","CLASSICPROCVARS","MACPROCVARS","REPEATFORWARD","POINTERTOPROCVAR","AUTODEREF","INITFINAL","ANSISTRINGS","OUT","DEFAULTPARAMETERS","HINTDIRECTIVE","DUPLICATELOCALS","PROPERTIES","ALLOWINLINE","EXCEPTIONS","OBJECTIVEC1","OBJECTIVEC2","NESTEDPROCVARS","NONLOCALGOTO","ADVANCEDRECORDS","ISOUNARYMINUS","SYSTEMCODEPAGE","FINALFIELDS","UNICODESTRINGS","TYPEHELPERS","CBLOCKS","ISOIO","ISOPROGRAMPARAS","ISOMOD","ARRAYOPERATORS","MULTIHELPERS","ARRAY2DYNARRAYS","PREFIXEDATTRIBUTES","UNDERSCOREISSEPARARTOR","IMPLICITFUNCTIONSPECIALIZATION","FUNCTIONREFERENCES","ANONYMOUSFUNCTIONS","EXTERNALCLASS","OMITRTTI","MULTILINESTRINGS","DELPHIMULTILINESTRINGS","INLINEVARS"],this.LetterSwitchNames=["ALIGN","BOOLEVAL","ASSERTIONS","DEBUGINFO","EXTENSION","","IMPORTEDDATA","LONGSTRINGS","IOCHECKS","WRITEABLECONST","","LOCALSYMBOLS","TYPEINFO","","OPTIMIZATION","OPENSTRINGS","OVERFLOWCHECKS","RANGECHECKS","","TYPEDADDRESS","SAFEDIVIDE","VARSTRINGCHECKS","STACKFRAMES","EXTENDEDSYNTAX","REFERENCEINFO",""],this.BoolSwitchNames=["None","Align","BoolEval","Assertions","DebugInfo","Extension","ImportedData","LongStrings","IOChecks","WriteableConst","LocalSymbols","TypeInfo","Optimization","OpenStrings","OverflowChecks","RangeChecks","TypedAddress","SafeDivide","VarStringChecks","Stackframes","ExtendedSyntax","ReferenceInfo","Hints","Notes","Warnings","Macro","ScopedEnums","ObjectChecks","PointerMath","Goto"],this.ValueSwitchNames=["Interfaces","DispatchField","DispatchStrField"],this.MessageTypeNames=["Fatal","Error","Warning","Note","Hint","Info","Debug"],this.msAllModeSwitches=rtl.createSet(null,e.msNone,e.msInlineVars),this.AllLanguageModes=rtl.createSet(null,1,9),this.DelphiModeSwitches=rtl.createSet(3,10,11,12,13,19,20,16,21,22,23,24,26,25,27,28,29,34,39,47,44,49,50,51,55,56),this.DelphiUnicodeModeSwitches=rtl.unionSet(this.DelphiModeSwitches,rtl.createSet(36,38)),this.FPCModeSwitches=rtl.createSet(1,13,15,18,14,21,25,27,28),this.OBJFPCModeSwitches=rtl.createSet(2,10,11,12,13,15,18,14,21,23,24,25,27,28,29),this.TPModeSwitches=rtl.createSet(5,16,26),this.GPCModeSwitches=rtl.createSet(9,16),this.MacModeSwitches=rtl.createSet(6,14,17,32,33,35,28),this.ISOModeSwitches=rtl.createSet(7,16,26,32,33,35,41,42,43),this.ExtPasModeSwitches=rtl.createSet(8,16,26,32,33,35,41,42,43),this.StrToModeSwitch=function(e){var t=0;if(""===(e=w(e)))return 0;for(var s=0;s<=56;s++)if(t=s,i.SModeSwitchNames[t]===e)return t;return 0},this.FilenameIsAbsolute=function(e){return i.FilenameIsUnixAbsolute(e)},this.FilenameIsUnixAbsolute=function(e){return""!==e&&"/"===e.charAt(0)},this.ExtractFilenameOnly=function(e){return Z(ee(e),"")},this.CreateMsgArgs=function(e,t){var s=0,i=void 0;e.set(rtl.arraySetLength(e.get(),"",rtl.length(t)-1-0+1));for(var r=0,n=rtl.length(t)-1;r<=n;r++)i=t[s=r],ae(i)?e.get()[s]=oe(!(0==i),!1):rtl.isString(i)?e.get()[s]=""+i:rtl.isNumber(i)?he(i)?e.get()[s]=""+rtl.trunc(i):e.get()[s]=rtl.floatToStr(rtl.getNumber(i)):e.get()[s]=""},this.SafeFormat=function(e,t){var s="",r=[],n=0;try{s=H(e,t)}catch(o){s="",r=[],i.CreateMsgArgs({get:function(){return r},set:function(e){r=e}},t);for(var l=0,a=rtl.length(r)-1;l<=a;l++)(n=l)>0&&(s+=","),s+=r[n];s="{"+e+"}["+s+"]"}return s},i.$resourcestrings={SErrInvalidCharacter:{org:"Invalid character '%s'"},SErrOpenString:{org:"string exceeds end of line"},SErrIncludeFileNotFound:{org:"Could not find include file '%s'"},SErrResourceFileNotFound:{org:"Could not find resource file '%s'"},SErrIfXXXNestingLimitReached:{org:"Nesting of $IFxxx too deep"},SErrInvalidPPElse:{org:"$ELSE without matching $IFxxx"},SErrInvalidPPEndif:{org:"$ENDIF without matching $IFxxx"},SLogOpeningFile:{org:'Opening source file "%s".'},SLogLineNumber:{org:"Reading line %d."},SLogIFDefAccepted:{org:"IFDEF %s found, accepting."},SLogIFDefRejected:{org:"IFDEF %s found, rejecting."},SLogIFNDefAccepted:{org:"IFNDEF %s found, accepting."},SLogIFNDefRejected:{org:"IFNDEF %s found, rejecting."},SLogIFAccepted:{org:"IF %s found, accepting."},SLogIFRejected:{org:"IF %s found, rejecting."},SLogIFOptAccepted:{org:"IFOpt %s found, accepting."},SLogIFOptRejected:{org:"IFOpt %s found, rejecting."},SLogELSEIFAccepted:{org:"ELSEIF %s found, accepting."},SLogELSEIFRejected:{org:"ELSEIF %s found, rejecting."},SErrInvalidMode:{org:'Invalid mode: "%s"'},SErrInvalidModeSwitch:{org:'Invalid mode switch: "%s"'},SErrXExpectedButYFound:{org:'"%s" expected, but "%s" found'},SErrRangeCheck:{org:"range check failed"},SErrDivByZero:{org:"division by zero"},SErrOperandAndOperatorMismatch:{org:"operand and operator mismatch"},SUserDefined:{org:'User defined: "%s"'},SLogMacroDefined:{org:"Macro defined: %s"},SLogMacroUnDefined:{org:"Macro undefined: %s"},SWarnIllegalCompilerDirectiveX:{org:'Illegal compiler directive "%s"'},SIllegalStateForWarnDirective:{org:'Illegal state "%s" for $WARN directive'},SErrIncludeLimitReached:{org:"Include file limit reached"},SMisplacedGlobalCompilerSwitch:{org:"Misplaced global compiler switch, ignored"},SLogMacroXSetToY:{org:"Macro %s set to %s"},SInvalidDispatchFieldName:{org:"Invalid Dispatch field name"},SErrWrongSwitchToggle:{org:"Wrong switch toggle, use ON/OFF or +/-"},SNoResourceSupport:{org:'No support for resources of type "%s"'},SErrInvalidMultiLineLineEnding:{org:"Invalid multilinestring line ending type: use one of CR/LF/CRLF/SOURCE/PLATFORM"},SWarnIgnoringLinkLib:{org:"Ignoring LINKLIB directive %s -> %s (Options: %s)"},SErrInvalidIndent:{org:" Inconsistent indent characters"},SErrMultilineNonWhiteSpaceBeforeClosing:{org:"There should be no white-space characters before closing quotes of the text block"}},i.$implcode=function(){W=pas.strutils,Y=W.LeftStr,r.IdentChars=rtl.createSet(null,48,57,null,65,90,null,97,122,95),r.Digits=rtl.createSet(null,48,57),r.Letters=rtl.createSet(null,97,122,null,65,90),r.HexDigits=rtl.createSet(null,48,57,null,97,102,null,65,70),r.SingleQuote="'",rtl.createClass(r,"TIncludeStackItem",y,function(){S=this,this.$init=function(){y.$init.call(this),this.SourceFile=null,this.Filename="",this.Token=0,this.TokenString="",this.Line="",this.Row=0,this.ColumnOffset=0,this.TokenPos=0},this.$final=function(){this.SourceFile=void 0,y.$final.call(this)}})}},["strutils"]),rtl.module("Pas2JSFS",["System","Classes","SysUtils","PScanner","fpjson"],function(){"use strict";var e=this,t=null,s=pas.SysUtils,i=s.Exception,r=pas.PScanner,n=r.TLineReader,l=pas.System,a=l.Copy,o=l.TObject,h=s.CompareText,u=r.TBaseFileResolver;this.nUsingPath=104,this.sUsingPath='Using %s: "%s"',this.nFolderNotFound=105,this.sFolderNotFound="%s not found: %s",this.nDuplicateFileFound=205,this.sDuplicateFileFound='Duplicate file found: "%s" and "%s"',this.nCustomJSFileNotFound=206,rtl.createClass(this,"EPas2jsFS",i,function(){0}),rtl.createClass(this,"TSourceLineReader",n,function(){this.$init=function(){n.$init.call(this),this.FIsEOF=!1,this.FLineNumber=0,this.FSource="",this.FSrcPos=0},this.IncLineNumber=function(){this.FLineNumber+=1},this.Create$2=function(e,t){return n.Create$1.call(this,e),this.FSource=t,this.FSrcPos=1,this.FIsEOF=""===this.FSource,this},this.IsEOF=function(){return this.FIsEOF},this.ReadLine=function(){var e,t=this,s="",i="",r=0;function n(){var e;e=r-t.FSrcPos,s=a(i,t.FSrcPos,e),t.FSrcPos=r,t.IncLineNumber()}if(this.FIsEOF)return"";for(e=(i=this.FSource).length,r=this.FSrcPos;r<=e;){var l=i.charAt(r-1);if("\n"===l||"\r"===l)return n(),(r+=1)<=e&&i.charCodeAt(r-1)in rtl.createSet(10,13)&&i.charAt(r-1)!==i.charAt(r-1-1)&&(r+=1),r>e&&(this.FIsEOF=!0),this.FSrcPos=r,s;r+=1}return this.FIsEOF=!0,n(),s}}),this.TP2jsFSOption={0:"caoShowFullFilenames",caoShowFullFilenames:0,1:"caoShowTriedUsedFiles",caoShowTriedUsedFiles:1,2:"caoSearchLikeFPC",caoSearchLikeFPC:2,3:"caoStrictFileCase",caoStrictFileCase:3},this.TKeyCompareType={0:"kcFilename",kcFilename:0,1:"kcUnitName",kcUnitName:1},rtl.createClass(this,"TPas2JSFS",o,function(){this.$init=function(){o.$init.call(this),this.FOptions={},this.FReadLineCounter=0,this.FDefaultOutputPath="",this.FUnitOutputPath=""},this.$final=function(){this.FOptions=void 0,o.$final.call(this)},this.SetOptionFromIndex=function(e,t){this.SetOption(e,t)},this.SetOption=function(e,t){this.FOptions=t?rtl.includeSet(this.FOptions,e):rtl.excludeSet(this.FOptions,e)},this.SameFileName=function(e,t){return 0===h(e,t)},this.File1IsNewer=function(e,t){return false},this.ExpandDirectory=function(e){return e},this.ExpandFileName=function(e){return e},this.FormatPath=function(e){return e},this.DirectoryExists=function(e){return""===e},this.TryCreateRelativePath=function(e,t,s,i,r){return r.set(e),true},this.WriteFoldersAndSearchPaths=function(){},this.CreateResolver=function(){return t.$create("Create$2",[this])},this.AddForeignUnitPath=function(e,t){return""},this.HandleOptionPaths=function(e,t,s){return"Invalid parameter: -F"+e+t},this.Create$1=function(){return this.FOptions=rtl.refSet(e.DefaultPas2jsFSOptions),this},this.Reset=function(){this.FReadLineCounter=0,this.FUnitOutputPath="",this.FDefaultOutputPath=""},this.IncReadLineCounter=function(){this.FReadLineCounter+=1}}),rtl.createClass(this,"TPas2jsFile",o,function(){this.$init=function(){o.$init.call(this),this.FFilename="",this.FFS=null,this.FSource=""},this.$final=function(){this.FFS=void 0,o.$final.call(this)},this.SetSource=function(e){this.FSource=e},this.Create$1=function(e,t){return this.FFS=e,this.FFilename=t,this}}),rtl.createClass(this,"TPas2jsFSResolver",u,function(){t=this,this.$init=function(){u.$init.call(this),this.FFS=null},this.$final=function(){this.FFS=void 0,u.$final.call(this)},this.Create$2=function(e){return u.Create$1.call(this),this.FFS=e,this},this.FindResourceFileName=function(e){return this.FFS.FindResourceFileName(e,this.FBaseDirectory)},this.FindIncludeFile=function(e){var t,s=null;if(s=null,""===(t=this.FFS.FindIncludeFileName(e,this.FBaseDirectory,this.FModuleDirectory,this.FMode)))return s;try{s=this.FindSourceFile(t)}catch(e){}return s},this.FindSourceFile=function(e){var t;return t=this.FFS.FindSourceFileName(e),this.FFS.LoadFile(t,!1).CreateLineReader(!1)}}),this.p2jsfcoCaption=["Show full filenames","Show tried/used files","Search files like FPC","Strict file case"],this.DefaultPas2jsFSOptions={}}),rtl.module("webfilecache",["System","Classes","SysUtils","JS","Web","fpjson","Pas2JSFS","PScanner","contnrs"],function(){"use strict";var e=null,t=null,s=null,i=null,r=null,n=null,l=null,a=pas.System,o=a.TObject,h=pas.contnrs.TFPObjectHashTable,u=pas.SysUtils,c=u.FreeAndNil,p=pas.PScanner.EFileNotFoundError,f=pas.Pas2JSFS,d=f.TPas2jsFile,F=f.TSourceLineReader,m=f.TPas2JSFS,C=u.LowerCase,S=u.ExtractFileName,T=a.Writeln,y=u.IncludeTrailingPathDelimiter,g=f.TPas2jsFSResolver;rtl.createClass(this,"TWebFileContent",o,function(){e=this,this.$init=function(){o.$init.call(this),this.FContents="",this.FFileName="",this.FModified=!1},this.SetContents=function(e){this.FContents!==e&&(this.FContents=e,this.FModified=!0)},this.Create$1=function(e,t){return this.FContents=t,this.FFileName=e,this}}),rtl.createClass(this,"TWebFilesCache",o,function(){t=this,this.$init=function(){o.$init.call(this),this.FFiles=null},this.$final=function(){this.FFiles=void 0,o.$final.call(this)},this.FindFile=function(e){var t;return null===(t=this.FFiles.Find(e))?null:t.FData},this.Create$1=function(){return this.FFiles=h.$create("Create$2",[!0]),this},this.Destroy=function(){c({p:this,get:function(){return this.p.FFiles},set:function(e){this.p.FFiles=e}}),o.Destroy.call(this)},this.HasFile=function(e){return null!==this.FindFile(e)},this.GetFileContent=function(e){var t;if(null==(t=this.FindFile(e)))throw p.$create("Create$1",["No such file "+e]);return t.FContents},this.SetFileContent=function(t,s){var i,r=null;return(i=null!=(r=this.FindFile(t)))?r.SetContents(s):this.FFiles.Add(t,e.$create("Create$1",[t,s])),i}}),rtl.createClass(this,"TPas2jsWebFile",d,function(){s=this,this.CreateLineReader=function(e){var t=null;return this.Load(e,!1)?(t=i.$create("Create$2",[this.FFilename,this.FSource])).FFS=this.FFS:t=null,t},this.Load=function(e,t){var s=!1;s=!1;var i=rtl.as(this.FFS,n).FCache;if(i.HasFile(this.FFilename)&&(this.SetSource(i.GetFileContent(this.FFilename)),s=!0),!s&&e)throw p.$create("Create$1",["File not loaded "+this.FFilename]);return s}}),rtl.createClass(this,"TWebSourceLineReader",F,function(){i=this,this.$init=function(){F.$init.call(this),this.FFS=null},this.$final=function(){this.FFS=void 0,F.$final.call(this)},this.IncLineNumber=function(){null!==this.FFS&&this.FFS.IncReadLineCounter(),F.IncLineNumber.call(this)}}),rtl.createClass(this,"TLoadFileRequest",o,function(){r=this,this.$init=function(){o.$init.call(this),this.FFS=null,this.FFileName="",this.FXML=null,this.FOnLoaded=null},this.$final=function(){this.FFS=void 0,this.FXML=void 0,this.FOnLoaded=void 0,o.$final.call(this)},this.DoChange=function(){var e="",t=this.FXML.readyState;0===t||1===t||2===t||3===t||4===t&&(2===rtl.trunc(this.FXML.status/100)?(e="",this.FFS.SetFileContent(this.FFileName,this.FXML.responseText)):e="Error loading file: "+this.FXML.statusText,null!=this.FOnLoaded&&this.FOnLoaded(this.FFS,this.FFileName,e),null!=this.FFS.FOnLoadedFile&&this.FFS.FOnLoadedFile(this.FFS,this.FFileName,e),this.Free())},this.Create$1=function(e,t,s){return this.FFS=e,this.FOnLoaded=s,this.FFileName=t,this},this.DoLoad=function(e){this.FXML=new XMLHttpRequest,this.FXML.onreadystatechange=rtl.createSafeCallback(this,"DoChange"),this.FXML.open("GET",e),this.FXML.send()}}),rtl.createClass(this,"TPas2jsWebFS",m,function(){n=this,this.$init=function(){m.$init.call(this),this.FCache=null,this.FLoadBaseURL="",this.FOnLoadedFile=null},this.$final=function(){this.FCache=void 0,this.FOnLoadedFile=void 0,m.$final.call(this)},this.NormalizeFileName=function(e){return C(S(e))},this.FindSourceFileName=function(e){var t="";return t=this.$class.NormalizeFileName(e),this.FCache.HasFile(t)||(t=""),t},this.Create$1=function(){return m.Create$1.call(this),this.FCache=t.$create("Create$1"),this},this.CreateResolver=function(){return l.$create("Create$2",[this])},this.FileExists=function(e){return this.FCache.HasFile(this.$class.NormalizeFileName(e))},this.FindCustomJSFileName=function(e){var t="";return t=this.$class.NormalizeFileName(e),this.FCache.HasFile(t)||(t=""),t},this.FindIncludeFileName=function(e,t,s,i){var r="";return r=this.$class.NormalizeFileName(e),this.FCache.HasFile(r)||(r=""),r},this.FindUnitFileName=function(e,t,s,i){var r;return r=this.$class.NormalizeFileName(e+".pas"),i.set(!1),r},this.FindUnitJSFileName=function(e){return this.$class.NormalizeFileName(e)},this.LoadFile=function(e,t){var i=null;return(i=s.$create("Create$1",[this,e])).Load(!0,!1),i},this.SaveToFile=function(e,t){var s="",i=0,r=void 0;s="";for(var n=0,l=e.length-1;n<=l;n++)r=e[i=n],T("Char ",i,"(",r,") : ",String.fromCharCode(r)),s+=String.fromCharCode(e[i]);this.SetFileContent(t,s)},this.SetFileContent=function(e,t){return this.FCache.SetFileContent(this.$class.NormalizeFileName(e),t)},this.GetFileContent=function(e){return this.FCache.GetFileContent(this.$class.NormalizeFileName(e))},this.LoadFile$2=function(e,t){var s,i,n="";return i=this.$class.NormalizeFileName(e),(s=!this.FCache.HasFile(i))?(n=y(this.FLoadBaseURL)+i,r.$create("Create$1",[this,e,t]).DoLoad(n)):null!=t&&t(this,e,""),s},this.LoadFiles$1=function(e,t){var s=0,i=0;s=0;for(var r=0,n=rtl.length(e)-1;r<=n;r++)i=r,this.LoadFile$2(e[i],t)&&(s+=1);return s}}),rtl.createClass(this,"TPas2jsWebResolver",g,function(){l=this})}),rtl.module("PasTree",["System","SysUtils","Classes"],function(){"use strict";var e,t=this,s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=null,R=null,v=null,A=null,N=null,x=null,b=null,O=null,k=null,$=null,D=null,L=null,B=null,M=null,G=null,w=null,V=null,U=null,J=pas.SysUtils,j=J.Exception,H=pas.System,W=H.TObject,Y=H.Pos,z=J.LowerCase,_=pas.Classes,K=_.TFPList,X=J.FreeAndNil,q=J.SameText,Q=_.TStringList,Z=J.IntToStr,ee=J.CompareText;rtl.createClass(this,"EPasTree",j,function(){s=this}),rtl.createClass(this,"TPasElementBase",W,function(){i=this,this.$init=function(){W.$init.call(this),this.FData=null},this.$final=function(){this.FData=void 0,W.$final.call(this)}}),this.TPasMemberVisibility={0:"visDefault",visDefault:0,1:"visPrivate",visPrivate:1,2:"visProtected",visProtected:2,3:"visPublic",visPublic:3,4:"visPublished",visPublished:4,5:"visAutomated",visAutomated:5,6:"visStrictPrivate",visStrictPrivate:6,7:"visStrictProtected",visStrictProtected:7,8:"visRequired",visRequired:8,9:"visOptional",visOptional:9},this.TCallingConvention={0:"ccDefault",ccDefault:0,1:"ccRegister",ccRegister:1,2:"ccPascal",ccPascal:2,3:"ccCDecl",ccCDecl:3,4:"ccStdCall",ccStdCall:4,5:"ccOldFPCCall",ccOldFPCCall:5,6:"ccSafeCall",ccSafeCall:6,7:"ccSysCall",ccSysCall:7,8:"ccMWPascal",ccMWPascal:8,9:"ccHardFloat",ccHardFloat:9,10:"ccSysV_ABI_Default",ccSysV_ABI_Default:10,11:"ccSysV_ABI_CDecl",ccSysV_ABI_CDecl:11,12:"ccMS_ABI_Default",ccMS_ABI_Default:12,13:"ccMS_ABI_CDecl",ccMS_ABI_CDecl:13,14:"ccVectorCall",ccVectorCall:14,15:"ccWinApi",ccWinApi:15},this.TProcTypeModifier={0:"ptmOfObject",ptmOfObject:0,1:"ptmIsNested",ptmIsNested:1,2:"ptmStatic",ptmStatic:2,3:"ptmVarargs",ptmVarargs:3,4:"ptmReferenceTo",ptmReferenceTo:4,5:"ptmAsync",ptmAsync:5,6:"ptmFar",ptmFar:6,7:"ptmCblock",ptmCblock:7},this.TPackMode={0:"pmNone",pmNone:0,1:"pmPacked",pmPacked:1,2:"pmBitPacked",pmBitPacked:2},this.TPasMemberHint={0:"hDeprecated",hDeprecated:0,1:"hLibrary",hLibrary:1,2:"hPlatform",hPlatform:2,3:"hExperimental",hExperimental:3,4:"hUnimplemented",hUnimplemented:4},rtl.createClass(this,"TPasElement",i,function(){r=this,this.FLastPasElementId=0,this.$init=function(){i.$init.call(this),this.FDocComment="",this.FName="",this.FParent=null,this.FHints={},this.FHintMessage="",this.FPasElementId=0,this.SourceFilename="",this.SourceLinenumber=0,this.SourceEndLinenumber=0,this.Visibility=0},this.$final=function(){this.FParent=void 0,this.FHints=void 0,i.$final.call(this)},this.SetParent=function(e){this.FParent=e},this.Create$1=function(e,t){return W.Create.call(this),this.FName=e,this.FParent=t,r.FLastPasElementId+=1,this.FPasElementId=this.FLastPasElementId,this},this.Destroy=function(){this.FParent=null,W.Destroy.call(this)};this.IsKeyWord=function(e){return 0!==Y(";"+z(e)+";",";absolute;and;array;asm;begin;case;const;constructor;destructor;div;do;downto;else;end;file;for;function;goto;if;implementation;in;inherited;inline;interface;label;mod;nil;not;object;of;on;operator;or;packed;procedure;program;record;reintroduce;repeat;self;set;shl;shr;TPasTreeString;then;to;type;unit;until;uses;var;while;with;xor;dispose;exit;false;new;true;as;class;dispinterface;except;exports;finalization;finally;initialization;inline;is;library;on;out;packed;property;raise;resourcestring;threadvar;try;private;published;length;setlength;")},this.ForEachCall=function(e,t){e(this,t)},this.ForEachChildCall=function(e,t,s,i){null!==s&&(i&&!s.HasParent(this)||s.ForEachCall(e,t))},this.SafeName=function(){var e="";return e=this.FName,this.$class.IsKeyWord(e)&&(e="&"+e),e},this.FullPath=function(){var e="",t=null;for(e="",t=this.FParent;null!=t&&!t.$class.InheritsFrom(o);)""===t.FName||x.isPrototypeOf(t)||(e=e.length>0?t.FName+"."+e:t.FName),t=t.FParent;return e},this.ParentPath=function(){var e="",t=null;for(e="",t=this.FParent;null!=t;)""===t.FName||x.isPrototypeOf(t)||(e=e.length>0?t.FName+"."+e:t.FName),t=t.FParent;return e},this.FullName=function(){var e="";return e=""!==(e=this.FullPath())?e+"."+this.FName:this.FName},this.PathName=function(){var e="";return e=""!==(e=this.ParentPath())?e+"."+this.FName:this.FName},this.GetModule=function(){var e=null,t=null;if(F.isPrototypeOf(this))e=null;else{for(t=this;null!==t&&!d.isPrototypeOf(t);)t=t.FParent;e=t}return e},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeElement")},this.HasParent=function(e){var t=null;for(t=this.FParent;null!==t;){if(t===e)return!0;t=t.FParent}return false}}),this.TPasExprKind={0:"pekIdent",pekIdent:0,1:"pekNumber",pekNumber:1,2:"pekString",pekString:2,3:"pekStringMultiLine",pekStringMultiLine:3,4:"pekSet",pekSet:4,5:"pekNil",pekNil:5,6:"pekBoolConst",pekBoolConst:6,7:"pekRange",pekRange:7,8:"pekUnary",pekUnary:8,9:"pekBinary",pekBinary:9,10:"pekFuncParams",pekFuncParams:10,11:"pekArrayParams",pekArrayParams:11,12:"pekListOfExp",pekListOfExp:12,13:"pekInherited",pekInherited:13,14:"pekSelf",pekSelf:14,15:"pekSpecialize",pekSpecialize:15,16:"pekProcedure",pekProcedure:16},this.TExprOpCode={0:"eopNone",eopNone:0,1:"eopAdd",eopAdd:1,2:"eopSubtract",eopSubtract:2,3:"eopMultiply",eopMultiply:3,4:"eopDivide",eopDivide:4,5:"eopDiv",eopDiv:5,6:"eopMod",eopMod:6,7:"eopPower",eopPower:7,8:"eopShr",eopShr:8,9:"eopShl",eopShl:9,10:"eopNot",eopNot:10,11:"eopAnd",eopAnd:11,12:"eopOr",eopOr:12,13:"eopXor",eopXor:13,14:"eopEqual",eopEqual:14,15:"eopNotEqual",eopNotEqual:15,16:"eopLessThan",eopLessThan:16,17:"eopGreaterThan",eopGreaterThan:17,18:"eopLessthanEqual",eopLessthanEqual:18,19:"eopGreaterThanEqual",eopGreaterThanEqual:19,20:"eopIn",eopIn:20,21:"eopIs",eopIs:21,22:"eopAs",eopAs:22,23:"eopSymmetricaldifference",eopSymmetricaldifference:23,24:"eopAddress",eopAddress:24,25:"eopDeref",eopDeref:25,26:"eopMemAddress",eopMemAddress:26,27:"eopSubIdent",eopSubIdent:27},rtl.createClass(this,"TPasExpr",r,function(){n=this,this.$init=function(){r.$init.call(this),this.Kind=0,this.OpCode=0,this.Format1=null,this.Format2=null},this.$final=function(){this.Format1=void 0,this.Format2=void 0,r.$final.call(this)},this.Create$2=function(e,t,s){return r.Create$1.call(this,this.$classname,e),this.Kind=t,this.OpCode=s,this}}),rtl.createClass(this,"TUnaryExpr",n,function(){this.$init=function(){n.$init.call(this),this.Operand=null},this.$final=function(){this.Operand=void 0,n.$final.call(this)},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Operand,!1)}}),rtl.createClass(this,"TBinaryExpr",n,function(){l=this,this.$init=function(){n.$init.call(this),this.Left=null,this.Right=null},this.$final=function(){this.Left=void 0,this.Right=void 0,n.$final.call(this)},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Left,!1),this.ForEachChildCall(e,t,this.Right,!1)},this.IsRightSubIdent=function(e){var t;return!(null===e||!l.isPrototypeOf(e.FParent))&&((t=e.FParent).Right===e&&27===t.OpCode)}}),rtl.createClass(this,"TPrimitiveExpr",n,function(){this.$init=function(){n.$init.call(this),this.Value=""},this.Create$3=function(e,t,s){return n.Create$2.call(this,e,t,0),this.Value=s,this}}),rtl.createClass(this,"TBoolConstExpr",n,function(){this.$init=function(){n.$init.call(this),this.Value=!1}}),rtl.createClass(this,"TNilExpr",n,function(){0}),rtl.createClass(this,"TInheritedExpr",n,function(){0}),rtl.createClass(this,"TSelfExpr",n,function(){0}),rtl.createClass(this,"TParamsExpr",n,function(){this.$init=function(){n.$init.call(this),this.Value=null,this.Params=[]},this.$final=function(){this.Value=void 0,this.Params=void 0,n.$final.call(this)},this.AddParam=function(e){var t;t=rtl.length(this.Params),this.Params=rtl.arraySetLength(this.Params,null,t+1),this.Params[t]=e},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Value,!1);for(var i=0,n=rtl.length(this.Params)-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,this.Params[s],!1)}}),rtl.recNewT(this,"TRecordValuesItem",function(){a=this,this.Name="",this.NameExp=null,this.ValueExp=null,this.$eq=function(e){return this.Name===e.Name&&this.NameExp===e.NameExp&&this.ValueExp===e.ValueExp},this.$assign=function(e){return this.Name=e.Name,this.NameExp=e.NameExp,this.ValueExp=e.ValueExp,this}}),rtl.createClass(this,"TRecordValues",n,function(){this.$init=function(){n.$init.call(this),this.Fields=[]},this.$final=function(){this.Fields=void 0,n.$final.call(this)},this.Destroy=function(){this.Fields=[],r.Destroy.call(this)},this.AddField=function(e,t){var s;s=rtl.length(this.Fields),this.Fields=rtl.arraySetLength(this.Fields,a,s+1),this.Fields[s].Name=e.Value,this.Fields[s].NameExp=e,e.SetParent(this),this.Fields[s].ValueExp=t,t.SetParent(this)},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=rtl.length(this.Fields)-1;i<=n;i++){s=i;var l=this.Fields[s];null!==l.NameExp&&this.ForEachChildCall(e,t,l.NameExp,!1),null!==l.ValueExp&&this.ForEachChildCall(e,t,l.ValueExp,!1)}}}),rtl.createClass(this,"TArrayValues",n,function(){this.$init=function(){n.$init.call(this),this.Values=[]},this.$final=function(){this.Values=void 0,n.$final.call(this)},this.Destroy=function(){this.Values=[],r.Destroy.call(this)},this.AddValues=function(e){var t;t=rtl.length(this.Values),this.Values=rtl.arraySetLength(this.Values,null,t+1),this.Values[t]=e,e.SetParent(this)},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=rtl.length(this.Values)-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,this.Values[s],!1)}}),rtl.createClass(this,"TPasDeclarations",r,function(){o=this,this.$init=function(){r.$init.call(this),this.Declarations=null,this.Attributes=null,this.Classes=null,this.Consts=null,this.ExportSymbols=null,this.Functions=null,this.Properties=null,this.ResStrings=null,this.Labels=null,this.Types=null,this.Variables=null},this.$final=function(){this.Declarations=void 0,this.Attributes=void 0,this.Classes=void 0,this.Consts=void 0,this.ExportSymbols=void 0,this.Functions=void 0,this.Properties=void 0,this.ResStrings=void 0,this.Labels=void 0,this.Types=void 0,this.Variables=void 0,r.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Declarations=K.$create("Create"),this.Attributes=K.$create("Create"),this.Classes=K.$create("Create"),this.Consts=K.$create("Create"),this.ExportSymbols=K.$create("Create"),this.Functions=K.$create("Create"),this.Properties=K.$create("Create"),this.ResStrings=K.$create("Create"),this.Types=K.$create("Create"),this.Labels=K.$create("Create"),this.Variables=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Variables},set:function(e){this.p.Variables=e}}),X({p:this,get:function(){return this.p.Types},set:function(e){this.p.Types=e}}),X({p:this,get:function(){return this.p.ResStrings},set:function(e){this.p.ResStrings=e}}),X({p:this,get:function(){return this.p.Properties},set:function(e){this.p.Properties=e}}),X({p:this,get:function(){return this.p.Functions},set:function(e){this.p.Functions=e}}),X({p:this,get:function(){return this.p.ExportSymbols},set:function(e){this.p.ExportSymbols=e}}),X({p:this,get:function(){return this.p.Consts},set:function(e){this.p.Consts=e}}),X({p:this,get:function(){return this.p.Classes},set:function(e){this.p.Classes=e}}),X({p:this,get:function(){return this.p.Attributes},set:function(e){this.p.Attributes=e}}),X({p:this,get:function(){return this.p.Labels},set:function(e){this.p.Labels=e}}),X({p:this,get:function(){return this.p.Declarations},set:function(e){this.p.Declarations=e}}),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeSection")},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=this.Declarations.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Declarations.Get(s)),!1)}}),rtl.createClass(this,"TPasUsesUnit",r,function(){h=this,this.$init=function(){r.$init.call(this),this.Expr=null,this.InFilename=null,this.Module=null},this.$final=function(){this.Expr=void 0,this.InFilename=void 0,this.Module=void 0,r.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeUsesUnit")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Expr,!1),this.ForEachChildCall(e,t,this.InFilename,!1),this.ForEachChildCall(e,t,this.Module,!0)}}),rtl.createClass(this,"TPasSection",o,function(){u=this,this.$init=function(){o.$init.call(this),this.UsesList=null,this.UsesClause=[],this.PendingUsedIntf=null},this.$final=function(){this.UsesList=void 0,this.UsesClause=void 0,this.PendingUsedIntf=void 0,o.$final.call(this)},this.Create$1=function(e,t){return o.Create$1.call(this,e,t),this.UsesList=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.UsesList},set:function(e){this.p.UsesList=e}}),o.Destroy.call(this)},this.AddUnitToUsesList=function(e,t,i,r,n){var l,a;if(null!==i&&2!==i.Kind)throw s.$create("Create$1",["Wrong In expression for "+e]);return null===r&&(r=R.$create("Create$1",[e,this])),a=rtl.length(this.UsesClause),this.UsesClause=rtl.arraySetLength(this.UsesClause,null,a+1),null===n&&(n=h.$create("Create$1",[e,this]),null!==t&&(n.SourceFilename=t.SourceFilename,n.SourceLinenumber=t.SourceLinenumber)),this.UsesClause[a]=n,n.Expr=t,n.InFilename=i,n.Module=r,l=n,this.UsesList.Add(r),l},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeSection")},this.ForEachCall=function(e,t){var s=0;o.ForEachCall.call(this,e,t);for(var i=0,r=rtl.length(this.UsesClause)-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,this.UsesClause[s],!1)}}),rtl.createClass(this,"TInterfaceSection",u,function(){c=this,this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeInterfaceSection")}}),rtl.createClass(this,"TImplementationSection",u,function(){p=this,this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeImplementationSection")}}),rtl.createClass(this,"TProgramSection",p,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeProgramSection")}}),rtl.createClass(this,"TLibrarySection",p,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeLibrarySection")}}),rtl.createClass(this,"TPasPackageSection",c,function(){f=this,this.$init=function(){c.$init.call(this),this.Requires=null},this.$final=function(){this.Requires=void 0,c.$final.call(this)},this.Create$1=function(e,t){return u.Create$1.call(this,e,t),this.Requires=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Requires},set:function(e){this.p.Requires=e}}),u.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreePackageSection")}}),rtl.createClass(this,"TPasModule",r,function(){d=this,this.$init=function(){r.$init.call(this),this.InterfaceSection=null,this.ImplementationSection=null,this.InitializationSection=null,this.FinalizationSection=null,this.PackageName="",this.Filename=""},this.$final=function(){this.InterfaceSection=void 0,this.ImplementationSection=void 0,this.InitializationSection=void 0,this.FinalizationSection=void 0,r.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeModule")},this.GetDeclaration=function(e){return"Unit "+this.SafeName()},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.InterfaceSection,!1),this.ForEachChildCall(e,t,this.ImplementationSection,!1),this.ForEachChildCall(e,t,this.InitializationSection,!1),this.ForEachChildCall(e,t,this.FinalizationSection,!1)}}),rtl.createClass(this,"TPasUnitModule",d,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeUnit")}}),rtl.createClass(this,"TPasProgram",d,function(){this.$init=function(){d.$init.call(this),this.ProgramSection=null,this.InputFile="",this.OutPutFile=""},this.$final=function(){this.ProgramSection=void 0,d.$final.call(this)},this.ElementTypeName=function(){return d.ElementTypeName.call(this)},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.ProgramSection,!1),d.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasLibrary",d,function(){this.$init=function(){d.$init.call(this),this.LibrarySection=null},this.$final=function(){this.LibrarySection=void 0,d.$final.call(this)},this.ElementTypeName=function(){return d.ElementTypeName.call(this)},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.LibrarySection,!1),d.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasPackage",r,function(){F=this,this.$init=function(){r.$init.call(this),this.Modules=null},this.$final=function(){this.Modules=void 0,r.$final.call(this)},this.Create$1=function(e,t){return e.length>0&&"#"!==e.charAt(0)?r.Create$1.call(this,"#"+e,t):r.Create$1.call(this,e,t),this.Modules=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Modules},set:function(e){this.p.Modules=e}}),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreePackage")},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=this.Modules.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Modules.Get(s)),!0)}}),rtl.createClass(this,"TPasRequiredPackage",r,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeRequiredPackage")}}),rtl.createClass(this,"TPasDynamicPackage",d,function(){this.$init=function(){d.$init.call(this),this.PackageSection=null},this.$final=function(){this.PackageSection=void 0,d.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.PackageSection=f.$create("Create$1",[e,this]),this},this.Destroy=function(){X({p:this,get:function(){return this.p.PackageSection},set:function(e){this.p.PackageSection=e}}),r.Destroy.call(this)}}),rtl.createClass(this,"TPasResString",r,function(){this.$init=function(){r.$init.call(this),this.Expr=null},this.$final=function(){this.Expr=void 0,r.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeResString")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Expr,!1)}}),rtl.createClass(this,"TPasType",r,function(){m=this,this.SafeName=function(){return q(this.FName,"TPasTreeString")?this.FName:r.SafeName.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeType")}}),rtl.createClass(this,"TPasAliasType",m,function(){C=this,this.$init=function(){m.$init.call(this),this.DestType=null,this.SubType=null,this.Expr=null,this.CodepageExpr=null},this.$final=function(){this.DestType=void 0,this.SubType=void 0,this.Expr=void 0,this.CodepageExpr=void 0,m.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeAliasType")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.DestType,!0),this.ForEachChildCall(e,t,this.Expr,!1)}}),rtl.createClass(this,"TPasPointerType",m,function(){this.$init=function(){m.$init.call(this),this.DestType=null},this.$final=function(){this.DestType=void 0,m.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreePointerType")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.DestType,!0)}}),rtl.createClass(this,"TPasTypeAliasType",C,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeTypeAliasType")}}),rtl.createClass(this,"TPasGenericTemplateType",m,function(){this.$init=function(){m.$init.call(this),this.TypeConstraint="",this.Constraints=[]},this.$final=function(){this.Constraints=void 0,m.$final.call(this)},this.Destroy=function(){r.Destroy.call(this)},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=rtl.length(this.Constraints)-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,this.Constraints[s],!1)},this.AddConstraint=function(e){var t;t=rtl.length(this.Constraints),this.Constraints=rtl.arraySetLength(this.Constraints,null,t+1),this.Constraints[t]=e}}),rtl.createClass(this,"TPasGenericType",m,function(){S=this,this.$init=function(){m.$init.call(this),this.GenericTemplateTypes=null},this.$final=function(){this.GenericTemplateTypes=void 0,m.$final.call(this)},this.Destroy=function(){X({p:this,get:function(){return this.p.GenericTemplateTypes},set:function(e){this.p.GenericTemplateTypes=e}}),r.Destroy.call(this)},this.ForEachCall=function(e,t){var s=0;if(r.ForEachCall.call(this,e,t),null!==this.GenericTemplateTypes)for(var i=0,n=this.GenericTemplateTypes.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.GenericTemplateTypes.Get(s)),!1)},this.SetGenericTemplates=function(e){var t=0,s=null;null===this.GenericTemplateTypes&&(this.GenericTemplateTypes=K.$create("Create"));for(var i=0,r=e.FCount-1;i<=r;i++)t=i,(s=rtl.getObject(e.Get(t))).SetParent(this),this.GenericTemplateTypes.Add(s);e.Clear()}}),rtl.createClass(this,"TPasSpecializeType",C,function(){this.$init=function(){C.$init.call(this),this.Params=null},this.$final=function(){this.Params=void 0,C.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Params=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Params},set:function(e){this.p.Params=e}}),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeSpecializedType")},this.ForEachCall=function(e,t){var s=0;C.ForEachCall.call(this,e,t);for(var i=0,r=this.Params.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Params.Get(s)),!0)}}),rtl.createClass(this,"TInlineSpecializeExpr",n,function(){this.$init=function(){n.$init.call(this),this.NameExpr=null,this.Params=null},this.$final=function(){this.NameExpr=void 0,this.Params=void 0,n.$final.call(this)},this.Create$1=function(e,t){return n.Create$2.call(this,t,15,0),this.Params=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Params},set:function(e){this.p.Params=e}}),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeSpecializedExpr")},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.NameExpr,!1);for(var i=0,n=this.Params.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Params.Get(s)),!0)}}),rtl.createClass(this,"TPasClassOfType",C,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeClassOfType")}}),rtl.createClass(this,"TPasRangeType",m,function(){this.$init=function(){m.$init.call(this),this.RangeExpr=null},this.$final=function(){this.RangeExpr=void 0,m.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeRangeType")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.RangeExpr,!1)}}),rtl.createClass(this,"TPasArrayType",S,function(){this.$init=function(){S.$init.call(this),this.IndexRange="",this.Ranges=[],this.PackMode=0,this.ElType=null},this.$final=function(){this.Ranges=void 0,this.ElType=void 0,S.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeArrayType")},this.AddRange=function(e){var t;t=rtl.length(this.Ranges),this.Ranges=rtl.arraySetLength(this.Ranges,null,t+1),this.Ranges[t]=e}}),rtl.createClass(this,"TPasFileType",m,function(){this.$init=function(){m.$init.call(this),this.ElType=null},this.$final=function(){this.ElType=void 0,m.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeFileType")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.ElType,!0)}}),rtl.createClass(this,"TPasEnumValue",r,function(){this.$init=function(){r.$init.call(this),this.Value=null},this.$final=function(){this.Value=void 0,r.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeEnumValue")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Value,!1)}}),rtl.createClass(this,"TPasEnumType",m,function(){this.$init=function(){m.$init.call(this),this.Values=null},this.$final=function(){this.Values=void 0,m.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Values=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Values},set:function(e){this.p.Values=e}}),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeEnumType")},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=this.Values.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Values.Get(s)),!1)}}),rtl.createClass(this,"TPasSetType",m,function(){this.$init=function(){m.$init.call(this),this.EnumType=null,this.IsPacked=!1},this.$final=function(){this.EnumType=void 0,m.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeSetType")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.EnumType,!0)}}),rtl.createClass(this,"TPasVariant",r,function(){this.$init=function(){r.$init.call(this),this.Values=null,this.Members=null},this.$final=function(){this.Values=void 0,this.Members=void 0,r.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Values=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Values},set:function(e){this.p.Values=e}}),r.Destroy.call(this)},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=this.Values.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Values.Get(s)),!1);this.ForEachChildCall(e,t,this.Members,!1)}}),rtl.createClass(this,"TPasMembersType",S,function(){T=this,this.TRTTIVisibilitySection={0:"vcPrivate",vcPrivate:0,1:"vcProtected",vcProtected:1,2:"vcPublic",vcPublic:2,3:"vcPublished",vcPublished:3},rtl.recNewT(this,"TRTTIVisibility",function(){y=this,this.Explicit=!1,this.$new=function(){var e=Object.create(this);return e.Fields={},e.Methods={},e.Properties={},e},this.$eq=function(e){return this.Explicit===e.Explicit&&rtl.eqSet(this.Fields,e.Fields)&&rtl.eqSet(this.Methods,e.Methods)&&rtl.eqSet(this.Properties,e.Properties)},this.$assign=function(e){return this.Explicit=e.Explicit,this.Fields=rtl.refSet(e.Fields),this.Methods=rtl.refSet(e.Methods),this.Properties=rtl.refSet(e.Properties),this}}),this.VisibilityToExtRTTI=[2,0,1,2,3,2,0,1,2,2],this.$init=function(){S.$init.call(this),this.PackMode=0,this.Members=null,this.RTTIVisibility=y.$new()},this.$final=function(){this.Members=void 0,this.RTTIVisibility=void 0,S.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.PackMode=0,this.Members=K.$create("Create"),this.GenericTemplateTypes=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.GenericTemplateTypes},set:function(e){this.p.GenericTemplateTypes=e}}),X({p:this,get:function(){return this.p.Members},set:function(e){this.p.Members=e}}),S.Destroy.call(this)},this.IsPacked=function(){return 0!==this.PackMode},this.ForEachCall=function(e,t){var s=0;S.ForEachCall.call(this,e,t);for(var i=0,r=this.Members.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Members.Get(s)),!1)},this.HasExtRTTI=function(e){var t=null;if(4===e.Visibility)return!0;if((t=e.$class.ClassType())===v){if(this.VisibilityToExtRTTI[e.Visibility]in this.RTTIVisibility.Fields)return!0}else if(t===A){if(this.VisibilityToExtRTTI[e.Visibility]in this.RTTIVisibility.Properties)return!0}else if(t.InheritsFrom(b)&&this.VisibilityToExtRTTI[e.Visibility]in this.RTTIVisibility.Methods)return!0;return false}}),rtl.createClass(this,"TPasRecordType",T,function(){this.$init=function(){T.$init.call(this),this.VariantEl=null,this.Variants=null},this.$final=function(){this.VariantEl=void 0,this.Variants=void 0,T.$final.call(this)},this.Create$1=function(e,t){return T.Create$1.call(this,e,t),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Variants},set:function(e){this.p.Variants=e}}),T.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeRecordType")},this.ForEachCall=function(e,t){var s=0;if(T.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.VariantEl,!0),null!==this.Variants)for(var i=0,r=this.Variants.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Variants.Get(s)),!1)}}),this.TPasObjKind={0:"okObject",okObject:0,1:"okClass",okClass:1,2:"okInterface",okInterface:2,3:"okClassHelper",okClassHelper:3,4:"okRecordHelper",okRecordHelper:4,5:"okTypeHelper",okTypeHelper:5,6:"okDispInterface",okDispInterface:6,7:"okObjcClass",okObjcClass:7,8:"okObjcCategory",okObjcCategory:8,9:"okObjcProtocol",okObjcProtocol:9},this.okWithFields=rtl.createSet(0,1,7,8),this.okAllHelpers=rtl.createSet(3,4,5),this.okWithClassFields=rtl.unionSet(this.okWithFields,this.okAllHelpers),this.TPasClassInterfaceType={0:"citCom",citCom:0,1:"citCorba",citCorba:1},rtl.createClass(this,"TPasClassType",T,function(){this.$init=function(){T.$init.call(this),this.ObjKind=0,this.AncestorType=null,this.HelperForType=null,this.IsForward=!1,this.IsExternal=!1,this.IsShortDefinition=!1,this.GUIDExpr=null,this.Modifiers=null,this.Interfaces=null,this.ExternalNameSpace="",this.ExternalName="",this.InterfaceType=0},this.$final=function(){this.AncestorType=void 0,this.HelperForType=void 0,this.GUIDExpr=void 0,this.Modifiers=void 0,this.Interfaces=void 0,T.$final.call(this)},this.Create$1=function(e,t){return T.Create$1.call(this,e,t),this.IsShortDefinition=!1,this.Modifiers=Q.$create("Create$1"),this.Interfaces=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Interfaces},set:function(e){this.p.Interfaces=e}}),X({p:this,get:function(){return this.p.Modifiers},set:function(e){this.p.Modifiers=e}}),T.Destroy.call(this)},this.ElementTypeName=function(){var e=this.ObjKind;return 0===e?rtl.getResStr(t,"SPasTreeObjectType"):1===e?rtl.getResStr(t,"SPasTreeClassType"):2===e?rtl.getResStr(t,"SPasTreeInterfaceType"):3===e?rtl.getResStr(t,"SPasClassHelperType"):4===e?rtl.getResStr(t,"SPasRecordHelperType"):5===e?rtl.getResStr(t,"SPasTypeHelperType"):"ObjKind("+Z(this.ObjKind)+")"},this.ForEachCall=function(e,t){var s=0;T.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.AncestorType,!0);for(var i=0,r=this.Interfaces.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Interfaces.Get(s)),!0);this.ForEachChildCall(e,t,this.HelperForType,!0),this.ForEachChildCall(e,t,this.GUIDExpr,!1)},this.FindMember=function(e,t){var s=null,i=0;for(s=null,i=0;null===s&&i<this.Members.FCount;)(s=rtl.getObject(this.Members.Get(i))).$class.ClassType()===e&&0===ee(s.FName,t)||(s=null),i+=1;return s},this.IsAbstract=function(){return this.HasModifier("abstract")},this.HasModifier=function(e){for(var t=0,s=0,i=this.Modifiers.GetCount()-1;s<=i;s++)if(t=s,0===ee(e,this.Modifiers.Get(t)))return!0;return false}}),this.TArgumentAccess={0:"argDefault",argDefault:0,1:"argConst",argConst:1,2:"argVar",argVar:2,3:"argOut",argOut:3,4:"argConstRef",argConstRef:4},rtl.createClass(this,"TPasAttributes",r,function(){this.$init=function(){r.$init.call(this),this.Calls=[]},this.$final=function(){this.Calls=void 0,r.$final.call(this)},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=rtl.length(this.Calls)-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,this.Calls[s],!1)},this.AddCall=function(e){var t;t=rtl.length(this.Calls),this.Calls=rtl.arraySetLength(this.Calls,null,t+1),this.Calls[t]=e}}),rtl.createClass(this,"TPasArgument",r,function(){this.$init=function(){r.$init.call(this),this.Access=0,this.Attributes=null,this.ArgType=null,this.ValueExpr=null},this.$final=function(){this.Attributes=void 0,this.ArgType=void 0,this.ValueExpr=void 0,r.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeArgument")},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.Attributes,!0),r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.ArgType,!0),this.ForEachChildCall(e,t,this.ValueExpr,!0)}}),rtl.createClass(this,"TPasProcedureType",S,function(){g=this,this.$init=function(){S.$init.call(this),this.Args=null,this.CallingConvention=0,this.Modifiers={},this.VarArgsType=null},this.$final=function(){this.Args=void 0,this.Modifiers=void 0,this.VarArgsType=void 0,S.$final.call(this)},this.GetIsAsync=function(){return 5 in this.Modifiers},this.GetIsNested=function(){return 1 in this.Modifiers},this.GetIsOfObject=function(){return 0 in this.Modifiers},this.GetIsReference=function(){return 4 in this.Modifiers},this.SetIsNested=function(e){this.Modifiers=e?rtl.includeSet(this.Modifiers,1):rtl.excludeSet(this.Modifiers,1)},this.SetIsOfObject=function(e){this.Modifiers=e?rtl.includeSet(this.Modifiers,0):rtl.excludeSet(this.Modifiers,0)},this.SetIsReference=function(e){this.Modifiers=e?rtl.includeSet(this.Modifiers,4):rtl.excludeSet(this.Modifiers,4)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Args=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Args},set:function(e){this.p.Args=e}}),S.Destroy.call(this)},this.TypeName=function(){return"procedure"},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeProcedureType")},this.ForEachCall=function(e,t){var s=0;S.ForEachCall.call(this,e,t);for(var i=0,r=this.Args.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Args.Get(s)),!1);this.ForEachChildCall(e,t,this.VarArgsType,!1)}}),rtl.createClass(this,"TPasResultElement",r,function(){this.$init=function(){r.$init.call(this),this.ResultType=null},this.$final=function(){this.ResultType=void 0,r.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeResultElement")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.ResultType,!0)}}),rtl.createClass(this,"TPasFunctionType",g,function(){E=this,this.$init=function(){g.$init.call(this),this.ResultEl=null},this.$final=function(){this.ResultEl=void 0,g.$final.call(this)},this.TypeName=function(){return"function"},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeFunctionType")},this.ForEachCall=function(e,t){g.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.ResultEl,!1)}}),rtl.createClass(this,"TPasUnresolvedSymbolRef",m,function(){P=this}),rtl.createClass(this,"TPasUnresolvedTypeRef",P,function(){I=this,this.Create$1=function(e,t){return r.Create$1.call(this,e,null),this},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeUnresolvedTypeRef")}}),rtl.createClass(this,"TPasUnresolvedUnitRef",P,function(){R=this,this.$init=function(){P.$init.call(this),this.FileName=""},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeUnit")}}),rtl.createClass(this,"TPasStringType",I,function(){this.$init=function(){I.$init.call(this),this.LengthExpr="",this.CodePageExpr=""},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasStringType")}}),this.TVariableModifier={0:"vmCVar",vmCVar:0,1:"vmExternal",vmExternal:1,2:"vmPublic",vmPublic:2,3:"vmExport",vmExport:3,4:"vmClass",vmClass:4,5:"vmStatic",vmStatic:5,6:"vmfar",vmfar:6},rtl.createClass(this,"TPasVariable",r,function(){v=this,this.$init=function(){r.$init.call(this),this.VarType=null,this.VarModifiers={},this.LibraryName=null,this.ExportName=null,this.Modifiers="",this.AbsoluteLocation="",this.AbsoluteExpr=null,this.Expr=null},this.$final=function(){this.VarType=void 0,this.VarModifiers=void 0,this.LibraryName=void 0,this.ExportName=void 0,this.AbsoluteExpr=void 0,this.Expr=void 0,r.$final.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeVariable")},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.VarType,!0),this.ForEachChildCall(e,t,this.Expr,!1),this.ForEachChildCall(e,t,this.LibraryName,!1),this.ForEachChildCall(e,t,this.ExportName,!1),this.ForEachChildCall(e,t,this.AbsoluteExpr,!1)}}),rtl.createClass(this,"TPasExportSymbol",r,function(){this.$init=function(){r.$init.call(this),this.NameExpr=null,this.ExportName=null,this.ExportIndex=null},this.$final=function(){this.NameExpr=void 0,this.ExportName=void 0,this.ExportIndex=void 0,r.$final.call(this)},this.ElementTypeName=function(){return"Export"},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.NameExpr,!1),this.ForEachChildCall(e,t,this.ExportName,!1),this.ForEachChildCall(e,t,this.ExportIndex,!1)}}),rtl.createClass(this,"TPasConst",v,function(){this.$init=function(){v.$init.call(this),this.IsConst=!1},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeConst")}}),rtl.createClass(this,"TPasProperty",v,function(){A=this,this.$init=function(){v.$init.call(this),this.FArgs=null,this.IndexExpr=null,this.ReadAccessor=null,this.WriteAccessor=null,this.DispIDExpr=null,this.Implements=[],this.StoredAccessor=null,this.DefaultExpr=null,this.ReadAccessorName="",this.WriteAccessorName="",this.ImplementsName="",this.StoredAccessorName="",this.DispIDReadOnly=!1,this.IsDefault=!1,this.IsNodefault=!1},this.$final=function(){this.FArgs=void 0,this.IndexExpr=void 0,this.ReadAccessor=void 0,this.WriteAccessor=void 0,this.DispIDExpr=void 0,this.Implements=void 0,this.StoredAccessor=void 0,this.DefaultExpr=void 0,v.$final.call(this)},this.GetIsClass=function(){return 4 in this.VarModifiers},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.FArgs=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.FArgs},set:function(e){this.p.FArgs=e}}),this.Implements=rtl.arraySetLength(this.Implements,null,0),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeProperty")},this.ForEachCall=function(e,t){var s=0;v.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.IndexExpr,!1);for(var i=0,r=this.FArgs.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.FArgs.Get(s)),!1);this.ForEachChildCall(e,t,this.ReadAccessor,!1),this.ForEachChildCall(e,t,this.WriteAccessor,!1);for(var n=0,l=rtl.length(this.Implements)-1;n<=l;n++)s=n,this.ForEachChildCall(e,t,this.Implements[s],!1);this.ForEachChildCall(e,t,this.StoredAccessor,!1),this.ForEachChildCall(e,t,this.DefaultExpr,!1)}}),this.TProcType={0:"ptProcedure",ptProcedure:0,1:"ptFunction",ptFunction:1,2:"ptOperator",ptOperator:2,3:"ptClassOperator",ptClassOperator:3,4:"ptConstructor",ptConstructor:4,5:"ptDestructor",ptDestructor:5,6:"ptClassProcedure",ptClassProcedure:6,7:"ptClassFunction",ptClassFunction:7,8:"ptClassConstructor",ptClassConstructor:8,9:"ptClassDestructor",ptClassDestructor:9,10:"ptAnonymousProcedure",ptAnonymousProcedure:10,11:"ptAnonymousFunction",ptAnonymousFunction:11},rtl.createClass(this,"TPasProcedureBase",r,function(){N=this}),rtl.createClass(this,"TPasOverloadedProc",N,function(){x=this,this.$init=function(){N.$init.call(this),this.Overloads=null},this.$final=function(){this.Overloads=void 0,N.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Overloads=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Overloads},set:function(e){this.p.Overloads=e}}),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeOverloadedProcedure")},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=this.Overloads.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Overloads.Get(s)),!1)}}),this.TProcedureModifier={0:"pmVirtual",pmVirtual:0,1:"pmDynamic",pmDynamic:1,2:"pmAbstract",pmAbstract:2,3:"pmOverride",pmOverride:3,4:"pmExport",pmExport:4,5:"pmOverload",pmOverload:5,6:"pmMessage",pmMessage:6,7:"pmReintroduce",pmReintroduce:7,8:"pmInline",pmInline:8,9:"pmAssembler",pmAssembler:9,10:"pmPublic",pmPublic:10,11:"pmCompilerProc",pmCompilerProc:11,12:"pmExternal",pmExternal:12,13:"pmForward",pmForward:13,14:"pmDispId",pmDispId:14,15:"pmNoReturn",pmNoReturn:15,16:"pmFar",pmFar:16,17:"pmFinal",pmFinal:17,18:"pmDiscardResult",pmDiscardResult:18,19:"pmNoStackFrame",pmNoStackFrame:19,20:"pmsection",pmsection:20,21:"pmRtlProc",pmRtlProc:21,22:"pmInternProc",pmInternProc:22,23:"pmWeakExternal",pmWeakExternal:23},this.TProcedureMessageType={0:"pmtNone",pmtNone:0,1:"pmtInteger",pmtInteger:1,2:"pmtString",pmtString:2},rtl.createClass(this,"TProcedureNamePart",W,function(){this.$init=function(){W.$init.call(this),this.Name="",this.Templates=null},this.$final=function(){this.Templates=void 0,W.$final.call(this)}}),rtl.createClass(this,"TPasProcedure",N,function(){b=this,this.$init=function(){N.$init.call(this),this.FModifiers={},this.FMessageName="",this.FMessageType=0,this.PublicName=null,this.LibrarySymbolIndex=null,this.LibrarySymbolName=null,this.LibraryExpr=null,this.DispIDExpr=null,this.MessageExpr=null,this.CompProcID="",this.AliasName="",this.ProcType=null,this.Body=null,this.NameParts=null},this.$final=function(){this.FModifiers=void 0,this.PublicName=void 0,this.LibrarySymbolIndex=void 0,this.LibrarySymbolName=void 0,this.LibraryExpr=void 0,this.DispIDExpr=void 0,this.MessageExpr=void 0,this.ProcType=void 0,this.Body=void 0,this.NameParts=void 0,N.$final.call(this)},this.GetCallingConvention=function(){var e=0;return e=0,null!=this.ProcType&&(e=this.ProcType.CallingConvention),e},this.Destroy=function(){t.FreeProcNameParts({p:this,get:function(){return this.p.NameParts},set:function(e){this.p.NameParts=e}}),r.Destroy.call(this)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeProcedure")},this.TypeName=function(){return"procedure"},this.ForEachCall=function(e,t){var s=0,i=0,n=null;if(r.ForEachCall.call(this,e,t),null!==this.NameParts)for(var l=0,a=this.NameParts.FCount-1;l<=a;l++)if(s=l,null!==(n=rtl.getObject(this.NameParts.Get(s)).Templates))for(var o=0,h=n.FCount-1;o<=h;o++)i=o,this.ForEachChildCall(e,t,rtl.getObject(n.Get(i)),!1);this.ForEachChildCall(e,t,this.ProcType,!1),this.ForEachChildCall(e,t,this.PublicName,!1),this.ForEachChildCall(e,t,this.LibraryExpr,!1),this.ForEachChildCall(e,t,this.LibrarySymbolName,!1),this.ForEachChildCall(e,t,this.MessageExpr,!1),this.ForEachChildCall(e,t,this.Body,!1)},this.AddModifier=function(e){this.FModifiers=rtl.includeSet(this.FModifiers,e)},this.CanParseImplementation=function(){return!this.HasNoImplementation()&&(p.isPrototypeOf(this.FParent)||B.isPrototypeOf(this.FParent))},this.HasNoImplementation=function(){return this.IsExternal()||this.IsForward()||this.IsInternProc()},this.IsVirtual=function(){return 0 in this.FModifiers},this.IsDynamic=function(){return 1 in this.FModifiers},this.IsAbstract=function(){return 2 in this.FModifiers},this.IsOverride=function(){return 3 in this.FModifiers},this.IsExported=function(){return 4 in this.FModifiers},this.IsExternal=function(){return 12 in this.FModifiers},this.IsOverload=function(){return 5 in this.FModifiers},this.IsMessage=function(){return 6 in this.FModifiers},this.IsReintroduced=function(){return 7 in this.FModifiers},this.IsStatic=function(){return 2 in this.ProcType.Modifiers},this.IsForward=function(){return 13 in this.FModifiers},this.IsInternProc=function(){return 22 in this.FModifiers},this.IsAssembler=function(){return 9 in this.FModifiers},this.IsAsync=function(){return this.ProcType.GetIsAsync()},this.GetProcTypeEnum=function(){return 0},this.SetNameParts=function(e){var s=0,i=0;null!==this.NameParts&&t.FreeProcNameParts({p:this,get:function(){return this.p.NameParts},set:function(e){this.p.NameParts=e}}),this.NameParts=K.$create("Create"),this.NameParts.Assign(e,0,null),e.Clear();for(var r=0,n=this.NameParts.FCount-1;r<=n;r++){s=r;var l=rtl.getObject(this.NameParts.Get(s));if(null!==l.Templates)for(var a=0,o=l.Templates.FCount-1;a<=o;a++)i=a,rtl.getObject(l.Templates.Get(i)).SetParent(this)}}}),rtl.createClass(this,"TPasFunction",b,function(){O=this,this.GetFT=function(){return rtl.as(this.ProcType,E)},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeFunction")},this.TypeName=function(){return"function"},this.GetProcTypeEnum=function(){return 1}}),e=this.TOperatorType={0:"otUnknown",otUnknown:0,1:"otImplicit",otImplicit:1,2:"otExplicit",otExplicit:2,3:"otMul",otMul:3,4:"otPlus",otPlus:4,5:"otMinus",otMinus:5,6:"otDivision",otDivision:6,7:"otLessThan",otLessThan:7,8:"otEqual",otEqual:8,9:"otGreaterThan",otGreaterThan:9,10:"otAssign",otAssign:10,11:"otNotEqual",otNotEqual:11,12:"otLessEqualThan",otLessEqualThan:12,13:"otGreaterEqualThan",otGreaterEqualThan:13,14:"otPower",otPower:14,15:"otSymmetricalDifference",otSymmetricalDifference:15,16:"otInc",otInc:16,17:"otDec",otDec:17,18:"otMod",otMod:18,19:"otNegative",otNegative:19,20:"otPositive",otPositive:20,21:"otBitWiseOr",otBitWiseOr:21,22:"otDiv",otDiv:22,23:"otLeftShift",otLeftShift:23,24:"otLogicalOr",otLogicalOr:24,25:"otBitwiseAnd",otBitwiseAnd:25,26:"otbitwiseXor",otbitwiseXor:26,27:"otLogicalAnd",otLogicalAnd:27,28:"otLogicalNot",otLogicalNot:28,29:"otLogicalXor",otLogicalXor:29,30:"otRightShift",otRightShift:30,31:"otEnumerator",otEnumerator:31,32:"otIn",otIn:32,33:"otInitialize",otInitialize:33,34:"otFinalize",otFinalize:34,35:"otAddRef",otAddRef:35,36:"otCopy",otCopy:36},rtl.createClass(this,"TPasOperator",O,function(){k=this,this.$init=function(){O.$init.call(this),this.FOperatorType=0,this.FTokenBased=!1},this.NameSuffix=function(){var e="",t=0;if(e="(",null!=this.ProcType&&null!=this.ProcType.Args)for(var s=0,i=this.ProcType.Args.FCount-1;s<=i;s++)(t=s)>0&&(e+=","),e+=rtl.getObject(this.ProcType.Args.Get(t)).ArgType.FName;return e+=")",null!=this.ProcType&&null!=this.ProcType.ResultEl&&null!=this.ProcType.ResultEl.ResultType&&(e=e+":"+this.ProcType.ResultEl.ResultType.FName),e},this.TokenToOperatorType=function(s){var i=0;for(i=e.otCopy;i>0&&0!==ee(s,t.OperatorTokens[i]);)i-=1;return i},this.NameToOperatorType=function(s){var i=0;for(i=e.otCopy;i>0&&0!==ee(s,t.OperatorNames[i]);)i-=1;return i},this.CorrectName=function(){this.FName=t.OperatorNames[this.FOperatorType]+this.NameSuffix()},this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeOperator")},this.TypeName=function(){return"operator"},this.GetProcTypeEnum=function(){return 2}}),rtl.createClass(this,"TPasClassOperator",k,function(){this.TypeName=function(){return"class operator"},this.GetProcTypeEnum=function(){return 3}}),rtl.createClass(this,"TPasConstructor",b,function(){$=this,this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeConstructor")},this.TypeName=function(){return"constructor"},this.GetProcTypeEnum=function(){return 4}}),rtl.createClass(this,"TPasClassConstructor",$,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeClassConstructor")},this.TypeName=function(){return"class "+$.TypeName.call(this)},this.GetProcTypeEnum=function(){return 8}}),rtl.createClass(this,"TPasDestructor",b,function(){D=this,this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeDestructor")},this.TypeName=function(){return"destructor"},this.GetProcTypeEnum=function(){return 5}}),rtl.createClass(this,"TPasClassDestructor",D,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeClassDestructor")},this.TypeName=function(){return"destructor"},this.GetProcTypeEnum=function(){return 9}}),rtl.createClass(this,"TPasClassProcedure",b,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeClassProcedure")},this.TypeName=function(){return"class procedure"},this.GetProcTypeEnum=function(){return 6}}),rtl.createClass(this,"TPasClassFunction",O,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeClassFunction")},this.TypeName=function(){return"class function"},this.GetProcTypeEnum=function(){return 7}}),rtl.createClass(this,"TPasAnonymousProcedure",b,function(){L=this,this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeAnonymousProcedure")},this.TypeName=function(){return"anonymous procedure"},this.GetProcTypeEnum=function(){return 10}}),rtl.createClass(this,"TPasAnonymousFunction",L,function(){this.ElementTypeName=function(){return rtl.getResStr(t,"SPasTreeAnonymousFunction")},this.TypeName=function(){return"anonymous function"},this.GetProcTypeEnum=function(){return 11}}),rtl.createClass(this,"TProcedureExpr",n,function(){this.$init=function(){n.$init.call(this),this.Proc=null},this.$final=function(){this.Proc=void 0,n.$final.call(this)},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Proc,!1)}}),rtl.createClass(this,"TPasMethodResolution",r,function(){this.$init=function(){r.$init.call(this),this.ProcClass=null,this.InterfaceName=null,this.InterfaceProc=null,this.ImplementationProc=null},this.$final=function(){this.ProcClass=void 0,this.InterfaceName=void 0,this.InterfaceProc=void 0,this.ImplementationProc=void 0,r.$final.call(this)},this.ForEachCall=function(e,t){r.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.InterfaceName,!1),this.ForEachChildCall(e,t,this.InterfaceProc,!1),this.ForEachChildCall(e,t,this.ImplementationProc,!1)}}),rtl.createClass(this,"TProcedureBody",o,function(){B=this,this.$init=function(){o.$init.call(this),this.Body=null},this.$final=function(){this.Body=void 0,o.$final.call(this)},this.ForEachCall=function(e,t){o.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Body,!1)}}),rtl.createClass(this,"TPasImplElement",r,function(){M=this}),rtl.createClass(this,"TPasImplCommandBase",M,function(){G=this,this.$init=function(){M.$init.call(this),this.SemicolonAtEOL=!1},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.SemicolonAtEOL=!0,this}}),rtl.createClass(this,"TPasImplCommand",G,function(){this.$init=function(){G.$init.call(this),this.Command=""}}),rtl.createClass(this,"TPasLabels",M,function(){this.$init=function(){M.$init.call(this),this.Labels=null},this.$final=function(){this.Labels=void 0,M.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Labels=Q.$create("Create$1"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Labels},set:function(e){this.p.Labels=e}}),r.Destroy.call(this)}}),rtl.createClass(this,"TPasImplBlock",M,function(){w=this,this.$init=function(){M.$init.call(this),this.Elements=null},this.$final=function(){this.Elements=void 0,M.$final.call(this)},this.Create$1=function(e,t){return r.Create$1.call(this,e,t),this.Elements=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Elements},set:function(e){this.p.Elements=e}}),r.Destroy.call(this)},this.AddElement=function(e){this.Elements.Add(e)},this.CloseOnSemicolon=function(){return false},this.ForEachCall=function(e,t){var s=0;r.ForEachCall.call(this,e,t);for(var i=0,n=this.Elements.FCount-1;i<=n;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Elements.Get(s)),!1)}}),rtl.createClass(this,"TPasImplStatement",w,function(){V=this,this.CloseOnSemicolon=function(){return true}}),rtl.createClass(this,"TPasImplBeginBlock",w,function(){0}),rtl.createClass(this,"TInitializationSection",w,function(){0}),rtl.createClass(this,"TFinalizationSection",w,function(){0}),rtl.createClass(this,"TPasImplAsmStatement",V,function(){this.$init=function(){V.$init.call(this),this.FModifierTokens=null,this.FTokens=null},this.$final=function(){this.FModifierTokens=void 0,this.FTokens=void 0,V.$final.call(this)},this.Create$1=function(e,t){return w.Create$1.call(this,e,t),this.FTokens=Q.$create("Create$1"),this.FModifierTokens=Q.$create("Create$1"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.FTokens},set:function(e){this.p.FTokens=e}}),X({p:this,get:function(){return this.p.FModifierTokens},set:function(e){this.p.FModifierTokens=e}}),w.Destroy.call(this)}}),rtl.createClass(this,"TPasImplRepeatUntil",w,function(){this.$init=function(){w.$init.call(this),this.ConditionExpr=null},this.$final=function(){this.ConditionExpr=void 0,w.$final.call(this)},this.ForEachCall=function(e,t){w.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.ConditionExpr,!1)}}),rtl.createClass(this,"TPasImplIfElse",w,function(){this.$init=function(){w.$init.call(this),this.ConditionExpr=null,this.IfBranch=null,this.ElseBranch=null},this.$final=function(){this.ConditionExpr=void 0,this.IfBranch=void 0,this.ElseBranch=void 0,w.$final.call(this)},this.AddElement=function(e){if(w.AddElement.call(this,e),null===this.IfBranch)this.IfBranch=e;else{if(null!==this.ElseBranch)throw s.$create("Create$1",["TPasImplIfElse.AddElement if and else already set - please report this bug"]);this.ElseBranch=e}},this.CloseOnSemicolon=function(){return null!==this.ElseBranch},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.ConditionExpr,!1),this.Elements.IndexOf(this.IfBranch)<0&&this.ForEachChildCall(e,t,this.IfBranch,!1),this.Elements.IndexOf(this.ElseBranch)<0&&this.ForEachChildCall(e,t,this.ElseBranch,!1),w.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasImplWhileDo",V,function(){this.$init=function(){V.$init.call(this),this.ConditionExpr=null,this.Body=null},this.$final=function(){this.ConditionExpr=void 0,this.Body=void 0,V.$final.call(this)},this.AddElement=function(e){if(w.AddElement.call(this,e),null!==this.Body)throw s.$create("Create$1",["TPasImplWhileDo.AddElement body already set"]);this.Body=e},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.ConditionExpr,!1),this.Elements.IndexOf(this.Body)<0&&this.ForEachChildCall(e,t,this.Body,!1),w.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasImplWithDo",V,function(){this.$init=function(){V.$init.call(this),this.Expressions=null,this.Body=null},this.$final=function(){this.Expressions=void 0,this.Body=void 0,V.$final.call(this)},this.Create$1=function(e,t){return w.Create$1.call(this,e,t),this.Expressions=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Expressions},set:function(e){this.p.Expressions=e}}),w.Destroy.call(this)},this.AddElement=function(e){if(w.AddElement.call(this,e),null!==this.Body)throw s.$create("Create$1",["TPasImplWithDo.AddElement body already set"]);this.Body=e},this.AddExpression=function(e){this.Expressions.Add(e),null===e.FParent&&e.SetParent(this)},this.ForEachCall=function(e,t){for(var s=0,i=0,r=this.Expressions.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Expressions.Get(s)),!1);this.Elements.IndexOf(this.Body)<0&&this.ForEachChildCall(e,t,this.Body,!1),w.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasInlineVarDeclStatement",V,function(){this.$init=function(){V.$init.call(this),this.Declarations=null},this.$final=function(){this.Declarations=void 0,V.$final.call(this)},this.Create$1=function(e,t){return w.Create$1.call(this,e,t),this.Declarations=K.$create("Create"),this},this.Destroy=function(){w.Destroy.call(this),X({p:this,get:function(){return this.p.Declarations},set:function(e){this.p.Declarations=e}})}}),rtl.createClass(this,"TPasImplCaseOf",w,function(){this.$init=function(){w.$init.call(this),this.CaseExpr=null,this.ElseBranch=null},this.$final=function(){this.CaseExpr=void 0,this.ElseBranch=void 0,w.$final.call(this)},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.CaseExpr,!1),this.Elements.IndexOf(this.ElseBranch)<0&&this.ForEachChildCall(e,t,this.ElseBranch,!1),w.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasImplCaseStatement",V,function(){this.$init=function(){V.$init.call(this),this.Expressions=null,this.Body=null},this.$final=function(){this.Expressions=void 0,this.Body=void 0,V.$final.call(this)},this.Create$1=function(e,t){return w.Create$1.call(this,e,t),this.Expressions=K.$create("Create"),this},this.Destroy=function(){X({p:this,get:function(){return this.p.Expressions},set:function(e){this.p.Expressions=e}}),w.Destroy.call(this)},this.AddElement=function(e){if(w.AddElement.call(this,e),null!==this.Body)throw s.$create("Create$1",["TPasImplCaseStatement.AddElement body already set"]);this.Body=e},this.AddExpression=function(e){this.Expressions.Add(e),e.SetParent(this)},this.ForEachCall=function(e,t){for(var s=0,i=0,r=this.Expressions.FCount-1;i<=r;i++)s=i,this.ForEachChildCall(e,t,rtl.getObject(this.Expressions.Get(s)),!1);this.Elements.IndexOf(this.Body)<0&&this.ForEachChildCall(e,t,this.Body,!1),w.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasImplCaseElse",w,function(){0}),this.TLoopType={0:"ltNormal",ltNormal:0,1:"ltDown",ltDown:1,2:"ltIn",ltIn:2},rtl.createClass(this,"TPasImplForLoop",V,function(){this.$init=function(){V.$init.call(this),this.VariableName=null,this.LoopType=0,this.StartExpr=null,this.EndExpr=null,this.Variable=null,this.VarType=null,this.ImplicitTyped=!1,this.Body=null},this.$final=function(){this.VariableName=void 0,this.StartExpr=void 0,this.EndExpr=void 0,this.Variable=void 0,this.VarType=void 0,this.Body=void 0,V.$final.call(this)},this.AddElement=function(e){if(w.AddElement.call(this,e),null!==this.Body)throw s.$create("Create$1",["TPasImplForLoop.AddElement body already set - please report this bug"]);this.Body=e},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.VariableName,!1),this.ForEachChildCall(e,t,this.Variable,!1),this.ForEachChildCall(e,t,this.StartExpr,!1),this.ForEachChildCall(e,t,this.EndExpr,!1),this.Elements.IndexOf(this.Body)<0&&this.ForEachChildCall(e,t,this.Body,!1),w.ForEachCall.call(this,e,t)},this.Down=function(){return 1===this.LoopType}}),this.TAssignKind={0:"akDefault",akDefault:0,1:"akAdd",akAdd:1,2:"akMinus",akMinus:2,3:"akMul",akMul:3,4:"akDivision",akDivision:4},rtl.createClass(this,"TPasImplAssign",V,function(){this.$init=function(){V.$init.call(this),this.Left=null,this.Right=null,this.Kind=0},this.$final=function(){this.Left=void 0,this.Right=void 0,V.$final.call(this)},this.ForEachCall=function(e,t){w.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Left,!1),this.ForEachChildCall(e,t,this.Right,!1)}}),rtl.createClass(this,"TPasImplSimple",V,function(){this.$init=function(){V.$init.call(this),this.Expr=null},this.$final=function(){this.Expr=void 0,V.$final.call(this)},this.ForEachCall=function(e,t){w.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.Expr,!1)}}),rtl.createClass(this,"TPasImplTry",w,function(){this.$init=function(){w.$init.call(this),this.FinallyExcept=null,this.ElseBranch=null},this.$final=function(){this.FinallyExcept=void 0,this.ElseBranch=void 0,w.$final.call(this)},this.ForEachCall=function(e,t){w.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.FinallyExcept,!1),this.ForEachChildCall(e,t,this.ElseBranch,!1)}}),rtl.createClass(this,"TPasImplTryHandler",w,function(){U=this}),rtl.createClass(this,"TPasImplTryFinally",U,function(){0}),rtl.createClass(this,"TPasImplTryExcept",U,function(){0}),rtl.createClass(this,"TPasImplTryExceptElse",U,function(){0}),rtl.createClass(this,"TPasImplExceptOn",V,function(){this.$init=function(){V.$init.call(this),this.VarEl=null,this.TypeEl=null,this.Body=null},this.$final=function(){this.VarEl=void 0,this.TypeEl=void 0,this.Body=void 0,V.$final.call(this)},this.AddElement=function(e){w.AddElement.call(this,e),null===this.Body&&(this.Body=e)},this.ForEachCall=function(e,t){this.ForEachChildCall(e,t,this.VarEl,!1),this.ForEachChildCall(e,t,this.TypeEl,!0),this.Elements.IndexOf(this.Body)<0&&this.ForEachChildCall(e,t,this.Body,!1),w.ForEachCall.call(this,e,t)}}),rtl.createClass(this,"TPasImplRaise",V,function(){this.$init=function(){V.$init.call(this),this.ExceptObject=null,this.ExceptAddr=null},this.$final=function(){this.ExceptObject=void 0,this.ExceptAddr=void 0,V.$final.call(this)},this.ForEachCall=function(e,t){w.ForEachCall.call(this,e,t),this.ForEachChildCall(e,t,this.ExceptObject,!1),this.ForEachChildCall(e,t,this.ExceptAddr,!1)}}),rtl.createClass(this,"TPasImplLabelMark",M,function(){this.$init=function(){M.$init.call(this),this.LabelId=""}}),rtl.createClass(this,"TPasImplGoto",V,function(){this.$init=function(){V.$init.call(this),this.LabelName=""}}),this.AccessNames=["","const ","var ","out ","constref "],this.AccessDescriptions=["default","const","var","out","constref"],this.VisibilityNames=["default","private","protected","public","published","automated","strict private","strict protected","required","optional"],this.ObjKindNames=["object","class","interface","class helper","record helper","type helper","dispinterface","ObjcClass","ObjcCategory","ObjcProtocol"],this.InterfaceTypeNames=["COM","Corba"],this.ExprKindNames=["Ident","Number","String","StringMultiLine","Set","Nil","BoolConst","Range","Unary","Binary","FuncParams","ArrayParams","ListOfExp","Inherited","Self","Specialize","Procedure"],this.OpcodeStrings=["","+","-","*","/","div","mod","**","shr","shl","not","and","or","xor","=","<>","<",">","<=",">=","in","is","as","><","@","^","@@","."],this.OperatorTokens=["","","","*","+","-","/","<","=",">",":=","<>","<=",">=","**","><","Inc","Dec","mod","-","+","Or","div","shl","or","and","xor","and","not","xor","shr","enumerator","in","","","",""],this.OperatorNames=["","implicit","explicit","multiply","add","subtract","divide","lessthan","equal","greaterthan","assign","notequal","lessthanorequal","greaterthanorequal","power","symmetricaldifference","inc","dec","modulus","negative","positive","bitwiseor","intdivide","leftshift","logicalor","bitwiseand","bitwisexor","logicaland","logicalnot","logicalxor","rightshift","enumerator","in","initialize","finalize","addref","copy"],this.AssignKindNames=[":=","+=","-=","*=","/="],this.cCallingConventions=["","Register","Pascal","cdecl","stdcall","OldFPCCall","safecall","SysCall","MWPascal","HardFloat","SysV_ABI_Default","SysV_ABI_CDecl","MS_ABI_Default","MS_ABI_CDecl","VectorCall","WinApi"],this.ProcTypeModifiers=["of Object","is nested","static","varargs","reference to","async","far","cblock"],this.ModifierNames=["virtual","dynamic","abstract","override","export","overload","message","reintroduce","inline","assembler","public","compilerproc","external","forward","dispid","noreturn","far","final","discardresult","nostackframe","section","rtlproc","internproc","weakexternal"],this.VariableModifierNames=["cvar","external","public","export","class","static","far"],this.FreeProcNameParts=function(e){var t=0,s=null;if(null!==e.get()){for(var i=0,r=e.get().FCount-1;i<=r;i++)t=i,s=rtl.getObject(e.get().Get(t)),rtl.free(s,"Templates"),s=rtl.freeLoc(s);e.set(rtl.freeLoc(e.get())),e.set(null)}},t.$resourcestrings={SPasTreeElement:{org:"generic element"},SPasTreeSection:{org:"unit section"},SPasTreeProgramSection:{org:"program section"},SPasTreeLibrarySection:{org:"library section"},SPasTreePackageSection:{org:"package section"},SPasTreeInterfaceSection:{org:"interface section"},SPasTreeImplementationSection:{org:"implementation section"},SPasTreeRequiredPackage:{org:"Required package"},SPasTreeUsesUnit:{org:"uses unit"},SPasTreeModule:{org:"module"},SPasTreeUnit:{org:"unit"},SPasTreePackage:{org:"package"},SPasTreeResString:{org:"resource string"},SPasTreeType:{org:"generic type"},SPasTreePointerType:{org:"pointer type"},SPasTreeAliasType:{org:"alias type"},SPasTreeTypeAliasType:{org:'"type" alias type'},SPasTreeClassOfType:{org:'"class of" type'},SPasTreeRangeType:{org:"range type"},SPasTreeArrayType:{org:"array type"},SPasTreeFileType:{org:"file type"},SPasTreeEnumValue:{org:"enumeration value"},SPasTreeEnumType:{org:"enumeration type"},SPasTreeSetType:{org:"set type"},SPasTreeRecordType:{org:"record type"},SPasStringType:{org:"string type"},SPasTreeObjectType:{org:"object"},SPasTreeClassType:{org:"class"},SPasTreeInterfaceType:{org:"interface"},SPasTreeSpecializedType:{org:"specialized class type"},SPasTreeSpecializedExpr:{org:"specialize expr"},SPasClassHelperType:{org:"class helper type"},SPasRecordHelperType:{org:"record helper type"},SPasTypeHelperType:{org:"type helper type"},SPasTreeArgument:{org:"argument"},SPasTreeProcedureType:{org:"procedure type"},SPasTreeResultElement:{org:"function result"},SPasTreeFunctionType:{org:"function type"},SPasTreeUnresolvedTypeRef:{org:"unresolved type reference"},SPasTreeVariable:{org:"variable"},SPasTreeConst:{org:"constant"},SPasTreeProperty:{org:"property"},SPasTreeOverloadedProcedure:{org:"overloaded procedure"},SPasTreeProcedure:{org:"procedure"},SPasTreeFunction:{org:"function"},SPasTreeOperator:{org:"operator"},SPasTreeClassProcedure:{org:"class procedure"},SPasTreeClassFunction:{org:"class function"},SPasTreeClassConstructor:{org:"class constructor"},SPasTreeClassDestructor:{org:"class destructor"},SPasTreeConstructor:{org:"constructor"},SPasTreeDestructor:{org:"destructor"},SPasTreeAnonymousProcedure:{org:"anonymous procedure"},SPasTreeAnonymousFunction:{org:"anonymous function"}}}),rtl.module("PasResolveEval",["System","SysUtils","Classes","Math","PasTree","PScanner"],function(){"use strict";var e,t,s=this,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=pas.PasTree,C=m.TPasElementBase,S=pas.System,T=S.TObject,y=pas.SysUtils,g=y.IntToStr,E=S.Frac,P=S.Trunc,I=m.TPasEnumType,R=y.Exception,v=m.TPasEnumValue,A=pas.PScanner.SafeFormat,N=S.VarRecs,x=m.TBinaryExpr,b=y.EOverflow,O=y.ERangeError,k=S.Copy,$=m.TPrimitiveExpr,D=S.val,L=S.Pos,B=S.val$1,M=S.val$8,G=m.TNilExpr,w=m.TBoolConstExpr,V=m.TUnaryExpr,U=m.TParamsExpr,J=m.TArrayValues,j=m.TPasProcedure,H=m.TPasImplBlock,W=S.StringOfChar,Y=m.TPasArrayType,z=y.Format,_=m.TPasElement,K=m.TPasGenericType,X=y.IsValidIdent;this.nIdentifierNotFound=3001,this.nNotYetImplemented=3002,this.nIllegalQualifier=3003,this.nSyntaxErrorExpectedButFound=3004,this.nWrongNumberOfParametersForCallTo=3005,this.nIncompatibleTypeArgNo=3006,this.nIncompatibleTypeArgNoVarParamMustMatchExactly=3007,this.nVariableIdentifierExpected=3008,this.nDuplicateIdentifier=3009,this.nXExpectedButYFound=3010,this.nAncestorCycleDetected=3011,this.nCantUseForwardDeclarationAsAncestor=3012,this.nCantDetermineWhichOverloadedFunctionToCall=3013,this.nForwardTypeNotResolved=3014,this.nForwardProcNotResolved=3015,this.nInvalidXModifierY=3016,this.nAbstractMethodsMustNotHaveImplementation=3017,this.nCallingConventionMismatch=3018,this.nResultTypeMismatchExpectedButFound=3019,this.nFunctionHeaderMismatchForwardVarName=3020,this.nFunctionHidesIdentifier_NonVirtualMethod=3021,this.nNoMethodInAncestorToOverride=3022,this.nInheritedOnlyWorksInMethods=3023,this.nInheritedNeedsAncestor=3024,this.nNoPropertyFoundToOverride=3025,this.nExprTypeMustBeClassOrRecordTypeGot=3026,this.nPropertyNotWritable=3027,this.nIncompatibleTypesGotExpected=3028,this.nTypesAreNotRelatedXY=3029,this.nAbstractMethodsCannotBeCalledDirectly=3030,this.nMissingParameterX=3031,this.nInstanceMemberXInaccessible=3032,this.nInOperatorExpectsSetElementButGot=3033,this.nWrongNumberOfParametersForTypeCast=3034,this.nIllegalTypeConversionTo=3035,this.nConstantExpressionExpected=3036,this.nLeftSideOfIsOperatorExpectsAClassButGot=3037,this.nNotReadable=3038,this.nClassPropertyAccessorMustBeStatic=3039,this.nClassPropertyAccessorMustNotBeStatic=3040,this.nOnlyOneDefaultPropertyIsAllowed=3041,this.nWrongNumberOfParametersForArray=3042,this.nCantAssignValuesToAnAddress=3043,this.nIllegalExpression=3044,this.nCantAccessXMember=3045,this.nMustBeInsideALoop=3046,this.nExpectXArrayElementsButFoundY=3047,this.nCannotCreateADescendantOfTheSealedXY=3048,this.nAncestorIsNotExternal=3049,this.nPropertyMustHaveReadOrWrite=3050,this.nExternalClassInstanceCannotAccessStaticX=3051,this.nXModifierMismatchY=3052,this.nSymbolCannotBePublished=3053,this.nCannotTypecastAType=3054,this.nTypeIdentifierExpected=3055,this.nCannotNestAnonymousX=3056,this.nFoundCallCandidateX=3057,this.nTextAfterFinalIgnored=3058,this.nNoMemberIsProvidedToAccessProperty=3059,this.nTheUseOfXisNotAllowedInARecord=3060,this.nParameterlessConstructorsNotAllowedInRecords=3061,this.nMultipleXinTypeYNameZCAandB=3062,this.nXCannotHaveParameters=3063,this.nRangeCheckError=3064,this.nHighRangeLimitLTLowRangeLimit=3065,this.nRangeCheckEvaluatingConstantsVMinMax=3066,this.nOverflowInArithmeticOperation=3068,this.nDivByZero=3069,this.nRangeCheckInSetConstructor=3070,this.nIncompatibleTypesGotParametersExpected=3071,this.nAddingIndexSpecifierRequiresNewX=3072,this.nCantFindUnitX=3073,this.nCannotFindEnumeratorForType=3074,this.nPreviousDeclMissesOverload=3075,this.nOverloadedProcMissesOverload=3076,this.nMethodHidesMethodOfBaseType=3077,this.nContextExpectedXButFoundY=3078,this.nContextXInvalidY=3079,this.nIdentifierXIsNotAnInstanceField=3080,this.nXIsNotSupported=3081,this.nOperatorIsNotOverloadedAOpB=3082,this.nIllegalQualifierAfter=3084,this.nIllegalQualifierInFrontOf=3085,this.nClassXNotFoundInThisModule=3087,this.nClassMethodsMustBeStaticInX=3088,this.nCannotMixMethodResolutionAndDelegationAtX=3089,this.nImplementsDoesNotSupportArrayProperty=3101,this.nImplementsDoesNotSupportIndex=3102,this.nImplementsUsedOnUnimplIntf=3103,this.nDuplicateImplementsForIntf=3103,this.nImplPropMustHaveReadSpec=3104,this.nDoesNotImplementInterface=3105,this.nTypeCycleFound=3106,this.nTypeXIsNotYetCompletelyDefined=3107,this.nDuplicateCaseValueXatY=3108,this.nMissingFieldsX=3109,this.nCantAssignValuesToConstVariable=3110,this.nIllegalAssignmentToForLoopVar=3111,this.nFunctionHidesIdentifier_NonProc=3112,this.nTypeXCannotBeExtendedByATypeHelper=3113,this.nTypeXCannotBeExtendedByARecordHelper=3114,this.nDerivedXMustExtendASubClassY=3115,this.nDefaultPropertyNotAllowedInHelperForX=3116,this.nHelpersCannotBeUsedAsTypes=3117,this.nMessageHandlersInvalidParams=3118,this.nWrongTypeXInArrayConstructor=3120,this.nUnknownCustomAttributeX=3121,this.nAttributeIgnoredBecauseAbstractX=3122,this.nCreatingAnInstanceOfAbstractClassY=3123,this.nIllegalExpressionAfterX=3124,this.nMethodHidesNonVirtualMethodExactly=3125,this.nDuplicatePublishedMethodXAtY=3126,this.nConstraintXSpecifiedMoreThanOnce=3127,this.nConstraintXAndConstraintYCannotBeTogether=3128,this.nXIsNotAValidConstraint=3129,this.nWrongNumberOfParametersForGenericX=3130,this.nGenericsWithoutSpecializationAsType=3131,this.nDeclOfXDiffersFromPrevAtY=3132,this.nTypeParamXIsMissingConstraintY=3133,this.nTypeParamXIsNotCompatibleWithY=3134,this.nTypeParamXMustSupportIntfY=3135,this.nTypeParamsNotAllowedOnX=3136,this.nXMethodsCannotHaveTypeParams=3137,this.nImplMustNotRepeatConstraints=3138,this.nCouldNotInferTypeArgXForMethodY=3139,this.nInferredTypeXFromDiffArgsMismatchFromMethodY=3140,this.nParamOfThisTypeCannotHaveDefVal=3141,this.nClassTypesAreNotRelatedXY=3142,this.nDirectiveXNotAllowedHere=3143,this.nAwaitWithoutPromise=3144,this.nSymbolCannotBeExportedFromALibrary=3145,this.nForLoopControlVarMustBeSimpleLocalVar=3146,this.nIllegalCharConst=3147,this.nVirtualMethodXHasLowerVisibility=3250,this.nConstructingClassXWithAbstractMethodY=4046,this.nNoMatchingImplForIntfMethodXFound=5042,this.nSymbolXIsDeprecated=5043,this.nSymbolXBelongsToALibrary=5065,this.nSymbolXIsDeprecatedY=5066,this.nSymbolXIsNotPortable=5076,this.nSymbolXIsNotImplemented=5078,this.nSymbolXIsExperimental=5079,rtl.createClass(this,"TResolveData",C,function(){i=this,this.$init=function(){C.$init.call(this),this.FElement=null,this.Owner=null,this.Next=null},this.$final=function(){this.FElement=void 0,this.Owner=void 0,this.Next=void 0,C.$final.call(this)},this.SetElement=function(e){this.FElement!==e&&(this.FElement=e)},this.Create$1=function(){return this},this.Destroy=function(){this.SetElement(null),this.Owner=null,this.Next=null,T.Destroy.call(this)}}),this.HighIntAsUInt=9007199254740991,this.MinSafeIntCurrency=-922337203685477,this.MaxSafeIntCurrency=922337203685477,this.MinSafeIntSingle=-16777216,this.MaxSafeIntSingle=16777216,this.MinSafeIntDouble=-9007199254740991,this.MaxSafeIntDouble=9007199254740991,e=this.TREVKind={0:"revkNone",revkNone:0,1:"revkCustom",revkCustom:1,2:"revkNil",revkNil:2,3:"revkBool",revkBool:3,4:"revkInt",revkInt:4,5:"revkUInt",revkUInt:5,6:"revkFloat",revkFloat:6,7:"revkCurrency",revkCurrency:7,8:"revkUnicodeString",revkUnicodeString:8,9:"revkEnum",revkEnum:9,10:"revkRangeInt",revkRangeInt:10,11:"revkRangeUInt",revkRangeUInt:11,12:"revkSetOfInt",revkSetOfInt:12,13:"revkExternal",revkExternal:13},this.revkAllStrings=rtl.createSet(8),rtl.createClass(this,"TResEvalValue",i,function(){r=this,this.$init=function(){i.$init.call(this),this.Kind=0,this.IdentEl=null},this.$final=function(){this.IdentEl=void 0,i.$final.call(this)},this.CreateKind=function(e){return this.Create$1(),this.Kind=e,this},this.Clone=function(){var e=null;return(e=this.$class.ClassType().$create("Create$1")).Kind=this.Kind,e.IdentEl=this.IdentEl,e},this.AsDebugString=function(){return e[this.Kind]+"="+this.AsString()},this.AsString=function(){var t=this.Kind;return 0===t?"<None>":2===t?"nil":e[this.Kind]}}),rtl.createClass(this,"TResEvalBool",r,function(){n=this,this.$init=function(){r.$init.call(this),this.B=!1},this.Create$1=function(){return i.Create$1.call(this),this.Kind=3,this},this.CreateValue=function(e){return this.Create$1(),this.B=e,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).B=this.B,e},this.AsString=function(){return this.B?"true":"false"}}),this.TResEvalTypedInt={0:"reitNone",reitNone:0,1:"reitByte",reitByte:1,2:"reitShortInt",reitShortInt:2,3:"reitWord",reitWord:3,4:"reitSmallInt",reitSmallInt:4,5:"reitUIntSingle",reitUIntSingle:5,6:"reitIntSingle",reitIntSingle:6,7:"reitLongWord",reitLongWord:7,8:"reitLongInt",reitLongInt:8,9:"reitUIntDouble",reitUIntDouble:9,10:"reitIntDouble",reitIntDouble:10},this.reitDefaults=rtl.createSet(0,1,2,3,4,7,8),this.reitAllSigned=rtl.createSet(0,2,4,6,8,10),this.reitLow=[-9007199254740991,0,-128,0,-32768,0,-16777216,0,-2147483648,0,-9007199254740991],rtl.createClass(this,"TResEvalInt",r,function(){l=this,this.$init=function(){r.$init.call(this),this.Int=0,this.Typed=0},this.Create$1=function(){return i.Create$1.call(this),this.Kind=4,this},this.CreateValue=function(e){return this.Create$1(),this.Int=e,this},this.CreateValue$1=function(e,t){return this.Create$1(),this.Int=e,this.Typed=t,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).Int=this.Int,e.Typed=this.Typed,e},this.AsString=function(){return g(this.Int)},this.AsDebugString=function(){var t="";if(0===this.Typed)t=r.AsDebugString.call(this);else{t=e[this.Kind];var s=this.Typed;1===s?t+=":byte":2===s?t+=":shortint":3===s?t+=":word":4===s?t+=":smallint":5===s?t+=":uintsingle":6===s?t+=":intsingle":7===s?t+=":longword":8===s?t+=":longint":9===s?t+=":uintdouble":10===s&&(t+=":intdouble"),t=t+"="+this.AsString()}return t}}),rtl.createClass(this,"TResEvalUInt",r,function(){a=this,this.$init=function(){r.$init.call(this),this.UInt=0},this.Create$1=function(){return i.Create$1.call(this),this.Kind=5,this},this.CreateValue=function(e){return this.Create$1(),this.UInt=e,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).UInt=this.UInt,e},this.AsString=function(){return g(this.UInt)}}),rtl.createClass(this,"TResEvalFloat",r,function(){o=this,this.$init=function(){r.$init.call(this),this.FloatValue=0},this.Create$1=function(){return i.Create$1.call(this),this.Kind=6,this},this.CreateValue=function(e){return this.Create$1(),this.FloatValue=e,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).FloatValue=this.FloatValue,e},this.AsString=function(){return rtl.floatToStr(this.FloatValue)},this.IsInt=function(e){return e.set(0),0===E(this.FloatValue)&&(!(this.FloatValue<-9007199254740991)&&(!(this.FloatValue>9007199254740991)&&(e.set(P(this.FloatValue)),true)))}}),rtl.createClass(this,"TResEvalCurrency",r,function(){h=this,this.$init=function(){r.$init.call(this),this.Value=0},this.Create$1=function(){return i.Create$1.call(this),this.Kind=7,this},this.CreateValue=function(e){return this.Create$1(),this.Value=e,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).Value=this.Value,e},this.AsString=function(){return rtl.floatToStr(this.Value/1e4)},this.IsInt=function(e){var t,s;return t=(s=this.AsInt())%1e4==0,e.set(rtl.trunc(s/1e4)),t},this.AsInt=function(){return rtl.trunc(this.Value/1e4)}}),rtl.createClass(this,"TResEvalUTF16",r,function(){u=this,this.$init=function(){r.$init.call(this),this.S=""},this.Create$1=function(){return i.Create$1.call(this),this.Kind=8,this},this.CreateValue=function(e){return this.Create$1(),this.S=e,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).S=this.S,e},this.AsString=function(){return s.UnicodeStrToCaption(this.S,60)}}),rtl.createClass(this,"TResEvalEnum",r,function(){c=this,this.$init=function(){r.$init.call(this),this.Index=0,this.ElType=null},this.$final=function(){this.ElType=void 0,r.$final.call(this)},this.Create$1=function(){return i.Create$1.call(this),this.Kind=9,this},this.CreateValue=function(e,t){if(this.Create$1(),this.Index=e,this.IdentEl=t,this.ElType=rtl.as(this.IdentEl.FParent,I),null===this.ElType)throw R.$create("Create$1",[""]);return this},this.GetEnumValue=function(){var e=null;return e=null,null!==this.ElType&&this.Index>=0&&this.Index<this.ElType.Values.FCount&&(e=rtl.as(rtl.getObject(this.ElType.Values.Get(this.Index)),v)),e},this.GetEnumName=function(){var e;return null!==(e=this.GetEnumValue())?e.FName:""},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).Index=this.Index,e.ElType=this.ElType,e},this.AsDebugString=function(){return e[this.Kind]+"="+this.AsString()+"="+g(this.Index)},this.AsString=function(){var e="";return null!==this.IdentEl&&""!==(e=this.IdentEl.FName)||""!==(e=this.GetEnumName())?e:e=this.ElType.FName+"("+g(this.Index)+")"}}),t=this.TRESetElKind={0:"revskNone",revskNone:0,1:"revskEnum",revskEnum:1,2:"revskInt",revskInt:2,3:"revskChar",revskChar:3,4:"revskBool",revskBool:4},rtl.createClass(this,"TResEvalRangeInt",r,function(){p=this,this.$init=function(){r.$init.call(this),this.ElKind=0,this.RangeStart=0,this.RangeEnd=0,this.ElType=null},this.$final=function(){this.ElType=void 0,r.$final.call(this)},this.Create$1=function(){return i.Create$1.call(this),this.Kind=10,this},this.CreateValue=function(e,t,s,i){return this.Create$1(),this.ElKind=e,this.ElType=t,this.RangeStart=s,this.RangeEnd=i,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).ElKind=this.ElKind,e.RangeStart=this.RangeStart,e.RangeEnd=this.RangeEnd,e},this.AsString=function(){return this.ElementAsString(this.RangeStart)+".."+this.ElementAsString(this.RangeEnd)},this.AsDebugString=function(){return e[this.Kind]+"/"+t[this.ElKind]+":"+s.GetObjName(this.ElType)+"="+this.AsString()},this.ElementAsString=function(e){var t="",s=null,i=this.ElKind;return 4===i?t=0===e?"false":"true":1===i?(s=rtl.as(this.ElType,I),t=e>=0&&e<s.Values.FCount?rtl.getObject(s.Values.Get(e)).FName:this.ElType.FName+"("+g(e)+")"):2===i?t=g(e):3===i&&(t=e>=32&&e<=38||e>=40&&e<=126?"'"+String.fromCharCode(e)+"'":"#"+g(e)),t}}),rtl.createClass(this,"TResEvalRangeUInt",r,function(){f=this,this.$init=function(){r.$init.call(this),this.RangeStart=0,this.RangeEnd=0},this.Create$1=function(){return i.Create$1.call(this),this.Kind=10,this},this.CreateValue=function(e,t){return this.Create$1(),this.RangeStart=e,this.RangeEnd=t,this},this.Clone=function(){var e=null;return(e=r.Clone.call(this)).RangeStart=this.RangeStart,e.RangeEnd=this.RangeEnd,e},this.AsString=function(){return g(this.RangeStart)+".."+g(this.RangeEnd)}}),rtl.createClass(this,"TResEvalSet",p,function(){d=this,rtl.recNewT(this,"TItem",function(){F=this,this.RangeStart=0,this.RangeEnd=0,this.$eq=function(e){return this.RangeStart===e.RangeStart&&this.RangeEnd===e.RangeEnd},this.$assign=function(e){return this.RangeStart=e.RangeStart,this.RangeEnd=e.RangeEnd,this}}),this.$init=function(){p.$init.call(this),this.Ranges=[]},this.$final=function(){this.Ranges=void 0,p.$final.call(this)},this.Create$1=function(){return p.Create$1.call(this),this.Kind=12,this},this.CreateEmpty=function(e,t){return this.Create$1(),this.ElKind=e,this.ElType=t,this},this.CreateEmptySameKind=function(e){return this.Create$1(),this.IdentEl=e.IdentEl,this.ElKind=e.ElKind,this.ElType=e.ElType,this},this.CreateValue=function(e,t,s,i){return p.CreateValue.call(this,e,t,s,i),this.Add(s,i),this},this.Clone=function(){var e,t=null,s=0;(t=e=p.Clone.call(this)).ElKind=this.ElKind,t.ElType=this.ElType,t.Ranges=rtl.arraySetLength(t.Ranges,F,rtl.length(this.Ranges));for(var i=0,r=rtl.length(this.Ranges)-1;i<=r;i++)s=i,t.Ranges[s].$assign(this.Ranges[s]);return e},this.AsString=function(){var e="",t=0;e="[";for(var s=0,i=rtl.length(this.Ranges)-1;s<=i;s++)(t=s)>0&&(e+=","),e+=this.ElementAsString(this.Ranges[t].RangeStart),this.Ranges[t].RangeStart!==this.Ranges[t].RangeEnd&&(e=e+".."+this.ElementAsString(this.Ranges[t].RangeEnd));return e+="]"},this.Add=function(e,t){var s=!1;function i(e,t,s){var i=0;t.set(rtl.arraySetLength(t.get(),F,rtl.length(t.get())+1));for(var r=rtl.length(t.get())-1,n=s+1;r>=n;r--)i=r,t.get()[i].$assign(t.get()[i-1]);t.get()[s].$assign(e)}var r,n=0,l=0,a=F.$new();if(s=!1,e>t)throw R.$create("Create$1",[""]);if(0===this.ElKind)throw R.$create("Create$1",[""]);if(0===(r=rtl.length(this.Ranges)))return this.RangeStart=e,this.RangeEnd=t,this.Ranges=rtl.arraySetLength(this.Ranges,F,1),this.Ranges[0].RangeStart=e,this.Ranges[0].RangeEnd=t,!0;if(this.RangeStart>e&&(this.RangeStart=e),this.RangeEnd<t&&(this.RangeEnd=t),(n=this.IndexOfRange(e,!0))>0&&this.Ranges[n-1].RangeEnd===e-1&&(n-=1),n===r)a.RangeStart=e,a.RangeEnd=t,i(a,{p:this,get:function(){return this.p.Ranges},set:function(e){this.p.Ranges=e}},n),s=!0;else{if((l=this.IndexOfRange(t,!0))>n&&(l===r||this.Ranges[l].RangeStart>t+1)&&(l-=1),n>l)throw R.$create("Create$1",[""]);n===l?this.Ranges[n].RangeStart>t?this.Ranges[n].RangeStart>t+1?(a.RangeStart=e,a.RangeEnd=t,i(a,{p:this,get:function(){return this.p.Ranges},set:function(e){this.p.Ranges=e}},n),s=!0):(this.Ranges[n].RangeStart=e,s=!0):this.Ranges[n].RangeEnd<e?this.Ranges[n].RangeEnd+1<e?(a.RangeStart=e,a.RangeEnd=t,i(a,{p:this,get:function(){return this.p.Ranges},set:function(e){this.p.Ranges=e}},n+1),s=!0):(this.Ranges[n].RangeEnd=t,s=!0):(s=!1,this.Ranges[n].RangeStart>e&&(this.Ranges[n].RangeStart=e),this.Ranges[n].RangeEnd<t&&(this.Ranges[n].RangeEnd=t)):(s=!1,this.Ranges[n].RangeStart>e&&(this.Ranges[n].RangeStart=e),t<this.Ranges[l].RangeEnd&&(t=this.Ranges[l].RangeEnd),this.Ranges[n].RangeEnd=t,function(e,t,s){var i=0;if(0!==s){for(var r=t+s,n=rtl.length(e.get())-1;r<=n;r++)i=r,e.get()[i-s].$assign(e.get()[i]);e.set(rtl.arraySetLength(e.get(),F,rtl.length(e.get())-s))}}({p:this,get:function(){return this.p.Ranges},set:function(e){this.p.Ranges=e}},n+1,l-n))}return s},this.IndexOfRange=function(e,t){var s=0,i=0,r=0;for(s=0,i=rtl.length(this.Ranges)-1;s<=i;)if(r=rtl.trunc((s+i)/2),this.Ranges[r].RangeStart>e)i=r-1;else{if(!(this.Ranges[r].RangeEnd<e))return r;s=r+1}return t?0===rtl.length(this.Ranges)?0:s>r?s:r:-1},this.Intersects=function(e,t){var s;return(s=this.IndexOfRange(e,!0))===rtl.length(this.Ranges)||this.Ranges[s].RangeStart>t?-1:s}}),rtl.createClass(this,"TResEvalExternal",r,function(){this.Create$1=function(){return i.Create$1.call(this),this.Kind=13,this},this.Clone=function(){return r.Clone.call(this)},this.AsString=function(){return r.AsString.call(this)}}),this.TResEvalFlag={0:"refConst",refConst:0,1:"refConstExt",refConstExt:1,2:"refAutoConst",refAutoConst:2,3:"refAutoConstExt",refAutoConstExt:3},rtl.createClass(this,"TResExprEvaluator",T,function(){this.$init=function(){T.$init.call(this),this.FAllowedInts={},this.FOnEvalIdentifier=null,this.FOnEvalParams=null,this.FOnLog=null,this.FOnRangeCheckEl=null},this.$final=function(){this.FAllowedInts=void 0,this.FOnEvalIdentifier=void 0,this.FOnEvalParams=void 0,this.FOnLog=void 0,this.FOnRangeCheckEl=void 0,T.$final.call(this)},this.LogMsg=function(e,t,s,i,r,n){this.FOnLog(this,e,t,s,i,r,n)},this.RaiseMsg=function(e,t,s,i,r){throw this.LogMsg(e,1,t,s,i,r),R.$create("Create$1",["["+g(e)+"] ("+g(t)+") "+A(s,i)])},this.RaiseNotYetImplemented=function(e,t,i){var r="";r=rtl.getResStr(s,"sNotYetImplemented")+" ["+g(e)+"]",""!==i&&(r=r+" "+i),this.RaiseMsg(e,3002,r,N(18,s.GetObjName(t)),t)},this.RaiseInternalError=function(e,t){throw R.$create("Create$1",["Internal error: ["+g(e)+"] "+t])},this.RaiseConstantExprExp=function(e,t){this.RaiseMsg(e,3036,rtl.getResStr(s,"sConstantExpressionExpected"),[],t)},this.RaiseRangeCheck=function(e,t){this.RaiseMsg(e,3064,rtl.getResStr(s,"sRangeCheckError"),[],t)},this.RaiseOverflowArithmetic=function(e,t){this.RaiseMsg(e,3068,rtl.getResStr(s,"sOverflowInArithmeticOperation"),[],t)},this.RaiseDivByZero=function(e,t){this.RaiseMsg(e,3069,rtl.getResStr(s,"sDivByZero"),[],t)},this.EvalUnaryExpr=function(e,t){var i=null,n=0,a=0;if(null===(i=this.Eval(e.Operand,rtl.refSet(t))))return i;var h=e.OpCode;if(1===h);else if(2===h){var u=i.Kind;if(4===u){if(0===(n=i.Int))return i;if(null!==i.FElement&&(i=i.Clone()),i.Typed in s.reitAllSigned){if(n===s.reitLow[i.Typed]){if(0===i.Typed)return s.ReleaseEvalValue({get:function(){return i},set:function(e){i=e}}),i=o.$create("CreateValue",[9007199254740991]);i.Typed=0}}else i.Typed=0;i.Int=-n}else if(5===u){if(0===(a=i.UInt))return i;a<=9007199254740991?(s.ReleaseEvalValue({get:function(){return i},set:function(e){i=e}}),i=l.$create("CreateValue",[-a])):(s.ReleaseEvalValue({get:function(){return i},set:function(e){i=e}}),i=o.$create("CreateValue",[-a]))}else if(6===u){if(0===i.FloatValue)return i;null!==i.FElement&&(i=i.Clone()),i.FloatValue=-i.FloatValue}else if(7===u){if(0===i.Value)return i;null!==i.FElement&&(i=i.Clone()),i.Value=-i.Value}else{if(13===u)return i;null===i.FElement&&(i=rtl.freeLoc(i)),this.RaiseNotYetImplemented(20170518230738,e,"")}}else if(10===h){var c=i.Kind;if(3===c)null!==i.FElement&&(i=i.Clone()),i.B=!i.B;else if(4===c){null!==i.FElement&&(i=i.Clone());var p=i.Typed;1===p?i.Int=~(255&i.Int):2===p?i.Int=~((255&i.Int)<<24>>24):3===p?i.Int=~(65535&i.Int):4===p?i.Int=~((65535&i.Int)<<16>>16):5===p?i.Int=4194303&~i.Int:6===p?i.Int=8388607&~i.Int:7===p?i.Int=rtl.lw(~(i.Int>>>0)):8===p?i.Int=~(4294967295&i.Int):9===p?i.Int=rtl.and(~i.Int,0xfffffffffffff):10===p||(i.Int=~i.Int)}else if(5===c)null!==i.FElement&&(i=i.Clone()),i.UInt=~i.UInt;else{if(13===c)return i;null===i.FElement&&(i=rtl.freeLoc(i)),this.RaiseNotYetImplemented(20170518232804,e,"")}}else 24===h?(null===i.FElement&&(i=rtl.freeLoc(i)),i=r.$create("CreateKind",[2])):this.RaiseNotYetImplemented(20170518232823,e,"operator="+m.OpcodeStrings[e.OpCode]);return i},this.EvalBinaryExpr=function(e,t){var i=null,r=null,n=null,l=null,a=null;if(i=null,9===e.Kind&&27===e.OpCode)return i=this.Eval(e.Right,rtl.refSet(t));r=null,n=null;try{if(1===e.OpCode){for(l=e.Left;l.$class.ClassType()===x&&1===(a=l).OpCode;)l=a.Left;for(r=this.Eval(l,rtl.refSet(t));null!==r;){if(a=l.FParent,null===(n=this.Eval(a.Right,rtl.refSet(t))))return i;if(13===r.Kind)return rtl.eqSet(rtl.intersectSet(rtl.createSet(0,1),t),rtl.createSet(0))&&this.RaiseConstantExprExp(20210321205928,e.Left),i=r,r=null,i;if(13===n.Kind)return rtl.eqSet(rtl.intersectSet(rtl.createSet(0,1),t),rtl.createSet(0))&&this.RaiseConstantExprExp(20210321205948,e.Right),i=n,n=null,i;if(i=this.EvalBinaryAddExpr(a,r,n),s.ReleaseEvalValue({get:function(){return r},set:function(e){r=e}}),s.ReleaseEvalValue({get:function(){return n},set:function(e){n=e}}),a===e)return i;r=i,i=null,l=a}return i}if(null===(r=this.Eval(e.Left,rtl.refSet(t))))return i;if(null===(n=this.Eval(e.Right,rtl.refSet(t))))return i;if(13===r.Kind)return rtl.eqSet(rtl.intersectSet(rtl.createSet(0,1),t),rtl.createSet(0))&&this.RaiseConstantExprExp(20181024134508,e.Left),i=r,r=null,i;if(13===n.Kind)return rtl.eqSet(rtl.intersectSet(rtl.createSet(0,1),t),rtl.createSet(0))&&this.RaiseConstantExprExp(20181024134545,e.Right),i=n,n=null,i;var o=e.Kind;if(7===o)i=this.EvalBinaryRangeExpr(e,r,n);else if(9===o){var h=e.OpCode;1===h?i=this.EvalBinaryAddExpr(e,r,n):2===h?i=this.EvalBinarySubExpr(e,r,n):3===h?i=this.EvalBinaryMulExpr(e,r,n):4===h?i=this.EvalBinaryDivideExpr(e,r,n):5===h?i=this.EvalBinaryDivExpr(e,r,n):6===h?i=this.EvalBinaryModExpr(e,r,n):7===h?i=this.EvalBinaryPowerExpr(e,r,n):9===h||8===h?i=this.EvalBinaryShiftExpr(e,r,n):11===h||12===h||13===h?i=this.EvalBinaryBoolOpExpr(e,r,n):14===h||15===h?i=this.EvalBinaryNEqualExpr(e,r,n):16===h||17===h||18===h||19===h?i=this.EvalBinaryLessGreaterExpr(e,r,n):20===h?i=this.EvalBinaryInExpr(e,r,n):23===h?i=this.EvalBinarySymmetricaldifferenceExpr(e,r,n):this.RaiseNotYetImplemented(20170530100823,e,"")}else this.RaiseNotYetImplemented(20170530100827,e,"")}finally{s.ReleaseEvalValue({get:function(){return r},set:function(e){r=e}}),s.ReleaseEvalValue({get:function(){return n},set:function(e){n=e}})}return i},this.EvalBinaryRangeExpr=function(e,t,i){var r=null,n=0,l=0,a=t.Kind;if(3===a){if(3===i.Kind)return(n=t.B+0)>(l=i.B+0)&&this.RaiseMsg(20170714133540,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=p.$create("CreateValue",[4,null,n,l]);this.RaiseRangeCheck(20170714133017,e.Right)}else if(4===a){if(4===i.Kind)return(n=t.Int)>(l=i.Int)&&this.RaiseMsg(20170518222939,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=p.$create("CreateValue",[2,null,n,l]);if(5===i.Kind)return i.UInt<=9007199254740991?(t.Int>i.UInt&&this.RaiseMsg(20170519000235,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=p.$create("CreateValue",[2,null,t.Int,i.UInt])):(t.Int<0?this.RaiseRangeCheck(20170522151629,e.Right):t.Int>i.UInt&&this.RaiseMsg(20170522151708,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=f.$create("CreateValue",[t.Int,i.UInt]));this.RaiseRangeCheck(20170518222812,e.Right)}else if(5===a){if(4===i.Kind)return t.UInt>9007199254740991?(i.Int<0?this.RaiseRangeCheck(20170522152608,e.Right):t.UInt>i.Int&&this.RaiseMsg(20170522152648,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=f.$create("CreateValue",[t.UInt,i.Int])):(t.UInt>i.Int&&this.RaiseMsg(20170522152804,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=p.$create("CreateValue",[2,null,t.UInt,i.Int]));if(5===i.Kind)return t.UInt>i.UInt&&this.RaiseMsg(20170519000240,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=f.$create("CreateValue",[t.UInt,i.UInt]);this.RaiseRangeCheck(20170522123106,e.Right)}else if(9===a)if(9!==i.Kind)this.RaiseRangeCheck(20170522153003,e.Right);else if(t.ElType!==i.ElType)this.RaiseRangeCheck(20170522123241,e.Right);else{if(!(t.Index>i.Index))return r=p.$create("CreateValue",[1,rtl.as(t.ElType,I),t.Index,i.Index]);this.RaiseMsg(20170522123320,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right)}else if(8===a){if(n=this.StringToOrd(t,e.Left),i.Kind in s.revkAllStrings)return n>(l=this.StringToOrd(i,e.Right))&&this.RaiseMsg(20170523151508,3065,rtl.getResStr(s,"sHighRangeLimitLTLowRangeLimit"),[],e.Right),r=p.$create("CreateValue",[3,null,n,l]);this.RaiseRangeCheck(20170522123106,e.Right)}return r},this.EvalBinaryAddExpr=function(e,t,s){var i=this,r=null;function n(t,s){var n=0,a=0;t>=0?(a=t+s,r=i.CreateResEvalInt(a)):s<=9007199254740991?(n=t+s,r=l.$create("CreateValue",[n])):i.RaiseRangeCheck(20170601140523,e)}var u=0,c=0,p=0,f=0,d=null,F=null,m=0;r=null;try{var C=t.Kind;if(4===C){u=rtl.rc(t.Int,-9007199254740991,9007199254740991);var S=s.Kind;4===S?u>0&&s.Int>0?(c=rtl.rc(rtl.oc(rtl.rc(u,0,9007199254740991)+rtl.rc(s.Int,0,9007199254740991)),0,9007199254740991),r=this.CreateResEvalInt(c)):(u=rtl.rc(rtl.oc(u+s.Int),-9007199254740991,9007199254740991),r=l.$create("CreateValue",[u])):5===S?n(u,s.UInt):6===S?r=o.$create("CreateValue",[rtl.oc(u+s.FloatValue)]):7===S?r=h.$create("CreateValue",[rtl.oc(1e4*u+s.Value)]):this.RaiseNotYetImplemented(20170525115537,e,"")}else if(5===C){c=rtl.rc(t.UInt,0,9007199254740991);var T=s.Kind;4===T?n(c,s.Int):5===T?(c=rtl.rc(rtl.oc(c+s.UInt),0,9007199254740991),r=a.$create("CreateValue",[c])):6===T?r=o.$create("CreateValue",[rtl.oc(c+s.FloatValue)]):7===T?r=h.$create("CreateValue",[rtl.oc(1e4*c+s.Value)]):this.RaiseNotYetImplemented(20170601141031,e,"")}else if(6===C){p=t.FloatValue;var y=s.Kind;4===y?r=o.$create("CreateValue",[rtl.oc(p+s.Int)]):5===y?r=o.$create("CreateValue",[rtl.oc(p+s.UInt)]):6===y?r=o.$create("CreateValue",[p+s.FloatValue]):7===y?r=h.$create("CreateValue",[rtl.oc(1e4*p+s.Value)]):this.RaiseNotYetImplemented(20170711145637,e,"")}else if(7===C){f=rtl.rc(t.Value,-922337203685477,922337203685477);var g=s.Kind;4===g?r=o.$create("CreateValue",[rtl.oc(f+1e4*s.Int)/1e4]):5===g?r=o.$create("CreateValue",[rtl.oc(f+1e4*s.UInt)/1e4]):6===g?r=o.$create("CreateValue",[rtl.oc(f+1e4*s.FloatValue)/1e4]):7===g?r=h.$create("CreateValue",[rtl.oc(f+s.Value)]):this.RaiseNotYetImplemented(20180421163819,e,"")}else if(8===C)r=this.EvalStringAddExpr(e,e.Left,e.Right,t,s);else if(12===C){if(12===s.Kind)if(F=s,0===(d=t).ElKind)r=F.Clone();else if(0===F.ElKind)r=d.Clone();else{r=F.Clone();for(var E=0,P=rtl.oc(rtl.length(d.Ranges)-1);E<=P;E++)for(m=E,u=rtl.rc(rtl.rcArrR(d.Ranges,m).RangeStart,-9007199254740991,9007199254740991);u<=rtl.rcArrR(d.Ranges,m).RangeEnd;)r.Add(u,u),u+=1}else this.RaiseNotYetImplemented(20170714114055,e,"")}else this.RaiseNotYetImplemented(20170525115548,e,"")}catch(t){if(b.isPrototypeOf(t))this.RaiseOverflowArithmetic(20170601140130,e);else{if(!O.isPrototypeOf(t))throw t;this.RaiseRangeCheck(20170601140132,e)}}return r},this.EvalBinarySubExpr=function(e,t,s){var i=null,r=0,n=0,u=0,c=0,p=null,f=null,F=0;i=null;var m=t.Kind;if(4===m){r=rtl.rc(t.Int,-9007199254740991,9007199254740991);var C=s.Kind;if(4===C)try{r=rtl.rc(r-s.Int,-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])}catch(t){if(!b.isPrototypeOf(t))throw t;r>0&&s.Int<0?(n=rtl.rc(rtl.rc(r,0,9007199254740991)+rtl.rc(-s.Int,0,9007199254740991),0,9007199254740991),i=this.CreateResEvalInt(n)):this.RaiseOverflowArithmetic(20170525230247,e)}else if(5===C)try{r=rtl.rc(r-s.UInt,-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151201,e)}else if(6===C)try{u=r-s.FloatValue,i=o.$create("CreateValue",[u])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151313,e)}else if(7===C)try{c=rtl.rc(rtl.rc(1e4*r,-922337203685477,922337203685477)-s.Value,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164011,e)}else this.RaiseNotYetImplemented(20170525230028,e,"")}else if(5===m){n=rtl.rc(t.UInt,0,9007199254740991);var S=s.Kind;if(4===S)try{n=rtl.rc(n-s.Int,0,9007199254740991),i=a.$create("CreateValue",[n])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151405,e)}else if(5===S)try{n=rtl.rc(n-s.UInt,0,9007199254740991),i=a.$create("CreateValue",[n])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151419,e)}else if(6===S)try{u=n-s.FloatValue,i=o.$create("CreateValue",[u])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151428,e)}else if(7===S)try{c=rtl.rc(rtl.rc(1e4*n,-922337203685477,922337203685477)-s.Value,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164005,e)}else this.RaiseNotYetImplemented(20170711151435,e,"")}else if(6===m){u=t.FloatValue;var T=s.Kind;if(4===T)try{u-=s.Int,i=o.$create("CreateValue",[u])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151519,e)}else if(5===T)try{u-=s.UInt,i=o.$create("CreateValue",[u])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151538,e)}else if(6===T)try{u-=s.FloatValue,i=o.$create("CreateValue",[u])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711151552,e)}else if(7===T)try{c=rtl.rc(1e4*u-s.Value,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164054,e)}else this.RaiseNotYetImplemented(20170711151600,e,"")}else if(7===m){c=rtl.rc(t.Value,-922337203685477,922337203685477);var y=s.Kind;if(4===y)try{c=rtl.rc(c-1e4*s.Int,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164200,e)}else if(5===y)try{c=rtl.rc(c-1e4*s.UInt,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164218,e)}else if(6===y)try{c=rtl.rc(c-1e4*s.FloatValue,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164250,e)}else if(7===y)try{c=rtl.rc(c-s.Value,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164258,e)}else this.RaiseNotYetImplemented(20180421164312,e,"")}else if(12===m){if(12===s.Kind)if(f=s,0===(p=t).ElKind)i=d.$create("CreateEmptySameKind",[f]);else{i=d.$create("CreateEmptySameKind",[p]);for(var g=0,E=rtl.length(p.Ranges)-1;g<=E;g++)for(F=g,r=rtl.rc(rtl.rcArrR(p.Ranges,F).RangeStart,-9007199254740991,9007199254740991);r<=rtl.rcArrR(p.Ranges,F).RangeEnd;)f.IndexOfRange(r,!1)<0&&i.Add(r,r),r+=1}else this.RaiseNotYetImplemented(20170714114101,e,"")}else this.RaiseNotYetImplemented(20170525225946,e,"");return i},this.EvalBinaryMulExpr=function(e,t,s){var i=null,r=0,n=0,u=0,c=0,p=null,f=null,F=0;i=null;var m=t.Kind;if(4===m){r=rtl.rc(t.Int,-9007199254740991,9007199254740991);var C=s.Kind;if(4===C)try{r=rtl.rc(r*s.Int,-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])}catch(t){if(!b.isPrototypeOf(t))throw t;if(r>0&&s.Int>0)try{n=rtl.rc(rtl.rc(r,0,9007199254740991)*rtl.rc(s.Int,0,9007199254740991),0,9007199254740991),i=this.CreateResEvalInt(n)}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170530101616,e)}else this.RaiseOverflowArithmetic(20170525230247,e)}else if(5===C)try{r=rtl.rc(r*s.UInt,-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])}catch(t){this.RaiseOverflowArithmetic(20170711164445,e)}else if(6===C)try{u=r*s.FloatValue,i=o.$create("CreateValue",[u])}catch(t){this.RaiseOverflowArithmetic(20170711164541,e)}else if(7===C)try{c=rtl.rc(r*s.Value,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){this.RaiseOverflowArithmetic(20180421164426,e)}else this.RaiseNotYetImplemented(20170525230028,e,"")}else if(5===m){n=rtl.rc(t.UInt,0,9007199254740991);var S=s.Kind;if(4===S)if(s.Int>=0)try{n=rtl.rc(n*s.Int,0,9007199254740991),i=a.$create("CreateValue",[n])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711164714,e)}else try{r=rtl.rc(n*s.Int,-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711164736,e)}else if(5===S)try{n=rtl.rc(n*s.UInt,0,9007199254740991),i=a.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20170711164751,e)}else if(6===S)try{u=n*s.FloatValue,i=o.$create("CreateValue",[u])}catch(t){this.RaiseOverflowArithmetic(20170711164800,e)}else if(7===S)try{c=rtl.rc(n*s.Value,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){this.RaiseOverflowArithmetic(20180421164500,e)}else this.RaiseNotYetImplemented(20170711164810,e,"")}else if(6===m){u=t.FloatValue;var T=s.Kind;if(4===T)try{u*=s.Int,i=o.$create("CreateValue",[u])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20170711164920,e)}else if(5===T)try{u*=s.UInt,i=o.$create("CreateValue",[u])}catch(t){this.RaiseOverflowArithmetic(20170711164940,e)}else if(6===T)try{u*=s.FloatValue,i=o.$create("CreateValue",[u])}catch(t){this.RaiseOverflowArithmetic(20170711164955,e)}else if(7===T)try{u=u*s.Value/1e4,i=o.$create("CreateValue",[u])}catch(t){this.RaiseOverflowArithmetic(20180421164542,e)}else this.RaiseNotYetImplemented(20170711165004,e,"")}else if(7===m){c=rtl.rc(t.Value,-922337203685477,922337203685477);var y=s.Kind;if(4===y)try{c=rtl.rc(c*s.Int,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){if(!b.isPrototypeOf(t))throw t;this.RaiseOverflowArithmetic(20180421164636,e)}else if(5===y)try{c=rtl.rc(c*s.UInt,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){this.RaiseOverflowArithmetic(20180421164654,e)}else if(6===y)try{u=c*s.FloatValue/1e4,i=o.$create("CreateValue",[u])}catch(t){this.RaiseOverflowArithmetic(20180421164718,e)}else if(7===y)try{c=rtl.rc(c*s.Value/1e4,-922337203685477,922337203685477),i=h.$create("CreateValue",[c])}catch(t){this.RaiseOverflowArithmetic(20180421164806,e)}else this.RaiseNotYetImplemented(20180421164817,e,"")}else if(12===m){if(12===s.Kind)if(f=s,0===(p=t).ElKind)i=d.$create("CreateEmptySameKind",[f]);else{i=d.$create("CreateEmptySameKind",[p]);for(var g=0,E=rtl.length(p.Ranges)-1;g<=E;g++)for(F=g,r=rtl.rc(rtl.rcArrR(p.Ranges,F).RangeStart,-9007199254740991,9007199254740991);r<=rtl.rcArrR(p.Ranges,F).RangeEnd;)f.IndexOfRange(r,!1)>=0&&i.Add(r,r),r+=1}else this.RaiseNotYetImplemented(20170714110420,e,"")}else this.RaiseNotYetImplemented(20170525225946,e,"");return i},this.EvalBinaryDivideExpr=function(e,t,i){var r=0,n=0,l=0,a=0;l=0;var u=t.Kind;if(4===u){r=rtl.rc(t.Int,-9007199254740991,9007199254740991);var c=i.Kind;if(4===c)l=0===i.Int?this.DivideByZero(Math.sign(r),Math.sign(i.Int)):r/i.Int;else if(5===c)l=0===i.UInt?this.DivideByZero(Math.sign(r),s.Sign(i.UInt)):r/i.UInt;else if(6===c)try{l=r/i.FloatValue}catch(e){l=this.DivideByZero(Math.sign(r),Math.sign(i.FloatValue))}else{if(7===c){try{a=rtl.rc(rtl.trunc(1e4*rtl.trunc(r/i.Value)),-922337203685477,922337203685477)}catch(t){this.RaiseMsg(20180421164915,3069,rtl.getResStr(s,"sDivByZero"),[],e)}return h.$create("CreateValue",[a])}this.RaiseNotYetImplemented(20170711144057,e,"")}}else if(5===u){n=rtl.rc(t.UInt,0,9007199254740991);var p=i.Kind;if(4===p)l=0===i.Int?this.DivideByZero(s.Sign(n),Math.sign(i.Int)):n/i.Int;else if(5===p)l=0===i.UInt?this.DivideByZero(s.Sign(n),s.Sign(i.UInt)):n/i.UInt;else if(6===p)try{l=n/i.FloatValue}catch(e){l=this.DivideByZero(s.Sign(n),Math.sign(i.FloatValue))}else{if(7===p){try{a=rtl.rc(rtl.trunc(1e4*rtl.trunc(n/i.Value)),-922337203685477,922337203685477)}catch(t){this.RaiseMsg(20180421164959,3069,rtl.getResStr(s,"sDivByZero"),[],e)}return h.$create("CreateValue",[a])}this.RaiseNotYetImplemented(20170711144239,e,"")}}else if(6===u){l=t.FloatValue;var f=i.Kind;if(4===f)0===i.Int?l=this.DivideByZero(Math.sign(l),Math.sign(i.Int)):l/=i.Int;else if(5===f)0===i.UInt?l=this.DivideByZero(Math.sign(l),s.Sign(i.UInt)):l/=i.UInt;else if(6===f)try{l/=i.FloatValue}catch(e){l=this.DivideByZero(Math.sign(l),Math.sign(i.FloatValue))}else if(7===f){try{a=rtl.rc(rtl.trunc(l/i.Value),-922337203685477,922337203685477)}catch(t){this.RaiseMsg(20180421165058,3069,rtl.getResStr(s,"sDivByZero"),[],e)}h.$create("CreateValue",[a])}else this.RaiseNotYetImplemented(20170711145050,e,"")}else{if(7===u){a=rtl.rc(t.Value,-922337203685477,922337203685477);var d=i.Kind;if(4===d)0===i.Int?this.RaiseMsg(20210515133307,3069,rtl.getResStr(s,"sDivByZero"),[],e):a=rtl.rc(rtl.trunc(a/i.Int),-922337203685477,922337203685477);else if(5===d)0===i.UInt?this.RaiseMsg(20210515133318,3069,rtl.getResStr(s,"sDivByZero"),[],e):a=rtl.rc(rtl.trunc(a/i.UInt),-922337203685477,922337203685477);else if(6===d)try{a=rtl.rc(rtl.trunc(a/i.FloatValue),-922337203685477,922337203685477)}catch(t){this.RaiseMsg(20180421165237,3069,rtl.getResStr(s,"sDivByZero"),[],e)}else if(7===d)try{a=rtl.rc(rtl.trunc(a/i.Value*1e4),-922337203685477,922337203685477)}catch(t){this.RaiseMsg(20180421165252,3069,rtl.getResStr(s,"sDivByZero"),[],e)}else this.RaiseNotYetImplemented(20180421165301,e,"");return h.$create("CreateValue",[a])}this.RaiseNotYetImplemented(20170530102352,e,"")}return o.$create("CreateValue",[l])},this.EvalBinaryDivExpr=function(e,t,s){var i=null,r=0,n=0;i=null;var a=t.Kind;if(4===a){var o=s.Kind;4===o?0===s.Int?this.RaiseDivByZero(20170530102619,e):(r=rtl.rc(rtl.trunc(t.Int/s.Int),-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])):5===o?0===s.UInt?this.RaiseDivByZero(20170530102745,e):(r=s.UInt>9007199254740991?0:rtl.rc(rtl.trunc(t.Int/s.UInt),-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])):this.RaiseNotYetImplemented(20170530102403,e,"")}else if(5===a){var h=s.Kind;4===h?0===s.Int?this.RaiseDivByZero(20170530103026,e):t.UInt<=9007199254740991?(r=rtl.rc(rtl.trunc(t.UInt/s.Int),-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])):s.Int>0?(n=rtl.rc(rtl.trunc(t.UInt/rtl.rc(s.Int,0,9007199254740991)),0,9007199254740991),i=this.CreateResEvalInt(n)):this.RaiseOverflowArithmetic(20170530104315,e):5===h?0===s.Int?this.RaiseDivByZero(20170530103026,e):(n=rtl.rc(rtl.trunc(t.UInt/s.UInt),0,9007199254740991),i=this.CreateResEvalInt(n)):this.RaiseNotYetImplemented(20170530102403,e,"")}else this.RaiseNotYetImplemented(20170530102352,e,"");return i},this.EvalBinaryModExpr=function(e,t,s){var i=null,r=0,n=0;i=null;var a=t.Kind;if(4===a){var o=s.Kind;4===o?0===s.Int?this.RaiseDivByZero(20170530104638,e):(r=rtl.rc(t.Int%s.Int,-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])):5===o?0===s.UInt?this.RaiseDivByZero(20170530104758,e):(n=t.Int<0?rtl.rc(rtl.rc(-t.Int,0,9007199254740991)%s.UInt,0,9007199254740991):rtl.rc(rtl.rc(t.Int,0,9007199254740991)%s.UInt,0,9007199254740991),i=this.CreateResEvalInt(n)):this.RaiseNotYetImplemented(20170530110057,e,"")}else if(5===a){var h=s.Kind;4===h?0===s.Int?this.RaiseDivByZero(20170530110110,e):t.UInt<=9007199254740991?(r=rtl.rc(t.UInt%s.Int,-9007199254740991,9007199254740991),i=l.$create("CreateValue",[r])):s.Int>0?(n=rtl.rc(t.UInt%rtl.rc(s.Int,0,9007199254740991),0,9007199254740991),i=this.CreateResEvalInt(n)):this.RaiseOverflowArithmetic(20170530110602,e):5===h?0===s.Int?this.RaiseDivByZero(20170530110609,e):(n=rtl.rc(t.UInt%s.UInt,0,9007199254740991),i=this.CreateResEvalInt(n)):this.RaiseNotYetImplemented(20170530110633,e,"")}else this.RaiseNotYetImplemented(20170530110644,e,"");return i},this.EvalBinaryPowerExpr=function(e,t,s){var i=null,r=0,n=0,a=0;i=null;var u=t.Kind;if(4===u){var c=s.Kind;if(4===c)try{r=P(Math.pow(t.Int,s.Int)),i=l.$create("CreateValue",[r])}catch(t){this.RaiseOverflowArithmetic(20170530210533,e)}else if(5===c)try{r=P(Math.pow(t.Int,s.UInt)),i=l.$create("CreateValue",[r])}catch(t){this.RaiseOverflowArithmetic(20170530211028,e)}else if(6===c)try{n=Math.pow(t.Int,s.FloatValue),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20170816154223,e)}else if(7===c)try{n=Math.pow(t.Int,s.Value/1e4),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20180421165906,e)}else this.RaiseNotYetImplemented(20170530205640,e,"")}else if(5===u){var p=s.Kind;if(4===p)try{r=P(Math.pow(t.UInt,s.Int)),i=l.$create("CreateValue",[r])}catch(t){this.RaiseOverflowArithmetic(20170530211102,e)}else if(5===p)try{r=P(Math.pow(t.UInt,s.UInt)),i=l.$create("CreateValue",[r])}catch(t){this.RaiseOverflowArithmetic(20170530211121,e)}else if(6===p)try{n=Math.pow(t.UInt,s.FloatValue),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20170816154241,e)}else if(7===p)try{n=Math.pow(t.UInt,s.Value/1e4),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20180421165948,e)}else this.RaiseNotYetImplemented(20170530211140,e,"")}else if(6===u){var f=s.Kind;if(4===f)try{n=Math.pow(t.FloatValue,s.Int),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20170816153950,e)}else if(5===f)try{n=Math.pow(t.FloatValue,s.UInt),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20170816154012,e)}else if(6===f)try{n=Math.pow(t.FloatValue,s.FloatValue),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20170816154012,e)}else if(7===f)try{n=Math.pow(t.FloatValue,s.Value/1e4),i=o.$create("CreateValue",[n])}catch(t){this.RaiseOverflowArithmetic(20180421170016,e)}}else if(7===u){var d=s.Kind;if(4===d)try{a=rtl.trunc(1e4*Math.pow(t.Value/1e4,s.Int)),i=h.$create("CreateValue",[a])}catch(t){this.RaiseOverflowArithmetic(20180421170235,e)}else if(5===d)try{a=rtl.trunc(1e4*Math.pow(t.Value/1e4,s.UInt)),i=h.$create("CreateValue",[a])}catch(t){this.RaiseOverflowArithmetic(20180421170240,e)}else if(6===d)try{a=rtl.trunc(1e4*Math.pow(t.Value/1e4,s.FloatValue)),i=h.$create("CreateValue",[a])}catch(t){this.RaiseOverflowArithmetic(20180421170254,e)}else if(7===d)try{a=rtl.trunc(1e4*Math.pow(t.Value/1e4,s.Value/1e4)),i=h.$create("CreateValue",[a])}catch(t){this.RaiseOverflowArithmetic(20180421170311,e)}}else this.RaiseNotYetImplemented(20170816153813,e,"");return i},this.EvalBinaryShiftExpr=function(e,t,s){var i,r=null,n=0,a=0;r=null,i=9===e.OpCode;var o=t.Kind;if(4===o){var h=s.Kind;4===h?((s.Int<0||s.Int>63)&&this.EmitRangeCheckConst$1(20170530203840,g(s.Int),0,63,e,2),n=i?rtl.rc(rtl.shl(t.Int,rtl.rc(s.Int,0,255)),-9007199254740991,9007199254740991):rtl.rc(rtl.shr(t.Int,rtl.rc(s.Int,0,255)),-9007199254740991,9007199254740991),r=l.$create("CreateValue",[n])):5===h?(s.UInt>63&&this.EmitRangeCheckConst$1(20170530203840,g(s.UInt),0,63,e,2),n=i?rtl.rc(rtl.shl(t.Int,rtl.rc(s.UInt,0,255)),-9007199254740991,9007199254740991):rtl.rc(rtl.shr(t.Int,rtl.rc(s.UInt,0,255)),-9007199254740991,9007199254740991),r=l.$create("CreateValue",[n])):this.RaiseNotYetImplemented(20170530205332,e,"")}else if(5===o){var u=s.Kind;4===u?((s.Int<0||s.Int>63)&&this.EmitRangeCheckConst$1(20170530205414,g(s.Int),0,63,e,2),a=i?rtl.rc(rtl.shl(t.UInt,rtl.rc(s.Int,0,255)),0,9007199254740991):rtl.rc(rtl.shr(t.UInt,rtl.rc(s.Int,0,255)),0,9007199254740991),r=this.CreateResEvalInt(a)):5===u?(s.UInt>63&&this.EmitRangeCheckConst$1(20170530205601,g(s.UInt),0,63,e,2),a=i?rtl.rc(rtl.shl(t.UInt,rtl.rc(s.UInt,0,255)),0,9007199254740991):rtl.rc(rtl.shr(t.UInt,rtl.rc(s.UInt,0,255)),0,9007199254740991),r=this.CreateResEvalInt(a)):this.RaiseNotYetImplemented(20170530205640,e,"")}else this.RaiseNotYetImplemented(20170530205646,e,"");return r},this.EvalBinaryBoolOpExpr=function(e,t,s){var i=null;i=null;var r=t.Kind;if(3===r)if(3===s.Kind){i=n.$create("Create$1");var o=e.OpCode;11===o?i.B=t.B&&s.B:12===o?i.B=t.B||s.B:13===o&&(i.B=t.B^s.B)}else this.RaiseNotYetImplemented(20170531011502,e,"");else if(4===r){if(4===s.Kind){i=l.$create("Create$1");var h=e.OpCode;11===h?i.Int=rtl.rc(rtl.and(t.Int,s.Int),-9007199254740991,9007199254740991):12===h?i.Int=rtl.rc(rtl.or(t.Int,s.Int),-9007199254740991,9007199254740991):13===h&&(i.Int=rtl.rc(rtl.xor(t.Int,s.Int),-9007199254740991,9007199254740991))}else this.RaiseNotYetImplemented(20170530211140,e,"")}else if(5===r){if(5===s.Kind){i=a.$create("Create$1");var u=e.OpCode;11===u?i.UInt=rtl.rc(rtl.and(t.UInt,s.UInt),0,9007199254740991):12===u?i.UInt=rtl.rc(rtl.or(t.UInt,s.UInt),0,9007199254740991):13===u&&(i.UInt=rtl.rc(rtl.xor(t.UInt,s.UInt),0,9007199254740991))}else this.RaiseNotYetImplemented(20170530211140,e,"")}else this.RaiseNotYetImplemented(20170530205938,e,"");return i},this.EvalBinaryNEqualExpr=function(e,t,s){var i=null,r=0,l=null,a=null,o=0;i=n.$create("Create$1");try{var h=t.Kind;if(3===h)3===s.Kind?i.B=t.B===s.B:(i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170531011937,e,""));else if(4===h){var u=s.Kind;4===u?i.B=t.Int===s.Int:5===u?i.B=t.Int===s.UInt:6===u?i.B=t.Int===s.FloatValue:7===u?i.B=1e4*t.Int===s.Value:(i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170531012412,e,""))}else if(5===h){r=t.UInt;var c=s.Kind;4===c?i.B=r<=9007199254740991&&r===s.Int:5===c?i.B=r===s.UInt:6===c?i.B=r===s.FloatValue:7===c?i.B=1e4*r===s.Value:(i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170601122803,e,""))}else if(6===h){var p=s.Kind;4===p?i.B=t.FloatValue===s.Int:5===p?i.B=t.FloatValue===s.UInt:6===p?i.B=t.FloatValue===s.FloatValue:7===p?i.B=1e4*t.FloatValue===s.Value:(i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170601122806,e,""))}else if(7===h){var f=s.Kind;4===f?i.B=t.Value===1e4*s.Int:5===f?i.B=t.Value===1e4*s.UInt:6===f?i.B=t.Value===1e4*s.FloatValue:7===f?i.B=t.Value===s.Value:(i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20180421165438,e,""))}else if(8===h){8===s.Kind?i.B=t.S===s.S:(i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170711175409,e,""))}else if(12===h){if(12===s.Kind)if(a=s,0===(l=t).ElKind)i.B=0===rtl.length(a.Ranges);else if(0===a.ElKind)i.B=0===rtl.length(l.Ranges);else if(rtl.length(l.Ranges)!==rtl.length(a.Ranges))i.B=!1;else{i.B=!0;for(var d=0,F=rtl.length(l.Ranges)-1;d<=F;d++)if(o=d,l.Ranges[o].RangeStart!==a.Ranges[o].RangeStart||l.Ranges[o].RangeEnd!==a.Ranges[o].RangeEnd){i.B=!1;break}}else this.RaiseNotYetImplemented(20170714120756,e,"")}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170531011931,e,"")}catch(t){if(b.isPrototypeOf(t))this.RaiseOverflowArithmetic(20170601132729,e);else{if(!O.isPrototypeOf(t))throw t;this.RaiseRangeCheck(20170601132740,e)}}return 15===e.OpCode&&(i.B=!i.B),i},this.EvalBinaryLessGreaterExpr=function(e,t,s){var i=null;var r=null,l=null,a=0,o=0;i=n.$create("Create$1");try{var h=t.Kind;if(4===h){var u=s.Kind;if(4===u){var c=e.OpCode;16===c?i.B=t.Int<s.Int:17===c?i.B=t.Int>s.Int:18===c?i.B=t.Int<=s.Int:19===c&&(i.B=t.Int>=s.Int)}else if(5===u){var p=e.OpCode;16===p?i.B=t.Int<s.UInt:17===p?i.B=t.Int>s.UInt:18===p?i.B=t.Int<=s.UInt:19===p&&(i.B=t.Int>=s.UInt)}else if(6===u){var f=e.OpCode;16===f?i.B=t.Int<s.FloatValue:17===f?i.B=t.Int>s.FloatValue:18===f?i.B=t.Int<=s.FloatValue:19===f&&(i.B=t.Int>=s.FloatValue)}else if(7===u){var d=e.OpCode;16===d?i.B=1e4*t.Int<s.Value:17===d?i.B=1e4*t.Int>s.Value:18===d?i.B=1e4*t.Int<=s.Value:19===d&&(i.B=1e4*t.Int>=s.Value)}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170601122512,e,"")}else if(5===h){var F=s.Kind;if(4===F){var m=e.OpCode;16===m?i.B=t.UInt<s.Int:17===m?i.B=t.UInt>s.Int:18===m?i.B=t.UInt<=s.Int:19===m&&(i.B=t.UInt>=s.Int)}else if(5===F){var C=e.OpCode;16===C?i.B=t.UInt<s.UInt:17===C?i.B=t.UInt>s.UInt:18===C?i.B=t.UInt<=s.UInt:19===C&&(i.B=t.UInt>=s.UInt)}else if(6===F){var S=e.OpCode;16===S?i.B=t.UInt<s.FloatValue:17===S?i.B=t.UInt>s.FloatValue:18===S?i.B=t.UInt<=s.FloatValue:19===S&&(i.B=t.UInt>=s.FloatValue)}else if(7===F){var T=e.OpCode;16===T?i.B=1e4*t.UInt<s.Value:17===T?i.B=1e4*t.UInt>s.Value:18===T?i.B=1e4*t.UInt<=s.Value:19===T&&(i.B=1e4*t.UInt>=s.Value)}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170601133222,e,"")}else if(6===h){var y=s.Kind;if(4===y){var g=e.OpCode;16===g?i.B=t.FloatValue<s.Int:17===g?i.B=t.FloatValue>s.Int:18===g?i.B=t.FloatValue<=s.Int:19===g&&(i.B=t.FloatValue>=s.Int)}else if(5===y){var E=e.OpCode;16===E?i.B=t.FloatValue<s.UInt:17===E?i.B=t.FloatValue>s.UInt:18===E?i.B=t.FloatValue<=s.UInt:19===E&&(i.B=t.FloatValue>=s.UInt)}else if(6===y){var P=e.OpCode;16===P?i.B=t.FloatValue<s.FloatValue:17===P?i.B=t.FloatValue>s.FloatValue:18===P?i.B=t.FloatValue<=s.FloatValue:19===P&&(i.B=t.FloatValue>=s.FloatValue)}else if(7===y){var I=e.OpCode;16===I?i.B=1e4*t.FloatValue<s.Value:17===I?i.B=1e4*t.FloatValue>s.Value:18===I?i.B=1e4*t.FloatValue<=s.Value:19===I&&(i.B=1e4*t.FloatValue>=s.Value)}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170601133421,e,"")}else if(7===h){var R=s.Kind;if(4===R){var v=e.OpCode;16===v?i.B=t.Value<1e4*s.Int:17===v?i.B=t.Value>1e4*s.Int:18===v?i.B=t.Value<=1e4*s.Int:19===v&&(i.B=t.Value>=1e4*s.Int)}else if(5===R){var A=e.OpCode;16===A?i.B=t.Value<1e4*s.UInt:17===A?i.B=t.Value>1e4*s.UInt:18===A?i.B=t.Value<=1e4*s.UInt:19===A&&(i.B=t.Value>=1e4*s.UInt)}else if(6===R){var N=e.OpCode;16===N?i.B=t.Value<1e4*s.FloatValue:17===N?i.B=t.Value>1e4*s.FloatValue:18===N?i.B=t.Value<=1e4*s.FloatValue:19===N&&(i.B=t.Value>=1e4*s.FloatValue)}else if(7===R){var x=e.OpCode;16===x?i.B=t.Value<s.Value:17===x?i.B=t.Value>s.Value:18===x?i.B=t.Value<=s.Value:19===x&&(i.B=t.Value>=s.Value)}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20180421165752,e,"")}else if(8===h){8===s.Kind?function(t,s){var r=e.OpCode;16===r?i.B=t<s:17===r?i.B=t>s:18===r?i.B=t<=s:19===r&&(i.B=t>=s)}(t.S,s.S):(i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170711210730,e,""))}else if(12===h){if(12===s.Kind){r=t,l=s;var k=e.OpCode;if(19===k){i.B=!0;for(var $=0,D=rtl.oc(rtl.length(l.Ranges)-1);$<=D;$++)for(a=$,o=rtl.rc(rtl.rcArrR(l.Ranges,a).RangeStart,-9007199254740991,9007199254740991);o<=rtl.rcArrR(l.Ranges,a).RangeEnd;){if(r.IndexOfRange(o,!1)<0){i.B=!1;break}o+=1}}else if(18===k){i.B=!0;for(var L=0,B=rtl.oc(rtl.length(r.Ranges)-1);L<=B;L++)for(a=L,o=rtl.rc(rtl.rcArrR(r.Ranges,a).RangeStart,-9007199254740991,9007199254740991);o<=rtl.rcArrR(r.Ranges,a).RangeEnd;){if(l.IndexOfRange(o,!1)<0){i.B=!1;break}o+=1}}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170714122121,e,"")}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170714121925,e,"")}else i=rtl.freeLoc(i),this.RaiseNotYetImplemented(20170601122529,e,"")}catch(t){if(b.isPrototypeOf(t))this.RaiseOverflowArithmetic(20170601132956,e);else{if(!O.isPrototypeOf(t))throw t;this.RaiseRangeCheck(20170601132958,e)}}return i},this.EvalBinaryInExpr=function(e,t,i){var r=null,l=null,a=0;if(r=null,12===i.Kind){l=i;var o=t.Kind;3===o?a=rtl.rc(t.B+0,-9007199254740991,9007199254740991):4===o?a=rtl.rc(t.Int,-9007199254740991,9007199254740991):5===o?t.UInt>9007199254740991?this.RaiseMsg(20170714123700,3064,rtl.getResStr(s,"sRangeCheckError"),[],e):a=rtl.rc(t.UInt,-9007199254740991,9007199254740991):8===o?a=rtl.rc(this.StringToOrd(t,e),-9007199254740991,9007199254740991):9===o?a=rtl.rc(t.Index,-9007199254740991,9007199254740991):this.RaiseNotYetImplemented(20170714123412,e,""),r=n.$create("CreateValue",[l.IndexOfRange(a,!1)>=0])}else this.RaiseNotYetImplemented(20170714123409,e,"");return r},this.EvalBinarySymmetricaldifferenceExpr=function(e,t,s){var i=null,r=null,n=null,l=0,a=0;if(12===t.Kind)if(12===s.Kind)if(n=s,0===(r=t).ElKind)i=n.Clone();else{i=d.$create("CreateEmptySameKind",[r]);for(var o=0,h=rtl.oc(rtl.length(r.Ranges)-1);o<=h;o++)for(l=o,a=rtl.rc(rtl.rcArrR(r.Ranges,l).RangeStart,-9007199254740991,9007199254740991);a<=rtl.rcArrR(r.Ranges,l).RangeEnd;)n.IndexOfRange(a,!1)<0&&i.Add(a,a),a+=1;for(var u=0,c=rtl.oc(rtl.length(n.Ranges)-1);u<=c;u++)for(l=u,a=rtl.rc(rtl.rcArrR(n.Ranges,l).RangeStart,-9007199254740991,9007199254740991);a<=rtl.rcArrR(n.Ranges,l).RangeEnd;)r.IndexOfRange(a,!1)<0&&i.Add(a,a),a+=1}else this.RaiseNotYetImplemented(20170714114144,e,"");else this.RaiseNotYetImplemented(20170714114119,e,"");return i},this.EvalParamsExpr=function(e,t){var s=null;if(null!==(s=this.FOnEvalParams(this,e,rtl.refSet(t))))return s;var i=e.Kind;return 11===i?s=this.EvalArrayParamsExpr(e,rtl.refSet(t)):4===i&&(s=this.EvalSetParamsExpr(e,rtl.refSet(t))),null===s?(rtl.neSet(rtl.intersectSet(rtl.createSet(0,1),t),{})&&this.RaiseConstantExprExp(20170713124038,e),s):s},this.EvalArrayParamsExpr=function(e,t){var i=null,r=null,n=null,l=0,a=null,o=0;if(i=null,null===(r=this.Eval(e.Value,rtl.refSet(t))))return rtl.neSet(rtl.intersectSet(rtl.createSet(0,1),t),{})&&this.RaiseConstantExprExp(20170711181321,e.Value),i;n=null;try{if(8===r.Kind){if(a=e.Params[0],null===(n=this.Eval(a,rtl.refSet(t))))return rtl.neSet(rtl.intersectSet(rtl.createSet(0,1),t),{})&&this.RaiseConstantExprExp(20170711181603,a),i;var h=n.Kind;return 4===h?l=rtl.rc(n.Int,-9007199254740991,9007199254740991):5===h?n.UInt>9007199254740991?this.RaiseRangeCheck(20170711182006,a):l=rtl.rc(n.UInt,-9007199254740991,9007199254740991):this.RaiseNotYetImplemented(20170711182100,e,""),o=rtl.rc(r.S.length,-2147483648,2147483647),(l<1||l>o)&&this.EmitRangeCheckConst(20170711183058,g(l),"1",g(o),a,1),i=u.$create("CreateValue",[rtl.rcCharAt(r.S,l-1)])}this.RaiseNotYetImplemented(20170711181507,e,""),rtl.neSet(rtl.intersectSet(rtl.createSet(0,1),t),{})&&this.RaiseConstantExprExp(20170522173150,e)}finally{s.ReleaseEvalValue({get:function(){return r},set:function(e){r=e}}),s.ReleaseEvalValue({get:function(){return n},set:function(e){n=e}})}return i},this.EvalSetParamsExpr=function(e,t){return this.EvalSetExpr(e,e.Params,rtl.refSet(t))},this.EvalSetExpr=function(e,t,i){var r=null,n=0,l=0,a=0,o=null,h=!1,u=!1,c=null;r=d.$create("Create$1"),o=null,u=!0,h=!1;try{for(var p=0,f=rtl.oc(rtl.length(t)-1);p<=f;p++)if(n=p,c=rtl.rcArrR(t,n),null!==(o=this.Eval(c,rtl.refSet(i)))){var F=o.Kind;if(3===F)0===r.ElKind?r.ElKind=4:4!==r.ElKind&&this.RaiseNotYetImplemented(20170714132843,c,""),l=rtl.rc(o.B+0,-9007199254740991,9007199254740991),a=rtl.rc(l,-9007199254740991,9007199254740991);else if(4===F)0===r.ElKind?r.ElKind=2:2!==r.ElKind&&this.RaiseNotYetImplemented(20170713201208,c,""),l=rtl.rc(o.Int,-9007199254740991,9007199254740991),a=rtl.rc(l,-9007199254740991,9007199254740991);else if(5===F)0===r.ElKind?r.ElKind=2:2!==r.ElKind?this.RaiseNotYetImplemented(20170713201230,c,""):o.UInt>9007199254740991&&this.EmitRangeCheckConst(20170713201306,o.AsString(),"0",g(9007199254740991),c,1),l=rtl.rc(o.UInt,-9007199254740991,9007199254740991),a=rtl.rc(l,-9007199254740991,9007199254740991);else if(8===F){if(0===r.ElKind?r.ElKind=3:3!==r.ElKind&&this.RaiseNotYetImplemented(20170713201516,c,""),1!==o.S.length)return s.ReleaseEvalValue({get:function(){return r},set:function(e){r=e}}),r;l=rtl.rc(o.S.charCodeAt(0),-9007199254740991,9007199254740991),a=rtl.rc(l,-9007199254740991,9007199254740991)}else 9===F?(0===r.ElKind?(r.ElKind=1,r.ElType=rtl.as(o.IdentEl.FParent,I)):1!==r.ElKind?this.RaiseNotYetImplemented(20170713143559,c,""):r.ElType!==o.ElType&&this.RaiseNotYetImplemented(20170713201021,c,""),l=rtl.rc(o.Index,-9007199254740991,9007199254740991),a=rtl.rc(l,-9007199254740991,9007199254740991)):10===F?(0===r.ElKind?(r.ElKind=rtl.rc(o.ElKind,0,4),1===r.ElKind&&(r.ElType=o.ElType)):r.ElKind!==o.ElKind&&this.RaiseNotYetImplemented(20170714101910,c,""),l=rtl.rc(o.RangeStart,-9007199254740991,9007199254740991),a=rtl.rc(o.RangeEnd,-9007199254740991,9007199254740991)):11===F?(0===r.ElKind?r.ElKind=2:2!==r.ElKind?this.RaiseNotYetImplemented(20170713202934,c,""):o.RangeEnd>9007199254740991&&this.EmitRangeCheckConst(20170713203034,o.AsString(),"0",g(9007199254740991),c,1),l=rtl.rc(o.RangeStart,-9007199254740991,9007199254740991),a=rtl.rc(o.RangeEnd,-9007199254740991,9007199254740991)):this.RaiseNotYetImplemented(20170713143422,c,"");r.Intersects(l,a)>=0&&this.RaiseMsg(20170714141326,3070,rtl.getResStr(s,"sRangeCheckInSetConstructor"),[],c),r.Add(l,a),s.ReleaseEvalValue({get:function(){return o},set:function(e){o=e}})}else u=!1;h=u}finally{s.ReleaseEvalValue({get:function(){return o},set:function(e){o=e}}),h||s.ReleaseEvalValue({get:function(){return r},set:function(e){r=e}})}return r},this.EvalArrayValuesExpr=function(e,t){return this.EvalSetExpr(e,e.Values,rtl.refSet(t))},this.EvalPrimitiveExprString=function(e){var t=this,s=null,i=null;function r(s){i=rtl.freeLoc(i),t.RaiseRangeCheck(s,e)}function n(e){""!==e&&(i.S=i.S+e)}function l(e){i.S=i.S+String.fromCharCode(e)}function a(e,s,i){var n=0,a=0,o=0,h="\0";if(n=s,(n+=1)>i&&t.RaiseInternalError(20181016121354,""),"$"===e.charAt(n-1))for(a=n+=1,o=0;n<=i;){var u=h=e.charAt(n-1);if(u>="0"&&u<="9")o=16*o+(h.charCodeAt()-48>>>0);else if(u>="a"&&u<="f")o=16*o+(h.charCodeAt()-97>>>0)+10;else{if(!(u>="A"&&u<="F"))break;o=16*o+(h.charCodeAt()-65>>>0)+10}o>1114111&&r(20170523115712),n+=1}else for(a=n,o=0;n<=i;){h=e.charAt(n-1);if(!(h>="0"&&h<="9"))break;(o=10*o+(h.charCodeAt()-48>>>0))>65535&&r(20170523123137),n+=1}return n===a&&t.RaiseInternalError(20170523123806,""),o>65535?(o-=65536,l(55296+rtl.lw(o>>>10)),l(56320+(1023&o))):l(o),n}var o,h=0,c=0,p="\0",f="";s=null,0===(o=(f=e.Value).length)&&this.RaiseInternalError(20170523113809,""),i=u.$create("Create$1");try{for(h=1;h<=o;){var d=f.charAt(h-1);if("'"===d){for(c=h+=1;;){if(h>o&&this.RaiseInternalError(20170523113938,""),"'"===(p=f.charAt(h-1))){if(h>c&&n(k(f,c,h-c)),c=h+=1,h>o||"'"!==f.charAt(h-1))break;n("'"),c=h+=1}else h+=1}h>c&&n(k(f,c,h-c))}else if("#"===d)h=a(f,h,o);else if("^"===d){(h+=1)>o&&this.RaiseInternalError(20181016121520,"");var F=p=f.charAt(h-1);F>="a"&&F<="z"?l(p.charCodeAt()-97+1):F>="A"&&F<="Z"?l(p.charCodeAt()-65+1):this.RaiseInternalError(20170523123809,""),h+=1}else this.RaiseNotYetImplemented(20170523123815,e,"ord="+g(f.charCodeAt(h-1)))}s=i,i=null}finally{i=rtl.freeLoc(i)}return s},this.EvalPrimitiveExprStringMultiLine=function(e){return u.$create("CreateValue",[e.Value])},this.PredBool=function(e,t){!1===e.B&&this.EmitRangeCheckConst(20170624140251,e.AsString(),"true","true",t,2),e.B=!e.B},this.SuccBool=function(e,t){!0===e.B&&this.EmitRangeCheckConst(20170624142316,e.AsString(),"false","false",t,2),e.B=!e.B},this.PredInt=function(e,t){-9007199254740991===e.Int?(this.EmitRangeCheckConst(20170624142511,g(e.Int),g(-9007199254740990),g(9007199254740991),t,2),e.Int=9007199254740991):e.Int-=1},this.SuccInt=function(e,t){9007199254740991===e.Int?(this.EmitRangeCheckConst(20170624142920,g(e.Int),g(-9007199254740991),g(9007199254740990),t,2),e.Int=-9007199254740991):e.Int+=1},this.PredUInt=function(e,t){0===e.UInt?(this.EmitRangeCheckConst(20170624143122,g(e.UInt),g(1),g(9007199254740991),t,2),e.UInt=9007199254740991):e.UInt-=1},this.SuccUInt=function(e,t){9007199254740991===e.UInt?(this.EmitRangeCheckConst(20170624142921,g(e.UInt),g(0),g(9007199254740990),t,2),e.UInt=0):e.UInt+=1},this.PredUnicodeString=function(e,t){1!==e.S.length&&this.RaiseRangeCheck(20170624150703,t),"\0"===e.S.charAt(0)?(this.EmitRangeCheckConst(20170624150710,e.AsString(),"#1","#65535",t,2),e.S=""):e.S=String.fromCharCode(e.S.charAt(0).charCodeAt()-1)},this.SuccUnicodeString=function(e,t){1!==e.S.length&&this.RaiseRangeCheck(20170624150849,t),""===e.S.charAt(0)?(this.EmitRangeCheckConst(20170624150910,e.AsString(),"#0","#65534",t,2),e.S="\0"):e.S=String.fromCharCode(e.S.charAt(0).charCodeAt()+1)},this.PredEnum=function(e,t){var i=null;null===(i=rtl.as(e.ElType,I))&&this.RaiseInternalError(20170821174038,s.dbgs$1(e)),e.Index<=0?(this.EmitRangeCheckConst(20170624144332,e.AsString(),rtl.getObject(i.Values.Get(Math.min(1,i.Values.FCount-1))).FName,rtl.getObject(i.Values.Get(i.Values.FCount-1)).FName,t,2),e.Index=i.Values.FCount-1):e.Index-=1,e.IdentEl=rtl.getObject(i.Values.Get(e.Index))},this.SuccEnum=function(e,t){var i=null;null===(i=rtl.as(e.ElType,I))&&this.RaiseInternalError(20170821174058,s.dbgs$1(e)),e.Index>=i.Values.FCount-1?(this.EmitRangeCheckConst(20170624145013,e.AsString(),rtl.getObject(i.Values.Get(0)).FName,rtl.getObject(i.Values.Get(Math.max(0,i.Values.FCount-2))).FName,t,2),e.Index=0):e.Index+=1,e.IdentEl=rtl.getObject(i.Values.Get(e.Index))},this.DivideByZero=function(e,t){return 0===e?0:e<0!=t<0?-1/0:1/0},this.CreateResEvalInt=function(e){return e<=9007199254740991?l.$create("CreateValue",[e]):a.$create("CreateValue",[e])},this.Create$1=function(){return T.Create.call(this),this.FAllowedInts=rtl.refSet(s.reitDefaults),this},this.Eval=function(e,t){var s,i=null,h=0,u=0,c=0,p=0;if(i=null,r.isPrototypeOf(e.FData))return i=e.FData;if(2 in t&&(t=rtl.excludeSet(t,2),this.IsConst(e)&&(t=rtl.includeSet(t,0))),3 in t&&(t=rtl.excludeSet(t,3),this.IsConst(e)&&(t=rtl.includeSet(t,1))),(s=e.$class.ClassType())===$){var f=e.Kind;if(0===f)i=this.FOnEvalIdentifier(this,e,rtl.refSet(t));else if(1===f){if(D(e.Value,{get:function(){return u},set:function(e){u=e}},{get:function(){return h},set:function(e){h=e}}),0===h&&!(u<0&&L("-",e.Value)<1))return i=l.$create("CreateValue",[u]);if(B(e.Value,{get:function(){return c},set:function(e){c=e}},{get:function(){return h},set:function(e){h=e}}),0===h)return i=a.$create("CreateValue",[c]);if(M(e.Value,{get:function(){return p},set:function(e){p=e}},{get:function(){return h},set:function(e){h=e}}),0===h)return i=o.$create("CreateValue",[p]);this.RaiseRangeCheck(20170518202252,e)}else{if(2===f)return i=this.EvalPrimitiveExprString(e);if(3===f)return i=this.EvalPrimitiveExprStringMultiLine(e);this.RaiseNotYetImplemented(20170518200951,e,"")}}else s===G?i=r.$create("CreateKind",[2]):s===w?i=n.$create("CreateValue",[e.Value]):s===V?i=this.EvalUnaryExpr(e,rtl.refSet(t)):s===x?i=this.EvalBinaryExpr(e,rtl.refSet(t)):s===U?i=this.EvalParamsExpr(e,rtl.refSet(t)):s===J?i=this.EvalArrayValuesExpr(e,rtl.refSet(t)):rtl.neSet(rtl.intersectSet(rtl.createSet(0,1),t),{})&&this.RaiseConstantExprExp(20170518213800,e);return i},this.IsInRange=function(e,t,i){var r=!1,n=null,l=null;if(null===(n=this.Eval(e,rtl.createSet(2))))return!0;l=null;try{null===(l=this.Eval(t,{}))&&this.RaiseNotYetImplemented(20170522171226,t,""),r=this.IsInRange$1(n,e,l,t,i)}finally{s.ReleaseEvalValue({get:function(){return n},set:function(e){n=e}}),s.ReleaseEvalValue({get:function(){return l},set:function(e){l=e}})}return r},this.IsInRange$1=function(e,t,i,r,n){var l=null,a=null,o=0;var h=i.Kind;if(10===h){var u=(l=i).ElKind;if(4===u){if(3===e.Kind)return!0;this.RaiseNotYetImplemented(20170522220104,t,"")}else if(1===u)if(9!==e.Kind)this.RaiseInternalError(20170522172754,"");else{if(e.ElType===l.ElType)return!(e.Index<l.RangeStart||e.Index>l.RangeEnd)||(n&&this.EmitRangeCheckConst(20170522174406,e.AsString(),l.ElementAsString(l.RangeStart),l.ElementAsString(l.RangeEnd),t,2),!1);this.RaiseInternalError(20170522174028,"")}else if(2===u){if(4===e.Kind)return!(e.Int<l.RangeStart||e.Int>l.RangeEnd)||(n&&this.EmitRangeCheckConst(20170522174958,e.AsString(),l.ElementAsString(l.RangeStart),l.ElementAsString(l.RangeEnd),t,2),!1);if(5===e.Kind)return!(e.UInt>9007199254740991||e.UInt<l.RangeStart||e.UInt>l.RangeEnd)||(n&&this.EmitRangeCheckConst(20170522215852,e.AsString(),l.ElementAsString(l.RangeStart),l.ElementAsString(l.RangeEnd),t,2),!1);this.RaiseNotYetImplemented(20170522215906,t,"")}else if(3===u){if(e.Kind in s.revkAllStrings)return!((o=this.StringToOrd(e,t))<l.RangeStart||o>l.RangeEnd)||(n&&this.EmitRangeCheckConst(20170522221709,e.AsString(),l.ElementAsString(l.RangeStart),l.ElementAsString(l.RangeEnd),t,2),!1);this.RaiseNotYetImplemented(20170522220210,t,"")}else this.RaiseInternalError(20170522172630,"")}else if(11===h){if(4===e.Kind)return a=i,!(e.Int<0||e.Int<a.RangeStart||e.Int>a.RangeEnd)||(n&&this.EmitRangeCheckConst(20170522172250,e.AsString(),g(a.RangeStart),g(a.RangeEnd),t,2),!1);if(5===e.Kind)return a=i,!(e.UInt<a.RangeStart||e.UInt>a.RangeEnd)||(n&&this.EmitRangeCheckConst(20170522172544,g(e.UInt),g(a.RangeStart),g(a.RangeEnd),t,2),!1);this.RaiseNotYetImplemented(20170522171551,t,"")}else this.RaiseNotYetImplemented(20170522171307,r,"");return false},this.IsSetCompatible=function(e,t,s,i){var r=null,n=null,l=0,a=0;if(12===e.Kind){if(0===(r=e).ElKind)return!0;if(10===s.Kind){if((n=s).ElKind===r.ElKind&&n.ElType===r.ElType||this.RaiseNotYetImplemented(20170714201425,t,""),0===rtl.length(r.Ranges))return!0;if(l=r.Ranges[0].RangeStart,a=r.Ranges[rtl.length(r.Ranges)-1].RangeEnd,l<n.RangeStart){if(!i)return!1;this.EmitRangeCheckConst(20170714202813,r.ElementAsString(l),n.ElementAsString(n.RangeStart),n.ElementAsString(n.RangeEnd),t,1)}if(a>n.RangeEnd){if(!i)return!1;this.EmitRangeCheckConst(20170714203134,r.ElementAsString(a),n.ElementAsString(n.RangeStart),n.ElementAsString(n.RangeEnd),t,1)}}else this.RaiseNotYetImplemented(20170714201121,t,"")}else this.RaiseNotYetImplemented(20170714195815,t,"");return true},this.IsConst=function(e){var t=null,s=null;for(t=e;null!==t;){if((s=t.$class.ClassType()).InheritsFrom(j))return!0;if(s.InheritsFrom(H))return!1;t=t.FParent}return true},this.IsSimpleExpr=function(e){var t;return(t=e.$class.ClassType())===G||t===w||t===$},this.EmitRangeCheckConst=function(e,t,i,r,n,l){null!=this.FOnRangeCheckEl&&this.FOnRangeCheckEl(this,n,{get:function(){return l},set:function(e){l=e}}),this.LogMsg(e,l,3066,rtl.getResStr(s,"sRangeCheckEvaluatingConstantsVMinMax"),N(18,t,18,i,18,r),n)},this.EmitRangeCheckConst$1=function(e,t,s,i,r,n){this.EmitRangeCheckConst(e,t,g(s),g(i),r,n)},this.ChrValue=function(e,t){var s=null,i=0;s=null;var r=e.Kind;return 4===r||5===r?(5===e.Kind?e.UInt>65535?this.EmitRangeCheckConst$1(20170711195605,e.AsString(),0,65535,t,1):i=e.UInt:i=e.Int,(i<0||i>65535)&&this.EmitRangeCheckConst$1(20170711195747,e.AsString(),0,65535,t,1),s=u.$create("CreateValue",[String.fromCharCode(i)])):this.RaiseNotYetImplemented(20170711195440,t,""),s},this.OrdValue=function(e,t){var s=null,i=0;s=null,i=0;var r=e.Kind;if(3===r)i=e.B?1:0;else{if(4===r||5===r)return e;8===r?i=this.StringToOrd(e,t):9===r?i=e.Index:this.RaiseNotYetImplemented(20170624155932,t,"")}return i>65535?s:s=l.$create("CreateValue",[i])};this.StringToOrd=function(e,t){var i=0,r="";if(8===e.Kind)if(1!==(r=e.S).length){if(null===t)return 305419896;this.RaiseMsg(20170522221358,3010,rtl.getResStr(s,"sXExpectedButYFound"),N(18,"AnsiChar",18,"string"),t)}else i=r.charCodeAt(0);else this.RaiseNotYetImplemented(20170522220959,t,"");return i},this.PredValue=function(e,t){var i=e.Kind;3===i?this.PredBool(e,t):4===i?this.PredInt(e,t):5===i?this.PredUInt(e,t):8===i?this.PredUnicodeString(e,t):9===i?this.PredEnum(e,t):(s.ReleaseEvalValue({get:function(){return e},set:function(t){e=t}}),this.RaiseNotYetImplemented(20170624135738,t,""))},this.SuccValue=function(e,t){var i=e.Kind;3===i?this.SuccBool(e,t):4===i?this.SuccInt(e,t):5===i?this.SuccUInt(e,t):8===i?this.SuccUnicodeString(e,t):9===i?this.SuccEnum(e,t):(s.ReleaseEvalValue({get:function(){return e},set:function(t){e=t}}),this.RaiseNotYetImplemented(20170624151252,t,""))},this.EvalStrFunc=function(e,t){var i=this,r=null,n=!1;function l(e,s,r){var l,a;return null===(a=i.Eval(e,rtl.refSet(t)))?(n=!1,-1):(4!==a.Kind&&i.RaiseNotYetImplemented(20170717144010,e,""),((l=a.Int)<s||l>r)&&i.EmitRangeCheckConst$1(20170717144609,g(l),s,r,e,1),l)}var a=0,o=null,h="",c="",p=null,f=0,d=0;r=null,p=null,n=!0,h="";for(var F=0,m=rtl.length(e.Params)-1;F<=m;F++)if(a=F,o=e.Params[a],null!==(p=this.Eval(o,rtl.refSet(t)))){f=-1,d=-1;try{if(c="",null!==o.Format1){if((f=l(o.Format1,1,255))<0)continue;if(null!==o.Format2&&(d=l(o.Format2,0,255))<0)continue}var C=p.Kind;if(3===C)c=f<0?""+p.B:rtl.spaceLeft(""+p.B,f);else if(4===C)c=f<0?""+p.Int:rtl.spaceLeft(""+p.Int,f);else if(5===C)c=f<0?""+p.UInt:rtl.spaceLeft(""+p.UInt,f);else if(6===C)c=f<0?rtl.floatToStr(p.FloatValue):d<0?rtl.floatToStr(p.FloatValue,f):rtl.floatToStr(p.FloatValue,f,d);else if(7===C)c=f<0?rtl.floatToStr(p.Value/1e4):d<0?rtl.floatToStr(p.Value/1e4,f):rtl.floatToStr(p.Value/1e4,f,d);else{if(9!==C){n=!1;continue}c=p.AsString(),f>0&&(c=W(" ",f)+c)}}finally{s.ReleaseEvalValue({get:function(){return p},set:function(e){p=e}}),s.ReleaseEvalValue({get:function(){return p},set:function(e){p=e}}),s.ReleaseEvalValue({get:function(){return p},set:function(e){p=e}})}h+=c}else n=!1;return n&&(r=u.$create("CreateValue",[h])),r},this.EvalStringAddExpr=function(e,t,s,i,r){var n=null;8===i.Kind?8===r.Kind?(n=u.$create("Create$1")).S=i.S+r.S:this.RaiseNotYetImplemented(20170601141811,e,""):this.RaiseNotYetImplemented(20181219233139,e,"");return n},this.ShiftAndMaskValue=function(e,t,s,i){var r=0,n=e.Kind;return 4===n?r=32===t?rtl.trunc(e.Int/4294967296)>>>0:rtl.shr(e.Int,t)&s:5===n?r=32===t?rtl.trunc(e.UInt/4294967296)>>>0:rtl.shr(e.UInt,t)&s:this.RaiseNotYetImplemented(20190129012100,i,""),l.$create("CreateValue",[r])},this.EnumTypeCast=function(e,t,i){var r=null,n=null,l=0,a=0;if(r=null,null===(n=this.Eval(t,rtl.refSet(i))))return r;try{l=e.Values.FCount-1;var o=n.Kind;4===o?n.Int>2147483647?this.EmitRangeCheckConst(20170713105944,g(n.Int),"0",g(l),t,1):a=n.Int:5===o?n.UInt>l?this.EmitRangeCheckConst(20170713105944,g(n.UInt),"0",g(l),t,1):a=n.UInt:this.RaiseNotYetImplemented(20170713105625,t,""),(a<0||a>l)&&this.EmitRangeCheckConst(20170713110232,g(a),"0",g(l),t,1),r=c.$create("CreateValue",[a,rtl.getObject(e.Values.Get(a))])}finally{s.ReleaseEvalValue({get:function(){return n},set:function(e){n=e}})}return r}}),this.ReleaseEvalValue=function(e){null!==e.get()&&null===e.get().FElement&&(e.get().$destroy("Destroy"),e.set(null))},this.NumberIsFloat=function(e){var t=0;if(""===e)return!1;if(e.charCodeAt(0)in rtl.createSet(36,37,38))return!1;for(var s=2,i=e.length;s<=i;s++)if(t=s,e.charCodeAt(t-1)in rtl.createSet(46,69,101))return!0;return false},this.Sign=function(e){return e>0?1:0},this.UnicodeStrToCaption=function(e,t){var s="",i=!1,r=0;function n(e){var n;""!==s&&i&&(s+="'",r+=1,i=!1),n="#"+g(e),(r+=n.length)<=t&&(s+=n)}function l(e,t){i||(s+="'",r+=1,i=!0),s+=e,r+=t}var a=0;for(s="",a=1,r=0,i=!1;r<t&&a<=e.length;){var o=e.charAt(a-1);"'"===o?(l("''",2),a+=1):o>="\0"&&o<=""||o>=""&&o<=""||o>="\ud800"&&o<=""?(n(e.charCodeAt(a-1)),a+=1):(l(e.charAt(a-1),1),a+=1)}return i&&(s+="'"),s},this.GetObjName=function(e){var t="",i=null;return null===e?t="nil":Y.isPrototypeOf(e)&&""===e.FName?t=null===e.ElType?"array of const":z("TArray<%s>",N(18,e.ElType.FName)):_.isPrototypeOf(e)?(t=e.FName,K.isPrototypeOf(e)&&null!==(i=e).GenericTemplateTypes&&i.GenericTemplateTypes.FCount>0&&(t+=s.GetGenericParamCommas(i.GenericTemplateTypes.FCount)),t=t+":"+e.$classname):t=e.$classname,t},this.GetObjPath=function(e){var t="",i=null,r=null;if(_.isPrototypeOf(e))for(t=":"+(i=e).$classname;null!==i;)i!==e&&(t="."+t),K.isPrototypeOf(i)&&null!==(r=i).GenericTemplateTypes&&r.GenericTemplateTypes.FCount>0&&L("<",i.FName)<1&&(t=s.GetGenericParamCommas(r.GenericTemplateTypes.FCount)+t),t=""!==i.FName?X(i.FName,!1,!1)?i.FName+t:'"'+i.FName+'"'+t:"["+i.$classname+"]"+t,i=i.FParent;else t=s.GetObjName(e);return t},this.GetGenericParamCommas=function(e){return e<=0?"":"<"+W(",",e-1)+">"},this.GetElementNameAndParams=function(e,t){var i="";return null===e?"(nil)":(i=e.FName,K.isPrototypeOf(e)&&(i+=s.GetTypeParamNames(e.GenericTemplateTypes,t-1)),i)},this.GetTypeParamNames=function(e,t){var i="",r=0,n=null;if(null===e||0===e.FCount)return"";if(t<=0)return"...";i="<";for(var l=0,a=e.FCount-1;l<=a;l++)(r=l)>0&&(i+=","),""!==(n=rtl.getObject(e.Get(r))).FName?i+=s.GetElementNameAndParams(n,t-1):Y.isPrototypeOf(n)?i+="array...":i+="...";return i+=">"},this.dbgs$1=function(e){return null===e?"nil":e.AsDebugString()},s.$resourcestrings={sIdentifierNotFound:{org:'identifier not found "%s"'},sNotYetImplemented:{org:"not yet implemented: %s"},sIllegalQualifier:{org:'illegal qualifier "%s"'},sSyntaxErrorExpectedButFound:{org:'Syntax error, "%s" expected but "%s" found'},sWrongNumberOfParametersForCallTo:{org:'Wrong number of parameters specified for call to "%s"'},sIncompatibleTypeArgNo:{org:'Incompatible type for arg no. %s: Got "%s", expected "%s"'},sIncompatibleTypeArgNoVarParamMustMatchExactly:{org:'Incompatible type for arg no. %s: Got "%s", expected "%s". Var param must match exactly.'},sVariableIdentifierExpected:{org:"Variable identifier expected"},sDuplicateIdentifier:{org:'Duplicate identifier "%s" at %s'},sXExpectedButYFound:{org:"%s expected, but %s found"},sAncestorCycleDetected:{org:"Ancestor cycle detected"},sCantUseForwardDeclarationAsAncestor:{org:'Can\'t use forward declaration "%s" as ancestor'},sCantDetermineWhichOverloadedFunctionToCall:{org:"Can't determine which overloaded function to call"},sForwardTypeNotResolved:{org:'Forward type not resolved "%s"'},sForwardProcNotResolved:{org:'Forward %s not resolved "%s"'},sInvalidXModifierY:{org:"Invalid %s modifier %s"},sAbstractMethodsMustNotHaveImplementation:{org:"Abstract method must not have an implementation."},sCallingConventionMismatch:{org:"Calling convention mismatch"},sResultTypeMismatchExpectedButFound:{org:"Result type mismatch, expected %s, but found %s"},sFunctionHeaderMismatchForwardVarName:{org:'function header "%s" doesn\'t match forward : var name changes %s => %s'},sFunctionHidesIdentifier:{org:'function hides identifier at "%s". Use overload or reintroduce'},sNoMethodInAncestorToOverride:{org:'There is no method in an ancestor class to be overridden "%s"'},sInheritedOnlyWorksInMethods:{org:"Inherited works only in methods"},sInheritedNeedsAncestor:{org:"inherited needs an ancestor"},sNoPropertyFoundToOverride:{org:"No property found to override"},sExprTypeMustBeClassOrRecordTypeGot:{org:"Expression type must be class or record type, got %s"},sPropertyNotWritable:{org:"No member is provided to access property"},sIncompatibleTypesGotExpected:{org:'Incompatible types: got "%s" expected "%s"'},sTypesAreNotRelatedXY:{org:'Types are not related: "%s" and "%s"'},sAbstractMethodsCannotBeCalledDirectly:{org:"Abstract methods cannot be called directly"},sMissingParameterX:{org:"Missing parameter %s"},sInstanceMemberXInaccessible:{org:'Instance member "%s" inaccessible here'},sInOperatorExpectsSetElementButGot:{org:"the in-operator expects a set element, but got %s"},sWrongNumberOfParametersForTypeCast:{org:"wrong number of parameters for type cast to %s"},sIllegalTypeConversionTo:{org:'Illegal type conversion: "%s" to "%s"'},sConstantExpressionExpected:{org:"Constant expression expected"},sLeftSideOfIsOperatorExpectsAClassButGot:{org:'left side of is-operator expects a class, but got "%s"'},sNotReadable:{org:"not readable"},sClassPropertyAccessorMustBeStatic:{org:"class property accessor must be static"},sClassPropertyAccessorMustNotBeStatic:{org:"class property accessor must not be static"},sOnlyOneDefaultPropertyIsAllowed:{org:"Only one default property is allowed"},sWrongNumberOfParametersForArray:{org:"Wrong number of parameters for array"},sCantAssignValuesToAnAddress:{org:"Can't assign values to an address"},sIllegalExpression:{org:"Illegal expression"},sCantAccessXMember:{org:"Can't access %s member %s"},sMustBeInsideALoop:{org:"%s must be inside a loop"},sExpectXArrayElementsButFoundY:{org:"Expect %s array elements, but found %s"},sCannotCreateADescendantOfTheSealedXY:{org:'Cannot create a descendant of the sealed %s "%s"'},sAncestorIsNotExternal:{org:'Ancestor "%s" is not external'},sPropertyMustHaveReadOrWrite:{org:"Property must have read or write accessor"},sVirtualMethodXHasLowerVisibility:{org:'Virtual method "%s" has a lower visibility (%s) than parent class %s (%s)'},sExternalClassInstanceCannotAccessStaticX:{org:"External class instance cannot access static %s"},sXModifierMismatchY:{org:'%s modifier "%s" mismatch'},sSymbolCannotBePublished:{org:"Symbol cannot be published"},sCannotTypecastAType:{org:"Cannot type cast a type"},sTypeIdentifierExpected:{org:"Type identifier expected"},sCannotNestAnonymousX:{org:"Cannot nest anonymous %s"},sFoundCallCandidateX:{org:"Found call candidate %s"},sTextAfterFinalIgnored:{org:"Text after final 'end.'. ignored by compiler"},sNoMemberIsProvidedToAccessProperty:{org:"No member is provided to access property"},sTheUseOfXisNotAllowedInARecord:{org:'The use of "%s" is not allowed in a record'},sParameterlessConstructorsNotAllowedInRecords:{org:"Parameterless constructors are not allowed in records or record/type helpers"},sMultipleXinTypeYNameZCAandB:{org:"Multiple %s in %s %s: %s and %s"},sXCannotHaveParameters:{org:"%s cannot have parameters"},sSymbolXIsNotPortable:{org:'Symbol "%s" is not portable'},sSymbolXIsExperimental:{org:'Symbol "%s" is experimental'},sSymbolXIsNotImplemented:{org:'Symbol "%s" is not implemented'},sSymbolXBelongsToALibrary:{org:'Symbol "%s" belongs to a library'},sSymbolXIsDeprecated:{org:'Symbol "%s" is deprecated'},sSymbolXIsDeprecatedY:{org:'Symbol "%s" is deprecated: %s'},sRangeCheckError:{org:"Range check error"},sHighRangeLimitLTLowRangeLimit:{org:"High range limit < low range limit"},sRangeCheckEvaluatingConstantsVMinMax:{org:"range check error while evaluating constants (%s is not between %s and %s)"},sOverflowInArithmeticOperation:{org:"Overflow in arithmetic operation"},sDivByZero:{org:"Division by zero"},sRangeCheckInSetConstructor:{org:"range check error in set constructor or duplicate set element"},sIncompatibleTypesGotParametersExpected:{org:"Incompatible types, got %s parameters, expected %s"},sAddingIndexSpecifierRequiresNewX:{org:'adding index specifier requires new "%s" specifier'},sCantFindUnitX:{org:'can\'t find unit "%s"'},sCannotFindEnumeratorForType:{org:'Cannot find an enumerator for the type "%s"'},sPreviousDeclMissesOverload:{org:'Previous declaration of "%s" at %s was not marked with "overload" directive'},sOverloadedProcMissesOverload:{org:'Overloaded procedure misses "overload" directive. Previous declaration is at %s'},sMethodHidesMethodOfBaseType:{org:'Method "%s" hides method of base type "%s" at %s'},sContextExpectedXButFoundY:{org:'%s: expected "%s", but found "%s"'},sContextXInvalidY:{org:"%s: invalid %s"},sIdentifierXIsNotAnInstanceField:{org:'Identifier "%s" is not an instance field'},sConstructingClassXWithAbstractMethodY:{org:'Constructing a class "%s" with abstract method "%s"'},sXIsNotSupported:{org:"%s is not supported"},sOperatorIsNotOverloadedAOpB:{org:'Operator is not overloaded: "%s" %s "%s"'},sIllegalQualifierAfter:{org:'illegal qualifier "%s" after "%s"'},sIllegalQualifierInFrontOf:{org:'illegal qualifier "%s" in front of "%s"'},sClassXNotFoundInThisModule:{org:'class "%s" not found in this module'},sNoMatchingImplForIntfMethodXFound:{org:'No matching implementation for interface method "%s" found'},sClassMethodsMustBeStaticInX:{org:"Class methods must be static in %s"},sCannotMixMethodResolutionAndDelegationAtX:{org:"Cannot mix method resolution and delegation at %s"},sImplementsDoesNotSupportArrayProperty:{org:'"implements" does dot support array property'},sImplementsDoesNotSupportIndex:{org:'"implements" does not support "index"'},sImplementsUsedOnUnimplIntf:{org:'Implements-property used on unimplemented interface: "%"'},sDuplicateImplementsForIntf:{org:'Duplicate implements for interface "%s" at %s'},sImplPropMustHaveReadSpec:{org:"Implements-property must have read specifier"},sDoesNotImplementInterface:{org:'"%s" does not implement interface "%s"'},sTypeCycleFound:{org:"Type cycle found"},sTypeXIsNotYetCompletelyDefined:{org:'type "%s" is not yet completely defined'},sDuplicateCaseValueXatY:{org:'Duplicate case value "%s", other at %s'},sMissingFieldsX:{org:'Missing fields: "%s"'},sCantAssignValuesToConstVariable:{org:"Can't assign values to const variable"},sIllegalAssignmentToForLoopVar:{org:'Illegal assignment to for-loop variable "%s"'},sTypeXCannotBeExtendedByATypeHelper:{org:'Type "%s" cannot be extended by a type helper'},sTypeXCannotBeExtendedByARecordHelper:{org:'Type "%s" cannot be extended by a record helper'},sDerivedXMustExtendASubClassY:{org:'Derived %s must extend a subclass of "%s" or the class itself'},sDefaultPropertyNotAllowedInHelperForX:{org:"Default property not allowed in helper for %s"},sHelpersCannotBeUsedAsTypes:{org:"helpers cannot be used as types"},sMessageHandlersInvalidParams:{org:"Message handlers can take only one call by ref. parameter"},sWrongTypeXInArrayConstructor:{org:'Wrong type "%s" in array constructor'},sUnknownCustomAttributeX:{org:'Unknown custom attribute "%s"'},sAttributeIgnoredBecauseAbstractX:{org:"attribute ignored because abstract %s"},sCreatingAnInstanceOfAbstractClassY:{org:'Creating an instance of abstract class "%s"'},sIllegalExpressionAfterX:{org:"illegal expression after %s"},sMethodHidesNonVirtualMethodExactly:{org:'method hides identifier at "%s". Use reintroduce'},sDuplicatePublishedMethodXAtY:{org:'Duplicate published method "%s" at %s'},sConstraintXSpecifiedMoreThanOnce:{org:'Constraint "%s" specified more than once'},sConstraintXAndConstraintYCannotBeTogether:{org:'"%s" constraint and "%s" constraint cannot be specified together'},sXIsNotAValidConstraint:{org:'"%s" is not a valid constraint'},sWrongNumberOfParametersForGenericX:{org:"wrong number of parameters for generic %s"},sGenericsWithoutSpecializationAsType:{org:"Generics without specialization cannot be used as a type for a %s"},sDeclOfXDiffersFromPrevAtY:{org:'Declaration of "%s" differs from previous declaration at %s'},sTypeParamXIsMissingConstraintY:{org:'Type parameter "%s" is missing constraint "%s"'},sTypeParamXIsNotCompatibleWithY:{org:'Type parameter "%s" is not compatible with type "%s"'},sTypeParamXMustSupportIntfY:{org:'Type parameter "%s" must support interface "%s"'},sTypeParamsNotAllowedOnX:{org:"Type parameters not allowed on %s"},sXMethodsCannotHaveTypeParams:{org:"%s methods cannot have type parameters"},sImplMustNotRepeatConstraints:{org:"Implementations must not repeat constraints"},sCouldNotInferTypeArgXForMethodY:{org:'Could not infer generic type argument "%s" for method "%s"'},sInferredTypeXFromDiffArgsMismatchFromMethodY:{org:'Inferred type "%s" from different arguments mismatch for method "%s"'},sParamOfThisTypeCannotHaveDefVal:{org:"Parameters of this type cannot have default values"},sClassTypesAreNotRelatedXY:{org:'Class types "%s" and "%s" are not related'},sDirectiveXNotAllowedHere:{org:'Directive "%s" not allowed here'},sAwaitWithoutPromise:{org:"Await without promise"},sSymbolCannotBeExportedFromALibrary:{org:"The symbol cannot be exported from a library"},sForLoopControlVarMustBeSimpleLocalVar:{org:"For loop control variable must be simple local variable"},sIllegalCharConst:{org:"Illegal char constant"}}}),rtl.module("PParser",["System","SysUtils","Classes","Types","PasTree","PScanner"],function(){"use strict";var e=this,t=e.$impl,s=null,i=null,r=null,n=null,l=pas.System,a=l.TObject,o=pas.Classes,h=o.TFPList,u=pas.SysUtils,c=u.FreeAndNil,p=pas.PasTree,f=p.TPasFunctionType,d=p.TPasResultElement,F=u.Exception,m=pas.PScanner,C=m.TPasSourcePos,S=p.TPasImplExceptOn,T=u.LowerCase,y=p.TPasImplWithDo,g=p.TPasImplBlock,E=p.TPasImplIfElse,P=p.TPasImplAsmStatement,I=p.TPasImplCaseOf,R=p.TPasImplCaseElse,v=p.TPasImplCaseStatement,A=p.TPasImplCommand,N=p.TPasImplTryExcept,x=p.TPasImplTryExceptElse,b=p.TPasImplWhileDo,O=p.TPasImplForLoop,k=p.TPasImplRaise,$=p.TPasImplGoto,D=p.TPasImplTry,L=p.TPasImplTryFinally,B=p.TPasVariable,M=p.TPasImplRepeatUntil,G=p.TPasImplAssign,w=p.TPrimitiveExpr,V=p.TPasImplLabelMark,U=p.TPasImplSimple,J=u.UpperCase,j=p.TPasInlineVarDeclStatement,H=p.TPasMembersType,W=H.TRTTIVisibility,Y=u.CompareText,z=p.TPasOverloadedProc,_=p.TPasProcedure,K=p.TInterfaceSection,X=p.TPasProcedureType,q=l.VarRecs,Q=p.TPasClassType,Z=u.Format,ee=p.TPasVariant,te=p.TPasRecordType,se=p.TPasFunction,ie=p.TPasClassFunction,re=p.TPasClassProcedure,ne=p.TPasClassConstructor,le=p.TPasClassDestructor,ae=p.TPasConstructor,oe=p.TPasDestructor,he=p.TPasOperator,ue=p.TPasClassOperator,ce=p.TPasAnonymousProcedure,pe=p.TPasAnonymousFunction,fe=p.TPasGenericTemplateType,de=l.Pos,Fe=p.TBoolConstExpr,me=p.TBinaryExpr,Ce=p.TUnaryExpr,Se=p.TArrayValues,Te=p.TInheritedExpr,ye=p.TSelfExpr,ge=p.TNilExpr,Ee=p.TRecordValues,Pe=p.TPasExpr,Ie=p.TParamsExpr,Re=p.TProcedureExpr,ve=p.TInlineSpecializeExpr,Ae=p.TPasArgument,Ne=p.TPasDynamicPackage,xe=p.TImplementationSection,be=p.TPasUnresolvedUnitRef,Oe=p.TPasUsesUnit,ke=p.TPasModule,$e=m.SafeFormat,De=o.TStringList,Le=m.CreateMsgArgs,Be=m.EScannerError,Me=u.BoolToStr$1,Ge=p.TPasType,we=p.TPasUnresolvedTypeRef,Ve=p.TPasDeclarations,Ue=u.SameText,Je=u.DeQuoteString,je=p.TProcedureBody,He=p.TPasArrayType,We=p.TPasPointerType,Ye=p.TPasAliasType,ze=p.TPasStringType,_e=p.TPasTypeAliasType,Ke=p.TPasSpecializeType,Xe=p.TPasFileType,qe=p.TPasEnumType,Qe=p.TPasEnumValue,Ze=p.TPasSetType,et=p.TPasClassOfType,tt=p.TPasProperty,st=p.TPasRangeType,it=p.TPasExportSymbol,rt=p.TPasConst,nt=p.TPasResString,lt=p.TPasAttributes,at=p.TPasProgram,ot=p.TPasLibrary,ht=p.TPasUnitModule,ut=u.ChangeFileExt,ct=p.TProgramSection,pt=p.TLibrarySection,ft=p.TPasRequiredPackage,dt=p.TInitializationSection,Ft=p.TFinalizationSection,mt=p.TPasSection,Ct=p.TPasImplBeginBlock,St=p.TPasImplTryHandler,Tt=p.TPasLabels,yt=l.Copy,gt=p.TProcedureNamePart,Et=u.LeftStr,Pt=l.Delete,It=p.FreeProcNameParts,Rt=p.TPasMethodResolution;this.nErrNoSourceGiven=2001,this.nParserError=2003,this.nParserUngetTokenError=2005,this.nParserExpectTokenError=2006,this.nParserForwardNotInterface=2007,this.nParserExpectVisibility=2008,this.nParserStrangeVisibility=2009,this.nParserExpectToken2Error=2010,this.nParserExpectedCommaRBracket=2011,this.nParserExpectedCommaSemicolon=2012,this.nParserExpectedAssignIn=2013,this.nParserExpectedCommaColon=2014,this.nErrUnknownOperatorType=2015,this.nParserOnlyOneArgumentCanHaveDefault=2016,this.nParserExpectedLBracketColon=2017,this.nParserExpectedSemiColonEnd=2018,this.nParserExpectedConstVarID=2019,this.nParserExpectedNested=2020,this.nParserExpectedColonID=2021,this.nParserSyntaxError=2022,this.nParserTypeSyntaxError=2023,this.nParserArrayTypeSyntaxError=2024,this.nParserParamsOrResultTypesNoLocalTypeDefs=2025,this.nParserExpectedIdentifier=2026,this.nParserNotAProcToken=2026,this.nRangeExpressionExpected=2027,this.nParserExpectCase=2028,this.nParserGenericFunctionNeedsGenericKeyword=2029,this.nLogStartImplementation=2030,this.nLogStartInterface=2031,this.nParserNoConstructorAllowed=2032,this.nParserNoFieldsAllowed=2033,this.nParserInvalidRecordVisibility=2034,this.nErrRecordConstantsNotAllowed=2035,this.nErrRecordMethodsNotAllowed=2036,this.nErrRecordPropertiesNotAllowed=2037,this.nErrRecordTypesNotAllowed=2038,this.nParserTypeNotAllowedHere=2039,this.nParserNotAnOperand=2040,this.nParserArrayPropertiesCannotHaveDefaultValue=2041,this.nParserDefaultPropertyMustBeArray=2042,this.nParserUnknownProcedureType=2043,this.nParserTypeParamsNotAllowedOnType=2045,this.nParserDuplicateIdentifier=2046,this.nParserDefaultParameterRequiredFor=2047,this.nParserOnlyOneVariableCanBeInitialized=2048,this.nParserExpectedTypeButGot=2049,this.nParserPropertyArgumentsCanNotHaveDefaultValues=2050,this.nParserExpectedExternalClassName=2051,this.nParserNoConstRangeAllowed=2052,this.nErrRecordVariablesNotAllowed=2053,this.nParserResourcestringsMustBeGlobal=2054,this.nParserOnlyOneVariableCanBeAbsolute=2055,this.nParserXNotAllowedInY=2056,this.nInvalidMessageType=2058,this.nErrCompilationAborted=2059,this.nErrInvalidParamsForDirectiveX=2060,this.TPasScopeType={0:"stModule",stModule:0,1:"stUsesClause",stUsesClause:1,2:"stTypeSection",stTypeSection:2,3:"stTypeDef",stTypeDef:3,4:"stResourceString",stResourceString:4,5:"stProcedure",stProcedure:5,6:"stProcedureHeader",stProcedureHeader:6,7:"stSpecializeType",stSpecializeType:7,8:"stWithExpr",stWithExpr:8,9:"stExceptOnExpr",stExceptOnExpr:9,10:"stExceptOnStatement",stExceptOnStatement:10,11:"stForLoopHeader",stForLoopHeader:11,12:"stDeclaration",stDeclaration:12,13:"stAncestors",stAncestors:13,14:"stInitialFinalization",stInitialFinalization:14},this.TPParserLogEvent={0:"pleInterface",pleInterface:0,1:"pleImplementation",pleImplementation:1},rtl.createClass(this,"TPasTreeContainer",a,function(){this.$init=function(){a.$init.call(this),this.FCurrentParser=null,this.FNeedComments=!1,this.FOnLog=null,this.FPParserLogEvents={},this.FScannerLogEvents={},this.FPackage=null,this.FInterfaceOnly=!1,this.FOwnedElements=null},this.$final=function(){this.FCurrentParser=void 0,this.FOnLog=void 0,this.FPParserLogEvents=void 0,this.FScannerLogEvents=void 0,this.FPackage=void 0,this.FOwnedElements=void 0,a.$final.call(this)},this.SetCurrentParser=function(e){this.FCurrentParser!==e&&(this.FCurrentParser=e)},this.Create$1=function(){return this.FOwnedElements=h.$create("Create"),this},this.Destroy=function(){for(var e=0,t=null,s=this.FOwnedElements.FCount-1;s>=0;s--)e=s,t=rtl.getObject(this.FOwnedElements.Get(e)),t=rtl.freeLoc(t);c({p:this,get:function(){return this.p.FOwnedElements},set:function(e){this.p.FOwnedElements=e}}),a.Destroy.call(this)},this.HandleResultOnError=function(e){return true},this.CreateElement$2=function(e,t,s,i,r,n){return this.CreateElement$1(e,t,s,i,r.FileName,r.Row)},this.CreateFunctionType=function(e,t,s,i,r,n){var l=null,a=null;return l=this.CreateElement$2(f,e,s,0,r,n),a=i?s:l,l.ResultEl=this.CreateElement$2(d,t,a,0,r,n),l},this.FindElementFor=function(e,t,s){return this.FindElement(e)},this.BeginScope=function(e,t){},this.FinishScope=function(e,t){null!=t&&null!==this.FCurrentParser&&(t.SourceEndLinenumber=this.FCurrentParser.CurSourcePos().Row)},this.FinishTypeAlias=function(e){e.get()},this.FindModule=function(e){return null},this.FindModule$1=function(e,t,s){return this.FindModule(e)},this.CheckPendingUsedInterface=function(e){return false},this.NeedArrayValues=function(e){return false},this.GetDefaultClassVisibility=function(e){return 0},this.ModeChanged=function(e,t,s,i){i.get()}}),rtl.createClass(this,"EParserError",F,function(){s=this,this.$init=function(){F.$init.call(this),this.FErrNo=0,this.FFilename="",this.FRow=0,this.FColumn=0},this.Create$2=function(e,t,s,i,r){return F.Create$1.call(this,e),this.FFilename=t,this.FRow=s,this.FColumn=i,this.FErrNo=r,this}}),rtl.recNewT(this,"TRecoveryContext",function(){i=this,this.Element=null,this.Error=null,this.UngetRestartToken=!1,this.HaveScope=!1,this.Scope=0,this.$new=function(){var e=Object.create(this);return e.RestartTokens={},e},this.$eq=function(e){return this.Element===e.Element&&this.Error===e.Error&&rtl.eqSet(this.RestartTokens,e.RestartTokens)&&this.UngetRestartToken===e.UngetRestartToken&&this.HaveScope===e.HaveScope&&this.Scope===e.Scope},this.$assign=function(e){return this.Element=e.Element,this.Error=e.Error,this.RestartTokens=rtl.refSet(e.RestartTokens),this.UngetRestartToken=e.UngetRestartToken,this.HaveScope=e.HaveScope,this.Scope=e.Scope,this},this.Create=function(e,t,s,r){var n=i.$new();return n.$assign(i.$new()),n.Element=e,n.Error=t,n.RestartTokens=rtl.refSet(s),n.UngetRestartToken=r,n},this.Create$1=function(e,t,s,r,n){var l=i.$new();return l.$assign(i.Create(e,t,rtl.refSet(s),r)),l.Scope=n,l.HaveScope=!0,l}}),rtl.createClass(this,"TPasParser",a,function(){this.FTokenRingSize=32,this.TDeclParseType={0:"dptBasic",dptBasic:0,1:"dptFull",dptFull:1,2:"dptInline",dptInline:2},rtl.recNewT(this,"TTokenRec",function(){r=this,this.Token=0,this.AsString="",this.Comments=null,this.IsEscaped=!1,this.$new=function(){var e=Object.create(this);return e.SourcePos=C.$new(),e.TokenPos=C.$new(),e},this.$eq=function(e){return this.Token===e.Token&&this.AsString===e.AsString&&this.Comments===e.Comments&&this.SourcePos.$eq(e.SourcePos)&&this.TokenPos.$eq(e.TokenPos)&&this.IsEscaped===e.IsEscaped},this.$assign=function(e){return this.Token=e.Token,this.AsString=e.AsString,this.Comments=e.Comments,this.SourcePos.$assign(e.SourcePos),this.TokenPos.$assign(e.TokenPos),this.IsEscaped=e.IsEscaped,this}}),rtl.recNewT(this,"TParseStatementParams",function(){n=this,this.Parser=null,this.Parent=null,this.NewImplElement=null,this.CurBlock=null,this.$eq=function(e){return this.Parser===e.Parser&&this.Parent===e.Parent&&this.NewImplElement===e.NewImplElement&&this.CurBlock===e.CurBlock},this.$assign=function(e){return this.Parser=e.Parser,this.Parent=e.Parent,this.NewImplElement=e.NewImplElement,this.CurBlock=e.CurBlock,this},this.CloseBlock=function(){var e,t=!1,s=0;return(e=this.CurBlock.$class.ClassType())===S?(this.Parser.FEngine.FinishScope(10,this.CurBlock),(t=17===this.Parser.FCurToken)&&this.Parser.NextToken(),(s=this.Parser.FCurToken)in rtl.createSet(58,57)||3===s&&"on"===T(this.Parser.FCurTokenString)||this.Parser.ParseExcExpectedAorB("end","on"),t&&this.Parser.UngetToken()):e===y&&this.Parser.FEngine.FinishScope(8,this.CurBlock),this.CurBlock=rtl.as(this.CurBlock.FParent,g),this.CurBlock===this.Parent},this.CloseStatement=function(e){if(this.CurBlock===this.Parent)return!0;for(;this.CurBlock.CloseOnSemicolon()||e&&E.isPrototypeOf(this.CurBlock);)if(this.CloseBlock())return!0;return false},this.CreateBlock=function(e){this.CurBlock.AddElement(e),this.CurBlock=e,null===this.NewImplElement&&(this.NewImplElement=this.CurBlock)},this.CreateElement=function(e){return this.Parser.CreateElement$1(e,"",this.CurBlock,this.Parser.CurTokenPos())},this.CreateElement$1=function(e,t){return this.Parser.CreateElement$1(e,"",this.CurBlock,t)},this.ParseAsm=function(){var e;return e=this.CreateElement(P),this.Parser.ParseAsmBlock(e),this.CurBlock.AddElement(e),null===this.NewImplElement&&(this.NewImplElement=this.CurBlock),this.CloseStatement(!1)},this.ParseCase=function(){var t=C.$new(),s=null,i=null,r=null,n=null,l=null;for(t.$assign(this.Parser.CurTokenPos()),this.Parser.NextToken(),s=this.Parser.DoParseExpression(this.CurBlock,null,!0),this.Parser.UngetToken(),this.Parser.ExpectToken(86),(i=this.CreateElement$1(I,t)).CaseExpr=s,s.SetParent(i),this.CreateBlock(i);;){this.Parser.NextToken();var a=this.Parser.FCurToken;if(58===a){0===this.CurBlock.Elements.FCount&&this.Parser.ParseExc(2028,rtl.getResStr(e,"SParserExpectCase"));break}if(57===a||89===a){n=this.CreateElement(R),i.ElseBranch=n,this.CreateBlock(n);break}do{t.$assign(this.Parser.CurTokenPos()),s=this.Parser.DoParseExpression(this.CurBlock,null,!0),v.isPrototypeOf(this.CurBlock)?(this.CurBlock.AddExpression(s),s=null):((r=this.CreateElement$1(v,t)).AddExpression(s),this.CreateBlock(r)),12===this.Parser.FCurToken?this.Parser.NextToken():16!==this.Parser.FCurToken&&this.Parser.ParseExcTokenError(m.TokenInfos[12])}while(16!==this.Parser.FCurToken);this.Parser.ParseStatement(this.CurBlock,{get:function(){return l},set:function(e){l=e}}),this.CloseBlock(),17!==this.Parser.FCurToken&&this.Parser.NextToken(),this.Parser.FCurToken in rtl.createSet(17,57,58,89)||this.Parser.ParseExcTokenError(m.TokenInfos[17]),17!==this.Parser.FCurToken&&this.Parser.UngetToken()}if(58===this.Parser.FCurToken){if(this.CloseBlock())return!0;if(this.CloseStatement(!1))return!0}return false},this.ParseElse=function(){var e=null,t=null;for(!1;;){if(E.isPrototypeOf(this.CurBlock)){if(null===this.CurBlock.IfBranch&&(e=this.CreateElement(A),this.CurBlock.AddElement(e)),57===this.Parser.FCurToken&&null===this.CurBlock.ElseBranch){this.Parser.NextToken(),57===this.Parser.FCurToken&&(e=this.CreateElement(A),this.CurBlock.AddElement(e),this.CloseBlock()),this.Parser.UngetToken();break}}else{if(N.isPrototypeOf(this.CurBlock)&&57===this.Parser.FCurToken){this.CloseBlock(),t=this.CreateElement(x),this.CurBlock.ElseBranch=t,this.CurBlock=t;break}if(v.isPrototypeOf(this.CurBlock))return this.Parser.UngetToken(),this.CurBlock!==this.Parent&&this.Parser.CheckToken(17),!0;b.isPrototypeOf(this.CurBlock)||O.isPrototypeOf(this.CurBlock)||y.isPrototypeOf(this.CurBlock)||k.isPrototypeOf(this.CurBlock)||$.isPrototypeOf(this.CurBlock)||S.isPrototypeOf(this.CurBlock)||this.Parser.ParseExcSyntaxError()}this.CloseBlock()}return false},this.ParseExcept=function(){var e=null;return this.CloseStatement(!0)?(this.Parser.UngetToken(),!0):(D.isPrototypeOf(this.CurBlock)?(e=this.CreateElement(N),this.CurBlock.FinallyExcept=e,this.CurBlock=e):this.Parser.ParseExcSyntaxError(),false)},this.ParseFinally=function(){var e=null;return this.CloseStatement(!0)?(this.Parser.UngetToken(),!0):(D.isPrototypeOf(this.CurBlock)?(e=this.CreateElement(L),this.CurBlock.FinallyExcept=e,this.CurBlock=e):this.Parser.ParseExcSyntaxError(),false)},this.ParseIf=function(){var e=C.$new(),t=null,s=null;e.$assign(this.Parser.CurTokenPos()),this.Parser.NextToken(),t=this.Parser.DoParseExpression(this.CurBlock,null,!0),this.Parser.UngetToken(),(s=this.CreateElement$1(E,e)).ConditionExpr=t,t.SetParent(s),this.CreateBlock(s),this.Parser.ExpectToken(105)},this.ParseOn=function(){var e=C.$new(),t=null,s="",i=null,r=null;return N.isPrototypeOf(this.CurBlock)?(e.$assign(this.Parser.CurTokenPos()),this.Parser.ExpectIdentifier({}),t=this.CreateElement$1(S,e),e.$assign(this.Parser.CurSourcePos()),s=this.Parser.FCurTokenString,this.Parser.NextToken(),16===this.Parser.FCurToken?(this.Parser.NextToken(),i=this.Parser.ParseSimpleType(t,e,"",!1),t.TypeEl=i,r=this.Parser.CreateElement$1(B,s,t,e),t.VarEl=r,r.VarType=i,i.FParent===t&&i.SetParent(r)):(this.Parser.UngetToken(),t.TypeEl=this.Parser.ParseSimpleType(t,e,"",!1)),this.Parser.FEngine.FinishScope(9,t),this.CreateBlock(t),this.Parser.ExpectToken(55)):this.Parser.ParseExcSyntaxError(),false},this.ParseUntil=function(){var e=null;if(this.CloseStatement(!0))return this.Parser.UngetToken(),!0;if(M.isPrototypeOf(this.CurBlock)){if(this.Parser.NextToken(),e=this.Parser.DoParseExpression(this.CurBlock,null,!0),this.Parser.UngetToken(),this.CurBlock.ConditionExpr=e,this.CloseBlock())return!0}else this.Parser.ParseExcSyntaxError();return false},this.ParseExpr=function(){var t=this;function s(e){t.CurBlock.AddElement(e),null===t.NewImplElement&&(t.NewImplElement=e),t.Parser.UngetToken()}var i=C.$new(),r=null,n=null,l=null,a=null,o=null;i.$assign(this.Parser.CurTokenPos()),r=this.Parser.DoParseExpression(this.CurBlock,null,!0);var h=this.Parser.FCurToken;27===h||33===h||34===h||35===h||36===h?((l=this.CreateElement$1(G,i)).Left=r,r.SetParent(l),l.Kind=e.TokenToAssignKind(this.Parser.FCurToken),this.Parser.NextToken(),n=this.Parser.DoParseExpression(this.CurBlock,null,!0),l.Right=n,n.SetParent(l),s(l)):16===h?(29 in this.Parser.FScanner.FCurrentBoolSwitches&&w.isPrototypeOf(r)||this.Parser.ParseExcTokenError(m.TokenInfos[17]),(a=this.CreateElement$1(V,i)).LabelId=r.Value,this.CurBlock.AddElement(a)):((o=this.CreateElement$1(U,i)).Expr=r,r.SetParent(o),s(o))},this.ParseFor=function(){var t=null,s=null,i=0,r=C.$new(),n=!1;t=this.CreateElement(O),n=!1,56 in this.Parser.GetCurrentModeSwitches()&&(this.Parser.NextToken(),(n=114===this.Parser.FCurToken)||this.Parser.UngetToken()),r.$assign(this.Parser.CurTokenPos()),this.Parser.ExpectIdentifier({}),s=this.Parser.CreatePrimitiveExpr(t,0,this.Parser.FCurTokenString),t.VariableName=s;for(;;){this.Parser.NextToken();var l=this.Parser.FCurToken;if(27===l){i=0,t.ImplicitTyped=n&&null===t.VarType;break}if(16===l)n||this.Parser.ParseExc(2013,rtl.getResStr(e,"SParserExpectedAssignIn")),t.VarType=this.Parser.ParseType$1(t,r,"",!1);else{if(71===l){i=2,t.ImplicitTyped=n&&null===t.VarType;break}14===l?(n&&this.Parser.ParseExc(2013,rtl.getResStr(e,"SParserExpectedAssignIn")),r.$assign(this.Parser.CurTokenPos()),this.Parser.ExpectIdentifier({}),this.Parser.AddToBinaryExprChain({get:function(){return s},set:function(e){s=e}},this.Parser.CreatePrimitiveExpr(t,0,this.Parser.FCurTokenString),27,r),t.VariableName=s):this.Parser.ParseExc(2013,rtl.getResStr(e,"SParserExpectedAssignIn"))}}this.Parser.NextToken(),t.StartExpr=this.Parser.DoParseExpression(t,null,!0),0===i&&(this.Parser.FCurToken in rtl.createSet(107,56)||this.Parser.ParseExcTokenError(m.TokenInfos[107]),56===this.Parser.FCurToken&&(i=1),this.Parser.NextToken(),t.EndExpr=this.Parser.DoParseExpression(t,null,!0)),t.LoopType=i,55!==this.Parser.FCurToken&&this.Parser.ParseExcTokenError(m.TokenInfos[55]),this.Parser.FEngine.FinishScope(11,t),this.CreateBlock(t)},this.ParseGoto=function(){var e=C.$new(),t=null;e.$assign(this.Parser.CurTokenPos()),this.Parser.ExpectTokens(rtl.createSet(3,6)),t=this.CreateElement$1($,e),this.CreateBlock(t),t.LabelName=this.Parser.FCurTokenString},this.ParseRaise=function(){var e=null;e=this.CreateElement(k),this.CreateBlock(e),this.Parser.NextToken(),this.Parser.FCurToken in rtl.createSet(57,58,17,89)?this.Parser.UngetToken():(e.ExceptObject=this.Parser.DoParseExpression(e,null,!0),3===this.Parser.FCurToken&&"AT"===J(this.Parser.FCurTokenString)&&(this.Parser.NextToken(),e.ExceptAddr=this.Parser.DoParseExpression(e,null,!0)),this.Parser.FCurToken in rtl.createSet(57,58,17,89)&&this.Parser.UngetToken())},this.ParseWhile=function(){var e=C.$new(),t=null,s=null;e.$assign(this.Parser.CurTokenPos()),this.Parser.NextToken(),s=this.Parser.DoParseExpression(this.CurBlock,null,!0),this.Parser.UngetToken(),(t=this.CreateElement$1(b,e)).ConditionExpr=s,s.SetParent(t),this.CreateBlock(t),this.Parser.ExpectToken(55)},this.ParseWith=function(){var e=C.$new(),t=null,s=null;for(e.$assign(this.Parser.CurTokenPos()),this.Parser.NextToken(),t=this.CreateElement$1(y,e),s=this.Parser.DoParseExpression(this.CurBlock,null,!0),t.AddExpression(s),s.SetParent(t),this.Parser.FEngine.BeginScope(8,s),this.CreateBlock(t);;){if(55===this.Parser.FCurToken)break;12!==this.Parser.FCurToken&&this.Parser.ParseExcTokenError(m.TokenInfos[55]),this.Parser.NextToken(),s=this.Parser.DoParseExpression(this.CurBlock,null,!0),t.AddExpression(s),this.Parser.FEngine.BeginScope(8,s)}},this.ParseVarStatement=function(){var e,t=C.$new();t.$assign(this.Parser.CurTokenPos()),e=this.CreateElement$1(j,t),this.NewImplElement=e,this.CurBlock.AddElement(e),this.Parser.ParseVarList(e,e.Declarations,0,2)}}),this.FTokenRing$a$clone=function(e){var t=[];t.length=32;for(var s=0;s<32;s++)t[s]=r.$clone(e[s]);return t},this.$init=function(){a.$init.call(this),this.FCurModule=null,this.FCurTokenEscaped=!1,this.FFailOnModuleErors=!1,this.FFileResolver=null,this.FIdentifierPos=C.$new(),this.FImplicitUses=null,this.FLastMsg="",this.FLastMsgArgs=[],this.FLastMsgNumber=0,this.FLastMsgPattern="",this.FLastMsgType=0,this.FLogEvents={},this.FOnError=null,this.FOnLog=null,this.FOptions={},this.FScanner=null,this.FEngine=null,this.FCurToken=0,this.FCurTokenString="",this.FSavedComments="",this.FErrorCount=0,this.FMaxErrorCount=0,this.FTokenRing=rtl.arraySetLength(null,r,32),this.FTokenRingCur=0,this.FTokenRingStart=0,this.FTokenRingEnd=0,this.RTTIVisibility=W.$new()},this.$final=function(){this.FCurModule=void 0,this.FFileResolver=void 0,this.FIdentifierPos=void 0,this.FImplicitUses=void 0,this.FLastMsgArgs=void 0,this.FLogEvents=void 0,this.FOnError=void 0,this.FOnLog=void 0,this.FOptions=void 0,this.FScanner=void 0,this.FEngine=void 0,this.FTokenRing=void 0,this.RTTIVisibility=void 0,a.$final.call(this)},this.CheckOverloadList=function(e,t,s){var i=null,r=0;for(i=null,r=0;null===i&&r<e.FCount;)s.set(rtl.getObject(e.Get(r))),0===Y(s.get().FName,t)&&(z.isPrototypeOf(s.get())?i=s.get():(i=this.CreateElement(z,t,s.get().FParent),s.get().SetParent(i),i.Visibility=s.get().Visibility,i.Overloads.Add(s.get()),i.SourceFilename=s.get().SourceFilename,i.SourceLinenumber=s.get().SourceLinenumber,i.FDocComment=s.get().FDocComment,e.Put(r,i))),r+=1;return null===i&&s.set(null),i},this.DoCheckHint=function(e){var t,s=0;return(t=this.IsCurTokenHint({get:function(){return s},set:function(e){s=e}}))&&(e.FHints=rtl.unionSet(e.FHints,rtl.createSet(s)),0===s&&(this.NextToken(),4!==this.FCurToken?this.UngetToken():e.FHintMessage=this.FCurTokenString)),t},this.GetCurrentModeSwitches=function(){return null!=this.FScanner?rtl.refSet(this.FScanner.FCurrentModeSwitches):rtl.createSet(0)},this.GetVariableModifiers=function(e,t,s,i,r){var n,l="",a=0;if(l="",s.set(null),i.set(null),t.set({}),this.NextToken(),0 in r&&this.CurTokenIsIdentifier("cvar")&&(l=";cvar",t.set(rtl.includeSet(t.get(),0)),this.ExpectToken(17),this.NextToken()),n=T(this.CurTokenText()),!(1 in r)||"external"!==n&&"weakexternal"!==n)if(2 in r&&"public"===n)a=2;else if(3 in r&&"export"===n)a=3;else{if(!(6 in r)||"far"!==n)return this.UngetToken(),l;a=6}else a=1;if(t.set(rtl.includeSet(t.get(),a)),l=l+";"+this.CurTokenText(),this.NextToken(),!(this.FCurToken in rtl.createSet(4,3))){if(17===this.FCurToken&&a in rtl.createSet(1,2,3))return l;this.ParseExcSyntaxError()}return 1===a&&this.FCurToken in rtl.createSet(4,3)&&!this.CurTokenIsIdentifier("name")&&(l=l+" "+this.CurTokenText(),s.set(this.DoParseExpression(e,null,!0))),17===this.FCurToken||(this.CurTokenIsIdentifier("name")||this.ParseExcSyntaxError(),this.NextToken(),this.FCurToken in rtl.createSet(7,4,3)||this.ParseExcTokenError(m.TokenInfos[4]),l=l+" "+this.CurTokenText(),i.set(this.DoParseExpression(e,null,!0))),l},this.GetVariableValueAndLocation=function(e,t,s,i,r){var n=!1;return s.set(null),i.set(null),r.set(""),this.NextToken(),(n=t?27===this.FCurToken:19===this.FCurToken)&&(this.NextToken(),t?s.set(this.DoParseExpression(e,null,!0)):s.set(this.DoParseConstValueExpression(e))),39===this.FCurToken?(n=!0,this.NextToken(),this.FCurToken in rtl.createSet(6,8)?(i.set(this.DoParseExpression(e,null,!1)),r.set(this.FCurTokenString)):(r.set(this.ReadDottedIdentifier(e,i,!0)),17!==this.FCurToken&&i.set(this.DoParseExpression(e,i.get(),!1)),this.UngetToken())):this.UngetToken(),n},this.HandleProcedureModifier=function(t,s,i){var r=this,n=null,l=null;function a(){s in n.FModifiers&&r.ParseExcSyntaxError(),n.AddModifier(s)}n=t,10!==s&&a();var o=s;if(12===o)this.NextToken(),this.FCurToken in rtl.createSet(7,4,3)?(this.CurTokenIsIdentifier("NAME")||(l=this.DoParseExpression(t,null,!0),null!=n&&(n.LibraryExpr=l)),this.CurTokenIsIdentifier("NAME")&&(this.NextToken(),this.FCurToken in rtl.createSet(7,4,3)||this.ParseExcTokenError(m.TokenInfos[4]),l=this.DoParseExpression(t,null,!0),null!=n&&(n.LibrarySymbolName=l)),this.CurTokenIsIdentifier("INDEX")&&(this.NextToken(),this.FCurToken in rtl.createSet(6,7,4,3)||this.ParseExcTokenError(m.TokenInfos[6]),l=this.DoParseExpression(t,null,!0),null!=n&&(n.LibrarySymbolIndex=l)),17!==this.FCurToken&&this.UngetToken()):this.UngetToken();else if(20===o)this.NextToken(),4!==this.FCurToken&&this.ParseExcTokenError(m.TokenInfos[4]),this.NextToken(),this.CheckToken(17);else if(10===o){if(this.NextToken(),!this.CurTokenIsIdentifier("name"))return i?(this.FCurToken in rtl.createSet(12,23)||this.ParseExcTokenError(m.TokenInfos[12]),void a()):H.isPrototypeOf(n.FParent)?(this.UngetToken(),void this.UngetToken()):(a(),void this.CheckToken(17));a(),this.NextToken(),this.FCurToken in rtl.createSet(4,3)||this.ParseExcTokenError(m.TokenInfos[4]),l=this.DoParseExpression(t,null,!0),_.isPrototypeOf(t)&&(t.PublicName=l),this.CheckToken(17)}else if(13===o)K.isPrototypeOf(t.FParent)&&(this.ParseExc(2007,rtl.getResStr(e,"SParserForwardNotInterface")),this.UngetToken());else if(6===o){if(this.NextToken(),l=this.DoParseExpression(t,null,!0),t.MessageExpr=l,w.isPrototypeOf(l)){t.FMessageName=l.Value;var h=l.Kind;1===h||8===h?t.FMessageType=1:2===h?t.FMessageType=2:0===h||this.ParseExc(2058,rtl.getResStr(e,"SErrInvalidMessageType"))}17!==this.FCurToken&&this.UngetToken()}else 14===o?(this.NextToken(),t.DispIDExpr=this.DoParseExpression(t,null,!0),17!==this.FCurToken&&this.UngetToken()):11===o&&(this.NextToken(),16===this.FCurToken&&(this.NextToken(),this.CheckToken(3),t.CompProcID=this.FCurTokenString,this.NextToken()),17!==this.FCurToken&&this.UngetToken())},this.HandleProcedureTypeModifier=function(e,t){var s=null;if(t in e.Modifiers&&this.ParseExcSyntaxError(),e.Modifiers=rtl.includeSet(e.Modifiers,t),3===t){if(this.NextToken(),86!==this.FCurToken)return void this.UngetToken();this.NextToken(),s=null,e.VarArgsType=this.ParseTypeReference(e,!1,{get:function(){return s},set:function(e){s=e}})}},this.ParseMembersLocalConsts=function(e,t){for(var s=null,i=!1;22===this.FCurToken&&47 in this.GetCurrentModeSwitches();)this.ParseAttributes(e,!0),this.NextToken();do{if(this.SaveIdentifierPosition(),null!=(s=this.ParseConstDecl(e))&&(s.Visibility=t,e.Members.Add(s),this.FEngine.FinishScope(12,s)),this.NextToken(),17!==this.FCurToken)return;this.NextToken();var r=this.FCurToken;if(39===r||3===r)i=this.CheckVisibility(this.FCurTokenString,{get:function(){return t},set:function(e){t=e}},!1)||this.CheckCurtokenIsFinal(e);else if(22===r)if(47 in this.GetCurrentModeSwitches())do{this.ParseAttributes(e,!0),this.NextToken(),i=!1}while(22===this.FCurToken);else i=!0;else i=!0;i&&this.UngetToken()}while(!i)},this.ParseMembersLocalTypes=function(e,t){var s=null,i=!1;for(i=!1;22===this.FCurToken&&47 in this.GetCurrentModeSwitches();)this.ParseAttributes(e,!0),this.NextToken();do{(s=this.ParseTypeDecl(e)).Visibility=t,e.Members.Add(s),this.NextToken();var r=this.FCurToken;if(67===r)this.NextToken(),3!==this.FCurToken&&(i=!0),this.UngetToken();else if(3===r)!(i=this.CheckVisibility(this.FCurTokenString,{get:function(){return t},set:function(e){t=e}},!1))&&this.CheckCurtokenIsFinal(e)&&(i=!0);else if(22===r)if(47 in this.GetCurrentModeSwitches())do{this.ParseAttributes(e,!0),this.NextToken(),i=!1}while(22===this.FCurToken);else i=!0;else i=!0;i&&this.UngetToken()}while(!i);this.FEngine.FinishScope(2,e)},this.ParseVarList=function(t,s,i,r){var n=0,l=0,a=0,o=null,h=null,u=null,c=null,p=null,f=null,d={},m={},C={},S="",T="",y="",g=!1,E=!1,P=!1,I=!1;o=null,h=null,u=null,c=null,y="",l=0,a=0,E=!1,I=!1;try{for(S=this.SaveComments(),f=null;22===this.FCurToken;)47 in this.GetCurrentModeSwitches()?(s.Add(this.ParseAttributes(t,!1)),l+=1,this.NextToken()):this.CheckToken(3);do{f=this.CreateElement$3(B,this.FCurTokenString,t,i,this.CurTokenPos(),null),s.Add(f),a+=1,this.NextToken();var R=this.FCurToken;if(16===R)break;if(12===R)this.ExpectIdentifier({});else{if(27===R){2!==r&&this.ParseExc(2014,rtl.getResStr(e,"SParserExpectedCommaColon")),this.UngetToken(),I=!0;break}this.ParseExc(2014,rtl.getResStr(e,"SParserExpectedCommaColon"))}}while(16!==this.FCurToken);if(p=null,16===this.FCurToken){g=this.FScanner.SetForceCaret(!0);try{if(p=this.ParseVarType(f),s.Get(s.FCount-1)!==f)throw F.$create("Create$1",["20241121115919"])}finally{this.FScanner.SetForceCaret(g)}for(var v=s.FCount-a,A=s.FCount-1;v<=A;v++)n=v,(f=rtl.getObject(s.Get(n))).VarType=p}d=rtl.refSet(this.CheckHint(null,!1)),r in rtl.createSet(1,2)&&this.GetVariableValueAndLocation(f,I,{get:function(){return o},set:function(e){o=e}},{get:function(){return c},set:function(e){c=e}},{get:function(){return y},set:function(e){y=e}}),a>1&&(null!==o&&this.ParseExc(2048,rtl.getResStr(e,"SParserOnlyOneVariableCanBeInitialized")),null!==c&&this.ParseExc(2055,rtl.getResStr(e,"SParserOnlyOneVariableCanBeAbsolute"))),f.Expr=o,o=null,P=52 in this.GetCurrentModeSwitches()&&H.isPrototypeOf(t),d=rtl.unionSet(d,this.CheckHint(null,!1)),1===r||P?(this.NextToken(),17!==this.FCurToken&&this.UngetToken(),C={},C=P?rtl.createSet(1):rtl.createSet(0,1,2,3,6),""===(T=this.GetVariableModifiers(f,{get:function(){return m},set:function(e){m=e}},{get:function(){return h},set:function(e){h=e}},{get:function(){return u},set:function(e){u=e}},C))&&17!==this.FCurToken&&this.NextToken()):(this.NextToken(),m={},T=""),this.SaveComments$1(S);for(var N=s.FCount-a,x=s.FCount-1;N<=x;N++)n=N,f=rtl.getObject(s.Get(n)),null!=p&&X.isPrototypeOf(p)?f.FHints=rtl.refSet(p.FHints):f.FHints=rtl.refSet(d),f.Modifiers=T,f.VarModifiers=rtl.refSet(m),f.AbsoluteLocation=y,null!==c&&(f.AbsoluteExpr=c,c=null),null!==h&&(f.LibraryName=h,h=null),null!==u&&(f.ExportName=u,u=null);E=!0}finally{E||s.SetCount(s.FCount-a-l)}},this.SetOptions=function(e){rtl.eqSet(this.FOptions,e)||(this.FOptions=rtl.refSet(e),null!=this.FScanner&&this.FScanner.SetOptions(rtl.refSet(e)))},this.OnScannerModeChanged=function(e,t,s,i){this.FEngine.ModeChanged(this,t,s,i)},this.OnScannerDirectiveRTTI=function(t,s,i,r){var n=W.$new();20 in this.FOptions&&(r.set(!0),this.ParseRTTIDirective(i,n)||this.ParseExc$1(2060,rtl.getResStr(e,"SErrInvalidParamsForDirectiveX"),q(18,s)),this.RTTIVisibility.$assign(n))},this.AllowFinal=function(e){var t=!1;if(t=!1,!Q.isPrototypeOf(e))return t;for(;null!==e&&!t;)t=e.IsExternal,e=Q.isPrototypeOf(e.FParent)?e.FParent:null;return t},this.CheckCurtokenIsFinal=function(e){return!this.FCurTokenEscaped&&this.CurTokenIsIdentifier("final")&&this.AllowFinal(e)},this.SaveComments=function(){return this.FEngine.FNeedComments&&(this.FSavedComments=this.CurComments().GetTextStr()),this.FSavedComments},this.SaveComments$1=function(e){return this.FSavedComments=e,this.FSavedComments},this.LogEvent=function(e){return e in this.FLogEvents},this.DoLog=function(e,t,s,i){this.DoLog$1(e,t,s,[],i)},this.DoLog$1=function(e,t,s,i,r){var n="";null!==this.FScanner&&this.FScanner.IgnoreMsgType(e)||(this.SetLastMsg(e,t,s,i),null!=this.FOnLog&&(n=m.MessageTypeNames[e]+": ",r||null==this.FScanner?n+=this.FLastMsg:n+=Z("%s(%d,%d) : %s",q(18,this.FScanner.FCurFilename,0,this.FScanner.FCurRow,0,this.FScanner.GetCurColumn(),18,this.FLastMsg)),this.FOnLog(this,n)))},this.GetProcTypeFromToken=function(t,s){var i=0;i=0;return 92===t?i=s?6:0:66===t?i=s?7:1:50===t?i=s?8:4:52===t?i=s?9:5:87===t?i=s?3:2:this.ParseExc(2026,rtl.getResStr(e,"SParserNotAProcToken")),i},this.ParseAsmBlock=function(e){var t=this,s=0,i=null;function r(){return 58===t.FCurToken&&!(s in rtl.createSet(21,37))}if(4 in this.FOptions){for(this.FTokenRingCur=0,this.FTokenRingStart=0,this.FTokenRingEnd=1,(i=this.FTokenRing[0]).Comments.Clear();;){this.FScanner.ReadNonPascalTillEndToken(!0);var n=this.FScanner.FCurToken;if(118!==n&&1!==n&&2!==n){if(58===n){i.Token=58,i.AsString=this.FScanner.GetTokenString();break}i.Token=0,i.AsString="";break}e.FTokens.Add(this.FScanner.GetTokenString())}this.FCurToken=i.Token,this.FCurTokenString=i.AsString,this.CheckToken(58)}else for(s=0,this.NextToken();!r();)e.FTokens.Add(this.CurTokenText()),s=this.FCurToken,this.NextToken();if(this.NextToken(),22!==this.FCurToken)this.UngetToken();else for(this.NextToken();!(this.FCurToken in rtl.createSet(23,0));)e.FModifierTokens.Add(this.FCurTokenString),this.NextToken()},this.ParseRecordMembers=function(t,s,i){var r=this,n=!1;function l(){n=!0,r.FScanner.SetTokenOption(1)}function a(){n&&(n=!1,r.FScanner.UnSetTokenOption(1))}function o(){var e;return r.NextToken(),(e=r.FCurToken in rtl.createSet(114,110,48,46))||r.UngetToken(),e}var u,c="",p=0,f=null,d=0,F=null,m=C.$new(),S=0,T=0,y=null,g=0,E=!1;E=!1,u=34 in this.GetCurrentModeSwitches(),p=u?3:0,n=!1,g=96;for(;this.FCurToken!==s;){this.SaveComments();var P=this.FCurToken;if(110===P){if(a(),i||this.ParseExc(2038,rtl.getResStr(e,"SErrRecordTypesNotAllowed")),o())continue;this.ExpectToken(3),this.ParseMembersLocalTypes(t,p)}else if(48===P){if(a(),i||this.ParseExc(2035,rtl.getResStr(e,"SErrRecordConstantsNotAllowed")),o())continue;this.ExpectToken(3),this.SaveIdentifierPosition(),this.ParseMembersLocalConsts(t,p)}else if(114===P){if(i||this.ParseExc(2053,rtl.getResStr(e,"SErrRecordVariablesNotAllowed")),o())continue;this.ExpectToken(3),this.SaveIdentifierPosition(),S=t.Members.FCount,this.ParseInlineVarDecl(t,t.Members,p,9===s);for(var I=S,R=t.Members.FCount-1;I<=R;I++)T=I,(y=rtl.getObject(t.Members.Get(T))).$class.ClassType()===B&&(n&&(y.VarModifiers=rtl.unionSet(y.VarModifiers,rtl.createSet(4))),this.FEngine.FinishScope(12,y))}else if(47===P){if(47===g&&this.ParseExc(2023,rtl.getResStr(e,"SParserTypeSyntaxError")),!i){this.NextToken();var v=this.FCurToken;48===v?this.ParseExc(2035,rtl.getResStr(e,"SErrRecordConstantsNotAllowed")):114===v?this.ParseExc(2053,rtl.getResStr(e,"SErrRecordVariablesNotAllowed")):this.ParseExc(2036,rtl.getResStr(e,"SErrRecordMethodsNotAllowed"))}l()}else if(94===P)a(),i||this.ParseExc(2037,rtl.getResStr(e,"SErrRecordPropertiesNotAllowed")),this.ExpectToken(3),F=this.ParseProperty(t,this.FCurTokenString,p,47===g),t.Members.Add(F),this.FEngine.FinishScope(12,F);else if(87===P||92===P||50===P||66===P)a(),i||this.ParseExc(2036,rtl.getResStr(e,"SErrRecordMethodsNotAllowed")),d=this.GetProcTypeFromToken(this.FCurToken,47===g),f=this.ParseProcedureOrFunctionDecl(t,d,E,p),z.isPrototypeOf(f.FParent)?f.FParent.Overloads.Add(f):t.Members.Add(f),this.FEngine.FinishScope(5,f);else if(52===P)this.ParseExc(2032,rtl.getResStr(e,"SParserNoConstructorAllowed"));else if(67===P||39===P||76===P||100===P||3===P){if(67===this.FCurToken&&u){if(this.NextToken(),this.FCurToken in rtl.createSet(47,87,66,92)){E=!0;continue}this.UngetToken()}if(u&&this.CheckVisibility(this.FCurTokenString,{get:function(){return p},set:function(e){p=e}},!1)){p in rtl.createSet(1,3,6)||this.ParseExc(2034,rtl.getResStr(e,"SParserInvalidRecordVisibility")),this.NextToken();continue}S=t.Members.FCount,this.ParseInlineVarDecl(t,t.Members,p,9===s);for(var A=S,N=t.Members.FCount-1;A<=N;A++)T=A,(y=rtl.getObject(t.Members.Get(T))).$class.ClassType()===B&&(n&&(y.VarModifiers=rtl.unionSet(y.VarModifiers,rtl.createSet(4))),this.FEngine.FinishScope(12,y))}else 22===P?47 in this.GetCurrentModeSwitches()?this.ParseAttributes(t,!0):this.CheckToken(3):46===P?(a(),t.Variants=h.$create("Create"),this.NextToken(),c=this.FCurTokenString,m.$assign(this.CurSourcePos()),this.NextToken(),16===this.FCurToken?(t.VariantEl=this.CreateElement$1(B,c,t,m),t.VariantEl.VarType=this.ParseType$1(t,this.CurSourcePos(),"",!1)):(this.UngetToken(),this.UngetToken(),t.VariantEl=this.ParseType$1(t,this.CurSourcePos(),"",!1)),this.ExpectToken(86),this.ParseRecordVariantParts(t,s)):this.ParseExc(2023,rtl.getResStr(e,"SParserTypeSyntaxError"));if(this.FCurToken===s)break;g=this.FCurToken,this.NextToken(),n||(E=!1)}},this.ParseRecordVariantParts=function(t,s){var i=null,r=null,n=!1;do{r=this.CreateElement(ee,"",t),t.Variants.Add(r);do{this.NextToken(),r.Values.Add(this.DoParseExpression(t,null,!0)),this.FCurToken in rtl.createSet(12,16)||this.ParseExc(2014,rtl.getResStr(e,"SParserExpectedCommaColon"))}while(16!==this.FCurToken);this.ExpectToken(8),this.NextToken(),(i=this.CreateElement(te,"",r)).RTTIVisibility.$assign(this.RTTIVisibility),r.Members=i,this.ParseRecordMembers(i,9,!1),this.NextToken(),17===this.FCurToken&&this.NextToken(),(n=this.FCurToken===s)||this.UngetToken()}while(!n)},this.GetProcedureClass=function(t){var s=null;s=null;return 1===t?s=se:7===t?s=ie:6===t?s=re:8===t?s=ne:9===t?s=le:0===t?s=_:4===t?s=ae:5===t?s=oe:2===t?s=he:3===t?s=ue:10===t?s=ce:11===t?s=pe:this.ParseExc$1(2043,rtl.getResStr(e,"SParserUnknownProcedureType"),q(0,t)),s},this.ParseClassFields=function(e,t,s){var i,r=null,n=0,l=!1,a=null,o=null;i=(o=e.Members).FCount,this.ParseInlineVarDecl(e,o,t,!1),17===this.FCurToken&&(this.NextToken(),(l=this.CurTokenIsIdentifier("static"))?this.ExpectToken(17):this.UngetToken());for(var h=i,u=o.FCount-1;h<=u;h++)n=h,(r=rtl.getObject(o.Get(n))).Visibility=t,r.$class.ClassType()===B&&(a=r,s&&(a.VarModifiers=rtl.includeSet(a.VarModifiers,4)),l&&(a.VarModifiers=rtl.includeSet(a.VarModifiers,5)),this.FEngine.FinishScope(12,a))};this.ParseClassMembers=function(t){var s=0,i=0,r=!1,n=!1,l=0,a=null,o=null;for(i=0,r=!1,s=null!=this.FEngine?this.FEngine.GetDefaultClassVisibility(t):3,l=this.FCurToken;58!==this.FCurToken;){r=47===l;var h=this.FCurToken;if(110===h){r&&this.ParseExcExpectedAorB("Procedure","Function");var u=t.ObjKind;1===u||0===u||3===u||4===u||5===u||2===u&&t.IsExternal||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"TYPE",18,p.ObjKindNames[t.ObjKind])),i=2,this.NextToken(),this.ParseMembersLocalTypes(t,s),i=0}else if(48===h){r&&this.ParseExcExpectedAorB("Procedure","Var");var c=t.ObjKind;1===c||0===c||3===c||4===c||5===c||2===c&&t.IsExternal||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"CONST",18,p.ObjKindNames[t.ObjKind])),i=1,this.NextToken(),this.ParseMembersLocalConsts(t,s),i=0}else if(114===h)t.ObjKind in p.okWithFields||r&&t.ObjKind in p.okAllHelpers||2===t.ObjKind&&t.IsExternal||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"VAR",18,p.ObjKindNames[t.ObjKind])),i=r?4:3;else if(39===h||3===h){if(this.CheckCurtokenIsFinal(t)){this.NextToken();continue}if(this.CheckVisibility(this.FCurTokenString,{get:function(){return s},set:function(e){s=e}},9===t.ObjKind))i=0;else{r?47===l&&this.ParseExcExpectedAorB("Procedure","Function"):this.SaveComments();var f=i;if(0===f||3===f)t.ObjKind in p.okWithFields||this.ParseExc$1(2033,rtl.getResStr(e,"SParserNoFieldsAllowedInX"),q(18,p.ObjKindNames[t.ObjKind])),this.ParseClassFields(t,s,!1),58===this.FCurToken&&this.UngetToken();else{if(4!==f)throw F.$create("Create$1",["Internal error 201704251415"]);t.ObjKind in p.okWithClassFields||2===t.ObjKind&&t.IsExternal||this.ParseExc$1(2033,rtl.getResStr(e,"SParserNoFieldsAllowedInX"),q(18,p.ObjKindNames[t.ObjKind])),this.ParseClassFields(t,s,!0)}}}else if(50===h||52===h){i=0,r||this.SaveComments();var d=t.ObjKind;0===d||1===d||(3===d||5===d||4===d?52!==this.FCurToken||r||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"destructor",18,p.ObjKindNames[t.ObjKind])):50===this.FCurToken?this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"constructor",18,p.ObjKindNames[t.ObjKind])):this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"destructor",18,p.ObjKindNames[t.ObjKind]))),this.ProcessMethod(t,r,s,!1)}else if(92===h||66===h)i=0,n=!1,r||(this.SaveComments(),1===t.ObjKind&&(this.NextToken(),3===this.FCurToken&&(this.NextToken(),n=14===this.FCurToken,this.UngetToken()),this.UngetToken())),n?(o=this.ParseMethodResolution(t),t.Members.Add(o),this.FEngine.FinishScope(12,o)):this.ProcessMethod(t,r,s,!1);else if(67===h){3 in this.GetCurrentModeSwitches()&&this.ParseExcSyntaxError(),r&&47===l&&this.ParseExcTokenError("Generic Class");var m=t.ObjKind;1===m||0===m||3===m||4===m||5===m||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"generic",18,p.ObjKindNames[t.ObjKind])),this.SaveComments(),i=0,this.NextToken(),47===this.FCurToken?(r=!0,this.NextToken()):r=!1,this.FCurToken in rtl.createSet(92,66)||this.ParseExcExpectedAorB("Procedure","Function"),this.ProcessMethod(t,r,s,!0)}else if(47===h){var C=t.ObjKind;1===C||0===C||3===C||4===C||5===C||7===C||8===C||9===C||2===C&&t.IsExternal||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"CLASS",18,p.ObjKindNames[t.ObjKind])),this.SaveComments(),i=0}else 94===h?(i=0,r||this.SaveComments(),this.ExpectIdentifier({}),a=this.ParseProperty(t,this.FCurTokenString,s,r),t.Members.Add(a),this.FEngine.FinishScope(12,a)):22===h&&47 in this.GetCurrentModeSwitches()?this.ParseAttributes(t,!0):this.CheckToken(3);l=this.FCurToken,this.NextToken()}},this.ProcessMethod=function(e,t,s,i){var r,n=null;r=this.GetProcTypeFromToken(this.FCurToken,t),n=this.ParseProcedureOrFunctionDecl(e,r,i,s),z.isPrototypeOf(n.FParent)?n.FParent.Overloads.Add(n):e.Members.Add(n),this.FEngine.FinishScope(5,n)},this.ReadGenericArguments=function(e,t){var s="",i=null,r=null,n=null;this.ExpectToken(18);do{if(s=this.ExpectIdentifier({}),i=this.CreateElement(fe,s,t),e.Add(i),this.NextToken(),16===this.FCurToken)do{this.NextToken();var l=this.FCurToken;47===l||96===l||50===l?(""===i.TypeConstraint&&(i.TypeConstraint=this.FCurTokenString),r=this.CreatePrimitiveExpr(i,0,this.CurTokenText()),i.AddConstraint(r),this.NextToken()):3===l||104===l?(n=this.ParseTypeReference(i,!1,{get:function(){return r},set:function(e){r=e}}),""===i.TypeConstraint&&(i.TypeConstraint=n.FName),i.AddConstraint(n)):this.CheckToken(3)}while(12===this.FCurToken);this.FEngine.FinishScope(3,i)}while(this.FCurToken in rtl.createSet(17,12));this.FCurToken in rtl.createSet(20,30)?30===this.FCurToken&&this.ChangeToken(20):this.ParseExcExpectedAorB(m.TokenInfos[12],m.TokenInfos[20])},this.ReadSpecializeArguments=function(e,t){var s=null;for(this.CheckToken(18);;)if(s=this.ParseType$1(e,this.CurTokenPos(),"",!1),t.Add(s),this.NextToken(),12!==this.FCurToken){if(103===this.FCurToken){this.ChangeToken(20);break}if(20===this.FCurToken)break;this.ParseExcExpectedAorB(m.TokenInfos[12],m.TokenInfos[20])}},this.ReadDottedIdentifier=function(e,t,s){var i="",r=C.$new();for(t.set(null),i=s?this.FCurTokenString:"",this.CheckToken(3),t.set(this.CreatePrimitiveExpr(e,0,this.FCurTokenString)),this.NextToken();14===this.FCurToken;)r.$assign(this.CurTokenPos()),this.ExpectIdentifier({}),s&&(i=i+"."+this.FCurTokenString),this.AddToBinaryExprChain(t,this.CreatePrimitiveExpr(e,0,this.FCurTokenString),27,r),this.NextToken();return i},this.ParseProcedureModifiers=function(e,t,s,i){var r=this;function n(){var e=!1,t="";return(e=3===r.FCurToken)&&(e="consoledevice"===(t=T(r.CurTokenText()))||"legacy"===t||de("base",t)>0||de("systrap",t)>0||de("sysv",t)>0),e}function l(){r.NextToken(),17!==r.FCurToken&&r.IsCurTokenHint$1()&&r.UngetToken()}var a=0,o=0,h=0,u=0,c="",p=0;for(a=0;;){if(a+=1,u=this.FCurToken,this.NextToken(),19===this.FCurToken&&s&&a<=3)return this.UngetToken(),void this.FEngine.FinishScope(6,t);if(17!==this.FCurToken)if(this.TokenIsCallingConvention(this.FCurTokenString,{get:function(){return p},set:function(e){p=e}}))t.CallingConvention=p,7===p&&(this.NextToken(),17===this.FCurToken?this.UngetToken():(6===this.FCurToken||n())&&(this.HandleProcedureModifier(e,12,!1),this.NextToken(),6!==this.FCurToken&&this.UngetToken())),s?(this.ExpectTokens(rtl.createSet(17,19)),19===this.FCurToken&&this.UngetToken()):i||this.ExpectTokens(rtl.createSet(17));else if(i&&this.TokenIsAnonymousProcedureModifier(e,this.FCurTokenString,{get:function(){return o},set:function(e){o=e}}))this.HandleProcedureModifier(e,o,!1);else if(this.TokenIsProcedureTypeModifier(e,this.FCurTokenString,{get:function(){return h},set:function(e){h=e}}))this.HandleProcedureTypeModifier(t,h),6===h&&_.isPrototypeOf(e)&&rtl.as(e,_).AddModifier(16);else if(s||i||!this.TokenIsProcedureModifier(e,this.FCurTokenString,{get:function(){return o},set:function(e){o=e}}))if(78!==this.FCurToken||s||i)if(!i&&this.DoCheckHint(t))l();else if(3!==this.FCurToken||i||0!==Y(this.CurTokenText(),"alias")){if(22!==this.FCurToken){if(17===u){this.UngetToken(),i&&this.ParseExcSyntaxError();break}if(i){this.UngetToken();break}this.CheckToken(17);continue}if(47 in this.GetCurrentModeSwitches()){this.UngetToken();break}do{this.NextToken(),this.TokenIsProcedureModifier(e,this.FCurTokenString,{get:function(){return o},set:function(e){o=e}})&&this.HandleProcedureModifier(e,o,!0),this.FCurToken in rtl.createSet(22,17)&&this.CheckToken(23)}while(23!==this.FCurToken);this.ExpectToken(17)}else this.ExpectToken(16),this.ExpectToken(4),_.isPrototypeOf(e)&&(rtl.as(e,_).AliasName=this.CurTokenText()),this.ExpectToken(17);else c=J(this.FCurTokenString),this.NextToken(),"NAME"!==c?(1 in t.FHints&&this.ParseExcSyntaxError(),t.FHints=rtl.unionSet(t.FHints,rtl.createSet(1))):(this.NextToken(),this.ExpectToken(17));else this.HandleProcedureModifier(e,o,!1);else i&&this.CheckToken(44)}},this.CheckProcedureArgs=function(t,s,i){var r=!1;if(this.NextToken(),8===this.FCurToken)r=!0,this.NextToken(),9!==this.FCurToken&&(this.UngetToken(),this.ParseArgList(t,s,9));else{r=!1;var n=i;if(2===n||3===n)this.ParseExc(2017,rtl.getResStr(e,"SParserExpectedLBracketColon"));else if(10===n||11===n){var l=this.FCurToken;3===l||44===l||114===l||48===l||110===l||92===l||66===l||43===l||16===l&&11===i?this.UngetToken():this.ParseExcTokenError("begin")}else{var a=this.FCurToken;17===a||16===a||86===a||76===a||3===a?this.UngetToken():this.ParseExcTokenError(";")}}return r},this.CheckVisibility=function(s,i,r){var n,l;if(this.FCurTokenEscaped)return!1;if((l="strict"===(s=T(this.FCurTokenString)))&&(this.NextToken(),s=T(this.FCurTokenString)),n=t.IsVisibility(s,i,r)){if(4===i.get()&&53 in this.FScanner.FCurrentModeSwitches&&i.set(3),l){var a=i.get();1===a?i.set(6):2===a?i.set(7):this.ParseExc$1(2009,rtl.getResStr(e,"SParserStrangeVisibility"),q(18,s))}}else l&&this.ParseExc(2008,rtl.getResStr(e,"SParserExpectVisibility"));return n},this.OpLevel=function(e){return 81===e||21===e||37===e||31===e?4:10===e||15===e||54===e||79===e||40===e||102===e||103===e||42===e||76===e?3:11===e||13===e||88===e||117===e?2:19===e||28===e||18===e||29===e||20===e||30===e||71===e?1:0},this.TokenToExprOp=function(t){var s=0;return 10===t?s=3:11===t?s=1:13===t?s=2:15===t?s=4:18===t?s=16:19===t?s=14:20===t?s=17:21===t?s=24:37===t?s=26:28===t?s=15:29===t?s=18:30===t?s=19:31===t?s=7:32===t?s=23:76===t?s=21:42===t?s=22:103===t?s=8:102===t?s=9:40===t?s=11:88===t?s=12:117===t?s=13:79===t?s=6:54===t?s=5:81===t?s=10:71===t?s=20:14===t?s=27:24===t?s=25:(s=1,this.ParseExc$1(2040,rtl.getResStr(e,"SParserNotAnOperand"),q(0,t,18,m.TokenInfos[t]))),s},this.CreateElement=function(e,t,s){return this.FEngine.CreateElement$2(e,t,s,0,this.CurSourcePos(),null)},this.CreateElement$1=function(e,t,s,i){return this.FEngine.CreateElement$2(e,t,s,0,i,null)},this.CreateElement$2=function(e,t,s,i){return this.FEngine.CreateElement$2(e,t,s,i,this.CurSourcePos(),null)},this.CreateElement$3=function(e,t,s,i,r,n){return 0===r.Row&&""===r.FileName?this.FEngine.CreateElement$2(e,t,s,i,this.CurSourcePos(),n):this.FEngine.CreateElement$2(e,t,s,i,r,n)},this.CreatePrimitiveExpr=function(e,t,s){var i=null;return(i=this.CreateElement$1(w,"",e,this.CurTokenPos())).Kind=t,i.Value=s,i},this.CreateBoolConstExpr=function(e,t,s){var i=null;return(i=this.CreateElement$1(Fe,"",e,this.CurTokenPos())).Kind=t,i.Value=s,i},this.CreateBinaryExpr$1=function(e,t,s,i,r){var n=null;return(n=this.CreateElement$1(me,"",e,r)).OpCode=i,n.Kind=9,null!==t&&(n.Left=t,t.SetParent(n)),null!==s&&(n.Right=s,s.SetParent(n)),n},this.AddToBinaryExprChain=function(e,t,s,i){null!==t&&(null===e.get()?e.set(t):e.set(this.CreateBinaryExpr$1(e.get().FParent,e.get(),t,s,i)))},this.CreateUnaryExpr=function(e,t,s){return this.CreateUnaryExpr$1(e,t,s,this.CurTokenPos())},this.CreateUnaryExpr$1=function(e,t,s,i){var r=null;return(r=this.CreateElement$1(Ce,"",e,i)).Kind=8,r.Operand=t,r.Operand.SetParent(r),r.OpCode=s,r},this.CreateArrayValues=function(e){var t=null;return(t=this.CreateElement(Se,"",e)).Kind=12,t},this.CreateFunctionType=function(e,t,s,i,r,n){return this.FEngine.CreateFunctionType(e,t,s,i,r,n)},this.CreateInheritedExpr=function(e){var t=null;return(t=this.CreateElement$1(Te,"",e,this.CurTokenPos())).Kind=13,t},this.CreateSelfExpr=function(e){var t=null;return(t=this.CreateElement$1(ye,"Self",e,this.CurTokenPos())).Kind=14,t},this.CreateNilExpr=function(e){var t=null;return(t=this.CreateElement$1(ge,"nil",e,this.CurTokenPos())).Kind=5,t},this.CreateRecordValues=function(e){var t=null;return(t=this.CreateElement(Ee,"",e)).Kind=12,t},this.IsCurTokenHint=function(t){var s=!1;return(s=78===this.FCurToken)?t.set(1):3===this.FCurToken&&(s=e.IsHintToken(this.FCurTokenString,t)),s},this.IsCurTokenHint$1=function(){var e=0;return this.IsCurTokenHint({get:function(){return e},set:function(t){e=t}})},this.TokenIsCallingConvention=function(t,s){return e.IsCallingConvention(t,s)};var l=rtl.createSet(5,6,14,15,16,17);this.TokenIsProcedureModifier=function(t,s,i){var r,n={};if(!(r=e.IsProcModifier(s,i)))return r;for(;null!==t;){if(Q.isPrototypeOf(t))return!(i.get()in rtl.createSet(10,13))&&((!(t.ObjKind in rtl.createSet(2,6))||(n=rtl.refSet(l),t.IsExternal&&(n=rtl.includeSet(n,12)),i.get()in n))&&r);if(te.isPrototypeOf(t))return i.get()in rtl.createSet(5,8,9,12,15,16,17)&&r;t=t.FParent}return r},this.TokenIsAnonymousProcedureModifier=function(t,s,i){var r=!1;return(r=e.IsProcModifier(s,i))?r=9===i.get():r},this.TokenIsProcedureTypeModifier=function(e,t,s){var i=!1;return 0===Y(t,p.ProcTypeModifiers[3])?(i=!0,s.set(3)):0===Y(t,p.ProcTypeModifiers[6])?(i=!0,s.set(6)):0===Y(t,p.ProcTypeModifiers[2])?(i=!0,s.set(2)):0===Y(t,p.ProcTypeModifiers[7])?(i=!0,s.set(7)):0===Y(t,p.ProcTypeModifiers[5])&&15 in this.FOptions?(i=!0,s.set(5)):i=!1,i},this.CheckHint=function(e,t){var s={},i=!1,r=0;s={};do{this.NextToken(),(i=this.IsCurTokenHint({get:function(){return r},set:function(e){r=e}}))&&(s=rtl.includeSet(s,r),0===r&&(this.NextToken(),4!==this.FCurToken?this.UngetToken():null!=e&&(e.FHintMessage=this.FCurTokenString)))}while(i);return this.UngetToken(),null!=e&&(e.FHints=rtl.refSet(s)),t&&this.ExpectToken(17),s},this.IsAnonymousProcAllowed=function(e){for(;Pe.isPrototypeOf(e);)e=e.FParent;return g.isPrototypeOf(e)},this.ParseParams=function(t,s,i){var r=null,n=null,l=0;if(s in rtl.createSet(11,4)?(22!==this.FCurToken&&this.ParseExc$1(2006,rtl.getResStr(e,"SParserExpectTokenError"),q(9,"[")),l=23):(8!==this.FCurToken&&this.ParseExc$1(2006,rtl.getResStr(e,"SParserExpectTokenError"),q(9,"(")),l=9),(r=this.CreateElement$1(Ie,"",t,this.CurTokenPos())).Kind=s,this.NextToken(),!this.isEndOfExp(!1,!1))do{null==(n=this.DoParseExpression(r,null,!0))&&this.ParseExcSyntaxError(),r.AddParam(n),16===this.FCurToken&&(i?(this.NextToken(),n.Format1=this.DoParseExpression(n,null,!0),16===this.FCurToken&&(this.NextToken(),n.Format2=this.DoParseExpression(n,null,!0))):this.ParseExc$1(2006,rtl.getResStr(e,"SParserExpectTokenError"),q(9,","))),this.FCurToken in rtl.createSet(12,l)||this.ParseExc$1(2006,rtl.getResStr(e,"SParserExpectTokenError"),q(9,",")),12===this.FCurToken&&(this.NextToken(),this.FCurToken===l&&this.ParseExcSyntaxError())}while(this.FCurToken!==l);return this.NextToken(),r};this.ParseExprOperand=function(e){var t=this,s=null;function i(e){var t=!1,s="";return(t=w.isPrototypeOf(e))&&(t="write"===(s=T(e.Value))||"str"===s||"writeln"===s||"writestr"===s),t}function r(e){var s=!1,i="";return(s=18 in t.FOptions&&w.isPrototypeOf(e))&&(s="mem"===(i=T(e.Value))||"meml"===i||"memw"===i),s}function n(){var e,s=0;function i(){return 32!==s&&(t.NextToken(),s+=1,true)}e=!1,s=0,t.CheckToken(18);try{if(i(),!(t.FCurToken in rtl.createSet(3,100)))return e;for(;i();){var r=t.FCurToken;if(14===r){if(!i())return e;if(!(t.FCurToken in rtl.createSet(3,100,108,61)))return e}else{if(12!==r)return 18===r||(20===r||e);if(!i())return e;if(!(t.FCurToken in rtl.createSet(3,100)))return e}}}finally{for(var n=1,l=s;n<=l;n++)t.UngetToken()}return e}var l,a=null,o=null,h=null,u=null,c=null,p=0,f="",d=null,F=C.$new(),m=C.$new(),S=0,y=null;s=null,p=0,f="";var g=this.FCurToken;if(7===g)a=this.CreatePrimitiveExpr(e,2,this.FCurTokenString);else if(4===g)a=this.CreatePrimitiveExpr(e,2,this.FCurTokenString);else if(5===g)a=this.CreatePrimitiveExpr(e,3,this.FCurTokenString);else if(6===g)a=this.CreatePrimitiveExpr(e,1,this.FCurTokenString);else if(3===g)p=3 in this.GetCurrentModeSwitches()?1:0,f=this.CurTokenText(),a=0!==Y(f,"self")||100 in this.FScanner.FNonTokens?this.CreatePrimitiveExpr(e,0,f):this.CreateSelfExpr(e);else if(104===g)p=2,this.ExpectToken(3),f=this.CurTokenText(),a=this.CreatePrimitiveExpr(e,0,f);else if(61===g||108===g)a=this.CreateBoolConstExpr(e,6,108===this.FCurToken);else if(80===g)a=this.CreateNilExpr(e);else if(22===g)a=this.ParseParams(e,4,!1),this.UngetToken();else if(72===g){if(a=this.CreateInheritedExpr(e),this.NextToken(),3===this.FCurToken)return F.$assign(this.CurTokenPos()),null==(c=this.CreateBinaryExpr$1(e,a,this.ParseExprOperand(e),0,F)).Right&&this.ParseExcExpectedIdentifier(),s=c;this.UngetToken()}else if(100===g)p=1,f=this.CurTokenText(),a=this.CreateSelfExpr(e);else{if(92===g||66===g)return this.IsAnonymousProcAllowed(e)||this.ParseExcExpectedIdentifier(),S=92===this.FCurToken?10:11,(y=this.CreateElement$2(Re,"",e,3)).Proc=this.ParseProcedureOrFunctionDecl(y,S,!1,0),this.FEngine.FinishScope(5,y.Proc),s=y;24===g?(this.NextToken(),1===this.CurTokenText().length&&this.CurTokenText().charCodeAt(0)in rtl.createSet(null,65,95)||(this.UngetToken(),this.ParseExcExpectedIdentifier()),a=this.CreatePrimitiveExpr(e,2,"^"+this.CurTokenText())):8===g?(this.NextToken(),null==(a=this.DoParseExpression(e,null,!0))&&this.ParseExcSyntaxError(),9!==this.FCurToken&&this.CheckToken(9)):this.ParseExcExpectedIdentifier()}l=3 in this.GetCurrentModeSwitches(),s=a,d=null,this.NextToken(),o=a;for(;;){var E=this.FCurToken;if(14===E)m.$assign(this.CurTokenPos()),this.NextToken(),104===this.FCurToken?(2===p&&this.CheckToken(18),p=2,this.NextToken()):p=3 in this.GetCurrentModeSwitches()?1:0,this.FCurToken in rtl.createSet(3,108,61,100)||l&&this.FCurToken>=39&&this.FCurToken<=117?(f=f+"."+this.FCurTokenString,h=this.CreatePrimitiveExpr(e,0,this.FCurTokenString),this.AddToBinaryExprChain({get:function(){return s},set:function(e){s=e}},h,27,m),o=h,this.NextToken()):(this.UngetToken(),this.ParseExcExpectedIdentifier());else if(8===E||22===E){if(null==(u=8===this.FCurToken?this.ParseParams(e,10,i(o)):this.ParseParams(e,11,r(o))))return s;u.Value=s,s.SetParent(u),s=u,p=0,o=null}else if(24===E)s=this.CreateUnaryExpr(e,s,this.TokenToExprOp(this.FCurToken)),this.NextToken(),p=0,o=null;else{if(18!==E)break;if(F.$assign(this.CurTokenPos()),0===p)break;if(1===p&&!n())break;9===(h=s).Kind?(27!==(c=h).OpCode&&this.ParseExcSyntaxError(),h=c.Right):c=null,0!==h.Kind&&this.ParseExcSyntaxError(),d=null!==c?this.CreateElement$1(ve,"",c,F):this.CreateElement$1(ve,"",e,F),this.ReadSpecializeArguments(d,d.Params),d.NameExpr=h,h.SetParent(d),null!==c?c.Right=d:s=d,d=null,p=0,this.NextToken(),o=null}}return s},this.DoParseClassType=function(e){var t="",s=null;if(3===this.FCurToken&&e.ObjKind in rtl.createSet(1,0)&&("sealed"!==(t=T(this.FCurTokenString))&&"abstract"!==t||(e.Modifiers.Add(t),this.NextToken())),e.IsForward=17===this.FCurToken,8===this.FCurToken){if(4===e.ObjKind&&rtl.eqSet(rtl.intersectSet(rtl.createSet(39,3),this.FScanner.FCurrentModeSwitches),rtl.createSet(3))&&this.CheckToken(58),this.NextToken(),e.AncestorType=this.ParseTypeReference(e,!1,{get:function(){return s},set:function(e){s=e}}),e.ObjKind in rtl.createSet(1,7,9)||2===e.ObjKind&&e.IsExternal)for(;12===this.FCurToken;)this.NextToken(),e.Interfaces.Add(this.ParseTypeReference(e,!1,{get:function(){return s},set:function(e){s=e}}));this.CheckToken(9),this.NextToken(),e.IsShortDefinition=17===this.FCurToken}e.ObjKind in p.okAllHelpers&&(this.CheckToken(65),this.NextToken(),e.HelperForType=this.ParseTypeReference(e,!1,{get:function(){return s},set:function(e){s=e}})),this.FEngine.FinishScope(13,e),e.IsShortDefinition||e.IsForward?this.UngetToken():(e.ObjKind in rtl.createSet(2,6)&&22===this.FCurToken&&(this.NextToken(),e.GUIDExpr=this.DoParseExpression(e,null,!0),23!==this.FCurToken&&this.ParseExcTokenError(m.TokenInfos[23]),this.NextToken()),this.ParseClassMembers(e))},this.DoParseClassExternalHeader=function(t,s,i){var r=!1;if(r=!1,(t in rtl.createSet(8,7,9)||t in rtl.createSet(1,2)&&52 in this.GetCurrentModeSwitches())&&this.CurTokenIsIdentifier("external")){if(r=!0,this.NextToken(),17===this.FCurToken)return r;if(4!==this.FCurToken?this.UngetToken():s.set(this.FCurTokenString),t in rtl.createSet(8,7)){if(this.NextToken(),8===this.FCurToken)return r;this.UngetToken()}this.ExpectIdentifier({}),this.CurTokenIsIdentifier("Name")||this.ParseExc(2051,rtl.getResStr(e,"SParserExpectedExternalClassName")),this.NextToken(),this.FCurToken in rtl.createSet(7,4)||this.CheckToken(4),i.set(this.FCurTokenString),this.NextToken()}else s.set(""),i.set("");return r},this.DoParseArrayType=function(t){var s="",i=null;this.NextToken(),s="";var r=this.FCurToken;if(22===r){for(Ae.isPrototypeOf(t.FParent)&&this.ParseExcTokenError("of");;){if(this.NextToken(),7 in this.FOptions?(i=this.DoParseExpression(t,null,!0),t.AddRange(i)):23!==this.FCurToken&&(s+=this.CurTokenText()),23===this.FCurToken)break;12!==this.FCurToken&&(7 in this.FOptions&&this.ParseExcTokenError("]"))}t.IndexRange=s,this.ExpectToken(86),t.ElType=this.ParseType$1(t,this.CurSourcePos(),"",!1)}else 86===r?(this.NextToken(),48===this.FCurToken?Ae.isPrototypeOf(t.FParent)||this.ParseExcExpectedIdentifier():(41===this.FCurToken&&Ae.isPrototypeOf(t.FParent)&&this.ParseExcExpectedIdentifier(),this.UngetToken(),t.ElType=this.ParseType$1(t,this.CurSourcePos(),"",!1))):this.ParseExc(2024,rtl.getResStr(e,"SParserArrayTypeSyntaxError"));X.isPrototypeOf(t.ElType)&&t.ElType.FParent===t&&this.UngetToken()};var o=rtl.recNewT(null,"",function(){this.Token=0,this.$new=function(){var e=Object.create(this);return e.SrcPos=C.$new(),e},this.$eq=function(e){return this.Token===e.Token&&this.SrcPos.$eq(e.SrcPos)},this.$assign=function(e){return this.Token=e.Token,this.SrcPos.$assign(e.SrcPos),this}}),u=rtl.createSet(11,13,81,21,37),f=rtl.createSet(10,15,54,79,26,40,102,103,42,31,11,13,88,117,32,19,28,18,29,20,30,71,76);this.DoParseExpression=function(e,t,s){var i=this,r=null,n=null,l=[],a=0,c=0,p=null,d=0,F=!1;function S(){var e=null;return n.FCount>0?(e=rtl.getObject(n.Get(n.FCount-1)),n.Delete(n.FCount-1)):e=null,e}function T(e){(a+=1)===rtl.length(l)&&(l=rtl.arraySetLength(l,o,2*rtl.length(l)+4)),l[a].Token=e,l[a].SrcPos.$assign(i.CurTokenPos())}function y(){return a>=0?l[a].Token:0}function g(e){var t;return 0===(t=y())?e.$assign(m.DefPasSourcePos):(e.$assign(l[a].SrcPos),a-=1),t}function E(){var t,s,r,l=null,a=C.$new();t=g(a),s=S(),r=S(),26===t?(l=i.CreateBinaryExpr$1(e,r,s,0,a)).Kind=7:l=i.CreateBinaryExpr$1(e,r,s,i.TokenToExprOp(t),a),n.Add(l)}var P={},I=C.$new();P=rtl.refSet(f),s||(P=rtl.excludeSet(P,19)),r=null,n=h.$create("Create"),l=rtl.arraySetLength(l,o,4),a=-1;try{do{if(F=!0,c=0,null==t){for(;this.FCurToken in u;)T(this.FCurToken),c+=1,this.NextToken();null==(p=this.ParseExprOperand(e))&&this.ParseExcSyntaxError(),n.Add(p);for(var R=1,v=c;R<=v;R++)d=g(I),p=S(),13===d&&7===p.Kind?(p.Left=this.CreateUnaryExpr$1(p,p.Left,2,I),n.Add(p)):n.Add(this.CreateUnaryExpr$1(e,p,this.TokenToExprOp(d),I))}else n.Add(t),t=null;if(this.FCurToken in P){for(F=!1,d=y();a>=0&&this.OpLevel(d)>=this.OpLevel(this.FCurToken);)E(),d=y();T(this.FCurToken),this.NextToken()}}while(!F&&!this.isEndOfExp(s,F));for(F||this.ParseExcExpectedIdentifier();a>=0;)E();1!==n.FCount&&this.ParseExcSyntaxError(),(r=rtl.getObject(n.Get(0))).SetParent(e)}finally{l=rtl.arraySetLength(l,o,0),n=rtl.freeLoc(n)}return r},this.DoParseConstValueExpression=function(s){var i=this,r=null;function n(){var e=!1;return(e=17!==i.FCurToken)||(i.NextToken(),9===i.FCurToken?e=!0:i.UngetToken()),e}function l(e){var t=null;r=null,t=i.CreateArrayValues(s),null!==e&&(t.AddValues(e),e=null);do{i.NextToken(),t.AddValues(i.DoParseConstValueExpression(t))}while(12===i.FCurToken);r=t}var a=null,o=null,h="",u=null;if(8!==this.FCurToken)r=this.DoParseExpression(s,null,!0);else{if(r=null,this.FEngine.NeedArrayValues(s))l(null);else{if(this.NextToken(),9===this.FCurToken)return r=this.CreateRecordValues(s),this.NextToken(),r;a=this.DoParseConstValueExpression(s);var c=this.FCurToken;if(12===c)l(a);else{if(16!==c)return r=this.DoParseExpression(s,a,!0),9!==this.FCurToken&&this.ParseExc(2011,rtl.getResStr(e,"SParserExpectedCommaRBracket")),this.NextToken(),17!==this.FCurToken&&(r=this.DoParseExpression(s,r,!0)),r;if(w.isPrototypeOf(a)||this.CheckToken(9),h=t.GetExprIdent(a),u=this.CreateRecordValues(s),this.NextToken(),o=this.DoParseConstValueExpression(u),u.AddField(a,o),a=null,!n())do{h=this.ExpectIdentifier({}),a=this.CreatePrimitiveExpr(u,0,h),this.ExpectToken(16),this.NextToken(),o=this.DoParseConstValueExpression(s),u.AddField(a,o),a=null}while(!n());r=u}}9!==this.FCurToken&&this.ParseExc(2011,rtl.getResStr(e,"SParserExpectedCommaRBracket")),this.NextToken()}return r},this.CheckPackMode=function(){var e=0;this.NextToken();var t=this.FCurToken;return 0!==(e=90===t?1:45===t?2:0)&&(this.NextToken(),this.FCurToken in rtl.createSet(41,96,85,47,83,101)||this.ParseExcTokenError("SET, ARRAY, RECORD, OBJECT or CLASS")),e},this.AddUseUnit=function(t,s,i,r,n){var l=this,a=null;function o(t){if(0!==rtl.length(t))for(var s=0,r=rtl.length(t)-1;s<=r;s++)0===Y(i,t[s].FName)&&l.ParseExc$1(2046,rtl.getResStr(e,"SParserDuplicateIdentifier"),q(18,i))}var h,u=null;if(a=null,null,u=null,0===Y(i,this.FCurModule.FName)&&!this.FCurModule.$class.InheritsFrom(Ne)){if(0===Y(i,"System"))return a;this.ParseExc$1(2046,rtl.getResStr(e,"SParserDuplicateIdentifier"),q(18,i))}return o(t.UsesClause),t.$class.ClassType()===xe&&o(this.FCurModule.InterfaceSection.UsesClause),null==(u=this.FEngine.FindModule$1(i,r,n))&&(u=this.CreateElement$1(be,i,t,s)),h=this.CreateElement$1(Oe,i,t,s),a=t.AddUnitToUsesList(i,r,n,u,h),null!==n&&(ke.isPrototypeOf(u)?""===u.Filename&&(u.Filename=n.Value):be.isPrototypeOf(u)&&(u.FileName=n.Value)),a},this.CheckImplicitUsedUnits=function(e){var t=0,s=C.$new();if(e.$class.ClassType()!==xe){s.$assign(this.CurSourcePos());for(var i=0,r=this.FImplicitUses.GetCount()-1;i<=r;i++)t=i,this.AddUseUnit(e,s,this.FImplicitUses.Get(t),null,null)}},this.FinishedModule=function(){null!==this.FScanner&&this.FScanner.FinishedModule(),this.FEngine.FinishScope(0,this.FCurModule)},this.ParseExcExpectedIdentifier=function(){this.ParseExc(2026,rtl.getResStr(e,"SParserExpectedIdentifier"))},this.ParseExcSyntaxError=function(){this.ParseExc(2022,rtl.getResStr(e,"SParserSyntaxError"))},this.ParseExcTypeParamsNotAllowed=function(){this.ParseExc$1(2045,rtl.getResStr(e,"SParserTypeParamsNotAllowedOnType"),[])},this.ParseExc=function(e,t){this.ParseExc$1(e,t,[])},this.ParseExc$1=function(t,i,r){var n,l=C.$new();throw this.SetLastMsg(1,t,i,r),l.$assign(this.FScanner.FCurTokenPos),""===l.FileName&&l.$assign(this.FScanner.CurSourcePos()),0===l.Row&&(l.Row=1,l.Column=1),n=$e(rtl.getResStr(e,"SParserErrorAtToken"),q(18,this.FLastMsg,18,this.CurTokenName(),18,l.FileName,19,l.Row,19,l.Column)),s.$create("Create$2",[n,l.FileName,l.Row,l.Column,t])},this.ParseExcTokenError=function(t){this.ParseExc$1(2006,rtl.getResStr(e,"SParserExpectTokenError"),q(18,t))},this.ParseExcExpectedAorB=function(t,s){this.ParseExc$1(2010,rtl.getResStr(e,"SParserExpectToken2Error"),q(18,t,18,s))},this.LogLastMessage=function(){this.DoLog(this.FLastMsgType,this.FLastMsgNumber,this.FLastMsg,!1)},this.CreateRecovery=function(e,t,s){var r=i.$new();return r.$assign(i.Create(null,e,rtl.refSet(t),s)),r},this.CreateRecovery$2=function(e,t,s,r,n){var l=i.$new();return l.$assign(i.Create$1(e,t,rtl.refSet(s),r,n)),l},this.TryErrorRecovery=function(e){var t=!1,s={},i=null;if(this.FErrorCount+=1,!(t=this.FErrorCount<this.FMaxErrorCount))return t;if(null!=this.FOnError&&(this.FOnError(this,e,{get:function(){return t},set:function(e){t=e}}),!t))return t;if(e.HaveScope&&this.FEngine.FinishScope(e.Scope,e.Element),null!=e.Element&&this.FEngine.HandleResultOnError(e.Element)&&(i=e.Element,i=rtl.freeLoc(i)),this.LogLastMessage(),s=rtl.refSet(e.RestartTokens),rtl.neSet(s,{})){if(!(this.FCurToken in s)){s=rtl.includeSet(s,0);do{this.NextToken()}while(!(this.FCurToken in s))}e.UngetRestartToken&&this.UngetToken()}return t},this.AddProcOrFunction=function(e,t){var s=0,i=null,r=null;i=null,null!==(r=5 in this.FOptions?null:this.CheckOverloadList(e.Functions,t.FName,{get:function(){return i},set:function(e){i=e}}))?(r.Overloads.Add(t),i!==r&&-1!==(s=e.Declarations.IndexOf(i))&&e.Declarations.Put(s,r)):(e.Declarations.Add(t),e.Functions.Add(t)),this.FEngine.FinishScope(5,t)},this.CheckIfOverloaded=function(e,t){var s=null,i=null,r=null;return s=e,!(5 in this.FOptions)&&H.isPrototypeOf(e)&&null!==(r=this.CheckOverloadList(e.Members,t,{get:function(){return i},set:function(e){i=e}}))&&(s=r),s},this.Create$1=function(e,t,s){return a.Create.call(this),this.FScanner=e,null===this.FScanner.FOnModeChanged&&(this.FScanner.FOnModeChanged=rtl.createCallback(this,"OnScannerModeChanged")),this.FScanner.RegisterDirectiveHandler("rtti",rtl.createCallback(this,"OnScannerDirectiveRTTI")),this.FFileResolver=t,this.FTokenRingCur=31,this.FEngine=s,null!=this.FEngine&&(this.FEngine.SetCurrentParser(this),this.FEngine.FNeedComments&&(this.FScanner.FSkipComments=!this.FEngine.FNeedComments)),this.FErrorCount=0,this.FMaxErrorCount=1,this.FFailOnModuleErors=!0,this.FImplicitUses=De.$create("Create$1"),this.FImplicitUses.Add("System"),this},this.Destroy=function(){var e=0;for(rtl.eqCallback(this.FScanner.FOnModeChanged,rtl.createCallback(this,"OnScannerModeChanged"))&&(this.FScanner.FOnModeChanged=null),null!=this.FEngine&&(this.FEngine.SetCurrentParser(null),this.FEngine=null),c({p:this,get:function(){return this.p.FImplicitUses},set:function(e){this.p.FImplicitUses=e}}),e=0;e<=31;e++)c({p:this.FTokenRing[e],get:function(){return this.p.Comments},set:function(e){this.p.Comments=e}});a.Destroy.call(this)},this.SetLastMsg=function(e,t,s,i){this.FLastMsgType=e,this.FLastMsgNumber=t,this.FLastMsgPattern=s,this.FLastMsg=$e(s,i),Le({p:this,get:function(){return this.p.FLastMsgArgs},set:function(e){this.p.FLastMsgArgs=e}},i)},this.CurTokenName=function(){return 3===this.FCurToken?"Identifier "+this.FCurTokenString:m.TokenInfos[this.FCurToken]},this.CurTokenText=function(){var e=this.FCurToken;return 3===e||4===e||5===e||6===e||7===e?this.FCurTokenString:m.TokenInfos[this.FCurToken]},this.CurComments=function(){return this.FTokenRingStart===this.FTokenRingEnd?null:this.FTokenRing[this.FTokenRingCur].Comments},this.CurTokenPos=function(){var e=C.$new();return this.HasToken()?e.$assign(this.FTokenRing[this.FTokenRingCur].TokenPos):null!==this.FScanner?e.$assign(this.FScanner.FCurTokenPos):e.$assign(C.$new()),e},this.CurSourcePos=function(){var e=C.$new();return this.HasToken()?e.$assign(this.FTokenRing[this.FTokenRingCur].SourcePos):null!==this.FScanner?e.$assign(this.FScanner.CurSourcePos()):e.$assign(C.$new()),e},this.HasToken=function(){return this.FTokenRingStart<this.FTokenRingEnd?this.FTokenRingCur>=this.FTokenRingStart&&this.FTokenRingCur<this.FTokenRingEnd:this.FTokenRingCur>=this.FTokenRingStart||this.FTokenRingCur<this.FTokenRingEnd},this.NextToken=function(){var e=null;if(this.FTokenRingCur=(this.FTokenRingCur+1)%32,e=this.FTokenRing[this.FTokenRingCur],this.FTokenRingCur!==this.FTokenRingEnd)this.FCurToken=this.FScanner.CheckToken(e.Token,e.AsString),this.FCurTokenString=e.AsString,this.FCurTokenEscaped=e.IsEscaped;else{this.FTokenRingEnd=(this.FTokenRingEnd+1)%32,this.FTokenRingStart===this.FTokenRingEnd&&(this.FTokenRingStart=(this.FTokenRingStart+1)%32);try{null===e.Comments?e.Comments=De.$create("Create$1"):e.Comments.Clear();do{this.FCurToken=this.FScanner.FetchToken(),2===this.FCurToken&&e.Comments.Add(this.FScanner.GetTokenString())}while(this.FCurToken in t.WhitespaceTokensToIgnore)}catch(e){if(Be.isPrototypeOf(e)){var i=e;throw 1 in this.FOptions?e:(this.FLastMsgType=1,this.FLastMsgNumber=this.FScanner.FLastMsgNumber,this.FLastMsgPattern=this.FScanner.FLastMsgPattern,this.FLastMsg=this.FScanner.FLastMsg,this.FLastMsgArgs=this.FScanner.FLastMsgArgs,s.$create("Create$2",[i.fMessage,this.FScanner.FCurFilename,this.FScanner.FCurRow,this.FScanner.GetCurColumn(),this.FLastMsgNumber]))}throw e}this.FCurTokenString=this.FScanner.GetTokenString(),this.FCurTokenEscaped=this.FScanner.FCurtokenEscaped,e.Token=this.FCurToken,e.AsString=this.FCurTokenString,e.SourcePos.$assign(this.FScanner.CurSourcePos()),e.TokenPos.$assign(this.FScanner.FCurTokenPos),e.IsEscaped=this.FScanner.FCurtokenEscaped}},this.ChangeToken=function(e){var t,s=this,i=null,r=null;function n(e,t){(i=s.FTokenRing[s.FTokenRingCur]).Token=t,i.AsString=m.TokenInfos[t],(r=s.FTokenRing[s.FTokenRingEnd]).Token=t,r.AsString=m.TokenInfos[t],null!==r.Comments&&r.Comments.Clear(),r.SourcePos.$assign(i.SourcePos),i.SourcePos.Column-=1,r.TokenPos.$assign(i.TokenPos),r.TokenPos.Column+=1,s.FTokenRingEnd=(s.FTokenRingEnd+1)%32,s.FTokenRingStart===s.FTokenRingEnd&&(s.FTokenRingStart=(s.FTokenRingStart+1)%32),s.FCurToken=e,s.FCurTokenString=m.TokenInfos[e]}t=(this.FTokenRingCur+1)%32===this.FTokenRingEnd,30===this.FCurToken&&20===e&&t?n(20,19):103===this.FCurToken&&20===e&&t?n(20,20):this.CheckToken(e)},this.UngetToken=function(){var t;this.FTokenRingStart===this.FTokenRingEnd&&this.ParseExc(2005,rtl.getResStr(e,"SParserUngetTokenError")),this.FTokenRingCur>0?this.FTokenRingCur-=1:this.FTokenRingCur=31,t=this.FTokenRing[this.FTokenRingCur],this.FCurToken=t.Token,this.FCurTokenString=t.AsString},this.CheckToken=function(e){this.FCurToken!==e&&this.ParseExcTokenError(m.TokenInfos[e])},this.CheckTokens=function(e){var t="",s=0;if(!(this.FCurToken in e)){t="";for(var i=0;i<=119;i++)(s=i)in e&&(""!==t&&(t+=" or "),t+=m.TokenInfos[s]);this.ParseExcTokenError(t)}},this.ExpectToken=function(e){this.NextToken(),this.CheckToken(e)},this.ExpectTokens=function(e){this.NextToken(),this.CheckTokens(rtl.refSet(e))},this.GetPrevToken=function(){var e=0;return this.FTokenRingStart===this.FTokenRingEnd&&0,(e=this.FTokenRingCur)>0?e-=1:e=31,this.FTokenRing[e].Token},this.ExpectIdentifier=function(e){return rtl.eqSet(e,{})?this.ExpectToken(3):(e=rtl.includeSet(e,3),this.ExpectTokens(rtl.refSet(e))),this.FCurTokenString},this.SaveIdentifierPosition=function(){this.FIdentifierPos.$assign(this.FScanner.CurSourcePos())},this.CurTokenIsIdentifier=function(e){return 3===this.FCurToken&&0===Y(e,this.CurTokenText())};var vt=rtl.createSet(0,9,23,17,12,16,55,56,57,58,86,105,107,89);this.isEndOfExp=function(e,t){return!!(this.FCurToken in vt||t&&this.IsCurTokenHint$1())||(!(!e||19!==this.FCurToken)||false)},this.ExprToText=function(t){var s,i="";if(i="",(s=t.$class.ClassType())===w)i=t.Value;else if(s===ye)i="self";else if(s===Fe)i=Me(t.Value,"true","false");else if(s===ge)i="nil";else if(s===Te)i="inherited";else if(s===Ce)i=p.OpcodeStrings[t.OpCode]+this.ExprToText(t.Operand);else if(s===me)i=this.ExprToText(t.Left),""!==p.OpcodeStrings[t.OpCode]?i+=p.OpcodeStrings[t.OpCode]:i+=" ",i+=this.ExprToText(t.Right);else if(s===Ie){var r=t.Kind;11===r?i=this.ExprToText(t.Value)+"["+this.ArrayExprToText(t.Params)+"]":10===r?i=this.ExprToText(t.Value)+"("+this.ArrayExprToText(t.Params)+")":4===r?i="["+this.ArrayExprToText(t.Params)+"]":this.ParseExc$1(2015,rtl.getResStr(e,"SErrUnknownOperatorType"),q(18,p.ExprKindNames[t.Kind]))}else this.ParseExc$1(2015,rtl.getResStr(e,"SErrUnknownOperatorType"),q(18,"TPasParser.ExprToText: "+t.$classname));return i},this.ArrayExprToText=function(e){var t="",s=0;t="";for(var i=0,r=rtl.length(e)-1;i<=r;i++)(s=i)>0&&(t+=","),t+=this.ExprToText(e[s]);return t},this.ResolveTypeReference=function(s,i,r){var n=null;return n=null,!(3 in this.FOptions)&&t.IsSimpleTypeToken({get:function(){return s},set:function(e){s=e}})||null===(n=this.FEngine.FindElementFor(s,i,r))||Ge.isPrototypeOf(n)||this.ParseExc$1(2049,rtl.getResStr(e,"SParserExpectedTypeButGot"),q(18,n.ElementTypeName())),null===n?this.CreateElement(we,s,i):n},this.ParseVarType=function(e){var t=null,s=C.$new();t=null,this.NextToken();var i=this.FCurToken;return 92===i?(t=this.CreateElement(X,"",e),this.ParseProcedureOrFunction(t,t,0,!0),17===this.FCurToken&&this.UngetToken()):66===i?(t=this.CreateFunctionType("","Result",e,!1,this.CurSourcePos(),null),this.ParseProcedureOrFunction(t,t,1,!0),17===this.FCurToken&&this.UngetToken()):(s.$assign(this.CurSourcePos()),this.UngetToken(),t=this.ParseType$1(e,s,"",!1)),t},this.ParseTypeDecl=function(e){return this.ParseTypeDecl$1(e,C.$clone(this.CurSourcePos()))},this.ParseTypeDecl$1=function(e,t){var s=null,i="",r=!1,n=!1;try{r=this.FScanner.SetForceCaret(!0),n=!1,3 in this.GetCurrentModeSwitches()&&(this.NextToken(),n=18===this.FCurToken,this.UngetToken()),n?s=this.ParseGenericTypeDecl(e,!1):(i=this.FCurTokenString,this.ExpectToken(19),s=this.ParseType$1(e,t,i,!0))}finally{this.FScanner.SetForceCaret(r)}return s},this.ParseGenericTypeDecl=function(e,t){var s=this,i=null;function r(s,r){i=s,t&&(Ve.isPrototypeOf(e)?e.Declarations.Add(s):H.isPrototypeOf(e)&&e.Members.Add(s)),r.FCount>0&&s.SetGenericTemplates(r)}function n(i,n,l,a){var o=null,h=0;o=null,h=0;var u=s.FCurToken;66===u?(o=s.CreateFunctionType(i,"Result",e,!1,n,l),h=1):92===u?(o=s.CreateElement$3(X,i,e,0,n,l),h=0):s.ParseExcTokenError("procedure or function"),o.SetIsReference(a),t&&Ve.isPrototypeOf(e)&&e.Functions.Add(o),r(o,l),s.ParseProcedureOrFunction(o,o,h,!0)}var l,a="",o="",u=C.$new(),c=null,p=null,f=null,d=null,F=0;i=null,l=this.FCurTokenString,u.$assign(this.CurSourcePos()),c=h.$create("Create");try{this.ReadGenericArguments(c,e),this.ExpectToken(19),this.NextToken();var m=this.FCurToken;if(85===m||47===m||75===m){var S=this.FCurToken;F=85===S?0:75===S?2:1,this.NextToken(),1===F&&86===this.FCurToken&&this.ParseExcExpectedIdentifier(),this.DoParseClassExternalHeader(F,{get:function(){return a},set:function(e){a=e}},{get:function(){return o},set:function(e){o=e}}),(p=this.CreateElement$3(Q,l,e,0,u,c)).ObjKind=F,2===F&&Ue(this.FScanner.GetCurrentValueSwitch(0),"CORBA")&&(p.InterfaceType=1),t&&Ve.isPrototypeOf(e)&&e.Classes.Add(p),p.IsExternal=""!==o,""!==o&&(p.ExternalName=Je(o,"'")),""!==a&&(p.ExternalNameSpace=Je(a,"'")),p.IsExternal||p.RTTIVisibility.$assign(this.RTTIVisibility),r(p,c),this.DoParseClassType(p),this.CheckHint(p,!0),this.FEngine.FinishScope(3,p)}else 96===m?((f=this.CreateElement$3(te,l,e,0,u,c)).RTTIVisibility.$assign(this.RTTIVisibility),t&&Ve.isPrototypeOf(e)&&e.Classes.Add(f),r(f,c),this.NextToken(),this.ParseRecordMembers(f,58,34 in this.FScanner.FCurrentModeSwitches&&!je.isPrototypeOf(e)&&""!==f.FName),this.CheckHint(f,!0),this.FEngine.FinishScope(3,f)):41===m?(d=this.CreateElement$3(He,l,e,0,u,c),t&&Ve.isPrototypeOf(e)&&e.Types.Add(d),r(d,c),this.DoParseArrayType(d),this.CheckHint(d,!0),this.FEngine.FinishScope(3,d)):92===m||66===m?n(l,u,c,!1):3===m&&this.CurTokenIsIdentifier("reference")?(this.NextToken(),this.CheckToken(107),this.NextToken(),n(l,u,c,!0)):this.ParseExcTypeParamsNotAllowed()}finally{c=rtl.freeLoc(c)}return i};var At=rtl.createSet(67,83,75,84,53,110),Nt=rtl.createSet(92,66),xt=[2,9],bt=[1,7,8,3],Ot=rtl.createSet(3,41,104,62);this.ParseType=function(t,s,i,r){var n,l=null,a=!1,o=!1,h=0;l=null,n=this.CheckPackMode(),1===r?a=!(this.FCurToken in Nt):(a=!1,this.FCurToken in At&&this.ParseExc$1(2039,rtl.getResStr(e,"SParserTypeNotAllowedHere"),q(18,this.CurTokenText()))),this.FCurToken in Ot||!Ae.isPrototypeOf(t)&&!d.isPrototypeOf(t)||this.ParseExc(2025,rtl.getResStr(e,"SParserParamsOrResultTypesNoLocalTypeDefs"));var u=this.FCurToken;return 85===u?l=this.ParseClassDecl(t,s,i,0,n):53===u?l=this.ParseClassDecl(t,s,i,6,n):84===u||75===u?l=this.ParseClassDecl(t,s,i,xt[+(84===this.FCurToken)],n):104===u?l=this.ParseSimpleType(t,this.CurSourcePos(),i,!1):83===u||82===u||47===u?(83===this.FCurToken?h=1:82===this.FCurToken?h=2:(h=0,this.NextToken(),1!==r&&86!==this.FCurToken&&this.ParseExc$1(2039,rtl.getResStr(e,"SParserTypeNotAllowedHere"),q(18,this.CurTokenText())),this.CurTokenIsIdentifier("Helper")&&(this.NextToken(),this.FCurToken in rtl.createSet(65,8)&&(h=3),this.UngetToken()),this.UngetToken()),l=this.ParseClassDecl(t,s,i,bt[h],n)):110===u?(o=!1,39 in this.FScanner.FCurrentModeSwitches&&(this.NextToken(),this.CurTokenIsIdentifier("helper")&&(this.NextToken(),o=this.FCurToken in rtl.createSet(65,8),this.UngetToken()),this.UngetToken()),l=o?this.ParseClassDecl(t,s,i,5,n):this.ParseAliasType(t,s,i)):3===u?this.CurTokenIsIdentifier("reference")&&!We.isPrototypeOf(t)?(a=!1,l=this.ParseReferenceToProcedureType(t,s,i)):l=this.ParseSimpleType(t,s,i,1===r):24===u?l=this.ParsePointerType(t,s,i):62===u?l=this.ParseFileType(t,s,i):41===u?l=this.ParseArrayType(t,s,i,n):8===u?l=this.ParseEnumType(t,s,i):101===u?l=this.ParseSetType(t,s,i,1===n):92===u?l=this.ParseProcedureType(t,s,i,0):66===u?l=this.ParseProcedureType(t,s,i,1):96===u?(this.NextToken(),o=!1,this.CurTokenIsIdentifier("Helper")&&(this.NextToken(),o=this.FCurToken in rtl.createSet(65,8),this.UngetToken()),this.UngetToken(),l=o?this.ParseClassDecl(t,s,i,4,n):this.ParseRecordDecl(t,s,i,n)):6===u||13===u||7===u?(this.UngetToken(),l=this.ParseRangeType(t,s,i,1===r)):this.ParseExcExpectedIdentifier(),a&&this.CheckHint(l,!0),l};var kt=[0,1];this.ParseType$1=function(e,t,s,i){return this.ParseType(e,t,s,kt[+i])},this.ParseReferenceToProcedureType=function(e,t,s){var i=null;this.CurTokenIsIdentifier("reference")||this.ParseExcTokenError("reference"),this.ExpectToken(107),this.NextToken();var r=this.FCurToken;return 92===r?i=this.ParseProcedureType(e,t,s,0):66===r?i=this.ParseProcedureType(e,t,s,1):(i=null,this.ParseExcTokenError("procedure or function")),i.SetIsReference(!0),i},this.ParseProcedureType=function(e,t,s,i){var r=null;return r=i in rtl.createSet(1,7)?this.CreateFunctionType(s,"Result",e,!1,t,null):this.CreateElement$1(X,s,e,t),this.ParseProcedureOrFunction(r,r,i,!0),r},this.ParseStringType=function(e,t,s){var i=null,r="",n="",l=null,a=null,o=null;return""===(i=this.CreateElement$1(Ye,s,e,t)).FName&&(i.FName="string"),i.Expr=this.CreatePrimitiveExpr(i,0,s),this.NextToken(),n="",22===this.FCurToken?((l=this.CreateElement(Ie,"",i)).Value=i.Expr,l.Value.SetParent(l),i.Expr=l,n="",this.NextToken(),o=this.DoParseExpression(l,null,!1),l.AddParam(o),this.CheckToken(23),n=this.ExprToText(o)):8===this.FCurToken?(r="",this.NextToken(),a=this.DoParseExpression(i,null,!1),i.CodepageExpr=a,this.CheckToken(9),r=this.ExprToText(a)):this.UngetToken(),i.DestType=this.CreateElement(ze,"string",i),i.DestType.LengthExpr=n,i.DestType.CodePageExpr=r,i};this.ParseSimpleType=function(e,t,s,i){var r,n=null,l=null,a=0,o="",h=null,u=!1;if(n=null,104===this.FCurToken?(u=!0,this.ExpectIdentifier({})):u=!1,o=this.FCurTokenString,h=null,l=null,i)o=this.ReadDottedIdentifier(e,{get:function(){return h},set:function(e){h=e}},!0);else for(this.NextToken();14===this.FCurToken;)this.ExpectIdentifier({}),o=o+"."+this.FCurTokenString,this.NextToken();if(r=T(o),u&&18!==this.FCurToken&&this.ParseExcTokenError("<"),i&&17===this.FCurToken||this.IsCurTokenHint$1())a=0,this.UngetToken();else if(i&&22===this.FCurToken)"string"===r?a=1:this.ParseExcSyntaxError(),this.UngetToken();else{if(18===this.FCurToken&&(u||3 in this.GetCurrentModeSwitches()))return n=this.ParseSpecializeType(e,t,s,o,{get:function(){return h},set:function(e){h=e}});this.FCurToken in rtl.createSet(8,26)?(a="string"===r||"ansistring"===r?1:2,this.UngetToken()):(i&&this.ParseExcTokenError(";"),a=0,3 in this.FOptions||"string"!==T(o)||(a=1),this.UngetToken())}var c=a;return 1===c?(h=null,n=this.ParseStringType(e,t,s)):2===c?(h=null,this.UngetToken(),n=this.ParseRangeType(e,t,s,!1)):0===c&&(l=this.ResolveTypeReference(o,e,0),i?((n=this.CreateElement$1(Ye,s,e,t)).DestType=l,l=null,n.Expr=h,h.SetParent(n),h=null,""!==s&&this.FEngine.FinishScope(3,n)):n=l),n},this.ParseAliasType=function(e,t,s){var i=null;return(i=this.CreateElement$1(_e,s,e,t)).DestType=this.ParseType$1(i,t,"",!1),this.FEngine.FinishTypeAlias({get:function(){return i},set:function(e){i=e}}),this.FEngine.FinishScope(3,i),i},this.ParseTypeReference=function(e,t,s){var i=null,r="",n=!1,l=!1,a=C.$new();i=null,s.set(null),l=!1;try{a.$assign(this.CurSourcePos()),104===this.FCurToken?(n=!0,this.NextToken()):n=!1,this.CheckToken(3),r=this.ReadDottedIdentifier(e,s,!0),18===this.FCurToken?n||3 in this.GetCurrentModeSwitches()?(i=this.ParseSpecializeType(e,a,"",r,s),this.NextToken()):this.CheckToken(58):n?this.CheckToken(18):i=this.ResolveTypeReference(r,e,0),l=!0}finally{l&&t||s.set(null)}return i},this.ParseSpecializeType=function(e,t,s,i,r){var n=null;return 18!==this.FCurToken&&this.ParseExcTokenError("[20190801112729]"),n=this.CreateElement$1(Ke,s,e,t),null!==r.get()&&(n.Expr=r.get(),r.get().SetParent(n),r.set(null)),this.ReadSpecializeArguments(n,n.Params),20!==this.FCurToken&&this.ParseExcTokenError("[20190801113005]"),n.DestType=this.ResolveTypeReference(i,n,n.Params.FCount),this.NextToken(),14!==this.FCurToken?this.UngetToken():(this.NextToken(),this.FEngine.BeginScope(7,n),n.SubType=this.ParseSimpleType(n,this.CurSourcePos(),i,!1),this.FEngine.FinishScope(7,n)),this.FEngine.FinishScope(3,n),n},this.ParsePointerType=function(e,t,s){var i=null,r="";for(i=this.CreateElement$1(We,s,e,t),this.ExpectTokens(rtl.createSet(3,62)),r=this.FCurTokenString;;){if(this.NextToken(),14!==this.FCurToken)break;this.ExpectIdentifier({}),r=r+"."+this.FCurTokenString}if(18===this.FCurToken)do{this.NextToken()}while(20!==this.FCurToken);else 17===this.FCurToken&&(this.NextToken(),this.CurTokenIsIdentifier("far")||this.CurTokenIsIdentifier("near")?(this.NextToken(),this.CheckToken(17)):this.UngetToken()),this.UngetToken();return i.DestType=this.ResolveTypeReference(r,i,0),this.FEngine.FinishScope(3,i),i},this.ParseArrayType=function(e,t,s,i){var r=null;return(r=this.CreateElement$1(He,s,e,t)).PackMode=i,this.DoParseArrayType(r),this.FEngine.FinishScope(3,r),r},this.ParseFileType=function(e,t,s){var i=null;return i=this.CreateElement$1(Xe,s,e,t),this.NextToken(),86===this.FCurToken?i.ElType=this.ParseType$1(i,this.CurSourcePos(),"",!1):this.UngetToken(),i},this.ParseRecordDecl=function(e,t,s,i){var r,n=null;return(n=this.CreateElement$1(te,s,e,t)).RTTIVisibility.$assign(this.RTTIVisibility),n.PackMode=i,this.NextToken(),r=34 in this.FScanner.FCurrentModeSwitches&&!je.isPrototypeOf(e)&&""!==n.FName,this.ParseRecordMembers(n,58,r),this.FEngine.FinishScope(3,n),n},this.ParseEnumType=function(t,s,i){var r=null,n=null;for(r=this.CreateElement$1(qe,i,t,s);this.NextToken(),this.SaveComments(),n=this.CreateElement(Qe,this.FCurTokenString,r),r.Values.Add(n),this.NextToken(),9!==this.FCurToken;)if(this.FCurToken in rtl.createSet(19,27)){if(this.NextToken(),n.Value=this.DoParseExpression(r,null,!0),9===this.FCurToken)break;12!==this.FCurToken&&this.ParseExc(2011,rtl.getResStr(e,"SParserExpectedCommaRBracket"))}else 12!==this.FCurToken&&this.ParseExc(2011,rtl.getResStr(e,"SParserExpectedCommaRBracket"));return this.FEngine.FinishScope(3,r),r},this.ParseSetType=function(e,t,s,i){var r=null;return(r=this.CreateElement$1(Ze,s,e,t)).IsPacked=i,this.ExpectToken(86),r.EnumType=this.ParseType$1(r,this.CurSourcePos(),"",!1),this.FEngine.FinishScope(3,r),r},this.ParseClassDecl=function(e,t,s,i,r){var n,l=null,a=!1,o=!1,h=!1,u="",c="",f=null;if(this.NextToken(),1===i&&86===this.FCurToken)return l=this.CreateElement$1(et,s,e,t),this.ExpectIdentifier({}),this.UngetToken(),l.DestType=this.ParseType$1(l,this.CurSourcePos(),"",!1),this.FEngine.FinishScope(3,l),l;o=!1,a=!1,1===i&&(this.CurTokenIsIdentifier("abstract")||this.CurTokenIsIdentifier("sealed"))&&(o=this.CurTokenIsIdentifier("abstract"),a=this.CurTokenIsIdentifier("sealed"),this.NextToken()),n=this.DoParseClassExternalHeader(i,{get:function(){return u},set:function(e){u=e}},{get:function(){return c},set:function(e){c=e}}),i in p.okAllHelpers&&(this.CurTokenIsIdentifier("Helper")||this.ParseExcSyntaxError(),this.NextToken()),l=f=this.CreateElement$1(Q,s,e,t),h=!1;try{o&&f.Modifiers.Add("abstract"),a&&f.Modifiers.Add("sealed"),f.HelperForType=null,f.IsExternal=n,""!==c&&(f.ExternalName=Je(c,"'")),""!==u&&(f.ExternalNameSpace=Je(u,"'")),f.ObjKind=i,f.PackMode=r,2===i&&Ue(this.FScanner.GetCurrentValueSwitch(0),"CORBA")&&(f.InterfaceType=1),f.IsExternal||f.RTTIVisibility.$assign(this.RTTIVisibility),this.DoParseClassType(f),this.FEngine.FinishScope(3,l),h=!0}finally{h||f.SetParent(null)}return l},this.ParseProperty=function(t,s,i,r){var n=this,l=null;function a(e,t){var s="",i=null,r=null,l=C.$new();if(n.NextToken(),s=n.ReadDottedIdentifier(e,t,!0),22!==n.FCurToken)n.UngetToken();else{s+="[",r=null,(i=n.CreateElement(Ie,"",e)).Kind=11,i.Value=t.get(),t.get().SetParent(i),t.set(i),n.NextToken();var a=n.FCurToken;7===a?r=n.CreatePrimitiveExpr(e,2,n.CurTokenText()):6===a?r=n.CreatePrimitiveExpr(e,1,n.FCurTokenString):3===a?r=n.CreatePrimitiveExpr(e,0,n.CurTokenText()):61===a||108===a?r=n.CreateBoolConstExpr(e,6,108===n.FCurToken):n.ParseExcExpectedIdentifier(),i.AddParam(r),s+=n.FCurTokenString,n.ExpectToken(23),s+="]"}for(;;){if(n.NextToken(),14!==n.FCurToken){n.UngetToken();break}l.$assign(n.CurTokenPos()),n.ExpectIdentifier({}),s=s+"."+n.FCurTokenString,n.AddToBinaryExprChain(t,n.CreatePrimitiveExpr(e,0,n.FCurTokenString),27,l)}return s}var o,h,u=0;if(l=this.CreateElement$2(tt,s,t,i),r&&(l.VarModifiers=rtl.includeSet(l.VarModifiers,4)),u=(h=null!==t&&t.$class.ClassType()===Q)?t.ObjKind:1,this.NextToken(),(o=22===this.FCurToken)&&(this.ParseArgList(l,l.FArgs,23),this.NextToken()),16===this.FCurToken?(l.VarType=this.ParseType$1(l,this.CurSourcePos(),"",!1),this.NextToken()):h||this.ParseExcTokenError(":"),this.CurTokenIsIdentifier("INDEX")&&(this.NextToken(),l.IndexExpr=this.DoParseExpression(l,null,!0)),this.CurTokenIsIdentifier("READ")&&(l.ReadAccessorName=a(l,{p:l,get:function(){return this.p.ReadAccessor},set:function(e){this.p.ReadAccessor=e}}),this.NextToken()),this.CurTokenIsIdentifier("WRITE")&&(l.WriteAccessorName=a(l,{p:l,get:function(){return this.p.WriteAccessor},set:function(e){this.p.WriteAccessor=e}}),this.NextToken()),h&&6===u&&(this.CurTokenIsIdentifier("READONLY")&&(l.DispIDReadOnly=!0,this.NextToken()),this.CurTokenIsIdentifier("DISPID")&&(this.NextToken(),l.DispIDExpr=this.DoParseExpression(l,null,!0))),h&&1===u&&this.CurTokenIsIdentifier("IMPLEMENTS")&&function(){var e="",t=null,s=0;do{n.ExpectToken(3),s=rtl.length(l.Implements),e=n.ReadDottedIdentifier(l,{get:function(){return t},set:function(e){t=e}},0===s),0===s&&(l.ImplementsName=e),l.Implements=rtl.arraySetLength(l.Implements,null,s+1),l.Implements[s]=t}while(12===n.FCurToken)}(),this.CurTokenIsIdentifier("STORED")&&(u in rtl.createSet(1)||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"STORED",18,p.ObjKindNames[u])),this.NextToken(),108===this.FCurToken?(l.StoredAccessorName="True",l.StoredAccessor=this.CreateBoolConstExpr(l,6,!0)):61===this.FCurToken?(l.StoredAccessorName="False",l.StoredAccessor=this.CreateBoolConstExpr(l,6,!1)):3===this.FCurToken?(this.UngetToken(),l.StoredAccessorName=a(l,{p:l,get:function(){return this.p.StoredAccessor},set:function(e){this.p.StoredAccessor=e}})):this.ParseExcSyntaxError(),this.NextToken()),this.CurTokenIsIdentifier("DEFAULT")?(u in rtl.createSet(1,3)||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"DEFAULT",18,p.ObjKindNames[u])),o&&this.ParseExc(2041,rtl.getResStr(e,"SParserArrayPropertiesCannotHaveDefaultValue")),this.NextToken(),l.DefaultExpr=this.DoParseExpression(l,null,!0)):this.CurTokenIsIdentifier("NODEFAULT")&&(u in rtl.createSet(1)||this.ParseExc$1(2056,rtl.getResStr(e,"SParserXNotAllowedInY"),q(18,"NODEFAULT",18,p.ObjKindNames[u])),l.IsNodefault=!0,null!==l.DefaultExpr&&this.ParseExcSyntaxError(),this.NextToken()),17===this.FCurToken){for(this.NextToken(),this.CurTokenIsIdentifier("DEFAULT")&&(null===l.VarType||o||this.ParseExc(2042,rtl.getResStr(e,"SParserDefaultPropertyMustBeArray")),this.NextToken(),17===this.FCurToken&&(l.IsDefault=!0,this.NextToken()));this.DoCheckHint(l);)this.NextToken(),17===this.FCurToken&&this.NextToken();this.UngetToken()}else 58===this.FCurToken||this.CheckToken(17);return l},this.ParseRangeType=function(t,s,i,r){var n,l=null;return l=this.CreateElement$1(st,i,t,s),r&&19!==this.FCurToken&&this.ParseExcTokenError(m.TokenInfos[19]),this.NextToken(),n=this.DoParseExpression(l,null,!1),me.isPrototypeOf(n)&&7===n.Kind||this.ParseExc(2027,rtl.getResStr(e,"SRangeExpressionExpected")),l.RangeExpr=n,this.UngetToken(),this.FEngine.FinishScope(3,l),l},this.ParseExportDecl=function(t,s){var i=null,r="",n=null;do{s.FCount>0&&this.ExpectIdentifier({}),r=this.ReadDottedIdentifier(t,{get:function(){return n},set:function(e){n=e}},!0),i=this.CreateElement(it,r,t),0===n.Kind||(i.NameExpr=n,n.SetParent(i)),n=null,s.Add(i),this.CurTokenIsIdentifier("INDEX")&&(this.NextToken(),i.ExportIndex=this.DoParseExpression(i,null,!0),this.NextToken(),this.CurTokenIsIdentifier("NAME")||this.UngetToken()),this.CurTokenIsIdentifier("NAME")&&(this.NextToken(),i.ExportName=this.DoParseExpression(i,null,!0)),this.FCurToken in rtl.createSet(12,17)||this.ParseExc(2012,rtl.getResStr(e,"SParserExpectedCommaSemicolon")),this.FEngine.FinishScope(12,i)}while(17!==this.FCurToken)},this.ParseConstDecl=function(t){var s=null,i=!1;this.SaveComments(),s=this.CreateElement$1(rt,this.FCurTokenString,t,this.FIdentifierPos);try{if(H.isPrototypeOf(t)&&(s.VarModifiers=rtl.includeSet(s.VarModifiers,4)),this.NextToken(),16===this.FCurToken){9 in this.FScanner.FCurrentBoolSwitches||(s.IsConst=!0),i=this.FScanner.SetForceCaret(!0);try{s.VarType=this.ParseType$1(s,this.CurSourcePos(),"",!1)}finally{this.FScanner.SetForceCaret(i)}}else this.UngetToken(),s.IsConst=!0;this.NextToken(),19===this.FCurToken?(this.NextToken(),s.Expr=this.DoParseConstValueExpression(s),null===s.VarType&&7===s.Expr.Kind&&this.ParseExc(2052,rtl.getResStr(e,"SParserNoConstRangeAllowed"))):null!==s.VarType&&12 in this.FOptions?Q.isPrototypeOf(t)&&t.IsExternal&&1===t.ObjKind?s.IsConst=!0:17===this.FCurToken?(this.NextToken(),this.CurTokenIsIdentifier("external")||this.CurTokenIsIdentifier("weakexternal")?(s.IsConst=!0,s.VarModifiers=rtl.includeSet(s.VarModifiers,1),this.NextToken(),this.FCurToken in rtl.createSet(4,3)?(this.CurTokenIsIdentifier("name")||(s.LibraryName=this.DoParseExpression(s,null,!0)),this.CurTokenIsIdentifier("name")||this.ParseExcSyntaxError(),this.NextToken(),this.FCurToken in rtl.createSet(7,4,3)||this.ParseExcTokenError(m.TokenInfos[4]),s.ExportName=this.DoParseExpression(s,null,!0),s.IsConst=!0):17===this.FCurToken||this.ParseExcSyntaxError()):(this.UngetToken(),this.CheckToken(19))):this.CheckToken(19):this.CheckToken(19),this.UngetToken(),this.CheckHint(s,!H.isPrototypeOf(t))}catch(e){if(!F.isPrototypeOf(e))throw e;var r=e;if(!this.TryErrorRecovery(this.CreateRecovery$2(s,r,rtl.createSet(17),!1,12)))throw e;s=null}return s},this.ParseResourcestringDecl=function(e){var t=null;return this.SaveComments(),t=this.CreateElement$1(nt,this.FCurTokenString,e,this.FIdentifierPos),this.ExpectToken(19),this.NextToken(),t.Expr=this.DoParseConstValueExpression(t),this.UngetToken(),this.CheckHint(t,!0),t},this.ParseAttributes=function(e,t){var s,i=null,r=null,n=null,l=null,a=null;n=this.CreateElement(lt,"",e);do{if(this.NextToken(),i=null,this.ReadDottedIdentifier(n,{get:function(){return i},set:function(e){i=e}},!1),8===this.FCurToken){(l=this.CreateElement(Ie,"",n)).Kind=10,n.AddCall(l),l.Value=i,i.SetParent(l),i=null;do{if(this.NextToken(),9===this.FCurToken)break;r=this.DoParseConstValueExpression(l),l.AddParam(r)}while(12===this.FCurToken);this.CheckToken(9),this.NextToken()}else n.AddCall(i),i=null}while(12===this.FCurToken);return this.CheckToken(23),s=n,t&&(Ve.isPrototypeOf(e)?((a=e).Declarations.Add(s),a.Attributes.Add(s)):H.isPrototypeOf(e)?e.Members.Add(s):this.ParseExcTokenError("[20190922193803]"),this.FEngine.FinishScope(12,s)),s},this.ParseVarDecl=function(e,t){try{this.ParseVarList(e,t,0,1)}catch(e){if(!F.isPrototypeOf(e))throw e;var s=e;if(!this.TryErrorRecovery(this.CreateRecovery(s,rtl.createSet(17),!1)))throw e}},this.ParseInlineVarDecl=function(t,s,i,r){var n={};n=rtl.createSet(58,17),r&&(n=rtl.includeSet(n,9));try{this.ParseVarList(t,s,i,0)}catch(e){if(!F.isPrototypeOf(e))throw e;var l=e;if(!this.TryErrorRecovery(this.CreateRecovery(l,rtl.refSet(n),!1)))throw e}this.FCurToken in n||this.ParseExc(2018,rtl.getResStr(e,"SParserExpectedSemiColonEnd"))},this.ParseMain=function(t){t.set(null),this.NextToken(),this.SaveComments();var s=this.FCurToken;111===s?this.ParseUnit(t):93===s?this.ParseProgram(t,!1):78===s?this.ParseLibrary(t):91===s?this.ParsePackage(t):0===s?this.CheckToken(93):(this.UngetToken(),this.ParseProgram(t,!0)),this.FErrorCount>0&&this.FFailOnModuleErors&&(this.FEngine.HandleResultOnError(t.get())?c(t):t.set(null),this.ParseExc(2059,rtl.getResStr(e,"SErrCompilationAborted")))},this.ParseUnit=function(e){var t="",s=C.$new(),i=!1;for(this.FScanner.DisablePackageTokens(),s.$assign(this.CurTokenPos()),e.set(null),t=this.ExpectIdentifier({}),this.NextToken();14===this.FCurToken;)this.ExpectIdentifier({}),t=t+"."+this.FCurTokenString,this.NextToken();this.UngetToken(),e.set(this.CreateElement$1(ke,t,this.FEngine.FPackage,s)),this.FCurModule=e.get(),i=!0;try{if(this.FScanner.FCurModulename=t,null!=this.FEngine.FPackage&&(e.get().PackageName=this.FEngine.FPackage.FName,this.FEngine.FPackage.Modules.Add(e.get())),this.CheckHint(e.get(),!0),this.ExpectToken(75),13 in this.FOptions)return void(i=!1);this.ParseInterface(),null!==e.get().InterfaceSection&&null!==e.get().InterfaceSection.PendingUsedIntf&&(i=!1),null!==e.get().ImplementationSection&&null!==e.get().ImplementationSection.PendingUsedIntf&&(i=!1),i&&this.FinishedModule()}finally{i&&(this.FCurModule=null)}},this.GetLastSection=function(){var e=null;return e=null,null===this.FCurModule||(at.isPrototypeOf(this.FCurModule)?e=this.FCurModule.ProgramSection:ot.isPrototypeOf(this.FCurModule)?e=this.FCurModule.LibrarySection:(this.FCurModule.$class.ClassType()===ke||ht.isPrototypeOf(this.FCurModule))&&(e=null!==this.FCurModule.ImplementationSection?this.FCurModule.ImplementationSection:this.FCurModule.InterfaceSection)),e},this.CanParseContinue=function(e){var t=!1;return t=!1,e.set(null),null===this.FCurModule||""!==this.FLastMsg&&this.FLastMsgType<=1||""!==this.FScanner.FLastMsg&&this.FScanner.FLastMsgType<=1?t:(e.set(this.GetLastSection()),null===e.get()?!(!(13 in this.FOptions)||!ht.isPrototypeOf(this.FCurModule)&&this.FCurModule.$class.ClassType()!==ke||null!==this.FCurModule.InterfaceSection):t=null===e.get().PendingUsedIntf)},this.ParseContinue=function(){var e=null,t=!1;null===this.FCurModule&&this.ParseExcTokenError("TPasParser.ParseContinue missing module"),this.CanParseContinue({get:function(){return e},set:function(t){e=t}})||this.ParseExcTokenError("TPasParser.ParseContinue missing section"),t=!0;try{null===e?this.ParseInterface():(this.FEngine.FinishScope(1,e),this.ParseDeclarations(e)),null===(e=this.GetLastSection())&&this.ParseExc(2001,"[20180306112327]"),null!==e.PendingUsedIntf&&(t=!1),t&&this.FinishedModule()}finally{t&&(this.FCurModule=null)}},this.ParseProgram=function(t,s){var i=null,r=null,n="",l=C.$new(),a=!1;if(this.FScanner.DisablePackageTokens(),l.$assign(this.CurTokenPos()),s)n=ut(this.FScanner.FCurFilename,"");else{for(n=this.ExpectIdentifier({}),this.NextToken();14===this.FCurToken;)this.ExpectIdentifier({}),n=n+"."+this.FCurTokenString,this.NextToken();this.UngetToken()}t.set(null),i=this.CreateElement$1(at,n,this.FEngine.FPackage,l),t.set(i),a=!0,this.FCurModule=t.get();try{if(this.FScanner.FCurModulename=n,null!=this.FEngine.FPackage&&(t.get().PackageName=this.FEngine.FPackage.FName,this.FEngine.FPackage.Modules.Add(t.get())),s||(this.NextToken(),8===this.FCurToken&&(i.InputFile=this.ExpectIdentifier({}),this.NextToken(),this.FCurToken in rtl.createSet(9,12)||this.ParseExc(2011,rtl.getResStr(e,"SParserExpectedCommaRBracket")),12===this.FCurToken&&(i.OutPutFile=this.ExpectIdentifier({})),this.ExpectToken(9),this.NextToken()),17!==this.FCurToken&&this.ParseExcTokenError(";")),r=this.CreateElement(ct,"",this.FCurModule),i.ProgramSection=r,this.ParseOptionalUsesList(r),!(a=null===r.PendingUsedIntf))return;this.ParseDeclarations(r),this.FinishedModule()}finally{a&&(this.FCurModule=null)}},this.ParseLibrary=function(e){var t=null,s=null,i="",r=C.$new(),n=!1;for(this.FScanner.DisablePackageTokens(),r.$assign(this.CurTokenPos()),i=this.ExpectIdentifier({}),this.NextToken();14===this.FCurToken;)this.ExpectIdentifier({}),i=i+"."+this.FCurTokenString,this.NextToken();this.UngetToken(),e.set(null),t=this.CreateElement$1(ot,i,this.FEngine.FPackage,r),e.set(t),n=!0,this.FCurModule=e.get();try{if(this.FScanner.FCurModulename=i,null!=this.FEngine.FPackage&&(e.get().PackageName=this.FEngine.FPackage.FName,this.FEngine.FPackage.Modules.Add(e.get())),this.NextToken(),17!==this.FCurToken&&this.ParseExcTokenError(";"),s=this.CreateElement(pt,"",this.FCurModule),t.LibrarySection=s,this.ParseOptionalUsesList(s),!(n=null===s.PendingUsedIntf))return;this.ParseDeclarations(s),this.FinishedModule()}finally{n&&(this.FCurModule=null)}},this.ParsePackage=function(e){var t,s=C.$new(),i="";for(s.$assign(this.CurTokenPos()),i=this.ExpectIdentifier({}),this.NextToken();14===this.FCurToken;)this.ExpectIdentifier(rtl.createSet(91)),i=i+"."+this.FCurTokenString,this.NextToken();this.UngetToken(),this.ExpectToken(17),this.NextToken(),e.set(null),t=this.CreateElement$1(Ne,i,this.FEngine.FPackage,s),e.set(t),this.FCurModule=e.get();try{for(;14!==this.FCurToken;){var r=this.FCurToken;51===r?this.ParseContains(t.PackageSection):98===r?this.ParseRequires(t.PackageSection):58===r?(this.ExpectToken(14),this.UngetToken()):this.ParseExcSyntaxError(),this.NextToken()}this.FinishedModule()}finally{this.FCurModule=null}},this.ParseOptionalUsesList=function(e){this.NextToken(),this.CheckImplicitUsedUnits(e),113===this.FCurToken?this.ParseUsesList(e):this.UngetToken(),this.FEngine.CheckPendingUsedInterface(e),null===e.PendingUsedIntf&&this.FEngine.FinishScope(1,e)},this.ParseContains=function(e){this.ParseUsesList(e)},this.ParseRequires=function(e){var t=null,s=C.$new(),i="";do{i="",s.$assign(this.CurSourcePos());do{this.ExpectIdentifier(rtl.createSet(91)),""!==i&&(i+="."),i+=this.FCurTokenString,this.NextToken()}while(!(this.FCurToken in rtl.createSet(17,12)));t=this.FEngine.CreateElement$2(ft,i,e,3,s,null),e.Requires.Add(t)}while(17!==this.FCurToken)},this.ParseUsesList=function(t){var s="",i="",r=null,n=null,l=C.$new(),a=C.$new(),o=null;this.FScanner.FSkipGlobalSwitches=!0,r=null,n=null;do{for(s=this.ExpectIdentifier({}),l.$assign(this.CurSourcePos()),r=this.CreatePrimitiveExpr(t,2,s),this.NextToken();14===this.FCurToken;)a.$assign(this.CurTokenPos()),this.ExpectIdentifier({}),s=s+"."+(i=this.FCurTokenString),this.AddToBinaryExprChain({get:function(){return r},set:function(e){r=e}},this.CreatePrimitiveExpr(t,2,i),27,a),this.NextToken();71===this.FCurToken&&(3 in this.GetCurrentModeSwitches()&&(null===(o=t.GetModule())||o.$class.ClassType()!==ke&&!ht.isPrototypeOf(o)||this.CheckToken(17)),this.ExpectToken(4),n=this.CreatePrimitiveExpr(t,2,this.FCurTokenString),this.NextToken()),this.AddUseUnit(t,l,s,r,n),n=null,r=null,this.FCurToken in rtl.createSet(12,17)||this.ParseExc(2012,rtl.getResStr(e,"SParserExpectedCommaSemicolon"))}while(17!==this.FCurToken)},this.ParseInterface=function(){var t;this.LogEvent(0)&&this.DoLog(5,2031,rtl.getResStr(e,"SLogStartInterface"),!1),t=this.CreateElement(K,"",this.FCurModule),this.FCurModule.InterfaceSection=t,this.ParseOptionalUsesList(t),null===t.PendingUsedIntf&&this.ParseDeclarations(t)},this.ParseImplementation=function(){var e;e=this.CreateElement(xe,"",this.FCurModule),this.FCurModule.ImplementationSection=e,this.ParseOptionalUsesList(e),null===e.PendingUsedIntf&&this.ParseDeclarations(e)},this.ParseInitialization=function(){var e,t=null;for(e=this.CreateElement$1(dt,"",this.FCurModule,this.CurTokenPos()),this.FCurModule.InitializationSection=e;;){if(this.NextToken(),58===this.FCurToken)return this.ExpectToken(14),void this.FEngine.FinishScope(14,e);if(63===this.FCurToken)return this.FEngine.FinishScope(14,e),void this.ParseFinalization();17!==this.FCurToken&&(this.UngetToken(),this.ParseStatement(e,{get:function(){return t},set:function(e){t=e}}),null===t&&this.ExpectToken(58))}},this.ParseFinalization=function(){var e,t=null;for(e=this.CreateElement(Ft,"",this.FCurModule),this.FCurModule.FinalizationSection=e;;){if(this.NextToken(),58===this.FCurToken)return this.ExpectToken(14),void this.FEngine.FinishScope(14,e);17!==this.FCurToken&&(this.UngetToken(),this.ParseStatement(e,{get:function(){return t},set:function(e){t=e}}),null===t&&this.ExpectToken(58))}},this.ParseDeclarations=function(t){var s=this,i=!1,r=0;function n(e){r!==e&&(3===r&&3 in s.GetCurrentModeSwitches()&&s.FEngine.FinishScope(2,t),3===e?i=!0:0===e&&i&&(i=!1,3 in s.GetCurrentModeSwitches()||s.FEngine.FinishScope(2,t)),r=e,s.FScanner.SetForceCaret(3===e))}var l=null,a=null,o=null,u=null,c=null,p=0,f=0,d=null,S=null,T=0,y=!1,g=null;for(r=0,i=!1;;){r in rtl.createSet(0,1,3,4)?this.FScanner.SetTokenOption(1):this.FScanner.UnSetTokenOption(1),this.NextToken(),this.FScanner.FSkipGlobalSwitches=!0;var E=this.FCurToken;if(58===E){at.isPrototypeOf(this.FCurModule)&&null===this.FCurModule.InitializationSection&&this.ParseExcTokenError("begin"),this.ExpectToken(14);break}if(70===E){if(K.isPrototypeOf(t)){this.FEngine.FInterfaceOnly||(this.LogEvent(1)&&this.DoLog(5,2030,rtl.getResStr(e,"SLogStartImplementation"),!1),n(0),this.ParseImplementation());break}this.ParseExcSyntaxError()}else if(73===E){if(K.isPrototypeOf(t)||xe.isPrototypeOf(t)&&!ct.isPrototypeOf(t)){n(0),this.ParseInitialization();break}this.ParseExcSyntaxError()}else if(63===E){if(K.isPrototypeOf(t)||xe.isPrototypeOf(t)&&!ct.isPrototypeOf(t)){n(0),this.ParseFinalization();break}}else if(113===E)t.$class.ClassType()===K?this.ParseExcTokenError(m.TokenInfos[70]):mt.isPrototypeOf(t)?this.ParseExcTokenError(m.TokenInfos[58]):this.ParseExcSyntaxError();else if(48===E)n(1);else if(60===E)mt.isPrototypeOf(t)?n(7):this.ParseExcTokenError(m.TokenInfos[44]);else if(99===E)mt.isPrototypeOf(t)?n(2):this.ParseExc(2054,rtl.getResStr(e,"SParserResourcestringsMustBeGlobal"));else if(110===E)n(3);else if(114===E)n(4);else if(106===E)n(5);else if(94===E)n(6);else if(92===E||66===E||50===E||52===E||87===E)y=!(3 in this.GetCurrentModeSwitches())&&67===this.GetPrevToken(),n(0),this.SaveComments(),T=this.GetProcTypeFromToken(this.FCurToken,!1),this.AddProcOrFunction(t,this.ParseProcedureOrFunctionDecl(t,T,y,0));else if(47===E)y=!(3 in this.GetCurrentModeSwitches())&&67===this.GetPrevToken(),n(0),this.SaveComments(),this.NextToken(),this.CheckTokens(rtl.createSet(92,66,50,52,87)),T=this.GetProcTypeFromToken(this.FCurToken,!0),this.AddProcOrFunction(t,this.ParseProcedureOrFunctionDecl(t,T,y,0));else if(39===E||3===E){this.FScanner.UnSetTokenOption(1),this.SaveComments(),this.SaveIdentifierPosition();var P=r;if(1===P)null!=(l=this.ParseConstDecl(t))&&(t.Declarations.Add(l),t.Consts.Add(l),this.FEngine.FinishScope(12,l));else if(2===P)a=this.ParseResourcestringDecl(t),t.Declarations.Add(a),t.ResStrings.Add(a),this.FEngine.FinishScope(4,a);else if(3===P){if(null!=(o=this.ParseTypeDecl$1(t,C.$clone(this.FIdentifierPos))))if(t.Declarations.Add(o),o.$class.ClassType()!==Q||6 in this.FOptions)t.Types.Add(o);else{for(var I=0,R=t.Classes.FCount-1;I<=R;I++)if(p=I,u=rtl.getObject(t.Classes.Get(p)),0===Y(u.FName,o.FName)){t.Classes.Delete(p);for(var v=0,A=t.Declarations.FCount-1;v<=A;v++)if(f=v,0===Y(o.FName,rtl.getObject(t.Declarations.Get(f)).FName)){t.Declarations.Delete(f);break}break}t.Classes.Add(o)}}else if(7===P){c=h.$create("Create");try{this.ParseExportDecl(t,c);for(var N=0,x=c.FCount-1;N<=x;N++)p=N,d=rtl.getObject(c.Get(p)),t.Declarations.Add(d),t.ExportSymbols.Add(d)}finally{c=rtl.freeLoc(c)}}else if(4===P||5===P){c=h.$create("Create");try{this.ParseVarDecl(t,c);for(var b=0,O=c.FCount-1;b<=O;b++)p=b,g=rtl.getObject(c.Get(p)),t.Declarations.Add(g),g.$class.ClassType()===lt?t.Attributes.Add(g):t.Variables.Add(g),this.FEngine.FinishScope(12,g);if(17!==this.FCurToken)try{this.CheckToken(17)}catch(e){if(!F.isPrototypeOf(e))throw e;var k=e;if(!this.TryErrorRecovery(this.CreateRecovery(k,rtl.createSet(17),!1)))throw e}}finally{c=rtl.freeLoc(c)}}else 6===P?(S=this.ParseProperty(t,this.FCurTokenString,0,!1),t.Declarations.Add(S),t.Properties.Add(S),this.FEngine.FinishScope(12,S)):this.ParseExcSyntaxError()}else if(67===E)if(this.NextToken(),this.FCurToken in rtl.createSet(47,92,66)&&(3 in this.GetCurrentModeSwitches()&&this.ParseExcSyntaxError(),n(0),this.UngetToken()),3===r)this.CheckToken(3),this.ParseGenericTypeDecl(t,!0);else if(0===r){3 in this.GetCurrentModeSwitches()&&this.ParseExcSyntaxError(),n(0),this.SaveComments(),this.NextToken();var $=this.FCurToken;47===$?(this.NextToken(),this.FCurToken in rtl.createSet(92,66)||this.ParseExcSyntaxError(),T=this.GetProcTypeFromToken(this.FCurToken,!0),this.AddProcOrFunction(t,this.ParseProcedureOrFunctionDecl(t,T,!0,0))):92===$||66===$?(n(0),this.SaveComments(),T=this.GetProcTypeFromToken(this.FCurToken,!1),this.AddProcOrFunction(t,this.ParseProcedureOrFunctionDecl(t,T,!0,0))):this.ParseExcSyntaxError()}else this.ParseExcSyntaxError();else if(44===E){if(je.isPrototypeOf(t)){9 in rtl.as(t.FParent,_).FModifiers&&this.ParseExc$1(2006,rtl.getResStr(e,"SParserExpectTokenError"),q(18,"asm")),n(0),this.ParseProcBeginBlock(t);break}if(K.isPrototypeOf(t)||xe.isPrototypeOf(t)){n(0),this.ParseInitialization();break}this.ParseExcSyntaxError()}else if(43===E){if(je.isPrototypeOf(t)){9 in rtl.as(t.FParent,_).FModifiers||3 in this.GetCurrentModeSwitches()||this.ParseExc$1(2006,rtl.getResStr(e,"SParserExpectTokenError"),q(18,"begin")),n(0),this.ParseProcAsmBlock(t);break}this.ParseExcSyntaxError()}else 77===E?(n(0),K.isPrototypeOf(t)||this.ParseLabels(t)):22===E&&47 in this.GetCurrentModeSwitches()?this.ParseAttributes(t,!0):this.ParseExcSyntaxError()}n(0)},this.ParseStatement=function(e,t){var s=this,i=n.$new(),r=0;function l(){0!==i.CurBlock.Elements.FCount&&(r in rtl.createSet(17,16,57,89)||s.ParseExcTokenError("Semicolon"))}function a(e){var t,i=!1;return t=rtl.createSet(17,58,63,43,44,97,115,69,68,65,116,46,109,95,21,37,3,104,6,4,61,108,7,8,22,13,11,72),(i=0!==s.FCurToken)&&(i=s.TryErrorRecovery(s.CreateRecovery(e,rtl.refSet(t),!1))),i}var o=null;for(t.set(null),i.Parser=s,i.NewImplElement=null,i.CurBlock=e,i.Parent=e;;){r=this.FCurToken;try{this.NextToken();var h=this.FCurToken;if(43===h){if(l(),i.ParseAsm())break}else if(44===h)l(),o=i.CreateElement(Ct),i.CreateBlock(o);else if(97===h)l(),o=i.CreateElement(M),i.CreateBlock(o);else if(69===h)l(),i.ParseIf();else if(57===h||89===h){if(i.ParseElse())return}else if(115===h)l(),i.ParseWhile();else if(68===h)l(),i.ParseGoto();else if(65===h)l(),i.ParseFor();else if(116===h)l(),i.ParseWith();else if(46===h)l(),i.ParseCase();else if(109===h)l(),o=i.CreateElement(D),i.CreateBlock(o);else if(64===h){if(i.ParseFinally())break}else if(59===h){if(i.ParseExcept())break}else if(95===h)l(),i.ParseRaise();else if(58===h){if(i.CloseStatement(!0)){this.UngetToken();break}if(Ct.isPrototypeOf(i.CurBlock)){if(i.CloseBlock())break;if(i.CloseStatement(!1))break}else if(R.isPrototypeOf(i.CurBlock)){if(i.CloseBlock())break;if(i.CloseBlock())break;if(i.CloseStatement(!1))break}else if(St.isPrototypeOf(i.CurBlock)){if(i.CloseBlock())break;if(i.CloseBlock())break;if(i.CloseStatement(!1))break}else this.ParseExcSyntaxError()}else if(17===h){if(i.CloseStatement(!0))break}else if(63===h){if(i.CloseStatement(!0)){this.UngetToken();break}}else if(112===h){if(i.ParseUntil())break}else if(0===h)this.CheckToken(58);else if(114===h)56 in this.GetCurrentModeSwitches()||this.ParseExcSyntaxError(),l(),this.NextToken(),i.ParseVarStatement(),i.CloseStatement(!0);else if(21===h||37===h||3===h||104===h||6===h||4===h||61===h||108===h||7===h||8===h||22===h||13===h||11===h||72===h)if(l(),0===Y(this.CurTokenText(),"on")){if(i.ParseOn())break}else i.ParseExpr();else this.ParseExcSyntaxError()}catch(e){if(!F.isPrototypeOf(e))throw e;if(!a(e))throw e}}t.set(i.NewImplElement)},this.ParseLabels=function(e){var t=null;t=this.CreateElement(Tt,"",e);do{this.ExpectTokens(rtl.createSet(3,6)),t.Labels.Add(this.FCurTokenString),this.NextToken(),this.FCurToken in rtl.createSet(17,12)||this.ParseExcTokenError(m.TokenInfos[17])}while(17!==this.FCurToken);Ve.isPrototypeOf(e)?(e.Declarations.Add(t),e.Labels.Add(t)):c({get:function(){return t},set:function(e){t=e}})},this.ParseRTTIDirective=function(e,t){var s=!1,i=0,r=0;function n(){for(;i<=r&&e.charCodeAt(i-1)in rtl.createSet(32,9,10,13);)i+=1}function l(){var t;for(t=i;i<=r&&e.charCodeAt(i-1)in rtl.createSet(null,97,122,null,65,90,null,48,57,95);)i+=1;return yt(e,t,i-t)}var a=0,o="",h={};s=!1,t.$assign(W.$new()),i=1,r=e.length,n(),o=l();var u=T(o);if("explicit"===u)t.Explicit=!0;else{if("inherit"!==u)return s;t.Explicit=!1}for(;i<=r&&(n(),!(i>r));){o=l();var c=T(o);if("fields"===c)a=0;else if("methods"===c)a=1;else{if("properties"!==c)return s;a=2}if(n(),i>r||"("!==e.charAt(i-1))return s;if(i+=1,n(),i>r||"["!==e.charAt(i-1))return s;for(i+=1,h={};;){if(n(),i<=r&&"]"===e.charAt(i-1))break;o=l();var p=T(o);if("vcprivate"===p)h=rtl.includeSet(h,0);else if("vcprotected"===p)h=rtl.includeSet(h,1);else if("vcpublic"===p)h=rtl.includeSet(h,2);else{if("vcpublished"!==p)return s;h=rtl.includeSet(h,3)}if(n(),i>r)return s;var f=e.charAt(i-1);if(","!==f){if("]"===f)break;return s}i+=1}if(i+=1,n(),i>r||")"!==e.charAt(i-1))return s;i+=1;var d=a;0===d?t.Fields=rtl.refSet(h):1===d?t.Methods=rtl.refSet(h):2===d&&(t.Properties=rtl.refSet(h))}return s=!0},this.ParseProcedureOrFunctionDecl=function(t,s,i,r){var n=this,l=null,a=null,o=C.$new();var u="",c="",f=null,d=0,F=!1,m=0,S=0;u="",a=null,l=null;try{var T=s;if(2===T||3===T?(i&&this.ParseExcTokenError("procedure"),this.NextToken(),(F=3!==this.FCurToken)?d=he.TokenToOperatorType(this.CurTokenText()):(d=he.NameToOperatorType(this.FCurTokenString),u=this.FCurTokenString,0===d&&(this.NextToken(),14!==this.FCurToken&&this.ParseExc$1(2015,rtl.getResStr(e,"SErrUnknownOperatorType"),q(18,u)),this.NextToken(),d=(F=3!==this.FCurToken)?he.TokenToOperatorType(this.CurTokenText()):he.NameToOperatorType(this.FCurTokenString))),0===d&&this.ParseExc$1(2015,rtl.getResStr(e,"SErrUnknownOperatorType"),q(18,this.FCurTokenString)),c=p.OperatorNames[d],""!==u&&(c=u+"."+c),o.$assign(this.CurTokenPos())):10===T||11===T?(c="",i&&this.ParseExcTokenError("generic"),o.$assign(this.CurTokenPos())):c=function(){var s="",r=null,l=0,u=0,c="",p=null;for(s=Q.isPrototypeOf(t)&&t.IsExternal?n.ExpectIdentifier(rtl.createSet(39)):n.ExpectIdentifier({}),o.$assign(n.CurSourcePos()),l=1;;)if(n.NextToken(),14===n.FCurToken)xe.isPrototypeOf(t)?(l+=1,c=n.ExpectIdentifier({}),o.$assign(n.CurSourcePos()),s=s+"."+c,null!==a&&(p=gt.$create("Create"),a.Add(p),p.Name=c)):n.ParseExcSyntaxError();else{if(18!==n.FCurToken)break;if(i||3 in n.GetCurrentModeSwitches()||n.ParseExc(2029,rtl.getResStr(e,"SParserGenericFunctionNeedsGenericKeyword")),null===a)for(a=h.$create("Create"),c=s;;){if(p=gt.$create("Create"),a.Add(p),!((u=de(".",c))>0)){p.Name=c;break}p.Name=Et(c,u-1),Pt({get:function(){return c},set:function(e){c=e}},1,u)}else null!==rtl.getObject(a.Get(l-1)).Templates&&n.ParseExcSyntaxError();n.UngetToken(),r=h.$create("Create"),rtl.getObject(a.Get(l-1)).Templates=r,n.ReadGenericArguments(r,t)}return null===a&&i&&n.CheckToken(18),n.UngetToken(),s}(),f=this.GetProcedureClass(s),""!==c&&(t=this.CheckIfOverloaded(t,c)),l=this.FEngine.CreateElement$2(f,c,t,r,o,a),null!==a){null===l.NameParts&&l.SetNameParts(a);for(var y=0,g=l.NameParts.FCount-1;y<=g;y++){S=y;var E=rtl.getObject(l.NameParts.Get(S));if(null!==E.Templates)for(var P=0,I=E.Templates.FCount-1;P<=I;P++)m=P,rtl.getObject(E.Templates.Get(m)).FParent!==l&&this.ParseExc(2003,rtl.getResStr(e,"SParserError")+"[20190818131750] "+rtl.getObject(E.Templates.Get(m)).FParent.FName+":"+rtl.getObject(E.Templates.Get(m)).FParent.$classname)}a.FCount>0&&this.ParseExc(2003,rtl.getResStr(e,"SParserError")+'[20190818131909] "'+c+'"')}if(1===s||7===s||2===s||3===s||11===s?(l.ProcType=this.CreateFunctionType("","Result",l,!1,this.CurTokenPos(),null),s in rtl.createSet(2,3)&&(l.FTokenBased=F,l.FOperatorType=d,l.CorrectName())):l.ProcType=this.CreateElement(X,"",l),this.ParseProcedureOrFunction(l,l.ProcType,s,!1),l.FHints=rtl.refSet(l.ProcType.FHints),l.FHintMessage=l.ProcType.FHintMessage,s in rtl.createSet(2,3)&&l.FOperatorType in rtl.createSet(20,19)&&l.ProcType.Args.FCount>1){var R=l.FOperatorType;20===R?l.FOperatorType=4:19===R&&(l.FOperatorType=5),l.FName=p.OperatorNames[l.FOperatorType],l.CorrectName()}}finally{null!==a&&It({get:function(){return a},set:function(e){a=e}})}return l},this.ParseArgList=function(t,s,i){var r=this,n=!1,l=null;function a(){var e="";return rtl.neSet(rtl.intersectSet(rtl.createSet(3,4,2),r.GetCurrentModeSwitches()),{})?e=r.ExpectIdentifier({}):(r.NextToken(),r.FCurToken in rtl.createSet(94,3,47)?e=r.FCurTokenString:r.ParseExcTokenError("identifier")),e}function o(s){var i;return s&&r.NextToken(),(i=22===r.FCurToken)?(47 in r.GetCurrentModeSwitches()||r.ParseExc(2019,rtl.getResStr(e,"SParserExpectedConstVarID")),function(e){var s=null,i=0,a=null;if(n=!1,null!==(a=r.ParseAttributes(t,!1))){for(var o=0,h=rtl.length(a.Calls)-1;o<=h;o++)i=o,0===(s=a.Calls[i]).Kind&&"ref"===s.Value&&(n=!0);if(null===l)l=a;else{for(var u=0,c=rtl.length(a.Calls)-1;u<=c;u++)i=u,s=a.Calls[i],l.AddCall(s),s.SetParent(l);a.Calls=[],a=rtl.freeLoc(a)}}e||r.NextToken()}(s)):s&&r.UngetToken(),i}var h=!1,u=!1,c=!1,p="",f=null,d=0,F=0,m=null,C=0,S=null;c=!1;try{for(;;){if(C=0,u=!1,S=null,this.NextToken(),n=!1,l=null,o(!1),38===this.FCurToken){this.ExpectToken(i);break}for(48===this.FCurToken?(C=1,o(!0),n&&(C=4),p=a()):49===this.FCurToken?(C=4,o(!0),p=a()):114===this.FCurToken?(C=2,o(!0),p=a()):3===this.FCurToken&&"OUT"===J(this.FCurTokenString)?rtl.neSet(rtl.intersectSet(rtl.createSet(2,3,4,23),this.GetCurrentModeSwitches()),{})?(C=3,p=this.ExpectIdentifier({})):p=this.FCurTokenString:94===this.FCurToken||47===this.FCurToken?rtl.neSet(rtl.intersectSet(rtl.createSet(3,4,2),this.GetCurrentModeSwitches()),{})?this.ParseExcTokenError("identifier"):p=this.FCurTokenString:3===this.FCurToken?p=this.FCurTokenString:this.ParseExc(2019,rtl.getResStr(e,"SParserExpectedConstVarID")),F=s.FCount;(m=this.CreateElement(Ae,p,t)).Access=C,s.Add(m),this.NextToken(),16!==this.FCurToken;){if((17===this.FCurToken||9===this.FCurToken)&&0!==C){this.UngetToken(),u=!0;break}12!==this.FCurToken&&this.ParseExc(2014,rtl.getResStr(e,"SParserExpectedCommaColon")),this.NextToken(),3===this.FCurToken?p=this.FCurTokenString:this.ParseExc(2019,rtl.getResStr(e,"SParserExpectedConstVarID"))}if(f=null,!u){m=rtl.getObject(s.Get(F)),S=null,h=this.FScanner.SetForceCaret(!0);try{S=this.ParseType$1(m,this.CurSourcePos(),"",!1),this.NextToken(),19===this.FCurToken?(s.FCount>F+1&&(S=null,this.ParseExc(2016,rtl.getResStr(e,"SParserOnlyOneArgumentCanHaveDefault"))),tt.isPrototypeOf(t)&&this.ParseExc(2050,rtl.getResStr(e,"SParserPropertyArgumentsCanNotHaveDefaultValues")),this.NextToken(),f=this.DoParseExpression(m,null,!0),c=!0):c&&this.ParseExc$1(2047,rtl.getResStr(e,"SParserDefaultParameterRequiredFor"),q(18,rtl.getObject(s.Get(F)).FName)),this.UngetToken()}finally{this.FScanner.SetForceCaret(h)}}for(var y=F,g=s.FCount-1;y<=g;y++)d=y,m=rtl.getObject(s.Get(d)),null!==l&&(m.Attributes=l,d===F&&(l.SetParent(m),this.FEngine.FinishScope(12,l))),m.ArgType=S,m.ValueExpr=f,f=null;l=null;for(var E=F,P=s.FCount-1;E<=P;E++)d=E,this.FEngine.FinishScope(12,rtl.getObject(s.Get(d)));if(this.NextToken(),3===this.FCurToken&&"location"===T(this.FCurTokenString)&&(this.NextToken(),this.NextToken()),this.FCurToken===i)break;this.CheckToken(17)}}finally{l=rtl.freeLoc(l)}},this.ParseProcedureOrFunction=function(t,s,i,r){function n(e,t){var s=!1,i=0,r="",n="",l=null;for(i=t.Functions.FCount-1;i>=0&&0!==Y(rtl.getObject(t.Functions.Get(i)).FName,e);)i-=1;if(s=-1!==i,i=de(".",e),!s&&i>0)for(r=yt(e,1,i-1),n=e,Pt({get:function(){return n},set:function(e){n=e}},1,i),i=t.Classes.FCount-1;!s&&i>=0;)l=rtl.getObject(t.Classes.Get(i)),0===Y(l.FName,r)&&(s=null!==l.FindMember(se,n)),i-=1;return s}var l,a,o=null,h=!1,u=!1;this.CheckProcedureArgs(s,s.Args,i),a=!(l=!_.isPrototypeOf(t))&&i in rtl.createSet(10,11);var c=i;if(1===c||7===c||11===c)if(this.NextToken(),16===this.FCurToken){o=s.ResultEl,u=this.FScanner.SetForceCaret(!0);try{o.ResultType=this.ParseType$1(o,this.CurSourcePos(),"",!1)}finally{this.FScanner.SetForceCaret(u)}}else a||!(3 in this.GetCurrentModeSwitches())||null==this.FCurModule.ImplementationSection&&!at.isPrototypeOf(this.FCurModule)?this.CheckToken(16):(h=!1,null!=this.FCurModule.InterfaceSection?h=n(t.FName,this.FCurModule.InterfaceSection):at.isPrototypeOf(this.FCurModule)&&null!=this.FCurModule.ProgramSection&&(h=n(t.FName,this.FCurModule.ProgramSection)),h?(this.CheckToken(17),this.UngetToken()):this.CheckToken(16));else 2===c||3===c?(this.NextToken(),o=s.ResultEl,3===this.FCurToken?(o.FName=this.CurTokenName(),this.ExpectToken(16),o.ResultType=this.ParseType$1(o,this.CurSourcePos(),"",!1)):he.isPrototypeOf(t)&&t.FOperatorType in rtl.createSet(33,34,35,36)||(16===this.FCurToken?o.FName="Result":this.ParseExc(2021,rtl.getResStr(e,"SParserExpectedColonID")),o.ResultType=this.ParseType$1(o,this.CurSourcePos(),"",!1))):o=null;r&&(this.NextToken(),86===this.FCurToken?(this.ExpectToken(85),s.SetIsOfObject(!0)):76===this.FCurToken?(this.ExpectToken(3),"nested"!==T(this.FCurTokenString)&&this.ParseExc(2020,rtl.getResStr(e,"SParserExpectedNested")),s.SetIsNested(!0)):this.UngetToken()),this.ParseProcedureModifiers(t,s,l,a),i in rtl.createSet(2,3)&&he.isPrototypeOf(t)&&t.CorrectName(),this.FEngine.FinishScope(6,s),l||!a&&!t.CanParseImplementation()||this.ParseProcedureBody(t)},this.ParseProcedureBody=function(e){var t;t=this.CreateElement(je,"",e),e.Body=t,this.ParseDeclarations(t)},this.ParseMethodResolution=function(e){var t=null;return t=this.CreateElement(Rt,"",e),66===this.FCurToken?t.ProcClass=se:t.ProcClass=_,this.ExpectToken(3),t.InterfaceName=this.CreatePrimitiveExpr(t,0,this.FCurTokenString),this.ExpectToken(14),this.ExpectToken(3),t.InterfaceProc=this.CreatePrimitiveExpr(t,0,this.FCurTokenString),this.ExpectToken(19),this.ExpectToken(3),t.ImplementationProc=this.CreatePrimitiveExpr(t,0,this.FCurTokenString),this.NextToken(),17===this.FCurToken||(58===this.FCurToken?this.UngetToken():this.CheckToken(17)),t},this.ParseProcBeginBlock=function(e){var t,s=null;t=this.CreateElement(Ct,"",e),e.Body=t,this.FScanner.SetNonToken(82),this.FScanner.SetNonToken(84),this.FScanner.SetNonToken(83);try{for(;;){if(this.NextToken(),58===this.FCurToken)break;17!==this.FCurToken&&(this.UngetToken(),this.ParseStatement(t,{get:function(){return s},set:function(e){s=e}}),null===s&&this.ExpectToken(58))}}finally{this.FScanner.UnsetNonToken(82),this.FScanner.UnsetNonToken(84),this.FScanner.UnsetNonToken(83)}rtl.as(e.FParent,_).GetProcTypeEnum()in rtl.createSet(10,11)?this.NextToken():this.ExpectToken(17)},this.ParseProcAsmBlock=function(e){var t;t=this.CreateElement(P,"",e),e.Body=t,this.ParseAsmBlock(t),this.NextToken(),ce.isPrototypeOf(e.FParent)||this.CheckToken(17)}});var vt=["deprecated","library","platform","experimental","unimplemented"];this.IsHintToken=function(e,t){var s=!1,i=0;for(e=T(e),s=!1,i=0;i<=4;i++)if(s=e===vt[i])return t.set(i),s;return s},this.IsProcModifier=function(e,t){var s=!1,i=0;for(e=T(e),s=!1,i=0;i<=23;i++)if(s=e===p.ModifierNames[i])return t.set(i),s;return s},this.IsCallingConvention=function(e,t){var s=!1,i=["","register","pascal","cdecl","stdcall","oldfpccall","safecall","syscall","mwpascal","hardfloat","sysv_abi_default","sysv_abi_cdecl","ms_abi_default","ms_abi_cdecl","vectorcall","winapi"],r=0;for(e=T(e),s=!1,r=0;r<=15;r++)if(s=""!==i[r]&&e===i[r])return t.set(r),s;return s},this.TokenToAssignKind=function(e){var t=0;if(27===e)t=0;else if(33===e)t=1;else if(34===e)t=2;else if(35===e)t=3;else{if(36!==e)throw F.$create("CreateFmt",["Not an assignment token : %s",q(18,m.TokenInfos[e])]);t=4}return t},e.$resourcestrings={SParserError:{org:"Error"},SParserErrorAtToken:{org:'%s at token "%s" in file %s at line %d column %d'},SParserUngetTokenError:{org:"Internal error: Cannot unget more tokens, history buffer is full"},SParserExpectTokenError:{org:'Expected "%s"'},SParserForwardNotInterface:{org:"The use of a FORWARD procedure modifier is not allowed in the interface"},SParserExpectVisibility:{org:"Expected visibility specifier"},SParserStrangeVisibility:{org:'Strange strict visibility encountered : "%s"'},SParserExpectToken2Error:{org:'Expected "%s" or "%s"'},SParserExpectedCommaRBracket:{org:'Expected "," or ")"'},SParserExpectedCommaSemicolon:{org:'Expected "," or ";"'},SParserExpectedAssignIn:{org:"Expected := or in"},SParserExpectedCommaColon:{org:'Expected "," or ":"'},SErrUnknownOperatorType:{org:"Unknown operator type: %s"},SParserOnlyOneArgumentCanHaveDefault:{org:"A default value can only be assigned to 1 parameter"},SParserExpectedLBracketColon:{org:'Expected "(" or ":"'},SParserExpectedSemiColonEnd:{org:'Expected ";" or "End"'},SParserExpectedConstVarID:{org:'Expected "const", "var" or identifier'},SParserExpectedNested:{org:"Expected nested keyword"},SParserExpectedColonID:{org:'Expected ":" or identifier'},SParserSyntaxError:{org:"Syntax error"},SParserTypeSyntaxError:{org:"Syntax error in type"},SParserArrayTypeSyntaxError:{org:"Syntax error in array type"},SParserParamsOrResultTypesNoLocalTypeDefs:{org:"Parameters or result types cannot contain local type definitions. Use a separate type definition in a type block."},SParserExpectedIdentifier:{org:"Identifier expected"},SParserNotAProcToken:{org:"Not a procedure or function token"},SRangeExpressionExpected:{org:"Range expression expected"},SParserExpectCase:{org:"Case label expression expected"},SParserGenericFunctionNeedsGenericKeyword:{org:"Generic function needs keyword generic"},SLogStartImplementation:{org:"Start parsing implementation section."},SLogStartInterface:{org:"Start parsing interface section"},SParserNoConstructorAllowed:{org:"Constructors or Destructors are not allowed in Interfaces or Records"},SParserNoFieldsAllowedInX:{org:"Fields are not allowed in %s"},SParserInvalidRecordVisibility:{org:"Records can only have public and (strict) private as visibility specifiers"},SErrRecordConstantsNotAllowed:{org:"Record constants not allowed at this location"},SErrRecordVariablesNotAllowed:{org:"Record variables not allowed at this location"},SErrRecordMethodsNotAllowed:{org:"Record methods not allowed at this location"},SErrRecordPropertiesNotAllowed:{org:"Record properties not allowed at this location"},SErrRecordTypesNotAllowed:{org:"Record types not allowed at this location"},SParserTypeNotAllowedHere:{org:'Type "%s" not allowed here'},SParserNotAnOperand:{org:"Not an operand: (%d : %s)"},SParserArrayPropertiesCannotHaveDefaultValue:{org:"Array properties cannot have default value"},SParserDefaultPropertyMustBeArray:{org:"The default property must be an array property"},SParserUnknownProcedureType:{org:'Unknown procedure type "%d"'},SParserTypeParamsNotAllowedOnType:{org:"Type parameters not allowed on this type"},SParserDuplicateIdentifier:{org:'Duplicate identifier "%s"'},SParserDefaultParameterRequiredFor:{org:'Default parameter required for "%s"'},SParserOnlyOneVariableCanBeInitialized:{org:"Only one variable can be initialized"},SParserExpectedTypeButGot:{org:"Expected type, but got %s"},SParserPropertyArgumentsCanNotHaveDefaultValues:{org:"Property arguments can not have default values"},SParserExpectedExternalClassName:{org:"Expected external class name"},SParserNoConstRangeAllowed:{org:"Const ranges are not allowed"},SParserResourcestringsMustBeGlobal:{org:"Resourcestrings can be only static or global"},SParserOnlyOneVariableCanBeAbsolute:{org:"Only one variable can be absolute"},SParserXNotAllowedInY:{org:"%s is not allowed in %s"},SErrInvalidMessageType:{org:"Invalid message type: string or integer expression expected"},SErrCompilationAborted:{org:"Compilation aborted"},SErrInvalidParamsForDirectiveX:{org:"Invalid parameters for compiler directive %s"}},e.$implcode=function(){t.WhitespaceTokensToIgnore=rtl.createSet(1,2,118,119),t.TDeclType={0:"declNone",declNone:0,1:"declConst",declConst:1,2:"declResourcestring",declResourcestring:2,3:"declType",declType:3,4:"declVar",declVar:4,5:"declThreadvar",declThreadvar:5,6:"declProperty",declProperty:6,7:"declExports",declExports:7};var e=["byte","boolean","char","integer","int64","longint","longword","double","shortint","smallint","string","word","qword","cardinal","widechar"],s=["Byte","Boolean","char","Integer","Int64","LongInt","LongWord","Double","ShortInt","SmallInt","String","Word","QWord","Cardinal","WideChar"];t.IsSimpleTypeToken=function(t){var i,r,n=0;for(r=T(t.get()),n=15;n>0&&r!==e[n-1];)n-=1;return(i=n>0)&&t.set(s[n-1]),i},t.GetExprIdent=function(e){var t="";return t="",null==e||(e.$class.ClassType()===w&&0===e.Kind?t=e.Value:e.$class.ClassType()===ye&&(t="Self")),t};var i=["","private","protected","public","published","automated","","","required","optional"],r=[5,9];t.IsVisibility=function(e,t,s){var n=!1,l=0;n=!1,e=T(e);for(var a=0,o=r[+s];a<=o;a++)if(n=""!==i[l=a]&&e===i[l])return t.set(l),n;return n}},e.$init=function(){}},[]),rtl.module("PasResolver",["System","JS","Classes","SysUtils","Math","Types","contnrs","PasTree","PScanner","PParser","PasResolveEval"],function(){"use strict";var e,t,s,i,r=this,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=null,R=null,v=null,A=null,N=null,x=null,b=null,O=null,k=null,$=null,D=null,L=null,B=null,M=null,G=null,w=null,V=null,U=null,J=null,j=null,H=null,W=null,Y=null,z=null,_=null,K=null,X=null,q=null,Q=null,Z=null,ee=null,te=null,se=null,ie=null,re=null,ne=null,le=null,ae=null,oe=pas.System,he=oe.TObject,ue=pas.JS.JSDelete,ce=pas.SysUtils,pe=ce.Exception,fe=pas.PScanner,de=fe.TPasSourcePos,Fe=pas.PasTree,me=Fe.TPasUnresolvedSymbolRef,Ce=pas.PasResolveEval,Se=Ce.TResolveData,Te=ce.LowerCase,ye=Ce.GetObjName,ge=pas.Classes.TFPList,Ee=ce.FreeAndNil,Pe=ce.CompareText,Ie=Fe.TPasModule,Re=Fe.TPasUsesUnit,ve=Fe.TPasProperty,Ae=ce.IntToStr,Ne=Fe.TProcedureBody,xe=Fe.TPasProcedure,be=pas.contnrs.TObjectList,Oe=pas.PParser.TPasTreeContainer,ke=Fe.TPasGenericType,$e=Fe.TPasClassType,De=Fe.TPasType,Le=Fe.TPasClassOfType,Be=Fe.TPasPointerType,Me=Fe.TPasRecordType,Ge=Fe.TPasEnumType,we=Fe.TPasProcedureType,Ve=Fe.TPasFunctionType,Ue=Fe.TPasArrayType,Je=Fe.TPasRangeType,je=Fe.TPasGenericTemplateType,He=Fe.TPasVariable,We=Fe.TPasArgument,Ye=oe.VarRecs,ze=Fe.TPasMembersType,_e=Fe.TPasConstructor,Ke=Fe.TInterfaceSection,Xe=Fe.TImplementationSection,qe=Fe.TPasFunction,Qe=Fe.TPasEnumValue,Ze=Fe.TPasProgram,et=Fe.TPasLibrary,tt=Fe.TPasPackage,st=Fe.TPasSection,it=Fe.TPasConst,rt=Fe.TPasVariant,nt=ce.SameText,lt=Fe.TPasSetType,at=Ce.GetObjPath,ot=Ce.GetGenericParamCommas,ht=Fe.TPasClassConstructor,ut=Fe.TPasClassDestructor,ct=oe.Delete,pt=ce.LeftStr,ft=Fe.TPasImplBeginBlock,dt=Fe.TPasImplAssign,Ft=Fe.TPasImplSimple,mt=Fe.TPasImplBlock,Ct=Fe.TPasImplRepeatUntil,St=Fe.TPasImplIfElse,Tt=Fe.TPasImplWhileDo,yt=Fe.TPasImplCaseOf,gt=Fe.TPasImplLabelMark,Et=Fe.TPasImplForLoop,Pt=Fe.TPasImplTry,It=Fe.TPasImplExceptOn,Rt=Fe.TPasImplRaise,vt=Fe.TPasImplCommand,At=Fe.TPasImplAsmStatement,Nt=Fe.TPasImplWithDo,xt=Ce.TResEvalSet,bt=Fe.TPasImplCaseStatement,Ot=Ce.ReleaseEvalValue,kt=Fe.TPasImplCaseElse,$t=Fe.TPasResultElement,Dt=Fe.TPrimitiveExpr,Lt=Fe.TUnaryExpr,Bt=Fe.TBinaryExpr,Mt=Fe.TParamsExpr,Gt=Fe.TBoolConstExpr,wt=Fe.TNilExpr,Vt=Fe.TInheritedExpr,Ut=Fe.TArrayValues,Jt=Fe.TRecordValues,jt=Fe.TProcedureExpr,Ht=Fe.TInlineSpecializeExpr,Wt=oe.Pos,Yt=Fe.TPasExpr,zt=ce.BoolToStr$1,_t=Fe.TPasAttributes,Kt=Fe.TPasSpecializeType,Xt=Fe.TPasDeclarations,qt=Fe.TPasAliasType,Qt=Fe.TPasTypeAliasType,Zt=Fe.TPasMethodResolution,es=Fe.TPasDestructor,ts=Fe.TPasClassProcedure,ss=Fe.TPasClassFunction,is=Fe.TPasAnonymousProcedure,rs=Fe.TPasAnonymousFunction,ns=Ce.TResEvalRangeInt,ls=Fe.TPasExportSymbol,as=ce.RightStr,os=Ce.TResEvalExternal,hs=Ce.TResEvalEnum,us=Ce.TResEvalInt,cs=Ce.TResEvalFloat,ps=Ce.TResEvalCurrency,fs=Ce.TResEvalBool,ds=Ce.TResEvalUTF16,Fs=oe.Copy,ms=Fe.TPasStringType,Cs=Fe.TPasImplTryFinally,Ss=Fe.TPasImplTryExcept,Ts=Fe.TPasImplTryExceptElse,ys=Fe.TPasResString,gs=Fe.TPasOperator,Es=Fe.TPasImplElement,Ps=Fe.TProcedureNamePart,Is=Fe.TRecordValuesItem,Rs=Ce.TResExprEvaluator,vs=Fe.TSelfExpr,As=Fe.TPasOverloadedProc,Ns=Fe.TProgramSection,xs=Fe.TLibrarySection,bs=Fe.TInitializationSection,Os=Fe.TFinalizationSection,ks=Fe.TPasUnresolvedUnitRef,$s=ce.ChangeFileExt,Ds=ce.ExtractFileName,Ls=fe.SafeFormat,Bs=fe.CreateMsgArgs,Ms=ce.UpperCase,Gs=Ce.NumberIsFloat,ws=Fe.TPasClassOperator,Vs=Ce.TResEvalUInt,Us=oe.StringOfChar,Js=Fe.TPasFileType;this.ParserMaxEmbeddedColumn=2048,this.ParserMaxEmbeddedRow=rtl.trunc(2147483647/2048),this.po_Resolver=rtl.createSet(3,5,6,7,10),e=this.TResolverBaseType={0:"btNone",btNone:0,1:"btCustom",btCustom:1,2:"btContext",btContext:2,3:"btModule",btModule:3,4:"btUntyped",btUntyped:4,5:"btChar",btChar:5,6:"btWideChar",btWideChar:6,7:"btString",btString:7,8:"btWideString",btWideString:8,9:"btUnicodeString",btUnicodeString:9,10:"btSingle",btSingle:10,11:"btDouble",btDouble:11,12:"btExtended",btExtended:12,13:"btCExtended",btCExtended:13,14:"btCurrency",btCurrency:14,15:"btBoolean",btBoolean:15,16:"btByteBool",btByteBool:16,17:"btWordBool",btWordBool:17,18:"btLongBool",btLongBool:18,19:"btByte",btByte:19,20:"btShortInt",btShortInt:20,21:"btWord",btWord:21,22:"btSmallInt",btSmallInt:22,23:"btUIntSingle",btUIntSingle:23,24:"btIntSingle",btIntSingle:24,25:"btLongWord",btLongWord:25,26:"btLongint",btLongint:26,27:"btUIntDouble",btUIntDouble:27,28:"btIntDouble",btIntDouble:28,29:"btPointer",btPointer:29,30:"btNil",btNil:30,31:"btProc",btProc:31,32:"btBuiltInProc",btBuiltInProc:32,33:"btArrayProperty",btArrayProperty:33,34:"btSet",btSet:34,35:"btArrayLit",btArrayLit:35,36:"btArrayOrSet",btArrayOrSet:36,37:"btRange",btRange:37},this.btIntMax=28,this.btAllInteger=rtl.createSet(19,20,21,22,24,23,25,26,28,27),this.btAllIntegerNoQWord=this.btAllInteger,this.btAllSignedInteger=rtl.createSet(20,22,24,26,28),this.btAllChars=rtl.createSet(5,6),this.btAllStrings=rtl.createSet(7,8,9),this.btAllStringAndChars=rtl.unionSet(this.btAllStrings,this.btAllChars),this.btAllStringPointer=rtl.createSet(7,8,9),this.btAllFloats=rtl.createSet(10,11,12,13,14),this.btAllBooleans=rtl.createSet(15,16,17,18),this.btArrayRangeTypes=rtl.unionSet(rtl.unionSet(this.btAllChars,this.btAllBooleans),this.btAllInteger),this.btAllRanges=rtl.unionSet(this.btArrayRangeTypes,rtl.createSet(37)),this.btAllWithSubType=rtl.createSet(34,35,36,37),this.btAllIntrinsicTypes=rtl.unionSet(rtl.unionSet(rtl.unionSet(this.btAllInteger,this.btAllStringAndChars),this.btAllFloats),this.btAllBooleans),this.btAllFPCTypes=rtl.createSet(5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,25,26,29),this.ResBaseTypeNames=["None","Custom","Context","Module","Untyped","Char","WideChar","String","WideString","UnicodeString","Single","Double","Extended","CExtended","Currency","Boolean","ByteBool","WordBool","LongBool","Byte","ShortInt","Word","SmallInt","UIntSingle","IntSingle","LongWord","Longint","UIntDouble","IntDouble","Pointer","Nil","Procedure/Function","BuiltInProc","array property","set","array","set or array literal","range.."],t=this.TResolverBuiltInProc={0:"bfCustom",bfCustom:0,1:"bfLength",bfLength:1,2:"bfSetLength",bfSetLength:2,3:"bfInclude",bfInclude:3,4:"bfExclude",bfExclude:4,5:"bfBreak",bfBreak:5,6:"bfContinue",bfContinue:6,7:"bfExit",bfExit:7,8:"bfInc",bfInc:8,9:"bfDec",bfDec:9,10:"bfAssigned",bfAssigned:10,11:"bfChr",bfChr:11,12:"bfOrd",bfOrd:12,13:"bfLow",bfLow:13,14:"bfHigh",bfHigh:14,15:"bfPred",bfPred:15,16:"bfSucc",bfSucc:16,17:"bfStrProc",bfStrProc:17,18:"bfStrFunc",bfStrFunc:18,19:"bfWriteStr",bfWriteStr:19,20:"bfVal",bfVal:20,21:"bfLo",bfLo:21,22:"bfHi",bfHi:22,23:"bfConcatArray",bfConcatArray:23,24:"bfConcatString",bfConcatString:24,25:"bfCopyArray",bfCopyArray:25,26:"bfInsertArray",bfInsertArray:26,27:"bfDeleteArray",bfDeleteArray:27,28:"bfTypeInfo",bfTypeInfo:28,29:"bfGetTypeKind",bfGetTypeKind:29,30:"bfAssert",bfAssert:30,31:"bfNew",bfNew:31,32:"bfDispose",bfDispose:32,33:"bfDefault",bfDefault:33},this.ResolverBuiltInProcNames=["Custom","Length","SetLength","Include","Exclude","Break","Continue","Exit","Inc","Dec","Assigned","Chr","Ord","Low","High","Pred","Succ","Str","Str","WriteStr","Val","Lo","Hi","Concat","Concat","Copy","Insert","Delete","TypeInfo","GetTypeKind","Assert","New","Dispose","Default"],this.bfAllStandardProcs=rtl.createSet(null,1,t.bfDefault),this.ResolverResultVar="Result",rtl.createClass(this,"TPasResHashList",he,function(){n=this,this.$init=function(){he.$init.call(this),this.FItems=null},this.$final=function(){this.FItems=void 0,he.$final.call(this)},this.Create$1=function(){return this.FItems=new Object,this},this.Add=function(e,t){this.FItems["%"+e]=t},this.Find=function(e){return this.FItems.hasOwnProperty("%"+e)?this.FItems["%"+e]:null},this.ForEachCall=function(e,t){var s="";for(s in this.FItems)this.FItems.hasOwnProperty(s)&&e(this.FItems[s],t)},this.Clear=function(){this.FItems=new Object},this.Remove=function(e){this.FItems.hasOwnProperty("%"+e)&&ue(this.FItems,"%"+e)}}),rtl.createClass(this,"EPasResolve",pe,function(){l=this,this.$init=function(){pe.$init.call(this),this.FPasElement=null,this.Id=0,this.MsgType=0,this.MsgNumber=0,this.MsgPattern="",this.Args=[],this.SourcePos=de.$new()},this.$final=function(){this.FPasElement=void 0,this.Args=void 0,this.SourcePos=void 0,pe.$final.call(this)},this.SetPasElement=function(e){this.FPasElement!==e&&(this.FPasElement=e)},this.Destroy=function(){this.SetPasElement(null),he.Destroy.call(this)}}),rtl.createClass(this,"TUnresolvedPendingRef",me,function(){a=this}),rtl.createClass(this,"TPasSpecializeTypeData",Se,function(){o=this,this.$init=function(){Se.$init.call(this),this.SpecializedType=null},this.$final=function(){this.SpecializedType=void 0,Se.$final.call(this)}}),this.TPRSpecializeStep={0:"prssNone",prssNone:0,1:"prssInterfaceBuilding",prssInterfaceBuilding:1,2:"prssInterfaceFinished",prssInterfaceFinished:2,3:"prssImplementationBuilding",prssImplementationBuilding:3,4:"prssImplementationFinished",prssImplementationFinished:4},rtl.createClass(this,"TPRSpecializedItem",he,function(){h=this,this.$init=function(){he.$init.call(this),this.FSpecializedEl=null,this.GenericEl=null,this.Index=0,this.Step=0,this.FirstSpecialize=null,this.Params=[],this.SpecializedConstraints=[]},this.$final=function(){this.FSpecializedEl=void 0,this.GenericEl=void 0,this.FirstSpecialize=void 0,this.Params=void 0,this.SpecializedConstraints=void 0,he.$final.call(this)},this.Destroy=function(){this.SpecializedConstraints=rtl.arraySetLength(this.SpecializedConstraints,null,0),he.Destroy.call(this)}}),rtl.createClass(this,"TPRSpecializedTypeItem",h,function(){u=this,this.$init=function(){h.$init.call(this),this.FSpecializedType=null,this.HeaderScope=null,this.ImplProcs=null},this.$final=function(){this.FSpecializedType=void 0,this.HeaderScope=void 0,this.ImplProcs=void 0,h.$final.call(this)},this.SetSpecializedType=function(e){this.FSpecializedType!==e&&(this.FSpecializedEl=e,this.FSpecializedType=e)},this.Destroy=function(){null!==this.ImplProcs&&(rtl.free(this,"ImplProcs"),this.ImplProcs=null),rtl.free(this,"HeaderScope"),this.HeaderScope=null,this.SetSpecializedType(null),h.Destroy.call(this)}}),rtl.createClass(this,"TPRSpecializedProcItem",h,function(){c=this,this.$init=function(){h.$init.call(this),this.FSpecializedProc=null,this.ImplProc=null},this.$final=function(){this.FSpecializedProc=void 0,this.ImplProc=void 0,h.$final.call(this)},this.SetSpecializedProc=function(e){this.FSpecializedProc!==e&&(this.FSpecializedEl=e,this.FSpecializedProc=e)},this.Destroy=function(){null!==this.ImplProc&&(this.ImplProc=null),this.SetSpecializedProc(null),h.Destroy.call(this)}}),s=this.TPSRefAccess={0:"psraNone",psraNone:0,1:"psraRead",psraRead:1,2:"psraWrite",psraWrite:2,3:"psraReadWrite",psraReadWrite:3,4:"psraWriteRead",psraWriteRead:4,5:"psraTypeInfo",psraTypeInfo:5},rtl.createClass(this,"TPasScopeReference",he,function(){p=this,this.$init=function(){he.$init.call(this),this.FElement=null,this.Access=0,this.NextSameName=null},this.$final=function(){this.FElement=void 0,this.NextSameName=void 0,he.$final.call(this)},this.SetElement=function(e){this.FElement!==e&&(this.FElement=e)},this.Destroy=function(){this.SetElement(null),he.Destroy.call(this)}}),rtl.createClass(this,"TPasScopeReferences",he,function(){f=this,this.$init=function(){he.$init.call(this),this.FScope=null,this.References=null},this.$final=function(){this.FScope=void 0,this.References=void 0,he.$final.call(this)},this.OnClearItem=function(e,t){for(var s=null;null!==e;)s=e,e=e.NextSameName,s=rtl.freeLoc(s)},this.Create$1=function(e){return this.References=n.$create("Create$1"),this.FScope=e,this},this.Destroy=function(){this.Clear(),this.References=null,he.Destroy.call(this)},this.Clear=function(){null!==this.References&&(this.References.ForEachCall(rtl.createCallback(this,"OnClearItem"),null),this.References.Clear())},this.Add=function(e,t){var s,i=null,r=null;for(s=Te(e.FName),i=this.References.Find(s),r=null;null!==i;){if(i.FElement===e){var n=t;if(0===n);else if(1===n){var a=i.Access;0===a?i.Access=t:2===a&&(i.Access=4)}else if(2===n){var o=i.Access;0===o?i.Access=t:1===o&&(i.Access=3)}else if(3===n){var h=i.Access;0===h?i.Access=t:1===h?i.Access=3:2===h&&(i.Access=4)}else if(4===n){var u=i.Access;0===u?i.Access=t:1===u?i.Access=3:2===u&&(i.Access=4)}else{if(5!==n)throw l.$create("Create$1",[ye(e)+" unknown Access"]);i.Access=5}return i}r=i,i=i.NextSameName}return(i=p.$create("Create")).SetElement(e),i.Access=t,null===r?this.References.Add(s,i):r.NextSameName=i,i}}),rtl.createClass(this,"TPasScope",Se,function(){d=this,this.$init=function(){Se.$init.call(this),this.VisibilityContext=null},this.$final=function(){this.VisibilityContext=void 0,Se.$final.call(this)},this.IsStoredInElement=function(){return true},this.FreeOnPop=function(){return!this.IsStoredInElement()},this.IterateElements=function(e,t,s,i,r){r.get()}}),this.TPasModuleScopeFlag={0:"pmsfAssertSearched",pmsfAssertSearched:0,1:"pmsfRangeErrorNeeded",pmsfRangeErrorNeeded:1,2:"pmsfRangeErrorSearched",pmsfRangeErrorSearched:2},rtl.createClass(this,"TPasModuleScope",d,function(){F=this,this.$init=function(){d.$init.call(this),this.FAssertClass=null,this.FAssertDefConstructor=null,this.FAssertMsgConstructor=null,this.FRangeErrorClass=null,this.FRangeErrorConstructor=null,this.FSystemTVarRec=null,this.FirstName="",this.PendingResolvers=null,this.Flags={},this.BoolSwitches={}},this.$final=function(){this.FAssertClass=void 0,this.FAssertDefConstructor=void 0,this.FAssertMsgConstructor=void 0,this.FRangeErrorClass=void 0,this.FRangeErrorConstructor=void 0,this.FSystemTVarRec=void 0,this.PendingResolvers=void 0,this.Flags=void 0,this.BoolSwitches=void 0,d.$final.call(this)},this.SetAssertClass=function(e){this.FAssertClass!==e&&(this.FAssertClass=e)},this.SetAssertDefConstructor=function(e){this.FAssertDefConstructor!==e&&(this.FAssertDefConstructor=e)},this.SetAssertMsgConstructor=function(e){this.FAssertMsgConstructor!==e&&(this.FAssertMsgConstructor=e)},this.SetRangeErrorClass=function(e){this.FRangeErrorClass!==e&&(this.FRangeErrorClass=e)},this.SetRangeErrorConstructor=function(e){this.FRangeErrorConstructor!==e&&(this.FRangeErrorConstructor=e)},this.SetSystemTVarRec=function(e){this.FSystemTVarRec!==e&&(this.FSystemTVarRec=e)},this.Create$1=function(){return Se.Create$1.call(this),this.PendingResolvers=ge.$create("Create"),this},this.Destroy=function(){this.SetAssertClass(null),this.SetAssertDefConstructor(null),this.SetAssertMsgConstructor(null),this.SetRangeErrorClass(null),this.SetRangeErrorConstructor(null),this.SetSystemTVarRec(null),Ee({p:this,get:function(){return this.p.PendingResolvers},set:function(e){this.p.PendingResolvers=e}}),Se.Destroy.call(this)},this.IterateElements=function(e,t,s,i,r){0===Pe(e,this.FirstName)&&s(this.FElement,this,t,i,r)}}),this.TPasIdentifierKind={0:"pikNone",pikNone:0,1:"pikBaseType",pikBaseType:1,2:"pikBuiltInProc",pikBuiltInProc:2,3:"pikSimple",pikSimple:3,4:"pikProc",pikProc:4,5:"pikNamespace",pikNamespace:5},rtl.createClass(this,"TPasIdentifier",he,function(){m=this,this.$init=function(){he.$init.call(this),this.FElement=null,this.Identifier="",this.NextSameIdentifier=null,this.Kind=0},this.$final=function(){this.FElement=void 0,this.NextSameIdentifier=void 0,he.$final.call(this)},this.SetElement=function(e){this.FElement!==e&&(this.FElement=e)},this.Destroy=function(){this.SetElement(null),he.Destroy.call(this)}}),rtl.createClass(this,"TPasIdentifierScope",d,function(){C=this,this.$init=function(){d.$init.call(this),this.FItems=null},this.$final=function(){this.FItems=void 0,d.$final.call(this)},this.InternalAdd=function(e){var t,s;s=Te(e.Identifier),null!==(t=this.FItems.Find(s))&&(e.NextSameIdentifier=t),this.FItems.Add(s,e)},this.OnClearItem=function(e,t){for(var s=null;null!==e;)s=e,e=e.NextSameIdentifier,s=rtl.freeLoc(s)},this.Create$1=function(){return this.FItems=n.$create("Create$1"),this},this.Destroy=function(){this.ClearIdentifiers(!0),Se.Destroy.call(this)},this.ClearIdentifiers=function(e){this.FItems.ForEachCall(rtl.createCallback(this,"OnClearItem"),null),e?this.FItems=null:this.FItems.Clear()},this.FindLocalIdentifier=function(e){return this.FItems.Find(Te(e))},this.FindIdentifier=function(e){return this.FindLocalIdentifier(e)},this.RemoveLocalIdentifier=function(e){var t,s=!1,i=null,r=null;for(t=Te(e.FName),i=this.FItems.Find(t),this.FindLocalIdentifier(e.FName),r=null,s=!1;null!==i;)i.FElement!==e?(r=i,i=i.NextSameIdentifier):(null!==r?(r.NextSameIdentifier=i.NextSameIdentifier,i=rtl.freeLoc(i),i=r.NextSameIdentifier):(this.FItems.Remove(t),r=i,i=i.NextSameIdentifier,r=rtl.freeLoc(r),r=null,null!==i&&this.FItems.Add(t,i)),s=!0);return s},this.AddIdentifier=function(e,t,s){var i=null;return(i=m.$create("Create")).Identifier=e,i.SetElement(t),i.Kind=s,this.InternalAdd(i),i},this.IterateLocalElements=function(e,t,s,i,r){var n=null;for(n=this.FindLocalIdentifier(e);null!==n;){if(s(n.FElement,this,t,i,r),r.get())return;n=n.NextSameIdentifier}},this.IterateElements=function(e,t,s,i,r){this.IterateLocalElements(e,t,s,i,r)}}),rtl.createClass(this,"TPasDefaultScope",C,function(){S=this,this.IsStoredInElement=function(){return false}}),rtl.recNewT(this,"TPasIterateFilterData",function(){T=this,this.OnIterate=null,this.Data=null,this.$eq=function(e){return rtl.eqCallback(this.OnIterate,e.OnIterate)&&this.Data===e.Data},this.$assign=function(e){return this.OnIterate=e.OnIterate,this.Data=e.Data,this}}),rtl.createClass(this,"TPRHelperEntry",he,function(){y=this,this.$init=function(){he.$init.call(this),this.Added=0,this.HelperForType=null,this.Helper=null},this.$final=function(){this.HelperForType=void 0,this.Helper=void 0,he.$final.call(this)}}),rtl.createClass(this,"TPasSectionScope",C,function(){g=this,this.$init=function(){C.$init.call(this),this.UsesScopes=null,this.UsesFinished=!1,this.Finished=!1,this.BoolSwitches={},this.ModeSwitches={},this.Helpers=[]},this.$final=function(){this.UsesScopes=void 0,this.BoolSwitches=void 0,this.ModeSwitches=void 0,this.Helpers=void 0,C.$final.call(this)},this.OnInternalIterate=function(e,t,s,i,r){e.$class.ClassType()!==Ie&&e.$class.ClassType()!==Re&&i.OnIterate(e,t,s,i.Data,r)},this.Create$1=function(){return C.Create$1.call(this),this.UsesScopes=ge.$create("Create"),this},this.Destroy=function(){r.ClearHelperList({p:this,get:function(){return this.p.Helpers},set:function(e){this.p.Helpers=e}}),Ee({p:this,get:function(){return this.p.UsesScopes},set:function(e){this.p.UsesScopes=e}}),C.Destroy.call(this)},this.FindIdentifier=function(e){var t=null,s=0,i=null;if(null!==(t=C.FindIdentifier.call(this,e)))return t;for(var r=this.UsesScopes.FCount-1;r>=0;r--)if(s=r,null!==(t=rtl.getObject(this.UsesScopes.Get(s)).FindLocalIdentifier(e))&&(i=t.FElement.$class.ClassType())!==Ie&&i!==Re)return t;return t},this.IterateElements=function(e,t,s,i,r){var n=0,l=T.$new();if(C.IterateElements.call(this,e,t,s,i,r),!r.get()){l.OnIterate=s,l.Data=i;for(var a=this.UsesScopes.FCount-1;a>=0;a--)if(n=a,rtl.getObject(this.UsesScopes.Get(n)).IterateLocalElements(e,t,rtl.createCallback(this,"OnInternalIterate"),l,r),r.get())return}}}),rtl.createClass(this,"TPasInitialFinalizationScope",d,function(){E=this,this.$init=function(){d.$init.call(this),this.References=null},this.$final=function(){this.References=void 0,d.$final.call(this)},this.AddReference=function(e,t){return null===this.References&&(this.References=f.$create("Create$1",[this])),this.References.Add(e,t)},this.Destroy=function(){Ee({p:this,get:function(){return this.p.References},set:function(e){this.p.References=e}}),Se.Destroy.call(this)}}),rtl.createClass(this,"TPasEnumTypeScope",C,function(){P=this,this.$init=function(){C.$init.call(this),this.CanonicalSet=null},this.$final=function(){this.CanonicalSet=void 0,C.$final.call(this)},this.Destroy=function(){this.CanonicalSet=null,C.Destroy.call(this)}}),rtl.createClass(this,"TPasGenericParamsScope",C,function(){I=this}),this.TPSGenericStep={0:"psgsNone",psgsNone:0,1:"psgsInterfaceParsed",psgsInterfaceParsed:1,2:"psgsImplementationParsed",psgsImplementationParsed:2},rtl.createClass(this,"TPasGenericScope",C,function(){R=this,this.$init=function(){C.$init.call(this),this.SpecializedItems=null,this.GenericStep=0,this.SpecializedFromItem=null},this.$final=function(){this.SpecializedItems=void 0,this.SpecializedFromItem=void 0,C.$final.call(this)},this.Destroy=function(){null!==this.SpecializedItems&&(rtl.free(this,"SpecializedItems"),this.SpecializedItems=null),C.Destroy.call(this)}}),rtl.createClass(this,"TPasArrayScope",R,function(){v=this}),rtl.createClass(this,"TPasProcTypeScope",R,function(){A=this}),rtl.createClass(this,"TPasClassOrRecordScope",R,function(){N=this,this.$init=function(){R.$init.call(this),this.DefaultProperty=null,this.ClassConstructor=null,this.ClassDestructor=null},this.$final=function(){this.DefaultProperty=void 0,this.ClassConstructor=void 0,this.ClassDestructor=void 0,R.$final.call(this)}}),rtl.createClass(this,"TPasRecordScope",N,function(){x=this}),this.TPasClassScopeFlag={0:"pcsfAncestorResolved",pcsfAncestorResolved:0,1:"pcsfSealed",pcsfSealed:1,2:"pcsfPublished",pcsfPublished:2},rtl.createClass(this,"TPasClassIntfMap",he,function(){b=this,this.$init=function(){he.$init.call(this),this.Element=null,this.Intf=null,this.Procs=null,this.AncestorMap=null},this.$final=function(){this.Element=void 0,this.Intf=void 0,this.Procs=void 0,this.AncestorMap=void 0,he.$final.call(this)},this.Destroy=function(){this.Element=null,this.Intf=null,Ee({p:this,get:function(){return this.p.Procs},set:function(e){this.p.Procs=e}}),Ee({p:this,get:function(){return this.p.AncestorMap},set:function(e){this.p.AncestorMap=e}}),he.Destroy.call(this)}}),rtl.createClass(this,"TPasClassScope",N,function(){O=this,this.$init=function(){N.$init.call(this),this.AncestorScope=null,this.CanonicalClassOf=null,this.DirectAncestor=null,this.Flags={},this.AbstractProcs=[],this.Interfaces=null},this.$final=function(){this.AncestorScope=void 0,this.CanonicalClassOf=void 0,this.DirectAncestor=void 0,this.Flags=void 0,this.AbstractProcs=void 0,this.Interfaces=void 0,N.$final.call(this)},this.Destroy=function(){var e=0,t=null;if(null!==this.Interfaces){for(var s=0,i=this.Interfaces.FCount-1;s<=i;s++)if(e=s,null===(t=rtl.getObject(this.Interfaces.Get(e))));else if(ve.isPrototypeOf(t));else{if(!b.isPrototypeOf(t))throw pe.$create("Create$1",["[20180322132757] "+r.GetElementDbgPath(this.FElement)+" i="+Ae(e)+" "+ye(t)]);t=rtl.freeLoc(t)}Ee({p:this,get:function(){return this.p.Interfaces},set:function(e){this.p.Interfaces=e}})}this.CanonicalClassOf=null,R.Destroy.call(this)}}),rtl.createClass(this,"TPasGroupScope",C,function(){k=this,this.$init=function(){C.$init.call(this),this.Scopes=[],this.Count=0,this.OnlyTypeMembers=!1},this.$final=function(){this.Scopes=void 0,C.$final.call(this)},this.Add=function(e){for(var t=0,s=0,i=this.Count-1;s<=i;s++)if(t=s,this.Scopes[t]===e)return;if(e.$class.FreeOnPop())throw pe.$create("Create$1",["TPasGroupScope.Add "+ye(e)+" "+ye(e.FElement)]);this.Count===rtl.length(this.Scopes)&&(this.Scopes=rtl.arraySetLength(this.Scopes,null,2*this.Count+4)),this.Scopes[this.Count]=e,this.Count+=1},this.Destroy=function(){this.Scopes=[],this.Count=0,C.Destroy.call(this)},this.IsStoredInElement=function(){return false},this.FindAncestorIdentifier=function(e){for(var t=null,s=0,i=1,r=this.Count-1;i<=r;i++)if(s=i,null!==(t=this.Scopes[s].FindIdentifier(e)))return t;return t=null},this.FindAncestorElement=function(e){var t;return null!==(t=this.FindAncestorIdentifier(e))?t.FElement:null},this.FindIdentifier=function(e){for(var t=null,s=0,i=0,r=this.Count-1;i<=r;i++)if(s=i,null!==(t=this.Scopes[s].FindIdentifier(e)))return t;return t=null},this.IterateElements=function(e,t,s,i,r){for(var n=0,l=0,a=this.Count-1;l<=a;l++)if(n=l,this.Scopes[n].IterateElements(e,t,s,i,r),r.get())return}}),this.TPasProcedureScopeFlag={0:"ppsfIsGroupOverload",ppsfIsGroupOverload:0,1:"ppsfIsSpecialized",ppsfIsSpecialized:1,2:"ppsfIsOverrideOverload",ppsfIsOverrideOverload:2},rtl.createClass(this,"TPasProcedureScope",R,function(){$=this,this.$init=function(){R.$init.call(this),this.DeclarationProc=null,this.ImplProc=null,this.OverriddenProc=null,this.ClassRecScope=null,this.GroupScope=null,this.NestedMembersScope=null,this.SelfArg=null,this.Flags={},this.BoolSwitches={},this.ModeSwitches={},this.References=null},this.$final=function(){this.DeclarationProc=void 0,this.ImplProc=void 0,this.OverriddenProc=void 0,this.ClassRecScope=void 0,this.GroupScope=void 0,this.NestedMembersScope=void 0,this.SelfArg=void 0,this.Flags=void 0,this.BoolSwitches=void 0,this.ModeSwitches=void 0,this.References=void 0,R.$final.call(this)},this.FindIdentifier=function(e){var t=null;return null!==(t=C.FindIdentifier.call(this,e))||null===this.GroupScope?t:t=this.GroupScope.FindIdentifier(e)},this.IterateElements=function(e,t,s,i,r){C.IterateElements.call(this,e,t,s,i,r),r.get()||null!==this.GroupScope&&this.GroupScope.IterateElements(e,t,s,i,r)},this.GetSelfScope=function(){var e=null,t=null;for(e=this;;){if(null!==e.ClassRecScope)return e;for(t=e.FElement.FParent;;){if(null===t)return null;if(Ne.isPrototypeOf(t))break;t=t.FParent}e=rtl.as(t.FParent,xe).FData}return e},this.Destroy=function(){Ee({p:this,get:function(){return this.p.References},set:function(e){this.p.References=e}}),Ee({p:this,get:function(){return this.p.GroupScope},set:function(e){this.p.GroupScope=e}}),this.NestedMembersScope=null,R.Destroy.call(this),this.SelfArg=null},this.AddReference=function(e,t){return null===this.References&&(this.References=f.$create("Create$1",[this])),this.References.Add(e,t)}}),rtl.createClass(this,"TPasPropertyScope",C,function(){D=this,this.$init=function(){C.$init.call(this),this.AncestorProp=null},this.$final=function(){this.AncestorProp=void 0,C.$final.call(this)},this.Destroy=function(){this.AncestorProp=null,C.Destroy.call(this)}}),rtl.createClass(this,"TPasExceptOnScope",C,function(){L=this}),this.TPasWithExprScopeFlag={0:"wesfNeedTmpVar",wesfNeedTmpVar:0,1:"wesfOnlyTypeMembers",wesfOnlyTypeMembers:1,2:"wesfIsClassOf",wesfIsClassOf:2,3:"wesfConstParent",wesfConstParent:3},rtl.createClass(this,"TPasWithExprScope",d,function(){B=this,this.$init=function(){d.$init.call(this),this.WithScope=null,this.Index=0,this.Expr=null,this.Scope=null,this.ClassRecScope=null,this.Flags={}},this.$final=function(){this.WithScope=void 0,this.Expr=void 0,this.Scope=void 0,this.ClassRecScope=void 0,this.Flags=void 0,d.$final.call(this)},this.IsStoredInElement=function(){return false},this.FreeOnPop=function(){return false},this.IterateElements=function(e,t,s,i,r){this.Scope.IterateElements(e,t,s,i,r)},this.Destroy=function(){Ee({p:this,get:function(){return this.p.Scope},set:function(e){this.p.Scope=e}}),Se.Destroy.call(this)}}),rtl.createClass(this,"TPasWithScope",d,function(){M=this,this.$init=function(){d.$init.call(this),this.ExpressionScopes=null},this.$final=function(){this.ExpressionScopes=void 0,d.$final.call(this)},this.Create$1=function(){return Se.Create$1.call(this),this.ExpressionScopes=be.$create("Create$3",[!0]),this},this.Destroy=function(){Ee({p:this,get:function(){return this.p.ExpressionScopes},set:function(e){this.p.ExpressionScopes=e}}),Se.Destroy.call(this)}}),rtl.createClass(this,"TPasForLoopScope",d,function(){G=this,this.$init=function(){d.$init.call(this),this.GetEnumerator=null,this.MoveNext=null,this.Current=null},this.$final=function(){this.GetEnumerator=void 0,this.MoveNext=void 0,this.Current=void 0,d.$final.call(this)}}),rtl.createClass(this,"TPasSubExprScope",C,function(){w=this,this.IsStoredInElement=function(){return false}}),rtl.createClass(this,"TPasDotBaseScope",w,function(){V=this,this.$init=function(){w.$init.call(this),this.GroupScope=null,this.OnlyTypeMembers=!1,this.ConstParent=!1},this.$final=function(){this.GroupScope=void 0,w.$final.call(this)},this.FindIdentifier=function(e){return this.GroupScope.FindIdentifier(e)},this.IterateElements=function(e,t,s,i,r){this.GroupScope.IterateElements(e,t,s,i,r)},this.Destroy=function(){Ee({p:this,get:function(){return this.p.GroupScope},set:function(e){this.p.GroupScope=e}}),C.Destroy.call(this)}}),rtl.createClass(this,"TPasModuleDotScope",V,function(){U=this,this.$init=function(){V.$init.call(this),this.FModule=null,this.ImplementationScope=null,this.InterfaceScope=null,this.SystemScope=null},this.$final=function(){this.FModule=void 0,this.ImplementationScope=void 0,this.InterfaceScope=void 0,this.SystemScope=void 0,V.$final.call(this)},this.OnInternalIterate=function(e,t,s,i,r){e.$class.ClassType()!==Ie&&e.$class.ClassType()!==Re&&i.OnIterate(e,t,s,i.Data,r)},this.SetModule=function(e){this.FModule!==e&&(this.FModule=e)},this.Destroy=function(){this.SetModule(null),V.Destroy.call(this)},this.FindIdentifier=function(e){var t=null;function s(s){var i,r=null;return null!==s&&(r=s.FindLocalIdentifier(e),t=r,null!==r&&((i=r.FElement.$class.ClassType())!==Ie&&i!==Re))}return t=null,s(this.ImplementationScope)||s(this.InterfaceScope)||s(this.SystemScope),t},this.IterateElements=function(e,t,s,i,r){var n=this,l=T.$new();function a(s){return null!==s&&(s.IterateLocalElements(e,t,rtl.createCallback(n,"OnInternalIterate"),l,r),r.get())}l.OnIterate=s,l.Data=i,a(this.ImplementationScope)||a(this.InterfaceScope)||a(this.SystemScope)}}),rtl.createClass(this,"TPasDotEnumTypeScope",V,function(){J=this,this.$init=function(){V.$init.call(this),this.EnumScope=null},this.$final=function(){this.EnumScope=void 0,V.$final.call(this)},this.FindIdentifier=function(e){var t=null;return null!==(t=this.EnumScope.FindLocalIdentifier(e))?t:t=V.FindIdentifier.call(this,e)},this.IterateElements=function(e,t,s,i,r){this.EnumScope.IterateElements(e,t,s,i,r),r.get()||V.IterateElements.call(this,e,t,s,i,r)}}),rtl.createClass(this,"TPasDotClassOrRecordScope",V,function(){j=this,this.$init=function(){V.$init.call(this),this.ClassRecScope=null},this.$final=function(){this.ClassRecScope=void 0,V.$final.call(this)}}),rtl.createClass(this,"TPasDotClassScope",j,function(){H=this,this.$init=function(){j.$init.call(this),this.IsClassOf=!1}}),rtl.createClass(this,"TPasInheritedScope",j,function(){W=this,this.$init=function(){j.$init.call(this),this.AncestorScope=null},this.$final=function(){this.AncestorScope=void 0,j.$final.call(this)},this.FindIdentifier=function(e){var t=null,s=null;if(null!==(t=V.FindIdentifier.call(this,e)))return t;for(s=this.AncestorScope;null!==s;){if(null!==(t=s.FindIdentifier(e)))return t;s=s.AncestorScope}return t},this.IterateElements=function(e,t,s,i,r){var n=null;if(V.IterateElements.call(this,e,t,s,i,r),!r.get())for(n=this.AncestorScope;null!==n;){if(n.IterateElements(e,t,s,i,r),r.get())return;n=n.AncestorScope}}}),rtl.createClass(this,"TPasDotHelperScope",V,function(){Y=this}),this.TResolvedReferenceFlag={0:"rrfDotScope",rrfDotScope:0,1:"rrfImplicitCallWithoutParams",rrfImplicitCallWithoutParams:1,2:"rrfNoImplicitCallWithoutParams",rrfNoImplicitCallWithoutParams:2,3:"rrfNewInstance",rrfNewInstance:3,4:"rrfFreeInstance",rrfFreeInstance:4,5:"rrfVMT",rrfVMT:5,6:"rrfConstInherited",rrfConstInherited:6,7:"rrfUseFields",rrfUseFields:7},rtl.createClass(this,"TResolvedRefContext",he,function(){z=this}),this.TResolvedRefAccess={0:"rraNone",rraNone:0,1:"rraRead",rraRead:1,2:"rraAssign",rraAssign:2,3:"rraReadAndAssign",rraReadAndAssign:3,4:"rraVarParam",rraVarParam:4,5:"rraOutParam",rraOutParam:5,6:"rraParamToUnknownProc",rraParamToUnknownProc:6},this.rraAllRead=rtl.createSet(1,3,4),this.ResolvedToPSRefAccess=[0,1,2,3,3,2,0],rtl.createClass(this,"TResolvedReference",Se,function(){_=this,this.$init=function(){Se.$init.call(this),this.FDeclaration=null,this.Flags={},this.Access=0,this.Context=null,this.WithExprScope=null},this.$final=function(){this.FDeclaration=void 0,this.Flags=void 0,this.Context=void 0,this.WithExprScope=void 0,Se.$final.call(this)},this.SetDeclaration=function(e){this.FDeclaration!==e&&(this.FDeclaration=e)},this.Destroy=function(){this.SetDeclaration(null),Ee({p:this,get:function(){return this.p.Context},set:function(e){this.p.Context=e}}),Se.Destroy.call(this)}}),rtl.createClass(this,"TResolvedRefCtxConstructor",z,function(){K=this,this.$init=function(){z.$init.call(this),this.Typ=null},this.$final=function(){this.Typ=void 0,z.$final.call(this)}}),rtl.createClass(this,"TResolvedRefCtxAttrProc",z,function(){X=this,this.$init=function(){z.$init.call(this),this.Proc=null},this.$final=function(){this.Proc=void 0,z.$final.call(this)}}),i=this.TPasResolverResultFlag={0:"rrfReadable",rrfReadable:0,1:"rrfWritable",rrfWritable:1,2:"rrfAssignable",rrfAssignable:2,3:"rrfCanBeStatement",rrfCanBeStatement:3},rtl.recNewT(this,"TPasResolverResult",function(){q=this,this.BaseType=0,this.SubType=0,this.IdentEl=null,this.LoTypeEl=null,this.HiTypeEl=null,this.ExprEl=null,this.$new=function(){var e=Object.create(this);return e.Flags={},e},this.$eq=function(e){return this.BaseType===e.BaseType&&this.SubType===e.SubType&&this.IdentEl===e.IdentEl&&this.LoTypeEl===e.LoTypeEl&&this.HiTypeEl===e.HiTypeEl&&this.ExprEl===e.ExprEl&&rtl.eqSet(this.Flags,e.Flags)},this.$assign=function(e){return this.BaseType=e.BaseType,this.SubType=e.SubType,this.IdentEl=e.IdentEl,this.LoTypeEl=e.LoTypeEl,this.HiTypeEl=e.HiTypeEl,this.ExprEl=e.ExprEl,this.Flags=rtl.refSet(e.Flags),this}}),this.TPasResolverComputeFlag={0:"rcSetReferenceFlags",rcSetReferenceFlags:0,1:"rcNoImplicitProc",rcNoImplicitProc:1,2:"rcNoImplicitProcType",rcNoImplicitProcType:2,3:"rcConstant",rcConstant:3,4:"rcType",rcType:4,5:"rcCall",rcCall:5},rtl.createClass(this,"TResElDataBuiltInSymbol",Se,function(){Q=this}),rtl.createClass(this,"TResElDataBaseType",Q,function(){Z=this,this.$init=function(){Q.$init.call(this),this.BaseType=0}}),this.TBuiltInProcFlag={0:"bipfCanBeStatement",bipfCanBeStatement:0},rtl.createClass(this,"TResElDataBuiltInProc",Q,function(){ee=this,this.$init=function(){Q.$init.call(this),this.Proc=null,this.Signature="",this.BuiltIn=0,this.GetCallCompatibility=null,this.GetCallResult=null,this.Eval=null,this.FinishParamsExpression=null,this.Flags={}},this.$final=function(){this.Proc=void 0,this.GetCallCompatibility=void 0,this.GetCallResult=void 0,this.Eval=void 0,this.FinishParamsExpression=void 0,this.Flags=void 0,Q.$final.call(this)},this.Destroy=function(){this.Proc=null,Se.Destroy.call(this)}}),rtl.recNewT(this,"TPRFindData",function(){te=this,this.ErrorPosEl=null,this.Found=null,this.ElScope=null,this.StartScope=null,this.SkipGenerics=!1,this.$eq=function(e){return this.ErrorPosEl===e.ErrorPosEl&&this.Found===e.Found&&this.ElScope===e.ElScope&&this.StartScope===e.StartScope&&this.SkipGenerics===e.SkipGenerics},this.$assign=function(e){return this.ErrorPosEl=e.ErrorPosEl,this.Found=e.Found,this.ElScope=e.ElScope,this.StartScope=e.StartScope,this.SkipGenerics=e.SkipGenerics,this}}),rtl.recNewT(this,"TPRFindGenericData",function(){se=this,this.TemplateCount=0,this.LastProc=null,this.$new=function(){var e=Object.create(this);return e.Find=te.$new(),e},this.$eq=function(e){return this.Find.$eq(e.Find)&&this.TemplateCount===e.TemplateCount&&this.LastProc===e.LastProc},this.$assign=function(e){return this.Find.$assign(e.Find),this.TemplateCount=e.TemplateCount,this.LastProc=e.LastProc,this}}),this.TPasResolverOption={0:"proFixCaseOfOverrides",proFixCaseOfOverrides:0,1:"proClassPropertyNonStatic",proClassPropertyNonStatic:1,2:"proPropertyAsVarParam",proPropertyAsVarParam:2,3:"proClassOfIs",proClassOfIs:3,4:"proExtClassInstanceNoTypeMembers",proExtClassInstanceNoTypeMembers:4,5:"proOpenAsDynArrays",proOpenAsDynArrays:5,6:"proProcTypeWithoutIsNested",proProcTypeWithoutIsNested:6,7:"proMethodAddrAsPointer",proMethodAddrAsPointer:7,8:"proSafecallAllowsDefault",proSafecallAllowsDefault:8},rtl.createClass(this,"TPasResolverHub",he,function(){this.$init=function(){he.$init.call(this),this.FOwner=null,this.FinishedInterfaceCount=0},this.$final=function(){this.FOwner=void 0,he.$final.call(this)},this.Create$1=function(e){return this.FOwner=e,this},this.Reset=function(){this.FinishedInterfaceCount=0}}),this.TPasResolverStep={0:"prsInit",prsInit:0,1:"prsParsing",prsParsing:1,2:"prsFinishingModule",prsFinishingModule:2,3:"prsFinishedModule",prsFinishedModule:3},this.TPRResolveAlias={0:"prraNone",prraNone:0,1:"prraSimple",prraSimple:1,2:"prraAlias",prraAlias:2},this.TPRProcTypeDescFlag={0:"prptdUseName",prptdUseName:0,1:"prptdAddPaths",prptdAddPaths:1,2:"prptdResolveSimpleAlias",prptdResolveSimpleAlias:2},rtl.recNewT(this,"TPRParentParams",function(){ie=this,this.InlineSpec=null,this.Params=null,this.$eq=function(e){return this.InlineSpec===e.InlineSpec&&this.Params===e.Params},this.$assign=function(e){return this.InlineSpec=e.InlineSpec,this.Params=e.Params,this}}),this.TPRTemplateCompOp={0:"prtcoAssignToTempl",prtcoAssignToTempl:0,1:"prtcoAssignFromTempl",prtcoAssignFromTempl:1,2:"prtcoEqual",prtcoEqual:2},rtl.createClass(this,"TPasResolver",Oe,function(){re=this,this.TResolveDataListKind={0:"lkBuiltIn",lkBuiltIn:0,1:"lkModule",lkModule:1},this.cExact=0,this.cGenericExact=1,this.cAliasExact=2,this.cCompatible=3,this.cIntToIntConversion=e.btRange,this.cFloatToFloatConversion=74,this.cTypeConversion=1e4,this.cLossyConversion=1e5,this.cIntToFloatConversion=4e5,this.cIncompatible=2147483647,rtl.recNewT(this,"TFindCallElData",function(){ne=this,this.Params=null,this.TemplCnt=0,this.Found=null,this.LastProc=null,this.ElScope=null,this.StartScope=null,this.Distance=0,this.Count=0,this.List=null,this.$eq=function(e){return this.Params===e.Params&&this.TemplCnt===e.TemplCnt&&this.Found===e.Found&&this.LastProc===e.LastProc&&this.ElScope===e.ElScope&&this.StartScope===e.StartScope&&this.Distance===e.Distance&&this.Count===e.Count&&this.List===e.List},this.$assign=function(e){return this.Params=e.Params,this.TemplCnt=e.TemplCnt,this.Found=e.Found,this.LastProc=e.LastProc,this.ElScope=e.ElScope,this.StartScope=e.StartScope,this.Distance=e.Distance,this.Count=e.Count,this.List=e.List,this}}),this.TFindProcKind={0:"fpkProcDeclaration",fpkProcDeclaration:0,1:"fpkProc",fpkProc:1,2:"fpkMethod",fpkMethod:2},rtl.recNewT(this,"TFindProcData",function(){le=this,this.Proc=null,this.Args=null,this.Kind=0,this.FoundOverloadModifier=!1,this.FoundInSameScope=0,this.Found=null,this.ElScope=null,this.StartScope=null,this.FoundNonProc=null,this.$eq=function(e){return this.Proc===e.Proc&&this.Args===e.Args&&this.Kind===e.Kind&&this.FoundOverloadModifier===e.FoundOverloadModifier&&this.FoundInSameScope===e.FoundInSameScope&&this.Found===e.Found&&this.ElScope===e.ElScope&&this.StartScope===e.StartScope&&this.FoundNonProc===e.FoundNonProc},this.$assign=function(e){return this.Proc=e.Proc,this.Args=e.Args,this.Kind=e.Kind,this.FoundOverloadModifier=e.FoundOverloadModifier,this.FoundInSameScope=e.FoundInSameScope,this.Found=e.Found,this.ElScope=e.ElScope,this.StartScope=e.StartScope,this.FoundNonProc=e.FoundNonProc,this}}),rtl.recNewT(this,"TScopeStashState",function(){ae=this,this.ScopeCount=0,this.StashCount=0,this.$eq=function(e){return this.ScopeCount===e.ScopeCount&&this.StashCount===e.StashCount},this.$assign=function(e){return this.ScopeCount=e.ScopeCount,this.StashCount=e.StashCount,this}}),this.$init=function(){Oe.$init.call(this),this.FActiveHelpers=[],this.FAnonymousElTypePostfix="",this.FBaseTypeChar=0,this.FBaseTypeExtended=0,this.FBaseTypeLength=0,this.FBaseTypes=rtl.arraySetLength(null,null,38),this.FBaseTypeString=0,this.FBuiltInProcs=rtl.arraySetLength(null,null,34),this.FDefaultNameSpace="",this.FDefaultScope=null,this.FDynArrayMaxIndex=0,this.FDynArrayMinIndex=0,this.FFinishedInterfaceIndex=0,this.FHub=null,this.FLastCreatedData=rtl.arraySetLength(null,null,2),this.FLastElement=null,this.FLastMsg="",this.FLastMsgArgs=[],this.FLastMsgId=0,this.FLastMsgNumber=0,this.FLastMsgPattern="",this.FLastMsgType=0,this.FLastSourcePos=de.$new(),this.FOptions={},this.FPendingForwardProcs=null,this.FRootElement=null,this.FScopeClass_Array=null,this.FScopeClass_Class=null,this.FScopeClass_InitialFinalization=null,this.FScopeClass_Module=null,this.FScopeClass_Proc=null,this.FScopeClass_ProcType=null,this.FScopeClass_Record=null,this.FScopeClass_Section=null,this.FScopeClass_WithExpr=null,this.FScopeCount=0,this.FScopes=[],this.FStep=0,this.FStoreSrcColumns=!1,this.FStashScopeCount=0,this.FStashScopes=[],this.FTopScope=null,this.cTGUIDToString=0,this.cStringToTGUID=0,this.cInterfaceToTGUID=0,this.cInterfaceToString=0,this.fExprEvaluator=null},this.$final=function(){this.FActiveHelpers=void 0,this.FBaseTypes=void 0,this.FBuiltInProcs=void 0,this.FDefaultScope=void 0,this.FHub=void 0,this.FLastCreatedData=void 0,this.FLastElement=void 0,this.FLastMsgArgs=void 0,this.FLastSourcePos=void 0,this.FOptions=void 0,this.FPendingForwardProcs=void 0,this.FRootElement=void 0,this.FScopeClass_Array=void 0,this.FScopeClass_Class=void 0,this.FScopeClass_InitialFinalization=void 0,this.FScopeClass_Module=void 0,this.FScopeClass_Proc=void 0,this.FScopeClass_ProcType=void 0,this.FScopeClass_Record=void 0,this.FScopeClass_Section=void 0,this.FScopeClass_WithExpr=void 0,this.FScopes=void 0,this.FStashScopes=void 0,this.FTopScope=void 0,this.fExprEvaluator=void 0,Oe.$final.call(this)},this.GetBaseTypes=function(e){return this.FBaseTypes[e]},this.GetScopes=function(e){return this.FScopes[e]},this.ClearResolveDataList=function(e){for(var t=null;null!==this.FLastCreatedData[e];)(t=this.FLastCreatedData[e]).FElement.FData=null,this.FLastCreatedData[e]=t.Next,t=rtl.freeLoc(t)},this.GetBaseTypeNames=function(e){return null!==this.FBaseTypes[e]?this.FBaseTypes[e].FName:r.ResBaseTypeNames[e]},this.GetBuiltInProcs=function(e){return this.FBuiltInProcs[e]},this.OnFindFirst_PreferNoParams=function(e,t,s,i,r){var n=!1,l=null,a=null;n=!0,xe.isPrototypeOf(e)?(l=e,i.SkipGenerics&&null!==(a=this.GetProcTemplateTypes(l))&&a.FCount>0&&(n=!1),n&&this.ProcNeedsParams(l.ProcType)&&(n=!1)):i.SkipGenerics&&ke.isPrototypeOf(e)&&this.GetTypeParameterCount(e)>0&&(n=!1),(n||null===i.Found)&&(i.Found=e,i.ElScope=t,i.StartScope=s),n&&r.set(!0)},this.OnFindFirst=function(e,t,s,i,r){i.Found=e,i.ElScope=t,i.StartScope=s,r.set(!0)},this.OnFindFirst_GenericEl=function(e,t,s,i,r){var n=null,l=null,a=null;if(l=null,ke.isPrototypeOf(e))n=e.GenericTemplateTypes;else{if(!xe.isPrototypeOf(e))return;if(l=e,null!==(a=rtl.as(l.FData,$)).DeclarationProc&&(e=l=a.DeclarationProc),null!==i.LastProc&&!this.IsProcOverloading(i.LastProc,l))return void r.set(!0);i.LastProc=l,n=this.GetProcTemplateTypes(l)}if(null!==n&&n.FCount===i.TemplateCount&&(null===i.Find.Found||!this.ProcNeedsParams(l.ProcType))){if(i.Find.Found=e,i.Find.ElScope=t,i.Find.StartScope=s,null!==l)if(3 in a.ModeSwitches&&!this.IsProcOverload(l));else if(this.ProcNeedsParams(l.ProcType))return;r.set(!0)}},this.OnFindCallElements=function(e,t,s,i,r){var n=null,l=null,a=0,o=null,h=!1,u=null,c=null,p=null,f=null,d=null;if(h=!1,xe.isPrototypeOf(e)){if(n=e,l=null,i.Found===n)return;if(null!==(f=rtl.as(n.FData,$)).DeclarationProc&&(e=n=f.DeclarationProc),3 in f.ModeSwitches&&!this.IsProcOverload(n)&&(r.set(!0),null!==i.LastProc))return;if(xe.isPrototypeOf(i.Found)&&this.IsProcOverride(n,i.Found))return void(i.LastProc=n);if(null!==i.LastProc&&!this.IsProcOverloading(i.LastProc,n))return void r.set(!0);if(xe.isPrototypeOf(i.Found)){if(l=i.Found,this.IsProcOverride(n,l.FData.OverriddenProc))return void(i.LastProc=n);if(0===i.Distance&&l.FParent!==n.FParent&&l.FParent.$class.ClassType()===$e)return void r.set(!0)}h=!0,a=i.TemplCnt>0&&(null===(d=this.GetProcTemplateTypes(n))||d.FCount!==i.TemplCnt)?2147483647:this.CheckCallProcCompatibility(n.ProcType,i.Params,!1,!1),i.LastProc=n}else if(De.isPrototypeOf(e)){if(p=(c=this.ResolveAliasType(e,!0)).$class.ClassType(),0!==i.TemplCnt&&(!p.InheritsFrom(ke)||this.GetTypeParameterCount(c)!==i.TemplCnt))return;if(p===me){if(c.FData.$class.ClassType()===ee){if((o=c.FData).BuiltIn in rtl.createSet(17,18)&&17===o.BuiltIn===this.ParentNeedsExprResult(i.Params))return;a=o.GetCallCompatibility(o,i.Params,!1),h=!0}else if(Z.isPrototypeOf(c.FData)){if(r.set(!0),null!==i.Found)return;a=this.CheckTypeCast(e,i.Params,!1),h=!0}}else if(p===$e||p===Le||p===Be||p===Me||p===Ge||p===we||p===Ve||p===Ue||p===Je||p===je){if(r.set(!0),null!==i.Found)return;a=this.CheckTypeCast(e,i.Params,!1),h=!0}}else if(He.isPrototypeOf(e)){if(r.set(!0),null!==i.Found)return;if(0!==i.TemplCnt)return;u=e.$class.ClassType()===ve?this.GetPasPropertyType(e):e.VarType,u=this.ResolveAliasType(u,!0),we.isPrototypeOf(u)&&(a=this.CheckCallProcCompatibility(u,i.Params,!1,!1),h=!0)}else if(e.$class.ClassType()===We){if(r.set(!0),null!==i.Found)return;if(0!==i.TemplCnt)return;u=this.ResolveAliasType(e.ArgType,!0),we.isPrototypeOf(u)&&(a=this.CheckCallProcCompatibility(u,i.Params,!1,!1),h=!0)}if(!h)return r.set(!0),void(null===i.Found&&this.RaiseMsg(20170216151525,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"(",18,e.ElementTypeName()),i.Params));null===i.Found||2147483647===i.Distance&&a<2147483647?(i.Found=e,i.ElScope=t,i.StartScope=s,i.Distance=a,i.Count=1,null!==i.List&&(i.List.Clear(),i.List.Add(e))):2147483647===a||(i.Distance===a||a>=1e5&&i.Distance>=1e5&&a>=4e5==i.Distance>=4e5?(i.Count+=1,null!==i.List&&(i.List.IndexOf(e)>=0&&this.RaiseInternalError(20160924230805,""),i.List.Add(e))):a<i.Distance&&(a<1e5||a>=4e5!=i.Distance>=4e5?(i.Count=1,null!==i.List&&i.List.Clear()):i.Count+=1,i.Found=e,i.ElScope=t,i.StartScope=s,i.Distance=a,null!==i.List&&i.List.Add(e)))},this.OnFindProc=function(e,t,s,i,n){var l,a=null,o=null,h=!1,u=null;function c(){i.FoundInSameScope+=1,a.IsOverload()&&(i.FoundOverloadModifier=!0)}if(o=i.Proc,xe.isPrototypeOf(e))if(a=e,e!==o){l=this.CheckProcOverloadCompatibility(o,a);var p=i.Kind;1===p?h=o.GetModule()===a.GetModule():2===p?h=o.FParent===a.FParent:this.RaiseNotYetImplemented(20191010123525,o,""),h?(2 in this.FCurrentParser.GetCurrentModeSwitches()&&(r.ProcHasGroupOverload(o)?a.FData.Flags=rtl.includeSet(a.FData.Flags,0):r.ProcHasGroupOverload(a)&&(o.FData.Flags=rtl.includeSet(o.FData.Flags,0))),l?this.RaiseMsg(20171118221821,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,a.FName,18,this.GetElementSourcePosStr(a)),o.ProcType):(3 in this.FCurrentParser.GetCurrentModeSwitches()&&(this.IsProcOverload(a)?o.IsOverload()||o.IsOverride()||null!==o.FData.OverriddenProc&&2 in o.FData.Flags||this.RaiseMsg(20171118222147,3076,rtl.getResStr(Ce,"sOverloadedProcMissesOverload"),Ye(18,this.GetElementSourcePosStr(a)),o.ProcType):this.RaiseMsg(20171118222112,3075,rtl.getResStr(Ce,"sPreviousDeclMissesOverload"),Ye(18,a.FName,18,this.GetElementSourcePosStr(a)),o.ProcType)),c())):o.IsOverride()||o.IsReintroduced()||r.ProcHasGroupOverload(o)||(l||1===i.FoundInSameScope)&&(2===i.Kind&&(a.IsVirtual()||a.IsOverride())?this.LogMsg(20170216151712,2,3077,rtl.getResStr(Ce,"sMethodHidesMethodOfBaseType"),Ye(18,o.FName,18,a.FParent.FName,18,this.GetElementSourcePosStr(a)),o.ProcType):ze.isPrototypeOf(o.FParent)&&(u=rtl.as(a.FData,$),6===a.Visibility||1===a.Visibility&&a.GetModule()!==o.GetModule()||4===a.Visibility||(null===u.ImplProc||this.ProcHasImplElements(u.ImplProc))&&(_e.isPrototypeOf(a)&&o.$class.ClassType()===a.$class.ClassType()||(l?this.LogMsg(20190316152656,4,3125,rtl.getResStr(Ce,"sMethodHidesNonVirtualMethodExactly"),Ye(18,this.GetElementSourcePosStr(a)),o.ProcType):this.LogMsg(20171118214523,4,3021,rtl.getResStr(Ce,"sFunctionHidesIdentifier"),Ye(18,this.GetElementSourcePosStr(a)),o.ProcType)))),n.set(!0)),l&&(i.Found=a,i.ElScope=t,i.StartScope=s,n.set(!0))}else c();else{if(He.isPrototypeOf(e)){if(6===e.Visibility)return;if(1===e.Visibility&&e.GetModule()!==s.FElement.GetModule())return}if(i.FoundNonProc=e,n.set(!0),ee.isPrototypeOf(e.FData)&&(i.FoundOverloadModifier||this.IsProcOverload(o)))return;var f=i.Kind;1===f?o.GetModule()===e.GetModule()?this.RaiseMsg(20170216151649,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,e.FName,18,this.GetElementSourcePosStr(e)),o.ProcType):ze.isPrototypeOf(o.FParent)&&(6===e.Visibility||1===e.Visibility&&e.GetModule()!==o.GetModule()||this.LogMsg(20171118205344,4,3112,rtl.getResStr(Ce,"sFunctionHidesIdentifier"),Ye(18,this.GetElementSourcePosStr(e)),o.ProcType)):2===f&&(u=o.FData,3 in rtl.as(u.Owner,re).FCurrentParser.GetCurrentModeSwitches()||this.RaiseMsg(20171118232543,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,e.FName,18,this.GetElementSourcePosStr(e)),o.ProcType))}},this.OnFindProcDeclaration=function(e,t,s,i,r){var n;if(!xe.isPrototypeOf(e))return i.FoundNonProc=e,void r.set(!0);e!==i.Proc&&(n=e,this.CheckProcOverloadCompatibility(i.Proc,n)&&(i.Found=n,i.ElScope=t,i.StartScope=s,r.set(!0)))},this.IsSameProcContext=function(e,t){if(e===t)return!0;if(e.$class.ClassType()===Ke){if(t.$class.ClassType()===Xe&&t.FParent===e.FParent)return!0}else if(t.$class.ClassType()===Ke&&e.$class.ClassType()===Xe&&e.FParent===t.FParent)return!0;return false},this.IsProcOverloading=function(e,t){if(3 in e.FData.ModeSwitches){if(!this.IsProcOverload(e)||!this.IsProcOverload(t))return!1}else if(this.IsSameProcContext(e.FParent,t.FParent));else if(!r.ProcHasGroupOverload(e))return!1;return true},this.FindProcSameSignature=function(e,t,s,i){var r=le.$new(),n=!1;return r.$assign(le.$new()),r.Proc=t,r.Args=t.ProcType.Args,r.Kind=0,n=!1,i?s.IterateLocalElements(e,s,rtl.createCallback(this,"OnFindProcDeclaration"),r,{get:function(){return n},set:function(e){n=e}}):s.IterateElements(e,s,rtl.createCallback(this,"OnFindProcDeclaration"),r,{get:function(){return n},set:function(e){n=e}}),r.Found},this.SetCurrentParser=function(e){var t=null;e!==this.FCurrentParser&&(this.Clear(),Oe.SetCurrentParser.call(this,e),null!==this.FCurrentParser&&(this.FCurrentParser.SetOptions(rtl.unionSet(this.FCurrentParser.FOptions,r.po_Resolver)),null!==this.FCurrentParser.FScanner&&(null===(t=this.FCurrentParser.FScanner).FOnWarnDirective&&(t.FOnWarnDirective=rtl.createCallback(this,"ScannerWarnDirective")),t.SetNonToken(100))))},this.ScannerWarnDirective=function(e,t,s,i){var r=[],n=0;if(this.$class.GetWarnIdentifierNumbers(t,{get:function(){return r},set:function(e){r=e}})){i.set(!0);for(var l=0,a=rtl.length(r)-1;l<=a;l++)n=l,e.SetWarnMsgState(r[n],s)}},this.SetRootElement=function(e){this.FRootElement!==e&&(this.FRootElement=e)},this.CheckTopScope=function(e,t){var s=null;null===(s=this.FTopScope)&&this.RaiseInternalError(20160922163319,"Expected TopScope="+e.$classname+" but found nil"),s.$class.ClassType()!==e&&(t&&s.$class.InheritsFrom(e)||this.RaiseInternalError(20160922163323,"Expected TopScope="+e.$classname+" but found "+s.$classname))},this.AddIdentifier=function(e,t,s,i){var r=this;function n(e,t){for(var s=null;null!==e;){if(s=e.FElement,ke.isPrototypeOf(s)){if(r.GetTypeParameterCount(s)===t)break}else if(0===t)break;e=e.NextSameIdentifier}return e}var l,a,o=null,h=null,u=null,c=null,p=0,f=0,d=null,F=!1;if(""===t)return null;if(a=3 in this.FCurrentParser.GetCurrentModeSwitches(),k.isPrototypeOf(e)?e=(o=e).Scopes[0]:o=null,ke.isPrototypeOf(s)?(F=!0,f=this.GetTypeParameterCount(s)):(F=!1,f=0),4===s.Visibility&&((c=s.$class.ClassType())===ve||c===He||c===xe||c===qe||this.RaiseMsg(20170403223024,3053,rtl.getResStr(Ce,"sSymbolCannotBePublished"),[],s)),3===i&&null!==o&&s.$class.ClassType()!==ve&&!a)for(var m=1,C=o.Count-1;m<=C;m++)for(p=m,h=o.Scopes[p].FindLocalIdentifier(t),F&&(h=n(h,f));null!==h;){if(u=h.FElement,h=h.NextSameIdentifier,He.isPrototypeOf(u)){if(6===u.Visibility)continue;if(1===u.Visibility&&u.GetModule()!==s.GetModule())continue}this.RaiseMsg(20170221130001,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,t,18,this.GetElementSourcePosStr(u)),s)}if(h=(l=e.AddIdentifier(t,s,i)).NextSameIdentifier,F&&a&&(h=n(h,f)),null!==h&&((u=h.FElement).$class.ClassType()===Qe&&u.FParent.FParent!==e.FElement?(null!==h.NextSameIdentifier&&this.RaiseNotYetImplemented(20190807114726,s,this.GetElementSourcePosStr(u)),e.RemoveLocalIdentifier(u),h=null,u=null):4===s.Visibility&&xe.isPrototypeOf(s)&&xe.isPrototypeOf(u)?this.RaiseMsg(20190626175432,3126,rtl.getResStr(Ce,"sDuplicatePublishedMethodXAtY"),Ye(18,t,18,this.GetElementSourcePosStr(u)),s):3!==l.Kind&&3!==h.Kind||this.RaiseMsg(20170216151530,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,t,18,this.GetElementSourcePosStr(u)),s)),e===this.FTopScope&&g.isPrototypeOf(e)&&(d=this.GetScopes(this.FScopeCount-2),g.isPrototypeOf(d))){h=d.FindLocalIdentifier(t);do{if(F&&(h=n(h,f)),null===h)break;u=h.FElement,5===l.Kind||5===h.Kind||3!==l.Kind&&3!==h.Kind||this.RaiseMsg(20190818141630,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,t,18,this.GetElementSourcePosStr(u)),s),h=h.NextSameIdentifier}while(null!==h)}return l},this.AddModule=function(e){var t,s=null;null===this.FHub&&this.RaiseNotYetImplemented(20200815182122,e,""),this.FTopScope!==this.FDefaultScope&&this.RaiseInvalidScopeForElement(20160922163504,e,""),(s=this.PushScope$1(e,this.FScopeClass_Module)).VisibilityContext=e,s.FirstName=r.FirstDottedIdentifier(e.FName),t=e.$class.ClassType(),this.FDefaultNameSpace=t===Ze||t===et||t===tt?r.ChompDottedIdentifier(e.FName):"",s.BoolSwitches=rtl.refSet(this.FCurrentParser.FScanner.FCurrentBoolSwitches)},this.AddSection=function(e){var t=null;g.isPrototypeOf(this.FTopScope)&&this.FinishSection(rtl.as(this.FTopScope.FElement,st)),F.isPrototypeOf(this.FTopScope)&&(this.FTopScope.BoolSwitches=rtl.refSet(this.FCurrentParser.FScanner.FCurrentBoolSwitches)),this.FPendingForwardProcs.Add(e),(t=this.PushScope$1(e,this.FScopeClass_Section)).BoolSwitches=rtl.refSet(this.FCurrentParser.FScanner.FCurrentBoolSwitches),t.ModeSwitches=rtl.refSet(this.FCurrentParser.FScanner.FCurrentModeSwitches)},this.AddInitialFinalizationSection=function(e){this.PushScope$1(e,this.FScopeClass_InitialFinalization)},this.AddType=function(e){""!==e.FName&&(C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20160922163506,e,""),this.AddIdentifier(this.FTopScope,e.FName,e,3))},this.AddArrayType=function(e,t){var s=null;null!==t&&(e.SetGenericTemplates(t),t=e.GenericTemplateTypes,this.CheckGenericTemplateTypes(e)),this.PopGenericParamScope(e),""!==e.FName?(C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20190812215622,e,""),this.AddIdentifier(this.FTopScope,e.FName,e,3),null!==t&&(s=this.PushScope$1(e,this.FScopeClass_Array),this.AddGenericTemplateIdentifiers(t,s))):null!==t&&this.RaiseNotYetImplemented(20190812215851,e,"")},this.AddRecordType=function(e,t){var s,i=null;s=e.FParent.$class.ClassType(),""===e.FName&&(s===He||s===it||s===rt||this.RaiseMsg(20220321224331,3056,rtl.getResStr(Ce,"sCannotNestAnonymousX"),Ye(18,"record"),e),null!==t&&this.RaiseNotYetImplemented(20220322220743,e,""),this.DeanonymizeType(e)),null!==t&&(e.SetGenericTemplates(t),t=e.GenericTemplateTypes,this.CheckGenericTemplateTypes(e)),this.PopGenericParamScope(e),C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20160922163508,e,""),""!==e.FName&&(this.AddIdentifier(this.FTopScope,e.FName,e,3),this.FPendingForwardProcs.Add(e)),s!==rt&&((i=this.PushScope$1(e,this.FScopeClass_Record)).VisibilityContext=e,null!==t&&(""===e.FName&&this.RaiseNotYetImplemented(20190812220821,e,""),this.AddGenericTemplateIdentifiers(t,i)))},this.AddRecordVariant=function(e){},this.AddClassType=function(e,t){var s=null,i=null,r=null,n=0,l=0,a=0,o=null,h=null,u=null,c=[],p=[],f=null,d=null,F=null,m=0,S=q.$new(),T=q.$new();for(C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20160922163510,e,""),null===t?(n=0,I.isPrototypeOf(this.FTopScope)&&this.RaiseNotYetImplemented(20190831205006,e,ye(this.FTopScope)),r=this.FTopScope):(I.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20190831205038,e,ye(this.FTopScope)),r=this.GetScopes(this.FScopeCount-2),n=t.FCount,e.SetGenericTemplates(t),t=e.GenericTemplateTypes,this.CheckGenericTemplateTypes(e)),s=(k.isPrototypeOf(r)?r.Scopes[0]:r).FindLocalIdentifier(e.FName);null!==s&&(f=s.FElement,!ke.isPrototypeOf(f)||this.GetTypeParameterCount(f)!==n);)s=s.NextSameIdentifier;if(null!==s&&$e.isPrototypeOf(s.FElement)&&s.FElement.IsForward&&s.FElement.FParent===e.FParent){if(i=s.FElement,n>0)for(var y=0,g=n-1;y<=g;y++){l=y,h=rtl.getObject(i.GenericTemplateTypes.Get(l)),u=rtl.getObject(t.Get(l)),nt(h.FName,u.FName)||this.RaiseMsg(20190814114811,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetTypeDescription(u,!1),18,this.GetElementSourcePosStr(h)),u),c=h.Constraints,p=u.Constraints,rtl.length(c)!==rtl.length(p)&&this.RaiseMsg(20190814121031,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetTypeDescription(u,!1),18,this.GetElementSourcePosStr(h)),u);for(var E=0,P=rtl.length(c)-1;E<=P;E++)d=c[a=E],F=p[a],(m=this.GetGenericConstraintKeyword(d))!==this.GetGenericConstraintKeyword(F)&&this.RaiseMsg(20190814121139,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetTypeDescription(u,!1),18,this.GetElementSourcePosStr(d)),this.GetGenericConstraintErrorEl(F,u)),0===m&&(this.ComputeElement(d,S,rtl.createSet(4),null),this.ComputeElement(F,T,rtl.createSet(4),null),0!==this.CheckElTypeCompatibility(S.LoTypeEl,T.LoTypeEl,0)&&this.RaiseMsg(20190814121509,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetTypeDescription(u,!1),18,this.GetElementSourcePosStr(this.GetGenericConstraintErrorEl(d,h))),this.GetGenericConstraintErrorEl(F,u)))}null!==i.FData&&(o=rtl.as(i.FData,O),null!==e.FData&&this.RaiseInternalError(20190803202959,"real class has already customdata"),i.FData=null,e.FData=o,o.SetElement(e)),this.CreateReference(e,i,1,null),s.SetElement(e)}else this.AddIdentifier(r,e.FName,e,3);this.FPendingForwardProcs.Add(e)},this.AddVariable=function(e){""!==e.FName&&(C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20160929205730,e,""),this.AddIdentifier(this.FTopScope,e.FName,e,3))},this.AddResourceString=function(e){C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20171004092114,e,""),e.FParent.$class.ClassType().InheritsFrom(st)||this.RaiseNotYetImplemented(20171004092518,e,""),this.AddIdentifier(this.FTopScope,e.FName,e,3)},this.AddExportSymbol=function(e){},this.AddEnumType=function(e){var t=null,s=null;C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20160929205732,e,""),""!==e.FName&&this.AddIdentifier(this.FTopScope,e.FName,e,3),s=this.PushScope$1(e,P),lt.isPrototypeOf(e.FParent)?t=e.FParent:(t=this.CreateOwnedElement(lt,"",e)).EnumType=e,s.CanonicalSet=t},this.AddEnumValue=function(e){var t=0,s=null,i=null,r=null;if(P.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20160929205736,e,""),this.AddIdentifier(this.FTopScope,e.FName,e,3),!(26 in this.FCurrentParser.FScanner.FCurrentBoolSwitches)||lt.isPrototypeOf(e.FParent.FParent))for(var n=this.FScopeCount-2;n>=0;n--){if(t=n,s=this.GetScopes(t),k.isPrototypeOf(s)&&(s=s.Scopes[0]),!N.isPrototypeOf(s)){if($.isPrototypeOf(s)||g.isPrototypeOf(s)){null!==(i=s.FindLocalIdentifier(e.FName))&&this.RaiseMsg(20170216152224,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,e.FName,18,this.GetElementSourcePosStr(i.FElement)),e),s.AddIdentifier(e.FName,e,3);break}break}if(null===(i=s.FindIdentifier(e.FName))&&s.AddIdentifier(e.FName,e,3),r=rtl.as(s.FElement,ze),this.GetTypeParameterCount(r)>0)break}},this.AddProperty=function(e){""===e.FName&&this.RaiseNotYetImplemented(20160922163518,e,""),N.isPrototypeOf(this.GetLocalScope())||this.RaiseInvalidScopeForElement(20160922163520,e,""),this.AddIdentifier(this.FTopScope,e.FName,e,3),this.PushScope$1(e,D)},this.AddProcedureType=function(e,t){var s=null;""!==e.FName?(xe.isPrototypeOf(e.FParent)&&this.RaiseNotYetImplemented(20190911102852,e,at(e.FParent)),null!==t&&(e.SetGenericTemplates(t),t=e.GenericTemplateTypes,this.CheckGenericTemplateTypes(e)),this.PopGenericParamScope(e),C.isPrototypeOf(this.FTopScope)||this.RaiseInvalidScopeForElement(20190813193703,e,""),this.AddIdentifier(this.FTopScope,e.FName,e,3),null!==t&&(s=this.PushScope$1(e,this.FScopeClass_ProcType),this.AddGenericTemplateIdentifiers(t,s))):(null!==t&&this.RaiseNotYetImplemented(20190813193745,e,""),null===e.FParent&&this.RaiseNotYetImplemented(20220320122040,e,""),xe.isPrototypeOf(e.FParent)||(e.FParent.$class.ClassType().InheritsFrom(He)||this.RaiseMsg(20220320165827,3056,rtl.getResStr(Ce,"sCannotNestAnonymousX"),Ye(18,r.GetElementTypeName(e)),e),this.DeanonymizeType(e)))},this.AddProcedure=function(e,t){var s=this;function i(t,i){null!==i.get()&&s.RaiseMsg(20181231144353,3062,rtl.getResStr(Ce,"sMultipleXinTypeYNameZCAandB"),Ye(18,r.GetElementTypeName(e),18,r.GetElementTypeName(t.FElement),18,t.FElement.FName,18,i.get().FName,18,e.FName),e),i.set(e)}function n(e,t,i,n,l){var a=0,o=null,h=null;for(a=0,o=i.FindLocalIdentifier(e);null!==o;){if(h=o.FElement,ze.isPrototypeOf(h)||s.RaiseXExpectedButYFound(20170216152557,"class",h.FName+":"+r.GetElementTypeName(h),l),a+=1,null===n.get()&&n.set(h),s.GetTypeParameterCount(h)===t)return n.set(h),a;o=o.NextSameIdentifier}return a}function l(e,t,i,r,l){var a=null,o=0;return a=null,null!==e?o=n(t,i,e,{get:function(){return a},set:function(e){a=e}},l):C.isPrototypeOf(s.FTopScope)&&(o=n(t,i,s.FTopScope,{get:function(){return a},set:function(e){a=e}},l),null!==a&&i===s.GetTypeParameterCount(a)||g.isPrototypeOf(s.FTopScope)&&s.FScopeCount>1&&g.isPrototypeOf(s.GetScopes(s.FScopeCount-2))&&(o+=n(t,i,s.GetScopes(s.FScopeCount-2),{get:function(){return a},set:function(e){a=e}},l))),null===a&&s.RaiseMsg(20190818112356,3087,rtl.getResStr(Ce,"sClassXNotFoundInThisModule"),Ye(18,t+ot(i)),l),i===s.GetTypeParameterCount(a)?a:r||0!==i||1!==o?(s.RaiseMsg(20190818112856,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,a.FName+ot(s.GetTypeParameterCount(a)),18,t+ot(i)),l),a):a}var a,o,h="",u="",c=0,p=null,f=null,d=!1,m=null,S=null,T=null,y=null,E=0,P=0,R=0,v=null,A=null,x=null,b=null;if(null!==t&&(e.SetNameParts(t),t=e.NameParts,I.isPrototypeOf(this.FTopScope)&&this.PopScope(),function(){for(var i=0,r=0,n=null,l=null,a=0,o=t.FCount-1;a<=o;a++)if(i=a,null!==(n=rtl.getObject(t.Get(i)).Templates))for(var h=0,u=n.FCount-1;h<=u;h++)r=h,l=rtl.getObject(n.Get(r)),nt(l.FName,e.FName)&&s.RaiseMsg(20190912174817,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),[],l)}()),y=(T=this.FTopScope).$class.ClassType()===k?T.Scopes[0]:T,h=e.FName,""!==e.FName?C.isPrototypeOf(y)||this.RaiseInvalidScopeForElement(20160922163522,e,""):(null!==t&&this.RaiseNotYetImplemented(20190818101856,e,""),(S=y.$class.ClassType())===this.FScopeClass_InitialFinalization||S.InheritsFrom($)||S===M||S===this.FScopeClass_WithExpr||S===L||S===G||this.RaiseInvalidScopeForElement(20181210173134,e,"")),a=r.GetFirstDotPos(h)>1,null!==t&&a!==t.FCount>1&&this.RaiseNotYetImplemented(20190818093923,e,""),o=e.$class.ClassType()===ht||e.$class.ClassType()===ut,p=null,$.isPrototypeOf(e.FData))null!==(f=e.FData).DeclarationProc&&(t=f.DeclarationProc.NameParts),null!==(m=f.ClassRecScope)&&(p=m.FElement,this.GetTypeParameterCount(p)>0&&this.RaiseNotYetImplemented(20190804175518,e,""),null!==f.GroupScope&&this.RaiseNotYetImplemented(20190804175451,e,""),!a&&o&&(e.$class.ClassType()===ht?i(m,{p:m,get:function(){return this.p.ClassConstructor},set:function(e){this.p.ClassConstructor=e}}):i(m,{p:m,get:function(){return this.p.ClassDestructor},set:function(e){this.p.ClassDestructor=e}}))),this.PushScope(f);else{if(d=3 in this.FCurrentParser.GetCurrentModeSwitches(),!a&&o&&(""===h&&this.RaiseNotYetImplemented(20181231145302,e,""),N.isPrototypeOf(y)||this.RaiseInvalidScopeForElement(20181231143831,e,""),m=y,e.$class.ClassType()===ht?i(m,{p:m,get:function(){return this.p.ClassConstructor},set:function(e){this.p.ClassConstructor=e}}):i(m,{p:m,get:function(){return this.p.ClassDestructor},set:function(e){this.p.ClassDestructor=e}}),null!==t&&this.RaiseMsg(20190818094753,3136,rtl.getResStr(Ce,"sTypeParamsNotAllowedOnX"),Ye(18,e.ElementTypeName()),e)),a||""===h||o||this.AddIdentifier(T,h,e,4),(f=this.CreateScope(e,this.FScopeClass_Proc)).ModeSwitches=rtl.refSet(this.FCurrentParser.GetCurrentModeSwitches()),a){for(p=null,E=0;;){if(E+=1,(c=r.GetFirstDotPos(h))<1){null===p&&this.RaiseInternalError(20161013170829,"");break}if(u=r.FirstDottedIdentifier(h),ct({get:function(){return h},set:function(e){h=e}},1,c),P=0,null!==t){if(E>t.FCount&&this.RaiseNotYetImplemented(20190818122217,e,""),(v=rtl.getObject(t.Get(E-1))).Name!==u&&this.RaiseNotYetImplemented(20190818102541,e,Ae(E)+": "+v.Name+"<>"+u),null!==v.Templates)for(var O=0,D=(P=v.Templates.FCount)-1;O<=D;O++)R=O,A=rtl.getObject(v.Templates.Get(R)),rtl.length(A.Constraints)>0&&this.RaiseMsg(20190818102850,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,":",18,A.FName),A)}else v=null;if(r.IsValidIdent(u,!1,!1)||this.RaiseNotYetImplemented(20161013170844,e,""),p=l(null!==p?m=p.FData:null,u,P,d,e),$e.isPrototypeOf(p)&&(p.ObjKind in rtl.unionSet(rtl.createSet(1),Fe.okAllHelpers)||(u=pt(e.FName,e.FName.length-h.length-1),this.RaiseXExpectedButYFound(20180321161722,"class",u+ot(this.GetTypeParameterCount(p))+":"+r.GetElementTypeName(p),e))),p.GetModule()!==e.GetModule()&&this.RaiseNotYetImplemented(20190818120051,e,""),null!==v)for(var B=0,w=P-1;B<=w;B++)R=B,A=rtl.getObject(v.Templates.Get(R)),x=rtl.getObject(p.GenericTemplateTypes.Get(R)),nt(A.FName,x.FName)||this.RaiseMsg(20190822014652,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,x.FName,18,A.FName),A)}r.IsValidIdent(h,!1,!1)||this.RaiseNotYetImplemented(20161013170956,e,""),f.VisibilityContext=p,f.ClassRecScope=rtl.as(r.NoNil(p.FData),N),null!==t&&(E!==t.FCount&&this.RaiseNotYetImplemented(20190818122315,e,""),(v=rtl.getObject(t.Get(E-1))).Name!==h&&this.RaiseNotYetImplemented(20190818122551,e,Ae(E)+": "+v.Name+"<>"+h))}this.PushScope(f)}if(a&&(this.FTopScope!==f&&this.RaiseNotYetImplemented(20191014235935,e,ye(this.FTopScope)),f.GroupScope=this.CreateGroupScope(p,!0),ze.isPrototypeOf(p.FParent))){for(p=p.FParent,b=this.CreateGroupScope(p,!0),f.NestedMembersScope=b,b.OnlyTypeMembers=!0,R=0;R<this.FScopeCount&&!F.isPrototypeOf(this.FScopes[R]);)R+=1;for(this.InsertScope(b,R+1);ze.isPrototypeOf(p.FParent);)p=p.FParent,this.GroupScope_AddTypeAndAncestors(b,p,!0)}null!==t&&null!==(v=rtl.getObject(t.Get(t.FCount-1)))&&this.AddGenericTemplateIdentifiers(v.Templates,f)},this.AddProcedureBody=function(e){this.CheckTopScope(this.FScopeClass_Proc,!1)},this.AddArgument=function(e){var t=null,s=0,i=null,r=null;if(""===e.FName&&this.RaiseInternalError(20160922163526,ye(e)),null===(r=this.FTopScope)&&this.RaiseInvalidScopeForElement(20160922163529,e,""),e.FParent.$class.ClassType()===ve)r.$class.ClassType()!==D&&this.RaiseInvalidScopeForElement(20161014124530,e,""),this.AddIdentifier(r,e.FName,e,3);else if(we.isPrototypeOf(e.FParent))if(t=e.FParent,xe.isPrototypeOf(t.FParent))r.$class.ClassType()!==this.FScopeClass_Proc&&this.RaiseInvalidScopeForElement(20160922163529,e,ye(this.FTopScope)),this.AddIdentifier(r,e.FName,e,3);else for(var n=0,l=t.Args.FCount-1;n<=l;n++)s=n,(i=rtl.getObject(t.Args.Get(s)))!==e&&0===Pe(rtl.getObject(t.Args.Get(s)).FName,e.FName)&&this.RaiseMsg(20170216152225,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,i.FName,18,this.GetElementSourcePosStr(i)),e);else this.RaiseNotYetImplemented(20161014124937,e,"")},this.AddFunctionResult=function(e){var t=null;if((t=this.FTopScope).$class.ClassType()===this.FScopeClass_Proc){if(we.isPrototypeOf(e.FParent)){if(!xe.isPrototypeOf(e.FParent.FParent))return}else if(!xe.isPrototypeOf(e.FParent))return;this.AddIdentifier(t,r.ResolverResultVar,e,3)}},this.AddGenericTemplateType=function(e){var t,s=null;I.isPrototypeOf(this.FTopScope)?(s=this.FTopScope).FElement.FParent!==e.FParent&&this.RaiseNotYetImplemented(20190831203132,e,ye(s.FElement)):(null!==e.FData&&this.RaiseNotYetImplemented(20190831202627,e,ye(e.FData)),s=I.$create("Create$1"),this.AddResolveData(e,s,1),this.PushScope(s)),null!==(t=s.FindIdentifier(e.FName))&&this.RaiseMsg(20190831202920,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,t.Identifier,18,this.GetElementSourcePosStr(t.FElement)),e),s.AddIdentifier(e.FName,e,3)},this.AddExceptOn=function(e){this.PushScope$1(e,L)},this.AddWithDo=function(e){M.FreeOnPop()&&this.RaiseInternalError(20181210162344,""),this.PushScope$1(e,M)},this.ResolveImplBlock=function(e){var t=0;if(null!==e)for(var s=0,i=e.Elements.FCount-1;s<=i;s++)t=s,this.ResolveImplElement(rtl.getObject(e.Elements.Get(t)))},this.ResolveImplElement=function(e){var t;null!==e&&((t=e.$class.ClassType())===ft?this.ResolveImplBlock(e):t===dt?this.ResolveImplAssign(e):t===Ft?this.ResolveImplSimple(e):t===mt?this.ResolveImplBlock(e):t===Ct?(this.ResolveImplBlock(e),this.ResolveStatementConditionExpr(e.ConditionExpr)):t===St?(this.ResolveStatementConditionExpr(e.ConditionExpr),this.ResolveImplElement(e.IfBranch),this.ResolveImplElement(e.ElseBranch)):t===Tt?(this.ResolveStatementConditionExpr(e.ConditionExpr),this.ResolveImplElement(e.Body)):t===yt?this.ResolveImplCaseOf(e):t===gt?this.ResolveImplLabelMark(e):t===Et?this.ResolveImplElement(e.Body):t===Pt?(this.ResolveImplBlock(e),this.ResolveImplBlock(e.FinallyExcept),this.ResolveImplBlock(e.ElseBranch)):t===It||(t===Rt?this.ResolveImplRaise(e):t===vt?""!==e.Command&&this.RaiseNotYetImplemented(20160922163442,e,"TPasResolver.ResolveImplElement"):t===At?this.ResolveImplAsm(e):t===Nt?this.ResolveImplWithDo(e):this.RaiseNotYetImplemented(20160922163445,e,"TPasResolver.ResolveImplElement")))};var t=rtl.recNewT(null,"",function(){this.RangeStart=0,this.RangeEnd=0,this.Expr=null,this.aString="",this.$eq=function(e){return this.RangeStart===e.RangeStart&&this.RangeEnd===e.RangeEnd&&this.Expr===e.Expr&&this.aString===e.aString},this.$assign=function(e){return this.RangeStart=e.RangeStart,this.RangeEnd=e.RangeEnd,this.Expr=e.Expr,this.aString=e.aString,this}});this.ResolveImplCaseOf=function(e){var s=this;function i(e,s,i,r){var n=null;return(n=t.$new()).RangeStart=s,n.RangeEnd=i,n.Expr=r,e.Add(n),n}function n(e,t,r,n){var l=0,a=0,o=0,h=null;var u=e.Kind;if(3===u)a=l=e.B+0;else if(4===u)a=l=e.Int;else if(5===u)e.UInt>9007199254740991&&s.fExprEvaluator.EmitRangeCheckConst(20180424212414,e.AsString(),"0",Ae(9007199254740991),n,1),a=l=e.UInt;else if(8===u){if(null===r)return function(e){var r=null,l=0,a=0,o=null;a=1===e.length?e.charCodeAt(0):-1;for(var h=0,u=t.FCount-1;h<=u;h++)l=h,((o=t.Get(l)).aString===e||a>=o.RangeStart&&a<=o.RangeEnd)&&(r=t.Get(l).Expr,s.RaiseMsg(20180424220139,3108,rtl.getResStr(Ce,"sDuplicateCaseValueXatY"),Ye(18,"string",18,s.GetElementSourcePosStr(r)),n));return(o=i(t,1,0,n)).aString=e,!0}(e.S);if(1!==e.S.length)return!1;a=l=e.S.charCodeAt(0)}else if(9===u)a=l=e.Index;else if(10===u){if(null===r)return function(r,l){var a=0,o=0,h="",u=null,c=null;l>65535&&s.RaiseNotYetImplemented(20180501221359,n,e.AsDebugString());for(var p=0,f=t.FCount-1;p<=f;p++)a=p,((o=1===(h=(u=t.Get(a)).aString).length?h.charCodeAt(0):-1)>=r&&o<=l||u.RangeStart<=l&&u.RangeEnd>=r)&&(c=t.Get(a).Expr,s.RaiseMsg(20180501223914,3108,rtl.getResStr(Ce,"sDuplicateCaseValueXatY"),Ye(18,"string",18,s.GetElementSourcePosStr(c)),n));return i(t,r,l,n),!0}(e.RangeStart,e.RangeEnd);l=e.RangeStart,a=e.RangeEnd}else 11===u?(e.RangeEnd>9007199254740991&&s.fExprEvaluator.EmitRangeCheckConst(20180424212648,e.AsString(),"0",Ae(9007199254740991),n,1),l=e.RangeStart,a=e.RangeEnd):!1;if(null===r&&s.RaiseNotYetImplemented(20180424215728,n,e.AsDebugString()),(o=r.Intersects(l,a))<0)return r.Add(l,a),i(t,l,a,n),!0;for(var c=0,p=t.FCount-1;c<=p;c++)o=c,(h=t.Get(o)).RangeStart>a||h.RangeEnd<l||s.RaiseMsg(20180424214305,3108,rtl.getResStr(Ce,"sDuplicateCaseValueXatY"),Ye(18,e.AsString(),18,s.GetElementSourcePosStr(h.Expr)),n);return!1}var l=0,a=0,o=null,h=null,u=q.$new(),c=q.$new(),p=null,f=!1,d=null,F=null,m=null;this.ResolveExpr(e.CaseExpr,1),this.ComputeElement(e.CaseExpr,u,rtl.createSet(0),null),f=!1,d=ge.$create("Create"),F=null,m=null;try{0 in u.Flags&&(f=function e(t,i){var n=!1,l=null,a=0,o=q.$new();return n=!1,(a=t.BaseType)in r.btAllStrings||(37===a&&(a=t.SubType),a in r.btAllInteger?(i.set(xt.$create("CreateEmpty",[2,null])),n=!0):a in r.btAllBooleans?(i.set(xt.$create("CreateEmpty",[4,null])),n=!0):a in r.btAllChars?(i.set(xt.$create("CreateEmpty",[3,null])),n=!0):2===a&&((l=t.LoTypeEl).$class.ClassType()===Ge?(i.set(xt.$create("CreateEmpty",[1,l])),n=!0):l.$class.ClassType()===Je&&(s.ComputeElement(l.RangeExpr.Left,o,rtl.createSet(3),null),n=e(o,i))),n)}(u,{get:function(){return F},set:function(e){F=e}})),f||this.IsGenericTemplType(u)||this.RaiseXExpectedButYFound(20170216151952,"ordinal expression",this.GetTypeDescription(u.LoTypeEl,!1),e.CaseExpr);for(var C=0,S=e.Elements.FCount-1;C<=S;C++)if(l=C,(o=rtl.getObject(e.Elements.Get(l))).$class.ClassType()===bt){for(var T=0,y=(h=o).Expressions.FCount-1;T<=y;T++)a=T,p=rtl.getObject(h.Expressions.Get(a)),this.ResolveExpr(p,1),this.ComputeElement(p,c,rtl.createSet(3,0),null),37===c.BaseType&&this.ConvertRangeToElement(c),f&&(this.CheckEqualResCompatibility(u,c,p,!0,null),null!==(m=this.Eval(p,rtl.createSet(1),!0))?(13===m.Kind||n(m,d,F,p)||this.RaiseIncompatibleTypeRes(20180424210815,3028,[],c,u,p),Ot({get:function(){return m},set:function(e){m=e}})):this.RaiseMsg(20180518102047,3036,rtl.getResStr(Ce,"sConstantExpressionExpected"),[],p));this.ResolveImplElement(h.Body)}else o.$class.ClassType()===kt?this.ResolveImplBlock(o):this.RaiseNotYetImplemented(20160922163448,o,"")}finally{Ot({get:function(){return m},set:function(e){m=e}}),F=rtl.freeLoc(F);for(var g=0,E=d.FCount-1;g<=E;g++)l=g,d.Get(l);d=rtl.freeLoc(d)}},this.ResolveImplLabelMark=function(e){this.RaiseNotYetImplemented(20161014141636,e,"")},this.ResolveImplWithDo=function(e){var t=0,s=null,i=null;M.isPrototypeOf(e.FData)||this.RaiseInternalError(20181210175349,""),s=e.FData,this.PushScope(s);for(var r=0,n=s.ExpressionScopes.GetCount()-1;r<=n;r++)t=r,i=s.ExpressionScopes.GetItem(t),this.PushScope(i);this.ResolveImplElement(e.Body),this.PopWithScope(e)},this.ResolveImplAsm=function(e){},this.ResolveImplAssign=function(e){var t=q.$new(),s=q.$new(),i={},n=0,l=null;n=0===e.Kind?2:3,this.ResolveExpr(e.Left,n),this.ComputeElement(e.Left,t,rtl.createSet(1,0),null),this.CheckCanBeLHS(t,!0,this.GetRightMostExpr(e.Left)),this.ResolveExpr(e.Right,1),i=rtl.createSet(0),this.IsProcedureType(t,!0)&&(i=3 in this.FCurrentParser.GetCurrentModeSwitches()?rtl.includeSet(i,1):rtl.includeSet(i,2)),this.ComputeElement(e.Right,s,rtl.refSet(i),null);var a=e.Kind;if(0===a)this.CheckAssignResCompatibility(t,s,e.Right,!0),this.CheckAssignExprRange(t,e.Right),2===t.BaseType&&t.LoTypeEl.$class.ClassType()===Ue&&this.MarkArrayExprRecursive(e.Right,t.LoTypeEl);else if(1===a||2===a||3===a||4===a){if(t.BaseType in r.btAllInteger&&e.Kind in rtl.createSet(1,2,3))0 in s.Flags&&s.BaseType in r.btAllInteger||this.RaiseMsg(20170216152009,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(7,this.GetBaseTypes(s.BaseType),7,this.GetBaseTypes(t.BaseType)),e.Right);else if(t.BaseType in r.btAllStrings&&1===e.Kind)0 in s.Flags&&s.BaseType in r.btAllStringAndChars||this.RaiseMsg(20170216152012,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(7,this.GetBaseTypes(s.BaseType),7,this.GetBaseTypes(t.BaseType)),e.Right);else if(t.BaseType in r.btAllFloats&&e.Kind in rtl.createSet(1,2,3,4))0 in s.Flags&&s.BaseType in rtl.unionSet(r.btAllInteger,r.btAllFloats)||this.RaiseMsg(20170216152107,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(7,this.GetBaseTypes(s.BaseType),7,this.GetBaseTypes(t.BaseType)),e.Right);else if(34===t.BaseType&&e.Kind in rtl.createSet(1,2,3))0 in s.Flags&&s.BaseType in rtl.createSet(34,36)||this.RaiseMsg(20170216152110,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,this.GetBaseTypeNames(s.BaseType),18,"set of "+this.GetBaseTypeNames(t.SubType)),e.Right),t.SubType===s.SubType||t.SubType in r.btAllInteger&&s.SubType in r.btAllInteger||t.SubType in r.btAllBooleans&&s.SubType in r.btAllBooleans||this.RaiseMsg(20170216152117,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"set of "+this.GetBaseTypeNames(s.SubType),18,"set of "+this.GetBaseTypeNames(t.SubType)),e.Right);else if(2===t.BaseType){if(t.LoTypeEl.$class.ClassType()===Ue&&1===e.Kind&&0 in s.Flags&&this.IsDynArray(t.LoTypeEl,!0))return void this.CheckAssignCompatibilityArrayType(t,s,e,!0);this.RaiseIncompatibleTypeRes(20180615235749,3082,Ye(18,Fe.AssignKindNames[e.Kind]),t,s,e)}else this.RaiseIncompatibleTypeRes(20180208115707,3082,Ye(18,Fe.AssignKindNames[e.Kind]),t,s,e);l=this.Eval(e.Right,{},!0),Ot({get:function(){return l},set:function(e){l=e}})}else this.RaiseNotYetImplemented(20160927143649,e,"AssignKind "+Fe.AssignKindNames[e.Kind])},this.ResolveImplSimple=function(e){var t,s=q.$new();t=e.Expr,this.ResolveExpr(t,1),this.ComputeElement(t,s,rtl.createSet(0),null),3 in s.Flags||this.RaiseMsg(20170216152127,3044,rtl.getResStr(Ce,"sIllegalExpression"),[],e)},this.ResolveImplRaise=function(e){var t=q.$new();null!==e.ExceptObject&&(this.ResolveExpr(e.ExceptObject,1),this.ComputeElement(e.ExceptObject,t,rtl.createSet(0),null),this.CheckIsClass(e.ExceptObject,t),null!==t.IdentEl?He.isPrototypeOf(t.IdentEl)||We.isPrototypeOf(t.IdentEl)||$t.isPrototypeOf(t.IdentEl)||this.RaiseXExpectedButYFound(20170216152133,"variable",r.GetElementTypeName(t.IdentEl),e.ExceptObject):null!==t.ExprEl||this.RaiseXExpectedButYFound(0xb7727a211d0e,"variable",r.GetResolverResultDbg(t),e.ExceptObject),0 in t.Flags||this.RaiseMsg(20170303145037,3038,rtl.getResStr(Ce,"sNotReadable"),[],e.ExceptObject)),null!==e.ExceptAddr&&this.ResolveExpr(e.ExceptAddr,1)},this.ResolveExpr=function(e,t){var s,i=null;if(null===e&&this.RaiseNotYetImplemented(20160922163453,e,""),(s=e.$class.ClassType())===Dt){var r=(i=e).Kind;0===r?this.ResolveNameExpr(e,i.Value,t):1===r||2===r||3===r||5===r||6===r||this.RaiseNotYetImplemented(20160922163451,e,"")}else s===Lt?this.ResolveExpr(e.Operand,t):s===Bt?this.ResolveBinaryExpr(e,t):s===Mt?this.ResolveParamsExpr(e,t):s===Gt||s===wt||(s===Vt?this.ResolveInherited(e,t):s===Ut?(1!==t&&this.RaiseMsg(20170303205743,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],e),this.ResolveArrayValues(e)):s===Jt?(1!==t&&this.RaiseMsg(20180429103024,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],e),this.ResolveRecordValues(e)):s===jt||(s===Ht?this.ResolveInlineSpecializeExpr(e,t):this.RaiseNotYetImplemented(20170222184329,e,"")));null!==e.Format1&&this.ResolveExpr(e.Format1,1),null!==e.Format2&&this.ResolveExpr(e.Format2,1)},this.ResolveStatementConditionExpr=function(e){var t=q.$new();this.ResolveExpr(e,1),this.ComputeElement(e,t,rtl.createSet(0),null),this.CheckConditionExpr(e,t)},this.ResolveNameExpr=function(e,t,s){var i=te.$new(),n=null,l=null,a=null,o=null,h=null,u=0,c="",p=null,f=ie.$new(),d=0,F=null,m=null;if(this.GetParamsOfNameExpr(e,f),F=null!==f.InlineSpec?f.InlineSpec.Params:null,null===f.Params){if(null!==f.InlineSpec?(d=F.FCount,null!==(n=this.FindGenericEl(t,d,i,e))?n=this.GetSpecializedEl(f.InlineSpec,n,F):this.RaiseXExpectedButYFound(20190916160829,"generic type",r.GetElementTypeName(n),e)):n=this.FindElementWithoutParams$1(t,i,e,!1,!1),n.$class.ClassType()===Re&&(this.FindLongestUnitName({get:function(){return n},set:function(e){n=e}},e),i.Found=n),He.isPrototypeOf(n)&&e.HasParent(n)&&this.RaiseIdentifierNotFound(20230712105546,t,e),o=this.CreateReference(n,e,s,i),this.CheckFoundElement(i,o),xe.isPrototypeOf(n))if(l=n,null===f.InlineSpec&&null!==(m=this.GetProcTemplateTypes(l))&&this.RaiseMsg(20191007222004,3139,rtl.getResStr(Ce,"sCouldNotInferTypeArgXForMethodY"),Ye(18,rtl.getObject(m.Get(0)).FName,18,l.FName),e),e.FParent.$class.ClassType()===ve);else{if(2===s&&Ve.isPrototypeOf(l.ProcType)&&e.$class.ClassType()===Dt&&e.FParent.$class.ClassType()===dt&&e.FParent.Left===e&&(null===(a=rtl.as(l.FData,$).ImplProc)&&(a=l),e.HasParent(a)))return void o.SetDeclaration(l.ProcType.ResultEl);this.ProcNeedsParams(l.ProcType)&&!this.ExprIsAddrTarget(e)&&this.RaiseMsg(20170216152138,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,l.FName),e)}else if(n.$class.ClassType()===me)ee.isPrototypeOf(n.FData)&&(h=n.FData).GetCallCompatibility(h,e,!0);else if(n.$class.ClassType()===Re||Ie.isPrototypeOf(n))for(c=n.FName;;){if((u=Wt(".",c))<1)break;if(ct({get:function(){return c},set:function(e){c=e}},1,u),null===(e=this.GetNextDottedExpr(e))&&this.RaiseInternalError(20170503002012,""),this.CreateReference(n,e,s,null),Bt.isPrototypeOf(e.FParent)&&e.FParent.Right===e)for(p=e.FParent;27===p.OpCode&&(this.CreateReference(n,p,s,null),Bt.isPrototypeOf(p.FParent))&&p.FParent.Right===p;)p=p.FParent}}else{var C=f.Params.Kind;10===C?this.ResolveFuncParamsExprName(e,F,f.Params,s,""):11===C?this.ResolveArrayParamsExprName(e,f.Params,s):this.RaiseNotYetImplemented(20190912190428,e,at(f.Params))}},this.ResolveInherited=function(e,t){var s,i,r,n,l,a=null,o=null,h=null;if(e.FParent.$class.ClassType()!==Bt||0!==e.FParent.OpCode){if(null===(s=this.GetCurrentSelfScope(e))&&this.RaiseMsg(20170216152141,3023,rtl.getResStr(Ce,"sInheritedOnlyWorksInMethods"),[],e),null===(r=s.DeclarationProc)&&this.RaiseNotYetImplemented(20190121172251,e,""),i=s.ClassRecScope,O.isPrototypeOf(i)||this.RaiseMsg(20181218194022,3060,rtl.getResStr(Ce,"sTheUseOfXisNotAllowedInARecord"),Ye(18,"inherited"),e),o=null,n=rtl.as(i.FElement,$e),l=this.ResolveAliasType(n.HelperForType,!0),ze.isPrototypeOf(l))if(3 in this.FCurrentParser.GetCurrentModeSwitches()){if(!$e.isPrototypeOf(l))return;if(null===(a=l.FData.AncestorScope))return;h=this.PushInheritedScope(a.FElement,!0,null)}else a=n.FData.AncestorScope,h=this.PushInheritedScope(l,!1,a);else{if(null===(a=i.AncestorScope))return;h=this.PushInheritedScope(a.FElement,!0,null)}o=this.FindProcSameSignature(r.FName,r,h,!1),this.PopScope(),null!==o&&(ze.isPrototypeOf(o.FParent)||this.RaiseNotYetImplemented(20190121181234,e,""),this.CreateReference(o,e,t,null),o.IsAbstract()&&this.RaiseMsg(20170216152144,3030,rtl.getResStr(Ce,"sAbstractMethodsCannotBeCalledDirectly"),[],e))}else this.ResolveInheritedName(e.FParent,t)},this.ResolveInheritedName=function(e,t){var s,i,r,n,l,a,o,h=null;if(null===(s=this.GetCurrentSelfScope(e))&&this.RaiseMsg(20170216152148,3023,rtl.getResStr(Ce,"sInheritedOnlyWorksInMethods"),[],e),i=s.ClassRecScope,O.isPrototypeOf(i)||this.RaiseMsg(20181218194436,3060,rtl.getResStr(Ce,"sTheUseOfXisNotAllowedInARecord"),Ye(18,"inherited"),e),a=s.FElement,l=this.IsClassMethod(a),n=i.FElement,o=i.AncestorScope,n.ObjKind in Fe.okAllHelpers&&(h=this.ResolveAliasType(n.HelperForType,!0),ze.isPrototypeOf(h)))return this.PushInheritedScope(h,!1,o).OnlyTypeMembers=l,this.ResolveExpr(e.Right,t),void this.PopScope();null===o&&this.RaiseMsg(20170216152151,3024,rtl.getResStr(Ce,"sInheritedNeedsAncestor"),[],e.Left),r=o.FElement,this.PushInheritedScope(r,!0,null).OnlyTypeMembers=l,this.ResolveExpr(e.Right,t),this.PopScope()},this.ResolveBinaryExpr=function(e,t){var s=null,i=null,r=null,n=e.OpCode;if(0===n)if(7===e.Kind){if(this.ResolveExpr(e.Left,1),null===e.Right)return;this.ResolveExpr(e.Right,1)}else e.Left.$class.ClassType()===Vt?this.ResolveExpr(e.Left,t):this.RaiseNotYetImplemented(20160922163456,e,"");else if(1===n){for(s=e.Left;s.$class.ClassType()===Bt&&1===(r=s).OpCode;)(i=s.Left).FParent!==s&&this.RaiseNotYetImplemented(20210321201257,s,""),s=i;this.ResolveExpr(s,1);do{null!==(r=s.FParent).Right&&this.ResolveExpr(r.Right,1),s=r}while(s!==e)}else if(2===n||3===n||4===n||5===n||6===n||7===n||8===n||9===n||10===n||11===n||12===n||13===n||14===n||15===n||16===n||17===n||18===n||19===n||20===n||21===n||22===n||23===n){if(this.ResolveExpr(e.Left,1),null===e.Right)return;this.ResolveExpr(e.Right,1)}else if(27===n){if(this.ResolveExpr(e.Left,1),null===e.Right)return;this.ResolveSubIdent(e,t)}else this.RaiseNotYetImplemented(20160922163459,e,Fe.OpcodeStrings[e.OpCode])},this.ResolveSubIdent=function(e,t){var s=this;function i(){s.ResolveExpr(e.Right,t),s.PopScope()}function n(e,t){var r=null;return null!==e&&(null!==(r=s.PushHelperDotScope(e))&&(De.isPrototypeOf(t)&&(r.OnlyTypeMembers=!0),i(),true))}var l,a=null,o=null,h=null,u=q.$new(),c=null,p=null,f=null,d=null,F=null;if(!_.isPrototypeOf(e.FData)){if(l=e.Left,this.ComputeElement(l,u,rtl.createSet(0),null),3===u.BaseType)return a=rtl.as(r.NoNil(u.IdentEl),Ie),this.PushModuleDotScope(a),void i();if(null===u.LoTypeEl);else{if(d=u.HiTypeEl,(f=u.LoTypeEl).$class.ClassType()===Be&&this.ElHasModeSwitch(e,20)&&0 in u.Flags&&(d=f.DestType,f=this.ResolveAliasType(d,!0),u.Flags=rtl.includeSet(u.Flags,1)),f.$class.ClassType()===$e)return null!==(o=f).HelperForType&&this.RaiseHelpersCannotBeUsedAsType(20190123093438,e),h=this.PushClassDotScope({get:function(){return o},set:function(e){o=e}},!0),De.isPrototypeOf(u.IdentEl)?h.OnlyTypeMembers=!0:h.OnlyTypeMembers=!1,void i();if(f.$class.ClassType()===Le)return o=rtl.as(this.ResolveAliasType(f.DestType,!0),$e),(h=this.PushClassDotScope({get:function(){return o},set:function(e){o=e}},!0)).OnlyTypeMembers=!0,h.IsClassOf=!0,void i();if(f.$class.ClassType()===Me)return c=f,(p=this.PushRecordDotScope(c)).ConstParent=!(1 in u.Flags),De.isPrototypeOf(u.IdentEl)?p.OnlyTypeMembers=!0:(this.AccessExpr(e.Left,t),p.OnlyTypeMembers=!1),void i();if(f.$class.ClassType()===Ge){if(De.isPrototypeOf(u.IdentEl)&&this.ResolveAliasType(u.IdentEl,!0).$class.ClassType()===Ge)return(F=this.PushEnumDotScope(d,f)).OnlyTypeMembers=!0,void i()}else if(f.$class.ClassType()===je&&null!==(F=this.PushTemplateDotScope(f,e)))return De.isPrototypeOf(u.IdentEl)?F.OnlyTypeMembers=!0:F.OnlyTypeMembers=!1,void i();if(u.BaseType in r.btAllIntrinsicTypes||2===u.BaseType||1===u.BaseType){if(n(u.HiTypeEl,u.IdentEl))return}else if(34===u.BaseType&&n(this.GetSetType(u),u.IdentEl))return}this.RaiseMsg(20170216152157,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,".",18,this.GetResolverResultDescription(u,!1)),e)}},this.ResolveParamsExpr=function(e,t){4!==e.Kind||t in rtl.createSet(1,6)||this.RaiseMsg(20170303211052,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],e),this.ResolveParamsExprParams(e),10===e.Kind?this.ResolveFuncParamsExpr(e,t):11===e.Kind?this.ResolveArrayParamsExpr(e,t):4===e.Kind?this.ResolveSetParamsExpr(e):this.RaiseNotYetImplemented(20160922163501,e,"")},this.ResolveParamsExprParams=function(e){var t,s,i=0,r=0;t=this.StashSubExprScopes(),r=e.Kind in rtl.createSet(10,11)?6:1,s=e.Params;for(var n=0,l=rtl.length(s)-1;n<=l;n++)i=n,this.ResolveExpr(s[i],r);this.RestoreStashedScopes(t)},this.ResolveFuncParamsExpr=function(e,t){var s=null,i=null,r=q.$new();if(s=e.Value,Bt.isPrototypeOf(s)){if(Bt.isPrototypeOf(s)&&27===s.OpCode&&(s=s.Right),this.IsNameExpr(s))return this.ResolveBinaryExpr(e.Value,t),void(_.isPrototypeOf(s.FData)||this.RaiseNotYetImplemented(20190115140557,e,""));if(s.$class.ClassType()===Ht)return void this.ResolveBinaryExpr(e.Value,t);this.RaiseNotYetImplemented(20190115140809,e,"")}else if(this.IsNameExpr(s))this.ResolveFuncParamsExprName(s,null,e,t,"");else if(s.$class.ClassType()===Ht)this.ResolveInlineSpecializeExpr(s,t);else if(s.$class.ClassType()===Mt){if((i=s).Kind in rtl.createSet(11,10)&&(this.ResolveParamsExpr(i,1),this.ComputeElement(i,r,rtl.createSet(1,0),null),this.IsProcedureType(r,!0)))return this.CreateReference(r.LoTypeEl,s,t,null),void this.FinishProcParamAccess(r.LoTypeEl,e);this.RaiseMsg(20170216152202,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"(",18,i.ElementTypeName()),e)}else this.RaiseNotYetImplemented(20161014085118,e.Value,"")},this.ResolveFuncParamsExprName=function(e,t,s,i,n){var l=this;function a(e){var t=0;if(6!==e)for(var i=0,r=rtl.length(s.Params)-1;i<=r;i++)t=i,l.FinishCallArgAccess(s.Params[t],e)}function o(e,t){for(var i=0,n=null,a=null,o=q.$new(),h=0,u=t.FCount-1;h<=u;h++)i=h,n=rtl.getObject(t.Get(i)),l.ComputeElement(n,o,rtl.createSet(4),null),a=Yt.isPrototypeOf(n)?n:s,2147483647===l.CheckTemplateFitsParamRes(rtl.getObject(e.Get(i)),o,0,a)&&l.RaiseNotYetImplemented(20190919095604,a,r.GetResolverResultDbg(o))}function h(e,t,i){var r="";l.CheckCallProcCompatibility(t,s,!0,!1),i!==(null!==t.GenericTemplateTypes?t.GenericTemplateTypes.FCount:0)&&(""===(r=xe.isPrototypeOf(t.FParent)?t.FParent.FName:t.FName)&&(r=at(t)),l.RaiseMsg(20201101205447,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,r,18,e+ot(i)),s))}var u=ne.$new(),c=!1,p=null,f=null,d=te.$new(),F=null,m=q.$new(),C=null,S=null,T=0,y=null,g=null;if(""!==n||(e.$class.ClassType()===Dt?n=e.Value:this.RaiseNotYetImplemented(20190115143539,e,"")),u.$assign(ne.$new()),u.Params=s,null!==t?(T=t.FCount,u.TemplCnt=T):T=0,c=!1,this.IterateElements(n,rtl.createCallback(l,"OnFindCallElements"),u,{get:function(){return c},set:function(e){c=e}}),null===(p=u.Found)&&this.RaiseIdentifierNotFound(20170216152544,n,e),2147483647===u.Distance&&(xe.isPrototypeOf(p)?h(n,p.ProcType,T):we.isPrototypeOf(p)?this.CheckTypeCast(p,s,!0):p.$class.ClassType()===me?ee.isPrototypeOf(p.FData)?((F=p.FData).GetCallCompatibility(F,s,!0),this.RaiseNotYetImplemented(20200525124749,p,"missing exception, Found=["+F.Signature+"]")):Z.isPrototypeOf(p.FData)?this.CheckTypeCast(p,s,!0):this.RaiseNotYetImplemented(20161006132825,p,""):De.isPrototypeOf(p)?this.CheckTypeCast(p,s,!0):He.isPrototypeOf(p)?(C=this.ResolveAliasType(p.VarType,!0),we.isPrototypeOf(C)?h(n,C,T):this.RaiseMsg(20170405003522,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"(",18,C.ElementTypeName()),s)):We.isPrototypeOf(p)?(C=this.ResolveAliasType(p.ArgType,!0),we.isPrototypeOf(C)?h(n,C,T):this.RaiseMsg(20180228145412,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"(",18,C.ElementTypeName()),s)):this.RaiseNotYetImplemented(20161003134755,p,""),this.RaiseNotYetImplemented(20180621002400,s,"missing exception, Found="+ye(p))),u.Count>1&&(xe.isPrototypeOf(p)&&this.IndexOfGenericParam(s.Params)>=0||function(){var t=ne.$new(),i="",r=0,a=null,o=!1;t.$assign(ne.$new()),t.Params=s,t.List=ge.$create("Create");try{o=!1,l.IterateElements(n,rtl.createCallback(l,"OnFindCallElements"),t,{get:function(){return o},set:function(e){o=e}}),i="";for(var h=0,u=t.List.FCount-1;h<=u;h++)r=h,a=rtl.getObject(t.List.Get(r)),xe.isPrototypeOf(a)&&l.LogMsg(20170417180320,4,3057,rtl.getResStr(Ce,"sFoundCallCandidateX"),Ye(18,l.GetProcTypeDescription(a.ProcType,rtl.createSet(0,1,2))),a),i=i+", "+l.GetElementSourcePosStr(a)}finally{rtl.free(t,"List")}l.RaiseMsg(20170216152200,3013,rtl.getResStr(Ce,"sCantDetermineWhichOverloadedFunctionToCall")+i,Ye(18,n),e)}()),y=xe.isPrototypeOf(p)?this.GetProcTemplateTypes(p):ke.isPrototypeOf(p)?p.GenericTemplateTypes:null,T>0)null===y&&this.RaiseMsg(20190919100922,3136,rtl.getResStr(Ce,"sTypeParamsNotAllowedOnX"),Ye(18,p.FName),e),T!==y.FCount&&this.RaiseMsg(20190919101051,3130,rtl.getResStr(Ce,"sWrongNumberOfParametersForGenericX"),Ye(18,r.GetElementTypeName(p)+" "+p.FName),e),o(y,t),p=this.GetSpecializedEl(e,p,t),xe.isPrototypeOf(p)&&this.CheckCallProcCompatibility(p.ProcType,s,!0,!1);else if(null!==y&&y.FCount>0)if(xe.isPrototypeOf(p)&&49 in this.FCurrentParser.GetCurrentModeSwitches()){g=this.CreateInferenceTypesForCall(s,p);try{o(y,g),p=this.GetSpecializedEl(e,p,g),this.CheckCallProcCompatibility(p.ProcType,s,!0,!1)}finally{Ee({get:function(){return g},set:function(e){g=e}})}}else this.RaiseMsg(20190919120728,3130,rtl.getResStr(Ce,"sWrongNumberOfParametersForGenericX"),Ye(18,r.GetElementTypeName(p)+" "+p.FName),e);if(De.isPrototypeOf(p)&&((S=(C=this.ResolveAliasType(p,!0)).$class.ClassType())===me?Z.isPrototypeOf(C.FData)&&this.CheckTypeCast(C,s,!0):this.CheckTypeCast(C,s,!0)),f=this.CreateReference(p,e,1,null),u.StartScope.$class.ClassType()===this.FScopeClass_WithExpr&&(f.WithExprScope=u.StartScope),d.$assign(te.$new()),d.ErrorPosEl=e,d.StartScope=u.StartScope,d.ElScope=u.ElScope,d.Found=p,this.CheckFoundElement(d,f),xe.isPrototypeOf(p))i in rtl.createSet(1,6)||this.RaiseMsg(20170306104440,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],s),this.FinishProcParamAccess(p.ProcType,s);else if(De.isPrototypeOf(p))(S=(C=this.ResolveAliasType(p,!0)).$class.ClassType())===$e||S===Le||S===Me||S===Ge||S===lt||S===Be||S===Ue||S===Je||S===je?a(i):S===we||S===Ve?this.AccessExpr(s.Params[0],i):S===me?ee.isPrototypeOf(C.FData)?null!=(F=C.FData).FinishParamsExpression?F.FinishParamsExpression(F,s):a(1):Z.isPrototypeOf(C.FData)?a(i):this.RaiseNotYetImplemented(20170325145720,s,""):this.RaiseMsg(20170306121908,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"(",18,C.ElementTypeName()),s);else{if(this.ComputeElement(p,m,rtl.createSet(1,0),null),C=m.LoTypeEl,we.isPrototypeOf(C))return i in rtl.createSet(1,6)||this.RaiseMsg(20190215195439,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],s),void this.FinishProcParamAccess(C,s);this.RaiseMsg(20170306104301,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"(",18,C.ElementTypeName()),s)}},this.ResolveArrayParamsExpr=function(e,t){var s=q.$new(),i=null,r=null;if(null===(i=e.Value)&&this.RaiseInternalError(20180423093120,ye(e)),this.IsNameExpr(i))this.ResolveArrayParamsExprName(i,e,t);else{if(i.$class.ClassType()===Mt)r=i,this.ResolveExpr(r,1),this.ComputeElement(r,s,rtl.createSet(1,0),null),null===i.FData&&this.CreateReference(s.LoTypeEl,i,t,null),s.IdentEl=null;else if(i.$class.InheritsFrom(Lt))this.ResolveExpr(i.Operand,t),this.ComputeElement(i,s,rtl.createSet(0),null);else if(Bt.isPrototypeOf(i)){for(;Bt.isPrototypeOf(i)&&27===i.OpCode;)i=i.Right;if(this.IsNameExpr(i))return this.ResolveBinaryExpr(e.Value,t),void(_.isPrototypeOf(i.FData)||this.RaiseNotYetImplemented(20190115144534,e,""));i=e.Value,this.ResolveBinaryExpr(i,1),this.ComputeElement(i,s,rtl.createSet(0),null)}else this.RaiseNotYetImplemented(20160927212610,i,"");this.ResolveArrayParamsArgs(e,s,t)}},this.ResolveArrayParamsExprName=function(e,t,s){var i,r="",n=te.$new(),l=null,a=null,o=null,h=q.$new();e.$class.ClassType()===Dt&&0===e.Kind?r=e.Value:e.$class.ClassType()===Ht?this.RaiseMsg(20190912190518,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"[",18,"inline specialize"),t):this.RaiseNotYetImplemented(20190131154557,e,""),i=this.FindElementWithoutParams$1(r,n,e,!0,!0),l=this.CreateReference(i,e,s,n),this.CheckFoundElement(n,l),xe.isPrototypeOf(i)&&(a=i,2===s&&Ve.isPrototypeOf(a.ProcType)&&t.FParent.$class.ClassType()===dt&&t.FParent.Left===t&&(null===(o=rtl.as(a.FData,$).ImplProc)&&(o=a),t.HasParent(o)&&l.SetDeclaration(a.ProcType.ResultEl))),this.ComputeElement(e,h,rtl.createSet(0),null),this.ResolveArrayParamsArgs(t,h,s)},this.ResolveArrayParamsArgs=function(e,t,s){var i=this;function n(){var t=null,i=null;2===s&&(t=e.Value,Bt.isPrototypeOf(t)&&27===t.OpCode&&(t=t.Right),_.isPrototypeOf(t.FData)&&2===(i=t.FData).Access&&(i.Access=3))}function l(s){var l,a=q.$new();return n(),!(!s&&!i.ElHasBoolSwitch(e,28))&&(0 in t.Flags||i.RaiseXExpectedButYFound(20170216152548,"index",r.GetElementTypeName(t.LoTypeEl),e),rtl.length(e.Params)<1?i.RaiseMsg(20170216152204,3031,rtl.getResStr(Ce,"sMissingParameterX"),Ye(18,zt(s,"character index","index")),e):rtl.length(e.Params)>1&&i.RaiseMsg(20170216152551,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(9,","),e.Params[1]),l=e.Params[0],i.ComputeElement(l,a,rtl.createSet(0),null),a.BaseType in r.btAllInteger||i.RaiseMsg(20170216152209,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,i.GetBaseTypeNames(a.BaseType),18,"integer"),l),0 in a.Flags||i.RaiseMsg(20170216152211,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"type",18,"value"),l),i.AccessExpr(l,1),true)}var a=null,o=0,h=null,u=null;if(t.BaseType in r.btAllStrings){if(l(!0))return}else{if(ve.isPrototypeOf(t.IdentEl)&&this.GetPasPropertyArgs(t.IdentEl).FCount>0)return a=t.IdentEl,this.CheckCallPropertyCompatibility(a,e,!0),void this.FinishPropertyParamAccess(e,a);if(29===t.BaseType){if(l(!1))return}else if(2===t.BaseType)if((u=(h=t.LoTypeEl).$class.ClassType())===$e||u===Me||u===Le){if(this.ResolveBracketOperatorClassOrRec(e,t,s))return}else{if(u===Ue){De.isPrototypeOf(t.IdentEl)&&this.RaiseMsg(20170216152215,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"[",18,t.IdentEl.ElementTypeName()),e),n(),this.CheckCallArrayCompatibility(h,e,!0,!0);for(var c=0,p=rtl.length(e.Params)-1;c<=p;c++)o=c,this.AccessExpr(e.Params[o],1);return}if(u===Be&&l(!1))return}}this.RaiseMsg(20170216152217,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"[",18,this.GetResolverResultDescription(t,!0)),e)},this.ResolveBracketOperatorClassOrRec=function(e,t,s){var i,r,n=null,l=null,a=0,o=null,h=null,u=null;h=t.HiTypeEl,(r=(u=t.LoTypeEl).$class.ClassType()===Le)&&(h=u.DestType,u=this.ResolveAliasType(u,!0)),n=null;for(var c=0,p=(l=this.CreateGroupScope(h,!0)).Count-1;c<=p&&(a=c,o=l.Scopes[a],!N.isPrototypeOf(o)||null===(n=o.DefaultProperty));c++);return l=rtl.freeLoc(l),null!==n&&(!r&&!De.isPrototypeOf(t.IdentEl)||n.GetIsClass()||this.RaiseMsg(20170216152213,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"[",18,this.GetResolverResultDescription(t,!0)),e),i=e.Value,_.isPrototypeOf(i.FData)&&this.SetResolvedRefAccess(i,i.FData,1),this.CreateReference(n,e,s,null),this.CheckCallPropertyCompatibility(n,e,!0),this.FinishPropertyParamAccess(e,n),true)},this.ResolveSetParamsExpr=function(e){var t=0,s=null,i=q.$new();null!==e.Value&&this.RaiseNotYetImplemented(20160930135910,e,"");for(var r=0,n=rtl.length(e.Params)-1;r<=n;r++)t=r,s=e.Params[t],this.ComputeElement(s,i,rtl.createSet(2,0),null)},this.ResolveArrayValues=function(e){for(var t=0,s=0,i=rtl.length(e.Values)-1;s<=i;s++)t=s,this.ResolveExpr(e.Values[t],1)},this.ResolveRecordValues=function(e){function t(e,s){for(var i=null,r=0,n=0,l=e.Members.FCount-1;n<=l;n++)if(r=n,i=rtl.getObject(e.Members.Get(r)),nt(i.FName,s))return i;if(He.isPrototypeOf(e.VariantEl)&&(i=e.VariantEl,nt(i.FName,s)))return i;if(null!==e.Variants)for(var a=0,o=e.Variants.FCount-1;a<=o;a++)if(r=a,null!==(i=t(rtl.getObject(e.Variants.Get(r)).Members,s)))return i;return i=null}var s=0,i=0,r=null,n=null,l=null,a="",o=q.$new();this.ComputeElement(e,o,{},null),2===o.BaseType&&o.LoTypeEl.$class.ClassType()===Me||this.RaiseIncompatibleTypeDesc(20180429104135,3028,[],"record value",this.GetTypeDescription$1(o,!1),e),n=o.LoTypeEl;for(var h=0,u=rtl.length(e.Fields)-1;h<=u;h++){s=h,null===(r=t(n,(l=e.Fields[s]).Name))&&this.RaiseIdentifierNotFound(20180429104703,l.Name,l.NameExp),r.$class.ClassType()!==He&&this.RaiseMsg(20180429121933,3080,rtl.getResStr(Ce,"sIdentifierXIsNotAnInstanceField"),[],l.ValueExp),rtl.neSet(rtl.intersectSet(r.VarModifiers,rtl.createSet(4,5)),{})&&this.RaiseMsg(20190105221450,3080,rtl.getResStr(Ce,"sIdentifierXIsNotAnInstanceField"),Ye(18,"record assignment"),l.ValueExp),this.CreateReference(r,l.NameExp,2,null);for(var c=0,p=s-1;c<=p;c++)i=c,nt(l.Name,e.Fields[i].Name)&&this.RaiseMsg(20180429104942,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,l.Name,18,this.GetElementSourcePosStr(e.Fields[i].NameExp)),l.NameExp);this.ResolveExpr(e.Fields[s].ValueExp,1),this.CheckAssignCompatibility(r,l.ValueExp,!0,null)}a="";for(var f=0,d=n.Members.FCount-1;f<=d;f++)if(s=f,(r=rtl.getObject(n.Members.Get(s))).$class.ClassType()===He&&!rtl.neSet(rtl.intersectSet(r.VarModifiers,rtl.createSet(4,5)),{})){for(i=rtl.length(e.Fields)-1;i>=0&&!nt(r.FName,e.Fields[i].Name);)i-=1;if(i<0){if(""!==a&&(a+=", "),a.length>30){a+="...";break}a+=r.FName}}""!==a&&this.LogMsg(20180429121127,4,3109,rtl.getResStr(Ce,"sMissingFieldsX"),Ye(18,a),e)},this.ResolveInlineSpecializeExpr=function(e,t){0===e.Params.FCount&&this.RaiseMsg(20190916155014,3031,rtl.getResStr(Ce,"sMissingParameterX"),Ye(18,"type"),e),this.ResolveExpr(e.NameExpr,t)},this.ResolveAccessor=function(e){var t=this,s=null;function i(s){var i,r,n=te.$new(),l=null,a=!1;return 0!==s.Kind&&t.RaiseXExpectedButYFound(20170216151746,"class",s.Value,s),l=t.FTopScope,n.$assign(te.$new()),n.ErrorPosEl=e,a=!1,l.IterateElements(s.Value,l,rtl.createCallback(t,"OnFindFirst"),n,{get:function(){return a},set:function(e){a=e}}),null===(i=n.Found)&&t.RaiseIdentifierNotFound(20170216151749,s.Value,s),r=t.CreateReference(i,s,1,null),t.CheckFoundElementVisibility(n,r),i}var n=null,l=null;return e.$class.ClassType()===Bt?(l=null,Dt.isPrototypeOf(e.Left)?(n=e.Left,l=i(n),ze.isPrototypeOf(l)||this.RaiseXExpectedButYFound(20170216151752,"class",r.GetElementTypeName(l),n)):this.RaiseMsg(20170216151754,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,Fe.OpcodeStrings[e.OpCode]),e),27!==e.OpCode&&this.RaiseMsg(20170216151757,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,Fe.OpcodeStrings[e.OpCode]),e),l.$class.ClassType()===$e?this.PushClassDotScope({get:function(){return l},set:function(e){l=e}},!0):l.$class.ClassType()===Me?this.PushRecordDotScope(l):this.RaiseMsg(20190123145559,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,Fe.OpcodeStrings[e.OpCode]),e),e=e.Right,s=this.ResolveAccessor(e),this.PopScope()):e.$class.ClassType()===Dt?s=i(n=e):this.RaiseNotYetImplemented(20160922163436,e,""),s},this.SetResolvedRefAccess=function(e,t,s){if(t.Access!==s&&!(s in rtl.createSet(0,6))){var i=t.Access;if(0===i||6===i)t.Access=s;else if(1===i){if(!(s in rtl.createSet(2,3,4,5)))return;t.Access=3}else if(2===i||5===i){if(!(s in rtl.createSet(1,3,4)))return;t.Access=3}else{if(3===i)return;if(4===i)return;this.RaiseInternalError(20170403163727,"")}}},this.AccessExpr=function(e,t){var s,i=null,r=null,n=null,l=q.$new();if(_.isPrototypeOf(e.FData)&&(i=e.FData,this.SetResolvedRefAccess(e,i,t)),(s=e.$class.ClassType())===Bt)(r=e).OpCode in rtl.createSet(27,0)&&this.AccessExpr(r.Right,t);else if(s===Mt){var a=(n=e).Kind;10===a?this.IsTypeCast(n)?this.FinishCallArgAccess(n.Params[0],t):this.AccessExpr(n.Value,t):11===a?(this.ComputeElement(n.Value,l,{},null),this.IsDynArray(l.LoTypeEl,!1)||29===l.BaseType?this.AccessExpr(n.Value,1):this.AccessExpr(n.Value,t)):4===a?1!==t&&this.RaiseMsg(20170306112306,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],e):this.RaiseNotYetImplemented(20170403173831,n,"")}else s===Dt&&0===e.Kind||t in rtl.createSet(1,6)&&(s===Dt||s===wt||s===Gt||s===Vt||s===jt)||s===Ht||(s===Lt?this.AccessExpr(e.Operand,t):this.RaiseNotYetImplemented(20170306102158,e,""))},this.MarkArrayExpr=function(e,t){var s=!1,i=null;return null===e.FData?(this.CreateReference(t,e,1,null),s=!0):_.isPrototypeOf(e.FData)?(s=!1,i=e.FData,Ue.isPrototypeOf(i.FDeclaration)||this.RaiseNotYetImplemented(20180618102230,e,ye(i.FDeclaration))):this.RaiseNotYetImplemented(20180618102408,e,ye(e.FData)),s},this.MarkArrayExprRecursive=function(e,t){var s=this;!function e(t,i,r){var n=[],l=q.$new(),a=null,o=null,h=null;if(s.IsArrayOperatorAdd(t))e(t.Left,i,r),e(t.Right,i,r);else if(t.$class.ClassType()===Mt)if(n=(a=t).Params,4===t.Kind){if(s.MarkArrayExpr(a,i),0===rtl.length(n))return;if((r+=1)>rtl.length(i.Ranges)){if(null===i.ElType)return;if(s.ComputeElement(i.ElType,l,rtl.createSet(4),null),2!==l.BaseType||!Ue.isPrototypeOf(l.LoTypeEl))return;i=l.LoTypeEl,r=0}for(var u=0,c=rtl.length(n)-1;u<=c;u++)e(n[u],i,r)}else if(10===t.Kind&&_.isPrototypeOf(t.Value.FData)&&(h=t.Value.FData,me.isPrototypeOf(h.FDeclaration)&&ee.isPrototypeOf(h.FDeclaration.FData)))if(23===(o=h.FDeclaration.FData).BuiltIn)for(var p=0,f=rtl.length(n)-1;p<=f;p++)e(n[p],i,r);else 25===o.BuiltIn&&e(n[0],i,r)}(e,t,0)},this.DeanonymizeType=function(e){function t(t,s,i){var r=0,n=null;for(r=i.FCount-1;r>=0&&i.Get(r)!==s;)r-=1;if(He.isPrototypeOf(s))for(;r>0&&(n=rtl.getObject(i.Get(r-1))).$class.ClassType()===s.$class.ClassType()&&n.VarType===s.VarType;)r-=1;for(;r>0&&rtl.getObject(i.Get(r-1)).$class.ClassType()===_t;)r-=1;r<0?i.Add(e):i.Insert(r,e),e.SetParent(t)}var s=null,i=null,n=null,l=null,a="";if(""!==this.FAnonymousElTypePostfix&&(""!==e.FName&&this.RaiseNotYetImplemented(20220320121923,e,""),e.$class.ClassType()!==Kt))for(a="",i=e,n=e.FParent;;){if(null===n&&this.RaiseNotYetImplemented(20220320165553,e,""),Xt.isPrototypeOf(n)||ze.isPrototypeOf(n)){""===a&&this.RaiseMsg(20220320122946,3056,rtl.getResStr(Ce,"sCannotNestAnonymousX"),Ye(18,r.GetElementTypeName(e)),e),e.FName=a+this.FAnonymousElTypePostfix,Xt.isPrototypeOf(n)?(t(s=n,i,s.Declarations),s.Types.Add(e)):ze.isPrototypeOf(n)&&t(l=n,i,l.Members);break}""!==n.FName&&(""!==a?this.RaiseMsg(20220320132732,3056,rtl.getResStr(Ce,"sCannotNestAnonymousX"),Ye(18,r.GetElementTypeName(e)),e):a=n.FName),i=n,n=n.FParent}},this.FinishModule=function(e){var t,s=0,i=null;this.FStep=2,t=e.$class.ClassType(),i=rtl.as(e.FData,F),15 in this.FCurrentParser.FScanner.FCurrentBoolSwitches&&(i.Flags=rtl.includeSet(i.Flags,1),this.FindRangeErrorConstructors(null)),t===Ze?(this.FinishSection(e.ProgramSection),this.ResolveImplBlock(e.InitializationSection)):t===et?(this.FinishSection(e.LibrarySection),this.ResolveImplBlock(e.InitializationSection),this.ResolveImplBlock(e.FinalizationSection)):t===Ie?(this.FinishSection(e.InterfaceSection),null!==e.ImplementationSection&&this.FinishSection(e.ImplementationSection),null!==e.FinalizationSection&&this.ResolveImplBlock(e.FinalizationSection),null!==e.InitializationSection&&this.ResolveImplBlock(e.InitializationSection)):this.RaiseInternalError(20160922163327,"");for(var r=0,n=this.FPendingForwardProcs.FCount-1;r<=n;r++)s=r,this.CheckPendingForwardProcs(rtl.getObject(this.FPendingForwardProcs.Get(s)));for(this.FPendingForwardProcs.Clear();null!==this.FTopScope&&this.FTopScope.$class.ClassType()===this.FScopeClass_Section;)this.PopScope();this.CheckTopScope(this.FScopeClass_Module,!1),this.PopScope(),this.FStep=3,null!==this.FCurrentParser&&null!==this.FCurrentParser.FScanner&&(this.FCurrentParser.NextToken(),0!==this.FCurrentParser.FScanner.FCurToken&&this.LogMsg(20180628131456,4,3058,rtl.getResStr(Ce,"sTextAfterFinalIgnored")+" "+this.FCurrentParser.FScanner.FormatCurrentSrcPos(),[],e))},this.FinishUsesClause=function(){var e,t=0,s=0,i=null,n=null,l=null,a=null,o=null,h="",u=0,c=[];this.CheckTopScope(this.FScopeClass_Section,!1),e=(l=this.FTopScope).FElement,l.UsesFinished&&this.RaiseInternalError(20180305145220,""),l.UsesFinished=!0;for(var p=0,f=e.UsesList.FCount-1;p<=f;p++){t=p,i=null,(n=(o=e.UsesClause[t]).Module).$class.ClassType()===et?i=n.LibrarySection:n.$class.ClassType()===Ie?i=n.InterfaceSection:this.RaiseXExpectedButYFound(20170503004803,"unit",r.GetElementTypeName(n),o),null===i&&this.RaiseInternalError(20160922163352,"uses element has no interface section: "+ye(n)),null===i.FData&&this.RaiseInternalError(20160922163358,"uses element has no resolver data: "+o.FName+"->"+ye(i)),g.isPrototypeOf(i.FData)||this.RaiseInternalError(20160922163403,"uses element has invalid resolver data: "+o.FName+"->"+ye(i)+"->"+i.FData.$classname),a=i.FData,this.AddIdentifier(l,o.FName,o,3),l.UsesScopes.Add(a),c=a.Helpers;for(var d=0,F=rtl.length(c)-1;d<=F;d++)s=d,this.AddActiveHelper(c[s].Helper);this.EmitElementHints(o,n)}for(var m=e.UsesList.FCount-1;m>=0;m--)t=m,h=(o=e.UsesClause[t]).FName,(u=Wt(".",h))<1||(h=pt(h,u-1),null===l.FindLocalIdentifier(h)&&this.AddIdentifier(l,h,o,5))},this.FinishSection=function(e){var t=null;(t=rtl.as(e.FData,g)).Finished||(t.Finished=!0,Ke.isPrototypeOf(e)&&this.FinishInterfaceSection(e))},this.FinishInterfaceSection=function(e){this.FHub.FinishedInterfaceCount+=1,this.FFinishedInterfaceIndex=this.FHub.FinishedInterfaceCount,this.NotifyPendingUsedInterfaces()},this.FinishTypeSection=function(e){var t=this;Xt.isPrototypeOf(e)?function(e){for(var s=0,i=null,r=0,n=e.Declarations.FCount-1;r<=n;r++)s=r,i=rtl.getObject(e.Declarations.Get(s)),De.isPrototypeOf(i)&&t.FinishTypeSectionEl(i)}(e):ze.isPrototypeOf(e)?function(e){for(var s=0,i=null,r=0,n=e.Members.FCount-1;r<=n;r++)s=r,i=rtl.getObject(e.Members.Get(s)),De.isPrototypeOf(i)&&t.FinishTypeSectionEl(i)}(e):this.RaiseNotYetImplemented(20181226105933,e,"")},this.FinishTypeSectionEl=function(e){var t=this;function s(s,i,n,l,a){var o=!1,h=!1,u=te.$new();if(h=!1,u.$assign(te.$new()),u.ErrorPosEl=a,rtl.as(t.FTopScope,C).IterateElements(n,t.FTopScope,rtl.createCallback(t,"OnFindFirst"),u,{get:function(){return h},set:function(e){h=e}}),null===u.Found){if(!l)return!1;t.RaiseIdentifierNotFound(20170216151543,n,a)}return u.Found===i.get()?o:(Le.isPrototypeOf(s)&&(u.Found.$class.ClassType()===$e&&1===u.Found.ObjKind||t.RaiseXExpectedButYFound(20170216151548,"class",r.GetElementTypeName(u.Found),a)),i.set(u.Found),t.CheckUseAsType(i.get(),20190123100649,e),Be.isPrototypeOf(s)&&t.CheckPointerCycle(s),o=!0)}var i,n=null,l=null,o=null,h=null;if((i=e.$class.ClassType())===$e)e.IsForward&&!_.isPrototypeOf(e.FData)&&this.RaiseMsg(20170216151534,3014,rtl.getResStr(Ce,"sForwardTypeNotResolved"),Ye(18,e.FName),e);else if(i===Le){if(n=e,(l=this.ResolveAliasType(n.DestType,!0)).$class.ClassType()===a)o=l,s(n,{p:n,get:function(){return this.p.DestType},set:function(e){this.p.DestType=e}},l.FName,!0,o);else if(l.$class.ClassType()===$e){if(rtl.as(l,$e).FParent===n.FParent)return;s(n,{p:n,get:function(){return this.p.DestType},set:function(e){this.p.DestType=e}},n.DestType.FName,!1,n)}}else if(i===Be)if(h=e,(l=this.ResolveAliasType(h.DestType,!0)).$class.ClassType()===a)o=l,s(h,{p:h,get:function(){return this.p.DestType},set:function(e){this.p.DestType=e}},l.FName,!0,o);else{if(l.FParent===h.FParent)return;s(h,{p:h,get:function(){return this.p.DestType},set:function(e){this.p.DestType=e}},l.FName,!1,h)}},this.FinishTypeDef=function(e){var t;(t=e.$class.ClassType())===Ge?this.FinishEnumType(e):t===lt?this.FinishSetType(e):t===Je?this.FinishRangeType(e):t===Me?this.FinishRecordType(e):t===$e?this.FinishClassType(e):t===Le?this.FinishClassOfType(e):t===Be?this.FinishPointerType(e):t===Ue?this.FinishArrayType(e):t===qt||t===Qt?this.FinishAliasType(e):t===Be?this.EmitTypeHints(e,e.DestType):t===je?this.FinishGenericTemplateType(e):t===Kt&&this.FinishSpecializeType(e)},this.FinishEnumType=function(e){this.FTopScope.FElement===e&&this.PopScope()},this.FinishSetType=function(e){function t(){var t=null;return(t=e.EnumType).FParent!==e&&(t=e),t}var s,i=q.$new(),n=q.$new(),l=null,a=null;if((s=(a=this.ResolveAliasType(e.EnumType,!0)).$class.ClassType())!==Ge){if(s===Je)return(l=a.RangeExpr).FParent===e&&null===l.FData&&this.FinishConstRangeExpr(l,i,n),void this.FinishSubElementType(e,a);if(s===me&&Z.isPrototypeOf(a.FData)){if(a.FData.BaseType in rtl.unionSet(r.btAllChars,rtl.createSet(15,19)))return;this.RaiseXExpectedButYFound(20170216151553,"Char or boolean",r.GetElementTypeName(a),t())}this.RaiseXExpectedButYFound(20170216151557,"enum type",r.GetElementTypeName(a),t())}else this.FinishSubElementType(e,a)},this.FinishSubElementType=function(e,t){var s=null;this.EmitTypeHints(e,t),""===t.FName&&""!==this.FAnonymousElTypePostfix&&(t.FParent!==e&&this.RaiseNotYetImplemented(20220320123426,e,r.GetElementTypeName(t)),this.DeanonymizeType(t),t.$class.ClassType()===Ge&&e.$class.ClassType()===lt&&(s=t.FData).CanonicalSet!==e&&(s.CanonicalSet=e))},this.FinishRangeType=function(e){var t,s=q.$new(),i=q.$new();t=e.RangeExpr,this.ResolveExpr(t.Left,1),this.ResolveExpr(t.Right,1),this.FinishConstRangeExpr(t,s,i)},this.FinishConstRangeExpr=function(e,t,s){var i,r,n=null;i=e.Left,r=e.Right,this.ComputeElement(i,t,rtl.createSet(3),null),this.ComputeElement(r,s,rtl.createSet(3),null),this.CheckSetLitElCompatible(i,r,t,s),n=this.Eval(e,rtl.createSet(0),!0),Ot({get:function(){return n},set:function(e){n=e}})},this.FinishRecordType=function(e){var t;this.FTopScope.FElement!==e&&this.RaiseNotYetImplemented(20190801232042,e,""),this.PopScope(),t=rtl.as(e.FData,x),this.FinishGenericClassOrRecIntf(t)};var s=rtl.recNewT(null,"",function(){this.InterfaceIndex=0,this.ProcClassType=null,this.InterfaceName="",this.ImplementName="",this.ResolutionEl=null,this.Count=0,this.$eq=function(e){return this.InterfaceIndex===e.InterfaceIndex&&this.ProcClassType===e.ProcClassType&&this.InterfaceName===e.InterfaceName&&this.ImplementName===e.ImplementName&&this.ResolutionEl===e.ResolutionEl&&this.Count===e.Count},this.$assign=function(e){return this.InterfaceIndex=e.InterfaceIndex,this.ProcClassType=e.ProcClassType,this.InterfaceName=e.InterfaceName,this.ImplementName=e.ImplementName,this.ResolutionEl=e.ResolutionEl,this.Count=e.Count,this}});this.FinishClassType=function(e){var t=null,i=0,n=0,l=0,a=null,o=[],h=null,u=null,c=null,p=null,f=null,d=le.$new(),F=!1,m=null,C=q.$new(),S="",T="",y=null,E=null;if(o=[],t=null,!e.IsForward){if(this.FTopScope.FElement!==e&&this.RaiseInternalError(20180322142534,ye(e)+"<>"+ye(this.FTopScope.FElement)),null===(t=rtl.as(e.FData,O))&&this.RaiseNotYetImplemented(20190803204709,e,""),1===e.ObjKind){e.Interfaces.FCount>0?(null===t.Interfaces&&this.RaiseInternalError(20180408162725,""),t.Interfaces.FCount!==e.Interfaces.FCount&&this.RaiseInternalError(20180408162746,"")):null!==t.Interfaces&&this.RaiseInternalError(20180408162803,"");for(var P=0,R=e.Members.FCount-1;P<=R;P++)if(i=P,c=rtl.getObject(e.Members.Get(i)),Zt.isPrototypeOf(c)){m=c,this.ComputeElement(m.InterfaceName,C,rtl.createSet(1),null),De.isPrototypeOf(C.IdentEl)||this.RaiseInternalError(20180323135729,r.GetResolverResultDbg(C)),(n=e.Interfaces.IndexOf(C.IdentEl))<0&&this.RaiseInternalError(20180323135900,r.GetResolverResultDbg(C)),u=rtl.getObject(t.Interfaces.Get(n)),ve.isPrototypeOf(u)&&this.RaiseMsg(20180323140046,3089,rtl.getResStr(Ce,"sCannotMixMethodResolutionAndDelegationAtX"),Ye(18,this.GetElementSourcePosStr(u)),m.InterfaceName),null===u&&(u=this.CreateClassIntfMap(e,n)),h=u,y=m.InterfaceProc,Dt.isPrototypeOf(y)||this.RaiseXExpectedButYFound(20180327162230,"method name",r.GetElementTypeName(y),y),0!==y.Kind&&this.RaiseXExpectedButYFound(20180327162236,"method name",r.GetElementTypeName(y),y),T=y.Value,y=m.ImplementationProc,Dt.isPrototypeOf(y)||this.RaiseXExpectedButYFound(20180327152115,"method name",r.GetElementTypeName(y),y),0!==y.Kind&&this.RaiseXExpectedButYFound(20180327152157,"method name",r.GetElementTypeName(y),y),S=y.Value;for(var v=0,A=rtl.length(o)-1;v<=A;v++){var N=o[l=v];N.InterfaceIndex===n&&N.ProcClassType===m.ProcClass&&N.InterfaceName===T&&this.RaiseMsg(20180327164626,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,r.GetElementTypeName$1(N.ProcClassType)+" "+h.Intf.FName+"."+N.InterfaceName,18,this.GetElementSourcePosStr(N.ResolutionEl)),m.InterfaceProc)}l=rtl.length(o);var x=(o=rtl.arraySetLength(o,s,l+1))[l];x.InterfaceIndex=n,x.ProcClassType=m.ProcClass,x.InterfaceName=T,x.ImplementName=S,x.ResolutionEl=m,x.Count=0}for(var b=0,k=e.Interfaces.FCount-1;b<=k;b++)if(i=b,u=rtl.getObject(t.Interfaces.Get(i)),!ve.isPrototypeOf(u))for(null===u&&(u=this.CreateClassIntfMap(e,i)),h=u;null!==h;){for(var $=0,D=(a=h.Intf).Members.FCount-1;$<=D;$++)if(n=$,c=rtl.getObject(a.Members.Get(n)),xe.isPrototypeOf(c)){S=(f=c).FName;for(var L=0,B=rtl.length(o)-1;L<=B;L++){var M=o[l=L];M.InterfaceIndex===i&&M.ProcClassType===f.$class.ClassType()&&nt(M.InterfaceName,f.FName)&&(S=M.ImplementName,M.Count+=1)}d.$assign(le.$new()),d.Proc=f,d.Args=f.ProcType.Args,d.Kind=0,F=!1,this.IterateElements(S,rtl.createCallback(this,"OnFindProcDeclaration"),d,{get:function(){return F},set:function(e){F=e}}),null===d.Found&&this.RaiseMsg(20180322143202,5042,rtl.getResStr(Ce,"sNoMatchingImplForIntfMethodXFound"),Ye(18,this.GetProcTypeDescription(f.ProcType,rtl.createSet(0,1,2))),e),this.CheckProcSignatureMatch(f,d.Found,!0),h.Procs.Put(n,d.Found)}h=h.AncestorMap}}if(e.ObjKind in Fe.okAllHelpers)for(this.AddActiveHelper(e),p=e.FParent;null!==p;){if(p.$class.ClassType()===Ke){E=rtl.as(p.FData,g),this.AddHelper(e,{p:E,get:function(){return this.p.Helpers},set:function(e){this.p.Helpers=e}});break}p=p.FParent}}this.FTopScope.FElement===e&&this.PopScope(),I.isPrototypeOf(this.FTopScope)&&this.PopGenericParamScope(e),e.IsForward||this.FinishGenericClassOrRecIntf(t)},this.FinishClassOfType=function(e){var t;t=this.ResolveAliasType(e.DestType,!0),a.isPrototypeOf(t)||$e.isPrototypeOf(t)&&1===t.ObjKind||this.RaiseMsg(20170216151602,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,e.DestType.FName,18,"class"),e)},this.FinishPointerType=function(e){var t;t=this.ResolveAliasType(e.DestType,!0),a.isPrototypeOf(t)||(e.DestType.FParent===e&&this.RaiseMsg(20180429094237,3002,rtl.getResStr(Ce,"sNotYetImplemented"),Ye(18,"pointer of anonymous type"),e.DestType),this.CheckUseAsType(e.DestType,20190123095118,e),this.CheckPointerCycle(e))},this.FinishArrayType=function(e){var t=0,s=null,i=q.$new(),n=null,l=null;for(l=e;;){if(l===e.ElType&&this.RaiseMsg(20190807104630,3044,rtl.getResStr(Ce,"sIllegalExpression"),[],e),!Ue.isPrototypeOf(l.FParent))break;l=l.FParent}for(var a=0,o=rtl.length(e.Ranges)-1;a<=o;a++)t=a,s=e.Ranges[t],this.ResolveExpr(s,1),this.ComputeElement(s,i,rtl.createSet(3),null),null===i.IdentEl||De.isPrototypeOf(i.IdentEl)||this.RaiseXExpectedButYFound(20170216151607,"range",r.GetElementTypeName(i.IdentEl),s),37===i.BaseType?i.SubType in r.btArrayRangeTypes||(2===i.SubType?(n=i.LoTypeEl,Je.isPrototypeOf(n)||Ge.isPrototypeOf(n)||this.RaiseXExpectedButYFound(20171009193629,"range",r.GetElementTypeName(i.IdentEl),s)):this.RaiseXExpectedButYFound(20171009193514,"range",r.GetElementTypeName(i.IdentEl),s)):i.BaseType in r.btArrayRangeTypes||2===i.BaseType&&Ge.isPrototypeOf(i.LoTypeEl)||2===i.BaseType&&je.isPrototypeOf(i.LoTypeEl)||(null!==i.IdentEl?this.RaiseXExpectedButYFound(20170216151609,"range",r.GetElementTypeName(i.IdentEl),s):this.RaiseXExpectedButYFound(20190830215123,"range",this.GetResolverResultDescription(i,!1),s));null===e.ElType?(rtl.length(e.Ranges)>0&&this.RaiseNotYetImplemented(20190215102529,e,""),this.FindTVarRec(e)):(this.CheckUseAsType(e.ElType,20190123095401,e),this.FinishSubElementType(e,e.ElType)),v.isPrototypeOf(e.FData)&&(e.FData.GenericStep=2),this.FTopScope.FElement===e&&this.PopScope()},this.FinishAliasType=function(e){var t;t=this.ResolveAliasType(e,!0),ze.isPrototypeOf(t)&&null===t.FData||(ke.isPrototypeOf(t)&&this.GetTypeParameterCount(t)>0&&this.RaiseMsg(20190818135830,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"type",18,this.GetTypeDescription(t,!1)),e),this.EmitTypeHints(e,e.DestType))},this.FinishGenericTemplateType=function(e){var t=this,s=null;function i(i,r,n){t.RaiseMsg(i,3128,rtl.getResStr(Ce,"sConstraintXAndConstraintYCannotBeTogether"),Ye(18,r,18,n),t.GetGenericConstraintErrorEl(s,e))}function n(i,r){t.RaiseMsg(i,3129,rtl.getResStr(Ce,"sXIsNotAValidConstraint"),Ye(18,r),t.GetGenericConstraintErrorEl(s,e))}var l=0,a=!1,o=!1,h=!1,u=null,c=null,p=q.$new();a=!1,o=!1,h=!1,u=null;for(var f=0,d=rtl.length(e.Constraints)-1;f<=d;f++){l=f,s=e.Constraints[l];var F=this.GetGenericConstraintKeyword(s);if(47===F)a&&this.RaiseMsg(20190720202412,3127,rtl.getResStr(Ce,"sConstraintXSpecifiedMoreThanOnce"),Ye(18,"class"),s),o&&i(20190720202516,"record","class"),null!==u&&i(20190720205708,u.FName,"class"),a=!0;else if(96===F)o&&this.RaiseMsg(20190720203028,3127,rtl.getResStr(Ce,"sConstraintXSpecifiedMoreThanOnce"),Ye(18,"record"),s),a&&i(20190720203039,"class","record"),h&&i(20190720203056,"constructor","record"),null!==u&&i(20190720205938,u.FName,"record"),o=!0;else if(50===F)h&&this.RaiseMsg(20190720203123,3127,rtl.getResStr(Ce,"sConstraintXSpecifiedMoreThanOnce"),Ye(18,"constructor"),s),o&&i(20190720203148,"record","constructor"),null!==u&&i(20190720210005,u.FName,"constructor"),h=!0;else{if(De.isPrototypeOf(s)||n(20190912215619,r.GetElementTypeName(s)),this.ComputeElement(s,p,rtl.createSet(4),null),2!==p.BaseType&&n(20190914105144,r.GetElementTypeName(s)),o&&i(20190720210130,"record",p.HiTypeEl.FName),a&&i(20190720210202,"class",p.HiTypeEl.FName),h&&i(20190720210244,"constructor",p.HiTypeEl.FName),je.isPrototypeOf(p.LoTypeEl))p.LoTypeEl===e&&this.RaiseMsg(20200820185313,3106,rtl.getResStr(Ce,"sTypeCycleFound"),[],this.GetGenericConstraintErrorEl(s,e)),rtl.length(e.Constraints)>1&&n(20190831213645,p.HiTypeEl.FName);else if(ze.isPrototypeOf(p.LoTypeEl))if(c=p.LoTypeEl,$e.isPrototypeOf(c)){var m=c.ObjKind;1===m?null!==u&&i(20190720210351,u.FName,c.FName):2===m?null!==u&&($e.isPrototypeOf(u)||i(20190720211236,u.FName,c.FName),2!==u.ObjKind&&i(20190720211304,u.FName,c.FName)):n(20190720210919,c.FName)}else n(20190720210809,c.FName);else n(20190720204604,this.GetResolverResultDescription(p,!0));u=p.LoTypeEl}}},this.FinishSpecializeType=function(e){var t,s,i,r,n=null,l=null,a=0;i=this.StashSubExprScopes(),0===(n=e.Params).FCount&&this.RaiseMsg(20190724114416,3031,rtl.getResStr(Ce,"sMissingParameterX"),Ye(18,"type"),e);for(var o=0,h=n.FCount-1;o<=h;o++)a=o,l=rtl.getObject(n.Get(a)),Yt.isPrototypeOf(l)?this.ResolveExpr(l,1):De.isPrototypeOf(l)||this.RaiseMsg(20190728113336,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"type identifier",18,ye(l)+" parameter "+Ae(a+1)),e);this.RestoreStashedScopes(i),null===(s=e.DestType)?this.RaiseMsg(20190725184734,3001,rtl.getResStr(Ce,"sIdentifierNotFound"),Ye(18,"specialize type"),e):ke.isPrototypeOf(s)||this.RaiseMsg(20190725193552,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"generic type",18,s.FName),e),null===(t=(r=s).GenericTemplateTypes)&&this.RaiseMsg(20190725194222,3130,rtl.getResStr(Ce,"sWrongNumberOfParametersForGenericX"),Ye(18,"type "+s.FName),e),t.FCount!==n.FCount&&this.RaiseMsg(20190801222656,3130,rtl.getResStr(Ce,"sWrongNumberOfParametersForGenericX"),Ye(18,"type "+s.FName),e),this.GetSpecializedEl(e,r,n)},this.FinishResourcestring=function(e){var t=q.$new();this.ResolveExpr(e.Expr,1),this.ComputeElement(e.Expr,t,rtl.createSet(3),null),t.BaseType in r.btAllStringAndChars||this.RaiseXExpectedButYFound(20171004135753,"string",this.GetTypeDescription$1(t,!1),e.Expr)},this.FinishProcedure=function(e){var t,s=0,i=null,n=null,l=null;if(this.CheckTopScope(this.FScopeClass_Proc,!1),(l=this.FTopScope).FElement!==e&&this.RaiseInternalError(20170220163043,""),null!==(t=l.SpecializedFromItem)&&(t.Step<3&&this.RaiseNotYetImplemented(20190920184908,e,""),t.Step>3&&this.RaiseNotYetImplemented(20190920185123,e,"")),null!==(i=e.Body)){this.StoreScannerFlagsInProc(l),At.isPrototypeOf(i.Body)&&(e.FModifiers=rtl.unionSet(e.FModifiers,rtl.createSet(9))),this.ResolveImplBlock(i.Body);for(var a=0,o=i.Declarations.FCount-1;a<=o;a++)s=a,n=rtl.getObject(i.Declarations.Get(s)),xe.isPrototypeOf(n)&&n.IsForward()&&null===rtl.as(n.FData,$).ImplProc&&this.RaiseMsg(20170216151613,3015,rtl.getResStr(Ce,"sForwardProcNotResolved"),Ye(18,r.GetElementTypeName(n),18,n.FName),n);if(null!==l.GroupScope&&(rtl.free(l,"GroupScope"),l.GroupScope=null,null!==l.NestedMembersScope)){for(var h=0,u=this.FScopeCount-1;h<=u;h++)if(s=h,this.GetScopes(s)===l.NestedMembersScope){this.DeleteScope(s);break}rtl.free(l,"NestedMembersScope"),l.NestedMembersScope=null}l.GenericStep=2,null!==l.DeclarationProc&&(rtl.as(l.DeclarationProc.FData,$).GenericStep=2)}null!==l.GroupScope&&this.RaiseNotYetImplemented(20190122142142,e,""),null!==l.NestedMembersScope&&this.RaiseNotYetImplemented(20191014233200,e,""),this.FTopScope.FElement!==e&&this.RaiseInternalError(20190806094032,""),this.PopScope(),2===l.GenericStep&&(null!==l.DeclarationProc&&(l=l.DeclarationProc.FData),null!==l.SpecializedItems&&this.FinishSpecializations(l))},this.FinishProcedureType=function(e){var t="",s=le.$new(),i=null,n=null,l=!1,a=!1,o=!1,h=null,u=null,c=null,p=0,f=0,d=0,F=null,m=null,S=null,T=null,y=null,g=null;if(this.FTopScope.FElement===e&&(rtl.as(e.FData,A).GenericStep=2,this.PopScope()),null!==(n=xe.isPrototypeOf(e.FParent)?e.FParent:null)&&n.ProcType===e){if(this.CheckTopScope(this.FScopeClass_Proc,!1),t=n.FName,u=rtl.as(n.FData,$),null!==(T=this.GetProcTemplateTypes(n))&&((_e.isPrototypeOf(n)||es.isPrototypeOf(n))&&this.RaiseMsg(20190911104114,3136,rtl.getResStr(Ce,"sTypeParamsNotAllowedOnX"),Ye(18,n.ElementTypeName()),n),(n.IsVirtual()||n.IsDynamic()||n.IsMessage()||n.IsOverride())&&this.RaiseMsg(20190911112925,3137,rtl.getResStr(Ce,"sXMethodsCannotHaveTypeParams"),Ye(18,"virtual, dynamic or message"),e),n.IsOverride()&&this.RaiseMsg(20191016174218,3137,rtl.getResStr(Ce,"sXMethodsCannotHaveTypeParams"),Ye(18,"override"),e),n.Visibility in rtl.createSet(0,1,6,2,7,3)||this.RaiseMsg(20191016174327,3137,rtl.getResStr(Ce,"sXMethodsCannotHaveTypeParams"),Ye(18,Fe.VisibilityNames[n.Visibility]),e)),Ve.isPrototypeOf(e)&&null!==(g=e).ResultEl&&this.CheckUseAsType(g.ResultEl.ResultType,20190123095743,g.ResultEl),6 in this.FOptions&&e.GetIsNested()&&this.RaiseInvalidProcTypeModifier(20170402120811,e,1,e),null!==(F=this.GetParentProcBody(n.FParent))&&(null!==T&&this.RaiseMsg(20190912173450,3136,rtl.getResStr(Ce,"sTypeParamsNotAllowedOnX"),Ye(18,"nested "+n.ElementTypeName()),n),6 in this.FOptions||e.SetIsNested(!0),rtl.as(F.FParent,xe).ProcType.GetIsOfObject()&&e.SetIsOfObject(!0)),e.GetIsReference()&&(e.GetIsNested()&&this.RaiseInvalidProcTypeModifier(20170419142818,e,1,e),e.GetIsOfObject()&&this.RaiseInvalidProcTypeModifier(20170419142844,e,0,e)),n.IsExternal()){for(var E in n.FModifiers)(p=+E)in rtl.createSet(0,1,3,5,6,7,12,14,16)||this.RaiseMsg(20170216151616,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"external, "+Fe.ModifierNames[p]),n);for(var P in n.ProcType.Modifiers)(f=+P)in rtl.createSet(0,1,2,3,4,5)||this.RaiseMsg(20170411171224,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"external, "+Fe.ProcTypeModifiers[f]),n)}if(e.GetIsAsync()&&(y=n.$class.ClassType())!==xe&&y!==qe&&y!==ts&&y!==ss&&y!==is&&y!==rs&&this.RaiseMsg(20200524105449,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"async"),n),(o=n.$class.ClassType()===ht||n.$class.ClassType()===ut)&&(n.IsVirtual()&&this.RaiseMsg(20181231150237,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"virtual"),n),n.IsOverride()&&this.RaiseMsg(20181231150305,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"override"),n),n.IsDynamic()&&this.RaiseMsg(20181231150319,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"dynamic"),n),n.IsStatic()&&this.RaiseMsg(20190216214651,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"static"),n),e.Args.FCount>0&&this.RaiseMsg(20181231150404,3063,rtl.getResStr(Ce,"sXCannotHaveParameters"),Ye(18,r.GetElementTypeName(n)),n)),a=r.GetFirstDotPos(t)>0,$e.isPrototypeOf(n.FParent)){var I=d=n.FParent.ObjKind;2===I||6===I?(n.IsVirtual()&&this.RaiseMsg(20180321234324,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,Fe.ObjKindNames[d]+" "+r.GetElementTypeName(n),18,"virtual"),n),n.IsOverride()&&this.RaiseMsg(20180321234551,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,Fe.ObjKindNames[d]+" "+r.GetElementTypeName(n),18,"override"),n),null!==T&&this.RaiseMsg(20190912153024,3137,rtl.getResStr(Ce,"sXMethodsCannotHaveTypeParams"),Ye(18,"interface"),n)):3!==I&&4!==I&&5!==I||(n.IsAbstract()&&this.RaiseMsg(20190116215744,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,Fe.ObjKindNames[d]+" "+r.GetElementTypeName(n),18,"abstract"),n),n.IsVirtual()&&this.RaiseMsg(20190116215823,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,Fe.ObjKindNames[d]+" "+r.GetElementTypeName(n),18,"virtual"),n),n.IsOverride()&&this.RaiseMsg(20190116215825,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,Fe.ObjKindNames[d]+" "+r.GetElementTypeName(n),18,"override"),n),m=this.ResolveAliasType(n.FParent.HelperForType,!0),n.IsStatic()||!this.IsClassMethod(n)||o||m.$class.ClassType()===$e&&1===m.ObjKind||this.RaiseMsg(20190201153831,3088,rtl.getResStr(Ce,"sClassMethodsMustBeStaticInX"),Ye(18,Fe.ObjKindNames[d]),n),n.$class.ClassType()===es&&this.RaiseMsg(20190302151019,3081,rtl.getResStr(Ce,"sXIsNotSupported"),Ye(18,"destructor"),n),n.$class.ClassType()===_e&&m.$class.ClassType()===$e&&1!==m.ObjKind&&this.RaiseMsg(20190302151514,3081,rtl.getResStr(Ce,"sXIsNotSupported"),Ye(18,"constructor"),n)),n.IsAbstract()&&(n.IsVirtual()||this.RaiseMsg(20170216151623,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"abstract without virtual"),n),n.IsOverride()&&this.RaiseMsg(20170216151625,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"abstract, override"),n)),n.IsVirtual()&&n.IsOverride()&&this.RaiseMsg(20170216151627,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"virtual, override"),n),n.IsReintroduced()&&n.IsOverride()&&this.RaiseMsg(20171119111845,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"reintroduce, override"),n),n.IsForward()&&this.RaiseMsg(20170216151629,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"forward"),n),n.IsStatic()&&n.$class.ClassType()!==ts&&n.$class.ClassType()!==ss&&this.RaiseMsg(20170216151631,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"static"),n)}else Me.isPrototypeOf(n.FParent)?(n.$class.ClassType()!==_e||0!==e.Args.FCount&&null===rtl.getObject(e.Args.Get(0)).ValueExpr||this.RaiseMsg(20181226231333,3061,rtl.getResStr(Ce,"sParameterlessConstructorsNotAllowedInRecords"),[],e),n.IsReintroduced()&&this.RaiseMsg(20181218195735,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"record "+r.GetElementTypeName(n),18,"reintroduce"),n),n.IsVirtual()&&this.RaiseMsg(20181218195431,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"record "+r.GetElementTypeName(n),18,"virtual"),n),n.IsOverride()&&this.RaiseMsg(20181218195437,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"record "+r.GetElementTypeName(n),18,"override"),n),n.IsAbstract()&&this.RaiseMsg(20181218195552,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"record "+r.GetElementTypeName(n),18,"abstract"),n),n.IsForward()&&this.RaiseMsg(20181218195514,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"record "+r.GetElementTypeName(n),18,"forward"),n),this.IsClassMethod(n)&&!o?n.IsStatic()||this.RaiseMsg(20190106121503,3088,rtl.getResStr(Ce,"sClassMethodsMustBeStaticInX"),Ye(18,"records"),n):n.IsStatic()&&this.RaiseMsg(20190206150922,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(n),18,"static"),n)):(n.IsAbstract()&&this.RaiseInvalidProcModifier(20170216151634,n,2,n),n.IsVirtual()&&this.RaiseInvalidProcModifier(20170216151635,n,0,n),n.IsOverride()&&this.RaiseInvalidProcModifier(20170216151637,n,3,n),n.IsMessage()&&this.RaiseInvalidProcModifier(20170216151638,n,6,n),n.IsStatic()&&!a&&this.RaiseInvalidProcTypeModifier(20170216151640,e,2,e),!a&&n.GetProcTypeEnum()in rtl.createSet(3,4,5,6,7,8,9)&&this.RaiseXExpectedButYFound(20170419232724,"full method name","short name",e));if(u.GenericStep=1,a)return void this.FinishMethodImplHeader(n);if(""!==t||n.GetProcTypeEnum()in rtl.createSet(10,11)||this.RaiseNotYetImplemented(20160922163407,e,""),Ve.isPrototypeOf(e)&&!(1 in u.Flags)&&this.EmitTypeHints(e.ResultEl,e.ResultEl.ResultType),null!==n.PublicName&&this.ResolveExpr(n.PublicName,1),null!==n.LibraryExpr&&this.ResolveExpr(n.LibraryExpr,1),null!==n.LibrarySymbolName&&this.ResolveExpr(n.LibrarySymbolName,1),null!==n.DispIDExpr&&this.ResolveExpr(n.DispIDExpr,1),null!==n.MessageExpr&&(this.ResolveExpr(n.MessageExpr,1),1!==(S=n.ProcType.Args).FCount&&this.RaiseMsg(20190303223701,3118,rtl.getResStr(Ce,"sMessageHandlersInvalidParams"),[],e),rtl.getObject(S.Get(0)).Access in rtl.createSet(2,3)||this.RaiseMsg(20190303223834,3118,rtl.getResStr(Ce,"sMessageHandlersInvalidParams"),[],e),n.$class.ClassType()!==xe&&n.$class.ClassType()!==qe&&this.RaiseMsg(20190303224128,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"procedure name(var Msg);message id;",18,r.GetElementTypeName(e)),e)),ze.isPrototypeOf(n.FParent))return void this.FinishMethodDeclHeader(n);if(""!==t&&r.ProcNeedsBody(n)){if(1 in u.Flags)null!==u.DeclarationProc&&this.ReplaceProcScopeImplArgsWithDeclArgs(u);else if(c=rtl.as(this.GetParentLocalScope(),C),null===(i=this.FindProcSameSignature(t,n,c,!0))&&n.FParent.$class.ClassType()===Xe&&(i=this.FindProcSameSignature(t,n,rtl.as(n.GetModule().InterfaceSection.FData,C),!0)),null!==i){if(r.ProcNeedsImplProc(i))return null!==(h=rtl.as(i.FData,$)).ImplProc&&this.RaiseMsg(20180318222430,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,h.ImplProc.FName,18,this.GetElementSourcePosStr(h.ImplProc)),n),this.CheckProcSignatureMatch(i,n,!1),h.ImplProc=n,i.IsAssembler()&&(n.FModifiers=rtl.unionSet(n.FModifiers,rtl.createSet(9))),u.DeclarationProc=i,c.RemoveLocalIdentifier(n),void this.ReplaceProcScopeImplArgsWithDeclArgs(u);this.RaiseMsg(20180318220543,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,i.FName,18,this.GetElementSourcePosStr(i)),n)}}else this.StoreScannerFlagsInProc(u);""!==t&&(s.$assign(le.$new()),s.Proc=n,s.Args=n.ProcType.Args,s.Kind=1,l=!1,this.IterateElements(t,rtl.createCallback(this,"OnFindProc"),s,{get:function(){return l},set:function(e){l=e}}))}else e.FName},this.FinishMethodDeclHeader=function(e){var t=this;function s(e,s){t.LogMsg(20170325004215,3,3250,rtl.getResStr(Ce,"sVirtualMethodXHasLowerVisibility"),Ye(18,e.FName,18,Fe.VisibilityNames[e.Visibility],18,s.FParent.FName,18,Fe.VisibilityNames[s.Visibility]),e),e.Visibility=s.Visibility}var i,r,n=!1,l=null,a=le.$new(),o=null,h=null,u=0,c=null;if(2 in e.ProcType.Modifiers||e.ProcType.SetIsOfObject(!0),h=rtl.as(this.FTopScope,$),c=this.GetScopes(this.FScopeCount-2),this.StoreScannerFlagsInProc(h),r=e.FParent,l=rtl.as(r.FData,N),h.ClassRecScope=l,i=this.GetProcTemplateTypes(e),a.$assign(le.$new()),e.$class.ClassType()===ht||e.$class.ClassType()===ut?null!==i&&this.RaiseNotYetImplemented(20190911105953,e,""):(a.Proc=e,a.Args=e.ProcType.Args,a.Kind=2,n=!1,c.IterateElements(e.FName,l,rtl.createCallback(t,"OnFindProc"),a,{get:function(){return n},set:function(e){n=e}})),null===a.Found)e.IsOverride()&&this.RaiseMsg(20170216151702,3022,rtl.getResStr(Ce,"sNoMethodInAncestorToOverride"),Ye(18,this.GetProcTypeDescription(e.ProcType,rtl.createSet(0,2))),e.ProcType);else if(o=a.Found,h.OverriddenProc=o,e.IsOverride()){if(o.IsVirtual()||o.IsOverride()||this.RaiseMsg(20170216151708,3022,rtl.getResStr(Ce,"sNoMethodInAncestorToOverride"),Ye(18,this.GetProcTypeDescription(e.ProcType,rtl.createSet(0,2))),e.ProcType),this.CheckProcSignatureMatch(o,e,!0),e.Visibility!==o.Visibility){var p=e.Visibility;1===p||6===p?o.Visibility in rtl.createSet(1,6)||s(e,o):2===p||7===p?o.Visibility in rtl.createSet(1,2,6,7)||s(e,o):3===p?o.Visibility in rtl.createSet(null,1,3,6,7)||s(e,o):4===p||this.RaiseNotYetImplemented(20170325003315,e,"visibility")}if(0 in this.FOptions&&(e.FName=o.FName),o.IsAbstract()&&O.isPrototypeOf(l))for(var f=rtl.length(l.AbstractProcs)-1;f>=0;f--)u=f,l.AbstractProcs[u]===o&&l.AbstractProcs.splice(u,1);this.IsProcOverload(o)&&(h.Flags=rtl.includeSet(h.Flags,2))}e.IsAbstract()&&O.isPrototypeOf(l)&&(l.AbstractProcs=rtl.arrayInsert(e,l.AbstractProcs,rtl.length(l.AbstractProcs))),this.CreateProcSelfArg(e)},this.FinishMethodImplHeader=function(e){var t,s,i="",n=null,l=null,a=null;e.IsExternal()&&this.RaiseMsg(20170216151715,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(e),18,"external"),e),e.IsExported()&&this.RaiseMsg(20170216151717,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(e),18,"export"),e),i=e.FName,null===(t=(n=rtl.as(e.FData,$)).ClassRecScope)&&this.RaiseInternalError(20161013172346,""),null===n.GroupScope&&this.RaiseInternalError(20190120135017,""),i=null!==e.NameParts?rtl.getObject(e.NameParts.Get(e.NameParts.FCount-1)).Name:r.LastDottedIdentifier(i),a=null,l=null,null===n.DeclarationProc?(r.IsValidIdent(i,!1,!1)||this.RaiseNotYetImplemented(20160922163421,e.ProcType,""),null===(a=e.$class.ClassType()===ht?t.ClassConstructor:e.$class.ClassType()===ut?t.ClassDestructor:this.FindProcSameSignature(i,e,t,!1))&&this.RaiseIdentifierNotFound(20170216151720,this.GetProcName(e,!0),e.ProcType),l=rtl.as(a.FData,$),e.ProcType.SetIsOfObject(a.ProcType.GetIsOfObject()),null!==l.ImplProc&&this.RaiseMsg(20180212094546,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,l.ImplProc.FName,18,this.GetElementSourcePosStr(l.ImplProc)),e),a.IsAbstract()&&this.RaiseMsg(20170216151722,3017,rtl.getResStr(Ce,"sAbstractMethodsMustNotHaveImplementation"),[],e),a.IsExternal()&&this.RaiseXExpectedButYFound(20170216151725,"method","external method",e),this.CheckProcSignatureMatch(a,e,!1),a.IsAssembler()&&(e.FModifiers=rtl.unionSet(e.FModifiers,rtl.createSet(9))),n.DeclarationProc=a,l.ImplProc=e,this.ReplaceProcScopeImplArgsWithDeclArgs(n)):1 in n.Flags?(a=n.DeclarationProc,(l=rtl.as(a.FData,$)).ImplProc!==e&&this.RaiseNotYetImplemented(20190804182220,e,""),this.ReplaceProcScopeImplArgsWithDeclArgs(n)):this.RaiseNotYetImplemented(20190804181222,e,""),null!==(s=l.SelfArg)&&(n.SelfArg=s,this.AddIdentifier(n,"Self",s,3))},this.FinishExceptOnExpr=function(){var e,t=q.$new();this.CheckTopScope(L,!1),e=this.FTopScope.FElement.TypeEl,this.ComputeElement(e,t,rtl.createSet(4),null),this.CheckIsClass(e,t)},this.FinishExceptOnStatement=function(){this.CheckTopScope(L,!1),this.ResolveImplElement(this.FTopScope.FElement.Body),this.PopScope()},this.FinishParserSpecializeType=function(e){this.PopScope()},this.FinishWithDo=function(e){this.PopWithScope(e)},this.FinishForLoopHeader=function(e){var t=q.$new(),s=q.$new(),i=q.$new(),r=q.$new(),n=!1,l=!1,a=null,o=null,h=null,u=null,c=0,p=null,f=null,d=null,F=null;this.CreateScope(e,G),this.ResolveExpr(e.VariableName,3),this.ComputeElement(e.VariableName,t,rtl.createSet(1,0),null),this.ResolvedElCanBeVarParam(t,e.VariableName,!0)||this.RaiseVarExpected(20170216151955,e.VariableName,t.IdentEl),(d=(F=t.IdentEl).$class.ClassType())===We||d===$t||d===He&&(Ne.isPrototypeOf(F.FParent)||st.isPrototypeOf(F.FParent))||this.RaiseMsg(20220815164902,3146,rtl.getResStr(Ce,"sForLoopControlVarMustBeSimpleLocalVar"),[],e.VariableName),this.ResolveExpr(e.StartExpr,1),this.ComputeElement(e.StartExpr,s,rtl.createSet(0),null);var m=e.LoopType;if(0===m||1===m)2147483647===this.CheckAssignResCompatibility(t,s,e.StartExpr,!0)&&this.RaiseIncompatibleTypeRes(20170216151958,3028,[],s,t,e.StartExpr),this.CheckAssignExprRange(t,e.StartExpr),this.ResolveExpr(e.EndExpr,1),this.ComputeElement(e.EndExpr,i,rtl.createSet(0),null),2147483647===this.CheckAssignResCompatibility(t,i,e.EndExpr,!1)&&this.RaiseIncompatibleTypeRes(20170216152001,3028,[],i,t,e.EndExpr),this.CheckAssignExprRange(t,e.EndExpr);else if(2===m){if((n=this.CheckForIn(e,t,s))||De.isPrototypeOf(s.IdentEl)||!(0 in s.Flags)||(n=this.CheckForInClassOrRec(e,t,s)),!n){o=null,a=null;try{if(r.$assign(s),De.isPrototypeOf(s.IdentEl))p=s.LoTypeEl,Ue.isPrototypeOf(p)&&1===rtl.length(p.Ranges)&&(a=this.Eval(p.Ranges[0],rtl.createSet(0),!0)),null===a&&(a=this.EvalTypeRange(p,{}));else if(0 in s.Flags)if((c=s.BaseType)in rtl.createSet(34,36))null===s.IdentEl&&null!==s.ExprEl&&(a=this.Eval(s.ExprEl,{},!0)),null===a&&(a=this.EvalTypeRange(s.LoTypeEl,{}));else if(2===c)(d=(p=s.LoTypeEl).$class.ClassType())===Ue&&(f=this.GetArrayElType(p),this.ComputeElement(f,s,rtl.createSet(4),null),s.Flags=rtl.intersectSet(r.Flags,rtl.createSet(0,1)),2147483647===this.CheckAssignResCompatibility(t,s,e.StartExpr,!0)&&this.RaiseIncompatibleTypeRes(20171112210138,3028,[],s,t,e.StartExpr),n=!0);else{9===(c=this.GetActualBaseType(c))&&(a=ns.$create("CreateValue",[3,null,0,65535]))}if(!n&&null!==a){null===(o=this.EvalTypeRange(t.LoTypeEl,{}))&&this.RaiseXExpectedButYFound(20171109191528,"range",this.GetResolverResultDescription(t,!1),e.VariableName);var C=a.Kind;if(10===C||12===C)if(h=a,10===o.Kind){u=o,l=12!==a.Kind||rtl.length(a.Ranges)>0;var S=h.ElKind;1===S?1===u.ElKind&&this.IsSameType(h.ElType,u.ElType,2)||this.RaiseXExpectedButYFound(20171109200752,this.GetTypeDescription(h.ElType,!1),this.GetResolverResultDescription(t,!0),e.VariableName):2===S?2!==u.ElKind&&this.RaiseXExpectedButYFound(20171109200752,"integer",this.GetResolverResultDescription(t,!0),e.VariableName):3===S?3!==u.ElKind&&this.RaiseXExpectedButYFound(20171109200753,"char",this.GetResolverResultDescription(t,!0),e.VariableName):4===S?4!==u.ElKind&&this.RaiseXExpectedButYFound(20171109200754,"boolean",this.GetResolverResultDescription(t,!0),e.VariableName):l&&this.RaiseNotYetImplemented(20171109200954,e.StartExpr,""),l&&(u.RangeStart>h.RangeStart&&this.fExprEvaluator.EmitRangeCheckConst(20171109201428,h.ElementAsString(h.RangeStart),u.ElementAsString(u.RangeStart),u.ElementAsString(u.RangeEnd),e.VariableName,1),u.RangeEnd<h.RangeEnd&&this.fExprEvaluator.EmitRangeCheckConst(20171109201429,h.ElementAsString(h.RangeEnd),u.ElementAsString(u.RangeStart),u.ElementAsString(u.RangeEnd),e.VariableName,1)),n=!0}}n||this.RaiseMsg(20171108223818,3074,rtl.getResStr(Ce,"sCannotFindEnumeratorForType"),Ye(18,this.GetBaseDescription(r,!1)),e.StartExpr)}finally{Ot({get:function(){return o},set:function(e){o=e}}),Ot({get:function(){return a},set:function(e){a=e}})}}}else this.RaiseNotYetImplemented(20171108221334,e,"")},this.FinishDeclaration=function(e){var t;(t=e.$class.ClassType())===He||t===it?this.FinishVariable(e):t===ve?this.FinishProperty(e):t===We?this.FinishArgument(e):t===Zt?this.FinishMethodResolution(e):t===_t?this.FinishAttributes(e):t===ls?this.FinishExportSymbol(e):this.RaiseNotYetImplemented(20180127121557,e,"")},this.FinishVariable=function(e){var t=q.$new(),s=null,i=null;4===e.Visibility&&rtl.neSet(rtl.intersectSet(rtl.createSet(4,5,0),e.VarModifiers),{})&&this.RaiseMsg(20170403223837,3053,rtl.getResStr(Ce,"sSymbolCannotBePublished"),[],e),null!==e.Expr&&this.ResolveExpr(e.Expr,1),null!==e.VarType?(Me.isPrototypeOf(e.FParent)&&e.VarType===e.FParent&&this.RaiseMsg(20181218173631,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,e.VarType.FName),e),this.CheckUseAsType(e.VarType,20190123095916,e),null!==e.Expr&&this.CheckAssignCompatibility(e,e.Expr,!0,null),e.VarType.FParent===e&&this.FinishSubElementType(e,e.VarType)):null!==e.Expr&&(i=this.Eval(e.Expr,rtl.createSet(1),!0),Ot({get:function(){return i},set:function(e){i=e}})),null!==e.AbsoluteExpr&&(e.$class.ClassType()===it&&this.RaiseMsg(20180201225530,3052,rtl.getResStr(Ce,"sXModifierMismatchY"),Ye(18,"absolute",18,"const"),e.AbsoluteExpr),null===e.VarType&&this.RaiseMsg(20171225235125,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],e.AbsoluteExpr),1 in e.VarModifiers&&this.RaiseMsg(20171226104221,3052,rtl.getResStr(Ce,"sXModifierMismatchY"),Ye(18,"absolute",18,"external"),e.AbsoluteExpr),this.ResolveExpr(e.AbsoluteExpr,1),this.ComputeElement(e.AbsoluteExpr,t,rtl.createSet(1),null),0 in t.Flags&&null!==t.IdentEl||this.RaiseVarExpected(20171225234734,e.AbsoluteExpr,t.IdentEl),(s=t.IdentEl.$class.ClassType())===He||s===We||s===it&&null!==t.IdentEl.VarType||s===$t||this.RaiseMsg(20171225235203,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],e.AbsoluteExpr),0 in t.Flags||this.RaiseVarExpected(20171225235249,e.AbsoluteExpr,t.IdentEl),t.IdentEl===e&&this.RaiseMsg(20171226000703,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],e.AbsoluteExpr)),null!==e.VarType&&this.EmitTypeHints(e,e.VarType)},this.FinishProperty=function(e){var t=this,s=null,i=null,n=null,l=null,a=null;function o(e){return null===n?!0===e:1 in t.FOptions||!0===e}function h(e,s,i,r){var n=q.$new();i.Access in rtl.createSet(0,1)||t.RaiseMsg(20170924202437,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(e),18,Fe.AccessDescriptions[i.Access],18,Fe.AccessDescriptions[1]),r),null===i.ArgType?t.RaiseMsg(20170924202531,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(e),18,"untyped",18,t.GetTypeDescription$1(s,!1)),r):2147483647===t.CheckParamCompatibility(a,i,e,!0,!1)&&(t.ComputeElement(i.ArgType,n,rtl.createSet(4),null),t.RaiseIncompatibleTypeRes(20170924203829,3006,Ye(18,Ae(e)),n,s,r))}function u(s,i,n,l){var a=0,o=null,u=null,c=q.$new(),p=q.$new(),f=!1;for(a=0;a<e.FArgs.FCount;)a>=s.ProcType.Args.FCount&&t.RaiseMsg(20170216151805,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,s.FName),l),o=rtl.getObject(e.FArgs.Get(a)),u=rtl.getObject(s.ProcType.Args.Get(a)),a+=1,f=!1,o.Access!==u.Access&&(o.Access in rtl.createSet(0,1)&&u.Access in rtl.createSet(0,1)&&null!==o.ArgType&&null!==u.ArgType&&(f=!0),f||t.RaiseMsg(20170216151808,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(a),18,Fe.AccessDescriptions[u.Access],18,Fe.AccessDescriptions[o.Access]),l)),null===o.ArgType?null!==u.ArgType&&t.RaiseMsg(20170216151811,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(a),18,r.GetElementTypeName(u.ArgType),18,"untyped"),l):null===u.ArgType?t.RaiseMsg(20170216151813,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(a),18,"untyped",18,r.GetElementTypeName(o.ArgType)),l):(t.ComputeElement(o,c,rtl.createSet(1),null),t.ComputeElement(u,p,rtl.createSet(1),null),c.BaseType!==p.BaseType&&t.RaiseMsg(20170216151816,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(a),18,t.GetBaseTypeNames(p.BaseType),18,t.GetBaseTypeNames(c.BaseType)),l),null===c.LoTypeEl&&t.RaiseInternalError(20161010125255,""),null===p.LoTypeEl&&t.RaiseInternalError(20161010125304,""),t.IsSameType(c.HiTypeEl,p.HiTypeEl,1)||t.RaiseIncompatibleType(20170216151819,3006,Ye(18,Ae(a)),p.HiTypeEl,c.HiTypeEl,l)),f&&(c.BaseType in rtl.unionSet(rtl.unionSet(rtl.unionSet(r.btAllBooleans,r.btAllInteger),r.btAllStringAndChars),r.btAllFloats)||t.RaiseMsg(20181007181647,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(a),18,Fe.AccessDescriptions[u.Access],18,Fe.AccessDescriptions[o.Access]),l));null!==i&&(a>=s.ProcType.Args.FCount&&t.RaiseMsg(20170924202334,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,s.FName),l),h(a,n,u=rtl.getObject(s.ProcType.Args.Get(a)),l))}var c,p,f=null,d=null,F=null,m=null,C=null,S=0,T=0,y=q.$new(),g=q.$new(),E=q.$new(),P=q.$new(),I=0,R=null,v=null,A=null,x=null;if(this.CheckTopScope(D,!1),this.PopScope(),4===e.Visibility)for(var $ in e.VarModifiers)(I=+$)in rtl.createSet(1)||this.RaiseMsg(20170403224112,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"published property",18,'"'+Fe.VariableModifierNames[I]+'"'),e);s=null,c=rtl.as(e.FParent,ze),i=rtl.as(r.NoNil(c.FData),N),n=null,x=null,O.isPrototypeOf(i)&&(n=i,x=c),l=null,p=null,null===s&&(p=null,null!==n&&null!==n.AncestorScope&&(t.CheckTopScope(k,!1),p=t.FTopScope.FindAncestorElement(e.FName)),ve.isPrototypeOf(p)?(l=p,e.FData.AncestorProp=l,0 in t.FOptions&&(e.FName=l.FName)):l=null,null!==e.VarType?(s=e.VarType,t.CheckUseAsType(e.VarType,20190123100011,e)):(null===l&&t.RaiseMsg(20170216151741,3025,rtl.getResStr(Ce,"sNoPropertyFoundToOverride"),[],e),e.$class.ClassType()!==l.$class.ClassType()&&t.RaiseXExpectedButYFound(20170216151744,r.GetElementTypeName(l),r.GetElementTypeName(e),e),s=t.GetPasPropertyType(l),null===n&&t.RaiseNotYetImplemented(20181231130642,e,""),n.DefaultProperty===l&&(n.DefaultProperty=e))),R=null;try{if(null!==e.IndexExpr?(a=e.IndexExpr,this.ResolveExpr(a,1)):a=this.GetPasPropertyIndex(e),null!==a){this.ComputeElement(a,E,rtl.createSet(3),null);var L=(R=this.Eval(a,rtl.createSet(0),!0)).Kind;3===L||4===L||5===L||6===L||7===L||8===L||9===L||this.RaiseXExpectedButYFound(20170924202837,"ordinal",this.GetTypeDescription$1(E,!1),e.IndexExpr),null!==e.IndexExpr&&null===e.VarType&&(null===(v=this.GetPasPropertyIndex(l))?(null===e.ReadAccessor&&(F=this.GetPasPropertyGetter(l),xe.isPrototypeOf(F)&&this.RaiseMsg(20171002144103,3072,rtl.getResStr(Ce,"sAddingIndexSpecifierRequiresNewX"),Ye(18,"read"),a)),null===e.WriteAccessor&&(F=this.GetPasPropertySetter(l),xe.isPrototypeOf(F)&&this.RaiseMsg(20171002144419,3072,rtl.getResStr(Ce,"sAddingIndexSpecifierRequiresNewX"),Ye(18,"write"),a)),null===e.StoredAccessor&&null!==(F=this.GetPasPropertyStoredExpr(l))&&(this.ComputeElement(F,P,rtl.createSet(1),null),xe.isPrototypeOf(P.IdentEl)&&this.RaiseMsg(20171002144644,3072,rtl.getResStr(Ce,"sAddingIndexSpecifierRequiresNewX"),Ye(18,"stored"),a))):this.CheckEqualElCompatibility(e.IndexExpr,v,e.IndexExpr,!0,!1))}null!==e.ReadAccessor&&(A=e.ReadAccessor,(F=this.ResolveAccessor(e.ReadAccessor)).$class.ClassType()===He||F.$class.ClassType()===it?(e.FArgs.FCount>0&&this.RaiseXExpectedButYFound(20170216151823,"function",r.GetElementTypeName(F),A),this.IsSameType(F.VarType,s,2)||this.RaiseIncompatibleType(20170216151826,3028,[],s,F.VarType,A),4 in e.VarModifiers!=4 in F.VarModifiers&&(4 in e.VarModifiers?this.RaiseXExpectedButYFound(20170216151828,"class var","var",A):this.RaiseXExpectedButYFound(20170216151831,"var","class var",A))):xe.isPrototypeOf(F)?(m=F,4 in e.VarModifiers?(m.$class.ClassType()!==ss&&this.RaiseXExpectedButYFound(20170216151834,"class function",r.GetElementTypeName(m),A),o(m.IsStatic())||(m.IsStatic()?this.RaiseMsg(20170216151837,3040,rtl.getResStr(Ce,"sClassPropertyAccessorMustNotBeStatic"),[],A):this.RaiseMsg(20170216151839,3039,rtl.getResStr(Ce,"sClassPropertyAccessorMustBeStatic"),[],A))):m.$class.ClassType()!==qe&&this.RaiseXExpectedButYFound(20170216151842,"function",r.GetElementTypeName(m),A),f=m.GetFT().ResultEl.ResultType,this.IsSameType(f,s,2)||this.RaiseXExpectedButYFound(20170216151844,"function result "+this.GetTypeDescription(s,!0),this.GetTypeDescription(f,!0),A),m.IsAsync()&&this.RaiseMsg(20200526101546,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"property getter",18,Fe.ProcTypeModifiers[5]),A),u(m,R,E,e.ReadAccessor),T=e.FArgs.FCount,null!==R&&(T+=1),m.ProcType.Args.FCount!==T&&this.RaiseMsg(20170216151847,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,m.FName),A)):this.RaiseXExpectedButYFound(20170216151850,"variable",r.GetElementTypeName(F),A)),null!==e.WriteAccessor?(A=e.WriteAccessor,(F=this.ResolveAccessor(e.WriteAccessor)).$class.ClassType()===He||F.$class.ClassType()===it&&!F.IsConst?(e.FArgs.FCount>0&&this.RaiseXExpectedButYFound(20170216151852,"procedure",r.GetElementTypeName(F),A),this.IsSameType(F.VarType,s,2)||this.RaiseIncompatibleType(20170216151855,3028,[],s,F.VarType,A),4 in e.VarModifiers!=4 in F.VarModifiers&&(4 in e.VarModifiers?this.RaiseXExpectedButYFound(20170216151858,"class var","var",A):this.RaiseXExpectedButYFound(20170216151900,"var","class var",A))):xe.isPrototypeOf(F)?(m=F,4 in e.VarModifiers?(m.$class.ClassType()!==ts&&this.RaiseXExpectedButYFound(20170216151903,"class procedure",r.GetElementTypeName(m),A),o(m.IsStatic())||(m.IsStatic()?this.RaiseMsg(20170216151905,3040,rtl.getResStr(Ce,"sClassPropertyAccessorMustNotBeStatic"),[],A):this.RaiseMsg(20170216151906,3039,rtl.getResStr(Ce,"sClassPropertyAccessorMustBeStatic"),[],A))):m.$class.ClassType()!==xe&&this.RaiseXExpectedButYFound(20170216151910,"procedure",r.GetElementTypeName(m),A),m.IsAsync()&&this.RaiseMsg(20200526101635,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,"property setter",18,Fe.ProcTypeModifiers[5]),A),u(m,R,E,e.WriteAccessor),S=e.FArgs.FCount,null!==R&&(S+=1),m.ProcType.Args.FCount!==S+1&&this.RaiseMsg(20170216151913,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,m.FName),A),(C=rtl.getObject(m.ProcType.Args.Get(S))).Access in rtl.createSet(0,1)||this.RaiseMsg(20170216151917,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(S+1),18,Fe.AccessDescriptions[C.Access],18,Fe.AccessDescriptions[1]),A),this.IsSameType(C.ArgType,s,2)||this.RaiseIncompatibleType(20170216151919,3006,Ye(18,Ae(S+1)),C.ArgType,s,A)):this.RaiseXExpectedButYFound(20170216151921,"variable",r.GetElementTypeName(F),A)):null===e.ReadAccessor&&null!==e.VarType&&this.RaiseMsg(20180519173551,3050,rtl.getResStr(Ce,"sPropertyMustHaveReadOrWrite"),[],e),rtl.length(e.Implements)>0&&function(){var i,l=0,o=0,h=null,u=q.$new(),c=null,p=null,f=null,d=null,F=null;$e.isPrototypeOf(e.FParent)||t.RaiseInternalError(20180323172125,r.GetElementDbgPath(e)),i=e.FParent,e.FArgs.FCount>0&&t.RaiseMsg(20180323170952,3101,rtl.getResStr(Ce,"sImplementsDoesNotSupportArrayProperty"),[],e.Implements[0]),null!==a&&t.RaiseMsg(20180323171354,3102,rtl.getResStr(Ce,"sImplementsDoesNotSupportIndex"),[],e.Implements[0]),null===t.GetPasPropertyGetter(e)&&t.RaiseMsg(20180323221322,3104,rtl.getResStr(Ce,"sImplPropMustHaveReadSpec"),[],e.Implements[0]);for(var m=0,C=rtl.length(e.Implements)-1;m<=C;m++){l=m,h=e.Implements[l],t.ResolveExpr(h,1),t.ComputeElement(h,u,rtl.createSet(4,1),null),De.isPrototypeOf(u.IdentEl)||(null===u.IdentEl?t.RaiseXExpectedButYFound(20180323171911,"interface",r.GetElementTypeName(u.LoTypeEl),h):t.RaiseXExpectedButYFound(20180323224846,"interface",r.GetElementTypeName(u.IdentEl),h)),f=u.IdentEl,p=t.ResolveAliasType(f,!0),$e.isPrototypeOf(p)&&2===p.ObjKind||t.RaiseXExpectedButYFound(20180323172904,"interface",r.GetElementTypeName(f),h),(o=t.IndexOfImplementedInterface(i,p))<0&&t.RaiseMsg(20180323172420,3103,rtl.getResStr(Ce,"sImplementsUsedOnUnimplIntf"),Ye(18,f.FName),h),d=t.ResolveAliasType(s,!0),$e.isPrototypeOf(d)||t.RaiseMsg(20180323222334,3105,rtl.getResStr(Ce,"sDoesNotImplementInterface"),Ye(18,r.GetElementTypeName(s),18,r.GetElementTypeName(f)),h);var S=(c=d).ObjKind;1===S?null===t.GetClassImplementsIntf(c,p)&&t.RaiseMsg(20180323223324,3105,rtl.getResStr(Ce,"sDoesNotImplementInterface"),Ye(18,r.GetElementTypeName(s),18,r.GetElementTypeName(f)),h):2===S?2147483647===t.CheckClassIsClass(s,p)&&t.RaiseIncompatibleType(20180323173746,3028,[],f,s,h):t.RaiseMsg(20180323222821,3105,rtl.getResStr(Ce,"sDoesNotImplementInterface"),Ye(18,r.GetElementTypeName(s),18,r.GetElementTypeName(f)),h),F=rtl.getObject(n.Interfaces.Get(o)),ve.isPrototypeOf(F)?t.RaiseMsg(20180323174240,3103,rtl.getResStr(Ce,"sDuplicateImplementsForIntf"),Ye(18,f.FName,18,t.GetElementSourcePosStr(F)),h):b.isPrototypeOf(F)?t.RaiseInternalError(20180323175919,r.GetElementDbgPath(e)):null!==F?t.RaiseInternalError(20180323174342,ye(F)):n.Interfaces.Put(o,e)}}(),null!==e.StoredAccessor&&function(s,i,n){var l=q.$new(),a=null,o=null,u=null,c=null,p=null,f=null,d=0;if(t.ResolveExpr(s,1),t.ComputeElement(s,l,rtl.createSet(1),null),f=l.IdentEl,xe.isPrototypeOf(f))return o=f,Dt.isPrototypeOf(s)||t.RaiseXExpectedButYFound(20170923202002,"member function","foreign "+r.GetElementTypeName(o),s),o.$class.ClassType()!==qe&&t.RaiseXExpectedButYFound(20170216151925,"function",r.GetElementTypeName(o),s),u=o.GetFT().ResultEl.ResultType,t.IsBaseType(u,15,!0)||t.RaiseXExpectedButYFound(20170923200836,"function: boolean","function:"+t.GetTypeDescription(u,!1),e.StoredAccessor),o.IsAsync()&&t.RaiseInvalidProcTypeModifier(20200524104719,o.ProcType,5,s),d=0,null!==i&&(d+=1),o.ProcType.Args.FCount!==d&&t.RaiseMsg(20170923200840,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,o.FName),s),void(null!==i&&h(1,n,rtl.getObject(o.ProcType.Args.Get(0)),s));if(null!==f&&(f.$class.ClassType()===He||f.$class.ClassType()===it&&!f.IsConst))return p=f,Dt.isPrototypeOf(s)||t.RaiseXExpectedButYFound(20170923202003,"member variable","foreign "+r.GetElementTypeName(p),s),c=p.VarType,c=t.ResolveAliasType(c,!0),t.IsBaseType(c,15,!0)||t.RaiseIncompatibleType(20170409214300,3028,[],c,t.GetBaseTypes(15),s),void(4 in e.VarModifiers!=4 in p.VarModifiers&&(4 in e.VarModifiers?t.RaiseXExpectedButYFound(20170409214351,"class var","var",s):t.RaiseXExpectedButYFound(20170409214359,"var","class var",s)));if(15===l.BaseType&&null!==l.ExprEl&&null!==(a=t.Eval(s,rtl.createSet(0),!0)))try{return void(3!==a.Kind&&t.RaiseXExpectedButYFound(20170923200256,"boolean",t.GetResolverResultDescription(l,!1),s))}finally{Ot({get:function(){return a},set:function(e){a=e}})}t.RaiseXExpectedButYFound(20170923194234,"identifier",t.GetResolverResultDescription(l,!1),s)}(e.StoredAccessor,R,E),null!==e.DefaultExpr&&(this.ResolveExpr(e.DefaultExpr,1),this.ComputeElement(e.DefaultExpr,g,rtl.createSet(3),null),this.ComputeElement(s,y,rtl.createSet(4),null),y.IdentEl=e,y.Flags=rtl.createSet(0),this.CheckEqualResCompatibility(y,g,e.DefaultExpr,!0,null)),e.IsDefault&&(null!==x&&null!==x.HelperForType&&(d=this.ResolveAliasType(x.HelperForType,!0),ze.isPrototypeOf(d)||this.RaiseMsg(20190117125004,3116,rtl.getResStr(Ce,"sDefaultPropertyNotAllowedInHelperForX"),Ye(18,this.GetTypeDescription(x.HelperForType,!1)),e)),null!==i.DefaultProperty&&i.DefaultProperty.FParent===e.FParent&&this.RaiseMsg(20170216151938,3041,rtl.getResStr(Ce,"sOnlyOneDefaultPropertyIsAllowed"),[],e),i.DefaultProperty=e),this.EmitTypeHints(e,e.VarType)}finally{Ot({get:function(){return R},set:function(e){R=e}})}},this.FinishArgument=function(e){var t=this;var s,i,r;e.Access in rtl.createSet(0,1,2,3,4)||this.RaiseMsg(20191018235644,3002,rtl.getResStr(Ce,"sNotYetImplemented"),Ye(18,Fe.AccessDescriptions[e.Access]),e),null!==e.ArgType&&this.CheckUseAsType(e.ArgType,20190123100049,e),null!==e.ValueExpr&&(this.ResolveExpr(e.ValueExpr,1),null!==e.ArgType&&(this.CheckAssignCompatibility(e,e.ValueExpr,!0,null),3 in this.FCurrentParser.GetCurrentModeSwitches()&&(null!==(s=e).ArgType&&we.isPrototypeOf(s.FParent)&&xe.isPrototypeOf(s.FParent.FParent)&&(i=s.FParent.FParent,null!==(r=t.GetProcTemplateTypes(i))&&function s(i,r,n){var l,a=null;if(null!==r)if((l=r.$class.ClassType())===je)n.IndexOf(r)>=0&&t.RaiseMsg(20191007213121,3141,rtl.getResStr(Ce,"sParamOfThisTypeCannotHaveDefVal"),[],e);else{if(r.FParent!==i)return;l===Ue&&s(a=r,a.ElType,n)}}(s,s.ArgType,r))))),this.EmitTypeHints(e,e.ArgType)},this.FinishAncestors=function(e){var t=this,s=null,i=null;function n(e,t){return nt(e.FName,t)&&st.isPrototypeOf(e.FParent)}function l(l,a){var o=null;if(i=null,nt(e.FName,l)){if(n(e,l))return;t.RaiseXExpectedButYFound(20190106132328,"top level "+l,"nested "+e.FName,e)}o=t.FindElementWithoutParams(l,e,!1,!0),De.isPrototypeOf(o)||t.RaiseXExpectedButYFound(20180321150128,a,r.GetElementTypeName(o),e),s=o,o=t.ResolveAliasType(s,!0),$e.isPrototypeOf(o)||t.RaiseXExpectedButYFound(20170216151941,a,r.GetElementTypeName(s),e),i=o}var a,o=null,h=null,u=null,c=null,p=0,f="",d="",F=!1,m=null,C=null,S=0,T=0,y=null,g=null,E=null,P=null,R=null,v=null,A=null;if(a=3 in this.FCurrentParser.GetCurrentModeSwitches(),e.IsForward){this.PopGenericParamScope(e),(A=e.FParent.$class.ClassType()).InheritsFrom(Xt)?v=e.FParent.Declarations:A===$e||A===Me?v=e.FParent.Members:this.RaiseNotYetImplemented(20180430141934,e,ye(e.FParent)),T=this.GetTypeParameterCount(e);for(var N=0,x=v.FCount-1;N<=x;N++)p=N,C=rtl.getObject(v.Get(p)),0===Pe(C.FName,e.FName)&&C!==e&&(ke.isPrototypeOf(C)&&this.GetTypeParameterCount(C)!==T||this.RaiseMsg(20180212144132,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,C.FName,18,this.GetElementSourcePosStr(C)),e));T>0&&this.CreateScope(e,this.FScopeClass_Class)}else{var b=e.ObjKind;if(1===b)u=this.ResolveAliasType(e.AncestorType,!0),$e.isPrototypeOf(u)&&2===u.ObjKind&&!a&&(e.Interfaces.Insert(0,e.AncestorType),e.AncestorType=null);else if(2===b)e.IsExternal&&this.RaiseMsg(20180321115831,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,"external"),e),e.InterfaceType in rtl.createSet(0,1)||this.RaiseMsg(20180321143613,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,this.FCurrentParser.FScanner.GetCurrentValueSwitch(0)),e);else if(3===b||4===b||5===b){e.IsExternal&&this.RaiseMsg(20190116192722,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,"external"),e),null===(E=this.ResolveAliasType(e.HelperForType,!0))&&this.RaiseNotYetImplemented(20191016125557,e,""),(e===E||e.HasParent(E))&&this.RaiseMsg(20190118190935,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,E.FName),e);var k=e.ObjKind;3===k?($e.isPrototypeOf(E)||this.RaiseXExpectedButYFound(20190116194751,"class type",this.GetTypeDescription(e.HelperForType,!1),e),1!==E.ObjKind&&this.RaiseXExpectedButYFound(20190116194855,"class type",this.GetTypeDescription(e.HelperForType,!1),e),E.IsForward&&this.RaiseMsg(20190116194931,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,E.FName),e)):4===k?a?E.$class.ClassType()===Me||E.$class.ClassType()===Ue||E.$class.ClassType()===lt||E.$class.ClassType()===Ge||E.$class.ClassType()===Je||E.$class.ClassType()===me&&Z.isPrototypeOf(E.FData)||this.RaiseMsg(20190116200304,3114,rtl.getResStr(Ce,"sTypeXCannotBeExtendedByARecordHelper"),Ye(18,this.GetTypeDescription(E,!1)),e):E.$class.ClassType()===Me||this.RaiseMsg(20190116200519,3114,rtl.getResStr(Ce,"sTypeXCannotBeExtendedByARecordHelper"),Ye(18,this.GetTypeDescription(E,!1)),e):5===k&&(E.$class.ClassType()===Me||E.$class.ClassType()===Ue||E.$class.ClassType()===lt||E.$class.ClassType()===Ge||E.$class.ClassType()===Je||E.$class.ClassType()===me&&Z.isPrototypeOf(E.FData)||(E.$class.ClassType()===$e&&E.ObjKind in rtl.createSet(1,2)?E.IsForward&&this.RaiseMsg(20190116200940,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,E.FName),e):this.RaiseMsg(20190116200304,3113,rtl.getResStr(Ce,"sTypeXCannotBeExtendedByATypeHelper"),Ye(18,this.GetTypeDescription(E,!1)),e)))}else this.RaiseNotYetImplemented(20161010174638,e,"Kind="+Fe.ObjKindNames[e.ObjKind]);F=!1;for(var $=0,D=e.Modifiers.GetCount()-1;$<=D;$++){p=$;f=Te(e.Modifiers.Get(p));"sealed"===f?F=!0:"abstract"===f||this.RaiseMsg(20170320190619,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,e.Modifiers.Get(p)),e)}if(i=null,s=e.AncestorType,null===(u=this.ResolveAliasType(s,!0))){null!==s&&this.RaiseInternalError(20180321151851,ye(s)),d="";var L=e.ObjKind;1===L?(d="TObject",e.IsExternal||n(e,d)?i=null:(l(d,"class type"),1!==i.ObjKind&&this.RaiseXExpectedButYFound(20180321145626,"class type",r.GetElementTypeName(i),e))):2===L&&0===e.InterfaceType&&(n(e,d=a?"IInterface":"IUnknown")?i=null:(l(d,"interface type"),2!==i.ObjKind&&this.RaiseXExpectedButYFound(20180321145725,"interface type",r.GetElementTypeName(i),e)))}else u.$class.ClassType()!==$e?this.RaiseXExpectedButYFound(20170216151944,"class type",this.GetTypeDescription(u,!1),e):e===u?this.RaiseMsg(20170525125854,3011,rtl.getResStr(Ce,"sAncestorCycleDetected"),[],e):((i=u).ObjKind!==e.ObjKind&&this.RaiseXExpectedButYFound(20180321152107,r.GetElementTypeName(e)+" type",r.GetElementTypeName(i)+" type",e),e.ObjKind in Fe.okAllHelpers&&(E=this.ResolveAliasType(e.HelperForType,!0),P=this.ResolveAliasType(i.HelperForType,!0),this.IsSameType(E,P,0)||$e.isPrototypeOf(E)&&$e.isPrototypeOf(P)&&2147483647!==this.CheckClassIsClass(E,P)||this.RaiseMsg(20190116203931,3115,rtl.getResStr(Ce,"sDerivedXMustExtendASubClassY"),Ye(18,r.GetElementTypeName(e),18,i.HelperForType.FName),e)),this.EmitTypeHints(e,i));if(h=null,null===i);else{i.IsForward&&this.RaiseMsg(20170216151947,3012,rtl.getResStr(Ce,"sCantUseForwardDeclarationAsAncestor"),Ye(18,i.FName),e),e.IsExternal&&!i.IsExternal&&this.RaiseMsg(20170321144035,3049,rtl.getResStr(Ce,"sAncestorIsNotExternal"),Ye(18,i.FName),e),1 in(h=rtl.as(i.FData,O)).Flags&&this.RaiseMsg(20170320191735,3048,rtl.getResStr(Ce,"sCannotCreateADescendantOfTheSealedXY"),Ye(18,r.GetElementTypeName(i),18,i.FName),e),c=i;do{c===e&&this.RaiseMsg(20170216151949,3011,rtl.getResStr(Ce,"sAncestorCycleDetected"),[],e),c.$class.ClassType()===qt||c.$class.ClassType()===Qt||c.$class.ClassType()===Kt?c=c.DestType:c.$class.ClassType()===$e?c=c.AncestorType:this.RaiseNotYetImplemented(20190825195203,e,ye(c))}while(null!==c);e.RTTIVisibility.Explicit||(e.RTTIVisibility.Fields=rtl.unionSet(i.RTTIVisibility.Fields,e.RTTIVisibility.Fields),e.RTTIVisibility.Methods=rtl.unionSet(i.RTTIVisibility.Methods,e.RTTIVisibility.Methods),e.RTTIVisibility.Properties=rtl.unionSet(i.RTTIVisibility.Properties,e.RTTIVisibility.Properties))}if(I.isPrototypeOf(this.FTopScope)&&this.PopGenericParamScope(e),null===e.FData?o=this.CreateScope(e,this.FScopeClass_Class):0 in(o=rtl.as(e.FData,O)).Flags&&this.RaiseNotYetImplemented(20190803203715,e,""),o.Flags=rtl.includeSet(o.Flags,0),F&&(o.Flags=rtl.includeSet(o.Flags,1)),this.AddGenericTemplateIdentifiers(e.GenericTemplateTypes,o),o.DirectAncestor=s,null!==i&&(o.AncestorScope=h,o.DefaultProperty=h.DefaultProperty,2 in h.Flags&&(o.Flags=rtl.includeSet(o.Flags,2)),o.AbstractProcs=rtl.arrayCopy(0,h.AbstractProcs,0)),11 in this.FCurrentParser.FScanner.FCurrentBoolSwitches&&(o.Flags=rtl.includeSet(o.Flags,2)),e.ObjKind in rtl.unionSet(rtl.createSet(1),Fe.okAllHelpers)&&(m=this.CreateOwnedElement(Le,"Self",e),o.CanonicalClassOf=m,m.DestType=e,m.Visibility=6,m.SourceFilename=e.SourceFilename,m.SourceLinenumber=e.SourceLinenumber),this.PushGroupScope(e).VisibilityContext=e,e.Interfaces.FCount>0){e.ObjKind in rtl.createSet(1)||this.RaiseXExpectedButYFound(20180322001341,"one ancestor",Ae(1+e.Interfaces.FCount),e),e.IsExternal&&this.RaiseMsg(20180324183641,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(18,"external"),e),R=ge.$create("Create");try{for(var B=0,M=e.Interfaces.FCount-1;B<=M;B++)p=B,y=rtl.getObject(e.Interfaces.Get(p)),null===(g=this.ResolveAliasType(y,!0))&&this.RaiseMsg(20180322140044,3012,rtl.getResStr(Ce,"sCantUseForwardDeclarationAsAncestor"),Ye(18,y.FName),e),$e.isPrototypeOf(g)||this.RaiseXExpectedButYFound(20180322001051,"interface type",r.GetElementTypeName(g)+" type",e),2!==g.ObjKind&&this.RaiseXExpectedButYFound(20180322001143,"interface type",r.GetElementTypeName(g)+" type",e),(S=R.IndexOf(g))>=0&&this.RaiseMsg(20180322001505,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,y.FName,18,Ae(S+1)),e),R.Add(g)}finally{R=rtl.freeLoc(R)}o.Interfaces=ge.$create("Create"),o.Interfaces.SetCount(e.Interfaces.FCount)}}},this.FinishMethodResolution=function(e){var t,s,i,n,l=q.$new(),a=null,o=null,h=null,u=null;for(this.ResolveExpr(e.InterfaceName,1),this.ComputeElement(e.InterfaceName,l,rtl.createSet(4,1),null),De.isPrototypeOf(l.IdentEl)||this.RaiseXExpectedButYFound(20180323132601,"interface type",this.GetResolverResultDescription(l,!1),e.InterfaceName),a=rtl.as(e.FParent,$e),(s=this.IndexOfImplementedInterface(a,l.IdentEl))<0&&this.RaiseXExpectedButYFound(20180323133055,"interface type",this.GetResolverResultDescription(l,!1),e.InterfaceName),t=this.ResolveAliasType(rtl.getObject(a.Interfaces.Get(s)),!0),i=e.InterfaceProc,Dt.isPrototypeOf(i)||this.RaiseXExpectedButYFound(20180327152808,"method name",r.GetElementTypeName(i),i),0!==i.Kind&&this.RaiseXExpectedButYFound(20180327152841,"method name",r.GetElementTypeName(i),i),n=i.Value,h=rtl.as(t.FData,O),o=null;null!==h;){for(u=h.FindLocalIdentifier(n);null!==u&&(xe.isPrototypeOf(u.FElement)||this.RaiseXExpectedButYFound(20180327153110,"interface method",r.GetElementTypeName(u.FElement),i),(o=u.FElement).$class.ClassType()!==e.ProcClass);)u=u.NextSameIdentifier;h=h.AncestorScope}null===o&&this.RaiseIdentifierNotFound(20180327153044,n,i),this.CreateReference(o,i,1,null),o.$class.ClassType()!==e.ProcClass&&this.RaiseXExpectedButYFound(20180323144107,r.GetElementTypeName$1(e.ProcClass),r.GetElementTypeName(o),e.InterfaceProc)},this.FinishAttributes=function(e){var t,s=0,i=0,n=null,l=null,a=null,o=q.$new(),h=q.$new(),u=null,c=null,p="",f=te.$new(),d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=[];t=We.isPrototypeOf(e.FParent);for(var E=0,P=rtl.length(e.Calls)-1;E<=P;E++)if(s=E,n=e.Calls[s],!t||0!==n.Kind||!nt(n.Value,"ref")||4!==e.FParent.Access)if(Mt.isPrototypeOf(n)&&(n=n.Value),y=null,Bt.isPrototypeOf(n)&&(a=n,this.ResolveExpr(a.Left,1),this.ComputeElement(a.Left,o,rtl.createSet(4,0),null),3===o.BaseType?(u=rtl.as(r.NoNil(o.IdentEl),Ie),y=this.PushModuleDotScope(u)):2===o.BaseType&&De.isPrototypeOf(o.IdentEl)&&ze.isPrototypeOf(o.LoTypeEl)?(c=o.LoTypeEl).$class.ClassType()===$e?(y=this.PushClassDotScope({get:function(){return c},set:function(e){c=e}},!0)).OnlyTypeMembers=!0:c.$class.ClassType()===Me?(y=this.PushRecordDotScope(c)).OnlyTypeMembers=!0:this.RaiseNotYetImplemented(20190221124930,a,""):this.RaiseMsg(20190221102049,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"module or type",18,this.GetResolverResultDescription(o,!0)),n),n=a.Right),this.IsNameExpr(n)||this.RaiseMsg(20190221125204,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"identifier",18,r.GetElementTypeName(a)),n),p=n.Value,d=null,nt(as(p,9),"Attribute")||(d=this.FindFirstEl(p+"Attribute",f,n)),null===d&&(d=this.FindFirstEl(p,f,n)),null!==y&&this.PopScope(),null!==d){if(this.IsCustomAttribute(d)||this.RaiseMsg(20190221130400,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,r.GetElementTypeName(d),18,"TCustomAttribute"),n),m=d,T=this.CreateReference(m,n,1,null),m.IsAbstract()&&this.LogMsg(20190223194424,2,3122,rtl.getResStr(Ce,"sAttributeIgnoredBecauseAbstractX"),Ye(18,"class"),n),(y=this.PushClassDotScope({get:function(){return m},set:function(e){m=e}},!0)).OnlyTypeMembers=!0,l=e.Calls[s],Mt.isPrototypeOf(l)){10!==l.Kind&&this.RaiseMsg(20190223195605,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(9,"(",9,"["),l),this.ResolveParamsExprParams(l),this.ResolveFuncParamsExprName(l,null,l,1,"Create"),g=l.Params;for(var I=0,R=rtl.length(g)-1;I<=R;I++)i=I,this.ComputeElement(g[i],h,rtl.createSet(3),null);(F=rtl.as(l.FData,_).FDeclaration).$class.ClassType()!==_e&&this.RaiseXExpectedButYFound(20190221150212,"constructor Create",r.GetElementTypeName(F),n),C=F}else null===(F=this.FindElementWithoutParams$1("Create",f,n,!1,!0))&&this.RaiseIdentifierNotFound(20190221144516,"Create",n),F.$class.ClassType()!==_e&&this.RaiseXExpectedButYFound(20190221145003,"constructor Create",r.GetElementTypeName(F),n),(S=(C=F).ProcType.Args).FCount>0&&null===rtl.getObject(S.Get(0)).ValueExpr&&this.RaiseMsg(20190221145407,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,C.FName),l);C.IsAbstract()&&this.LogMsg(20190223193645,2,3122,rtl.getResStr(Ce,"sAttributeIgnoredBecauseAbstractX"),Ye(18,"mrthod"),n),null!==T.Context&&this.RaiseNotYetImplemented(20190221164717,n,ye(T.Context)),T.Context=X.$create("Create"),T.Context.Proc=C,this.PopScope()}else this.LogMsg(20190221144613,2,3121,rtl.getResStr(Ce,"sUnknownCustomAttributeX"),Ye(18,p),n)},this.FinishExportSymbol=function(e){var t=this;function s(e,s,i){var r=null,n=q.$new();null!==e&&(t.ResolveExpr(e,1),null!==(r=t.Eval(e,rtl.createSet(0),!0))&&r.Kind in s?Ot({get:function(){return r},set:function(e){r=e}}):(Ot({get:function(){return r},set:function(e){r=e}}),t.ComputeElement(e,n,rtl.createSet(3),null),t.RaiseXExpectedButYFound(20210101194628,i,t.GetTypeDescription$1(n,!1),e)))}var i,n=null,l=null,a=te.$new(),o=null,h=q.$new(),u=null;null!==(i=e.NameExpr)?(this.ResolveExpr(i,1),this.ComputeElement(i,h,rtl.createSet(3),null),null===(n=h.IdentEl)&&this.RaiseMsg(20210103012907,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"symbol",18,this.GetTypeDescription$1(h,!1)),i),null===n.FParent&&this.RaiseMsg(20220206142147,3145,rtl.getResStr(Ce,"sSymbolCannotBeExportedFromALibrary"),[],e),st.isPrototypeOf(n.FParent)||ze.isPrototypeOf(n.FParent)&&xe.isPrototypeOf(n)&&n.IsStatic()||this.RaiseMsg(20210103012908,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"global symbol",18,r.GetElementTypeName(n)),i)):(this.FindFirstEl(e.FName,a,e),null===(n=a.Found)&&this.RaiseMsg(20210103002747,3001,rtl.getResStr(Ce,"sIdentifierNotFound"),Ye(18,e.FName),e),st.isPrototypeOf(n.FParent)||this.RaiseMsg(20210103003244,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"global symbol",18,at(n)),e),o=this.CreateReference(n,e,1,a),this.CheckFoundElement(a,o)),C.isPrototypeOf(n.FParent.FData)&&(null===(u=rtl.as(n.FParent.FData,C).FindLocalIdentifier(n.FName))&&this.RaiseNotYetImplemented(20210106103001,e,at(n)),null!==u.NextSameIdentifier&&(xe.isPrototypeOf(n)?this.RaiseMsg(20210106103320,3013,rtl.getResStr(Ce,"sCantDetermineWhichOverloadedFunctionToCall"),[],e):(l=u.FElement===n?u.NextSameIdentifier.FElement:u.FElement,this.RaiseMsg(20220206141619,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,l.FName,18,this.GetElementSourcePosStr(l)),e)))),s(e.ExportIndex,rtl.createSet(4,5),"integer"),s(e.ExportName,Ce.revkAllStrings,"string")},this.FinishProcParamAccess=function(e,t){var s,i=0,r=0,n=null;s=t.Params,n=e.Args;for(var l=0,a=rtl.length(s)-1;l<=a;l++){if(i=1,(r=l)<n.FCount){var o=rtl.getObject(n.Get(r)).Access;2===o?i=4:3===o&&(i=5)}this.AccessExpr(s[r],i)}this.CheckCallProcCompatibility(e,t,!1,!0)},this.FinishPropertyParamAccess=function(e,t){for(var s=0,i=0,r=0,n=rtl.length(e.Params)-1;r<=n;r++){if(i=1,(s=r)<t.FArgs.FCount){var l=rtl.getObject(t.FArgs.Get(s)).Access;2===l?i=4:3===l&&(i=5)}this.FinishCallArgAccess(e.Params[s],i)}},this.FinishCallArgAccess=function(e,t){var s=q.$new(),i={};this.AccessExpr(e,t),i=rtl.createSet(0),1!==t&&(i=rtl.includeSet(i,1)),this.ComputeElement(e,s,rtl.refSet(i),null)},this.FinishInitialFinalization=function(e){this.CheckTopScope(this.FScopeClass_InitialFinalization,!1),this.PopScope()},this.EmitTypeHints=function(e,t){for(;null!==t;){if(this.EmitElementHints(e,t))return;if(t.$class.InheritsFrom(qt))t=t.DestType;else if(t.$class.ClassType()===Be)t=t.DestType;else{if(t.$class.ClassType()!==$e||!t.IsForward||!_.isPrototypeOf(t.FData))return;t=t.FData.FDeclaration}}},this.EmitElementHints=function(e,t){return this.IsElementSkipped(t)&&this.RaiseNotYetImplemented(20170927160030,e,ye(t)),!rtl.eqSet(t.FHints,{})&&(0 in t.FHints&&(""!==t.FHintMessage?this.LogMsg(20170422160807,2,5066,rtl.getResStr(Ce,"sSymbolXIsDeprecatedY"),Ye(18,t.FName,18,t.FHintMessage),e):this.LogMsg(20170419190434,2,5043,rtl.getResStr(Ce,"sSymbolXIsDeprecated"),Ye(18,t.FName),e)),1 in t.FHints&&this.LogMsg(20170419190426,2,5065,rtl.getResStr(Ce,"sSymbolXBelongsToALibrary"),Ye(18,t.FName),e),2 in t.FHints&&this.LogMsg(20170419185916,2,5076,rtl.getResStr(Ce,"sSymbolXIsNotPortable"),Ye(18,t.FName),e),3 in t.FHints&&this.LogMsg(20170419190111,2,5079,rtl.getResStr(Ce,"sSymbolXIsExperimental"),Ye(18,t.FName),e),4 in t.FHints&&this.LogMsg(20170419190317,2,5078,rtl.getResStr(Ce,"sSymbolXIsNotImplemented"),Ye(18,t.FName),e),true)},this.StoreScannerFlagsInProc=function(e){var t=null;1 in e.Flags||(e.BoolSwitches=rtl.refSet(this.FCurrentParser.FScanner.FCurrentBoolSwitches),15 in e.BoolSwitches&&((t=rtl.as(this.FRootElement.FData,F)).Flags=rtl.includeSet(t.Flags,1)))},this.ReplaceProcScopeImplArgsWithDeclArgs=function(e){var t,s,i=null,n=null,l=null,a=null,o=0,h=0,u=null,c=null,p=null,f=null,d=null,F=null,m=null;if(s=rtl.as(e.FElement,xe),t=e.DeclarationProc,null!==(f=s.NameParts)){for(var C=0,S=f.FCount-2;C<=S;C++)if(o=C,null!==(l=rtl.getObject(f.Get(o)).Templates))for(var T=0,y=l.FCount-1;T<=y;T++)h=T,d=rtl.getObject(l.Get(h)),e.RemoveLocalIdentifier(d);if(l=this.GetProcTemplateTypes(s),a=this.GetProcTemplateTypes(t),null!==l){null!==a&&l.FCount===a.FCount||this.RaiseNotYetImplemented(20190912153602,s,"");for(var g=0,E=l.FCount-1;g<=E;g++)o=g,F=rtl.getObject(a.Get(o)),d=rtl.getObject(l.Get(o)),(p=e.FindLocalIdentifier(d.FName)).FElement!==d&&this.RaiseInternalError(20190912154009,ye(F)+" "+ye(d)),p.SetElement(F),p.Identifier=F.FName}else null!==a&&this.RaiseNotYetImplemented(20190912153439,s,"")}n=s.ProcType.Args;for(var P=0,I=(i=t.ProcType.Args).FCount-1;P<=I;P++)o=P,u=rtl.getObject(i.Get(o)),o<n.FCount?(c=rtl.getObject(n.Get(o)),(p=e.FindLocalIdentifier(u.FName)).FElement!==c&&this.RaiseInternalError(20170203161659,ye(u)+" "+ye(c)),p.SetElement(u),p.Identifier=u.FName):this.AddIdentifier(e,u.FName,u,3);Ve.isPrototypeOf(t.ProcType)&&null!==(m=t.ProcType).ResultEl&&(null===(p=e.FindLocalIdentifier(r.ResolverResultVar))?this.AddIdentifier(e,r.ResolverResultVar,m.ResultEl,3):$t.isPrototypeOf(p.FElement)&&p.SetElement(m.ResultEl))},this.CreateClassIntfMap=function(e,t){var s=null,i=null,n=null,l=null;for(null!=(l=rtl.as(e.FData,O)).Interfaces.Get(t)&&this.RaiseInternalError(20180322141916,r.GetElementDbgPath(e)+" "+Ae(t)+" "+ye(rtl.getObject(l.Interfaces.Get(t)))),i=this.ResolveAliasType(rtl.getObject(e.Interfaces.Get(t)),!0),n=null;null!==i;)null===n?((n=b.$create("Create")).Element=e,s=n,l.Interfaces.Put(t,n)):(n.AncestorMap=b.$create("Create"),(n=n.AncestorMap).Element=e),n.Intf=i,n.Procs=ge.$create("Create"),n.Procs.SetCount(i.Members.FCount),i=rtl.as(this.GetPasClassAncestor(i,!0),$e);return s},this.CheckConditionExpr=function(e,t){15!==t.BaseType&&(this.IsGenericTemplType(t)||this.RaiseXExpectedButYFound(20170216152135,this.GetBaseTypeNames(15),this.GetBaseTypeNames(t.BaseType),e))},this.CheckProcSignatureMatch=function(e,t,s){var i,r,n=0,l=null,a=null,o=null,h=null,u="",c="",p=null,f=null,d=null,F=null,m={},C=0,S={},T=0;if(t.$class.ClassType()!==e.$class.ClassType()&&this.RaiseXExpectedButYFound(20170216151729,e.TypeName(),t.TypeName(),t),l=e.ProcType.Args,a=t.ProcType.Args,l.FCount!==a.FCount&&this.RaiseNotYetImplemented(20190912110642,t,""),i=rtl.refSet(e.ProcType.Modifiers),r=rtl.refSet(t.ProcType.Modifiers),h=this.GetProcTemplateTypes(e),o=this.GetProcTemplateTypes(t),null!==h){s&&this.RaiseNotYetImplemented(20190912113857,t,""),null===o&&this.RaiseMsg(20190912144529,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetProcName(t,!0),18,this.GetElementSourcePosStr(e)),t),o.FCount!==h.FCount&&this.RaiseMsg(20190912145320,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetProcName(t,!0),18,this.GetElementSourcePosStr(rtl.getObject(h.Get(0)))),t);for(var y=0,g=h.FCount-1;y<=g;y++)n=y,F=rtl.getObject(h.Get(n)),d=rtl.getObject(o.Get(n)),nt(F.FName,d.FName)||this.RaiseMsg(20190912150311,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetProcName(t,!0),18,this.GetElementSourcePosStr(F)),d),rtl.length(d.Constraints)>0&&this.RaiseMsg(20190912150739,3138,rtl.getResStr(Ce,"sImplMustNotRepeatConstraints"),[],d)}else null!==o&&this.RaiseMsg(20190912113857,3132,rtl.getResStr(Ce,"sDeclOfXDiffersFromPrevAtY"),Ye(18,this.GetProcName(t,!0),18,this.GetElementSourcePosStr(e)),t);if(!s)for(var E=0,P=l.FCount-1;E<=P;E++)n=E,u=rtl.getObject(l.Get(n)).FName,c=rtl.getObject(a.Get(n)).FName,0!==Pe(u,c)&&this.RaiseMsg(20170216151738,3020,rtl.getResStr(Ce,"sFunctionHeaderMismatchForwardVarName"),Ye(18,e.FName,18,u,18,c),t);if(Ve.isPrototypeOf(t.ProcType)&&(p=t.ProcType.ResultEl.ResultType,f=e.ProcType.ResultEl.ResultType,this.CheckElTypeCompatibility(p,f,1)>1&&this.RaiseIncompatibleType(20170216151734,3019,[],f,p,t)),t.GetCallingConvention()!==e.GetCallingConvention()&&this.RaiseMsg(20170216151731,3018,rtl.getResStr(Ce,"sCallingConventionMismatch"),[],t),s)for(var I in m=rtl.symDiffSet(r,i))C=+I,this.RaiseMsg(20201227213020,3052,rtl.getResStr(Ce,"sXModifierMismatchY"),Ye(18,"procedure type",18,Fe.ProcTypeModifiers[C]),t.ProcType);else{if(S=rtl.diffSet(rtl.diffSet(t.FModifiers,e.FModifiers),rtl.createSet(9)),rtl.neSet(S,{}))for(var R in S)T=+R,this.RaiseMsg(20200518182445,3143,rtl.getResStr(Ce,"sDirectiveXNotAllowedHere"),Ye(18,Fe.ModifierNames[T]),t.ProcType);if(m=rtl.diffSet(r,i),rtl.neSet(m,{}))for(var v in m)C=+v,this.RaiseMsg(20200425154821,3143,rtl.getResStr(Ce,"sDirectiveXNotAllowedHere"),Ye(18,Fe.ProcTypeModifiers[C]),t.ProcType)}},this.CheckPointerCycle=function(e){var t=null,s=null,i=null;for(s=e;null!==s;){if((t=s.$class.ClassType())===Be)i=s.DestType;else{if(!t.InheritsFrom(qt))return;i=s.DestType}i===e&&this.RaiseMsg(20180422165758,3106,rtl.getResStr(Ce,"sTypeCycleFound"),[],e),s=i}},this.CheckGenericTemplateTypes=function(e){var t=null,s=0,i=null;null!==(t=e.GenericTemplateTypes)&&0!==t.FCount||this.RaiseNotYetImplemented(20190726184902,e,"empty generic template list");for(var r=0,n=t.FCount-1;r<=n;r++)s=r,i=rtl.getObject(t.Get(s)),nt(i.FName,e.FName)&&this.RaiseMsg(20190801101444,3009,rtl.getResStr(Ce,"sDuplicateIdentifier"),Ye(18,i.FName,18,this.GetElementSourcePosStr(e)),i)},this.ComputeUnaryNot=function(e,t,s){this.RaiseMsg(20180208121532,3085,rtl.getResStr(Ce,"sIllegalQualifierInFrontOf"),Ye(18,Fe.OpcodeStrings[e.OpCode],18,this.GetResolverResultDescription(t,!1)),e),rtl.eqSet(s,{})},this.ComputeBinaryExpr=function(e,t,s,i){var n=q.$new(),l=q.$new(),a=null,o=null;if(27===e.OpCode||0===e.OpCode&&Vt.isPrototypeOf(e.Left))this.ComputeElement(e.Right,t,rtl.refSet(s),i);else{if(e.OpCode in rtl.createSet(14,15))return 2147483647===this.CheckEqualElCompatibility(e.Left,e.Right,null,!0,0 in s)&&this.RaiseInternalError(20161007215912,""),void r.SetResolverValueExpr(t,15,this.FBaseTypes[15],this.FBaseTypes[15],e,rtl.createSet(0));if(s=rtl.diffSet(s,rtl.createSet(1,2)),1===e.OpCode){for(a=e.Left;a.$class.ClassType()===Bt&&1===(o=a).OpCode;)a=o.Left;this.ComputeElement(a,n,rtl.refSet(s),i);do{o=a.FParent,this.ComputeElement(o.Right,l,rtl.refSet(s),i),this.ComputeBinaryExprRes(o,t,rtl.refSet(s),n,l),n.$assign(t),a=o}while(a!==e)}else this.ComputeElement(e.Left,n,rtl.refSet(s),i),this.ComputeElement(e.Right,l,rtl.refSet(s),i),this.ComputeBinaryExprRes(e,t,rtl.refSet(s),n,l)}},this.ComputeBinaryExprRes=function(e,t,s,i,n){var l=this;function a(s){r.SetResolverValueExpr(t,s,l.FBaseTypes[s],l.FBaseTypes[s],e,rtl.createSet(0))}function o(s){r.SetResolverValueExpr(t,i.BaseType,i.LoTypeEl,i.HiTypeEl,e,rtl.refSet(s))}function h(s){r.SetResolverValueExpr(t,n.BaseType,n.LoTypeEl,n.HiTypeEl,e,rtl.refSet(s))}var u=q.$new(),c=null,p=null;if(37===i.BaseType&&this.ConvertRangeToElement(i),37===n.BaseType&&this.ConvertRangeToElement(n),this.IsGenericTemplType(i)||this.IsGenericTemplType(n)){var f=e.OpCode;return 14===f||15===f||16===f||17===f||18===f||19===f||20===f||21===f?void a(15):22===f?void h(rtl.createSet(0)):(t.$assign(i),void(t.Flags=rtl.diffSet(t.Flags,rtl.createSet(1))))}if(i.BaseType in r.btAllInteger){if(0 in i.Flags&&0 in n.Flags)if(n.BaseType in rtl.unionSet(r.btAllInteger,r.btAllFloats)){var d=e.OpCode;if(0===d){if(7===e.Kind)return n.BaseType in r.btAllInteger||this.RaiseXExpectedButYFound(20170216152600,"integer",this.GetBaseTypeNames(n.BaseType),e.Right),o(rtl.createSet(0)),void(Je.isPrototypeOf(e.FParent)&&(t.LoTypeEl=e.FParent,t.HiTypeEl=t.LoTypeEl))}else{if(1===d||2===d||3===d||5===d||6===d||7===d||9===d||8===d||11===d||12===d||13===d)return void(n.BaseType in r.btAllFloats?h(rtl.createSet(0)):o(rtl.createSet(0)));if(16===d||17===d||18===d||19===d)return void a(15);if(4===d)return void a(this.FBaseTypeExtended)}}else if(n.BaseType in rtl.createSet(34,36)){if(20===e.OpCode&&n.SubType in r.btAllInteger)return void a(15)}else if(29===n.BaseType){if(e.OpCode in rtl.createSet(1,2)&&this.ElHasBoolSwitch(e,28))return void r.SetResolverValueExpr(t,29,n.LoTypeEl,n.HiTypeEl,e,rtl.createSet(0))}else if(2===n.BaseType&&(p=n.LoTypeEl).$class.ClassType()===Be&&e.OpCode in rtl.createSet(1,2)&&this.ElHasBoolSwitch(e,28))return p=p.DestType,void r.SetResolverValueExpr(t,29,this.ResolveAliasType(p,!0),p,e,rtl.createSet(0))}else if(i.BaseType in r.btAllBooleans){if(0 in i.Flags&&n.BaseType in r.btAllBooleans&&0 in n.Flags){var F=e.OpCode;if(0===F){if(7===e.Kind)return r.SetResolverValueExpr(t,37,this.FBaseTypes[i.BaseType],this.FBaseTypes[i.BaseType],e,rtl.createSet(0)),void(t.SubType=i.BaseType)}else if(11===F||12===F||13===F)return void o(rtl.createSet(0))}}else if(i.BaseType in r.btAllStringAndChars){if(0 in i.Flags&&0 in n.Flags)if(n.BaseType in r.btAllStringAndChars){var m=e.OpCode;if(0===m){if(7===e.Kind&&i.BaseType in r.btAllChars)return n.BaseType in r.btAllChars||this.RaiseXExpectedButYFound(20170216152603,"char",this.GetBaseTypeNames(n.BaseType),e.Right),r.SetResolverValueExpr(t,37,this.FBaseTypes[i.BaseType],this.FBaseTypes[i.BaseType],e,rtl.createSet(0)),void(t.SubType=i.BaseType)}else if(1===m){if(n.BaseType in r.btAllStringAndChars&&this.ComputeAddStringRes(i,n,e,t))return}else if(16===m||17===m||18===m||19===m)return void a(15)}else if(n.BaseType in rtl.createSet(34,36)&&n.SubType in r.btAllChars&&i.BaseType in r.btAllChars){if(20===e.OpCode)return void a(15)}}else if(i.BaseType in r.btAllFloats){if(0 in i.Flags&&n.BaseType in rtl.unionSet(r.btAllInteger,r.btAllFloats)&&0 in n.Flags){var C=e.OpCode;if(1===C||2===C||3===C||4===C||6===C||7===C)return void(14===n.BaseType||n.BaseType in r.btAllFloats&&n.BaseType>i.BaseType?h(rtl.createSet(0)):o(rtl.createSet(0)));if(16===C||17===C||18===C||19===C)return void a(15)}}else if(29===i.BaseType){if(0 in i.Flags&&0 in n.Flags)if(n.BaseType in r.btAllInteger){var S=e.OpCode;if((1===S||2===S)&&this.ElHasBoolSwitch(e,28))return void r.SetResolverValueExpr(t,29,i.LoTypeEl,i.HiTypeEl,e,rtl.createSet(0))}else if(29===n.BaseType){var T=e.OpCode;if(16===T||17===T||18===T||19===T)return void a(15)}}else if(2===i.BaseType){c=i.LoTypeEl;var y=e.OpCode;if(0===y){if(7===e.Kind&&0 in i.Flags&&0 in n.Flags)return this.CheckSetLitElCompatible(e.Left,e.Right,i,n),t.$assign(i),t.IdentEl=null,t.SubType=t.BaseType,t.BaseType=37,void(t.ExprEl=e)}else if(20===y){if(0 in i.Flags&&0 in n.Flags){if(i.BaseType in r.btArrayRangeTypes)return n.BaseType in rtl.createSet(34,36)||this.RaiseXExpectedButYFound(20170216152607,"set of "+this.GetBaseTypeNames(i.BaseType),r.GetElementTypeName(i.LoTypeEl),e.Right),i.BaseType in r.btAllBooleans?n.SubType in r.btAllBooleans||this.RaiseXExpectedButYFound(20170216152610,"set of "+this.GetBaseTypeNames(i.BaseType),"set of "+this.GetBaseTypeNames(n.SubType),e.Right):i.BaseType in r.btAllChars?n.SubType in r.btAllChars||this.RaiseXExpectedButYFound(20170216152609,"set of "+this.GetBaseTypeNames(i.BaseType),"set of "+this.GetBaseTypeNames(n.SubType),e.Right):n.SubType in r.btAllInteger||this.RaiseXExpectedButYFound(20170216152612,"set of "+this.GetBaseTypeNames(i.BaseType),"set of "+this.GetBaseTypeNames(n.SubType),e.Right),void a(15);if(2===i.BaseType&&c.$class.ClassType()===Ge)return n.BaseType in rtl.createSet(34,36)||this.RaiseXExpectedButYFound(20170216152615,"set of "+i.LoTypeEl.FName,r.GetElementTypeName(i.LoTypeEl),e.Right),c===(p=n.LoTypeEl)||(n.LoTypeEl.$class.ClassType()===Je?(this.ComputeElement(p.RangeExpr.Left,u,rtl.createSet(3),null),c!==u.LoTypeEl&&this.RaiseXExpectedButYFound(20171109215833,"set of "+i.LoTypeEl.FName,"set of "+n.LoTypeEl.FName,e.Right)):this.RaiseXExpectedButYFound(20170216152618,"set of "+i.LoTypeEl.FName,"set of "+n.LoTypeEl.FName,e.Right)),void a(15);this.RaiseMsg(20170216152228,3033,rtl.getResStr(Ce,"sInOperatorExpectsSetElementButGot"),Ye(18,r.GetElementTypeName(i.LoTypeEl)),e)}}else if(21===y)if(p=n.LoTypeEl,$e.isPrototypeOf(c))if(0 in i.Flags||this.RaiseIncompatibleTypeRes(20180204124637,3082,Ye(18,Fe.OpcodeStrings[e.OpCode]),i,n,e),De.isPrototypeOf(i.IdentEl)&&this.RaiseIncompatibleTypeRes(20180204124638,3082,Ye(18,Fe.OpcodeStrings[e.OpCode]),i,n,e),De.isPrototypeOf(n.IdentEl)&&$e.isPrototypeOf(p)){if(c.ObjKind===p.ObjKind){if(2147483647!==this.CheckSrcIsADstType(n,i))return void a(15);if(2147483647!==this.CheckSrcIsADstType(i,n))return void a(15)}else if(2===p.ObjKind){if(1===c.ObjKind&&!c.IsExternal)return void a(15)}else if(2===c.ObjKind&&1===p.ObjKind&&!p.IsExternal)return void a(15)}else if(Le.isPrototypeOf(p)&&0 in n.Flags){if(2147483647!==this.CheckClassesAreRelated(i.LoTypeEl,p.DestType))return void a(15)}else this.RaiseXExpectedButYFound(20170216152625,"class type",r.GetElementTypeName(n.LoTypeEl),e.Right);else if(3 in this.FOptions&&Le.isPrototypeOf(c)&&0 in i.Flags)if((null===i.IdentEl||De.isPrototypeOf(i.IdentEl))&&this.RaiseIncompatibleTypeRes(20180204124657,3082,Ye(18,Fe.OpcodeStrings[e.OpCode]),i,n,e),c=this.ResolveAliasType(c.DestType,!0),De.isPrototypeOf(n.IdentEl)&&$e.isPrototypeOf(this.ResolveAliasType(n.IdentEl,!0))){if(2147483647!==this.CheckClassIsClass(n.LoTypeEl,c))return void a(15)}else if(Le.isPrototypeOf(p)){if(p=this.ResolveAliasType(p.DestType,!0),2147483647!==this.CheckClassesAreRelated(c,p))return void a(15)}else this.RaiseXExpectedButYFound(20170322105252,"class type",r.GetElementTypeName(n.LoTypeEl),e.Right);else null===i.LoTypeEl?this.RaiseMsg(20170216152232,3037,rtl.getResStr(Ce,"sLeftSideOfIsOperatorExpectsAClassButGot"),Ye(18,this.GetBaseTypeNames(i.BaseType)),e.Left):this.RaiseMsg(20170216152234,3037,rtl.getResStr(Ce,"sLeftSideOfIsOperatorExpectsAClassButGot"),Ye(18,r.GetElementTypeName(i.LoTypeEl)),e.Left);else if(22===y){if(c.$class.ClassType()===$e){if(!De.isPrototypeOf(i.IdentEl)&&0 in i.Flags||this.RaiseIncompatibleTypeRes(20180204124711,3082,Ye(18,Fe.OpcodeStrings[e.OpCode]),i,n,e),null===n.IdentEl&&this.RaiseXExpectedButYFound(20170216152630,"class",r.GetElementTypeName(n.LoTypeEl),e.Right),De.isPrototypeOf(n.IdentEl)||this.RaiseXExpectedButYFound(20170216152632,"class",n.IdentEl.FName,e.Right),2!==n.BaseType&&this.RaiseXExpectedButYFound(20180426195816,"class",n.IdentEl.FName,e.Right),p=n.LoTypeEl,$e.isPrototypeOf(p))if(c.ObjKind===p.ObjKind){if(2147483647!==this.CheckSrcIsADstType(n,i))return void h(rtl.createSet(0))}else if(2===c.ObjKind){if(1===p.ObjKind&&!p.IsExternal)return void h(rtl.createSet(0))}else if(2===p.ObjKind&&1===c.ObjKind&&!c.IsExternal)return void h(rtl.createSet(0));this.RaiseIncompatibleTypeRes(20180324190713,3029,[],i,n,e)}else if(c.$class.ClassType()===je){if(!De.isPrototypeOf(i.IdentEl)&&0 in i.Flags||this.RaiseIncompatibleTypeRes(20190908191127,3082,Ye(18,Fe.OpcodeStrings[e.OpCode]),i,n,e),null===n.IdentEl&&this.RaiseXExpectedButYFound(20190908191202,"class",r.GetElementTypeName(n.LoTypeEl),e.Right),De.isPrototypeOf(n.IdentEl)||this.RaiseXExpectedButYFound(20190908191204,"class",n.IdentEl.FName,e.Right),2!==n.BaseType&&this.RaiseXExpectedButYFound(20190908191206,"class",n.IdentEl.FName,e.Right),p=n.LoTypeEl,$e.isPrototypeOf(p))return void h(rtl.createSet(0));this.RaiseIncompatibleTypeRes(20190908192345,3029,[],i,n,e)}}else if(16===y||17===y||18===y||19===y){if(0 in i.Flags&&0 in n.Flags){if(p=n.LoTypeEl,c.$class.ClassType()===Ge&&c===p)return void a(15);if(c.$class.ClassType()===Be&&n.BaseType in r.btAllInteger)return void a(15)}}else{if(27===y)return void t.$assign(n);if((1===y||2===y)&&0 in i.Flags&&0 in n.Flags)if(c.$class.ClassType()===Ue){if(this.IsDynArray(c,!0)&&1===e.OpCode&&this.ElHasModeSwitch(e,44)&&(n.BaseType in rtl.createSet(36,35)||this.IsDynArray(n.LoTypeEl,!0)))return this.CheckAssignCompatibilityArrayType(i,n,e,!0),void o(rtl.createSet(0))}else if(c.$class.ClassType()===Be&&n.BaseType in r.btAllInteger&&this.ElHasBoolSwitch(e,28))return void o(rtl.createSet(0))}}else if(i.BaseType in rtl.createSet(34,36)){if(0 in i.Flags&&0 in n.Flags)if(n.BaseType in rtl.createSet(34,36)){var g=e.OpCode;if(1===g||2===g||3===g||23===g||18===g||19===g){if(null===n.LoTypeEl)return void(e.OpCode in rtl.createSet(18,19)?a(15):(t.$assign(i),t.IdentEl=null,t.ExprEl=e));if(null===i.LoTypeEl)return void(e.OpCode in rtl.createSet(18,19)?a(15):(t.$assign(n),t.IdentEl=null,t.ExprEl=e));if(i.SubType===n.SubType||i.SubType in r.btAllBooleans&&n.SubType in r.btAllBooleans||i.SubType in r.btAllInteger&&n.SubType in r.btAllInteger)return void(e.OpCode in rtl.createSet(18,19)?a(15):(t.$assign(i),t.IdentEl=null,t.ExprEl=e))}}else if(2===n.BaseType&&(p=n.LoTypeEl).$class.ClassType()===Ue&&this.IsDynArray(p,!0))return this.CheckAssignCompatibilityArrayType(n,i,e,!0),void h(rtl.createSet(0))}else if(35===i.BaseType){if(0 in i.Flags&&0 in n.Flags&&1===e.OpCode&&this.ElHasModeSwitch(e,44)){if(35===n.BaseType)return null!==i.LoTypeEl?t.$assign(i):t.$assign(n),t.IdentEl=null,void(t.ExprEl=e);if(2===n.BaseType&&n.LoTypeEl.$class.ClassType()===Ue)return t.$assign(n),t.IdentEl=null,void(t.ExprEl=e)}}else if(3===i.BaseType&&27===e.OpCode)return void t.$assign(n);this.RaiseIncompatibleTypeRes(20180204114631,3082,Ye(18,Fe.OpcodeStrings[e.OpCode]),i,n,e),rtl.eqSet(s,{})},this.ComputeAddStringRes=function(e,t,s,i){var n=this,l=!1;function a(e){r.SetResolverValueExpr(i,e,n.FBaseTypes[e],n.FBaseTypes[e],s,rtl.createSet(0))}function o(e){r.SetResolverValueExpr(i,t.BaseType,t.LoTypeEl,t.HiTypeEl,s,rtl.refSet(e))}l=!0;var h,u=e.BaseType;if(5===u){var c=t.BaseType;return 5===c?a(7):6===c?6===this.FBaseTypeChar?a(7):a(9):o(rtl.createSet(0)),l}if(6===u){var p=t.BaseType;return 5===p||6===p?6===this.FBaseTypeChar?a(7):a(9):o(rtl.createSet(0)),l}return 7===u||9===u?(h=rtl.createSet(0),r.SetResolverValueExpr(i,e.BaseType,e.LoTypeEl,e.HiTypeEl,s,rtl.refSet(h)),l):l=!1},this.ComputeArgumentAndExpr=function(e,t,s,i,n){this.ComputeElement(e,t,{},null),null===t.LoTypeEl&&null!==e.ArgType&&this.RaiseInternalError(20160922163628,"TypeEl=nil for "+r.GetTreeDbg(e,0)),this.ComputeArgumentExpr(t,e.Access,s,i,n)},this.ComputeArgumentExpr=function(e,t,s,i,r){var n={};n={},t in rtl.createSet(2,3)?n=rtl.includeSet(n,1):(this.IsProcedureType(e,!0)||29===e.BaseType||null===e.LoTypeEl&&We.isPrototypeOf(e.IdentEl))&&(n=rtl.includeSet(n,2),3 in this.GetElModeSwitches(s)&&(n=rtl.includeSet(n,1))),r&&(n=rtl.includeSet(n,0)),this.ComputeElement(s,i,rtl.refSet(n),null)},this.ComputeArrayParams=function(e,t,s,i){var n=this;function l(r){rtl.neSet(rtl.intersectSet(rtl.createSet(3,4),s),{})&&n.RaiseConstantExprExp(20170216152635,e),n.ComputeElement(n.GetPasPropertyType(r),t,rtl.createSet(4),i),t.IdentEl=r,t.Flags={},null!==n.GetPasPropertyGetter(r)&&(t.Flags=rtl.includeSet(t.Flags,0)),null!==n.GetPasPropertySetter(r)&&(t.Flags=rtl.includeSet(t.Flags,1))}function a(s){null===s&&n.RaiseInternalError(20180423092254,""),n.ComputeElement(s,t,rtl.createSet(4),e),t.IdentEl=null,t.ExprEl=e,t.Flags=rtl.unionSet(t.Flags,rtl.createSet(0,1))}var o=null,h=null,u=null,c=0,p=q.$new(),f=null,d=null;if(this.ComputeElement(e.Value,t,rtl.diffSet(s,rtl.createSet(1,2)),i),t.BaseType in r.btAllStrings){var F=this.GetActualBaseType(t.BaseType);8===F||9===F?6===this.FBaseTypeChar?t.BaseType=5:t.BaseType=6:this.RaiseNotYetImplemented(20170417202354,e,""),t.LoTypeEl=this.FBaseTypes[t.BaseType],t.HiTypeEl=t.LoTypeEl,t.ExprEl=e,t.Flags=rtl.unionSet(rtl.diffSet(t.Flags,rtl.createSet(1,3)),rtl.createSet(2))}else if(29===t.BaseType)a(t.LoTypeEl);else if(ve.isPrototypeOf(t.IdentEl)&&this.GetPasPropertyArgs(t.IdentEl).FCount>0)l(t.IdentEl);else if(2===t.BaseType)if((o=t.LoTypeEl).$class.ClassType()===$e||o.$class.ClassType()===Me||o.$class.ClassType()===Le)_.isPrototypeOf(e.FData)||this.RaiseNotYetImplemented(20190125143203,e,ye(e.FData)),d=e.FData,ve.isPrototypeOf(d.FDeclaration)?l(d.FDeclaration):ze.isPrototypeOf(o)?(f=rtl.as(r.NoNil(o.FData),N),this.ComputeArrayParams_Class(e,t,f,rtl.refSet(s),i)):this.RaiseNotYetImplemented(20161010174916,e,"");else if(o.$class.ClassType()===Ue){0 in t.Flags||this.RaiseMsg(20170517001140,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,"[",18,o.ElementTypeName()),e),u=o,c=0;for(;;){if(0===rtl.length(u.Ranges)?(c+=1,this.IsDynArray(u,!0)&&(t.Flags=rtl.includeSet(t.Flags,1))):c+=rtl.length(u.Ranges),c>rtl.length(e.Params)&&this.RaiseInternalError(20161010185535,""),c===rtl.length(e.Params))break;u=rtl.as(r.NoNil(this.ResolveAliasType(u.ElType,!0)),Ue)}p.$assign(t),h=this.GetArrayElType(u),this.ComputeElement(h,t,rtl.refSet(s),i),t.IdentEl=p.IdentEl,t.ExprEl=p.ExprEl,t.Flags=rtl.intersectSet(p.Flags,rtl.createSet(0,1)),this.IsDynArray(u,!0)&&(t.Flags=rtl.includeSet(t.Flags,1))}else o.$class.ClassType()===Be?a(o.DestType):this.RaiseNotYetImplemented(20161010151727,e,r.GetResolverResultDbg(t));else this.RaiseNotYetImplemented(20160928174212,e,r.GetResolverResultDbg(t))},this.ComputeArrayParams_Class=function(e,t,s,i,n){this.RaiseNotYetImplemented(20190125142240,e,""),rtl.eqSet(i,{}),r.SetResolverIdentifier(t,0,null,null,null,{})},this.ComputeFuncParams=function(e,t,s,i){var n,l=null,a=null,o=null,h=q.$new(),u=null,c=null;null===(n=this.GetParamsValueRef(e))&&this.RaiseNotYetImplemented(20160928174124,e,""),(l=n.FDeclaration).$class.ClassType()===me?l.FData.$class.ClassType()===ee?(null!=(a=l.FData).GetCallResult?a.GetCallResult(a,e,t):r.SetResolverIdentifier(t,31,a.Proc,a.Proc,a.Proc,{}),0 in a.Flags&&(t.Flags=rtl.includeSet(t.Flags,3))):Z.isPrototypeOf(l.FData)?(u=l,1!==rtl.length(e.Params)&&this.RaiseMsg(20180503105409,3034,rtl.getResStr(Ce,"sWrongNumberOfParametersForTypeCast"),Ye(18,u.FName),e),c=e.Params[0],this.ComputeElement(c,h,{},null),this.ComputeTypeCast(u,u,c,h,t,rtl.refSet(s))):this.RaiseNotYetImplemented(20161006133040,e,r.GetResolverResultDbg(t)):(this.ComputeElement(l,t,rtl.unionSet(s,rtl.createSet(1)),i),31===t.BaseType?(xe.isPrototypeOf(t.IdentEl)||this.RaiseNotYetImplemented(20160928180201,e,r.GetResolverResultDbg(t)),o=t.IdentEl,3 in s&&this.RaiseConstantExprExp(20170216152637,e),Ve.isPrototypeOf(o.ProcType)?this.ComputeResultElement(o.ProcType.ResultEl,t,rtl.unionSet(s,rtl.createSet(5)),i):o.IsAsync()&&this.ComputeProcAsyncResult(o,t,rtl.refSet(s),i)||(o.$class.ClassType()===_e?t.$assign(this.GetReference_ConstructorType(n,e.Value)):r.SetResolverIdentifier(t,31,o,o.ProcType,o.ProcType,{})),t.Flags=rtl.includeSet(t.Flags,3)):we.isPrototypeOf(t.LoTypeEl)?(Mt.isPrototypeOf(e.Value)&&(t.Flags=rtl.includeSet(t.Flags,0)),0 in t.Flags?(3 in s&&this.RaiseConstantExprExp(20170216152639,e),Ve.isPrototypeOf(t.LoTypeEl)?this.ComputeResultElement(t.LoTypeEl.ResultEl,t,rtl.unionSet(s,rtl.createSet(5)),i):we.isPrototypeOf(t.LoTypeEl)&&t.LoTypeEl.GetIsAsync()&&this.ComputeProcAsyncResult(t.LoTypeEl,t,rtl.refSet(s),i)||r.SetResolverTypeExpr(t,31,t.LoTypeEl,t.HiTypeEl,{}),t.Flags=rtl.includeSet(t.Flags,3)):(1!==rtl.length(e.Params)&&this.RaiseMsg(20170416185211,3034,rtl.getResStr(Ce,"sWrongNumberOfParametersForTypeCast"),Ye(18,t.LoTypeEl.FName),e),c=e.Params[0],this.ComputeElement(c,h,{},null),this.ComputeTypeCast(t.LoTypeEl,t.HiTypeEl,c,h,t,rtl.refSet(s)))):De.isPrototypeOf(l)?(c=e.Params[0],this.ComputeElement(c,h,rtl.refSet(s),null),this.ComputeTypeCast(t.LoTypeEl,t.HiTypeEl,c,h,t,rtl.refSet(s))):this.RaiseNotYetImplemented(20160928180048,e,r.GetResolverResultDbg(t)))},this.ComputeTypeCast=function(e,t,s,i,n,l){function a(){var e=null;return null!==(e=i.IdentEl)&&(rtl.neSet(rtl.intersectSet(rtl.createSet(3,4),l),{})?e.$class.ClassType()===it&&e.IsConst:He.isPrototypeOf(e)||e.$class.ClassType()===We||e.$class.ClassType()===$t)}var o={},h=!1,u=0,c=null;Z.isPrototypeOf(e.FData)?(u=this.GetActualBaseType(e.FData.BaseType),r.SetResolverValueExpr(n,e.FData.BaseType,e,t,s,rtl.createSet(0)),n.IdentEl=i.IdentEl,o=rtl.intersectSet(i.Flags,rtl.createSet(1,2)),rtl.neSet(o,{})&&a()&&(h=!1,29===u?(29===i.BaseType||i.BaseType in rtl.createSet(7,9,8)||null===i.LoTypeEl||i.LoTypeEl.$class.ClassType()===$e||this.IsDynArray(i.LoTypeEl,!0))&&(h=!0):this.IsSameType(e,i.LoTypeEl,0)&&(h=!0),h&&(n.Flags=rtl.unionSet(n.Flags,o)))):we.isPrototypeOf(e)?(o=a()?rtl.intersectSet(i.Flags,rtl.createSet(1,2)):{},r.SetResolverValueExpr(n,2,e,t,s,rtl.unionSet(rtl.createSet(0),o)),n.IdentEl=i.IdentEl):(c=Mt.isPrototypeOf(s.FParent)?s.FParent:s,this.ComputeElement(t,n,rtl.refSet(l),c),n.ExprEl=c,n.IdentEl=i.IdentEl,n.Flags=rtl.createSet(0),o=rtl.intersectSet(i.Flags,rtl.createSet(1,2)),rtl.neSet(o,{})&&a()&&(h=!1,0 in n.Flags&&(29===i.BaseType?(e.$class.ClassType()===$e||this.IsDynArray(i.LoTypeEl,!0))&&(h=!0):null===i.LoTypeEl||e===i.LoTypeEl?h=!0:e.$class.ClassType()===$e&&i.LoTypeEl.$class.ClassType()===$e?e.ObjKind!==i.LoTypeEl.ObjKind||(h=!0):(e.$class.ClassType()===Me&&i.LoTypeEl.$class.ClassType()===Me||e.$class.ClassType()===Ue&&i.LoTypeEl.$class.ClassType()===Ue&&this.IsDynArray(e,!0)&&this.IsDynArray(i.LoTypeEl,!0))&&(h=!0)),h&&(n.Flags=rtl.unionSet(n.Flags,o))))},this.ComputeSetParams=function(e,t,s,i){var n=q.$new(),l=q.$new(),a=0,o=null,h=!1,u=!1;if(u=null!==this.IsArrayExpr(e),0===rtl.length(e.Params))return r.SetResolverValueExpr(t,36,null,null,e,rtl.createSet(0)),void(u&&(t.BaseType=35));l.$assign(q.$new()),s=rtl.unionSet(rtl.diffSet(s,rtl.createSet(1)),rtl.createSet(2));for(var c=0,p=rtl.length(e.Params)-1;c<=p;c++)a=c,o=e.Params[a],this.ComputeElement(e.Params[0],n,rtl.refSet(s),i),(h=37===n.BaseType)&&(u&&this.RaiseXExpectedButYFound(20180615111713,"array value","range expression",o),this.ConvertRangeToElement(n)),0===l.BaseType?(l.$assign(n),h&&this.CheckIsOrdinal(l,o,!0),0 in l.Flags?u||h||this.CheckIsOrdinal(l,o,!1)||(u=!0):(u=!0,2===l.BaseType?$e.isPrototypeOf(l.IdentEl)||this.RaiseXExpectedButYFound(20170420002328,"array value","type",o):this.RaiseXExpectedButYFound(20170420002332,"array value","type",o))):this.CombineArrayLitElTypes(e.Params[0],o,l,n);l.IdentEl=null,l.ExprEl=e,l.SubType=l.BaseType,l.BaseType=u?35:36,l.Flags=rtl.createSet(0),t.$assign(l)},this.ComputeDereference=function(e,t){var s=this;function i(i){var r=null;null===(r=t.ExprEl)&&(r=e),s.ComputeElement(i,t,rtl.createSet(1),e),t.IdentEl=null,t.ExprEl=r,t.Flags=rtl.unionSet(t.Flags,rtl.createSet(0,1))}var r=null;29!==t.BaseType?2!==t.BaseType||(r=t.LoTypeEl).$class.ClassType()!==Be?this.RaiseMsg(20180422191139,3085,rtl.getResStr(Ce,"sIllegalQualifierInFrontOf"),Ye(18,Fe.OpcodeStrings[25],18,this.GetResolverResultDescription(t,!1)),e):i(r.DestType):i(t.LoTypeEl)},this.ComputeArrayValuesExpectedType=function(e,t,s,i){var n=null,l=null,a=null,o=null,h=null,u=null,c=0,p=null;if(n=e.FParent,He.isPrototypeOf(n))null===(l=n.VarType)&&this.RaiseMsg(20180429171628,3004,rtl.getResStr(Ce,"sSyntaxErrorExpectedButFound"),Ye(18,"const",18,"array values"),e),(a=this.ResolveAliasType(l,!0)).$class.ClassType()===Ue||this.RaiseIncompatibleTypeDesc(20180429171714,3028,[],"array value",this.GetTypeDescription(l,!1),e),r.SetResolverValueExpr(t,2,a,l,e,rtl.createSet(0));else if(n.$class.ClassType()===Jt){for(c=rtl.length(n.Fields)-1;c>=0&&n.Fields[c].ValueExp!==e;)c-=1;c<0&&this.RaiseInternalError(20180429181150,""),o=n.Fields[c],h=rtl.as(o.NameExp.FData,_),null===(u=rtl.as(h.FDeclaration,He))&&this.RaiseInternalError(20180429181210,""),this.ComputeElement(u,t,{},i),t.Flags=rtl.createSet(0)}else n.$class.ClassType()===Ut?(this.ComputeArrayValuesExpectedType(n,t,rtl.refSet(s),i),2===t.BaseType&&t.LoTypeEl.$class.ClassType()===Ue?(p=t.LoTypeEl,rtl.length(p.Ranges)>1&&this.RaiseNotYetImplemented(20180429180930,e,""),l=p.ElType,(a=this.ResolveAliasType(l,!0)).$class.ClassType()!==Ue&&this.RaiseIncompatibleTypeDesc(20180429180938,3028,[],"array values",this.GetTypeDescription(l,!1),e),r.SetResolverValueExpr(t,2,a,l,e,rtl.createSet(0))):this.RaiseIncompatibleTypeDesc(20180429173143,3028,[],"array values",this.GetTypeDescription$1(t,!1),e)):r.SetResolverValueExpr(t,35,null,null,e,rtl.createSet(0))},this.ComputeRecordValues=function(e,t,s,i){var n=null,l=null,a=null,o=null,h=0,u=null,c=null,p=null;if(n=e.FParent,He.isPrototypeOf(n))null===(o=n.VarType)&&this.RaiseMsg(20180429105451,3004,rtl.getResStr(Ce,"sSyntaxErrorExpectedButFound"),Ye(18,"const",18,"record values"),e),(a=this.ResolveAliasType(o,!0)).$class.ClassType()!==Me&&this.RaiseIncompatibleTypeDesc(20180429104135,3028,[],"record value",this.GetTypeDescription(o,!1),e),r.SetResolverValueExpr(t,2,a,o,e,rtl.createSet(0));else if(n.$class.ClassType()===Jt){for(h=rtl.length(n.Fields)-1;h>=0&&n.Fields[h].ValueExp!==e;)h-=1;h<0&&this.RaiseInternalError(20180429130244,""),u=n.Fields[h],c=rtl.as(u.NameExp.FData,_),null===(l=rtl.as(c.FDeclaration,He))&&this.RaiseInternalError(20180429130548,""),this.ComputeElement(l,t,{},i),t.Flags=rtl.createSet(0)}else n.$class.ClassType()===Ut?(this.ComputeArrayValuesExpectedType(n,t,rtl.refSet(s),i),2===t.BaseType&&t.LoTypeEl.$class.ClassType()===Ue?(p=t.LoTypeEl,rtl.length(p.Ranges)>1&&this.RaiseNotYetImplemented(20180429180450,e,""),o=p.ElType,(a=this.ResolveAliasType(o,!0)).$class.ClassType()!==Me&&this.RaiseIncompatibleTypeDesc(20180429180642,3028,[],"record values",this.GetTypeDescription(o,!1),e),r.SetResolverValueExpr(t,2,a,o,e,rtl.createSet(0))):this.RaiseIncompatibleTypeDesc(20180429173143,3028,[],"array values",this.GetTypeDescription$1(t,!1),e)):this.RaiseMsg(20180429110227,3004,rtl.getResStr(Ce,"sSyntaxErrorExpectedButFound"),Ye(18,"const",18,"(name:"),e)},this.CheckIsClass=function(e,t){var s=null;2!==t.BaseType&&this.RaiseXExpectedButYFound(20170216152245,"class",this.GetBaseTypeNames(t.BaseType),e),(s=t.LoTypeEl).$class.ClassType()===$e&&1===s.ObjKind||this.RaiseXExpectedButYFound(20170216152246,"class",r.GetElementTypeName(t.LoTypeEl),e)},this.CheckTypeCastClassInstanceToClass=function(e,t,s){return e.BaseType,t.BaseType,2147483647},this.CheckSetLitElCompatible=function(e,t,s,i){var n,l;if(0 in s.Flags||(null!==s.LoTypeEl?this.RaiseXExpectedButYFound(20170216152645,"ordinal",r.GetElementTypeName(s.LoTypeEl),e):this.RaiseXExpectedButYFound(20170216152648,"ordinal",this.GetBaseTypeNames(s.BaseType),e)),0 in i.Flags||(null!==i.LoTypeEl?this.RaiseXExpectedButYFound(20170216152651,"ordinal",r.GetElementTypeName(i.LoTypeEl),t):this.RaiseXExpectedButYFound(20170216152653,"ordinal",this.GetBaseTypeNames(i.BaseType),t)),n=this.GetActualBaseType(s.BaseType),l=this.GetActualBaseType(i.BaseType),n in r.btAllBooleans){if(l in r.btAllBooleans)return;this.RaiseXExpectedButYFound(20170216152656,"boolean",this.GetBaseTypeNames(i.BaseType),t)}else if(n in r.btAllInteger){if(l in r.btAllInteger)return;this.RaiseXExpectedButYFound(20170216152658,"integer",this.GetBaseTypeNames(i.BaseType),t)}else if(n in r.btAllChars){if(l in r.btAllChars)return;this.RaiseXExpectedButYFound(20170216152702,"char",this.GetBaseTypeNames(i.BaseType),t)}else if(2===n)if(s.LoTypeEl.$class.ClassType()===Ge){if(s.LoTypeEl===i.LoTypeEl)return;i.LoTypeEl.$class.ClassType()!==Ge&&this.RaiseXExpectedButYFound(20170216152707,s.LoTypeEl.FParent.FName,r.GetElementTypeName(i.LoTypeEl),t),s.LoTypeEl.FParent!==i.LoTypeEl.FParent&&this.RaiseXExpectedButYFound(20170216152710,s.LoTypeEl.FParent.FName,i.LoTypeEl.FParent.FName,t)}else this.RaiseXExpectedButYFound(20170216152712,"ordinal",this.GetBaseTypeNames(s.BaseType),e);else this.RaiseXExpectedButYFound(20170216152714,"ordinal",this.GetBaseTypeNames(s.BaseType),e)},this.CheckIsOrdinal=function(e,t,s){var i=!1;if(i=!1,e.BaseType in r.btAllRanges);else if(2===e.BaseType)if(e.LoTypeEl.$class.ClassType()===Ge);else{if(!s)return i;this.RaiseXExpectedButYFound(20170216152718,"ordinal value",r.GetElementTypeName(e.LoTypeEl),t)}else{if(!s)return i;this.RaiseXExpectedButYFound(20170216152720,"ordinal value",this.GetBaseTypeNames(e.BaseType),t)}return i=!0},this.CombineArrayLitElTypes=function(e,t,s,i){var n,l,a=null;if(s.LoTypeEl!==i.LoTypeEl||s.BaseType!==i.BaseType){if(n=this.GetActualBaseType(s.BaseType),l=this.GetActualBaseType(i.BaseType),0 in s.Flags){if(0 in i.Flags||this.RaiseIncompatibleTypeRes(20170420004759,3028,[],i,s,t),n in r.btAllBooleans){if(l in r.btAllBooleans)return void(s.BaseType=this.GetCombinedBoolean(n,l,t));this.RaiseXExpectedButYFound(20170420093015,"boolean",this.GetBaseTypeNames(i.BaseType),t)}else if(n in r.btAllInteger){if(l in r.btAllInteger)return void(s.BaseType=this.GetCombinedInt(s,i,t));this.RaiseXExpectedButYFound(20170420093019,"integer",this.GetBaseTypeNames(i.BaseType),t)}else if(n in r.btAllChars){if(l in r.btAllChars)return void(s.BaseType=this.GetCombinedChar(s,i,t));this.RaiseXExpectedButYFound(20170420093024,"char",this.GetBaseTypeNames(i.BaseType),t)}else if(n in r.btAllStrings){if(l in r.btAllStringAndChars)return void(s.BaseType=this.GetCombinedString(s,i,t));this.RaiseXExpectedButYFound(20170420102832,"string",this.GetBaseTypeNames(i.BaseType),t)}else if(30===n){if(30===l)return;if(29===l)return void s.$assign(i);if(2===l&&((a=i.LoTypeEl.$class.ClassType())===$e||a===Le||a===Be||a===Ue&&this.IsDynArray(i.LoTypeEl,!0)||a===we||a===Ve))return void s.$assign(i)}else if(2===n)if((a=s.LoTypeEl.$class.ClassType())===Ge){if(s.LoTypeEl===i.LoTypeEl)return}else if(a===$e){if(i.LoTypeEl.$class.ClassType()!==$e&&this.RaiseIncompatibleTypeRes(20170420135637,3028,[],i,s,t),this.CheckClassIsClass(s.LoTypeEl,i.LoTypeEl)<2147483647)return;if(this.CheckClassIsClass(i.LoTypeEl,s.LoTypeEl)<2147483647)return void s.$assign(i)}}else if(0 in i.Flags&&this.RaiseIncompatibleTypeRes(20170420004925,3028,[],i,s,t),2===n&&s.LoTypeEl.$class.ClassType()===$e){if(i.LoTypeEl.$class.ClassType()!==$e&&this.RaiseIncompatibleTypeRes(20170420091839,3028,[],i,s,t),this.CheckClassIsClass(s.LoTypeEl,i.LoTypeEl)<2147483647)return;if(this.CheckClassIsClass(i.LoTypeEl,s.LoTypeEl)<2147483647)return void s.$assign(i)}null===s.LoTypeEl&&this.RaiseXExpectedButYFound(20170420004537,"array element",this.GetBaseTypeNames(s.BaseType),e),null===i.LoTypeEl&&this.RaiseXExpectedButYFound(20170420004602,"array element",this.GetBaseTypeNames(i.BaseType),t),this.RaiseIncompatibleTypeRes(20170420092625,3028,[],i,s,t)}},this.ConvertRangeToElement=function(e){var t;37!==e.BaseType&&this.RaiseInternalError(20161001155732,""),null===e.LoTypeEl&&(null!==e.IdentEl?this.RaiseNotYetImplemented(20161001155747,e.IdentEl,""):this.RaiseNotYetImplemented(20161001155834,e.ExprEl,"")),t=e.LoTypeEl,Je.isPrototypeOf(t)?this.ComputeElement(t.RangeExpr.Left,e,rtl.createSet(3),null):(e.BaseType=e.SubType,e.SubType=0)},this.IsCharLiteral=function(e,t){var s,i=0,r=0,n=0,l=0;if(i=0,0===(s=e.length))return i;n=1;var a=e.charAt(0);if("'"===a){if((n+=1)>s)return i;var o=e.charAt(n-1);"'"===o?n+2===s&&"'"===e.charAt(n+1-1)&&"'"===e.charAt(n+2-1)&&(i=6):o>="\udc00"&&o<="\udfff"||3===s&&"'"===e.charAt(2)&&(i=(e.charCodeAt(1),6))}else if("#"===a){if((n+=1)>s)return i;var h=e.charAt(n-1);for("$"===h?(l=16,n+=1):"&"===h?(l=8,n+=1):"%"===h?(l=2,n+=1):h>="0"&&h<="9"?l=10:this.RaiseNotYetImplemented(20170728142709,t,""),r=0;n<=s;){var u=e.charAt(n-1);if(u>="0"&&u<="9")r=r*l+e.charCodeAt(n-1)-48;else if(u>="A"&&u<="Z")r=r*l+e.charCodeAt(n-1)-65+10;else{if(!(u>="a"&&u<="z"))break;r=r*l+e.charCodeAt(n-1)-97+10}n+=1}n>s&&(i=6)}else"^"===a&&2===s&&e.charCodeAt(1)in rtl.createSet(null,97,122,null,65,90)&&(i=6);return i in rtl.createSet(6)&&(null===this.FBaseTypes[i]&&(i=5),i===this.FBaseTypeChar&&(i=5)),i},this.CheckForIn=function(e,t,s){return t.BaseType,s.BaseType,false},this.CheckForInClassOrRec=function(e,t,s){var i,n=!1,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=0,F=q.$new(),m=q.$new(),C=q.$new(),S=null,T=null;if(n=!1,De.isPrototypeOf(s.IdentEl)&&this.RaiseMsg(20190120180525,3074,rtl.getResStr(Ce,"sCannotFindEnumeratorForType"),Ye(18,this.GetBaseDescription(s,!1)),e.StartExpr),0 in s.Flags||this.RaiseMsg(20171221195421,3074,rtl.getResStr(Ce,"sCannotFindEnumeratorForType"),Ye(18,this.GetBaseDescription(s,!1)),e.StartExpr),null===(l=s.LoTypeEl))return n;if(null===(T=this.PushDotScope(s.HiTypeEl)))return n;if(h=T.FindIdentifier("GetEnumerator"),this.PopScope(),null===h){if(!ze.isPrototypeOf(l))return n;this.RaiseIdentifierNotFound(20171221191511,"GetEnumerator",e.StartExpr)}for(var y in h.FElement.$class.ClassType()!==qe&&this.RaiseContextXExpectedButYFound(20171221191638,"GetEnumerator","function",r.GetElementTypeName(h.FElement),e.StartExpr),(p=h.FElement).Visibility in rtl.createSet(3,4)||this.RaiseContextXExpectedButYFound(20171221191824,"function GetEnumerator","public",Fe.VisibilityNames[p.Visibility],e.StartExpr),p.GetFT().Args.FCount>0&&this.RaiseContextXExpectedButYFound(20171221191944,"function GetEnumerator","no arguments",Ae(p.ProcType.Args.FCount),e.StartExpr),p.ProcType.Modifiers)(d=+y)in rtl.createSet(0)||this.RaiseContextXInvalidY(20171221193455,"function GetEnumerator","modifier "+Fe.ProcTypeModifiers[d],e.StartExpr);for(var g in this.ComputeResultElement(p.GetFT().ResultEl,F,rtl.createSet(5),null),2!==F.BaseType&&this.RaiseContextXExpectedButYFound(20171221193749,"function GetEnumerator","result class",this.GetTypeDescription$1(F,!1),e.StartExpr),l=F.LoTypeEl,$e.isPrototypeOf(l)||this.RaiseContextXExpectedButYFound(20171221193749,"function GetEnumerator","result class",this.GetTypeDescription(F.LoTypeEl,!1),e.StartExpr),0 in F.Flags||this.RaiseContextXExpectedButYFound(20171221195506,"function GetEnumerator","result class instance",this.GetTypeDescription(F.LoTypeEl,!1),e.StartExpr),a=l,null===(u=(o=this.PushClassDotScope({get:function(){return a},set:function(e){a=e}},!0)).FindIdentifier("MoveNext"))&&this.RaiseIdentifierNotFound(20171221195632,"MoveNext",e.StartExpr),u.FElement.$class.ClassType()!==qe&&this.RaiseContextXExpectedButYFound(20171221195651,"MoveNext","function",r.GetElementTypeName(u.FElement),e.StartExpr),(f=u.FElement).Visibility in rtl.createSet(3,4)||this.RaiseContextXExpectedButYFound(20171221195712,"function MoveNext","public",Fe.VisibilityNames[f.Visibility],e.StartExpr),f.GetFT().Args.FCount>0&&this.RaiseContextXExpectedButYFound(20171221195723,"function MoveNext","no arguments",Ae(f.ProcType.Args.FCount),e.StartExpr),f.ProcType.Modifiers)(d=+g)in rtl.createSet(0)||this.RaiseContextXInvalidY(20171221195732,"function MoveNext","modifier "+Fe.ProcTypeModifiers[d],e.StartExpr);return this.ComputeResultElement(f.GetFT().ResultEl,m,rtl.createSet(5),null),m.BaseType in r.btAllBooleans||this.RaiseContextXExpectedButYFound(20171221200337,"function MoveNext","result boolean",this.GetTypeDescription$1(m,!1),e.StartExpr),null===(c=o.FindIdentifier("Current"))&&this.RaiseIdentifierNotFound(20171221200433,"Current",e.StartExpr),c.FElement.$class.ClassType()!==ve&&this.RaiseContextXExpectedButYFound(20171221200508,"Current","property",r.GetElementTypeName(c.FElement),e.StartExpr),(i=c.FElement).Visibility in rtl.createSet(3,4)||this.RaiseContextXExpectedButYFound(20171221200546,"property Current","public",Fe.VisibilityNames[i.Visibility],e.StartExpr),i.FArgs.FCount>0&&this.RaiseContextXExpectedButYFound(20171221200638,"property Current","no arguments",Ae(i.FArgs.FCount),e.StartExpr),null===this.GetPasPropertyGetter(i)&&this.RaiseContextXInvalidY(20171221200823,"property Current","read accessor",e.StartExpr),this.ComputeElement(i,C,rtl.createSet(4),null),2147483647===this.CheckAssignResCompatibility(t,C,e.VariableName,!1)&&this.RaiseIncompatibleTypeRes(20171221200018,3028,[],t,C,e.VariableName),this.PopScope(),(S=rtl.as(e.FData,G)).GetEnumerator=p,S.MoveNext=f,S.Current=i,n=!0},this.CheckBuiltInMinParamCount=function(e,t,s,i){return!Mt.isPrototypeOf(t)||rtl.length(t.Params)<s?(i&&this.RaiseMsg(20170216152248,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,e.Signature),t),!1):true},this.CheckBuiltInMaxParamCount=function(e,t,s,i,r){return rtl.length(t.Params)>s?(i&&(""===r&&(r=e.Signature),this.RaiseMsg(20170329154348,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,r),t.Params[s])),2147483647):0},this.CheckRaiseTypeArgNo=function(e,t,s,i,r,n){return n&&this.RaiseMsg(e,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(t),18,this.GetResolverResultDescription(i,!0),18,r),s),2147483647},this.FindUsedUnitnameInSection=function(e,t){var s,i=null,r="";if(null===t)return null;s=t.UsesClause;for(var n=0,l=rtl.length(s)-1;n<=l;n++)if(null!==(i=s[n]).Module&&Ie.isPrototypeOf(i.Module)&&(r=i.Module.FName,0===Pe(r,e)))return i.Module;return null},this.FindUsedUnitname=function(e,t){var s=null,i=null;if((i=t.$class.ClassType()).InheritsFrom(Ze))s=this.FindUsedUnitnameInSection(e,t.ProgramSection);else if(i.InheritsFrom(et))s=this.FindUsedUnitnameInSection(e,t.LibrarySection);else{if(null!==(s=this.FindUsedUnitnameInSection(e,t.InterfaceSection)))return s;s=this.FindUsedUnitnameInSection(e,t.ImplementationSection)}return s},this.FinishAssertCall=function(e,t){var s,i,r=null;s=this.FRootElement,0 in(i=rtl.as(s.FData,F)).Flags||this.FindAssertExceptionConstructors(null),null!==i.FAssertClass&&null!==(r=rtl.length(t.Params)>1?i.FAssertMsgConstructor:i.FAssertDefConstructor)&&this.CreateReference(r,t,1,null)},this.FindSystemIdentifier=function(e,t,s){var i,n,l,a=null;if(a=null,i=this.FRootElement,null===(n=this.FindUsedUnitname(e,i))){if(null===s)return a;this.RaiseIdentifierNotFound(20200523224738,"unit "+e,s)}if(null===n.InterfaceSection){if(null===s)return a;this.RaiseIdentifierNotFound(20200523224831,e+"."+t,s)}if(null===(l=rtl.as(r.NoNil(n.InterfaceSection.FData),g).FindLocalIdentifier(t))){if(null===s)return a;this.RaiseIdentifierNotFound(20200523224841,e+"."+t,s)}return a=l.FElement},this.FindSystemClassType=function(e,t,s){var i,n=null;if(n=null,i=this.FindSystemIdentifier(e,t,s),!$e.isPrototypeOf(i)){if(null===s)return n;this.RaiseXExpectedButYFound(20180119172517,"class "+t,r.GetElementTypeName(i),s)}if((n=i).IsForward){if(null===s)return n;this.RaiseXExpectedButYFound(20200523225546,"class "+t,"forward "+this.GetTypeDescription(n,!0),s)}if(1!==n.ObjKind){if(null===s)return n;this.RaiseXExpectedButYFound(20180321163200,"class "+t,this.GetTypeDescription(n,!0),s)}return n},this.FindSystemClassTypeAndConstructor=function(e,t,s,i,n){var l,a=null,o=null;if(l=!1,s.set(null),i.set(null),s.set(this.FindSystemClassType(e,t,n)),null===s.get())return l;o=rtl.as(r.NoNil(s.get().FData),O);do{for(a=o.FindIdentifier("create");null!==a;){if(a.FElement.$class.ClassType()===_e&&(i.set(a.FElement),0===i.get().ProcType.Args.FCount))return!0;a=a.NextSameIdentifier}o=o.AncestorScope}while(null!==o);return i.set(null),null!==n&&this.RaiseIdentifierNotFound(20200523224856,"constructor "+t,n),l},this.FindAssertExceptionConstructors=function(e){var t,s=null,i=null,n=null,l=null,a=null,o=null,h=q.$new();if(t=this.FRootElement,!(0 in(s=rtl.as(t.FData,F)).Flags)&&(s.Flags=rtl.includeSet(s.Flags,0),this.FindSystemClassTypeAndConstructor("sysutils","EAssertionFailed",{get:function(){return n},set:function(e){n=e}},{get:function(){return a},set:function(e){a=e}},e),null!==n)){l=rtl.as(r.NoNil(n.FData),O),s.SetAssertClass(n);do{for(i=l.FindIdentifier("create");null!==i;)i.FElement.$class.ClassType()===_e&&(0===(a=i.FElement).ProcType.Args.FCount?null===s.FAssertDefConstructor&&s.SetAssertDefConstructor(a):1===a.ProcType.Args.FCount&&null===s.FAssertMsgConstructor&&(o=rtl.getObject(a.ProcType.Args.Get(0)),this.ComputeElement(o.ArgType,h,rtl.createSet(4),null),h.BaseType in r.btAllStrings&&s.SetAssertMsgConstructor(a))),i=i.NextSameIdentifier;l=l.AncestorScope}while(null!==l)}},this.FindRangeErrorConstructors=function(e){var t,s=null,i=null,r=null;t=this.FRootElement,2 in(s=rtl.as(t.FData,F)).Flags||(s.Flags=rtl.includeSet(s.Flags,2),this.FindSystemClassTypeAndConstructor("sysutils","ERangeError",{get:function(){return i},set:function(e){i=e}},{get:function(){return r},set:function(e){r=e}},e),s.SetRangeErrorClass(i),s.SetRangeErrorConstructor(r))},this.FindTVarRec=function(e){var t,s,i,n,l=null,a=null;return t=this.FRootElement,null!==(l=(a=rtl.as(t.FData,F)).FSystemTVarRec)||(null===(s=this.FindUsedUnitname("system",t))&&this.RaiseIdentifierNotFound(20190215101210,"System.TVarRec",e),null===s.InterfaceSection&&this.RaiseIdentifierNotFound(20190215101231,"System.TVarRec",e),null===(i=rtl.as(r.NoNil(s.InterfaceSection.FData),g).FindLocalIdentifier("TVarRec"))&&this.RaiseIdentifierNotFound(20190215101253,"System.TVarRec",e),n=i.FElement,Me.isPrototypeOf(n)||this.RaiseXExpectedButYFound(20190215101310,"record TVarRec",r.GetElementTypeName(n),e),l=n,a.SetSystemTVarRec(l)),l},this.GetTVarRec=function(e){var t,s;return s=e.GetModule(),null===(t=rtl.as(s.FData,F).FSystemTVarRec)&&this.RaiseNotYetImplemented(20190215111924,e,"missing System.TVarRec"),t},this.FindDefaultConstructor=function(e){var t,s=null,i=null,r=null,n=!1,l=null;if(t=null,null===e||e.IsExternal||1!==e.ObjKind)return t;for(s=rtl.as(e.FData,O);;){if(null!==(i=s.FindLocalIdentifier("create"))){for(n=!1;null!==i;){if(r=i.FElement,!xe.isPrototypeOf(r))return t;if((l=r).$class.ClassType()===_e&&0===l.ProcType.Args.FCount)return r;this.IsProcOverload(l)&&(n=!0),i=i.NextSameIdentifier}if(!n)return t}s=s.AncestorScope}return t},this.GetTypeInfoParamType=function(e,t,s){var i=null,r=null;return i=null,this.ComputeElement(e,t,rtl.createSet(1),null),null===(r=t.IdentEl)||(De.isPrototypeOf(r)?i=r:He.isPrototypeOf(r)?i=r.VarType:r.$class.ClassType()===We?i=r.ArgType:r.$class.ClassType()===$t?i=r.ResultType:xe.isPrototypeOf(r)&&Ve.isPrototypeOf(r.ProcType)&&(i=r.ProcType.ResultEl.ResultType),s&&(i=this.ResolveAliasType(i,!0))),i},this.OnExprEvalLog=function(e,t,s,i,r,n,l){s<=1?this.RaiseMsg(t,i,r,n,l):this.LogMsg(t,s,i,r,n,l)},this.OnExprEvalIdentifier=function(e,t,s){var i=null,r=null,n=null,l=q.$new(),a=null,o=null,h={};if(i=null,_.isPrototypeOf(t.FData)||this.RaiseNotYetImplemented(20170518203134,t,ye(t.FData)),(n=(r=t.FData.FDeclaration).$class.ClassType())===it){if(null===r.Expr||!r.IsConst&&null!==r.VarType){if(1 in r.VarModifiers)return(i=os.$create("Create$1")).IdentEl=r,i}else if(null!==r.VarType?this.ComputeElement(r.VarType,l,rtl.createSet(4),null):l.BaseType=0,1 in(h=rtl.refSet(s))||(h=rtl.includeSet(h,0)),null!==(i=this.fExprEvaluator.Eval(r.Expr,rtl.refSet(h)))){if(null!==i.FElement&&i.FElement!==r.Expr&&(i=i.Clone()),i.IdentEl=r,null!==r.VarType&&4===i.Kind){var u=l.BaseType;19===u?i.Typed=1:20===u?i.Typed=2:21===u?i.Typed=3:22===u?i.Typed=4:23===u?i.Typed=5:24===u?i.Typed=6:25===u?i.Typed=7:26===u?i.Typed=8:27===u?i.Typed=9:28===u?i.Typed=0:(Ot({get:function(){return i},set:function(e){i=e}}),this.RaiseNotYetImplemented(20170624181050,r.VarType,""))}return i}0 in s&&(Ot({get:function(){return i},set:function(e){i=e}}),this.RaiseConstantExprExp(20170518214928,t))}else{if(n===Qe)return a=r,o=rtl.as(a.FParent,Ge),i=hs.$create("CreateValue",[o.Values.IndexOf(a),a]);n.InheritsFrom(De)&&(i=this.EvalTypeRange(r,rtl.refSet(s)))}return null===i&&rtl.neSet(rtl.intersectSet(rtl.createSet(0,1),s),{})&&this.RaiseConstantExprExp(20170518213616,t),i},this.OnExprEvalParams=function(e,t,s){var i=null,r=null,n=null,l=null,a=0,o=q.$new(),h=null;i=null;var u=t.Kind;if(11===u);else if(10===u&&_.isPrototypeOf(t.Value.FData))if(r=t.Value.FData.FDeclaration,De.isPrototypeOf(r)&&(r=this.ResolveAliasType(r,!0)),(n=r.$class.ClassType())===me){if(ee.isPrototypeOf(r.FData)){if(null!==(l=r.FData).Eval)l.Eval(l,t,rtl.refSet(s),{get:function(){return i},set:function(e){i=e}});else{var c=l.BuiltIn;10===c||23===c||25===c||28===c?i=null:this.RaiseNotYetImplemented(20170624192324,t,"")}return i}Z.isPrototypeOf(r.FData)&&(a=r.FData.BaseType,i=this.EvalBaseTypeCast(t,a))}else n===Ge?i=this.fExprEvaluator.EnumTypeCast(r,t.Params[0],rtl.refSet(s)):n===Je&&(this.ComputeElement(r.RangeExpr.Left,o,rtl.createSet(3),null),2===o.BaseType?(h=o.LoTypeEl).$class.ClassType()===Ge?i=this.fExprEvaluator.EnumTypeCast(h,t.Params[0],rtl.refSet(s)):this.RaiseNotYetImplemented(20171009223403,t,""):this.RaiseNotYetImplemented(20171009223303,t,""));return rtl.eqSet(s,{}),i},this.OnRangeCheckEl=function(e,t,s){null!==t&&2===s.get()&&15 in this.FCurrentParser.FScanner.FCurrentBoolSwitches&&s.set(1)},this.EvalBaseTypeCast=function(e,t){var s=this,i=null;function n(n,l){var a=0,o=0,h=0;if(t in r.btAllIntegerNoQWord){s.GetIntegerRange(t,{get:function(){return o},set:function(e){o=e}},{get:function(){return h},set:function(e){h=e}}),(l<o||l>h)&&s.fExprEvaluator.EmitRangeCheckConst$1(20170711001228,n.AsString(),o,h,e,1);try{a=Math.round(l)}catch(t){s.RaiseMsg(20170711002218,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}var u=t;19===u?i=us.$create("CreateValue$1",[a,1]):20===u?i=us.$create("CreateValue$1",[a,2]):21===u?i=us.$create("CreateValue$1",[a,3]):22===u?i=us.$create("CreateValue$1",[a,4]):23===u?i=us.$create("CreateValue$1",[a,5]):24===u?i=us.$create("CreateValue$1",[a,6]):25===u?i=us.$create("CreateValue$1",[a,7]):26===u?i=us.$create("CreateValue$1",[a,8]):27===u?i=us.$create("CreateValue$1",[a,9]):28===u?i=us.$create("CreateValue",[a]):s.RaiseNotYetImplemented(20170711001513,e,"")}else if(10===t)try{i=cs.$create("CreateValue",[l])}catch(t){s.RaiseMsg(20170711002315,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}else if(11===t)try{i=cs.$create("CreateValue",[l])}catch(t){s.RaiseMsg(20170711002327,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}else if(14===t)try{i=ps.$create("CreateValue",[1e4*l])}catch(t){s.RaiseMsg(20180421171840,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}else s.RaiseNotYetImplemented(20170711002542,e,"")}var l=null,a=0,o=0,h=0,u=0,c="\0";if(i=null,null===(l=this.Eval(e.Params[0],rtl.createSet(3),!0)))return i;try{var p=l.Kind;if(4===p){if(a=l.Int,t in r.btAllIntegerNoQWord){if(this.GetIntegerRange(t,{get:function(){return o},set:function(e){o=e}},{get:function(){return h},set:function(e){h=e}}),a<o||a>h){var f=t;19===f?i=us.$create("CreateValue$1",[255&a,1]):20===f?i=us.$create("CreateValue$1",[(255&a)<<24>>24,2]):21===f?i=us.$create("CreateValue$1",[65535&a,3]):22===f?i=us.$create("CreateValue$1",[(65535&a)<<16>>16,4]):25===f?i=us.$create("CreateValue$1",[a>>>0,7]):26===f?i=us.$create("CreateValue$1",[4294967295&a,8]):23===f||24===f||27===f||28===f?this.fExprEvaluator.EmitRangeCheckConst$1(20170624194534,l.AsString(),o,h,e,1):this.RaiseNotYetImplemented(20170624200109,e,"")}else{var d=t;19===d?i=us.$create("CreateValue$1",[a,1]):20===d?i=us.$create("CreateValue$1",[a,2]):21===d?i=us.$create("CreateValue$1",[a,3]):22===d?i=us.$create("CreateValue$1",[a,4]):23===d?i=us.$create("CreateValue$1",[a,5]):24===d?i=us.$create("CreateValue$1",[a,6]):25===d?i=us.$create("CreateValue$1",[a,7]):26===d?i=us.$create("CreateValue$1",[a,8]):27===d?i=us.$create("CreateValue$1",[a,9]):28===d?i=us.$create("CreateValue",[a]):this.RaiseNotYetImplemented(20170624200109,e,"")}return i}if(t in r.btAllBooleans){var F=a;0===F?i=fs.$create("CreateValue",[!1]):1===F?i=fs.$create("CreateValue",[!0]):this.fExprEvaluator.EmitRangeCheckConst$1(20170710203254,l.AsString(),0,1,e,1)}else if(6===t||5===t&&6===this.FBaseTypeChar)try{c=String.fromCharCode(a),i=ds.$create("CreateValue",[c])}catch(t){this.RaiseMsg(20180125112716,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}else if(10===t)try{i=cs.$create("CreateValue",[a])}catch(t){this.RaiseMsg(20170711002015,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}else if(11===t)try{i=cs.$create("CreateValue",[a])}catch(t){this.RaiseMsg(20170711002016,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}else if(14===t)try{i=ps.$create("CreateValue",[1e4*a])}catch(t){this.RaiseMsg(20180422093631,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],e)}else this.RaiseNotYetImplemented(20170624194308,e,"")}else if(6===p)u=l.FloatValue,n(l,u);else if(7===p)14===t?(i=l,l=null):(u=l.Value/1e4,n(l,u));else if(8===p)1===l.S.length&&t in r.btAllChars?(c=l.S.charAt(0),(6===t||5===t&&6===this.FBaseTypeChar)&&(i=l,l=null)):(9===t||7===t&&9===this.FBaseTypeString)&&(i=l,l=null);else{if(13===p)return i;this.RaiseNotYetImplemented(20170624193436,e,"")}}finally{Ot({get:function(){return l},set:function(e){l=e}})}return i},this.EvalLengthOfString=function(e,t,s){var i=null,r=null;if(i=null,0 in e.Flags){if(null===(r=this.Eval(t,rtl.refSet(s),!0)))return i;8===r.Kind&&(i=us.$create("CreateValue",[r.S.length])),Ot({get:function(){return r},set:function(e){r=e}})}return i},this.AddGenericTemplateIdentifiers=function(e,t){var s=null,i=0;if(null!==e)for(var r=0,n=e.FCount-1;r<=n;r++)i=r,s=rtl.getObject(e.Get(i)),t.AddIdentifier(s.FName,s,3)},this.AddSpecializedTemplateIdentifiers=function(e,t,s,i){var r,n,l=0,a=null,o=null;r=t.Params,n=t.FirstSpecialize;for(var h=0,u=rtl.length(r)-1;h<=u;h++)l=h,a=rtl.getObject(e.Get(l)),o=r[l],i&&(je.isPrototypeOf(o)?this.CheckTemplateFitsTemplate(o,a,n):this.CheckTemplateFitsParam(o,a,t,0,n)),this.AddIdentifier(s,a.FName,r[l],3)};var i=rtl.recNewT(null,"",function(){this.InferType=null,this.IsVarOut=!1,this.$eq=function(e){return this.InferType===e.InferType&&this.IsVarOut===e.IsVarOut},this.$assign=function(e){return this.InferType=e.InferType,this.IsVarOut=e.IsVarOut,this}});this.CreateInferenceTypesForCall=function(e,t){var s=this,n=null;function l(e,i,r){s.RaiseMsg(e,3140,rtl.getResStr(Ce,"sInferredTypeXFromDiffArgsMismatchFromMethodY"),Ye(18,i.FName,18,t.FName),r)}function a(e,t,i,n,o,h,u,c,p,f){var d,F=0,m=null,C=null,S=0,T=null,y=q.$new(),g=q.$new(),E=0,P=0,I=0;if(null!==t&&null!==i)if((d=t.$class.ClassType())===je){if((F=p.IndexOf(t))>=0){if(null===(m=c[F].InferType))return c[F].InferType=n,void(c[F].IsVarOut=o);if(S=2,u&&(o||c[F].IsVarOut)&&(S=1),s.IsSameType(m,n,S))return;if(h){if(s.CheckElTypeCompatibility(m,c[F].InferType,S)<=1)return;l(20191006215539,t,f)}if(o)return c[F].IsVarOut&&l(20191006220355,t,f),2147483647===s.CheckAssignCompatibility(n,m,!1,f)&&l(20191006220402,t,f),c[F].InferType=n,void(c[F].IsVarOut=o);if(c[F].IsVarOut)return void(2147483647===s.CheckAssignCompatibility(m,n,!1,f)&&l(20191006220750,t,f));if(s.ComputeElement(n,y,{},f),s.ComputeElement(c[F].InferType,g,{},f),E=0,P=y.BaseType,I=g.BaseType,P in r.btAllBooleans?I in r.btAllBooleans&&(E=null!==s.GetBaseTypes(15)?15:s.GetCombinedBoolean(P,I,f)):P in r.btAllInteger?(E=Math.max(P,I),E=null!==s.GetBaseTypes(26)&&E in rtl.createSet(19,20,21,22,24,23,26)&&25!==P&&25!==I?26:null!==s.GetBaseTypes(28)&&E<=28?28:s.GetCombinedInt(y,g,f)):y.BaseType in r.btAllStringAndChars?g.BaseType in r.btAllStringAndChars&&(E=null!==s.GetBaseTypes(9)?9:s.GetCombinedString(y,g,f)):y.BaseType in r.btAllFloats&&null!==s.GetBaseTypes(11)&&(E=11),0!==E)return c[F].InferType=s.GetBaseTypes(E),void(c[F].IsVarOut=o);l(20191006220406,t,f)}}else if(e!==t.FParent);else if(d===Ue){if(T=t,i.$class.ClassType()!==Ue)return;C=i.ElType,a(T,T.ElType,C,s.ResolveAliasType(C,!0),o,!0,u,rtl.arrayRef(c),p,f)}}function o(e,t,i,n,l,o,h){var u,c=null,p=q.$new(),f=q.$new(),d=null;if(null!==(c=(u=rtl.getObject(n.Get(e))).ArgType)&&(c.FParent===u||c.$class.ClassType()===je)&&t===u.Access in rtl.createSet(2,3)){if(e<rtl.length(i))d=i[e];else if(null===(d=u.ValueExpr))return;s.ComputeArgumentAndExpr(u,p,d,f,!1),f.BaseType in r.btAllWithSubType||(0!==f.SubType?s.RaiseNotYetImplemented(20191006203622,d,""):a(u,c,f.LoTypeEl,f.HiTypeEl,t,!1,h,rtl.arrayRef(l),o,d))}}var h,u,c,p=null,f=[],d=0;n=null,null!==(p=this.GetProcTemplateTypes(t))&&0!==p.FCount||this.RaiseNotYetImplemented(20191006174321,e,""),h=t.ProcType.Args,u=e.Params,h.FCount<rtl.length(u)&&this.RaiseNotYetImplemented(20191006183021,e,""),c=3 in this.FCurrentParser.GetCurrentModeSwitches(),f=rtl.arraySetLength(f,i,p.FCount);for(var F=0,m=p.FCount-1;F<=m;F++)f[d=F].$assign(i.$new());for(var C=0,S=h.FCount-1;C<=S;C++)o(d=C,!0,rtl.arrayRef(u),h,rtl.arrayRef(f),p,c);for(var T=0,y=h.FCount-1;T<=y;T++)o(d=T,!1,rtl.arrayRef(u),h,rtl.arrayRef(f),p,c);for(var g=0,E=p.FCount-1;g<=E;g++)null===f[d=g].InferType&&this.RaiseMsg(20191006175104,3139,rtl.getResStr(Ce,"sCouldNotInferTypeArgXForMethodY"),Ye(18,rtl.getObject(p.Get(d)).FName,18,t.FName),e);n=ge.$create("Create");for(var P=0,I=rtl.length(f)-1;P<=I;P++)d=P,n.Add(f[d].InferType),f[d].InferType=null;return n},this.CheckGenericConstraintFitsParam=function(e,t,s,i,r,n){var l=this,a=0;function o(e,t,s){return null!==n&&l.RaiseXExpectedButTypeYFound(e,t,s,n),2147483647}function h(e,t){l.RaiseMsg(e,3129,rtl.getResStr(Ce,"sXIsNotAValidConstraint"),Ye(18,l.GetElementSourcePosStr(t)),n)}var u,c=null,p=null,f=null,d=0,F=q.$new(),m=null,C=null,S=null,T=u=this.GetGenericConstraintKeyword(i);if(96===T)return Me.isPrototypeOf(e)?0:o(20190725200015,"record type",e);if(47===T||50===T)return $e.isPrototypeOf(e)?1!==(c=e).ObjKind?o(20190726133232,"class type",e):c.IsExternal?o(20190726133233,"non external class type",e):50===u&&null===this.FindDefaultConstructor(c)?o(20190831000225,"class type with constructor create()",e):a:o(20190726133231,"class type",e);if(De.isPrototypeOf(i)||this.RaiseNotYetImplemented(20190912214727,i,at(n)),null!==t&&(S=t.GenericEl,ke.isPrototypeOf(S)?C=S.GenericTemplateTypes:xe.isPrototypeOf(S)?C=this.GetProcTemplateTypes(S):this.RaiseNotYetImplemented(20190920114755,i,""),function e(t,s){var i=!1,r=null,n=null,a=null,o=null,h=null,u=null,c=0,p=null;if(i=!1,null===t)return i;if((r=t.$class.ClassType())===Dt){if(0!==(n=t).Kind)return i;if(_.isPrototypeOf(n.FData))return e(a=n.FData.FDeclaration,s)}else if(r===Bt)i=e((o=t).Left,s)||e(o.Right,s);else if(r===Ht){if(e((p=t).NameExpr,s))return!0;for(var f=0,d=p.Params.FCount-1;f<=d;f++)if(c=f,(a=rtl.getObject(p.Params.Get(c))).FParent===p&&e(a,s))return!0}else if(r===je)i=s.IndexOf(t)>=0;else if(r.InheritsFrom(De)){if(""!==t.FName)return i;if(r===Kt){if(e((h=t).DestType,s))return!0;for(var F=0,m=h.Params.FCount-1;F<=m;F++)if(c=F,e(rtl.getObject(h.Params.Get(c)),s))return!0}else if(r===Ue){u=t;for(var C=0,S=rtl.length(u.Ranges)-1;C<=S;C++)if(c=C,e(u.Ranges[c],s))return!0;i=e(u.ElType,s)}else r===Be?i=e(t.DestType,s):r===lt?i=e(t.EnumType,s):r===Ge||l.RaiseNotYetImplemented(20190905110152,t,"")}else l.RaiseNotYetImplemented(20190905105648,t,"");return i}(i,C)&&(De.isPrototypeOf(i)?(m=i,d=rtl.length(t.SpecializedConstraints),t.SpecializedConstraints=rtl.arraySetLength(t.SpecializedConstraints,null,d+1),t.SpecializedConstraints[d]=null,this.SpecializeElType(s,t.FSpecializedEl,m,{a:d,p:t.SpecializedConstraints,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}}),i=t.SpecializedConstraints[d]):h(20190915181137,i))),this.ComputeElement(i,F,rtl.createSet(4),null),2!==F.BaseType&&h(20190914105836,i),""===F.HiTypeEl.FName&&h(20190726134037,this.GetGenericConstraintErrorEl(i,s)),je.isPrototypeOf(F.LoTypeEl))(f=F.LoTypeEl)===i.FParent&&this.RaiseNotYetImplemented(20190831213359,f,""),a=this.CheckTemplateFitsParam(e,f,null,r,n);else if($e.isPrototypeOf(F.LoTypeEl)){if(p=F.LoTypeEl,!$e.isPrototypeOf(e))return null!==n&&this.RaiseIncompatibleType(20190726135859,3028,Ye(18,""),e,p,n),2147483647;if(!(e.ObjKind in rtl.createSet(1,2)))return null!==n&&this.RaiseMsg(20190904175144,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"class",18,this.GetTypeDescription(e,!1)),n),2147483647;var y=p.ObjKind;if(1===y){var g=r;if(0===g){if(2147483647===this.CheckClassIsClass(e,p))return null!==n&&this.RaiseIncompatibleType(20190726135309,3028,Ye(18,""),e,p,n),2147483647}else if(1===g){if(2147483647!==this.CheckClassIsClass(p,e))return null!==n&&this.RaiseIncompatibleType(20190915202812,3028,Ye(18,""),p,e,n),2147483647}else if(2===g){if(2147483647===this.CheckClassIsClass(e,p)&&2147483647!==this.CheckClassIsClass(p,e))return null!==n&&this.RaiseIncompatibleType(20190915203651,3028,Ye(18,""),e,p,n),2147483647}else this.RaiseNotYetImplemented(20190915203439,i,"")}else{if(2!==y)return null!==n&&this.RaiseIncompatibleType(20190726135310,3028,Ye(18,""),e,p,n),2147483647;var E=r;if(0===E){if(null===this.GetClassImplementsIntf(e,p))return null!==n&&this.RaiseIncompatibleType(20190726135458,3028,Ye(18,""),e,p,n),2147483647}else 1===E||2===E||this.RaiseNotYetImplemented(20190915203218,i,"")}}else this.RaiseMsg(20190726134223,3129,rtl.getResStr(Ce,"sXIsNotAValidConstraint"),Ye(18,this.GetElementSourcePosStr(this.GetGenericConstraintErrorEl(i,i.FParent))),n);return a=0},this.CheckTemplateFitsParam=function(e,t,s,i,r){for(var n=0,l=0,a=0,o=rtl.length(t.Constraints)-1;a<=o;a++)if(l=a,2147483647===(n=this.CheckGenericConstraintFitsParam(e,s,t,t.Constraints[l],i,r)))return n;return n=0},this.CheckTemplateFitsParamRes=function(e,t,s,i){var r=0,n=0,l=null,a=null;if(0===rtl.length(e.Constraints))return 1;if(2===t.BaseType)if(a=t.LoTypeEl,je.isPrototypeOf(a)){if(a===e)return 1;0===s&&null!==i&&this.CheckTemplateFitsTemplate(a,e,i),r=1}else r=this.CheckTemplateFitsParam(a,e,null,s,i);else if(30===t.BaseType){for(var o=0,h=rtl.length(e.Constraints)-1;o<=h;o++)if(n=o,l=e.Constraints[n],96===this.GetGenericConstraintKeyword(l))return null!==i&&this.RaiseXExpectedButYFound(20190915211e3,"record type","nil",i),2147483647;r=1}else null!==i&&this.RaiseNotYetImplemented(20190915205441,i,""),r=2147483647;return r},this.CheckTemplateFitsTemplate=function(e,t,s){var i=this;function n(e,s){i.RaiseMsg(e,3129,rtl.getResStr(Ce,"sXIsNotAValidConstraint"),Ye(18,r.GetElementTypeName(s)),i.GetGenericConstraintErrorEl(s,t))}var l,a=0,o=0,h=0,u=null,c=null,p=null,f=null,d=null,F=null,m=q.$new();l=e.Constraints;for(var C=0,S=rtl.length(t.Constraints)-1;C<=S;C++)if(a=C,p=t.Constraints[a],0!==(h=this.GetGenericConstraintKeyword(p))){for(o=rtl.length(l)-1;o>=0&&this.GetGenericConstraintKeyword(l[o])!==h;)o-=1;o<0&&this.RaiseMsg(20190816230021,3133,rtl.getResStr(Ce,"sTypeParamXIsMissingConstraintY"),Ye(18,e.FName,18,fe.TokenInfos[h]),s)}else if(De.isPrototypeOf(p)){for(this.ComputeElement(p,m,rtl.createSet(4),null),2!==m.BaseType&&n(20190816231846,p),$e.isPrototypeOf(m.LoTypeEl)||n(20190816231849,p),u=m.LoTypeEl,o=rtl.length(l)-1;o>=0;){if(f=l[o],De.isPrototypeOf(f))if(F=f,d=this.ResolveAliasType(F,!0),$e.isPrototypeOf(d)||this.RaiseMsg(20190816232459,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"type",18,this.GetTypeDescription(F,!1)),this.GetGenericConstraintErrorEl(f,e)),c=d,2===u.ObjKind&&1===c.ObjKind){if(null!==this.GetClassImplementsIntf(c,u))break}else if(this.CheckClassIsClass(c,u)<2147483647)break;o-=1}o<0&&(2===u.ObjKind?this.RaiseMsg(20190816233102,3135,rtl.getResStr(Ce,"sTypeParamXMustSupportIntfY"),Ye(18,e.FName,18,this.GetTypeDescription(u,!1)),s):this.RaiseMsg(20190816230021,3134,rtl.getResStr(Ce,"sTypeParamXIsNotCompatibleWithY"),Ye(18,e.FName,18,this.GetTypeDescription(u,!1)),s))}else this.RaiseNotYetImplemented(20190912215702,this.GetGenericConstraintErrorEl(p,t),"")},this.CreateSpecializedItem=function(e,t,s){var i,r=this,n=null,l=null,a=null;function o(s){var i,n=null,o=0;for(n=t,null!==a&&(o=a.GetCount()-2)>=0&&(n=a.GetItem(o).FSpecializedEl),(i=s.IndexOf(n))<0&&(xe.isPrototypeOf(t)||r.RaiseNotYetImplemented(20200725093218,e,"")),o=s.FCount-1;o>i;)if(n=rtl.getObject(s.Get(o)),ke.isPrototypeOf(n)){if(R.isPrototypeOf(n.FData)&&rtl.as(n.FData,R).GenericStep>=1)break;o-=1}else{if(!xe.isPrototypeOf(n))break;if(rtl.as(n.FData,$).GenericStep>=1)break;o-=1}s.Insert(o+1,l)}var h,p,f,d,m,C=null,S=null;return n=null,f=t.GetModule(),d=rtl.as(f.FData,F),rtl.as(d.Owner,re)!==r&&this.RaiseInternalError(20190728121705,""),i=t.FData,a=i.SpecializedItems,C=null,S=null,ke.isPrototypeOf(t)?n=C=u.$create("Create"):xe.isPrototypeOf(t)?n=S=c.$create("Create"):this.RaiseNotYetImplemented(20190920140756,t,""),n.GenericEl=t,n.FirstSpecialize=e,n.Params=rtl.arrayRef(s),n.Index=a.GetCount(),a.Add$1(n),h=this.CreateSpecializedTypeName(n),p=t.$class.ClassType(),m=t.FParent,l=this.CreateOwnedElement(p,h,m),null!==C?C.SetSpecializedType(l):S.SetSpecializedProc(l),Xt.isPrototypeOf(m)?o(m.Declarations):ze.isPrototypeOf(m)&&o(m.Members),i.GenericStep>=1&&this.SpecializeGenericIntf(n),i.GenericStep>=2&&this.SpecializeGenericImpl(n),n},this.CreateSpecializedTypeName=function(e){var t,s=this;function i(e){return De.isPrototypeOf(e.FParent)?n(e.FParent):me.isPrototypeOf(e)?"System":xe.isPrototypeOf(e.FParent)?function(e){var t="";t=i(e),""!==e.FName&&(t=t+"."+e.FName);return t}(e.FParent):e.GetModule().FName}function r(e){var t="",s=0;t="<";for(var i=0,r=rtl.length(e.Params)-1;i<=r;i++)(s=i)>0&&(t+=","),t+=n(e.Params[s]);return t+=">"}function n(t){var l="",a=null,o=null,h=null;return""===t.FName?Ue.isPrototypeOf(t)?(l="array of ",a=t,rtl.length(a.Ranges)>0&&s.RaiseNotYetImplemented(20200905173026,e.FirstSpecialize,""),o=s.ResolveAliasType(a.ElType,!1),Ue.isPrototypeOf(o)&&s.RaiseNotYetImplemented(20200905173159,a,"multidimensional anonymous array as generic param"),l+=n(o)):s.RaiseNotYetImplemented(20200905173241,t,""):(l=i(t)+"."+t.FName,R.isPrototypeOf(t.FData)&&Wt("<",t.FName)<1&&null!==(h=t.FData.SpecializedFromItem)&&(l+=r(h))),l}return Wt("<",e.GenericEl.FName)>0&&this.RaiseNotYetImplemented(20201203140102,e.FSpecializedEl,e.GenericEl.FName),t=e.GenericEl.FName+r(e),Wt("><",t)>0&&this.RaiseNotYetImplemented(20201203140223,e.FSpecializedEl,t),t},this.InitSpecializeScopes=function(e,t){var s=this;var i;t.ScopeCount=this.FScopeCount,t.StashCount=this.FStashScopeCount,i=function i(r){var n=0,l=null,a=null;if(null===r&&s.RaiseInternalError(20190728125025,""),Ie.isPrototypeOf(r))F.isPrototypeOf(r.FData)||s.RaiseNotYetImplemented(20190728142609,e,ye(r)+" "+ye(r.FData)),n=0,s.FScopeCount<=n&&s.RaiseInternalError(20190728124857,""),S.isPrototypeOf(s.FScopes[n])||s.RaiseInternalError(20190728124858,"");else{if(null===r.FParent&&s.RaiseInternalError(20190728130238,ye(r)),null===r.FData)return i(r.FParent);C.isPrototypeOf(r.FData)||s.RaiseNotYetImplemented(20190728131934,e,ye(r)+" "+ye(r.FData)),n=i(r.FParent)}return n+=1,(l=r.FData).$class.FreeOnPop()&&s.RaiseInternalError(20190728131153,ye(r)),n<s.FScopeCount&&s.FScopes[n]===l||(n<s.FScopeCount&&(s.StashScopes(n),n!==s.FScopeCount&&s.RaiseNotYetImplemented(20190813005130,e,""),t.ScopeCount=s.FScopeCount),r.$class.ClassType()===Xe&&(null===(a=r.GetModule().InterfaceSection)&&s.RaiseNotYetImplemented(20190825112907,r,""),g.isPrototypeOf(a.FData)||s.RaiseNotYetImplemented(20190825112907,r,""),s.PushScope(a.FData),n+=1),s.PushScope(l)),n}(e.FParent)+1,i<this.FScopeCount&&(this.StashScopes(i),i!==this.FScopeCount&&this.RaiseNotYetImplemented(20190813005859,e,""))},this.RestoreSpecializeScopes=function(e){for(;this.FScopeCount>e.ScopeCount;)this.PopScope();this.RestoreStashedScopes(e.StashCount)},this.SpecializeGenericIntf=function(e){var t,s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=ae.$new();0===e.Step&&(e.Step=1,s=e.FSpecializedEl,t=e.GenericEl,this.InitSpecializeScopes(t,d),this.SpecializePasElementProperties(t,s),(i=s.$class.ClassType())===Me?(r=s,n=t,this.SpecializeRecordType(n,r,e)):i===$e?(l=s,a=t,this.SpecializeClassType(a,l,e)):i===Ue?(h=t,o=s,this.SpecializeArrayType(h,o,e)):i===we||i===Ve?(u=t,c=s,this.SpecializeProcedureType(u,c,e)):i.InheritsFrom(xe)?(p=t,f=s,this.SpecializeProcedure(p,f,e)):this.RaiseNotYetImplemented(20190728134933,t,""),this.RestoreSpecializeScopes(d))},this.SpecializeGenericImpl=function(e){var t,s,i=null,r=null,n=null,l=null,a=null,o=ae.$new();e.Step>2||(t=e.GenericEl,e.Step<2&&(De.isPrototypeOf(t)?this.RaiseMsg(20190804120128,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,this.GetTypeDescription(t,!1)),e.FirstSpecialize):this.RaiseMsg(20190920190727,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,t.FName),e.FirstSpecialize)),e.Step=3,(s=t.FData).GenericStep<2&&this.RaiseNotYetImplemented(20190804174019,t,ye(e.FSpecializedEl)),ze.isPrototypeOf(t)?(null===(i=e).ImplProcs&&(i.ImplProcs=ge.$create("Create")),this.SpecializeMembersImpl(t,i.FSpecializedType,i)):xe.isPrototypeOf(t)&&((l=t).IsAbstract()||l.IsExternal()||(r=e,null===(n=s.ImplProc)&&this.RaiseNotYetImplemented(20190920211609,r.FSpecializedProc,""),null===n.Body&&this.RaiseNotYetImplemented(20190920192731,n,""),a=r.FSpecializedProc,this.InitSpecializeScopes(n,o),this.SpecializeGenImplProc(l,a,r),this.RestoreSpecializeScopes(o))),e.Step=4)},this.SpecializeMembers=function(e,t){for(var s=0,i=null,r=null,n=null,l=0,a=e.Members.FCount-1;l<=a;l++)s=l,(i=rtl.getObject(e.Members.Get(s))).FParent!==e&&this.RaiseNotYetImplemented(20190728145634,i,ye(i.FParent)),n=i.$class.ClassType(),r=this.CreateOwnedElement(n,i.FName,t),t.Members.Add(r),this.SpecializeElement(i,r)},this.SpecializeMembersImpl=function(e,t,s){var i=null,r=null,n=0,l=null,a=null,o=null,h=null,u=null,c=null,p=ae.$new();i=e,r=t,o=null,p.$assign(ae.$new());for(var f=0,d=i.Members.FCount-1;f<=d;f++)if(n=f,l=rtl.getObject(i.Members.Get(n)),(a=rtl.getObject(r.Members.Get(n))).$class.ClassType()!==l.$class.ClassType()&&this.RaiseNotYetImplemented(20190816002658,l,ye(a)),a.FName!==l.FName&&this.RaiseNotYetImplemented(20190804124220,l,ye(a)),xe.isPrototypeOf(l)){if(c=a,(h=l).IsAbstract()||h.IsExternal())continue;null===(u=h.FData.ImplProc)&&this.RaiseNotYetImplemented(20190921221246,h,""),null===o?(o=u.FParent,this.InitSpecializeScopes(u,p)):o!==u.FParent&&this.RaiseNotYetImplemented(20190804130322,u,ye(o)),this.SpecializeGenImplProc(h,c,s)}else ze.isPrototypeOf(l)&&this.SpecializeMembersImpl(l,a,s);null!==o&&this.RestoreSpecializeScopes(p)},this.SpecializeGenImplProc=function(e,t,s){var i=this;var n,l,a,o,h,p=null,f=null,d=null,F=null,m=null,C=null,S="",T="",y=0,g=0,E=null,P=null,I=null;if(E=null,P=null,c.isPrototypeOf(s)?E=s:u.isPrototypeOf(s)?P=s:this.RaiseNotYetImplemented(20190922145050,t,""),null===(d=(n=e.FData).ImplProc)&&this.RaiseNotYetImplemented(20190804122134,e,""),null===d.Body&&this.RaiseNotYetImplemented(20190921220216,d,""),l=d.FData,p=t.FData,ze.isPrototypeOf(t.FParent)?(F=rtl.as(t.FParent,ze),C=rtl.as(F.FData,N)):(F=null,C=null),null!==P){for(null===C&&this.RaiseNotYetImplemented(20190921221839,t,""),S=d.FName,(g=r.GetLastDotPos(S))<1&&this.RaiseNotYetImplemented(20190921221730,d,""),y=g;y>1&&"."!==S.charAt(y-1-1);)y-=1;T=Fs(S,y,g-y),m=rtl.as(e.FParent,ze),nt(T,m.FName)||this.RaiseNotYetImplemented(20190814141833,d,""),S=pt(S,y-1)+F.FName+Fs(S,g,S.length)}else T=d.FName,S=(y=r.GetLastDotPos(T))>0?pt(T,y)+t.FName:t.FName;o=d.$class.ClassType(),h=d.FParent,a=this.CreateOwnedElement(o,S,h),p.ImplProc=a,null!==E?E.ImplProc=a:P.ImplProcs.Add(a),null!==E&&Xt.isPrototypeOf(h)&&function(t,s,r,n){var l=null,a=0;if(l=null,null!==s)for(a=s.GetCount()-1;a>=0;){if((l=s.GetItem(a).ImplProc)===n)l=null;else if(null!==l)break;a-=1}null===l&&(l=r),(a=t.IndexOf(l))<0&&i.RaiseNotYetImplemented(20191017122900,e,""),t.Insert(a+1,n)}(h.Declarations,n.SpecializedItems,d,a),(f=this.CreateScope(a,this.FScopeClass_Proc)).Flags=rtl.createSet(1),f.DeclarationProc=t,f.ModeSwitches=rtl.refSet(l.ModeSwitches),f.BoolSwitches=rtl.refSet(l.BoolSwitches),f.VisibilityContext=F,f.ClassRecScope=C,null!==E&&(I=this.GetProcTemplateTypes(e),this.AddSpecializedTemplateIdentifiers(I,s,f,!1)),this.SpecializePasElementProperties(d,a),this.AddProcedure(a,null),this.SpecializeProcedure(d,a,s)},this.SpecializeElement=function(e,t){var s=null;this.SpecializePasElementProperties(e,t),(s=e.$class.ClassType())===Dt?this.SpecializePrimitiveExpr(e,t):s===Lt?this.SpecializeUnaryExpr(e,t):s===Bt?this.SpecializeBinaryExpr(e,t):s===Gt?this.SpecializeBoolConstExpr(e,t):s===wt||s===Vt?this.SpecializeExpr(e,t):s===Mt?this.SpecializeParamsExpr(e,t):s===Jt?this.SpecializeRecordValues(e,t):s===Ut?this.SpecializeArrayValues(e,t):s===Ht?this.SpecializeInlineSpecializeExpr(e,t):s===jt?this.SpecializeProcedureExpr(e,t):s===qt||s===Qt||s===Le?(this.AddType(t),this.SpecializeAliasType(e,t)):s===Be?(this.AddType(t),this.SpecializePointerType(e,t)):s===Je?(this.AddType(t),this.SpecializeRangeType(e,t)):s===Ue?(this.GetTypeParameterCount(e)>0&&this.RaiseNotYetImplemented(20190815201219,e,""),this.AddArrayType(t,null),this.SpecializeArrayType(e,t,null)):s===Qe?(this.AddEnumValue(t),this.SpecializeEnumValue(e,t)):s===Ge?(this.AddEnumType(t),this.SpecializeEnumType(e,t)):s===lt?this.SpecializeSetType(e,t):s===rt?this.SpecializeVariant(e,t):s===Me?(this.GetTypeParameterCount(e)>0&&this.RaiseNotYetImplemented(20190815201201,e,""),this.AddRecordType(t,null),this.SpecializeRecordType(e,t,null)):s===$e?(this.GetTypeParameterCount(e)>0&&this.RaiseNotYetImplemented(20190816214947,e,""),this.AddClassType(t,null),this.SpecializeClassType(e,t,null)):s===ms?(this.AddType(t),this.SpecializeStringType(e,t)):s===Kt?(this.AddType(t),this.SpecializeSpecializeType(e,t)):s===je?this.SpecializeGenericTemplateType(e,t):s===vt||(s===ft?this.SpecializeImplBlock(e,t):s===At?this.SpecializeImplAsmStatement(e,t):s===Ct?this.SpecializeImplRepeatUntil(e,t):s===St?this.SpecializeImplIfElse(e,t):s===Tt?this.SpecializeImplWhileDo(e,t):s===Nt?this.SpecializeImplWithDo(e,t):s===yt?this.SpecializeImplCaseOf(e,t):s===bt?this.SpecializeImplCaseStatement(e,t):s===kt?this.SpecializeImplBlock(e,t):s===dt?this.SpecializeImplAssign(e,t):s===Ft?this.SpecializeImplSimple(e,t):s===Et?this.SpecializeImplForLoop(e,t):s===Pt?this.SpecializeImplTry(e,t):s===Cs||s===Ss||s===Ts?this.SpecializeImplBlock(e,t):s===It?(this.AddExceptOn(t),this.SpecializeImplExceptOn(e,t)):s===Rt?this.SpecializeImplRaise(e,t):s===ys?(this.AddResourceString(t),this.SpecializeResString(e,t)):s===He?(this.AddVariable(t),this.SpecializeVariable(e,t,!0)):s===it?(this.AddVariable(t),this.SpecializeConst(e,t)):s===ve?(this.AddProperty(t),this.SpecializeProperty(e,t)):s===_t?this.SpecializeAttributes(e,t):s===Zt?this.SpecializeMethodResolution(e,t):s===We?(this.AddArgument(t),this.SpecializeArgument(e,t)):s===Ne?(this.AddProcedureBody(t),this.SpecializeProcedureBody(e,t)):s===gs?(this.AddProcedure(t,null),this.SpecializeOperator(e,t)):s.InheritsFrom(xe)?(this.AddProcedure(t,null),this.SpecializeProcedure(e,t,null)):s.InheritsFrom(we)?(this.AddProcedureType(t,null),this.SpecializeProcedureType(e,t,null)):s===ls?this.RaiseMsg(20210101234958,3145,rtl.getResStr(Ce,"sSymbolCannotBeExportedFromALibrary"),[],e):this.RaiseNotYetImplemented(20190728151215,e,""))},this.SpecializePasElementProperties=function(e,t){t.SourceFilename=e.SourceFilename,t.SourceLinenumber=e.SourceLinenumber,t.SourceEndLinenumber=e.SourceEndLinenumber,t.Visibility=e.Visibility,t.FHints=rtl.refSet(e.FHints),t.FHintMessage=e.FHintMessage,t.FDocComment=e.FDocComment},this.SpecializeVariable=function(e,t,s){this.SpecializeElType(e,t,e.VarType,{p:t,get:function(){return this.p.VarType},set:function(e){this.p.VarType=e}}),t.VarModifiers=rtl.refSet(e.VarModifiers),null!==e.LibraryName&&this.SpecializeElExpr(e,t,e.LibraryName,{p:t,get:function(){return this.p.LibraryName},set:function(e){this.p.LibraryName=e}}),null!==e.ExportName&&this.SpecializeElExpr(e,t,e.ExportName,{p:t,get:function(){return this.p.ExportName},set:function(e){this.p.ExportName=e}}),t.Modifiers=e.Modifiers,null!==e.AbsoluteExpr&&this.SpecializeElExpr(e,t,e.AbsoluteExpr,{p:t,get:function(){return this.p.AbsoluteExpr},set:function(e){this.p.AbsoluteExpr=e}}),null!==e.Expr&&this.SpecializeElExpr(e,t,e.Expr,{p:t,get:function(){return this.p.Expr},set:function(e){this.p.Expr=e}}),s&&this.FinishVariable(t)},this.SpecializeConst=function(e,t){t.IsConst=e.IsConst,this.SpecializeVariable(e,t,!0)},this.SpecializeProperty=function(e,t){this.SpecializeVariable(e,t,!1),this.SpecializeElExpr(e,t,e.IndexExpr,{p:t,get:function(){return this.p.IndexExpr},set:function(e){this.p.IndexExpr=e}}),this.SpecializeElExpr(e,t,e.ReadAccessor,{p:t,get:function(){return this.p.ReadAccessor},set:function(e){this.p.ReadAccessor=e}}),this.SpecializeElExpr(e,t,e.WriteAccessor,{p:t,get:function(){return this.p.WriteAccessor},set:function(e){this.p.WriteAccessor=e}}),this.SpecializeElExpr(e,t,e.DispIDExpr,{p:t,get:function(){return this.p.DispIDExpr},set:function(e){this.p.DispIDExpr=e}}),this.SpecializeExprArray(e,t,e.Implements,{p:t,get:function(){return this.p.Implements},set:function(e){this.p.Implements=e}}),this.SpecializeElExpr(e,t,e.StoredAccessor,{p:t,get:function(){return this.p.StoredAccessor},set:function(e){this.p.StoredAccessor=e}}),this.SpecializeElExpr(e,t,e.DefaultExpr,{p:t,get:function(){return this.p.DefaultExpr},set:function(e){this.p.DefaultExpr=e}}),t.DispIDReadOnly=e.DispIDReadOnly,t.IsDefault=e.IsDefault,t.IsNodefault=e.IsNodefault,this.SpecializeElList(e,t,e.FArgs,t.FArgs,!1),this.FinishProperty(t)},this.SpecializeTypeRef=function(e,t,s){var i;return""===s.FName&&this.RaiseNotYetImplemented(20190813213555,e,at(s)),i=this.FindElement(s.FName),De.isPrototypeOf(i)||this.RaiseNotYetImplemented(20190812021538,e,ye(i)),i},this.SpecializeElType=function(e,t,s,i){var r;if(null!==s){if(null!==i.get()&&this.RaiseNotYetImplemented(20190812021617,e,""),s.FParent!==e||s.$class.ClassType()===je)return s=this.SpecializeTypeRef(e,t,s),void i.set(s);null!==i.get()&&this.RaiseNotYetImplemented(20190808222744,t,ye(i.get())),r=s.$class.ClassType(),i.set(this.CreateOwnedElement(r,s.FName,t)),this.SpecializeElement(s,i.get())}},this.SpecializeElExpr=function(e,t,s,i){var r;null!==s&&(null!==i.get()&&this.RaiseNotYetImplemented(20190803220248,t,ye(i.get())),s.FParent!==e&&this.RaiseNotYetImplemented(20190809160834,e,""),r=s.$class.ClassType(),i.set(this.CreateOwnedElement(r,s.FName,t)),this.SpecializeElement(s,i.get()))},this.SpecializeElImplEl=function(e,t,s,i){var r;null!==s&&(s.FParent!==e&&this.RaiseNotYetImplemented(20190808222638,e,ye(s.FParent)),r=s.$class.ClassType(),i.set(this.CreateOwnedElement(r,s.FName,t)),this.SpecializeElement(s,i.get()))},this.SpecializeElImplAlias=function(e,t,s,i){var r;null!==s&&((r=e.Elements.IndexOf(s))<0&&this.RaiseNotYetImplemented(20190808225239,e,""),i.set(rtl.as(rtl.getObject(t.Elements.Get(r)),Es)),i.get().$class.ClassType()!==s.$class.ClassType()&&this.RaiseNotYetImplemented(20190808231616,s,ye(i.get())))},this.SpecializeElList=function(e,t,s,i,r){for(var n=0,l=null,a=null,o=null,h=null,u=0,c=s.FCount-1;u<=c;u++)n=u,(l=rtl.getObject(s.Get(n))).FParent===e?(l.$class.ClassType()===je&&this.RaiseNotYetImplemented(20190812233309,e,""),h=l.$class.ClassType(),a=this.CreateOwnedElement(h,l.FName,t),i.Add(a),this.SpecializeElement(l,a)):(r||this.RaiseNotYetImplemented(20190808212421,e,Ae(n)),De.isPrototypeOf(l)||this.RaiseNotYetImplemented(20190812025715,e,Ae(n)+" GenListItem="+ye(l)),o=this.SpecializeTypeRef(e,t,l),i.Add(o))},this.SpecializeProcedure=function(e,t,s){var i,r=null,n=null,l=null,a=0,o=0,h=null,u=null,c=null,p=null,f=null,d=null;if(i=rtl.as(e.FData,$),null!==(l=rtl.as(t.FData,$))?this.FTopScope!==l&&this.RaiseNotYetImplemented(20190920194151,t,""):null!==s?((l=this.PushScope$1(t,this.FScopeClass_Proc)).SpecializedFromItem=s,null!==i.DeclarationProc&&this.RaiseNotYetImplemented(20190920203700,t,""),null!==i.OverriddenProc&&this.RaiseNotYetImplemented(20190920203536,t,""),l.ClassRecScope=i.ClassRecScope,l.ModeSwitches=rtl.refSet(i.ModeSwitches),l.BoolSwitches=rtl.refSet(i.BoolSwitches),null!==(f=this.GetProcTemplateTypes(e))&&0!==f.FCount||this.RaiseNotYetImplemented(20190920183140,t,""),this.AddSpecializedTemplateIdentifiers(f,s,l,!0)):this.RaiseNotYetImplemented(20190922153918,t,""),l.Flags=rtl.includeSet(l.Flags,1),null!==e.PublicName&&this.SpecializeElExpr(e,t,e.PublicName,{p:t,get:function(){return this.p.PublicName},set:function(e){this.p.PublicName=e}}),null!==e.LibrarySymbolName&&this.SpecializeElExpr(e,t,e.LibrarySymbolName,{p:t,get:function(){return this.p.LibrarySymbolName},set:function(e){this.p.LibrarySymbolName=e}}),null!==e.LibraryExpr&&this.SpecializeElExpr(e,t,e.LibraryExpr,{p:t,get:function(){return this.p.LibraryExpr},set:function(e){this.p.LibraryExpr=e}}),null!==e.DispIDExpr&&this.SpecializeElExpr(e,t,e.DispIDExpr,{p:t,get:function(){return this.p.DispIDExpr},set:function(e){this.p.DispIDExpr=e}}),null!==e.MessageExpr&&this.SpecializeElExpr(e,t,e.MessageExpr,{p:t,get:function(){return this.p.MessageExpr},set:function(e){this.p.MessageExpr=e}}),t.FMessageName=e.FMessageName,t.FMessageType=e.FMessageType,t.AliasName=e.AliasName,t.FModifiers=rtl.refSet(e.FModifiers),null!==e.NameParts){null!==t.NameParts&&this.RaiseNotYetImplemented(20190818125620,t,""),t.NameParts=ge.$create("Create");for(var F=0,m=e.NameParts.FCount-1;F<=m;F++)if(a=F,h=rtl.getObject(e.NameParts.Get(a)),u=Ps.$create("Create"),t.NameParts.Add(u),u.Name=h.Name,null!==h.Templates){if(null!==s&&a===e.NameParts.FCount-1)continue;u.Templates=ge.$create("Create");for(var C=0,S=h.Templates.FCount-1;C<=S;C++)o=C,(c=rtl.getObject(h.Templates.Get(o))).FParent!==e&&this.RaiseNotYetImplemented(20190818130001,e,Ae(a)+","+Ae(o)+":"+c.FName+" GenParent="+ye(c.FParent)+" GenEl="+ye(e)),n=c.$class.ClassType(),p=this.CreateOwnedElement(n,c.FName,t),u.Templates.Add(p),this.SpecializeElement(c,p)}}null!==e.ProcType&&((r=e.ProcType).FParent!==e&&this.RaiseNotYetImplemented(20190803212426,e,at(r.FParent)),n=r.$class.ClassType(),t.ProcType=this.CreateOwnedElement(n,r.FName,t),this.SpecializeElement(r,t.ProcType)),l.GenericStep=1,null!==e.Body?(null!==s&&(s.Step=3),(d=e.Body).FParent!==e&&this.RaiseNotYetImplemented(20190804183308,e,ye(d.FParent)),null!==t.Body&&this.RaiseNotYetImplemented(20190920211853,t,""),n=d.$class.ClassType(),t.Body=this.CreateOwnedElement(n,d.FName,t),this.SpecializeElement(d,t.Body),this.FinishProcedure(t)):null===s?this.FinishProcedure(t):(s.Step=2,this.FTopScope!==l&&this.RaiseNotYetImplemented(20190920190400,t,""),this.PopScope())},this.SpecializeOperator=function(e,t){t.FOperatorType=e.FOperatorType,t.FTokenBased=e.FTokenBased,this.SpecializeProcedure(e,t,null)},this.SpecializeProcedureType=function(e,t,s){var i=null,r=null,n=null,l=0,a=null;null!==e.GenericTemplateTypes&&(a=this.PushScope$1(t,this.FScopeClass_ProcType),null!==s?(a.SpecializedFromItem=s,this.AddSpecializedTemplateIdentifiers(e.GenericTemplateTypes,s,a,!0)):this.RaiseNotYetImplemented(20190813194550,e,"")),this.SpecializeElList(e,t,e.Args,t.Args,!1);for(var o=0,h=t.Args.FCount-1;o<=h;o++)l=o,this.FinishArgument(rtl.getObject(t.Args.Get(l)));this.SpecializeElType(e,t,e.VarArgsType,{p:t,get:function(){return this.p.VarArgsType},set:function(e){this.p.VarArgsType=e}}),t.CallingConvention=e.CallingConvention,t.Modifiers=rtl.refSet(e.Modifiers),Ve.isPrototypeOf(t)&&null!==(i=e.ResultEl)&&(i.FParent!==e&&this.RaiseNotYetImplemented(20190803212935,e,ye(i.FParent)),n=i.$class.ClassType(),r=this.CreateOwnedElement(n,i.FName,t),t.ResultEl=r,this.AddFunctionResult(r),this.SpecializeElType(i,r,i.ResultType,{p:r,get:function(){return this.p.ResultType},set:function(e){this.p.ResultType=e}})),this.FinishProcedureType(t),null!==s&&(s.Step=4)},this.SpecializeProcedureBody=function(e,t){var s=null,i=null,r=null;this.SpecializeDeclarations(e,t),this.FinishTypeSection(t),null!==e.Body&&((s=e.Body).FParent!==e&&this.RaiseNotYetImplemented(20190804184934,s,""),r=s.$class.ClassType(),i=this.CreateOwnedElement(r,s.FName,t),t.Body=i,this.SpecializeElement(s,i))},this.SpecializeDeclarations=function(e,t){for(var s=0,i=null,r=null,n=null,l=0,a=e.Declarations.FCount-1;l<=a;l++)s=l,(i=rtl.getObject(e.Declarations.Get(s))).FParent!==e&&this.RaiseNotYetImplemented(20190806091336,e,ye(i)),n=i.$class.ClassType(),r=this.CreateOwnedElement(n,i.FName,t),t.Declarations.Add(r),n===_t?t.Attributes.Add(r):n===$e||n===Me?t.Classes.Add(r):n===it?t.Consts.Add(r):n===ls?t.ExportSymbols.Add(r):n.InheritsFrom(xe)?t.Functions.Add(r):n===ve?t.Properties.Add(r):n===ys?t.ResStrings.Add(r):n.InheritsFrom(De)?t.Types.Add(r):n===He?t.Variables.Add(r):this.RaiseNotYetImplemented(20190804184718,i,""),this.SpecializeElement(i,r)},this.SpecializeSpecializeType=function(e,t){var s,i;null===(s=e.DestType)&&this.RaiseNotYetImplemented(20190812022211,e,""),s.FParent===e&&this.RaiseNotYetImplemented(20190812022251,e,""),i=this.FindElementFor(s.FName,e.FParent,e.Params.FCount),ke.isPrototypeOf(i)||this.RaiseNotYetImplemented(20190812022359,e,ye(i)),t.DestType=i,this.SpecializeElExpr(e,t,e.Expr,{p:t,get:function(){return this.p.Expr},set:function(e){this.p.Expr=e}}),this.SpecializeElList(e,t,e.Params,t.Params,!0),null!==e.SubType&&(this.PushParserSpecializeType(t),this.SpecializeElType(e,t,e.SubType,{p:t,get:function(){return this.p.SubType},set:function(e){this.p.SubType=e}}),this.PopScope()),this.FinishSpecializeType(t)},this.SpecializeGenericTemplateType=function(e,t){var s,i=[],r=0,n=null;s=e.Constraints,rtl.length(t.Constraints)>0&&this.RaiseNotYetImplemented(20190914070209,e,""),t.Constraints=rtl.arraySetLength(t.Constraints,null,rtl.length(s)),i=t.Constraints;for(var l=0,a=rtl.length(i)-1;l<=a;l++)i[r=l]=null;for(var o=0,h=rtl.length(s)-1;o<=h;o++)n=s[r=o],Yt.isPrototypeOf(n)?this.SpecializeElExpr(e,t,n,{a:r,p:i,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}}):De.isPrototypeOf(n)?this.SpecializeElType(e,t,n,{a:r,p:i,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}}):this.RaiseNotYetImplemented(20190914070522,e,Ae(r)+" "+ye(n))},this.SpecializeArgument=function(e,t){t.Access=e.Access,this.SpecializeElType(e,t,e.ArgType,{p:t,get:function(){return this.p.ArgType},set:function(e){this.p.ArgType=e}}),null!==e.ValueExpr&&this.SpecializeElExpr(e,t,e.ValueExpr,{p:t,get:function(){return this.p.ValueExpr},set:function(e){this.p.ValueExpr=e}})},this.SpecializeImplBlock=function(e,t){for(var s=0,i=null,r=null,n=null,l=0,a=e.Elements.FCount-1;l<=a;l++)s=l,(i=rtl.getObject(e.Elements.Get(s))).FParent!==e&&this.RaiseNotYetImplemented(20190806092151,e,this.GetElementSourcePosStr(i)),n=i.$class.ClassType(),r=this.CreateOwnedElement(n,i.FName,t),t.Elements.Add(r),this.SpecializeElement(i,r)},this.SpecializeImplAsmStatement=function(e,t){this.SpecializeImplBlock(e,t),t.FTokens.Assign(e.FTokens)},this.SpecializeImplRepeatUntil=function(e,t){this.SpecializeImplBlock(e,t),this.SpecializeElExpr(e,t,e.ConditionExpr,{p:t,get:function(){return this.p.ConditionExpr},set:function(e){this.p.ConditionExpr=e}})},this.SpecializeImplIfElse=function(e,t){this.SpecializeElExpr(e,t,e.ConditionExpr,{p:t,get:function(){return this.p.ConditionExpr},set:function(e){this.p.ConditionExpr=e}}),this.SpecializeElImplEl(e,t,e.IfBranch,{p:t,get:function(){return this.p.IfBranch},set:function(e){this.p.IfBranch=e}}),this.SpecializeElImplEl(e,t,e.ElseBranch,{p:t,get:function(){return this.p.ElseBranch},set:function(e){this.p.ElseBranch=e}})},this.SpecializeImplWhileDo=function(e,t){this.SpecializeElExpr(e,t,e.ConditionExpr,{p:t,get:function(){return this.p.ConditionExpr},set:function(e){this.p.ConditionExpr=e}}),this.SpecializeElImplEl(e,t,e.Body,{p:t,get:function(){return this.p.Body},set:function(e){this.p.Body=e}})},this.SpecializeImplWithDo=function(e,t){var s=0,i=null,r=null,n=null;null!==t.FData&&this.RaiseNotYetImplemented(20200530201007,e,ye(t.FData)),this.PushScope$1(t,M);for(var l=0,a=e.Expressions.FCount-1;l<=a;l++)s=l,(i=rtl.getObject(e.Expressions.Get(s))).FParent!==e&&this.RaiseNotYetImplemented(20190808224343,e,Ae(s)),n=i.$class.ClassType(),r=this.CreateOwnedElement(n,i.FName,t),t.Expressions.Add(r),this.SpecializeElement(i,r),this.BeginScope(8,r);this.SpecializeElImplEl(e,t,e.Body,{p:t,get:function(){return this.p.Body},set:function(e){this.p.Body=e}}),this.FinishWithDo(t)},this.SpecializeImplCaseOf=function(e,t){this.SpecializeElExpr(e,t,e.CaseExpr,{p:t,get:function(){return this.p.CaseExpr},set:function(e){this.p.CaseExpr=e}}),this.SpecializeImplBlock(e,t),null!==e.ElseBranch&&this.SpecializeElImplAlias(e,t,e.ElseBranch,{p:t,get:function(){return this.p.ElseBranch},set:function(e){this.p.ElseBranch=e}})},this.SpecializeImplCaseStatement=function(e,t){this.SpecializeElList(e,t,e.Expressions,t.Expressions,!1),this.SpecializeElImplEl(e,t,e.Body,{p:t,get:function(){return this.p.Body},set:function(e){this.p.Body=e}})},this.SpecializeImplAssign=function(e,t){e.Elements.FCount>0&&this.RaiseNotYetImplemented(20190808142935,e,""),t.Kind=e.Kind,this.SpecializeElExpr(e,t,e.Left,{p:t,get:function(){return this.p.Left},set:function(e){this.p.Left=e}}),this.SpecializeElExpr(e,t,e.Right,{p:t,get:function(){return this.p.Right},set:function(e){this.p.Right=e}})},this.SpecializeImplSimple=function(e,t){e.Elements.FCount>0&&this.RaiseNotYetImplemented(20190808142935,e,""),this.SpecializeElExpr(e,t,e.Expr,{p:t,get:function(){return this.p.Expr},set:function(e){this.p.Expr=e}})},this.SpecializeImplForLoop=function(e,t){var s=0,i=null,r=null,n=null;null!==e.Variable&&this.RaiseNotYetImplemented(20190808142627,e,""),this.SpecializeElExpr(e,t,e.VariableName,{p:t,get:function(){return this.p.VariableName},set:function(e){this.p.VariableName=e}}),t.LoopType=e.LoopType,this.SpecializeElExpr(e,t,e.StartExpr,{p:t,get:function(){return this.p.StartExpr},set:function(e){this.p.StartExpr=e}}),this.SpecializeElExpr(e,t,e.EndExpr,{p:t,get:function(){return this.p.EndExpr},set:function(e){this.p.EndExpr=e}}),this.FinishForLoopHeader(t);for(var l=0,a=e.Elements.FCount-1;l<=a;l++)s=l,(i=rtl.getObject(e.Elements.Get(s))).FParent!==e&&this.RaiseNotYetImplemented(20190806092151,e,this.GetElementSourcePosStr(i)),n=i.$class.ClassType(),r=this.CreateOwnedElement(n,i.FName,t),t.AddElement(r),this.SpecializeElement(i,r)},this.SpecializeImplTry=function(e,t){this.SpecializeImplBlock(e,t),null!==e.FinallyExcept&&this.SpecializeElImplEl(e,t,e.FinallyExcept,{p:t,get:function(){return this.p.FinallyExcept},set:function(e){this.p.FinallyExcept=e}}),null!==e.ElseBranch&&this.SpecializeElImplEl(e,t,e.ElseBranch,{p:t,get:function(){return this.p.ElseBranch},set:function(e){this.p.ElseBranch=e}})},this.SpecializeImplExceptOn=function(e,t){var s=null,i=null;null!==(s=e.VarEl)?(s.FParent!==e&&this.RaiseNotYetImplemented(20190808232327,e,""),i=s.$class.ClassType(),t.VarEl=this.CreateOwnedElement(i,s.FName,t),this.SpecializeElement(s,t.VarEl),s.VarType!==e.TypeEl&&this.RaiseNotYetImplemented(20190808232601,e,""),t.TypeEl=t.VarEl.VarType):this.SpecializeElType(e,t,e.TypeEl,{p:t,get:function(){return this.p.TypeEl},set:function(e){this.p.TypeEl=e}}),this.FinishExceptOnExpr(),this.SpecializeElImplEl(e,t,e.Body,{p:t,get:function(){return this.p.Body},set:function(e){this.p.Body=e}}),this.FinishExceptOnStatement()},this.SpecializeImplRaise=function(e,t){this.SpecializeElExpr(e,t,e.ExceptObject,{p:t,get:function(){return this.p.ExceptObject},set:function(e){this.p.ExceptObject=e}}),this.SpecializeElExpr(e,t,e.ExceptAddr,{p:t,get:function(){return this.p.ExceptAddr},set:function(e){this.p.ExceptAddr=e}})},this.SpecializeExpr=function(e,t){t.Kind=e.Kind,t.OpCode=e.OpCode,this.SpecializeElExpr(e,t,e.Format1,{p:t,get:function(){return this.p.Format1},set:function(e){this.p.Format1=e}}),this.SpecializeElExpr(e,t,e.Format2,{p:t,get:function(){return this.p.Format2},set:function(e){this.p.Format2=e}})},this.SpecializeExprArray=function(e,t,s,i){var r=0;rtl.length(i.get())>0&&this.RaiseNotYetImplemented(20190808205855,e,""),i.set(rtl.arraySetLength(i.get(),null,rtl.length(s)));for(var n=0,l=rtl.length(i.get())-1;n<=l;n++)r=n,i.get()[r]=null;for(var a=0,o=rtl.length(s)-1;a<=o;a++)r=a,this.SpecializeElExpr(e,t,s[r],{a:r,p:i.get(),get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}})},this.SpecializePrimitiveExpr=function(e,t){this.SpecializeExpr(e,t),t.Value=e.Value},this.SpecializeUnaryExpr=function(e,t){this.SpecializeExpr(e,t),this.SpecializeElExpr(e,t,e.Operand,{p:t,get:function(){return this.p.Operand},set:function(e){this.p.Operand=e}})},this.SpecializeBinaryExpr=function(e,t){this.SpecializeExpr(e,t),this.SpecializeElExpr(e,t,e.Left,{p:t,get:function(){return this.p.Left},set:function(e){this.p.Left=e}}),this.SpecializeElExpr(e,t,e.Right,{p:t,get:function(){return this.p.Right},set:function(e){this.p.Right=e}})},this.SpecializeBoolConstExpr=function(e,t){this.SpecializeExpr(e,t),t.Value=e.Value},this.SpecializeParamsExpr=function(e,t){this.SpecializeExpr(e,t),this.SpecializeElExpr(e,t,e.Value,{p:t,get:function(){return this.p.Value},set:function(e){this.p.Value=e}}),this.SpecializeExprArray(e,t,e.Params,{p:t,get:function(){return this.p.Params},set:function(e){this.p.Params=e}})},this.SpecializeRecordValues=function(e,t){var s=Is.$new(),i=0,r=null;this.SpecializeExpr(e,t),t.Fields=rtl.arraySetLength(t.Fields,Is,rtl.length(e.Fields));for(var n=0,l=rtl.length(t.Fields)-1;n<=l;n++){i=n;var a=t.Fields[i];a.NameExp=null,a.ValueExp=null}for(var o=0,h=rtl.length(e.Fields)-1;o<=h;o++)i=o,s.$assign(e.Fields[i]),s.NameExp.FParent!==e&&this.RaiseNotYetImplemented(20190808205128,e,""),s.ValueExp.FParent!==e&&this.RaiseNotYetImplemented(20190808205138,e,""),r=t.Fields[i],this.SpecializeElExpr(e,t,s.NameExp,{p:r,get:function(){return this.p.NameExp},set:function(e){this.p.NameExp=e}}),this.SpecializeElExpr(e,t,s.ValueExp,{p:r,get:function(){return this.p.ValueExp},set:function(e){this.p.ValueExp=e}})},this.SpecializeArrayValues=function(e,t){this.SpecializeExpr(e,t),this.SpecializeExprArray(e,t,e.Values,{p:t,get:function(){return this.p.Values},set:function(e){this.p.Values=e}})},this.SpecializeInlineSpecializeExpr=function(e,t){this.SpecializeExpr(e,t),this.SpecializeElExpr(e,t,e.NameExpr,{p:t,get:function(){return this.p.NameExpr},set:function(e){this.p.NameExpr=e}}),this.SpecializeElList(e,t,e.Params,t.Params,!0)},this.SpecializeProcedureExpr=function(e,t){var s,i=null;this.SpecializeExpr(e,t),null===(i=e.Proc)&&this.RaiseNotYetImplemented(20190808221018,e,""),is.isPrototypeOf(i)||this.RaiseNotYetImplemented(20210331224052,e,""),i.FParent!==e&&this.RaiseNotYetImplemented(20210331223856,e,""),s=i.$class.ClassType(),t.Proc=this.CreateOwnedElement(s,i.FName,t),this.SpecializeElement(i,t.Proc)},this.SpecializeResString=function(e,t){this.SpecializeElExpr(e,t,e.Expr,{p:t,get:function(){return this.p.Expr},set:function(e){this.p.Expr=e}}),this.FinishResourcestring(t)},this.SpecializeAliasType=function(e,t){this.SpecializeElType(e,t,e.DestType,{p:t,get:function(){return this.p.DestType},set:function(e){this.p.DestType=e}}),this.SpecializeElExpr(e,t,e.Expr,{p:t,get:function(){return this.p.Expr},set:function(e){this.p.Expr=e}}),this.FinishTypeDef(t)},this.SpecializePointerType=function(e,t){this.SpecializeElType(e,t,e.DestType,{p:t,get:function(){return this.p.DestType},set:function(e){this.p.DestType=e}}),this.FinishPointerType(t)},this.SpecializeRangeType=function(e,t){this.SpecializeElExpr(e,t,e.RangeExpr,{p:t,get:function(){return this.p.RangeExpr},set:function(e){this.p.RangeExpr=e}}),this.FinishRangeType(t)},this.SpecializeArrayType=function(e,t,s){var i=null;t.IndexRange=e.IndexRange,t.PackMode=e.PackMode,null!==e.GenericTemplateTypes&&(i=this.PushScope$1(t,this.FScopeClass_Array),null!==s?(i.SpecializedFromItem=s,this.AddSpecializedTemplateIdentifiers(e.GenericTemplateTypes,s,i,!0)):this.RaiseNotYetImplemented(20190812225218,e,"")),this.SpecializeExprArray(e,t,e.Ranges,{p:t,get:function(){return this.p.Ranges},set:function(e){this.p.Ranges=e}}),this.SpecializeElType(e,t,e.ElType,{p:t,get:function(){return this.p.ElType},set:function(e){this.p.ElType=e}}),this.FinishArrayType(t),null!==s&&(s.Step=4)},this.SpecializeRecordType=function(e,t,s){var i=null;t.PackMode=e.PackMode,t.RTTIVisibility.$assign(e.RTTIVisibility),null!==s?(null!==t.FData&&this.RaiseNotYetImplemented(20190921204740,t,""),(i=this.PushScope$1(t,this.FScopeClass_Record)).VisibilityContext=t,i.SpecializedFromItem=s,this.AddSpecializedTemplateIdentifiers(e.GenericTemplateTypes,s,i,!0),3 in this.FCurrentParser.GetCurrentModeSwitches()||i.AddIdentifier(e.FName,t,3)):e.GenericTemplateTypes.FCount>0&&(null===t.FData&&this.RaiseNotYetImplemented(20190815201634,t,""),i=t.FData,this.RaiseNotYetImplemented(20190815194327,e,"")),this.SpecializeMembers(e,t),this.FinishRecordType(t),null!==s&&(s.Step=2)},this.SpecializeClassType=function(e,t,s){var i=null,n=null,l=null,a=null;l=e.GenericTemplateTypes,t.ObjKind=e.ObjKind,t.PackMode=e.PackMode,t.RTTIVisibility.$assign(e.RTTIVisibility),null!==e.HelperForType&&this.RaiseNotYetImplemented(20190730182758,e,""),e.IsForward&&this.RaiseNotYetImplemented(20190730182858,e,""),t.IsExternal=e.IsExternal,t.IsShortDefinition=e.IsShortDefinition,null!==e.GUIDExpr&&this.SpecializeElExpr(e,t,e.GUIDExpr,{p:t,get:function(){return this.p.GUIDExpr},set:function(e){this.p.GUIDExpr=e}}),t.Modifiers.Assign(e.Modifiers),t.ExternalNameSpace=e.ExternalNameSpace,t.ExternalName=e.ExternalName,t.InterfaceType=e.InterfaceType,null!==s?(i=I.$create("Create$1"),s.HeaderScope=i,n=rtl.getObject(l.Get(0)),i.SetElement(n),this.PushScope(i),this.AddSpecializedTemplateIdentifiers(l,s,i,!0)):i=null,this.SpecializeElType(e,t,e.AncestorType,{p:t,get:function(){return this.p.AncestorType},set:function(e){this.p.AncestorType=e}}),this.SpecializeElList(e,t,e.Interfaces,t.Interfaces,!0),null!==i&&(this.FTopScope!==i&&this.RaiseNotYetImplemented(20190813003056,e,""),this.PopScope(),s.HeaderScope=null,i=rtl.freeLoc(i)),this.FinishAncestors(t),e.Interfaces.FCount!==t.Interfaces.FCount&&this.RaiseNotYetImplemented(20200601125556,e,Ae(e.Interfaces.FCount)+"<>"+Ae(t.Interfaces.FCount)),null!==(a=rtl.as(r.NoNil(t.FData),O)).SpecializedFromItem&&this.RaiseNotYetImplemented(20190816215413,t,""),null!==s&&(a.SpecializedFromItem=s,this.AddSpecializedTemplateIdentifiers(l,s,a,!1),3 in this.FCurrentParser.GetCurrentModeSwitches()||a.AddIdentifier(e.FName,t,3)),this.SpecializeMembers(e,t),null!==s&&(s.Step=2),this.FinishClassType(t)},this.SpecializeEnumValue=function(e,t){this.SpecializeElExpr(e,t,e.Value,{p:t,get:function(){return this.p.Value},set:function(e){this.p.Value=e}})},this.SpecializeEnumType=function(e,t){this.SpecializeElList(e,t,e.Values,t.Values,!1),this.FinishEnumType(t)},this.SpecializeSetType=function(e,t){t.IsPacked=e.IsPacked,this.SpecializeElType(e,t,e.EnumType,{p:t,get:function(){return this.p.EnumType},set:function(e){this.p.EnumType=e}}),this.FinishSetType(t)},this.SpecializeVariant=function(e,t){this.SpecializeElList(e,t,e.Values,t.Values,!1),this.RaiseNotYetImplemented(20190808214218,e,"")},this.SpecializeStringType=function(e,t){t.LengthExpr=e.LengthExpr,this.FinishTypeDef(t)},this.SpecializeAttributes=function(e,t){this.SpecializeExprArray(e,t,e.Calls,{p:t,get:function(){return this.p.Calls},set:function(e){this.p.Calls=e}}),this.FinishAttributes(t)},this.SpecializeMethodResolution=function(e,t){t.ProcClass=e.ProcClass,this.SpecializeElExpr(e,t,e.InterfaceName,{p:t,get:function(){return this.p.InterfaceName},set:function(e){this.p.InterfaceName=e}}),this.SpecializeElExpr(e,t,e.InterfaceProc,{p:t,get:function(){return this.p.InterfaceProc},set:function(e){this.p.InterfaceProc=e}}),this.SpecializeElExpr(e,t,e.ImplementationProc,{p:t,get:function(){return this.p.ImplementationProc},set:function(e){this.p.ImplementationProc=e}}),this.FinishMethodResolution(t)},this.CheckAssignCompatibilityCustom=function(e,t,s,i,r){return e.BaseType,t.BaseType,r.get(),2147483647},this.CheckEqualCompatibilityCustomType=function(e,t,s,i){return e.BaseType,t.BaseType,2147483647},this.BI_Length_OnGetCallCompatibility=function(e,t,s){var i,n,l=0,a=q.$new(),o=[];return this.CheckBuiltInMinParamCount(e,t,1,s)?(n=(i=t).Params[0],this.ComputeElement(n,a,{},null),l=2147483647,a.BaseType in r.btAllStringAndChars?0 in a.Flags&&(l=0):2===a.BaseType&&a.LoTypeEl.$class.ClassType()===Ue&&(o=a.LoTypeEl.Ranges,0===rtl.length(o)?0 in a.Flags&&(l=0):l=0),2147483647===l?this.CheckRaiseTypeArgNo(20170329160335,1,n,a,"string or dynamic array",s):l=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):2147483647},this.BI_Length_OnGetCallResult=function(e,t,s){r.SetResolverIdentifier(s,this.FBaseTypeLength,e.Proc,this.FBaseTypes[this.FBaseTypeLength],this.FBaseTypes[this.FBaseTypeLength],rtl.createSet(0))},this.BI_Length_OnEval=function(e,t,s,i){var n,l=null,a=q.$new(),o=[],h=null;i.set(null),n=t.Params[0],this.ComputeElement(n,a,{},null),a.BaseType in r.btAllStringAndChars?i.set(this.EvalLengthOfString(q.$clone(a),n,rtl.refSet(s))):2===a.BaseType&&a.LoTypeEl.$class.ClassType()===Ue&&(o=a.LoTypeEl.Ranges,0===rtl.length(o)?(h=a.IdentEl,He.isPrototypeOf(h)&&Yt.isPrototypeOf(h.Expr)&&(l=h.Expr,Ut.isPrototypeOf(l)?i.set(us.$create("CreateValue",[rtl.length(l.Values)])):Mt.isPrototypeOf(l)&&4===l.Kind&&i.set(us.$create("CreateValue",[rtl.length(l.Params)])))):i.set(us.$create("CreateValue",[this.GetRangeLength(o[0])])))},this.BI_SetLength_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new(),o=q.$new(),h=0,u=null,c=null;if(!this.CheckBuiltInMinParamCount(e,t,2,s))return 2147483647;if(l=(i=t).Params[0],this.ComputeElement(l,a,rtl.createSet(1),null),n=2147483647,u=null,this.ResolvedElCanBeVarParam(a,t,!0)&&(a.BaseType in r.btAllStrings?n=0:2===a.BaseType&&this.IsDynArray(a.LoTypeEl,!0)&&(n=0,u=rtl.as(r.NoNil(a.LoTypeEl),Ue))),2147483647===n)return this.CheckRaiseTypeArgNo(20170216152250,1,l,a,"string or dynamic array variable",s);for(h=2;;){if(l=i.Params[h-1],this.ComputeElement(l,o,{},null),n=2147483647,0 in o.Flags&&o.BaseType in r.btAllInteger&&(n=0),2147483647===n)return this.CheckRaiseTypeArgNo(20170329160338,h,l,o,"integer",s);if(null===u||h===rtl.length(i.Params))break;if(c=this.ResolveAliasType(u.ElType,!0),!this.IsDynArray(c,!0))break;u=rtl.as(r.NoNil(c),Ue),h+=1}return n=this.CheckBuiltInMaxParamCount(e,i,h,s,"")},this.BI_SetLength_OnFinishParamsExpr=function(e,t){var s;s=t.Params,rtl.length(s),this.FinishCallArgAccess(s[0],4),this.FinishCallArgAccess(s[1],1)},this.BI_InExclude_OnGetCallCompatibility=function(e,t,s){var i,r,n,l=q.$new(),a=q.$new(),o=null,h=null,u=null,c=null;if(!this.CheckBuiltInMinParamCount(e,t,2,s))return 2147483647;if(r=(i=t).Params[0],this.ComputeElement(r,l,rtl.createSet(1),null),n=i.Params[1],this.ComputeElement(n,a,{},null),o=null,c=null,rtl.eqSet(rtl.intersectSet(rtl.createSet(0,1),l.Flags),rtl.createSet(0,1))&&null!==l.IdentEl&&((h=l.IdentEl.$class.ClassType()).InheritsFrom(He)||h===We||h===$t)&&34===l.BaseType)if((u=l.LoTypeEl).$class.ClassType()===Ge){if(o=u,!(0 in l.Flags)||l.LoTypeEl!==o)return s&&this.RaiseIncompatibleType(20210201225926,3006,Ye(9,"2"),l.LoTypeEl,o,r),2147483647}else u.$class.ClassType()===Je&&(c=u,this.ComputeElement(c.RangeExpr.Left,l,{},null),this.CheckAssignResCompatibility(l,a,n,s));return null===o&&null===c?this.CheckRaiseTypeArgNo(20170216152301,1,r,l,"variable of set of enumtype",s):this.CheckBuiltInMaxParamCount(e,i,2,s,"")},this.BI_InExclude_OnFinishParamsExpr=function(e,t){var s;s=t.Params,rtl.length(s),this.FinishCallArgAccess(s[0],4),this.FinishCallArgAccess(s[1],1)},this.BI_Break_OnGetCallCompatibility=function(e,t,s){var i;return null===this.GetLoop(t)&&this.RaiseMsg(20170216152306,3046,rtl.getResStr(Ce,"sMustBeInsideALoop"),Ye(18,"Break"),t),Mt.isPrototypeOf(t)&&0!==rtl.length(t.Params)?(i=t,this.CheckBuiltInMaxParamCount(e,i,0,s,"")):0},this.BI_Continue_OnGetCallCompatibility=function(e,t,s){var i;return null===this.GetLoop(t)&&this.RaiseMsg(20170216152309,3046,rtl.getResStr(Ce,"sMustBeInsideALoop"),Ye(18,"Continue"),t),Mt.isPrototypeOf(t)&&0!==rtl.length(t.Params)?(i=t,this.CheckBuiltInMaxParamCount(e,i,0,s,"")):0},this.BI_Exit_OnGetCallCompatibility=function(e,t,s){var i,n,l=0,a=q.$new(),o=q.$new(),h=0,u=null,c=null,p={},f=null;if(!Mt.isPrototypeOf(t)||0===rtl.length(t.Params))return 0;for(n=(i=t).Params[0],l=2147483647,h=this.FScopeCount-1;h>0&&!$.isPrototypeOf(this.GetScopes(h));)h-=1;if(h>0){if(f=null!==(u=this.GetScopes(h)).DeclarationProc?u.DeclarationProc:u.FElement,!Ve.isPrototypeOf(f.ProcType))return s&&this.RaiseMsg(20170216152312,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,"procedure exit"),i.Params[0]),2147483647;c=f.ProcType.ResultEl,this.ComputeResultElement(c,o,{},t)}else r.SetResolverTypeExpr(o,26,this.FBaseTypes[26],this.FBaseTypes[26],rtl.createSet(0,1));return p={},this.IsProcedureType(o,!0)&&(p=rtl.includeSet(p,1)),this.ComputeElement(n,a,rtl.refSet(p),null),0 in a.Flags&&(l=this.CheckAssignResCompatibility(o,a,n,!1)),2147483647===l?(s&&this.RaiseIncompatibleTypeRes(20170216152314,3006,Ye(9,"1"),a,o,n),l):l=this.CheckBuiltInMaxParamCount(e,i,1,s,"")},this.BI_IncDec_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new(),o=q.$new(),h=null,u=0;return this.CheckBuiltInMinParamCount(e,t,1,s)?(l=(i=t).Params[0],this.ComputeElement(l,a,rtl.createSet(1),null),n=2147483647,this.ResolvedElCanBeVarParam(a,t,!0)?(37===(u=a.BaseType)&&(u=a.SubType),u in r.btAllInteger?n=0:29===u?this.ElHasBoolSwitch(t,28)&&(n=0):2===u&&((h=a.LoTypeEl).$class.ClassType()===Be&&this.ElHasBoolSwitch(t,28)||h.$class.ClassType()===Je)&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20170216152320,1,l,a,"integer",s):1===rtl.length(i.Params)?n:(l=i.Params[1],this.ComputeElement(l,o,{},null),n=2147483647,0 in o.Flags&&o.BaseType in r.btAllInteger&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20170216152322,2,l,o,"integer",s):n=this.CheckBuiltInMaxParamCount(e,i,2,s,""))):(s&&this.RaiseVarExpected(20170216152319,t,a.IdentEl),n)):2147483647},this.BI_IncDec_OnFinishParamsExpr=function(e,t){var s;s=t.Params,this.FinishCallArgAccess(s[0],4),rtl.length(s)>1&&this.FinishCallArgAccess(s[1],1)},this.BI_Assigned_OnGetCallCompatibility=function(e,t,s){var i,r,n=0,l=q.$new(),a=null;return this.CheckBuiltInMinParamCount(e,t,1,s)?(r=(i=t).Params[0],this.ComputeElement(r,l,rtl.createSet(2),null),n=2147483647,(l.BaseType in rtl.createSet(30,29)||2===l.BaseType&&((a=l.LoTypeEl.$class.ClassType())===$e||a===Le||a.InheritsFrom(we)||a===Ue&&0===rtl.length(l.LoTypeEl.Ranges)))&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20170216152329,1,r,l,"class or array",s):n=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):2147483647},this.BI_Assigned_OnGetCallResult=function(e,t,s){r.SetResolverIdentifier(s,15,e.Proc,this.FBaseTypes[15],this.FBaseTypes[15],rtl.createSet(0))},this.BI_Assigned_OnFinishParamsExpr=function(e,t){var s,i=q.$new();s=t.Params[0],this.AccessExpr(s,1),this.ComputeElement(s,i,rtl.createSet(2,0),null)},this.BI_Chr_OnGetCallCompatibility=function(e,t,s){var i,n,l=0,a=q.$new();return this.CheckBuiltInMinParamCount(e,t,1,s)?(n=(i=t).Params[0],this.ComputeElement(n,a,{},null),l=2147483647,0 in a.Flags&&a.BaseType in r.btAllInteger&&(l=0),2147483647===l?this.CheckRaiseTypeArgNo(20170325185321,1,n,a,"integer",s):l=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):2147483647},this.BI_Chr_OnGetCallResult=function(e,t,s){r.SetResolverIdentifier(s,this.FBaseTypeChar,e.Proc,this.FBaseTypes[this.FBaseTypeChar],this.FBaseTypes[this.FBaseTypeChar],rtl.createSet(0))},this.BI_Chr_OnEval=function(e,t,s,i){var r,n=null;if(i.set(null),r=t.Params[0],null!==(n=this.Eval(r,rtl.refSet(s),!0)))try{i.set(this.fExprEvaluator.ChrValue(n,t))}finally{Ot({get:function(){return n},set:function(e){n=e}})}},this.BI_Ord_OnGetCallCompatibility=function(e,t,s){var i,n,l=0,a=q.$new(),o=q.$new(),h=null;if(!this.CheckBuiltInMinParamCount(e,t,1,s))return 2147483647;if(n=(i=t).Params[0],this.ComputeElement(n,a,{},null),l=2147483647,0 in a.Flags)if(a.BaseType in r.btArrayRangeTypes)l=0;else if(2===a.BaseType&&Ge.isPrototypeOf(a.LoTypeEl))l=0;else if(37===a.BaseType)if(a.SubType in r.btArrayRangeTypes)l=0;else if(2===a.SubType&&(h=a.LoTypeEl).$class.ClassType()===Je&&(this.ComputeElement(h.RangeExpr.Left,o,rtl.createSet(3),null),o.LoTypeEl.$class.ClassType()===Ge))return 0;return 2147483647===l?this.CheckRaiseTypeArgNo(20170216152334,1,n,a,"enum or char",s):l=this.CheckBuiltInMaxParamCount(e,i,1,s,"")},this.BI_Ord_OnGetCallResult=function(e,t,s){r.SetResolverIdentifier(s,26,e.Proc,this.FBaseTypes[26],this.FBaseTypes[26],rtl.createSet(0))},this.BI_Ord_OnEval=function(e,t,s,i){var r,n=null;if(i.set(null),r=t.Params[0],null!==(n=this.Eval(r,rtl.refSet(s),!0)))try{i.set(this.fExprEvaluator.OrdValue(n,t))}finally{i.get()!==n&&Ot({get:function(){return n},set:function(e){n=e}})}},this.BI_LowHigh_OnGetCallCompatibility=function(e,t,s){var i,n,l,a=0,o=q.$new(),h=null;return this.CheckBuiltInMinParamCount(e,t,1,s)?(n=(i=t).Params[0],this.ComputeElement(n,o,{},null),a=2147483647,(l=o.BaseType)in r.btAllRanges||34===l||l in r.btAllStrings?a=0:2===l&&((h=o.LoTypeEl.$class.ClassType())!==Ue&&h!==lt&&h!==Ge||(a=0)),2147483647===a?this.CheckRaiseTypeArgNo(20170216152338,1,n,o,"ordinal type, array or set",s):a=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):2147483647},this.BI_LowHigh_OnGetCallResult=function(e,t,s){var i,n=null,l=null;i=t.Params[0],this.ComputeElement(i,s,{},null),2===s.BaseType?(l=s.LoTypeEl).$class.ClassType()===Ue?(n=l,0===rtl.length(n.Ranges)?r.SetResolverIdentifier(s,this.FBaseTypeLength,e.Proc,this.FBaseTypes[this.FBaseTypeLength],this.FBaseTypes[this.FBaseTypeLength],rtl.createSet(0)):(this.ComputeElement(n.Ranges[0],s,rtl.createSet(3),null),37===s.BaseType&&this.ConvertRangeToElement(s))):l.$class.ClassType()===lt&&(s.LoTypeEl=l.EnumType,s.HiTypeEl=s.LoTypeEl):34===s.BaseType?(s.BaseType=s.SubType,s.SubType=0):s.BaseType in r.btAllStrings&&r.SetResolverIdentifier(s,this.FBaseTypeLength,e.Proc,this.FBaseTypes[this.FBaseTypeLength],this.FBaseTypes[this.FBaseTypeLength],rtl.createSet(0)),s.Flags=rtl.unionSet(rtl.diffSet(s.Flags,rtl.createSet(1)),rtl.createSet(0))},this.BI_LowHigh_OnEval=function(e,t,s,i){var n=this;var l,a,o,h=q.$new(),u=null,c=null,p=null,f=null,d=null,F=0,m=0,C=0,S=0,T=0,y=null;if(i.set(null),l=t.Params[0],this.ComputeElement(l,h,{},null),u=h.LoTypeEl,2===h.BaseType)if(u.$class.ClassType()===Ue)if(c=u,0===rtl.length(c.Ranges))if(13===e.BuiltIn)i.set(us.$create("CreateValue",[0]));else{if(a=h.IdentEl,o=!1,!(He.isPrototypeOf(a)&&Yt.isPrototypeOf(a.Expr)&&(a.$class.ClassType()===it&&a.IsConst||n.fExprEvaluator.IsConst(t))||o))return;y=h.IdentEl.Expr,Ut.isPrototypeOf(y)?i.set(us.$create("CreateValue",[rtl.length(y.Values)-1])):Mt.isPrototypeOf(y)&&4===y.Kind&&i.set(us.$create("CreateValue",[rtl.length(y.Params)-1])),null===i.get()&&this.RaiseXExpectedButYFound(20170601191003,"array constant","expression",t)}else i.set(this.EvalRangeLimit(c.Ranges[0],rtl.refSet(s),13===e.BuiltIn,l));else u.$class.ClassType()===lt?(u=u.EnumType).$class.ClassType()===Ge?(f=u.EnumType,13===e.BuiltIn?i.set(hs.$create("CreateValue",[0,rtl.getObject(f.Values.Get(0))])):i.set(hs.$create("CreateValue",[f.Values.FCount-1,rtl.getObject(f.Values.Get(f.Values.FCount-1))]))):this.RaiseNotYetImplemented(20170601203026,t,""):u.$class.ClassType()===Ge&&(f=u,T=13===e.BuiltIn?0:f.Values.FCount-1,i.set(hs.$create("CreateValue",[T,rtl.getObject(f.Values.Get(T))])));else if(34===h.BaseType){if(null===(p=this.Eval(l,rtl.refSet(s),!0)))return;if(12===p.Kind){d=p,0===rtl.length(d.Ranges)&&this.RaiseXExpectedButYFound(20170601201637,"ordinal value",p.AsString(),l),m=13===e.BuiltIn?d.RangeStart:d.RangeEnd;var g=d.ElKind;1===g?(f=rtl.as(d.IdentEl,Ge),i.set(hs.$create("CreateValue",[m,rtl.getObject(f.Values.Get(m))]))):2===g?i.set(us.$create("CreateValue",[m])):3===g?i.set(ds.$create("CreateValue",[String.fromCharCode(m)])):4===g&&(0===m?i.set(fs.$create("CreateValue",[!1])):i.set(fs.$create("CreateValue",[!0])))}else this.RaiseXExpectedButYFound(20170601201237,"ordinal value",p.AsString(),l)}else me.isPrototypeOf(u)&&Z.isPrototypeOf(u.FData)?(F=u.FData.BaseType,(F=this.GetActualBaseType(F))in r.btAllBooleans?i.set(fs.$create("CreateValue",[14===e.BuiltIn])):F in r.btAllIntegerNoQWord&&this.GetIntegerRange(F,{get:function(){return C},set:function(e){C=e}},{get:function(){return S},set:function(e){S=e}})?13===e.BuiltIn?i.set(us.$create("CreateValue",[C])):i.set(us.$create("CreateValue",[S])):6===F?13===e.BuiltIn?i.set(ds.$create("CreateValue",["\0"])):i.set(ds.$create("CreateValue",[""])):F in r.btAllStrings?13===e.BuiltIn?i.set(us.$create("CreateValue",[1])):i.set(this.EvalLengthOfString(q.$clone(h),l,rtl.refSet(s))):this.RaiseNotYetImplemented(20170602070738,t,"")):Je.isPrototypeOf(h.LoTypeEl)?i.set(this.EvalRangeLimit(u.RangeExpr,rtl.refSet(s),13===e.BuiltIn,l)):h.BaseType in r.btAllStrings?13===e.BuiltIn?i.set(us.$create("CreateValue",[1])):i.set(this.EvalLengthOfString(q.$clone(h),l,rtl.refSet(s))):this.RaiseNotYetImplemented(20170601202353,t,"")},this.BI_PredSucc_OnGetCallCompatibility=function(e,t,s){var i,r,n=0,l=q.$new();return this.CheckBuiltInMinParamCount(e,t,1,s)?(r=(i=t).Params[0],this.ComputeElement(r,l,{},null),n=2147483647,this.CheckIsOrdinal(l,r,!1)&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20170216152343,1,r,l,"ordinal",s):n=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):2147483647},this.BI_PredSucc_OnGetCallResult=function(e,t,s){this.ComputeElement(t.Params[0],s,{},null),s.Flags=rtl.diffSet(s.Flags,rtl.createSet(1))},this.BI_PredSucc_OnEval=function(e,t,s,i){var r;i.set(null),r=t.Params[0],i.set(this.Eval(r,rtl.refSet(s),!0)),null!==i.get()&&(null!==i.get().FElement&&i.set(i.get().Clone()),15===e.BuiltIn?this.fExprEvaluator.PredValue(i.get(),t):this.fExprEvaluator.SuccValue(i.get(),t))},this.BI_Str_CheckParam=function(e,t,s,i,n){var l=this,a=0;function o(e,t,s){var i=!1,a=q.$new();return null===e||(i=!1,s.BaseType in r.btAllFloats||t<2?(l.ComputeElement(e,a,{},null),a.BaseType in r.btAllInteger?0 in a.Flags?i=!0:(n&&l.RaiseMsg(20170319221755,3038,rtl.getResStr(Ce,"sNotReadable"),[],e),i):(n&&l.RaiseXExpectedButYFound(20170319221515,"integer",l.GetResolverResultDescription(a,!0),e),i)):(n&&l.RaiseMsg(20170319222319,3044,rtl.getResStr(Ce,"sIllegalExpression"),[],e),i))}var h=0,u=null;return a=2147483647,37===(h=s.BaseType)&&(h=s.SubType),h in rtl.unionSet(rtl.unionSet(r.btAllInteger,r.btAllBooleans),r.btAllFloats)||e&&h in r.btAllStringAndChars?a=0:2===h&&((u=s.LoTypeEl.$class.ClassType())!==Ge&&u!==Je||(a=0)),2147483647===a?this.CheckRaiseTypeArgNo(20170319220517,i,t,s,"boolean, integer, enum value",n):o(t.Format1,1,s)&&o(t.Format2,2,s)?a:2147483647},this.BI_StrProc_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new();return this.CheckBuiltInMinParamCount(e,t,2,s)?(i=t,this.ParentNeedsExprResult(i)?(s&&this.RaiseMsg(20170326084331,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"procedure str",18,"function str"),i),2147483647):(l=i.Params[0],this.ComputeElement(l,a,{},null),2147483647===(n=this.BI_Str_CheckParam(!1,l,a,1,s))?n:(l=i.Params[1],this.ComputeElement(l,a,{},null),n=2147483647,this.ResolvedElCanBeVarParam(a,t,!0)&&a.BaseType in r.btAllStrings&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20170319220806,1,l,a,"string variable",s):n=this.CheckBuiltInMaxParamCount(e,i,2,s,"")))):2147483647},this.BI_StrProc_OnFinishParamsExpr=function(e,t){var s;s=t.Params,rtl.length(s),this.FinishCallArgAccess(s[0],1),this.FinishCallArgAccess(s[1],4)},this.BI_StrFunc_OnGetCallCompatibility=function(e,t,s){var i,r=0,n=null,l=q.$new(),a=0;if(!this.CheckBuiltInMinParamCount(e,t,1,s))return 2147483647;if(i=t,!this.ParentNeedsExprResult(i))return s&&this.RaiseMsg(20170326084622,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"function str",18,"procedure str"),i),2147483647;for(var o=0,h=rtl.length(i.Params)-1;o<=h;o++)if(a=o,n=i.Params[a],this.ComputeElement(n,l,{},null),2147483647===(r=this.BI_Str_CheckParam(!0,n,l,a+1,s)))return r;return r=0},this.BI_StrFunc_OnGetCallResult=function(e,t,s){r.SetResolverIdentifier(s,7,e.Proc,this.FBaseTypes[7],this.FBaseTypes[7],rtl.createSet(0))},this.BI_StrFunc_OnEval=function(e,t,s,i){i.set(this.fExprEvaluator.EvalStrFunc(t,rtl.refSet(s)))},this.BI_WriteStrProc_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new(),o=0;if(!this.CheckBuiltInMinParamCount(e,t,2,s))return 2147483647;if(l=(i=t).Params[0],this.ComputeElement(l,a,{},null),n=2147483647,this.ResolvedElCanBeVarParam(a,t,!0)&&a.BaseType in r.btAllStrings&&(n=0),2147483647===n)return this.CheckRaiseTypeArgNo(20180527190304,1,l,a,"string variable",s);for(var h=1,u=rtl.length(i.Params)-1;h<=u;h++)if(o=h,l=i.Params[o],this.ComputeElement(l,a,{},null),2147483647===(n=this.BI_Str_CheckParam(!1,l,a,o,s)))return n;return n},this.BI_WriteStrProc_OnFinishParamsExpr=function(e,t){var s,i=0;s=t.Params,rtl.length(s),this.FinishCallArgAccess(s[0],5);for(var r=0,n=rtl.length(t.Params)-1;r<=n;r++)i=r,this.FinishCallArgAccess(s[i],1)},this.BI_Val_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new(),o=0,h=null;return this.CheckBuiltInMinParamCount(e,t,3,s)?(l=(i=t).Params[0],this.ComputeElement(l,a,{},null),n=2147483647,a.BaseType in r.btAllStrings&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20181214141250,1,l,a,"string",s):(l=i.Params[1],this.ComputeElement(l,a,{},null),n=2147483647,this.ResolvedElCanBeVarParam(a,t,!0)&&(37===(o=a.BaseType)&&(o=a.SubType),o in rtl.unionSet(rtl.unionSet(r.btAllInteger,r.btAllBooleans),r.btAllFloats)?n=0:2===o&&((h=a.LoTypeEl.$class.ClassType())!==Ge&&h!==Je||(n=0))),2147483647===n?this.CheckRaiseTypeArgNo(20181214141704,2,l,a,"boolean/integer/float/enum variable",s):(l=i.Params[2],this.ComputeElement(l,a,{},null),n=2147483647,this.ResolvedElCanBeVarParam(a,t,!0)&&a.BaseType in r.btAllInteger&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20181214141511,3,l,a,"integer variable",s):n=this.CheckBuiltInMaxParamCount(e,i,3,s,"")))):2147483647},this.BI_Val_OnFinishParamsExpr=function(e,t){var s;s=t.Params,rtl.length(s),this.FinishCallArgAccess(s[0],1),this.FinishCallArgAccess(s[1],5),this.FinishCallArgAccess(s[2],5)},this.BI_LoHi_OnGetCallCompatibility=function(e,t,s){var i,n,l=0,a=q.$new();return this.CheckBuiltInMinParamCount(e,t,1,s)?(n=(i=t).Params[0],this.ComputeElement(n,a,{},null),l=2147483647,0 in a.Flags&&a.BaseType in r.btAllInteger&&(l=0),2147483647===l?this.CheckRaiseTypeArgNo(20190128232600,1,n,a,"integer type",s):l=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):2147483647},this.BI_LoHi_OnGetCallResult=function(e,t,s){var i=q.$new(),n=0,l=0;this.ComputeElement(t.Params[0],i,{},null),this.GetShiftAndMaskForLoHiFunc(i.BaseType,21===e.BuiltIn,{get:function(){return l},set:function(e){l=e}});n=15===l||255===l?19:65535===l?21:25,r.SetResolverIdentifier(s,n,e.Proc,this.FBaseTypes[n],this.FBaseTypes[n],rtl.createSet(0))},this.BI_LoHi_OnEval=function(e,t,s,i){var r,n=q.$new(),l=null,a=0,o=0;if(i.set(null),r=t.Params[0],null!==(l=this.Eval(r,rtl.refSet(s),!0)))try{this.ComputeElement(r,n,{},null),a=this.GetShiftAndMaskForLoHiFunc(n.BaseType,21===e.BuiltIn,{get:function(){return o},set:function(e){o=e}}),i.set(this.fExprEvaluator.ShiftAndMaskValue(l,a,o,t))}finally{Ot({get:function(){return l},set:function(e){l=e}})}},this.BI_ConcatArray_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new(),o=q.$new(),h=q.$new(),u=0,c=null,p=null;if(n=2147483647,!this.CheckBuiltInMinParamCount(e,t,1,s))return n;i=t,h.$assign(q.$new());for(var f=0,d=rtl.length(i.Params)-1;f<=d;f++){if(u=f,l=i.Params[u],this.ComputeElement(l,a,{},null),o.$assign(q.$new()),0 in a.Flags&&(2===a.BaseType?this.IsDynArray(a.LoTypeEl,!0)&&(c=a.LoTypeEl,p=this.GetArrayElType(c),this.ComputeElement(p,o,rtl.createSet(4),null)):a.BaseType in rtl.createSet(35,36)&&r.SetResolverValueExpr(o,a.SubType,a.LoTypeEl,a.HiTypeEl,l,rtl.refSet(a.Flags))),0===o.BaseType)return this.CheckRaiseTypeArgNo(20170329181206,u+1,l,a,"dynamic array",s);if(o.Flags=rtl.includeSet(o.Flags,0),0===u)h.$assign(o),h.Flags=rtl.includeSet(h.Flags,1);else if(2147483647===this.CheckAssignResCompatibility(h,o,l,s))return 2147483647}return n=0},this.BI_ConcatArray_OnGetCallResult=function(e,t,s){this.ComputeElement(t.Params[0],s,{},null),s.Flags=rtl.diffSet(s.Flags,rtl.createSet(1)),s.ExprEl=t,s.IdentEl=null,36===s.BaseType&&(s.BaseType=35)},this.BI_ConcatString_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=0,a=null,o=q.$new();if(n=2147483647,!this.CheckBuiltInMinParamCount(e,t,1,s))return n;i=t;for(var h=0,u=rtl.length(i.Params)-1;h<=u;h++)if(l=h,a=i.Params[l],this.ComputeElement(a,o,{},null),!(0 in o.Flags)||!(o.BaseType in r.btAllStringAndChars))return this.CheckRaiseTypeArgNo(20181219230329,l+1,a,o,"string",s);return n=0},this.BI_ConcatString_OnGetCallResult=function(e,t,s){var i,r=0,n=null,l=q.$new(),a=q.$new();i=t.Params;for(var o=0,h=rtl.length(i)-1;o<=h;o++)n=i[r=o],this.ComputeElement(n,l,{},null),0===r?s.$assign(l):(this.ComputeAddStringRes(s,l,t,a),s.$assign(a))},this.BI_ConcatString_OnEval=function(e,t,s,i){var r=0,n=null,l=null,a=null,o=!1;l=null,i.set(null),o=!1;try{for(var h=0,u=rtl.length(t.Params)-1;h<=u;h++){if(r=h,n=t.Params[r],null===(l=this.Eval(n,rtl.refSet(s),!0)))return;0===r?(i.set(l),l=null):(a=this.fExprEvaluator.EvalStringAddExpr(n,t.Params[r-1],n,i.get(),l),Ot(i),i.set(a),Ot({get:function(){return l},set:function(e){l=e}}))}o=!0}finally{Ot({get:function(){return l},set:function(e){l=e}}),o||Ot(i)}},this.BI_CopyArray_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new();return n=2147483647,this.CheckBuiltInMinParamCount(e,t,1,s)?(l=(i=t).Params[0],this.ComputeElement(l,a,{},null),0 in a.Flags&&(2===a.BaseType?this.IsDynArray(a.LoTypeEl,!0)&&(n=0):a.BaseType in rtl.createSet(35,36)&&(n=0)),2147483647===n?this.CheckRaiseTypeArgNo(20170329153951,1,l,a,"dynamic array",s):1===rtl.length(i.Params)?0:(l=i.Params[1],this.ComputeElement(l,a,{},null),0 in a.Flags&&a.BaseType in r.btAllInteger?2===rtl.length(i.Params)?0:(l=i.Params[2],this.ComputeElement(l,a,{},null),0 in a.Flags&&a.BaseType in r.btAllInteger?n=this.CheckBuiltInMaxParamCount(e,i,3,s,""):this.CheckRaiseTypeArgNo(20170329164329,3,l,a,"integer",s)):this.CheckRaiseTypeArgNo(20170329164210,2,l,a,"integer",s))):n},this.BI_CopyArray_OnGetCallResult=function(e,t,s){this.ComputeElement(t.Params[0],s,{},null),s.Flags=rtl.diffSet(s.Flags,rtl.createSet(1)),s.ExprEl=t,s.IdentEl=null,36===s.BaseType&&(s.BaseType=35)},this.BI_InsertArray_OnGetCallCompatibility=function(e,t,s){var i,n,l,a,o=0,h=null,u=q.$new(),c=q.$new(),p=q.$new();return o=2147483647,this.CheckBuiltInMinParamCount(e,t,3,s)?(n=(i=t).Params[0],this.ComputeElement(n,u,{},null),0 in u.Flags?(h=i.Params[1],this.ComputeElement(h,c,{},null),this.ResolvedElCanBeVarParam(c,t,!0)?2===c.BaseType&&this.IsDynArray(c.LoTypeEl,!0)?(l=c.LoTypeEl,a=this.GetArrayElType(l),this.ComputeElement(a,p,rtl.createSet(4),null),2147483647===this.CheckAssignResCompatibility(p,u,n,s)?2147483647:(h=i.Params[2],this.ComputeElement(h,c,{},null),0 in c.Flags&&c.BaseType in r.btAllInteger?o=this.CheckBuiltInMaxParamCount(e,i,3,s,""):this.CheckRaiseTypeArgNo(20170329172348,3,h,c,"integer",s))):this.CheckRaiseTypeArgNo(20170329172024,2,h,c,"dynamic array",s):(s&&this.RaiseVarExpected(20170329171514,h,c.IdentEl),o)):this.CheckRaiseTypeArgNo(20170329171400,1,n,u,"value",s)):o},this.BI_InsertArray_OnFinishParamsExpr=function(e,t){var s,i,r,n=q.$new(),l=q.$new(),a=null;i=(s=t.Params)[0],r=s[1],this.FinishCallArgAccess(i,1),this.FinishCallArgAccess(r,4),this.FinishCallArgAccess(s[2],1),Dt.isPrototypeOf(i)||(this.ComputeElement(r,n,{},null),2===n.BaseType&&this.IsDynArray(n.LoTypeEl,!0)||this.RaiseNotYetImplemented(20180622144039,r,""),a=this.GetArrayElType(n.LoTypeEl),this.ComputeElement(a,l,rtl.createSet(4),null),2===l.BaseType&&l.LoTypeEl.$class.ClassType()===Ue&&this.MarkArrayExprRecursive(i,l.LoTypeEl))},this.BI_DeleteArray_OnGetCallCompatibility=function(e,t,s){var i,n=0,l=null,a=q.$new();return n=2147483647,this.CheckBuiltInMinParamCount(e,t,3,s)?(l=(i=t).Params[0],this.ComputeElement(l,a,{},null),this.ResolvedElCanBeVarParam(a,t,!0)?2===a.BaseType&&this.IsDynArray(a.LoTypeEl,!0)?(l=i.Params[1],this.ComputeElement(l,a,{},null),0 in a.Flags&&a.BaseType in r.btAllInteger?(l=i.Params[2],this.ComputeElement(l,a,{},null),0 in a.Flags&&a.BaseType in r.btAllInteger?n=this.CheckBuiltInMaxParamCount(e,i,3,s,""):this.CheckRaiseTypeArgNo(20170329172348,3,l,a,"integer",s)):this.CheckRaiseTypeArgNo(20170329173613,2,l,a,"integer",s)):this.CheckRaiseTypeArgNo(20170329173434,1,l,a,"dynamic array",s):(s&&this.RaiseVarExpected(20170329173421,l,a.IdentEl),n)):n},this.BI_DeleteArray_OnFinishParamsExpr=function(e,t){var s;s=t.Params,rtl.length(s),this.FinishCallArgAccess(s[0],4),this.FinishCallArgAccess(s[1],1),this.FinishCallArgAccess(s[2],1)},this.BI_TypeInfo_OnGetCallCompatibility=function(e,t,s){var i,r,n=0,l=null,a=q.$new();return n=2147483647,this.CheckBuiltInMinParamCount(e,t,1,s)?(r=(i=t).Params[0],null===(l=this.GetTypeInfoParamType(r,a,!0))&&this.RaiseMsg(20170411100259,3055,rtl.getResStr(Ce,"sTypeIdentifierExpected"),[],r),l=this.ResolveAliasType(l,!0),this.HasTypeInfo(l)||this.RaiseMsg(20170413200118,3053,rtl.getResStr(Ce,"sSymbolCannotBePublished"),[],r),n=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):n},this.BI_TypeInfo_OnGetCallResult=function(e,t,s){r.SetResolverTypeExpr(s,29,this.FBaseTypes[29],this.FBaseTypes[29],rtl.createSet(0))},this.BI_GetTypeKind_OnGetCallCompatibility=function(e,t,s){var i,r,n=0,l=q.$new();return n=2147483647,this.CheckBuiltInMinParamCount(e,t,1,s)?(r=(i=t).Params[0],null===this.GetTypeInfoParamType(r,l,!0)&&this.RaiseMsg(20200826205441,3055,rtl.getResStr(Ce,"sTypeIdentifierExpected"),[],r),n=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):n},this.BI_GetTypeKind_OnGetCallResult=function(e,t,s){var i,n;i=this.FindSystemIdentifier("system","ttypekind",t),Ge.isPrototypeOf(i)||this.RaiseXExpectedButYFound(20200826211458,"enum type System.TTypeKind",r.GetElementTypeName(i),t),n=i,r.SetResolverTypeExpr(s,2,n,n,rtl.createSet(0))},this.BI_GetTypeKind_OnEval=function(e,t,s,i){var n,l=null,a=null,o=null,h=null,u=0,c=null,p="",f=0,d=q.$new();if(i.set(null),p="tkUnknown",(o=(l=this.GetTypeInfoParamType(t.Params[0],d,!0)).$class.ClassType())===Ge)p="tkEnumeration";else if(o===lt)p="tkSet";else if(o===Me)p="tkRecord";else if(o===$e){var F=(h=l).ObjKind;if(0===F)p="tkObject";else if(2===F){p=0===h.InterfaceType?"tkInterface":"tkInterfaceRaw"}else p=3===F||4===F||5===F?"tkHelper":"tkClass"}else if(o===Le)p="tkClassRef";else if(o.InheritsFrom(xe))p="tkMethod";else if(o.InheritsFrom(we))p="tkProcVar";else{u=d.BaseType;5===u||6===u?p="tkWChar":7===u?p="tkUString":8===u?p="tkWString":9===u?p="tkUString":29===u?p="tkPointer":u in r.btAllBooleans?p="tkBool":u in r.btAllInteger?p="tkInteger":u in r.btAllFloats&&(p="tkFloat")}n=this.FindSystemIdentifier("system","ttypekind",t);for(var m=0,C=(a=rtl.as(n,Ge)).Values.FCount-1;m<=C;m++)if(f=m,c=rtl.getObject(a.Values.Get(f)),nt(p,c.FName))return void i.set(hs.$create("CreateValue",[f,c]));rtl.eqSet(s,{})},this.BI_Assert_OnGetCallCompatibility=function(e,t,s){var i,n=null,l=q.$new();return this.CheckBuiltInMinParamCount(e,t,1,s)?(n=(i=t).Params[0],this.ComputeElement(n,l,{},null),0 in l.Flags&&l.BaseType in r.btAllBooleans?rtl.length(i.Params)>1&&(n=i.Params[1],this.ComputeElement(n,l,{},null),!(0 in l.Flags)||!(l.BaseType in r.btAllStringAndChars))?this.CheckRaiseTypeArgNo(20180117123932,2,n,l,"string",s):this.CheckBuiltInMaxParamCount(e,i,2,s,""):this.CheckRaiseTypeArgNo(20180117123819,1,n,l,"boolean",s)):2147483647},this.BI_Assert_OnFinishParamsExpr=function(e,t){this.FinishAssertCall(e,t)},this.BI_New_OnGetCallCompatibility=function(e,t,s){var i,r,n=0,l=null,a=q.$new();return this.CheckBuiltInMinParamCount(e,t,1,s)?(r=(i=t).Params[0],this.ComputeElement(r,a,rtl.createSet(1),null),n=2147483647,this.ResolvedElCanBeVarParam(a,t,!0)?(2===a.BaseType&&(l=a.LoTypeEl).$class.ClassType()===Be&&this.ResolveAliasType(l.DestType,!0).$class.ClassType()===Me&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20180425005421,1,r,a,"pointer of record",s):n=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):(s&&this.RaiseVarExpected(20180425005303,t,a.IdentEl),n)):2147483647},this.BI_New_OnFinishParamsExpr=function(e,t){this.FinishCallArgAccess(t.Params[0],5)},this.BI_Dispose_OnGetCallCompatibility=function(e,t,s){var i,r,n=0,l=null,a=q.$new();return this.CheckBuiltInMinParamCount(e,t,1,s)?(r=(i=t).Params[0],this.ComputeElement(r,a,rtl.createSet(1),null),n=2147483647,0 in a.Flags&&2===a.BaseType&&(l=a.LoTypeEl).$class.ClassType()===Be&&this.ResolveAliasType(l.DestType,!0).$class.ClassType()===Me&&(n=0),2147483647===n?this.CheckRaiseTypeArgNo(20180425010620,1,r,a,"pointer of record",s):n=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):2147483647},this.BI_Dispose_OnFinishParamsExpr=function(e,t){this.FinishCallArgAccess(t.Params[0],1)},this.BI_Default_OnGetCallCompatibility=function(e,t,s){var i,r,n=0,l=q.$new(),a=null,o=null;return n=2147483647,this.CheckBuiltInMinParamCount(e,t,1,s)?(r=(i=t).Params[0],this.ComputeElement(r,l,rtl.createSet(1),null),o=null,null!==(a=l.IdentEl)&&null!==l.LoTypeEl&&(De.isPrototypeOf(a)?o=a:He.isPrototypeOf(a)?o=a.VarType:a.$class.ClassType()===We&&(o=a.ArgType)),null===o&&this.RaiseMsg(20180501004009,3055,rtl.getResStr(Ce,"sTypeIdentifierExpected"),[],r),n=this.CheckBuiltInMaxParamCount(e,i,1,s,"")):n},this.BI_Default_OnGetCallResult=function(e,t,s){var i;i=t.Params[0],this.ComputeElement(i,s,rtl.createSet(1),null),s.Flags=rtl.createSet(0),s.IdentEl=null},this.BI_Default_OnEval=function(e,t,s,i){var n,l=q.$new(),a=null,o=null,h=0,u=null,c=0,p=0,f=0;i.set(null),n=t.Params[0],this.ComputeElement(n,l,rtl.createSet(1),null),a=l.LoTypeEl,2===l.BaseType?a.$class.ClassType()===Ue?(this.RaiseNotYetImplemented(20180501005214,n,""),u=a,rtl.length(u.Ranges)):a.$class.ClassType()===lt?(a=a.EnumType).$class.ClassType()===Ge?(o=a.EnumType,i.set(xt.$create("CreateEmpty",[1,o]))):this.RaiseNotYetImplemented(20180501005348,t,""):a.$class.ClassType()===Ge&&(o=a,h=0,i.set(hs.$create("CreateValue",[h,rtl.getObject(o.Values.Get(h))]))):me.isPrototypeOf(a)&&Z.isPrototypeOf(a.FData)?(c=a.FData.BaseType,(c=this.GetActualBaseType(c))in r.btAllBooleans?i.set(fs.$create("CreateValue",[!1])):c in r.btAllIntegerNoQWord&&this.GetIntegerRange(c,{get:function(){return p},set:function(e){p=e}},{get:function(){return f},set:function(e){f=e}})?i.set(us.$create("CreateValue",[p])):c in rtl.createSet(9,8)?i.set(ds.$create("CreateValue",[""])):6===c?i.set(ds.$create("CreateValue",["\0"])):c in r.btAllFloats?i.set(cs.$create("CreateValue",[0])):this.RaiseNotYetImplemented(20180501005645,t,"")):Je.isPrototypeOf(l.LoTypeEl)?i.set(this.EvalRangeLimit(a.RangeExpr,rtl.refSet(s),!0,n)):34===l.BaseType?2===l.SubType?l.LoTypeEl.$class.ClassType()===Ge?i.set(xt.$create("CreateEmpty",[1,l.LoTypeEl])):this.RaiseNotYetImplemented(20180501125138,n,""):this.RaiseNotYetImplemented(20180501125014,n,""):this.RaiseNotYetImplemented(20180501004839,n,"")},this.Create$2=function(){return Oe.Create$1.call(this),this.FDefaultScope=S.$create("Create$1"),this.FPendingForwardProcs=ge.$create("Create"),this.FBaseTypeChar=6,this.FBaseTypeString=9,this.FBaseTypeExtended=11,this.FBaseTypeLength=28,this.FDynArrayMinIndex=0,this.FDynArrayMaxIndex=9007199254740991,this.cTGUIDToString=10001,this.cStringToTGUID=10001,this.cInterfaceToTGUID=10001,this.cInterfaceToString=10002,this.FScopeClass_Array=v,this.FScopeClass_Class=O,this.FScopeClass_InitialFinalization=E,this.FScopeClass_Module=F,this.FScopeClass_Proc=$,this.FScopeClass_ProcType=A,this.FScopeClass_Record=x,this.FScopeClass_Section=g,this.FScopeClass_WithExpr=B,this.fExprEvaluator=Rs.$create("Create$1"),this.fExprEvaluator.FOnLog=rtl.createCallback(this,"OnExprEvalLog"),this.fExprEvaluator.FOnEvalIdentifier=rtl.createCallback(this,"OnExprEvalIdentifier"),this.fExprEvaluator.FOnEvalParams=rtl.createCallback(this,"OnExprEvalParams"),this.fExprEvaluator.FOnRangeCheckEl=rtl.createCallback(this,"OnRangeCheckEl"),this.PushScope(this.FDefaultScope),this},this.Destroy=function(){this.Clear(),this.PopScope(),Ee({p:this,get:function(){return this.p.FPendingForwardProcs},set:function(e){this.p.FPendingForwardProcs=e}}),Ee({p:this,get:function(){return this.p.fExprEvaluator},set:function(e){this.p.fExprEvaluator=e}}),this.ClearBuiltInIdentifiers(),Oe.Destroy.call(this)},this.Clear=function(){for(r.ClearHelperList({p:this,get:function(){return this.p.FActiveHelpers},set:function(e){this.p.FActiveHelpers=e}}),this.RestoreStashedScopes(0);this.FScopeCount>0&&this.FTopScope!==this.FDefaultScope;)this.PopScope();this.ClearResolveDataList(1)},this.CreateElement$1=function(e,t,s,i,r,n){var l=null,a=de.$new();return l=this.FCurrentParser.FScanner,""===r||this.FStoreSrcColumns?(a.FileName=l.FCurFilename,a.Row=l.FCurRow,a.Column=l.GetCurColumn()):(a.FileName=r,a.Row=n,a.Column=0),this.CreateElement$2(e,t,s,i,a,null)},this.CreateElement$2=function(e,t,s,i,r,n){var l=null,o=null,h=0,u=null;return l=null,null===s&&null!==this.FRootElement&&this.RaiseInternalError(20160922163535,'more than one root element Class="'+e.$classname+'" Root='+ye(this.FRootElement)),""===r.FileName&&this.RaiseInternalError(20160922163541,"missing filename"),h=r.Row,this.FStoreSrcColumns&&(h=this.$class.MangleSourceLineNumber(h,r.Column)),e===vs&&this.RaiseInternalError(20190131154235,""),o=this.CreateOwnedElement(e,t,s),this.FLastElement=o,o.Visibility=i,o.SourceFilename=r.FileName,o.SourceLinenumber=h,null===this.FRootElement?(this.SetRootElement(rtl.as(o,Ie)),0===this.FStep&&(this.FStep=1)):st.isPrototypeOf(s)&&0===s.Declarations.FCount&&((u=s.FData).BoolSwitches=rtl.refSet(this.FCurrentParser.FScanner.FCurrentBoolSwitches),u.ModeSwitches=rtl.refSet(this.FCurrentParser.FScanner.FCurrentModeSwitches)),this.IsElementSkipped(o)?l:(e.InheritsFrom(Yt)||(e===He||e===it?this.AddVariable(o):e===ys?this.AddResourceString(o):e===ve?this.AddProperty(o):e===We?this.AddArgument(o):e===Ge?this.AddEnumType(o):e===Qe?this.AddEnumValue(o):e===a||(e===qt||e===Qt||e===Le||e===Be||e===lt||e===Je||e===Kt?this.AddType(o):e===Ue?this.AddArrayType(o,n):e===we||e===Ve?this.AddProcedureType(o,n):e===je?this.AddGenericTemplateType(o):e===ms?(this.AddType(o),this.RaiseMsg(20170419203043,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(9,"["),o)):e===Me?this.AddRecordType(o,n):e===rt?this.AddRecordVariant(o):e===$e?this.AddClassType(o,n):e.InheritsFrom(xe)?this.AddProcedure(o,n):e===$t?this.AddFunctionResult(o):e===Ne?this.AddProcedureBody(o):e===Zt||(e===It?this.AddExceptOn(o):e===Nt?this.AddWithDo(o):e===gt||e===As||(e===Ke||e===Xe||e===Ns||e===xs?this.AddSection(o):e===Ie||e===Ze||e===et?this.AddModule(o):e===Re||(e===bs||e===Os?this.AddInitialFinalizationSection(o):e===vt||e.InheritsFrom(mt)||e===_t||(e===ls?this.AddExportSymbol(o):e===ks?this.RaiseMsg(20171018121900,3073,rtl.getResStr(Ce,"sCantFindUnitX"),Ye(18,t),o):this.RaiseNotYetImplemented(20160922163544,o,""))))))),l=o)},this.CreateOwnedElement=function(e,t,s){var i;return i=e.$create("Create$1",[t,s]),this.FOwnedElements.Add(i),i},this.FindModule$1=function(e,t,s){var i,r="",n="";return null!==s&&(""===(r=this.GetUsesUnitInFilename(s))&&this.RaiseXExpectedButYFound(20180222001220,"file path","empty string",s),3 in this.FCurrentParser.GetCurrentModeSwitches()&&(n=$s(Ds(r),""),0!==Pe(e,n)&&this.RaiseXExpectedButYFound(20180222230400,e,n,s))),null===(i=this.FindUnit(e,r,t,s))&&(null!==s?this.RaiseMsg(20180223140434,3073,rtl.getResStr(Ce,"sCantFindUnitX"),Ye(18,r),s):this.RaiseMsg(20180223140409,3073,rtl.getResStr(Ce,"sCantFindUnitX"),Ye(18,e),t)),i},this.FindElement=function(e){return this.FindElementFor(e,null,0)},this.FindElementFor=function(e,t,s){var i=this,n=null;function l(e){null!==e.GenericTemplateTypes&&0!==e.GenericTemplateTypes.FCount&&(!(3 in i.FCurrentParser.GetCurrentModeSwitches())&&null!==t&&t.HasParent(e)||i.RaiseMsg(20201129005025,3131,rtl.getResStr(Ce,"sGenericsWithoutSpecializationAsType"),Ye(18,"variable"),n))}var a=0,o="",h="",u="",c=!1,p=null,f=null,d=null,F=null,m=0,C=null,S=null,T=te.$new();for(n=null,o=e,u="",a=1,p=null;;){if((a=Wt(".",o))<1?(h=o,o=""):(h=pt(o,a-1),ct({get:function(){return o},set:function(e){o=e}},1,a),""===o&&this.RaiseMsg(20170328003146,3044,rtl.getResStr(Ce,"sIllegalExpression"),[],n)),u=""===u?h:u+"."+h,null!==p?(c=!0,De.isPrototypeOf(p)?(ke.isPrototypeOf(p)&&!this.IsFullySpecialized(p)&&this.RaiseMsg(20200217131215,3131,rtl.getResStr(Ce,"sGenericsWithoutSpecializationAsType"),Ye(18,"reference"),n),$e.isPrototypeOf(p)&&p.IsForward&&this.RaiseMsg(20220527113900,3001,rtl.getResStr(Ce,"sIdentifierNotFound"),Ye(18,h),n),null===(S=this.PushDotScope(p))&&this.RaiseMsg(20190122122529,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,".",18,u),n),S.OnlyTypeMembers=!0):Ie.isPrototypeOf(p)?this.PushModuleDotScope(p):this.RaiseMsg(20170504174021,3084,rtl.getResStr(Ce,"sIllegalQualifierAfter"),Ye(9,".",18,u),n)):c=!1,""===o&&s>0?(f=this.FindGenericEl(h,s,T,n),null!==T.StartScope&&T.StartScope.$class.ClassType()===this.FScopeClass_WithExpr&&0 in T.StartScope.Flags&&this.RaiseInternalError(20190801104033,"")):(f=this.FindElementWithoutParams(h,n,!0,!0),ke.isPrototypeOf(f)&&""===o&&l(f)),null===f&&this.RaiseIdentifierNotFound(20201129004745,h,n),Ie.isPrototypeOf(f))Ie.isPrototypeOf(p)&&this.RaiseXExpectedButYFound(20170328001619,"class",r.GetElementTypeName(f)+" "+f.FName,n),Wt(".",f.FName)>0&&(0!==Pe(f.FName+".",pt(e,f.FName.length+1))&&(0===Pe(f.FName,e)?this.RaiseXExpectedButYFound(20170504165825,"type",r.GetElementTypeName(f),n):this.RaiseIdentifierNotFound(20170504165412,e,n)),o=Fs(e,f.FName.length+2,e.length)),p=f;else if(f.$class.ClassType()===Re){for(F=rtl.as(f.FParent,st),m=rtl.length(F.UsesClause)-1,d=null;m>=0;)if(h=(C=F.UsesClause[m]).FName,r.IsDottedIdentifierPrefix(h,e)&&(null===d||h.length>d.FName.length)&&(d=C),(m-=1)<0&&F.$class.ClassType()===Xe){if(null===(F=rtl.as(F.FParent,Ie).InterfaceSection))break;m=rtl.length(F.UsesClause)-1}h=this.FRootElement.FName,r.IsDottedIdentifierPrefix(h,e)&&(null===d||h.length>d.FName.length)&&(d=this.FRootElement),null===d&&this.RaiseIdentifierNotFound(20170504172440,e,n),o=Fs(e,d.FName.length+2,e.length),p=d.$class.ClassType()===Re?d.Module:d}else p=f;if(c&&this.PopScope(),""===o)return f}return null},this.FindElementWithoutParams=function(e,t,s,i){var r,n=te.$new();return r=this.FindElementWithoutParams$1(e,n,t,s,i),null===n.Found||(this.CheckFoundElement(n,null),null!==n.StartScope&&n.StartScope.$class.ClassType()===this.FScopeClass_WithExpr&&0 in n.StartScope.Flags&&this.RaiseInternalError(20160923111727,"")),r},this.FindElementWithoutParams$1=function(e,t,s,i,r){var n=null,l=!1;if(n=null,l=!1,t.$assign(te.$new()),t.ErrorPosEl=s,t.SkipGenerics=r,this.IterateElements(e,rtl.createCallback(this,"OnFindFirst_PreferNoParams"),t,{get:function(){return l},set:function(e){l=e}}),null===(n=t.Found)){if(null===s&&null!==this.FLastElement){if(this.FLastElement.$class.ClassType()===Le&&null===this.FLastElement.DestType)return n=this.CreateElement$2(a,e,this.FLastElement,0,this.FCurrentParser.CurSourcePos(),null);if(this.FLastElement.$class.ClassType()===Be&&null===this.FLastElement.DestType)return n=this.CreateElement$2(a,e,this.FLastElement,0,this.FCurrentParser.CurSourcePos(),null)}this.RaiseIdentifierNotFound(20170216152722,e,s)}return i&&xe.isPrototypeOf(n)&&this.ProcNeedsParams(n.ProcType)&&this.RaiseMsg(20170216152347,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,this.GetProcTypeDescription(n.ProcType,rtl.createSet(0,2))),s),n},this.FindFirstEl=function(e,t,s){var i=!1;return i=!1,t.$assign(te.$new()),t.ErrorPosEl=s,this.IterateElements(e,rtl.createCallback(this,"OnFindFirst"),t,{get:function(){return i},set:function(e){i=e}}),t.Found},this.FindLongestUnitName=function(e,t){var s=null,i=null,n="",l="",a=[],o=null,h=null;for(Re.isPrototypeOf(e.get())||this.RaiseInternalError(20170503000945,""),""===(n=this.GetNameExprValue(t))&&this.RaiseNotYetImplemented(20170503110217,t,""),h=t;;){if(null===(h=this.GetNextDottedExpr(h)))break;""===(l=this.GetNameExprValue(h))&&this.RaiseNotYetImplemented(20170502164242,h,""),n=n+"."+l}i=null,o=rtl.as(e.get().FParent,st);do{a=o.UsesClause;for(var u=0,c=rtl.length(a)-1;u<=c;u++)l=(s=a[u]).FName,r.IsDottedIdentifierPrefix(l,n)&&(null===i||l.length>i.FName.length)&&(i=s);if(!Xe.isPrototypeOf(o))break;o=rtl.as(o.FParent,Ie).InterfaceSection}while(null!==o);l=e.get().GetModule().FName,r.IsDottedIdentifierPrefix(l,n)&&(null===i||l.length>i.FName.length)&&(i=e.get().GetModule()),null===i&&this.RaiseIdentifierNotFound(20170503140643,this.GetNameExprValue(t),t),e.set(i)},this.FindGenericEl=function(e,t,s,i){var r,n=se.$new(),l=!1;return n.$assign(se.$new()),n.TemplateCount=t,n.Find.ErrorPosEl=i,l=!1,this.IterateElements(e,rtl.createCallback(this,"OnFindFirst_GenericEl"),n,{get:function(){return l},set:function(e){l=e}}),s.$assign(n.Find),null===(r=s.Found)&&this.RaiseMsg(20190801104759,3001,rtl.getResStr(Ce,"sIdentifierNotFound"),Ye(18,e+ot(t)),i),this.CheckFoundElement(s,null),r},this.IterateElements=function(e,t,s,i){for(var r=0,n=null,l=this.FScopeCount-1;l>=0;l--){if(r=l,(n=this.GetScopes(r)).IterateElements(e,n,t,s,i),i.get())return;if(w.isPrototypeOf(n))break}},this.IterateGlobalElements=function(e,t,s,i){var r=0,n=null,l=null;for(r=0;r<this.FScopeCount&&((l=(n=this.GetScopes(r)).$class.ClassType()).InheritsFrom(S)||l.InheritsFrom(F)||l.InheritsFrom(g));)r+=1;for(;r>0;)if(r-=1,(n=this.GetScopes(r)).IterateElements(e,n,t,s,i),i.get())return},this.CheckFoundElement=function(e,t){function s(e){var t=null;return(t=e.FDeclaration).$class.ClassType()===He&&rtl.eqSet(rtl.intersectSet(t.VarModifiers,rtl.createSet(4,5)),{})}var i=null,n=null,l=!1,a=!1,o=null,h=null,u=0,c=[],p=null;if(n=e.StartScope,l=!1,a=!1,V.isPrototypeOf(n)?(l=n.OnlyTypeMembers,n.$class.ClassType()===H&&(a=n.IsClassOf),null!==t&&(t.Flags=rtl.includeSet(t.Flags,0),n.ConstParent&&s(t)&&(t.Flags=rtl.includeSet(t.Flags,6)))):n.$class.ClassType()===this.FScopeClass_WithExpr?(l=1 in n.Flags,a=2 in n.Flags,null!==t&&(t.Flags=rtl.includeSet(t.Flags,0),3 in n.Flags&&s(t)&&(t.Flags=rtl.includeSet(t.Flags,6)))):n.$class.ClassType()===this.FScopeClass_Proc?(i=rtl.as(n.FElement,xe),e.ElScope!==n&&this.IsClassMethod(i)&&(l=!0)):n.$class.ClassType()===k&&(l=n.OnlyTypeMembers),l?e.Found.$class.ClassType()===_e||this.IsClassMethod(e.Found)||He.isPrototypeOf(e.Found)&&4 in e.Found.VarModifiers||De.isPrototypeOf(e.Found)||Qe.isPrototypeOf(e.Found)||this.RaiseMsg(20170216152348,3032,rtl.getResStr(Ce,"sInstanceMemberXInaccessible"),Ye(18,e.Found.FName),e.ErrorPosEl):4 in this.FOptions&&H.isPrototypeOf(n)&&n.ClassRecScope.FElement.IsExternal&&((o=e.Found.$class.ClassType())===xe||o===qe||o===it||(o!==He&&o!==ve||4 in e.Found.VarModifiers)&&(this.IsHelper(e.Found.FParent)||this.RaiseMsg(20170331184224,3051,rtl.getResStr(Ce,"sExternalClassInstanceCannotAccessStaticX"),Ye(18,r.GetElementTypeName(e.Found)+" "+e.Found.FName),e.ErrorPosEl))),xe.isPrototypeOf(e.Found)){if(((i=e.Found).IsVirtual()||i.IsOverride())&&(n.$class.ClassType()===W?i.IsAbstract()&&this.RaiseMsg(20170216152352,3030,rtl.getResStr(Ce,"sAbstractMethodsCannotBeCalledDirectly"),[],e.ErrorPosEl):null!==t&&(t.Flags=rtl.unionSet(t.Flags,rtl.createSet(5)))),i.$class.ClassType()===_e&&null!==t)if(l&&(t.Flags=rtl.diffSet(rtl.unionSet(t.Flags,rtl.createSet(3)),rtl.createSet(6))),null!==t.Context&&this.RaiseInternalError(20170131141936,""),t.Context=K.$create("Create"),p=null,h=null,(o=n.$class.ClassType()).InheritsFrom(j)?h=n.ClassRecScope:o===this.FScopeClass_WithExpr?null===(h=n.ClassRecScope)&&(p=rtl.as(n.Scope.FElement,De)):o===this.FScopeClass_Proc?h=n.ClassRecScope:o===Y?p=rtl.as(r.NoNil(n.FElement),De):this.RaiseInternalError(20170131150855,ye(n)),null!==p)t.Context.Typ=p;else if(null===h&&this.RaiseInternalError(20190123120156,ye(n)),(p=rtl.as(h.FElement,ze)).$class.ClassType()===$e&&null!==p.HelperForType&&(p=rtl.as(this.ResolveAliasType(p.HelperForType,!0),De)),t.Context.Typ=p,l&&O.isPrototypeOf(h))if(p.$class.ClassType()===$e&&p.IsAbstract())this.LogMsg(20190224153450,2,3123,rtl.getResStr(Ce,"sCreatingAnInstanceOfAbstractClassY"),Ye(18,p.FName),e.ErrorPosEl);else if(c=h.AbstractProcs,rtl.length(c)>0)if(a);else for(var f=0,d=rtl.length(c)-1;f<=d;f++)u=f,this.LogMsg(20171227110746,2,4046,rtl.getResStr(Ce,"sConstructingClassXWithAbstractMethodY"),Ye(18,p.FName,18,c[u].FName),e.ErrorPosEl);i.$class.ClassType()===es&&null!==t&&(W.isPrototypeOf(n)||(t.Flags=rtl.unionSet(t.Flags,rtl.createSet(4))))}this.CheckFoundElementVisibility(e,t)},this.CheckFoundElementVisibility=function(e,t){var s=null,i=null,r=null;if(e.Found.Visibility in rtl.createSet(1,2,6,7)){s=this.GetVisibilityContext(),i=rtl.as(e.Found.FParent,ze);var n=e.Found.Visibility;1===n?i.GetModule()!==s.GetModule()&&this.RaiseMsg(20170216152354,3045,rtl.getResStr(Ce,"sCantAccessXMember"),Ye(18,"private",18,e.Found.FName),e.ErrorPosEl):2===n?(r=this.FTopScope,i.GetModule()===s.GetModule()||De.isPrototypeOf(s)&&2147483647!==this.CheckClassIsClass(s,i)||j.isPrototypeOf(r)&&r.ClassRecScope.FElement.GetModule()===s.GetModule()||B.isPrototypeOf(r)&&null!==r.Scope.FElement&&r.Scope.FElement.GetModule()===s.GetModule()||this.RaiseMsg(20170216152356,3045,rtl.getResStr(Ce,"sCantAccessXMember"),Ye(18,"protected",18,e.Found.FName),e.ErrorPosEl)):6===n?s!==i&&this.RaiseMsg(20170216152357,3045,rtl.getResStr(Ce,"sCantAccessXMember"),Ye(18,"strict private",18,e.Found.FName),e.ErrorPosEl):7===n&&(De.isPrototypeOf(s)&&2147483647!==this.CheckClassIsClass(s,i)||this.RaiseMsg(20170216152400,3045,rtl.getResStr(Ce,"sCantAccessXMember"),Ye(18,"strict protected",18,e.Found.FName),e.ErrorPosEl))}},this.GetVisibilityContext=function(){for(var e=null,t=0,s=this.FScopeCount-1;s>=0;s--)if(t=s,null!==(e=this.GetScopes(t).VisibilityContext))return e;return e=null},this.BeginScope=function(e,t){var s=e;7===s?this.PushParserSpecializeType(rtl.as(t,Kt)):8===s?this.PushWithExprScope(rtl.as(t,Yt)):this.RaiseMsg(20181210163324,3002,rtl.getResStr(Ce,"sNotYetImplemented")+" BeginScope",Ye(18,Ae(e)),null)},this.FinishScope=function(e,t){if(!this.IsElementSkipped(t)){var s=e;0===s?this.FinishModule(rtl.as(t,Ie)):1===s?this.FinishUsesClause():2===s?this.FinishTypeSection(t):3===s?this.FinishTypeDef(rtl.as(t,De)):4===s?this.FinishResourcestring(rtl.as(t,ys)):5===s?this.FinishProcedure(rtl.as(t,xe)):6===s?this.FinishProcedureType(rtl.as(t,we)):7===s?this.FinishParserSpecializeType(rtl.as(t,Kt)):8===s?this.FinishWithDo(rtl.as(t,Nt)):9===s?this.FinishExceptOnExpr():10===s?this.FinishExceptOnStatement():11===s?this.FinishForLoopHeader(rtl.as(t,Et)):12===s?this.FinishDeclaration(t):13===s?this.FinishAncestors(rtl.as(t,$e)):14===s?this.FinishInitialFinalization(rtl.as(t,mt)):this.RaiseMsg(20170216152401,3002,rtl.getResStr(Ce,"sNotYetImplemented")+" FinishScope",Ye(18,Ae(e)),null)}},this.FinishTypeAlias=function(e){var t,s,i=null,n=null,l=null,a=null;s=e.get().DestType,t=r.ResolveSimpleAliasType(s),$e.isPrototypeOf(t)&&(i=t,a=this.GetLocalScope(),rtl.as(a,C).RemoveLocalIdentifier(e.get()),(n=this.CreateElement$1($e,e.get().FName,e.get().FParent,e.get().Visibility,e.get().SourceFilename,e.get().SourceLinenumber)).ObjKind=i.ObjKind,n.RTTIVisibility.$assign(i.RTTIVisibility),l=e.get(),e.set(n),l.DestType=null,n.AncestorType=s,this.FinishScope(13,n))},this.IsUnitIntfFinished=function(e){var t;return null!==(t=e.InterfaceSection)&&g.isPrototypeOf(t.FData)&&t.FData.Finished},this.NotifyPendingUsedInterfaces=function(){var e=null,t=0,s=null,i=null;for(t=(e=rtl.as(this.FRootElement.FData,F)).PendingResolvers.FCount-1;t>=0;)null===(i=(s=rtl.as(rtl.getObject(e.PendingResolvers.Get(t)),re)).GetLastSection())&&this.RaiseInternalError(20180305141421,""),s.CheckPendingUsedInterface(i),(t-=1)>=e.PendingResolvers.FCount&&(t=e.PendingResolvers.FCount-1)},this.GetPendingUsedInterface=function(e){var t=0,s=null;for(var i=0,r=rtl.length(e.UsesClause)-1;i<=r;i++)if(t=i,s=e.UsesClause[t],Ie.isPrototypeOf(s.Module)&&!this.IsUnitIntfFinished(s.Module))return s;return null},this.CheckPendingUsedInterface=function(e){var t,s=!1,i=null,n=null;if(t=null!==e.PendingUsedIntf){if(i=rtl.as(e.PendingUsedIntf.Module,Ie),!this.IsUnitIntfFinished(i))return s;rtl.as(r.NoNil(i.FData),F).PendingResolvers.Remove(this),e.PendingUsedIntf=null}return e.PendingUsedIntf=this.GetPendingUsedInterface(e),null!==e.PendingUsedIntf?(i=rtl.as(e.PendingUsedIntf.Module,Ie),(n=rtl.as(r.NoNil(i.FData),F).PendingResolvers).IndexOf(this)<0&&n.Add(this),s=!t):(s=t)&&this.UsedInterfacesFinished(e),s},this.UsedInterfacesFinished=function(e){this.FCurrentParser.ParseContinue()},this.NeedArrayValues=function(e){var t,s=!1,i=null;if(s=!1,null===e)return s;if((t=e.$class.ClassType())===it||t===He){if(null===(i=e).VarType)return s;s=this.ResolveAliasType(i.VarType,!0).$class.ClassType()===Ue}return s},this.GetDefaultClassVisibility=function(e){return null===e.FData?0:2 in rtl.as(e.FData,O).Flags?4:3},this.ModeChanged=function(e,t,s,i){Oe.ModeChanged.call(this,e,t,s,i),s||st.isPrototypeOf(this.FLastElement)&&(this.FLastElement.FData.ModeSwitches=rtl.refSet(this.FCurrentParser.GetCurrentModeSwitches()))},this.ClearBuiltInIdentifiers=function(){var e=0,t=0;this.ClearResolveDataList(0);for(var s=0;s<=37;s++)e=s,this.FBaseTypes[e]=null;for(var i=0;i<=33;i++)t=i,this.FBuiltInProcs[t]=null},this.AddObjFPCBuiltInIdentifiers=function(e,t){var s=0;for(var i in e)s=+i,this.AddBaseType(this.GetBaseTypeNames(s),s);1 in t&&this.AddBuiltInProc("Length","function Length(const String or Array): sizeint",rtl.createCallback(this,"BI_Length_OnGetCallCompatibility"),rtl.createCallback(this,"BI_Length_OnGetCallResult"),rtl.createCallback(this,"BI_Length_OnEval"),null,1,{}),2 in t&&this.AddBuiltInProc("SetLength","procedure SetLength(var String or Array; NewLength: sizeint)",rtl.createCallback(this,"BI_SetLength_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_SetLength_OnFinishParamsExpr"),2,rtl.createSet(0)),3 in t&&this.AddBuiltInProc("Include","procedure Include(var Set of Enum; const Enum)",rtl.createCallback(this,"BI_InExclude_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_InExclude_OnFinishParamsExpr"),3,rtl.createSet(0)),4 in t&&this.AddBuiltInProc("Exclude","procedure Exclude(var Set of Enum; const Enum)",rtl.createCallback(this,"BI_InExclude_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_InExclude_OnFinishParamsExpr"),4,rtl.createSet(0)),5 in t&&this.AddBuiltInProc("Break","procedure Break",rtl.createCallback(this,"BI_Break_OnGetCallCompatibility"),null,null,null,5,rtl.createSet(0)),6 in t&&this.AddBuiltInProc("Continue","procedure Continue",rtl.createCallback(this,"BI_Continue_OnGetCallCompatibility"),null,null,null,6,rtl.createSet(0)),7 in t&&this.AddBuiltInProc("Exit","procedure Exit(result)",rtl.createCallback(this,"BI_Exit_OnGetCallCompatibility"),null,null,null,7,rtl.createSet(0)),8 in t&&this.AddBuiltInProc("Inc","procedure Inc(var Integer; const Incr: Integer = 1)",rtl.createCallback(this,"BI_IncDec_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_IncDec_OnFinishParamsExpr"),8,rtl.createSet(0)),9 in t&&this.AddBuiltInProc("Dec","procedure Dec(var Integer; const Decr: Integer = 1)",rtl.createCallback(this,"BI_IncDec_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_IncDec_OnFinishParamsExpr"),9,rtl.createSet(0)),10 in t&&this.AddBuiltInProc("Assigned","function Assigned(const Pointer or Class or Class-of): boolean",rtl.createCallback(this,"BI_Assigned_OnGetCallCompatibility"),rtl.createCallback(this,"BI_Assigned_OnGetCallResult"),null,rtl.createCallback(this,"BI_Assigned_OnFinishParamsExpr"),10,{}),11 in t&&this.AddBuiltInProc("Chr","function Chr(const Integer): char",rtl.createCallback(this,"BI_Chr_OnGetCallCompatibility"),rtl.createCallback(this,"BI_Chr_OnGetCallResult"),rtl.createCallback(this,"BI_Chr_OnEval"),null,11,{}),12 in t&&this.AddBuiltInProc("Ord","function Ord(const Enum or char): integer",rtl.createCallback(this,"BI_Ord_OnGetCallCompatibility"),rtl.createCallback(this,"BI_Ord_OnGetCallResult"),rtl.createCallback(this,"BI_Ord_OnEval"),null,12,{}),13 in t&&this.AddBuiltInProc("Low","function Low(const array or ordinal): ordinal or integer",rtl.createCallback(this,"BI_LowHigh_OnGetCallCompatibility"),rtl.createCallback(this,"BI_LowHigh_OnGetCallResult"),rtl.createCallback(this,"BI_LowHigh_OnEval"),null,13,{}),14 in t&&this.AddBuiltInProc("High","function High(const array or ordinal): ordinal or integer",rtl.createCallback(this,"BI_LowHigh_OnGetCallCompatibility"),rtl.createCallback(this,"BI_LowHigh_OnGetCallResult"),rtl.createCallback(this,"BI_LowHigh_OnEval"),null,14,{}),15 in t&&this.AddBuiltInProc("Pred","function Pred(const ordinal): ordinal",rtl.createCallback(this,"BI_PredSucc_OnGetCallCompatibility"),rtl.createCallback(this,"BI_PredSucc_OnGetCallResult"),rtl.createCallback(this,"BI_PredSucc_OnEval"),null,15,{}),16 in t&&this.AddBuiltInProc("Succ","function Succ(const ordinal): ordinal",rtl.createCallback(this,"BI_PredSucc_OnGetCallCompatibility"),rtl.createCallback(this,"BI_PredSucc_OnGetCallResult"),rtl.createCallback(this,"BI_PredSucc_OnEval"),null,16,{}),17 in t&&this.AddBuiltInProc("Str","procedure Str(const var; var String)",rtl.createCallback(this,"BI_StrProc_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_StrProc_OnFinishParamsExpr"),17,rtl.createSet(0)),18 in t&&this.AddBuiltInProc("Str","function Str(const var): String",rtl.createCallback(this,"BI_StrFunc_OnGetCallCompatibility"),rtl.createCallback(this,"BI_StrFunc_OnGetCallResult"),rtl.createCallback(this,"BI_StrFunc_OnEval"),null,18,{}),19 in t&&this.AddBuiltInProc("WriteStr","procedure WriteStr(out String; params...)",rtl.createCallback(this,"BI_WriteStrProc_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_WriteStrProc_OnFinishParamsExpr"),19,rtl.createSet(0)),20 in t&&this.AddBuiltInProc("Val","procedure Val(const String; var Value: bool|int|float|enum; out Int)",rtl.createCallback(this,"BI_Val_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_Val_OnFinishParamsExpr"),20,rtl.createSet(0)),21 in t&&this.AddBuiltInProc("Lo","function Lo(X: any integer type): Byte|Word)",rtl.createCallback(this,"BI_LoHi_OnGetCallCompatibility"),rtl.createCallback(this,"BI_LoHi_OnGetCallResult"),rtl.createCallback(this,"BI_LoHi_OnEval"),null,21,{}),22 in t&&this.AddBuiltInProc("Hi","function Hi(X: any integer type): Byte|Word)",rtl.createCallback(this,"BI_LoHi_OnGetCallCompatibility"),rtl.createCallback(this,"BI_LoHi_OnGetCallResult"),rtl.createCallback(this,"BI_LoHi_OnEval"),null,22,{}),23 in t&&this.AddBuiltInProc("Concat","function Concat(const Array1, Array2, ...): Array",rtl.createCallback(this,"BI_ConcatArray_OnGetCallCompatibility"),rtl.createCallback(this,"BI_ConcatArray_OnGetCallResult"),null,null,23,{}),24 in t&&this.AddBuiltInProc("Concat","function Concat(const String1, String2, ...): String",rtl.createCallback(this,"BI_ConcatString_OnGetCallCompatibility"),rtl.createCallback(this,"BI_ConcatString_OnGetCallResult"),rtl.createCallback(this,"BI_ConcatString_OnEval"),null,24,{}),25 in t&&this.AddBuiltInProc("Copy","function Copy(const Array; Start: integer = 0; Count: integer = all): Array",rtl.createCallback(this,"BI_CopyArray_OnGetCallCompatibility"),rtl.createCallback(this,"BI_CopyArray_OnGetCallResult"),null,null,25,{}),26 in t&&this.AddBuiltInProc("Insert","procedure Insert(const Element; var Array; Index: integer)",rtl.createCallback(this,"BI_InsertArray_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_InsertArray_OnFinishParamsExpr"),26,rtl.createSet(0)),27 in t&&this.AddBuiltInProc("Delete","procedure Delete(var Array; Start, Count: integer)",rtl.createCallback(this,"BI_DeleteArray_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_DeleteArray_OnFinishParamsExpr"),27,rtl.createSet(0)),28 in t&&this.AddBuiltInProc("TypeInfo","function TypeInfo(type or var identifier): Pointer",rtl.createCallback(this,"BI_TypeInfo_OnGetCallCompatibility"),rtl.createCallback(this,"BI_TypeInfo_OnGetCallResult"),null,null,28,{}),29 in t&&this.AddBuiltInProc("GetTypeKind","function GetTypeKind(type or var identifier): System.TTypeKind",rtl.createCallback(this,"BI_GetTypeKind_OnGetCallCompatibility"),rtl.createCallback(this,"BI_GetTypeKind_OnGetCallResult"),rtl.createCallback(this,"BI_GetTypeKind_OnEval"),null,29,{}),30 in t&&this.AddBuiltInProc("Assert","procedure Assert(bool[,string])",rtl.createCallback(this,"BI_Assert_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_Assert_OnFinishParamsExpr"),30,rtl.createSet(0)),31 in t&&this.AddBuiltInProc("New","procedure New(out ^record)",rtl.createCallback(this,"BI_New_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_New_OnFinishParamsExpr"),31,rtl.createSet(0)),32 in t&&this.AddBuiltInProc("Dispose","procedure Dispose(var ^record)",rtl.createCallback(this,"BI_Dispose_OnGetCallCompatibility"),null,null,rtl.createCallback(this,"BI_Dispose_OnFinishParamsExpr"),32,rtl.createSet(0)),33 in t&&this.AddBuiltInProc("Default","function Default(T): T",rtl.createCallback(this,"BI_Default_OnGetCallCompatibility"),rtl.createCallback(this,"BI_Default_OnGetCallResult"),rtl.createCallback(this,"BI_Default_OnEval"),null,33,{})},this.AddBaseType=function(e,t){var s,i=null;return s=this.CreateOwnedElement(me,e,null),t in rtl.createSet(0,1)||(this.FBaseTypes[t]=s),(i=Z.$create("Create$1")).BaseType=t,this.AddResolveData(s,i,0),this.FDefaultScope.AddIdentifier(e,s,1),i},this.AddCustomBaseType=function(e,t){var s,i=null;return s=this.CreateOwnedElement(me,e,null),(i=t.$create("Create$1")).BaseType=1,this.AddResolveData(s,i,0),this.FDefaultScope.AddIdentifier(e,s,1),s},this.IsBaseType=function(e,t,s){var i=!1;return i=!1,null===e?i:(s&&(e=this.ResolveAliasType(e,!0)),e.$class.ClassType()!==me?i:i=0===Pe(e.FName,this.GetBaseTypeNames(t)))},this.AddBuiltInProc=function(e,t,s,i,r,n,l,a){var o,h=null;return o=this.CreateOwnedElement(me,e,null),(h=ee.$create("Create$1")).Proc=o,h.Signature=t,h.BuiltIn=l,h.GetCallCompatibility=s,h.GetCallResult=i,h.Eval=r,h.FinishParamsExpression=n,h.Flags=rtl.refSet(a),this.AddResolveData(o,h,0),this.FDefaultScope.AddIdentifier(e,o,2),0!==l&&(this.FBuiltInProcs[l]=h),h},this.AddResolveData=function(e,t,s){null!==t.FElement&&this.RaiseInternalError(20171111162227,""),null!==e.FData&&this.RaiseInternalError(20171111162236,""),t.SetElement(e),t.Owner=this,t.Next=this.FLastCreatedData[s],this.FLastCreatedData[s]=t,e.FData=t},this.CreateReference=function(e,t,s,i){var r=this,n=null;return null!==t.FData&&r.RaiseInternalError(20160922163554,"customdata="+ye(e)),n=_.$create("Create$1"),null!==i&&i.StartScope.$class.ClassType()===this.FScopeClass_WithExpr&&(n.WithExprScope=i.StartScope),this.AddResolveData(t,n,1),n.SetDeclaration(e),Yt.isPrototypeOf(t)&&this.SetResolvedRefAccess(t,n,s),this.EmitElementHints(t,e),n},this.GetLocalScope=function(){var e=null;return(e=this.FTopScope).$class.ClassType()===k&&(e=e.Scopes[0]),e},this.GetParentLocalScope=function(){var e=null;return(e=this.GetScopes(this.FScopeCount-2)).$class.ClassType()===k&&(e=e.Scopes[0]),e},this.CreateScope=function(e,t){var s=null;return t.IsStoredInElement()||this.RaiseInternalError(20160923121858,""),null!==e.FData&&this.RaiseInternalError(20160923121849,""),(s=t.$create("Create$1")).$class.FreeOnPop()?(s.SetElement(e),e.FData=s,s.Owner=this):this.AddResolveData(e,s,1),s},this.CreateGroupScope=function(e,t){var s=null;return(s=k.$create("Create$1")).SetElement(e),this.GroupScope_AddTypeAndAncestors(s,e,t),s},this.GroupScope_AddTypeAndAncestors=function(e,t,s){var i=!1,r=0,n=null,l=null,a=null,o=null,h=null,u=null;if(t=this.ResolveAliasType(t,!1),(i=(a=this.ResolveAliasType(t,!0)).$class.ClassType()===$e)&&null!==a.HelperForType){for(s=!1,h=a.FData;null!==h;)e.Add(h),h=h.AncestorScope;t=this.ResolveAliasType(t.HelperForType,!1),i=(a=this.ResolveAliasType(t,!0)).$class.ClassType()===$e}do{if(s){for(var c=rtl.length(this.FActiveHelpers)-1;c>=0;c--)if(r=c,l=(n=this.FActiveHelpers[r]).HelperForType,this.IsSameType(l,t,0)){for(h=n.Helper.FData;null!==h;)e.Add(h),h=h.AncestorScope;if(!(45 in this.FCurrentParser.GetCurrentModeSwitches()))break}}else s=!0;if((u=a.$class.ClassType())!==$e&&u!==Me||e.Add(rtl.as(a.FData,C)),!i)break;if(null===(o=rtl.as(a.FData,O).AncestorScope))break;a=t=o.FElement}while(null!==a)},this.PopScope=function(){var e=null;0===this.FScopeCount&&this.RaiseInternalError(20160922163557,""),this.FScopeCount-=1,this.FTopScope.$class.FreeOnPop()&&(null!==(e=this.FScopes[this.FScopeCount]).FElement&&e.FElement.FData===e&&(e.FElement.FData=null),e===this.FDefaultScope&&(this.FDefaultScope=null),this.FScopes[this.FScopeCount]=null,e=rtl.freeLoc(e)),this.FScopeCount>0?this.FTopScope=this.FScopes[this.FScopeCount-1]:this.FTopScope=null},this.PopWithScope=function(e){for(var t=null,s=0,i=(t=rtl.as(e.FData,M)).ExpressionScopes.GetCount()-1;i>=0;i--)s=i,this.CheckTopScope(this.FScopeClass_WithExpr,!1),this.FTopScope!==t.ExpressionScopes.GetItem(s)&&this.RaiseInternalError(20160923102846,""),this.PopScope();this.CheckTopScope(M,!1),this.PopScope()},this.PopGenericParamScope=function(e){var t=null;null!==e.GenericTemplateTypes&&e.GenericTemplateTypes.FCount>0?(t=rtl.getObject(e.GenericTemplateTypes.Get(0)),I.isPrototypeOf(this.FTopScope)||this.RaiseNotYetImplemented(20190831204109,e,ye(this.FTopScope)),this.FTopScope.FElement!==t&&this.RaiseNotYetImplemented(20190831204134,e,ye(this.FTopScope.FElement)),this.PopScope()):I.isPrototypeOf(this.FTopScope)&&this.RaiseNotYetImplemented(20190831204213,e,ye(this.FTopScope.FElement))},this.PushScope=function(e){null===e&&this.RaiseInternalError(20160922163601,""),rtl.length(this.FScopes)===this.FScopeCount&&(this.FScopes=rtl.arraySetLength(this.FScopes,null,2*this.FScopeCount+10)),this.FScopes[this.FScopeCount]=e,this.FScopeCount+=1,this.FTopScope=e},this.PushScope$1=function(e,t){var s;return s=this.CreateScope(e,t),this.PushScope(s),s},this.PushGroupScope=function(e){var t;return t=this.CreateGroupScope(e,!0),this.PushScope(t),t},this.PushModuleDotScope=function(e){var t=null;return(t=U.$create("Create$1")).Owner=this,t.SetModule(e),Ze.isPrototypeOf(e)?null!==e.ProgramSection&&(t.InterfaceScope=rtl.as(r.NoNil(e.ProgramSection.FData),g)):et.isPrototypeOf(e)?null!==e.LibrarySection&&(t.InterfaceScope=rtl.as(r.NoNil(e.LibrarySection.FData),g)):(null!==e.InterfaceSection&&(t.InterfaceScope=rtl.as(r.NoNil(e.InterfaceSection.FData),g)),e===this.FRootElement&&null!==e.ImplementationSection&&null!==e.ImplementationSection.FData&&(t.ImplementationScope=rtl.as(r.NoNil(e.ImplementationSection.FData),g)),0===Pe(e.FName,"system")&&(t.SystemScope=this.FDefaultScope)),this.PushScope(t),t},this.PushClassDotScope=function(e,t){var s,i=null,n=null;return e.get().IsForward&&(n=rtl.as(e.get().FData,_),e.set(rtl.as(n.FDeclaration,$e))),null===e.get().FData&&this.RaiseInternalError(20160922163611,""),s=rtl.as(r.NoNil(e.get().FData),O),(i=H.$create("Create$1")).Owner=this,i.ClassRecScope=s,i.GroupScope=this.CreateGroupScope(e.get(),t),this.PushScope(i),i},this.PushRecordDotScope=function(e){var t,s=null;return t=rtl.as(r.NoNil(e.FData),x),(s=j.$create("Create$1")).Owner=this,s.ClassRecScope=t,s.GroupScope=this.CreateGroupScope(e,!0),this.PushScope(s),s},this.PushInheritedScope=function(e,t,s){var i=null;return(i=W.$create("Create$1")).Owner=this,i.ClassRecScope=rtl.as(r.NoNil(e.FData),N),i.AncestorScope=s,i.GroupScope=this.CreateGroupScope(e,t),this.PushScope(i),i},this.PushEnumDotScope=function(e,t){var s=null;return(s=J.$create("Create$1")).Owner=this,s.EnumScope=rtl.as(r.NoNil(t.FData),P),s.GroupScope=this.CreateGroupScope(e,!0),this.PushScope(s),s},this.PushHelperDotScope=function(e){var t=null,s=null;return 0===(s=this.CreateGroupScope(e,!0)).Count?(s=rtl.freeLoc(s),null):((t=Y.$create("Create$1")).SetElement(e),t.Owner=this,t.GroupScope=s,this.PushScope(t),t)},this.PushTemplateDotScope=function(e,t){var s=this,i=null;function r(n){var l,a=null,o=null,h=null,u=null,c=null,p=0,f=q.$new();l=s.GetGenericConstraintKeyword(n);if(96===l);else if(47===l||50===l)null!==i&&s.RaiseNotYetImplemented(20190831005217,e,""),s.FindSystemClassTypeAndConstructor("system","tobject",{get:function(){return u},set:function(e){u=e}},{get:function(){return c},set:function(e){c=e}},t)||s.RaiseIdentifierNotFound(20190831002421,"system.TObject.Create()",t),a=H.$create("Create$1"),i=a,s.PushScope(i),a.Owner=s,a.ClassRecScope=rtl.as(u.FData,O),i.GroupScope=s.CreateGroupScope(u,!1);else if(De.isPrototypeOf(n)||s.RaiseNotYetImplemented(20190914070842,e,ye(n)),s.ComputeElement(n,f,rtl.createSet(4),null),2!==f.BaseType&&s.RaiseNotYetImplemented(20190915183241,n,""),null===f.IdentEl&&s.RaiseNotYetImplemented(20190831214135,n,""),je.isPrototypeOf(f.LoTypeEl)){h=f.LoTypeEl,n.HasParent(h)&&s.RaiseNotYetImplemented(20190831214258,n,"");for(var d=0,F=rtl.length(h.Constraints)-1;d<=F;d++)p=d,r(h.Constraints[p])}else ze.isPrototypeOf(f.LoTypeEl)?(o=f.LoTypeEl,null===i?(a=H.$create("Create$1"),i=a,s.PushScope(i),a.Owner=s,a.ClassRecScope=rtl.as(o.FData,O),i.GroupScope=s.CreateGroupScope(f.HiTypeEl,!1)):s.GroupScope_AddTypeAndAncestors(i.GroupScope,o,!1)):s.RaiseNotYetImplemented(20190831001450,n,"")}var n=0;i=null;for(var l=0,a=rtl.length(e.Constraints)-1;l<=a;l++)n=l,r(e.Constraints[n]);return i},this.PushDotScope=function(e){var t,s=null;return(t=(s=this.ResolveAliasType(e,!0)).$class.ClassType())===$e?this.PushClassDotScope({get:function(){return s},set:function(e){s=e}},!0):t===Me?this.PushRecordDotScope(s):t===Ge?this.PushEnumDotScope(e,s):t===je?this.PushTemplateDotScope(s,e):this.PushHelperDotScope(e)},this.PushParserSpecializeType=function(e){return this.PushDotScope(e.DestType)},this.PushWithExprScope=function(e){var t,s,i,n=null,l=q.$new(),a=null,o=null,h=null,u=null,c=null,p={},f=null;return Nt.isPrototypeOf(e.FParent)||this.RaiseInternalError(20181210163412,ye(e.FParent)),t=e.FParent,M.isPrototypeOf(t.FData)||this.RaiseInternalError(20181210175526,""),n=t.FData,this.ResolveExpr(e,1),this.ComputeElement(e,l,rtl.createSet(0),null),s=e,i=l.HiTypeEl,null===(a=l.LoTypeEl)&&this.RaiseMsg(20170216152004,3026,rtl.getResStr(Ce,"sExprTypeMustBeClassOrRecordTypeGot"),Ye(18,this.GetBaseTypeNames(l.BaseType)),s),l.BaseType in r.btAllIntrinsicTypes||2===l.BaseType||this.RaiseMsg(20190210143257,3026,rtl.getResStr(Ce,"sExprTypeMustBeClassOrRecordTypeGot"),Ye(18,this.GetBaseTypeNames(l.BaseType)),s),0 in l.Flags||this.CheckUseAsType(l.LoTypeEl,20220210140100,e),p={},f=null,h=null,a.$class.ClassType()===Le?(o=a.DestType,u=rtl.as(this.ResolveAliasType(o,!0),$e),h=this.CreateGroupScope(o,!0),f=u.FData,p=rtl.includeSet(p,1),p=rtl.includeSet(p,2)):ze.isPrototypeOf(a)&&(f=a.FData),null===h&&(0===(h=this.CreateGroupScope(i,!0)).Count&&(h=rtl.freeLoc(h),this.RaiseMsg(20170216152007,3026,rtl.getResStr(Ce,"sExprTypeMustBeClassOrRecordTypeGot"),Ye(18,r.GetElementTypeName(a)),s)),De.isPrototypeOf(l.IdentEl)&&(p=rtl.includeSet(p,1))),(c=this.FScopeClass_WithExpr.$create("Create$1")).WithScope=n,c.Index=t.Expressions.FCount,c.Expr=e,c.Scope=h,c.ClassRecScope=f,De.isPrototypeOf(l.IdentEl)||(p=rtl.includeSet(p,0)),1 in l.Flags||2!==l.BaseType||l.LoTypeEl.$class.ClassType()!==Me||(p=rtl.includeSet(p,3)),c.Flags=rtl.refSet(p),n.ExpressionScopes.Add$1(c),this.PushScope(c),c},this.StashScopes=function(e){var t;for(t=this.FStashScopeCount,e>this.FScopeCount&&this.RaiseInternalError(20190728125505,"");this.FScopeCount>e;)this.FStashScopeCount===rtl.length(this.FStashScopes)&&(this.FStashScopes=rtl.arraySetLength(this.FStashScopes,null,this.FStashScopeCount+4)),this.FStashScopes[this.FStashScopeCount]=this.FTopScope,this.FStashScopeCount+=1,this.FScopeCount-=1,this.FScopes[this.FScopeCount]=null,this.FScopeCount>0?this.FTopScope=this.FScopes[this.FScopeCount-1]:this.FTopScope=null;return t},this.StashSubExprScopes=function(){var e=0;for(e=this.FScopeCount;e>0&&w.isPrototypeOf(this.FScopes[e-1]);)e-=1;return this.StashScopes(e)},this.RestoreStashedScopes=function(e){for(;this.FStashScopeCount>e;)this.FScopeCount===rtl.length(this.FScopes)&&(this.FScopes=rtl.arraySetLength(this.FScopes,null,this.FScopeCount+4)),this.FStashScopeCount-=1,this.FScopes[this.FScopeCount]=this.FStashScopes[this.FStashScopeCount],this.FTopScope=this.FScopes[this.FScopeCount],this.FStashScopes[this.FStashScopeCount]=null,this.FScopeCount+=1},this.DeleteScope=function(e){this.FScopes.splice(e,1),this.FScopeCount-=1},this.InsertScope=function(e,t){this.FScopes=rtl.arrayInsert(e,this.FScopes,t),this.FScopeCount+=1},this.GetCurrentProcScope=function(e){var t=null,s=0;for(s=this.FScopeCount;;)if((s-=1)<0&&this.RaiseMsg(20171006001229,3044,rtl.getResStr(Ce,"sIllegalExpression"),[],e),t=this.GetScopes(s),$.isPrototypeOf(t))return t;return null},this.GetProcScope=function(e){var t=null;for(t=e;null!==t;){if(xe.isPrototypeOf(t))return t.FData;t=t.FParent}return null},this.GetCurrentSelfScope=function(e){return this.GetCurrentProcScope(e).GetSelfScope()},this.GetSelfScope=function(e){var t=null;return null!==(t=this.GetProcScope(e))&&(t=t.GetSelfScope()),t},this.AddHelper=function(e,t){var s,i,r=null;i=this.ResolveAliasType(e.HelperForType,!1),(r=y.$create("Create")).Helper=e,r.HelperForType=i,s=rtl.length(t.get()),r.Added=s,t.set(rtl.arraySetLength(t.get(),null,s+1)),t.get()[s]=r},this.AddActiveHelper=function(e){this.AddHelper(e,{p:this,get:function(){return this.p.FActiveHelpers},set:function(e){this.p.FActiveHelpers=e}})},this.MangleSourceLineNumber=function(e,t){return t<2048&&e<1048575?-(2048*e+t):e},this.UnmangleSourceLineNumber=function(e,t,s){t.set(e),s.set(0),t.get()<0&&(t.set(-t.get()),s.set(t.get()%2048),t.set(rtl.trunc(t.get()/2048)))},this.GetDbgSourcePosStr=function(e){var t="",s=0,i=0;return null===e?"nil":(this.UnmangleSourceLineNumber(e.SourceLinenumber,{get:function(){return s},set:function(e){s=e}},{get:function(){return i},set:function(e){i=e}}),t=e.SourceFilename+"("+Ae(s),i>0&&(t=t+","+Ae(i)),t+=")")},this.GetElementSourcePosStr=function(e){var t="",s=0,i=0;return null===e?"nil":(this.$class.UnmangleSourceLineNumber(e.SourceLinenumber,{get:function(){return s},set:function(e){s=e}},{get:function(){return i},set:function(e){i=e}}),0===s&&me.isPrototypeOf(e)?"intrinsic":(t=this.FCurrentParser.FScanner.FormatPath(e.SourceFilename)+"("+Ae(s),i>0&&(t=t+","+Ae(i)),t+=")"))},this.SetLastMsg=function(e,t,s,i,r,n){var l=0,a=0;this.FLastMsgId=e,this.FLastMsgType=t,this.FLastMsgNumber=s,this.FLastMsgPattern=i,this.FLastMsg=Ls(i,r),this.FLastElement=n,null===n?this.FLastSourcePos.$assign(this.FCurrentParser.CurSourcePos()):(this.FLastSourcePos.FileName=n.SourceFilename,this.$class.UnmangleSourceLineNumber(n.SourceLinenumber,{get:function(){return a},set:function(e){a=e}},{get:function(){return l},set:function(e){l=e}}),this.FLastSourcePos.Row=a>=0?a:0,this.FLastSourcePos.Column=l>=0?l:0),Bs({p:this,get:function(){return this.p.FLastMsgArgs},set:function(e){this.p.FLastMsgArgs=e}},r)},this.LogMsg=function(e,t,s,i,r,n){var l=null,a=0;if(null!==(l=this.FCurrentParser.FScanner)){if(this.FStep<2&&l.IgnoreMsgType(t))return;if(t>=2){a=l.GetWarnMsgState(s);if(2===a)return;if(3===a)return void this.RaiseMsg(e,s,i,r,n)}}this.SetLastMsg(e,t,s,i,r,n),null!=this.FOnLog?this.FOnLog(this,this.FLastMsg):null!=this.FCurrentParser.FOnLog&&this.FCurrentParser.FOnLog(this,this.FLastMsg)},this.GetWarnIdentifierNumbers=function(e,t){var s=!1;function i(e){t.set(rtl.arraySetLength(t.get(),0,1)),t.get()[0]=e}if(""===e)return!1;if(e.charCodeAt(0)in rtl.createSet(null,48,57))return!1;s=!0;var r=Ms(e);return"CONSTRUCTING_ABSTRACT"===r?i(4046):"SYMBOL_DEPRECATED"===r?i(5043):"SYMBOL_EXPERIMENTAL"===r?i(5079):"SYMBOL_LIBRARY"===r?i(5065):"SYMBOL_PLATFORM"===r?i(5076):"SYMBOL_UNIMPLEMENTED"===r?i(5078):"HIDDEN_VIRTUAL"===r?i(3077):"GARBAGE"===r?i(3058):"BOUNDS_ERROR"===r?function(e){var s=0;t.set(rtl.arraySetLength(t.get(),0,rtl.length(e)));for(var i=0,r=rtl.length(e)-1;i<=r;i++)s=i,t.get()[s]=e[s]}([3064,3065,3066,3070]):"MESSAGE_DIRECTIVE"===r?i(1025):s=!1,s},this.GetIncompatibleTypeDesc=function(e,t,s,i){if(e.BaseType!==t.BaseType&&2!==e.BaseType&&2!==t.BaseType){if(s.set(this.GetBaseDescription(e,!1)),30===t.BaseType?i.set(this.GetBaseTypeNames(29)):i.set(this.GetBaseDescription(t,!1)),s.get()!==i.get())return;s.set(this.GetBaseDescription(e,!0)),i.set(this.GetBaseDescription(t,!0))}else if(null!==e.LoTypeEl&&null!==t.LoTypeEl){if(we.isPrototypeOf(e.LoTypeEl)&&we.isPrototypeOf(t.LoTypeEl)&&(this.GetIncompatibleProcParamsDesc(e.LoTypeEl,t.LoTypeEl,s,i),s.get()!==i.get()))return;if(s.set(this.GetTypeDescription$1(e,!1)),i.set(this.GetTypeDescription$1(t,!1)),s.get()!==i.get())return;if(e.HiTypeEl!==t.HiTypeEl&&(s.set(this.GetTypeDescription(e.HiTypeEl,!1)),i.set(this.GetTypeDescription(t.HiTypeEl,!1)),s.get()!==i.get()))return;s.set(this.GetTypeDescription$1(e,!0)),i.set(this.GetTypeDescription$1(t,!0))}else{if(s.set(this.GetResolverResultDescription(e,!0)),i.set(this.GetResolverResultDescription(t,!0)),s.get()!==i.get())return;s.set(this.GetResolverResultDescription(e,!1)),i.set(this.GetResolverResultDescription(t,!1))}},this.GetIncompatibleTypeDesc$1=function(e,t,s,i){var r=null,n=null;r=this.ResolveAliasType(e,!0),n=this.ResolveAliasType(t,!0),null!==r&&null!==n&&r.$class.ClassType()===n.$class.ClassType()&&we.isPrototypeOf(r)&&(this.GetIncompatibleProcParamsDesc(r,n,s,i),s.get()!==i.get())||(s.set(this.GetTypeDescription(e,!1)),i.set(this.GetTypeDescription(t,!1)),s.get()===i.get()&&(s.set(this.GetTypeDescription(e,!0)),i.set(this.GetTypeDescription(t,!0))))},this.GetIncompatibleProcParamsDesc=function(e,t,s,i){var r=this;function n(e,t){var s;(s=e.$class.ClassType())===we?t.set(t.get()+"procedure"):s===Ve?t.set(t.get()+"function"):r.RaiseNotYetImplemented(20200216114419,e,e.$classname)}var l=0,a=null,o=null,h=null,u=null,c="",p="",f=null,d=null;s.set(""),i.set(""),4 in e.Modifiers&&!(4 in t.Modifiers)?s.set("reference to "):!(4 in e.Modifiers)&&4 in t.Modifiers&&i.set("reference to "),n(e,s),n(t,i),s.set(s.get()+"("),i.set(i.get()+"("),h=e.Args,u=t.Args;for(var F=0,m=h.FCount-1;F<=m;F++)(l=F)>0&&s.set(s.get()+";"),a=rtl.getObject(h.Get(l)),f=this.ResolveAliasType(a.ArgType,!0),l<u.FCount?(l>0&&i.set(i.get()+";"),o=rtl.getObject(u.Get(l)),f===(d=this.ResolveAliasType(o.ArgType,!0))?(s.set(s.get()+this.GetTypeDescription(f,!1)),i.set(i.get()+this.GetTypeDescription(d,!1))):(this.GetIncompatibleTypeDesc$1(f,d,{get:function(){return c},set:function(e){c=e}},{get:function(){return p},set:function(e){p=e}}),s.set(s.get()+c),i.set(i.get()+p))):s.set(s.get()+this.GetTypeDescription(f,!1));for(var C=h.FCount,S=u.FCount-1;C<=S;C++)(l=C)>0&&i.set(i.get()+";"),o=rtl.getObject(u.Get(l)),d=this.ResolveAliasType(o.ArgType,!0),i.set(i.get()+this.GetTypeDescription(d,!1));s.set(s.get()+")"),i.set(i.get()+")"),Ve.isPrototypeOf(e)&&s.set(s.get()+": "+this.GetTypeDescription(this.ResolveAliasType(e.ResultEl.ResultType,!0),!1)),Ve.isPrototypeOf(t)&&i.set(i.get()+": "+this.GetTypeDescription(this.ResolveAliasType(t.ResultEl.ResultType,!0),!1)),0 in e.Modifiers&&!(0 in t.Modifiers)?s.set(s.get()+" of Object"):!(0 in e.Modifiers)&&0 in t.Modifiers&&i.set(i.get()+" of Object"),1 in e.Modifiers&&!(1 in t.Modifiers)?s.set(s.get()+" is nested"):!(1 in e.Modifiers)&&1 in t.Modifiers&&i.set(i.get()+" is nested"),2 in e.Modifiers&&!(2 in t.Modifiers)?s.set(s.get()+"; static"):!(2 in e.Modifiers)&&2 in t.Modifiers&&i.set(i.get()+"; static"),5 in e.Modifiers&&!(5 in t.Modifiers)?s.set(s.get()+"; async"):!(5 in e.Modifiers)&&5 in t.Modifiers&&i.set(i.get()+"; async"),3 in e.Modifiers&&!(3 in t.Modifiers)?s.set(s.get()+"; varargs"):!(3 in e.Modifiers)&&3 in t.Modifiers?i.set(i.get()+"; varargs"):(null!==e.VarArgsType&&s.set(s.get()+"; varargs of "+this.GetTypeDescription(this.ResolveAliasType(e.VarArgsType,!0),!1)),null!==t.VarArgsType&&i.set(i.get()+"; varargs of "+this.GetTypeDescription(this.ResolveAliasType(t.VarArgsType,!0),!1))),e.CallingConvention!==t.CallingConvention&&(s.set(s.get()+";"+Fe.cCallingConventions[e.CallingConvention]),i.set(i.get()+";"+Fe.cCallingConventions[t.CallingConvention])),s.get()===i.get()&&(is.isPrototypeOf(e.FParent)&&s.set("anonymous "+s.get()),is.isPrototypeOf(t.FParent)&&i.set("anonymous "+i.get()))},this.RaiseMsg=function(e,t,s,i,r){var n=null;throw this.SetLastMsg(e,1,t,s,i,r),(n=l.$create("Create$1",[this.FLastMsg])).Id=e,n.MsgType=1,n.MsgNumber=t,n.MsgPattern=s,n.SetPasElement(r),n.Args=rtl.arrayRef(this.FLastMsgArgs),n.SourcePos.$assign(this.FLastSourcePos),n},this.RaiseNotYetImplemented=function(e,t,s){var i="";i=rtl.getResStr(Ce,"sNotYetImplemented")+" ["+Ae(e)+"]",""!==s&&(i=i+' "'+s+'"'),this.RaiseMsg(e,3002,i,Ye(18,ye(t)),t)},this.RaiseInternalError=function(e,t){throw pe.$create("Create$1",["Internal error: ["+Ae(e)+"] "+t])},this.RaiseInvalidScopeForElement=function(e,t,s){var i=0,r="";r="["+Ae(e)+'] invalid scope for "'+ye(t)+'": ';for(var n=0,l=this.FScopeCount-1;n<=l;n++)(i=n)>0&&(r+=","),r+=this.GetScopes(i).$classname;""!==s&&(r=r+": "+s),this.RaiseInternalError(e,r)},this.RaiseIdentifierNotFound=function(e,t,s){this.RaiseMsg(e,3001,rtl.getResStr(Ce,"sIdentifierNotFound"),Ye(18,t),s)},this.RaiseXExpectedButYFound=function(e,t,s,i){this.RaiseMsg(e,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,t,18,s),i)},this.RaiseXExpectedButTypeYFound=function(e,t,s,i){this.RaiseMsg(e,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,t,18,this.GetTypeDescription(s,!1)),i)},this.RaiseContextXExpectedButYFound=function(e,t,s,i,r){this.RaiseMsg(e,3078,rtl.getResStr(Ce,"sContextExpectedXButFoundY"),Ye(18,t,18,s,18,i),r)},this.RaiseContextXInvalidY=function(e,t,s,i){this.RaiseMsg(e,3079,rtl.getResStr(Ce,"sContextXInvalidY"),Ye(18,t,18,s),i)},this.RaiseConstantExprExp=function(e,t){this.RaiseMsg(e,3036,rtl.getResStr(Ce,"sConstantExpressionExpected"),[],t)},this.RaiseVarExpected=function(e,t,s){ve.isPrototypeOf(s)?this.RaiseMsg(e,3059,rtl.getResStr(Ce,"sNoMemberIsProvidedToAccessProperty"),[],t):this.RaiseMsg(e,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],t)},this.RaiseRangeCheck=function(e,t){this.RaiseMsg(e,3064,rtl.getResStr(Ce,"sRangeCheckError"),[],t)},this.RaiseIncompatibleTypeDesc=function(e,t,s,i,r,n){function l(e){return e>rtl.length(s)-1?"invalid param "+Ae(e):18===s[e].VType?s[e].VJSValue:"invalid param "+Ae(s[e].VType)}var a=t;3035===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,i,18,r),n):3028===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,i,18,r),n):3006===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,l(0),18,i,18,r),n):3007===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sIncompatibleTypeArgNoVarParamMustMatchExactly"),Ye(18,l(0),18,i,18,r),n):3019===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sResultTypeMismatchExpectedButFound"),Ye(18,i,18,r),n):3010===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,i,18,r),n):3082===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sOperatorIsNotOverloadedAOpB"),Ye(18,i,18,l(0),18,r),n):3029===a?this.RaiseMsg(e,t,rtl.getResStr(Ce,"sTypesAreNotRelatedXY"),Ye(18,i,18,r),n):this.RaiseInternalError(20170329112911,"")},this.RaiseIncompatibleType=function(e,t,s,i,r,n){var l="",a="";this.GetIncompatibleTypeDesc$1(i,r,{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}}),this.RaiseIncompatibleTypeDesc(e,t,s,l,a,n)},this.RaiseIncompatibleTypeRes=function(e,t,s,i,r,n){var l="",a="";this.GetIncompatibleTypeDesc(i,r,{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}}),this.RaiseIncompatibleTypeDesc(e,t,s,l,a,n)},this.RaiseHelpersCannotBeUsedAsType=function(e,t){this.RaiseMsg(e,3117,rtl.getResStr(Ce,"sHelpersCannotBeUsedAsTypes"),[],t)},this.RaiseInvalidProcTypeModifier=function(e,t,s,i){this.RaiseMsg(e,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(t),18,Fe.ProcTypeModifiers[s]),i)},this.RaiseInvalidProcModifier=function(e,t,s,i){this.RaiseMsg(e,3016,rtl.getResStr(Ce,"sInvalidXModifierY"),Ye(18,r.GetElementTypeName(t),18,Fe.ModifierNames[s]),i)},this.ComputeElement=function(e,t,s,i){var n=this;var l,a,h,u=null,c=0,p=null,f=null,d=0;if(null===i&&(i=e),t.$assign(q.$new()),null!==e)if((l=e.$class.ClassType())===Dt){var F=e.Kind;if(0===F||14===F)_.isPrototypeOf(e.FData)||this.RaiseNotYetImplemented(20160922163658,e,'Value="'+e.Value+'" CustomData='+ye(e.FData)+" "+this.GetElementSourcePosStr(e)),function(e){var r=null,l=null,a=null;if(r=e.FData,n.ComputeElement(r.FDeclaration,t,rtl.unionSet(s,rtl.createSet(1)),i),6 in r.Flags&&(t.Flags=rtl.excludeSet(t.Flags,1)),0 in s||!(2 in r.Flags))if(31===t.BaseType){if(1 in s)0 in s&&(r.Flags=rtl.includeSet(r.Flags,2));else if(rtl.eqSet(rtl.intersectSet(rtl.createSet(3,4),s),{})&&(l=rtl.as(t.IdentEl,xe),!n.ProcNeedsParams(l.ProcType))){if(qe.isPrototypeOf(t.IdentEl))n.ComputeResultElement(t.IdentEl.GetFT().ResultEl,t,rtl.unionSet(s,rtl.createSet(5)),i);else if(xe.isPrototypeOf(t.IdentEl)&&t.IdentEl.IsAsync()&&n.ComputeProcAsyncResult(t.IdentEl,t,rtl.refSet(s),i));else if(t.IdentEl.$class.ClassType()===_e)t.$assign(n.GetReference_ConstructorType(r,e));else if(n.ParentNeedsExprResult(e))return;0 in s&&(r.Flags=rtl.excludeSet(r.Flags,2),r.Flags=rtl.includeSet(r.Flags,1)),t.Flags=rtl.includeSet(t.Flags,3)}}else if(n.IsProcedureType(t,!0))if(rtl.neSet(rtl.intersectSet(rtl.createSet(1,2),s),{}))0 in s&&(r.Flags=rtl.includeSet(r.Flags,2));else if(rtl.eqSet(rtl.intersectSet(rtl.createSet(3,4),s),{})&&(a=t.LoTypeEl,!n.ProcNeedsParams(a))){if(Ve.isPrototypeOf(t.LoTypeEl))n.ComputeResultElement(t.LoTypeEl.ResultEl,t,rtl.unionSet(s,rtl.createSet(5)),i);else if(we.isPrototypeOf(t.LoTypeEl)&&t.LoTypeEl.GetIsAsync()&&n.ComputeProcAsyncResult(t.LoTypeEl,t,rtl.refSet(s),i));else if(n.ParentNeedsExprResult(e))return;0 in s&&(r.Flags=rtl.excludeSet(r.Flags,2),r.Flags=rtl.includeSet(r.Flags,1)),t.Flags=rtl.includeSet(t.Flags,3)}}(e);else if(1===F){if(Gs(e.Value))c=this.FBaseTypeExtended;else if(e.Value.length<9)c=26;else{null===(f=this.Eval(e,{},!0))&&this.RaiseNotYetImplemented(20190130162601,e,"");try{4===f.Kind?(d=f.Int,c=this.GetSmallestIntegerBaseType(d,d)):c=this.FBaseTypeExtended}finally{Ot({get:function(){return f},set:function(e){f=e}})}}r.SetResolverValueExpr(t,c,this.FBaseTypes[c],this.FBaseTypes[c],e,rtl.createSet(0))}else 2===F?(c=this.IsCharLiteral(e.Value,e))in r.btAllChars?(c===this.FBaseTypeChar&&(c=5),r.SetResolverValueExpr(t,c,this.FBaseTypes[c],this.FBaseTypes[c],e,rtl.createSet(0))):r.SetResolverValueExpr(t,7,this.FBaseTypes[7],this.FBaseTypes[7],e,rtl.createSet(0)):3===F?r.SetResolverValueExpr(t,7,this.FBaseTypes[7],this.FBaseTypes[7],e,rtl.createSet(0)):5===F?r.SetResolverValueExpr(t,30,this.FBaseTypes[30],this.FBaseTypes[30],e,rtl.createSet(0)):6===F?r.SetResolverValueExpr(t,15,this.FBaseTypes[15],this.FBaseTypes[15],e,rtl.createSet(0)):this.RaiseNotYetImplemented(20160922163701,e,"")}else if(l===me)Z.isPrototypeOf(e.FData)?r.SetResolverIdentifier(t,e.FData.BaseType,e,e,e,{}):ee.isPrototypeOf(e.FData)?(r.SetResolverIdentifier(t,32,e,e,e,{}),0 in e.FData.Flags&&(t.Flags=rtl.includeSet(t.Flags,3))):this.RaiseNotYetImplemented(20160926194756,e,"");else if(l===Gt)r.SetResolverValueExpr(t,15,this.FBaseTypes[15],this.FBaseTypes[15],e,rtl.createSet(0));else if(l===Bt)this.ComputeBinaryExpr(e,t,rtl.refSet(s),i);else if(l===Lt){e.OpCode in rtl.createSet(24,26)?this.ComputeElement(e.Operand,t,rtl.unionSet(s,rtl.createSet(1)),i):this.ComputeElement(e.Operand,t,rtl.refSet(s),i);var m=e.OpCode;if(1===m){if(t.BaseType in rtl.unionSet(r.btAllInteger,r.btAllFloats))return;if(this.IsGenericTemplType(t))return;this.RaiseMsg(20170216152532,3085,rtl.getResStr(Ce,"sIllegalQualifierInFrontOf"),Ye(18,Fe.OpcodeStrings[e.OpCode],18,this.GetResolverResultDescription(t,!1)),e)}else if(2===m){if(t.BaseType in rtl.unionSet(r.btAllSignedInteger,r.btAllFloats))return;if(t.BaseType in r.btAllInteger){var C=t.BaseType;return void(19===C||21===C?t.BaseType=26:25!==C&&27!==C||(t.BaseType=28))}if(this.IsGenericTemplType(t))return;this.RaiseMsg(20210815225815,3085,rtl.getResStr(Ce,"sIllegalQualifierInFrontOf"),Ye(18,Fe.OpcodeStrings[e.OpCode],18,this.GetResolverResultDescription(t,!1)),e)}else{if(10===m)return void(t.BaseType in rtl.unionSet(r.btAllInteger,r.btAllBooleans)||this.ComputeUnaryNot(e,t,rtl.refSet(s)));if(24===m){if(31===t.BaseType&&xe.isPrototypeOf(t.IdentEl))return void r.SetResolverValueExpr(t,2,t.LoTypeEl,t.HiTypeEl,e.Operand,rtl.createSet(0));if(0 in t.Flags&&29!==t.BaseType)return void r.SetResolverValueExpr(t,29,t.LoTypeEl,t.HiTypeEl,e.Operand,rtl.createSet(0));this.RaiseMsg(20180208121541,3085,rtl.getResStr(Ce,"sIllegalQualifierInFrontOf"),Ye(18,Fe.OpcodeStrings[e.OpCode],18,this.GetResolverResultDescription(t,!1)),e)}else{if(25===m)return void this.ComputeDereference(e,t);if(26===m){if(2===t.BaseType&&(we.isPrototypeOf(t.LoTypeEl)||this.IsGenericTemplType(t)))return;this.RaiseMsg(20180208121549,3085,rtl.getResStr(Ce,"sIllegalQualifierInFrontOf"),Ye(18,Fe.OpcodeStrings[e.OpCode],18,this.GetResolverResultDescription(t,!1)),e)}}}this.RaiseNotYetImplemented(20160926142426,e,"")}else if(l===Mt){var S=e.Kind;11===S?this.ComputeArrayParams(e,t,rtl.refSet(s),i):10===S?this.ComputeFuncParams(e,t,rtl.refSet(s),i):4===S?this.ComputeSetParams(e,t,rtl.refSet(s),i):this.RaiseNotYetImplemented(20161010184559,e,"")}else l===Vt?_.isPrototypeOf(e.FData)?function(l){var a,o=null,h=null;if(o=e.FData,a=(h=rtl.as(r.NoNil(o.FDeclaration),xe)).ProcType,r.SetResolverIdentifier(t,31,h,a,a,rtl.createSet(3)),(e.FParent.$class.ClassType()!==Bt||0!==e.FParent.OpCode)&&!(1 in s)){if(qe.isPrototypeOf(h))n.ComputeResultElement(h.GetFT().ResultEl,t,rtl.unionSet(s,rtl.createSet(5)),i),t.Flags=rtl.excludeSet(t.Flags,1);else if(h.$class.ClassType()===_e&&3 in o.Flags)t.$assign(n.GetReference_ConstructorType(o,l));else if(n.ParentNeedsExprResult(l))return;0 in s&&(o.Flags=rtl.excludeSet(o.Flags,2),o.Flags=rtl.includeSet(o.Flags,1)),t.Flags=rtl.includeSet(t.Flags,3)}}(e):r.SetResolverIdentifier(t,32,null,null,null,rtl.createSet(3)):l===qt||l===Qt?(this.ComputeElement(e.DestType,t,rtl.unionSet(s,rtl.createSet(4)),i),t.IdentEl=e,t.HiTypeEl=e):l===He?(3 in s&&this.RaiseConstantExprExp(20170216152737,i),this.ComputeElement(e.VarType,t,rtl.unionSet(s,rtl.createSet(4)),i),t.IdentEl=e,t.Flags=rtl.createSet(0,1)):l===it?null!==e.VarType?(!e.IsConst&&rtl.neSet(rtl.intersectSet(rtl.createSet(3,4),s),{})&&this.RaiseConstantExprExp(20170216152739,i),this.ComputeElement(e.VarType,t,rtl.unionSet(s,rtl.createSet(4)),i),t.IdentEl=e,e.IsConst?t.Flags=rtl.createSet(0):t.Flags=rtl.createSet(0,1)):(this.ComputeElement(e.Expr,t,rtl.unionSet(s,rtl.createSet(3)),i),t.IdentEl=e,t.Flags=rtl.createSet(0)):l===Qe?(p=rtl.as(r.NoNil(e.FParent),Ge),r.SetResolverIdentifier(t,2,e,p,p,rtl.createSet(0))):l===Ge?r.SetResolverIdentifier(t,2,e,e,e,{}):l===ve?(3 in s&&this.RaiseConstantExprExp(20170216152741,i),0===this.GetPasPropertyArgs(e).FCount?(this.ComputeElement(this.GetPasPropertyType(e),t,rtl.unionSet(s,rtl.createSet(4)),i),t.IdentEl=e,t.Flags={},null!==this.GetPasPropertyGetter(e)&&(t.Flags=rtl.includeSet(t.Flags,0)),null!==this.GetPasPropertySetter(e)&&(t.Flags=rtl.includeSet(t.Flags,1)),this.IsProcedureType(t,!0)&&(t.Flags=rtl.includeSet(t.Flags,3))):r.SetResolverIdentifier(t,33,e,null,null,{})):l===We?(3 in s&&this.RaiseConstantExprExp(20170216152744,i),null===e.ArgType?r.SetResolverIdentifier(t,4,e,null,null,{}):(this.ComputeElement(e.ArgType,t,rtl.unionSet(s,rtl.createSet(4)),i),t.IdentEl=e),t.Flags=rtl.createSet(0),e.Access in rtl.createSet(0,2,3)&&(t.Flags=rtl.includeSet(t.Flags,1)),this.IsProcedureType(t,!0)&&(t.Flags=rtl.includeSet(t.Flags,3))):l===$e?(e.IsForward&&null!==e.FData?(u=rtl.as(e.FData,_).FDeclaration,p=rtl.as(r.NoNil(u),$e)):p=e,r.SetResolverIdentifier(t,2,p,p,p,{})):l===Le||l===Be||l===Me?r.SetResolverIdentifier(t,2,e,e,e,{}):l===Je?(this.ComputeElement(e.RangeExpr,t,rtl.createSet(3),i),t.IdentEl=e,t.LoTypeEl=e,t.HiTypeEl=t.LoTypeEl,null===t.ExprEl&&(t.ExprEl=e.RangeExpr),t.Flags={}):l===lt?(this.ComputeElement(e.EnumType,t,rtl.createSet(3),i),37===t.BaseType&&(this.ConvertRangeToElement(t),t.LoTypeEl=e.EnumType,t.HiTypeEl=t.LoTypeEl),t.SubType=t.BaseType,t.BaseType=34,t.IdentEl=e,t.Flags={}):l===$t?(3 in s&&this.RaiseConstantExprExp(20170216152746,i),this.ComputeResultElement(e,t,rtl.refSet(s),i)):l===Re?Ie.isPrototypeOf(e.Module)?r.SetResolverIdentifier(t,3,e.Module,null,null,{}):this.RaiseNotYetImplemented(20170429112047,e.Module,""):e.$class.InheritsFrom(Ie)?r.SetResolverIdentifier(t,3,e,null,null,{}):l===wt?r.SetResolverValueExpr(t,30,this.FBaseTypes[30],this.FBaseTypes[30],e,rtl.createSet(0)):e.$class.InheritsFrom(xe)?(p=e.ProcType,r.SetResolverIdentifier(t,31,e,p,p,rtl.createSet(3)),(Ve.isPrototypeOf(e.ProcType)||l===_e)&&(t.Flags=rtl.includeSet(t.Flags,0))):e.$class.InheritsFrom(we)?r.SetResolverIdentifier(t,2,e,e,e,rtl.createSet(3)):l===jt?(p=e.Proc.ProcType,r.SetResolverValueExpr(t,31,p,p,e,rtl.createSet(0))):l===Ue?r.SetResolverIdentifier(t,2,e,e,e,{}):l===Ut?r.SetResolverValueExpr(t,35,null,null,e,rtl.createSet(0)):l===Jt?this.ComputeRecordValues(e,t,rtl.refSet(s),i):l===ms?this.RaiseMsg(20170419203146,3003,rtl.getResStr(Ce,"sIllegalQualifier"),Ye(9,"["),e):l===ys?r.SetResolverIdentifier(t,7,e,this.FBaseTypes[7],this.FBaseTypes[7],rtl.createSet(0)):l===je?r.SetResolverIdentifier(t,2,e,e,e,{}):l===Kt?function(l){var a=null;null!==l.SubType?n.ComputeElement(l.SubType,t,rtl.refSet(s),i):o.isPrototypeOf(l.FData)?(null===(a=l.FData.SpecializedType)&&n.RaiseNotYetImplemented(20190908153503,e,""),r.SetResolverIdentifier(t,2,a,a,a,{})):(null===(a=l.DestType)&&n.RaiseNotYetImplemented(20190908153434,e,""),r.SetResolverIdentifier(t,2,l,a,l,{}))}(e):l===Ht?this.ComputeElement(e.NameExpr,t,rtl.refSet(s),i):l===ls?(a=e,h=null,_.isPrototypeOf(a.FData)?(h=e.FData,n.ComputeElement(h.FDeclaration,t,rtl.unionSet(s,rtl.createSet(1)),i)):null!==a.NameExpr?n.ComputeElement(a.NameExpr,t,rtl.refSet(s),i):n.RaiseNotYetImplemented(20210106225512,a,"")):this.RaiseNotYetImplemented(20160922163705,e,"")},this.ComputeResultElement=function(e,t,s,i){null===e.ResultType&&this.RaiseNotYetImplemented(20200524214458,e,""),this.ComputeElement(e.ResultType,t,rtl.unionSet(s,rtl.createSet(4,1)),i),t.IdentEl=e,t.Flags=rtl.createSet(0,1)},this.ComputeProcAsyncResult=function(e,t,s,i){return rtl.eqSet(s,{}),t.IdentEl,false},this.Eval=function(e,t,s){var i;return null===(i=this.fExprEvaluator.Eval(e,rtl.refSet(t)))||s&&null===e.FData&&null===i.FElement&&!this.fExprEvaluator.IsSimpleExpr(e)&&e.GetModule()===this.FRootElement&&this.AddResolveData(e,i,1),i},this.Eval$1=function(e,t,s){var i=null,r=null;if(i=null,null!==e.ExprEl)i=this.Eval(e.ExprEl,rtl.refSet(t),s);else if(it.isPrototypeOf(e.IdentEl)){if(null===(r=e.IdentEl.Expr))return i;i=this.Eval(r,rtl.refSet(t),s)}return i},this.IsSameType=function(e,t,s){var i=0,n=0;if(null===e||null===t)return!1;var l=s;return 1===l?(e=r.ResolveSimpleAliasType(e),t=r.ResolveSimpleAliasType(t)):2===l&&(e=this.ResolveAliasType(e,!0),t=this.ResolveAliasType(t,!0)),e===t||(e.$class.ClassType()===me&&t.$class.ClassType()===me?0===Pe(e.FName,t.FName)||(i=e.FData.BaseType,n=t.FData.BaseType,this.GetActualBaseType(i)===this.GetActualBaseType(n)):!1)},this.HasExactType=function(e){var t,s=null;return null!==(s=e.IdentEl)?He.isPrototypeOf(s)?null!==s.VarType:s.$class.ClassType()===We?null!==s.ArgType:s.$class.ClassType()===$t?null!==s.ResultType:!!De.isPrototypeOf(s):null!==(t=e.ExprEl)?t.Kind in rtl.createSet(1,2,3,5,6):false},this.IndexOfGenericParam=function(e){for(var t=0,s=q.$new(),i=0,r=rtl.length(e)-1;i<=r;i++)if(t=i,this.ComputeElement(e[t],s,{},null),je.isPrototypeOf(s.LoTypeEl))return t;return-1},this.CheckUseAsType=function(e,t,s){null!==e&&ke.isPrototypeOf(e)&&(e.$class.ClassType()===$e&&null!==e.HelperForType&&this.RaiseHelpersCannotBeUsedAsType(t,s),null!==e.GenericTemplateTypes&&e.GenericTemplateTypes.FCount>0&&(!(3 in this.FCurrentParser.GetCurrentModeSwitches())&&s.HasParent(e)||this.RaiseMsg(t,3131,rtl.getResStr(Ce,"sGenericsWithoutSpecializationAsType"),Ye(18,s.ElementTypeName()),s)))},this.CheckCallProcCompatibility=function(e,t,s,i){var r,n=0,l=null,a=0,o=0,h=null,u=null,c=q.$new(),p=q.$new(),f={};for(n=0,l=e.Args,u=t.Value,Bt.isPrototypeOf(u)&&(u=u.Right),r=rtl.length(t.Params),p.BaseType=0,a=0;a<r;){if(h=t.Params[a],a<l.FCount){if(2147483647===(o=this.CheckParamCompatibility(h,rtl.getObject(l.Get(a)),a,s,i)))return 2147483647}else{if(!(3 in e.Modifiers))return s&&this.RaiseMsg(20170216152408,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,this.GetProcTypeDescription(e,rtl.createSet(0,2))),h),2147483647;if(null!==e.VarArgsType){if(0===p.BaseType&&this.ComputeElement(e.VarArgsType,p,rtl.createSet(4),null),this.ComputeArgumentExpr(p,1,h,c,i),2147483647===(o=this.CheckParamResCompatibility(h,c,p,a,s,i)))return 2147483647}else{if(f=i?rtl.createSet(2,0):rtl.createSet(2),this.ComputeElement(h,c,rtl.refSet(f),h),!(0 in c.Flags))return s&&this.RaiseVarExpected(20180712001415,h,c.IdentEl),2147483647;o=0}}n<1e4?n+=o:n=Math.max(n,o),a+=1}return a<l.FCount&&null===rtl.getObject(l.Get(a)).ValueExpr?(s&&this.RaiseMsg(20170216152410,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,this.GetProcTypeDescription(e,rtl.createSet(0,2))),t.Value),2147483647):n},this.CheckCallPropertyCompatibility=function(e,t,s){var i=0,r=null,n=0,l=0,a=null,o=null;if(i=0,(o=this.GetPasPropertyArgs(e)).FCount<rtl.length(t.Params)){if(!s)return 2147483647;this.RaiseMsg(20170216152412,3005,rtl.getResStr(Ce,"sWrongNumberOfParametersForCallTo"),Ye(18,e.FName),t)}else if(o.FCount>rtl.length(t.Params)){if(!s)return 2147483647;this.RaiseMsg(20170216152413,3031,rtl.getResStr(Ce,"sMissingParameterX"),Ye(18,rtl.getObject(o.Get(rtl.length(t.Params))).FName),t)}for(var h=0,u=o.FCount-1;h<=u;h++){if(n=h,r=rtl.getObject(o.Get(n)),a=t.Params[n],2147483647===(l=this.CheckParamCompatibility(a,r,n,s,!1)))return 2147483647;i+=l}return i},this.CheckCallArrayCompatibility=function(e,t,s,i){var n=this,l=0,a=null,o=q.$new();function h(){l>=rtl.length(t.Params)&&n.RaiseMsg(20170216152415,3042,rtl.getResStr(Ce,"sWrongNumberOfParametersForArray"),[],t),a=t.Params[l],n.ComputeElement(a,o,{},null),l+=1}var u=0,c=q.$new(),p=q.$new(),f=q.$new(),d=0,F=null,m=null,C=null,S=!1,T=null;for(l=0;;){if(0===rtl.length(e.Ranges)){if(h(),!(0 in o.Flags)||!(o.BaseType in r.btAllInteger))return this.CheckRaiseTypeArgNo(20170216152417,l,a,o,"integer",s);if(i&&null!==(T=this.Eval(a,rtl.createSet(3),!0)))try{13===T.Kind||(4!==T.Kind||T.Int<this.FDynArrayMinIndex||T.Int>this.FDynArrayMaxIndex)&&this.fExprEvaluator.EmitRangeCheckConst$1(20170520202212,T.AsString(),this.FDynArrayMinIndex,this.FDynArrayMaxIndex,a,2)}finally{Ot({get:function(){return T},set:function(e){T=e}})}}else for(var y=0,g=rtl.length(e.Ranges)-1;y<=g;y++){if(u=y,h(),C=e.Ranges[u],this.ComputeElement(C,c,{},null),d=c.BaseType,!(0 in o.Flags)){if(!s)return 2147483647;this.RaiseIncompatibleTypeRes(20170216152421,3006,Ye(18,Ae(l)),o,c,a)}if(S=!1,p.$assign(c),f.$assign(o),37===d&&(this.ConvertRangeToElement(c),d=c.BaseType),37===o.BaseType&&this.ConvertRangeToElement(o),d in r.btAllBooleans?o.BaseType in r.btAllBooleans&&(S=!0):d in r.btAllInteger?o.BaseType in r.btAllInteger&&(S=!0):d in r.btAllChars?o.BaseType in r.btAllChars&&(S=!0):2===d&&(m=c.LoTypeEl,2===o.BaseType&&m.$class.ClassType()===Ge&&this.IsSameType(m,o.LoTypeEl,0)&&(S=!0)),!S){if(!s)return 2147483647;this.RaiseIncompatibleTypeRes(20170216152422,3006,Ye(18,Ae(l)),f,p,a)}i&&this.fExprEvaluator.IsInRange(a,C,!0)}if(l===rtl.length(t.Params))return 0;(F=this.ResolveAliasType(e.ElType,!0)).$class.ClassType()!==Ue&&this.RaiseMsg(20170216152424,3042,rtl.getResStr(Ce,"sWrongNumberOfParametersForArray"),[],t),e=F}return 2147483647},this.CheckParamCompatibility=function(e,t,s,i,r){var n=0,l=q.$new(),a=q.$new();if(n=2147483647,this.ComputeArgumentAndExpr(t,a,e,l,r),t.Access in rtl.createSet(2,3)){if(!this.ResolvedElCanBeVarParam(l,e,!0))return i&&(it.isPrototypeOf(l.IdentEl)?this.RaiseMsg(20180430012609,3110,rtl.getResStr(Ce,"sCantAssignValuesToConstVariable"),[],e):this.RaiseVarExpected(20180430012457,e,l.IdentEl)),n;if(null===t.ArgType)return 0;if(this.GetActualBaseType(a.BaseType)===this.GetActualBaseType(l.BaseType)){if(3 in this.FCurrentParser.GetCurrentModeSwitches()){if(this.IsSameType(a.HiTypeEl,l.HiTypeEl,1))return 0}else if(this.IsSameType(a.LoTypeEl,l.LoTypeEl,0))return this.IsSameType(a.HiTypeEl,l.HiTypeEl,1)?0:2;if(2===a.BaseType&&a.LoTypeEl.$class.ClassType()===Ue&&l.LoTypeEl.$class.ClassType()===Ue&&2147483647!==(n=this.CheckAssignResCompatibility(a,l,e,!1)))return n}return this.IsGenericTemplType(a)?1:(i&&this.RaiseIncompatibleTypeRes(20170216152452,3007,Ye(18,Ae(s+1)),l,a,e),2147483647)}return n=this.CheckParamResCompatibility(e,l,a,s,i,r)},this.CheckParamResCompatibility=function(e,t,s,i,r,n){var l,a=!1;return a=!1,r&&t.BaseType in rtl.createSet(35,36)&&(a=!0),2147483647===(l=this.CheckAssignResCompatibility(s,t,e,a))&&r&&this.RaiseIncompatibleTypeRes(20170216152454,3006,Ye(18,Ae(i+1)),t,s,e),n&&2===s.BaseType&&s.LoTypeEl.$class.ClassType()===Ue&&this.MarkArrayExprRecursive(e,s.LoTypeEl),l},this.CheckAssignCompatibilityUserType=function(e,t,s,i){var n=this,l=0,a=null,o=null,h=q.$new(),u=q.$new(),c=null,p=null,f="",d="",F=null,m=null,C=null;function S(r){var l;return l=2147483647,i?(n.RaiseIncompatibleTypeRes(r,3028,[],t,e,s),l):l}if(null===t.LoTypeEl&&this.RaiseInternalError(20160922163645,""),null===e.LoTypeEl&&this.RaiseInternalError(20160922163648,""),(o=e.LoTypeEl)===(a=t.LoTypeEl)&&0 in t.Flags)return 0;if(l=-1,o.$class.ClassType()===$e)if(30===t.BaseType)l=0;else{if(a.$class.ClassType()!==$e)return S(20190215112919);if(l=2147483647,!(0 in t.Flags))return S(20190215112914);if(C=a,(m=o).ObjKind===C.ObjKind)l=this.CheckSrcIsADstType(t,e);else if(2===m.ObjKind&&1===C.ObjKind&&!C.IsExternal&&null!==this.GetClassImplementsIntf(C,m))return 1e4;2147483647===l&&(l=this.CheckAssignCompatibilityClasses(m,C)),2147483647===l&&i&&this.RaiseIncompatibleType(20170216152458,3028,[],a,o,s)}else if(o.$class.ClassType()===Le){if(30===t.BaseType)l=0;else if(a.$class.ClassType()===Le)De.isPrototypeOf(t.IdentEl)?(l=2147483647,i&&(Le.isPrototypeOf(this.ResolveAliasType(t.IdentEl,!0))?this.RaiseMsg(20180317103206,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"type class-of",18,"class of "+o.DestType.FName),s):this.RaiseMsg(20180511123859,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,this.GetResolverResultDescription(t,!1),18,"class of "+o.DestType.FName),s))):2147483647===(l=this.CheckClassIsClass(a.DestType,o.DestType))&&i&&this.RaiseMsg(20170216152500,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"class of "+a.DestType.PathName(),18,"class of "+o.DestType.PathName()),s);else if(De.isPrototypeOf(t.IdentEl)&&this.ResolveAliasType(t.IdentEl,!0).$class.ClassType()===$e)return 2147483647===(l=this.CheckClassIsClass(a,o.DestType))&&i&&this.RaiseMsg(20170216152501,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,a.FName,18,"class of "+o.DestType.PathName()),s),l}else if(we.isPrototypeOf(o)){if(30===t.BaseType)return 0;if(o.$class.ClassType()===a.$class.ClassType()&&0 in t.Flags&&this.CheckProcTypeCompatibility(o,a,!0,s,i))return 0;i&&we.isPrototypeOf(a)&&0 in t.Flags&&this.RaiseMsg(20170404154738,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,r.GetElementTypeName(a),18,r.GetElementTypeName(o)),s)}else if(o.$class.ClassType()===Ue){if(c=o,0===rtl.length(c.Ranges)&&a.$class.ClassType()===Ue){if(p=a,1===rtl.length(p.Ranges)){if(3 in this.FCurrentParser.GetCurrentModeSwitches()&&!this.IsOpenArray(c))return i&&this.RaiseIncompatibleTypeDesc(20180620115341,3028,[],"static array","dynamic array",s),2147483647}else{if(rtl.length(p.Ranges)>1)return i&&this.RaiseIncompatibleTypeDesc(20180620115235,3028,[],"multi dimensional static array","dynamic array",s),2147483647;if(!(5 in this.FOptions))if(this.IsOpenArray(c));else{if(this.IsOpenArray(p))return i&&this.RaiseIncompatibleTypeDesc(20180620115515,3028,[],"open array","dynamic array",s),2147483647;if(3 in this.FCurrentParser.GetCurrentModeSwitches()&&c!==p)return S(20190215112626)}}if(null===c.ElType)if(null===p.ElType)l=0;else{if(F=this.GetTVarRec(c),this.ResolveAliasType(p.ElType,!0)!==F)return S(20190215112715);l=0}else{if(null===p.ElType)return S(20190215112907);if(2147483647===(l=this.CheckElTypeCompatibility(c.ElType,p.ElType,2))){if(!i)return 2147483647;this.GetIncompatibleTypeDesc$1(c.ElType,p.ElType,{get:function(){return f},set:function(e){f=e}},{get:function(){return d},set:function(e){d=e}}),this.RaiseMsg(20170328110050,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"array of "+f,18,"array of "+d),s)}}}}else if(o.$class.ClassType()===Me){if($e.isPrototypeOf(a)&&2===a.ObjKind&&this.IsTGUID(o))return this.cInterfaceToTGUID}else if(o.$class.ClassType()===Ge);else if(a.$class.ClassType()===lt){if(o.$class.ClassType()!==lt)return S(20190215112924);if(this.ComputeElement(o.EnumType,u,{},null),this.ComputeElement(a.EnumType,h,{},null),null!==h.LoTypeEl&&h.LoTypeEl===u.LoTypeEl)l=0;else if(Z.isPrototypeOf(h.LoTypeEl.FData)&&Z.isPrototypeOf(u.LoTypeEl.FData)&&0===Pe(h.LoTypeEl.FName,u.LoTypeEl.FName))l=0;else{if(!i)return 2147483647;this.RaiseIncompatibleTypeRes(20170216152510,3028,[],h,u,s)}}else if(o.$class.ClassType()===Be&&a.$class.ClassType()===Be&&2147483647===(l=this.CheckAssignCompatibilityPointerType(o.DestType,a.DestType,s,!1)))return S(20190215112927);return-1===l?S(20190215112931):0 in t.Flags?l:S(20190215112934)},this.CheckAssignCompatibilityArrayType=function(e,t,s,i){var n=this,l=0;function a(e,t,s,i,r){var a,o=null,h=0;if(null!==i)if(a=n.GetActualBaseType(s.BaseType),0!==rtl.length(e.Ranges)){o=n.Eval(i,rtl.createSet(2),!0);try{if(8!==o.Kind)return;t!==(h=6===a?o.S.length:o.S.length)&&n.RaiseMsg(20170913113216,3047,rtl.getResStr(Ce,"sExpectXArrayElementsButFoundY"),Ye(18,Ae(t),18,Ae(h)),r),l=0}finally{Ot({get:function(){return o},set:function(e){o=e}})}}else l=0}var o;return l=2147483647,2===e.BaseType&&Ue.isPrototypeOf(e.LoTypeEl)||this.RaiseInternalError(20170222230012,""),null===(o=e.LoTypeEl).ElType&&0 in t.Flags&&t.BaseType in rtl.createSet(35,36)?0:(function e(s,o,h,u){var c=q.$new();function p(){n.ComputeElement(s.ElType,c,rtl.createSet(4),null),c.BaseType in r.btAllChars&&(l=1e4)}var f=null,d=null,F=null,m=q.$new(),C=q.$new(),S=0,T=0,y=0,g=!1,E=[],P=0,I={},R=null,v=null,A=null;if(0 in t.Flags)if(2!==h.BaseType||0!==o||h.LoTypeEl!==s){if(null===(F=h.ExprEl)&&it.isPrototypeOf(h.IdentEl)&&null===h.IdentEl.VarType&&(F=h.IdentEl.Expr),I=null!==F&&n.fExprEvaluator.IsConst(F)?rtl.createSet(3):{},null!==F)if(n.IsEmptyArrayExpr(h)){if(0===rtl.length(s.Ranges))return i&&n.MarkArrayExprRecursive(h.ExprEl,s),void(l=0)}else{if(n.IsArrayOperatorAdd(F)&&!(h.BaseType in r.btAllStrings)){if(rtl.length(s.Ranges)>0)return;if(n.ComputeElement(F.Left,C,rtl.refSet(I),null),e(s,o,q.$clone(C),u),2147483647===l)return;if(P=l,l=2147483647,n.ComputeElement(F.Right,C,rtl.refSet(I),null),e(s,o,q.$clone(C),u),2147483647===l)return;return void(l<P&&(l=P))}if(null!==F&&F.$class.ClassType()===Mt&&10===F.Kind&&_.isPrototypeOf(F.Value.FData)&&(v=F.Value.FData,me.isPrototypeOf(v.FDeclaration)&&ee.isPrototypeOf(v.FDeclaration.FData))){if(R=v.FDeclaration.FData,E=F.Params,23===R.BuiltIn){l=0;for(var N=0,x=rtl.length(E)-1;N<=x;N++){if(S=N,P=l,l=2147483647,n.ComputeElement(E[S],C,rtl.refSet(I),null),e(s,o,q.$clone(C),u),2147483647===l)return;l<P&&(l=P)}return}if(25===R.BuiltIn)return n.ComputeElement(E[0],C,rtl.refSet(I),null),void e(s,o,q.$clone(C),u)}}if(T=-1,0===rtl.length(s.Ranges)){if(null===F)return 2!==h.BaseType||h.LoTypeEl.$class.ClassType()!==Ue?void(h.BaseType in r.btAllStringAndChars&&p()):(A=h.LoTypeEl,rtl.length(A.Ranges)>0?void(i&&n.RaiseXExpectedButYFound(20180622104834,"dynamic array","static array",u)):(n.ComputeElement(n.GetArrayElType(s),c,rtl.createSet(4),null),c.Flags=rtl.includeSet(c.Flags,1),n.ComputeElement(n.GetArrayElType(A),C,rtl.createSet(4),null),C.Flags=rtl.includeSet(C.Flags,0),void(l=n.CheckAssignResCompatibility(c,C,u,i))));if(F.$class.ClassType()===Ut)T=rtl.length(F.Values);else{if(F.$class.ClassType()!==Mt||4!==F.Kind)return h.BaseType in r.btAllStringAndChars?void p():void 0;T=rtl.length(F.Params)}f=null,g=!0}else if(f=s.Ranges[o],0===(T=n.GetRangeLength(f))&&(n.ComputeElement(f,m,rtl.createSet(3),null),n.RaiseNotYetImplemented(20170222232409,F,"range "+r.GetResolverResultDbg(m))),g=o+1===rtl.length(s.Ranges),null===F)return void(2===C.BaseType&&C.LoTypeEl.$class.ClassType());if(g?(n.ComputeElement(s.ElType,c,rtl.createSet(4),null),c.ExprEl=f,c.Flags=rtl.includeSet(c.Flags,1)):c.BaseType=0,null!==F&&(F.$class.ClassType()===Ut||Mt.isPrototypeOf(F)&&4===F.Kind)){if(He.isPrototypeOf(u.FParent))if(3 in n.FCurrentParser.GetCurrentModeSwitches()){if(rtl.length(s.Ranges)>0){if(F.$class.ClassType()!==Ut)return void(i&&n.RaiseXExpectedButYFound(20180615121203,"(","[",u))}else if(F.$class.ClassType()===Ut)return void(i&&n.RaiseXExpectedButYFound(20180615122953,"[","(",u))}else if(F.$class.ClassType()!==Ut)return void(i&&n.RaiseXExpectedButYFound(20170913181208,"(","[",u));E=F.$class.ClassType()===Ut?F.Values:F.Params,y=rtl.length(E),I=rtl.includeSet(I,2);for(var b=0,O=T-1;b<=O;b++)if((S=b)===y&&(y>0&&(u=E[y-1]),n.RaiseMsg(20170222233001,3047,rtl.getResStr(Ce,"sExpectXArrayElementsButFoundY"),Ye(18,Ae(T),18,Ae(y)),u)),d=E[S],n.ComputeElement(d,C,rtl.refSet(I),null),g){if(2147483647===(l=n.CheckAssignResCompatibility(c,C,d,i)))return;n.CheckAssignExprRange(c,d)}else e(s,o+1,q.$clone(C),d);if(T<y)return u=E[T],void(i&&n.RaiseMsg(20170222233605,3047,rtl.getResStr(Ce,"sExpectXArrayElementsButFoundY"),Ye(18,Ae(T),18,Ae(y)),u));i&&F.$class.ClassType()===Mt&&n.MarkArrayExpr(F,s)}else{if(!g)return void(i&&n.RaiseMsg(20170223095307,3047,rtl.getResStr(Ce,"sExpectXArrayElementsButFoundY"),Ye(18,Ae(T),9,"1"),u));if(c.BaseType in r.btAllChars){if(h.BaseType in r.btAllStrings)return void a(s,T,c,F,u);if(6===h.BaseType)return void a(s,T,c,F,u)}if(T>1)return void(i&&n.RaiseMsg(20170913103143,3047,rtl.getResStr(Ce,"sExpectXArrayElementsButFoundY"),Ye(18,Ae(T),9,"1"),u));if(2147483647===(l=n.CheckAssignResCompatibility(c,h,u,i)))return;null!==F&&n.CheckAssignExprRange(c,F)}}else l=0}(o,0,q.$clone(t),s),2147483647===l&&i&&this.RaiseIncompatibleTypeRes(20180622104721,3028,[],t,e,s),l)},this.CheckAssignCompatibilityPointerType=function(e,t,s,i){var r=q.$new(),n=q.$new();return this.ComputeElement(e,r,rtl.createSet(1),null),this.ComputeElement(t,n,rtl.createSet(1),null),r.Flags=rtl.includeSet(r.Flags,1),n.Flags=rtl.includeSet(n.Flags,0),this.CheckAssignResCompatibility(r,n,s,i)},this.CheckEqualCompatibilityUserType=function(e,t,s,i){var r=this,n=0,l=null,a=null,o=q.$new(),h=q.$new();function u(){var e;return e=2147483647,i?(r.RaiseIncompatibleType(20170216152513,3028,[],l,a,s),e):e}if(null===e.LoTypeEl&&this.RaiseInternalError(20161007223118,""),null===t.LoTypeEl&&this.RaiseInternalError(20161007223119,""),l=e.LoTypeEl,a=t.LoTypeEl,l===a)return 0;if(l.$class.ClassType()===$e)return a.$class.ClassType()===$e?(2147483647===(n=this.CheckSrcIsADstType(e,t))&&(n=this.CheckSrcIsADstType(t,e)),2147483647===n&&i&&this.RaiseIncompatibleTypeRes(20180324190757,3029,[],e,t,s),n):a.$class.ClassType()===Me&&2===l.ObjKind&&this.IsTGUID(a)?this.cInterfaceToTGUID:u();if(l.$class.ClassType()===Le)return a.$class.ClassType()===Le?(2147483647===(n=this.CheckClassIsClass(l.DestType,a.DestType))&&(n=this.CheckClassIsClass(a.DestType,l.DestType)),2147483647===n&&i&&this.RaiseIncompatibleTypeRes(20180324190804,3029,[],e,t,s),n):u();if(l.$class.ClassType()===Ge){if(!i)return 2147483647;if(a.$class.ClassType()!==Qe)return u();this.RaiseIncompatibleType(20170216152523,3028,[],l,a,s)}else if(l.$class.ClassType()===Me){if(a.$class.ClassType()===$e&&2===a.ObjKind&&this.IsTGUID(l))return this.cInterfaceToTGUID}else if(l.$class.ClassType()===lt){if(a.$class.ClassType()!==lt)return u();if(this.ComputeElement(l.EnumType,o,{},null),this.ComputeElement(a.EnumType,h,{},null),null!==o.LoTypeEl&&o.LoTypeEl===h.LoTypeEl)return 0;if(Z.isPrototypeOf(o.LoTypeEl.FData)&&Z.isPrototypeOf(h.LoTypeEl.FData)&&0===Pe(o.LoTypeEl.FName,h.LoTypeEl.FName))return 0;if(!i)return 2147483647;this.RaiseIncompatibleTypeRes(20170216152524,3028,[],o,h,s)}else if(we.isPrototypeOf(l)){if(!we.isPrototypeOf(a))return u();if(this.CheckProcTypeCompatibility(l,a,!1,null,!1))return 0}else if(l.$class.ClassType()===Be&&a.$class.ClassType()===Be)return 0;return u()},this.CheckTypeCast=function(e,t,s){var i,r=q.$new(),n=q.$new();return 1!==rtl.length(t.Params)?(s&&this.RaiseMsg(20170216152526,3034,rtl.getResStr(Ce,"sWrongNumberOfParametersForTypeCast"),Ye(18,e.FName),t),2147483647):(i=t.Params[0],this.ComputeElement(i,r,rtl.createSet(2),null),this.ComputeElement(e,n,rtl.createSet(4),null),this.CheckTypeCastRes(r,n,i,s))},this.CheckTypeCastRes=function(e,t,s,i){var n=this,l=0;var a,o,h,u,c=null,p=null,f=0,d=null,F=null,m=null,C=null,S=0,T=0,y=null,g=null,E=null;if(l=2147483647,null!==(c=t.LoTypeEl)&&0 in e.Flags)if(d=c.$class.ClassType(),4===e.BaseType)l=3;else if(d===me){if(Z.isPrototypeOf(c.FData)){if(c===e.LoTypeEl)return 0;if(2===e.BaseType&&e.LoTypeEl.$class.ClassType()===je)return 0;(f=rtl.as(c.FData,Z).BaseType)===e.BaseType?l=0:f in r.btAllInteger?(e.BaseType in rtl.unionSet(r.btArrayRangeTypes,rtl.createSet(37,14))||2===e.BaseType&&(p=e.LoTypeEl).$class.ClassType()===Ge)&&(l=3):f in r.btAllFloats?(e.BaseType in r.btAllFloats||e.BaseType in r.btAllInteger)&&(l=3):f in r.btAllBooleans?(e.BaseType in r.btAllBooleans||e.BaseType in r.btAllInteger)&&(l=3):f in r.btAllChars?(e.BaseType in rtl.unionSet(r.btArrayRangeTypes,rtl.createSet(37))||2===e.BaseType&&(p=e.LoTypeEl).$class.ClassType()===Ge)&&(l=3):f in r.btAllStrings?e.BaseType in r.btAllStringAndChars?l=3:29===e.BaseType&&f in r.btAllStringPointer&&(l=0):29===f&&(e.BaseType in rtl.unionSet(rtl.createSet(29),r.btAllStringPointer)?l=0:2===e.BaseType&&((d=(p=e.LoTypeEl).$class.ClassType())===$e||d===Le||d===Be||d===Ue&&this.IsDynArray(p,!0)?l=0:d!==we&&d!==Ve||((m=p).GetIsOfObject()?7 in this.FOptions?l=3:i&&this.RaiseMsg(20170416183615,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,r.GetElementTypeName(m)+" "+Fe.ProcTypeModifiers[0],18,this.GetBaseTypeNames(29)),s):m.GetIsNested()?i&&this.RaiseMsg(20170416183800,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,r.GetElementTypeName(m)+" "+Fe.ProcTypeModifiers[1],18,this.GetBaseTypeNames(29)),s):m.GetIsReference()?6 in this.FOptions?l=3:i&&this.RaiseMsg(20170419144311,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,r.GetElementTypeName(m)+" "+Fe.ProcTypeModifiers[4],18,this.GetBaseTypeNames(29)),s):l=3)))}}else if(d===$e)if(g=c,2===e.BaseType){if((p=e.LoTypeEl).$class.ClassType()===$e)E=p,De.isPrototypeOf(e.IdentEl)&&this.RaiseMsg(20170404162606,3054,rtl.getResStr(Ce,"sCannotTypecastAType"),[],s),E.ObjKind===g.ObjKind?2147483647===(l=this.CheckSrcIsADstType(e,t))&&(l=this.CheckSrcIsADstType(t,e)):2===g.ObjKind?1!==E.ObjKind||E.IsExternal||(l=3):2===E.ObjKind&&(1!==g.ObjKind||g.IsExternal||(l=3)),2147483647===l&&(l=this.CheckTypeCastClassInstanceToClass(e,t,s)),2147483647===l&&E.ObjKind===g.ObjKind&&(i&&(a=E,o=g,h="",u="",n.GetIncompatibleTypeDesc$1(a,o,{get:function(){return h},set:function(e){h=e}},{get:function(){return u},set:function(e){u=e}}),n.LogMsg(20200209140450,2,3142,rtl.getResStr(Ce,"sClassTypesAreNotRelatedXY"),Ye(18,h,18,u),s)),l=1e4);else if(p.$class.ClassType()===je)if(C=p,0===rtl.length(C.Constraints))l=0;else for(var P=0,I=rtl.length(C.Constraints)-1;P<=I;P++){S=P,y=C.Constraints[S];T=this.GetGenericConstraintKeyword(y);if(96===T);else{if(47!==T&&50!==T){l=0;break}l=0}}}else 29===e.BaseType?this.IsBaseType(e.LoTypeEl,29,!1)&&(l=0):30===e.BaseType&&(l=0);else if(d===je){if(C=c,null!==(p=e.LoTypeEl)&&p.$class.ClassType()===je)return 0;for(var R=0,v=rtl.length(C.Constraints)-1;R<=v;R++){S=R,y=C.Constraints[S];var A=T=this.GetGenericConstraintKeyword(y);if(96===A)2===e.BaseType&&(p.$class.ClassType()===Me||p.$class.ClassType()===ke)&&(l=0);else{if(47!==A&&50!==A){l=0;break}l=0}}}else d===Le?2===e.BaseType?e.LoTypeEl.$class.ClassType()===Le&&(De.isPrototypeOf(e.IdentEl)&&this.RaiseMsg(20170404162604,3054,rtl.getResStr(Ce,"sCannotTypecastAType"),[],s),c=c.DestType,p=e.LoTypeEl.DestType,l=this.CheckClassesAreRelated(c,p)):29===e.BaseType?this.IsBaseType(e.LoTypeEl,29,!1)&&(l=0):30===e.BaseType&&(l=0):d===Me?2===e.BaseType&&e.LoTypeEl.$class.ClassType()===Me&&(l=0):d===Ge||d===Je?this.CheckIsOrdinal(e,s,!0)&&(l=0):d===Ue?2===e.BaseType?e.LoTypeEl.$class.ClassType()===Ue&&(l=this.CheckTypeCastArray(e.LoTypeEl,c,s,i)):29===e.BaseType?this.IsDynArray(t.LoTypeEl,!0)&&this.IsBaseType(e.LoTypeEl,29,!1)&&(l=0):30===e.BaseType&&this.IsDynArray(t.LoTypeEl,!0)&&(l=0):d===we||d===Ve?(F=c,this.IsBaseType(e.LoTypeEl,29,!1)?F.GetIsOfObject()?7 in this.FOptions?l=3:i&&this.RaiseMsg(20170416183940,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,this.GetBaseTypeNames(29),18,F.ElementTypeName()+" "+Fe.ProcTypeModifiers[0]),s):F.GetIsNested()?i&&this.RaiseMsg(20170416184149,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,this.GetBaseTypeNames(29),18,F.ElementTypeName()+" "+Fe.ProcTypeModifiers[1]),s):F.GetIsReference()?7 in this.FOptions?l=3:i&&this.RaiseMsg(20170419144357,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,this.GetBaseTypeNames(29),18,F.ElementTypeName()+" "+Fe.ProcTypeModifiers[4]),s):l=3:2===e.BaseType?(p=e.LoTypeEl,we.isPrototypeOf(p)&&(m=p,F.GetIsReference()||m.GetIsReference()?l=3:m.GetIsOfObject()===F.GetIsOfObject()||7 in this.FOptions?m.GetIsNested()!==F.GetIsNested()?i&&this.RaiseMsg(20170416183305,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,r.GetElementTypeName(m)+zt(m.GetIsNested()," "+Fe.ProcTypeModifiers[1],""),18,F.ElementTypeName()+zt(F.GetIsNested()," "+Fe.ProcTypeModifiers[1],"")),s):l=3:i&&this.RaiseMsg(20170416183109,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,r.GetElementTypeName(m)+zt(m.GetIsOfObject()," "+Fe.ProcTypeModifiers[0],""),18,F.ElementTypeName()+zt(F.GetIsOfObject()," "+Fe.ProcTypeModifiers[0],"")),s))):31===e.BaseType?(p=e.LoTypeEl,we.isPrototypeOf(p)&&(m=p,3 in this.FCurrentParser.GetCurrentModeSwitches()&&null===e.IdentEl&&""!==e.LoTypeEl.FName||(F.GetIsReference()||null===e.IdentEl?l=3:m.GetIsOfObject()===F.GetIsOfObject()||7 in this.FOptions?m.GetIsNested()!==F.GetIsNested()?i&&this.RaiseMsg(20181210151102,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,r.GetElementTypeName(m)+zt(m.GetIsNested()," "+Fe.ProcTypeModifiers[1],""),18,F.ElementTypeName()+zt(F.GetIsNested()," "+Fe.ProcTypeModifiers[1],"")),s):l=3:i&&this.RaiseMsg(20181210151058,3035,rtl.getResStr(Ce,"sIllegalTypeConversionTo"),Ye(18,r.GetElementTypeName(m)+zt(m.GetIsOfObject()," "+Fe.ProcTypeModifiers[0],""),18,F.ElementTypeName()+zt(F.GetIsOfObject()," "+Fe.ProcTypeModifiers[0],"")),s)))):30===e.BaseType&&(l=0)):d===Be&&(e.BaseType in rtl.createSet(29,30)?l=0:2===e.BaseType&&((d=(p=e.LoTypeEl).$class.ClassType())===Be||d===Le||d===$e||d.InheritsFrom(we)||this.IsDynArray(p,!0))&&(l=3));else null!==c&&(2===e.BaseType&&(p=e.LoTypeEl).$class.ClassType()===$e&&p===e.IdentEl&&2===t.BaseType&&(c=t.LoTypeEl).$class.ClassType()===Le&&c===t.IdentEl&&(c=c.DestType,l=this.CheckClassesAreRelated(c,p)),2147483647===l&&i&&De.isPrototypeOf(e.IdentEl)&&this.RaiseMsg(20170404162610,3054,rtl.getResStr(Ce,"sCannotTypecastAType"),[],s));return 2147483647===l?(i&&this.RaiseIncompatibleTypeRes(20170216152528,3035,[],e,t,s),l):l},this.CheckTypeCastArray=function(e,t,s,i){var r=this,n=0;function l(e,t,s){return t.set(t.get()+1),t.get()<rtl.length(e.get().Ranges)?(s.BaseType=0,!0):(r.ComputeElement(r.GetArrayElType(e.get()),s,rtl.createSet(4),null),2===s.BaseType&&s.LoTypeEl.$class.ClassType()===Ue&&(e.set(s.LoTypeEl),t.set(0),true))}var a,o,h=0,u=0,c=q.$new(),p=q.$new();if(!i&&null!==t.GenericTemplateTypes&&t.GenericTemplateTypes.FCount>0)return 3;for(a=e,o=t,n=2147483647,h=0,u=0;;){if(rtl.length(t.Ranges),!l({get:function(){return e},set:function(t){e=t}},{get:function(){return h},set:function(e){h=e}},c)){if(l({get:function(){return t},set:function(e){t=e}},{get:function(){return u},set:function(e){u=e}},p))break;c.Flags=rtl.includeSet(c.Flags,0),c.IdentEl=null,n=this.CheckTypeCastRes(c,p,s,!1);break}if(!l({get:function(){return t},set:function(e){t=e}},{get:function(){return u},set:function(e){u=e}},p))break}return 2147483647===n&&i&&this.RaiseIncompatibleType(20170331124643,3035,[],a,o,s),n},this.CheckSrcIsADstType=function(e,t){return this.CheckClassIsClass(e.LoTypeEl,t.LoTypeEl)},this.CheckClassIsClass=function(e,t){var s=this,i=0;function r(e,t){var i,n,l,a,o=0,h=null,u=null;if(l=e.SpecializedFromItem,a=t.SpecializedFromItem,null===l)return!1;if(null===a)return!1;if(l.GenericEl!==a.GenericEl)return!1;i=l.Params,n=a.Params;for(var c=0,p=rtl.length(i)-1;c<=p;c++)if(o=c,h=s.ResolveAliasType(i[o],!0),u=s.ResolveAliasType(n[o],!0),je.isPrototypeOf(h)||je.isPrototypeOf(u)||h===u);else{if(!ke.isPrototypeOf(h)||!ke.isPrototypeOf(u))return!1;if(!r(rtl.as(h.FData,R),rtl.as(u.FData,R)))return!1}return true}var n,l=null,a=null;if(null===t)return 2147483647;if((t=this.ResolveAliasType(t,!0)).$class.ClassType()!==$e)return 2147483647;for(n=rtl.as(t.FData,O),i=0;null!==e;){if(e===t)return i;if(e.$class.ClassType()===qt)e=e.DestType;else if(e.$class.ClassType()===Qt)e=e.DestType,i+=1;else if(e.$class.ClassType()===Kt)e=o.isPrototypeOf(e.FData)?e.FData.SpecializedType:e.DestType;else{if(e.$class.ClassType()!==$e)return 2147483647;if((l=e).IsForward)e=rtl.as(rtl.as(l.FData,_).FDeclaration,De);else{if(null!==l.GenericTemplateTypes&&l.GenericTemplateTypes.FCount>0&&null!==n.SpecializedFromItem&&e===n.SpecializedFromItem.GenericEl)return i;if(null!==(a=rtl.as(l.FData,O)).SpecializedFromItem&&null!==n.SpecializedFromItem&&r(a,n))return i;e=a.DirectAncestor,i+=1}}}return i=2147483647},this.CheckClassesAreRelated=function(e,t){var s=0;return 2147483647!==(s=this.CheckClassIsClass(e,t))?s:s=this.CheckClassIsClass(t,e)},this.CheckAssignCompatibilityClasses=function(e,t){return 2147483647},this.GetClassImplementsIntf=function(e,t){for(null;null!==e;){if(e===t||this.IndexOfImplementedInterface(e,t)>=0)return e;e=rtl.as(this.GetPasClassAncestor(e,!0),$e)}return null},this.CheckProcOverloadCompatibility=function(e,t){var s=!1,i=null,r=null,n=null,l=null,a=0;if(s=!1,null!==e.NameParts||null!==t.NameParts)if(n=this.GetProcTemplateTypes(e),l=this.GetProcTemplateTypes(t),null===n){if(null!==l)return s}else{if(null===l)return s;if(n.FCount!==l.FCount)return s}if(i=e.ProcType.Args,r=t.ProcType.Args,i.FCount!==r.FCount)return s;for(var o=0,h=i.FCount-1;o<=h;o++)if(a=o,this.CheckProcArgCompatibility(rtl.getObject(i.Get(a)),rtl.getObject(r.Get(a)))>0)return s;return s=!0},this.CheckProcTypeCompatibility=function(e,t,s,i,n){var l=this,a=!1;function o(t){var s;return s=!1,n?(l.RaiseMsg(20170402112049,3052,rtl.getResStr(Ce,"sXModifierMismatchY"),Ye(18,r.GetElementTypeName(e),18,Fe.ProcTypeModifiers[t]),i),s):s}var h=null,u=null,c=0,p=null,f=null,d=null,F=null;if(a=!1,e.$class.ClassType()!==t.$class.ClassType())return n&&this.RaiseXExpectedButYFound(20170402112353,r.GetElementTypeName(e),r.GetElementTypeName(t),i),a;if(e.GetIsReference());else if(t.GetIsReference()){if(s)return o(4)}else if(is.isPrototypeOf(t.FParent)){if(s)return o(4)}else{if(e.GetIsNested()!==t.GetIsNested())return o(1);if(e.GetIsOfObject()!==t.GetIsOfObject()){if(6 in this.FOptions)return o(0);if(!e.GetIsNested())return o(0)}}if(e.CallingConvention!==t.CallingConvention&&(!(8 in this.FOptions)||6!==e.CallingConvention||0!==t.CallingConvention))return n&&this.RaiseMsg(20170402112253,3018,rtl.getResStr(Ce,"sCallingConventionMismatch"),[],i),a;if(h=e.Args,u=t.Args,h.FCount!==u.FCount)return n&&this.RaiseMsg(20170902142829,3071,rtl.getResStr(Ce,"sIncompatibleTypesGotParametersExpected"),Ye(18,Ae(h.FCount),18,Ae(u.FCount)),i),a;for(var m=0,C=h.FCount-1;m<=C;m++)if(c=m,p=rtl.getObject(h.Get(c)),f=rtl.getObject(u.Get(c)),this.CheckProcArgCompatibility(p,f)>1)return n&&(p.Access!==f.Access&&this.RaiseMsg(20170404151541,3006,rtl.getResStr(Ce,"sIncompatibleTypeArgNo"),Ye(18,Ae(c+1),18,"access modifier "+Fe.AccessDescriptions[f.Access],18,Fe.AccessDescriptions[p.Access]),i),this.RaiseIncompatibleType(20170404151538,3006,Ye(18,Ae(c+1)),p.ArgType,f.ArgType,i)),a;if(Ve.isPrototypeOf(e)){if(d=e.ResultEl.ResultType,F=t.ResultEl.ResultType,this.CheckElTypeCompatibility(d,F,1)>1)return n&&this.RaiseIncompatibleType(20170402112648,3019,[],d,F,i),a;e.GetIsAsync()!==t.GetIsAsync()&&this.RaiseMsg(20200524112519,3052,rtl.getResStr(Ce,"sXModifierMismatchY"),Ye(18,"procedure type",18,"async"),i)}return a=!0},this.CheckProcArgCompatibility=function(e,t){return e.Access!==t.Access?2147483647:this.CheckElTypeCompatibility(e.ArgType,t.ArgType,1)},this.CheckElTypeCompatibility=function(e,t,s){var i=0,r=q.$new(),n=q.$new(),l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=0,m=null,C=null;if(e===t)return 0;if(this.ComputeElement(e,r,rtl.createSet(4),null),this.ComputeElement(t,n,rtl.createSet(4),null),this.IsGenericTemplType(r))return i=1,r.LoTypeEl===n.LoTypeEl||this.IsGenericTemplType(n)&&(h=r.LoTypeEl,u=n.LoTypeEl,xe.isPrototypeOf(h.FParent)&&xe.isPrototypeOf(u.FParent)&&(c=this.GetProcTemplateTypes(h.FParent),p=this.GetProcTemplateTypes(u.FParent),(F=c.IndexOf(h))>=0&&F===p.IndexOf(u)))?0:i;if(this.IsGenericTemplType(n))return 1;if(r.BaseType!==n.BaseType||null===r.LoTypeEl||null===n.LoTypeEl)return 2147483647;if(1===s){if(this.IsSameType(r.HiTypeEl,n.HiTypeEl,1))return 0}else if(this.IsSameType(r.LoTypeEl,n.LoTypeEl,0))return 0;if(2===r.BaseType){if((l=r.LoTypeEl.$class.ClassType())!==n.LoTypeEl.$class.ClassType())return 2147483647;if(l===Ue)return a=r.LoTypeEl,o=n.LoTypeEl,rtl.length(a.Ranges)!==rtl.length(o.Ranges)?2147483647:(rtl.length(a.Ranges)>0&&this.RaiseNotYetImplemented(20170328093733,a.Ranges[0],"anonymous static array"),i=this.CheckElTypeCompatibility(this.GetArrayElType(a),this.GetArrayElType(o),s));if(l.InheritsFrom(we)&&!(3 in this.FCurrentParser.GetCurrentModeSwitches())){if(m=r.LoTypeEl,C=n.LoTypeEl,m.CallingConvention!==C.CallingConvention)return 2147483647;if(rtl.neSet(m.Modifiers,C.Modifiers))return 2147483647;if(m.VarArgsType!==C.VarArgsType&&2147483647===(i=this.CheckElTypeCompatibility(m.VarArgsType,C.VarArgsType,s)))return i;if(f=m.Args,d=C.Args,f.FCount!==d.FCount)return 2147483647;for(var S=0,T=f.FCount-1;S<=T;S++)if(F=S,(i=this.CheckProcArgCompatibility(rtl.getObject(f.Get(F)),rtl.getObject(d.Get(F))))>1)return 2147483647;return 0}}return i=2147483647},this.CheckCanBeLHS=function(e,t,s){var i,n;return i=!1,null!==(n=e.IdentEl)||Lt.isPrototypeOf(e.ExprEl)&&25===e.ExprEl.OpCode?rtl.neSet(rtl.intersectSet(rtl.createSet(1,2),e.Flags),{})?!this.IsVariableConst(n,s,t):t?(ve.isPrototypeOf(e.IdentEl)?this.RaiseMsg(20170216152427,3027,rtl.getResStr(Ce,"sPropertyNotWritable"),[],s):it.isPrototypeOf(e.IdentEl)?this.RaiseMsg(20180430012042,3110,rtl.getResStr(Ce,"sCantAssignValuesToConstVariable"),[],s):this.RaiseMsg(20170216152429,3008,rtl.getResStr(Ce,"sVariableIdentifierExpected"),[],s),i):i:(t&&(null!==e.LoTypeEl&&null!==e.ExprEl?this.RaiseXExpectedButYFound(20170216152727,"identifier",r.GetElementTypeName(e.LoTypeEl),e.ExprEl):this.RaiseVarExpected(20170216152426,s,e.IdentEl)),i)},this.CheckAssignCompatibility=function(e,t,s,i){var r,n=q.$new(),l=q.$new(),a={};return null===i&&(i=t),this.ComputeElement(e,n,rtl.createSet(1),null),a={},this.IsProcedureType(n,!0)&&(a=3 in this.FCurrentParser.GetCurrentModeSwitches()?rtl.includeSet(a,1):rtl.includeSet(a,2)),this.ComputeElement(t,l,rtl.refSet(a),null),r=this.CheckAssignResCompatibility(n,l,i,s),Yt.isPrototypeOf(t)&&this.CheckAssignExprRange(n,t),r},this.CheckAssignExprRange=function(e,t){var s=null,i=null,n=0,l=0,a=0,o=null,h=null,u=null,c=0,p=null;if((null===(p=e.LoTypeEl)||p.$class.ClassType()!==Ue&&p.$class.ClassType()!==Me)&&!Le.isPrototypeOf(p)&&null!==(i=this.Eval(t,rtl.createSet(3),!0))){s=null;try{if(13===i.Kind);else if(1===e.BaseType)this.CheckAssignExprRangeToCustom(e,i,t);else if(34===e.BaseType)(h=p.$class.ClassType())===Je?(o=p.RangeExpr,s=this.Eval(o,rtl.createSet(0),!1)):h===Ge?(u=p,s=ns.$create("CreateValue",[1,u,0,u.Values.FCount-1])):h===me?Z.isPrototypeOf(p.FData)?(c=this.GetActualBaseType(p.FData.BaseType))in r.btAllIntegerNoQWord&&this.GetIntegerRange(c,{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}})?s=ns.$create("CreateValue",[2,null,l,a]):15===c?s=ns.$create("CreateValue",[4,null,0,1]):6===c?s=ns.$create("CreateValue",[3,null,0,65535]):this.RaiseNotYetImplemented(20170714205110,t,""):this.RaiseNotYetImplemented(20170714204803,t,""):this.RaiseNotYetImplemented(20170714193100,t,""),this.fExprEvaluator.IsSetCompatible(i,t,s,!0);else if(Je.isPrototypeOf(p))o=p.RangeExpr,s=this.Eval(o,rtl.createSet(0),!0),34===e.BaseType?this.fExprEvaluator.IsSetCompatible(i,t,s,!0):this.fExprEvaluator.IsInRange$1(i,t,s,o,!0);else if(e.BaseType in r.btAllIntegerNoQWord&&this.GetIntegerRange(e.BaseType,{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}})){var f=i.Kind;4===f?(l>i.Int||a<i.Int)&&this.fExprEvaluator.EmitRangeCheckConst$1(20170530093126,Ae(i.Int),l,a,t,2):5===f?(i.UInt>9007199254740991||l>i.UInt||a<i.UInt)&&this.fExprEvaluator.EmitRangeCheckConst(20170530093616,Ae(i.UInt),Ae(l),Ae(a),t,2):6===f?i.IsInt({get:function(){return n},set:function(e){n=e}})?(l>n||a<n)&&this.fExprEvaluator.EmitRangeCheckConst$1(20170802133307,Ae(n),l,a,t,1):this.RaiseRangeCheck(20170802133750,t):7===f?i.IsInt({get:function(){return n},set:function(e){n=e}})?(l>n||a<n)&&this.fExprEvaluator.EmitRangeCheckConst$1(20180421171325,Ae(n),l,a,t,1):this.RaiseRangeCheck(20180421171438,t):this.RaiseNotYetImplemented(20170530092731,t,"")}else if(i.Kind in rtl.createSet(2,3));else if(e.BaseType in rtl.createSet(10,11,14));else if(e.BaseType in r.btAllChars){8===i.Kind?n=this.fExprEvaluator.StringToOrd(i,t):this.RaiseNotYetImplemented(20170714171218,t,""),6===this.GetActualBaseType(e.BaseType)&&(a=65535),n>a&&this.fExprEvaluator.EmitRangeCheckConst(20170714171911,"#"+Ae(n),"#0","#"+Ae(a),t,2)}else if(e.BaseType in r.btAllStrings);else if(2===e.BaseType);else if(37===e.BaseType)if(Bt.isPrototypeOf(e.ExprEl)&&7===e.ExprEl.Kind){s=this.Eval(e.ExprEl,rtl.createSet(0),!0);try{if(10===s.Kind)1===s.ElKind?9!==i.Kind?this.RaiseNotYetImplemented(20171009171251,t,""):(i.Index<s.RangeStart||i.Index>s.RangeEnd)&&this.fExprEvaluator.EmitRangeCheckConst(20171009171442,i.AsString(),s.ElementAsString(s.RangeStart),s.ElementAsString(s.RangeEnd),t,2):this.RaiseNotYetImplemented(20171009165348,e.ExprEl,"");else this.RaiseNotYetImplemented(20171009165326,e.ExprEl,"")}finally{Ot({get:function(){return s},set:function(e){s=e}})}}else this.RaiseNotYetImplemented(20171009171005,t,"");else this.RaiseNotYetImplemented(20170530095243,t,"")}finally{Ot({get:function(){return i},set:function(e){i=e}}),Ot({get:function(){return s},set:function(e){s=e}})}}},this.CheckAssignExprRangeToCustom=function(e,t,s){e.BaseType},this.CheckAssignResCompatibility=function(e,t,s,i){var n=0,l=null,a=null,o=!1,h=null,u=0,c=0,p=null,f=null,d=null,F=q.$new(),m="\0";if(n=-1,o=!1,n=this.CheckAssignCompatibilityCustom(e,t,s,i,{get:function(){return o},set:function(e){o=e}}),o&&n>=0&&n<2147483647)return n;if(!o){if(u=this.GetActualBaseType(e.BaseType),c=this.GetActualBaseType(t.BaseType),this.IsGenericTemplType(e))return i||(s=null),n=this.CheckTemplateFitsParamRes(e.LoTypeEl,t,0,s);if(this.IsGenericTemplType(t))return i||(s=null),n=this.CheckTemplateFitsParamRes(t.LoTypeEl,e,1,s);if(null===e.LoTypeEl)4===u?n=1e4:this.RaiseNotYetImplemented(20160922163631,e.IdentEl,"");else if(u===c){if(2===u)return this.CheckAssignCompatibilityUserType(e,t,s,i);n=this.IsSameType(e.HiTypeEl,t.HiTypeEl,1)&&this.HasExactType(t)?0:2}else if(u in r.btAllBooleans&&c in r.btAllBooleans)n=3;else if(u in r.btAllChars){if(c in r.btAllChars)6===u?n=1e5:this.RaiseNotYetImplemented(20170728132440,s,this.GetBaseTypeNames(u));else if(37===c&&t.SubType in r.btAllChars){if(6===u)return 3;this.RaiseNotYetImplemented(20171108195216,s,"")}}else if(u in r.btAllStrings){if(c in r.btAllStringAndChars){8===u||9===u?n=3:this.RaiseNotYetImplemented(20170417195208,s,this.GetBaseTypeNames(u))}else if(2===c)if((a=t.LoTypeEl).$class.ClassType()===$e){if(2===a.ObjKind&&this.IsTGUIDString(e))return this.cInterfaceToString}else a.$class.ClassType()===Me&&this.IsTGUID(a)&&(n=this.cTGUIDToString)}else if(u in r.btAllInteger&&c in r.btAllInteger){n=37+u-c;var C=u;19===C||20===C?n+=1e5:21===C||22===C?c in rtl.createSet(19,20)||(n+=1e5):23===C?c in rtl.createSet(19,20,21,22)||(n+=1e5):24===C?c in rtl.createSet(19,20,21,22,23)||(n+=1e5):25===C||26===C?c in rtl.createSet(19,20,21,22,23,24)||(n+=1e5):27===C?c in rtl.createSet(19,20,21,22,25,26)||(n+=1e5):28===C?c in rtl.createSet(19,20,21,22,25,26,27)||(n+=1e5):this.RaiseNotYetImplemented(20170417205301,s,this.GetBaseTypeNames(u))}else if(u in r.btAllFloats&&c in r.btAllFloats){n=74+u-c;10===u?c>10&&(n+=1e5):11===u?c>11&&(n+=1e5):12===u||13===u?c>13&&(n+=1e5):14===u?n+=1e5:this.RaiseNotYetImplemented(20170417205910,s,this.GetBaseTypeNames(u))}else if(u in r.btAllFloats&&c in r.btAllInteger){n=4e5+u-c;10===u?c>23&&(n+=1e5):11===u?c>27&&(n+=1e5):12===u||13===u?c>13&&(n+=1e5):14===u?c in rtl.createSet(19,20,21,22,24,23,25,26)||(n+=1e5):this.RaiseNotYetImplemented(20170417205911,s,this.GetBaseTypeNames(u))}else{if(30===u)return i&&this.RaiseMsg(20170216152431,3043,rtl.getResStr(Ce,"sCantAssignValuesToAnAddress"),[],s),2147483647;if(37===u){if(Bt.isPrototypeOf(e.ExprEl)&&7===e.ExprEl.Kind){p=this.Eval(e.ExprEl,rtl.createSet(0),!0),f=null;try{if(10===p.Kind){var S=p.ElKind;if(1===S){if(2===t.BaseType&&this.IsSameType(p.ElType,t.LoTypeEl,2))return 0}else if(2===S){if(t.BaseType in r.btAllInteger)return f=this.Eval$1(t,rtl.createSet(3),!0),3}else if(3===S){if(t.BaseType in r.btAllStringAndChars){if(null!==(f=this.Eval$1(t,rtl.createSet(3),!0))){var T=f.Kind;if(8===T){if(1!==f.S.length)return 2147483647;m=f.S.charAt(0)}else{if(13===T)return 3;this.RaiseNotYetImplemented(20171108192232,s,"")}if(m.charCodeAt()<p.RangeStart||m.charCodeAt()>p.RangeEnd)return 2147483647}return 3}}else if(4===S&&15===t.BaseType)return f=this.Eval$1(t,rtl.createSet(3),!0),3}}finally{Ot({get:function(){return p},set:function(e){p=e}}),Ot({get:function(){return f},set:function(e){f=e}})}}}else if(34===u)36===c&&(0===t.SubType||this.IsSameType(e.HiTypeEl,t.HiTypeEl,1)&&this.HasExactType(t)?n=0:e.SubType===t.SubType?n=2:(e.SubType in r.btAllBooleans&&t.SubType in r.btAllBooleans||e.SubType in r.btAllInteger&&t.SubType in r.btAllInteger||e.SubType in r.btAllChars&&t.SubType in r.btAllChars)&&(n=3));else{if(u in rtl.createSet(35,36,3,31))return i&&this.RaiseMsg(20170216152432,3044,rtl.getResStr(Ce,"sIllegalExpression"),[],s),2147483647;if(null===e.IdentEl&&null===e.ExprEl)return i&&this.RaiseMsg(20170216152434,3044,rtl.getResStr(Ce,"sIllegalExpression"),[],s),2147483647;if(30===c)(29===u||2===u&&((h=(l=e.LoTypeEl).$class.ClassType())===$e||h===Le||h===Be||h.InheritsFrom(we)||this.IsDynArray(l,!0)))&&(n=0);else if(31===c){if(3 in this.FCurrentParser.GetCurrentModeSwitches()&&we.isPrototypeOf(e.LoTypeEl)&&xe.isPrototypeOf(t.IdentEl)){if(this.CheckProcTypeCompatibility(e.LoTypeEl,t.IdentEl.ProcType,!0,s,i))return 0}else if(we.isPrototypeOf(e.LoTypeEl)&&jt.isPrototypeOf(t.ExprEl)&&this.CheckProcTypeCompatibility(e.LoTypeEl,t.ExprEl.Proc.ProcType,!0,s,i))return 0}else if(29===u){if(29===c)l=e.LoTypeEl,a=t.LoTypeEl,this.IsBaseType(l,29,!1)?n=0:this.IsBaseType(a,29,!1)?n=1e4:this.IsSameType(l,a,2)?n=0:l.$class.ClassType()===Be&&a.$class.ClassType()===Be&&(n=this.CheckAssignCompatibility(l.DestType,a.DestType,i,null));else if(this.IsBaseType(e.LoTypeEl,29,!1)&&2===c){if((h=(a=t.LoTypeEl).$class.ClassType())===$e)return 1e4;h===Le?n=1e4:h===Ue?this.IsDynArray(a,!0)&&(n=1e4):h===we||h===Ve?n=1e5:h===Be&&(n=0)}}else if(2===u)if((l=e.LoTypeEl).$class.ClassType()===Ue)n=this.CheckAssignCompatibilityArrayType(e,t,s,i);else if(l.$class.ClassType()===Ge)37===t.BaseType&&2===t.SubType&&(a=t.LoTypeEl).$class.ClassType()===Je&&(this.ComputeElement(a.RangeExpr.Left,F,rtl.createSet(3),null),2===F.BaseType&&this.IsSameType(l,F.LoTypeEl,2)&&(n=0));else if(l.$class.ClassType()===Me){if(c in r.btAllStrings&&this.IsTGUID(l)&&0 in t.Flags){d=this.Eval$1(t,rtl.createSet(1),!0);try{if(null===d){if(!i)return 2147483647;this.RaiseXExpectedButYFound(20180414105916,"string literal","string",s)}}finally{Ot({get:function(){return d},set:function(e){d=e}})}n=this.cStringToTGUID}}else l.$class.ClassType()===Be&&29===t.BaseType&&(a=t.LoTypeEl,n=this.IsBaseType(a,29,!1)?1e4:this.CheckAssignCompatibilityPointerType(l.DestType,a,s,!1))}}}return n>=0&&n<2147483647?0 in t.Flags?n:(i&&this.RaiseVarExpected(20170318235637,s,t.IdentEl),2147483647):i?(this.RaiseIncompatibleTypeRes(20170216152437,3028,[],t,e,s),n):2147483647},this.CheckEqualElCompatibility=function(e,t,s,i,r){var n={},l={},a=q.$new(),o=q.$new(),h=null,u=null;return n=3 in this.FCurrentParser.GetCurrentModeSwitches()?{}:rtl.createSet(2),r&&(n=rtl.includeSet(n,0)),this.ComputeElement(e,a,rtl.refSet(n),null),l=3 in this.FCurrentParser.GetCurrentModeSwitches()?rtl.refSet(n):30===a.BaseType||this.IsProcedureType(a,!0)?rtl.createSet(2):{},r&&(l=rtl.includeSet(l,0)),this.ComputeElement(t,o,rtl.refSet(l),null),null===s?(h=e,u=t):(h=s,u=s),this.CheckEqualResCompatibility(a,o,h,i,u)},this.CheckEqualResCompatibility=function(e,t,s,i,n){var l=0,a=null,o=null,h=q.$new();if(l=2147483647,null===n&&(n=s),!(0 in e.Flags)){if(2===e.BaseType&&(a=e.LoTypeEl).$class.ClassType()===$e&&this.ResolveAliasTypeEl(e.IdentEl)===a){if(30===t.BaseType)return 0;if(t.BaseType in r.btAllStrings){if(0 in t.Flags&&2===a.ObjKind&&this.IsTGUIDString(t))return this.cInterfaceToString}else if(2===t.BaseType){if((o=t.LoTypeEl).$class.ClassType()===Le&&0 in t.Flags&&1===a.ObjKind)return 0;if(o.$class.ClassType()===Me&&0 in t.Flags&&2===a.ObjKind&&this.IsTGUID(o))return this.cInterfaceToTGUID}}this.RaiseMsg(20170216152438,3038,rtl.getResStr(Ce,"sNotReadable"),[],s)}if(!(0 in t.Flags)){if(2===t.BaseType&&(o=t.LoTypeEl).$class.ClassType()===$e&&this.ResolveAliasTypeEl(t.IdentEl)===o){if(30===e.BaseType)return 0;if(e.BaseType in r.btAllStrings){if(0 in e.Flags&&2===o.ObjKind&&this.IsTGUIDString(e))return this.cInterfaceToString}else if(2===e.BaseType){if((a=e.LoTypeEl).$class.ClassType()===Le&&0 in e.Flags&&1===o.ObjKind)return 0;if(a.$class.ClassType()===Me&&0 in e.Flags&&2===o.ObjKind&&this.IsTGUID(a))return this.cInterfaceToTGUID}}this.RaiseMsg(20170216152440,3038,rtl.getResStr(Ce,"sNotReadable"),[],n)}if(this.IsGenericTemplType(e)){if(2147483647!==(l=this.CheckTemplateFitsParamRes(e.LoTypeEl,t,2,null)))return l}else if(this.IsGenericTemplType(t)&&2147483647!==(l=this.CheckTemplateFitsParamRes(t.LoTypeEl,e,2,null)))return l;if(1===e.BaseType||1===t.BaseType)return 2147483647===(l=this.CheckEqualCompatibilityCustomType(e,t,s,i))&&i&&this.RaiseIncompatibleTypeRes(20170330010727,3028,[],t,e,s),l;if(e.BaseType===t.BaseType)return 2===e.BaseType?this.CheckEqualCompatibilityUserType(e,t,s,i):0;if(e.BaseType in r.btAllInteger){if(t.BaseType in rtl.unionSet(r.btAllInteger,r.btAllFloats))return 3;if(37===t.BaseType&&t.SubType in r.btAllInteger)return 3}else if(e.BaseType in r.btAllFloats){if(t.BaseType in rtl.unionSet(r.btAllInteger,r.btAllFloats))return 3}else if(e.BaseType in r.btAllBooleans){if(t.BaseType in r.btAllBooleans)return 3;if(37===t.BaseType&&t.SubType in r.btAllBooleans)return 3}else if(e.BaseType in r.btAllStringAndChars){if(t.BaseType in r.btAllStringAndChars)return 3;if(37===t.BaseType&&t.SubType in r.btAllChars)return 3;if(2===t.BaseType)if((o=t.LoTypeEl).$class.ClassType()===$e){if(2===o.ObjKind&&this.IsTGUIDString(e))return this.cInterfaceToString}else if(o.$class.ClassType()===Me&&this.IsTGUID(o))return this.cTGUIDToString}else if(30===e.BaseType){if(t.BaseType in rtl.createSet(29,30))return 0;if(2===t.BaseType&&((a=t.LoTypeEl).$class.ClassType()===$e||a.$class.ClassType()===Le||a.$class.ClassType()===Be||we.isPrototypeOf(a)||this.IsDynArray(a,!0)))return 0;if(!i)return 2147483647;this.RaiseIncompatibleTypeRes(20170216152442,3028,[],t,e,n)}else if(30===t.BaseType){if(29===e.BaseType)return 0;if(2===e.BaseType&&((a=e.LoTypeEl).$class.ClassType()===$e||a.$class.ClassType()===Le||a.$class.ClassType()===Be||we.isPrototypeOf(a)||this.IsDynArray(a,!0)))return 0;if(!i)return 2147483647;this.RaiseIncompatibleTypeRes(20170216152444,3028,[],t,e,s)}else if(29===e.BaseType){if(2===t.BaseType){if((o=t.LoTypeEl).$class.ClassType()===Be)return 0;if(o.$class.ClassType()===$e)return 3;if(o.$class.ClassType()===Le)return 3}}else if(e.BaseType in rtl.createSet(34,36)){if(t.BaseType in rtl.createSet(34,36)){if(null===e.LoTypeEl)return 0;if(null===t.LoTypeEl)return 0;if(this.IsSameType(e.LoTypeEl,t.LoTypeEl,2))return 0;if(e.SubType===t.SubType&&e.SubType in rtl.unionSet(rtl.unionSet(r.btAllBooleans,r.btAllInteger),r.btAllChars))return 0;if(e.SubType in r.btAllBooleans&&t.SubType in r.btAllBooleans||e.SubType in r.btAllInteger&&t.SubType in r.btAllInteger)return 3;if(!i)return 2147483647;this.RaiseMsg(20170216152446,3028,rtl.getResStr(Ce,"sIncompatibleTypesGotExpected"),Ye(18,"set of "+this.GetBaseTypeNames(e.SubType),18,"set of "+this.GetBaseTypeNames(t.SubType)),s)}}else if(37===e.BaseType){if(e.SubType in r.btAllInteger){if(t.BaseType in r.btAllInteger)return 3;if(37===t.BaseType&&t.SubType in r.btAllInteger)return 3}else if(e.SubType in r.btAllBooleans){if(t.BaseType in r.btAllBooleans)return 3;if(37===t.BaseType&&t.SubType in r.btAllBooleans)return 3}else if(e.SubType in r.btAllChars){if(t.BaseType in r.btAllStringAndChars)return 3;if(37===t.BaseType&&t.SubType in r.btAllChars)return 3}else if(2===e.SubType&&(a=e.LoTypeEl).$class.ClassType()===Je&&(this.ComputeElement(a.RangeExpr.Left,h,rtl.createSet(3),null),2===h.BaseType&&(a=h.LoTypeEl).$class.ClassType()===Ge&&2===t.BaseType&&a===(o=t.LoTypeEl)))return 3}else if(2===e.BaseType)if((a=e.LoTypeEl).$class.ClassType()===Ge){if(37===t.BaseType&&(o=t.LoTypeEl).$class.ClassType()===Je&&(this.ComputeElement(o.RangeExpr.Left,h,rtl.createSet(3),null),2===h.BaseType&&a===(o=h.LoTypeEl)))return 3}else if(a.$class.ClassType()===$e){if(29===t.BaseType)return 3;if(2===a.ObjKind)if(t.BaseType in r.btAllStrings){if(this.IsTGUIDString(t))return this.cInterfaceToString}else if(2===t.BaseType&&(o=t.LoTypeEl).$class.ClassType()===Me&&this.IsTGUID(o))return this.cInterfaceToTGUID}else if(a.$class.ClassType()===Le){if(29===t.BaseType)return 3}else if(a.$class.ClassType()===Me){if(this.IsTGUID(a)){if(t.BaseType in r.btAllStrings)return this.cTGUIDToString;if(2===t.BaseType&&(o=t.LoTypeEl).$class.ClassType()===$e&&2===o.ObjKind)return this.cInterfaceToTGUID}}else if(a.$class.ClassType()===Be&&29===t.BaseType)return 0;return i?(this.RaiseIncompatibleTypeRes(20170216152449,3028,[],t,e,n),l):2147483647},this.IsVariableConst=function(e,t,s){var i=null,r=q.$new(),n=null;for(i=t;null!==i;){if(i.$class.ClassType()===Et&&(n=i).VariableName!==t&&(this.ComputeElement(n.VariableName,r,rtl.createSet(1),null),r.IdentEl===e))return s&&this.RaiseMsg(20180430100719,3111,rtl.getResStr(Ce,"sIllegalAssignmentToForLoopVar"),Ye(18,e.FName),t),!0;i=i.FParent}return false},this.ResolvedElCanBeVarParam=function(e,t,s){var i=this,r=!1;function n(e){return!i.IsVariableConst(e,t,s)}var l=null;return r=!1,rtl.neSet(rtl.intersectSet(rtl.createSet(0,1),e.Flags),rtl.createSet(0,1))?r:null===e.IdentEl||((l=e.IdentEl).$class.ClassType()===He?n(l):l.$class.ClassType()===it?l.IsConst?(s&&this.RaiseMsg(20180430100719,3110,rtl.getResStr(Ce,"sCantAssignValuesToConstVariable"),[],t),!1):n(l):l.$class.ClassType()===We?l.Access in rtl.createSet(1,4)?(s&&this.RaiseMsg(20180430100843,3110,rtl.getResStr(Ce,"sCantAssignValuesToConstVariable"),[],t),!1):(r=l.Access in rtl.createSet(0,2,3))&&n(l):l.$class.ClassType()===$t||2 in this.FOptions&&l.$class.ClassType()===ve?n(l):r)},this.ResolvedElIsClassOrRecordInstance=function(e){var t,s=null,i=null;if(t=!1,2!==e.BaseType)return t;if(null===(s=e.LoTypeEl))return t;if(s.$class.ClassType()===$e){if(1!==s.ObjKind)return t}else if(s.$class.ClassType()!==Me)return t;return!(null===e.IdentEl||!(i=e.IdentEl.$class.ClassType()).InheritsFrom(He)&&i!==We&&i!==$t)||t},this.GetResolver=function(e){var t,s,i=null;return i=null,null===e||null===(t=e.GetModule())||null===(s=rtl.as(t.FData,F))?i:i=rtl.as(s.Owner,re)},this.ElHasModeSwitch=function(e,t){return t in this.GetElModeSwitches(e)},this.GetElModeSwitches=function(e){for(var t=null;null!==e;){if(null!==e.FData){if((t=e.FData.$class.ClassType()).InheritsFrom($))return e.FData.ModeSwitches;if(t.InheritsFrom(g))return e.FData.ModeSwitches}e=e.FParent}return rtl.refSet(this.FCurrentParser.GetCurrentModeSwitches())},this.ElHasBoolSwitch=function(e,t){return t in this.GetElBoolSwitches(e)},this.GetElBoolSwitches=function(e){var t,s=null;for(t=rtl.refSet(this.FCurrentParser.FScanner.FCurrentBoolSwitches);null!==e;){if(null!==e.FData){if((s=e.FData.$class.ClassType()).InheritsFrom($))return e.FData.BoolSwitches;if(s.InheritsFrom(g))return e.FData.BoolSwitches;if(s.InheritsFrom(F))return e.FData.BoolSwitches}e=e.FParent}return t},this.GetProcTypeDescription=function(e,t){var s="",i=null,n=null,l=0,a=null,o=null,h=null;if(null===e)return"nil";if(s=e.$class.TypeName(),e.GetIsReference()&&(s=Fe.ProcTypeModifiers[4]+" "+s),xe.isPrototypeOf(e.FParent)&&(h=e.FParent,0 in t&&(s=1 in t?s+" "+h.FullName():s+" "+h.FName),null!==(n=this.GetProcTemplateTypes(h))&&(s+=ot(n.FCount))),(i=e.Args).FCount>0){s+="(";for(var u=0,c=i.FCount-1;u<=c;u++)(l=u)>0&&(s+=";"),a=rtl.getObject(i.Get(l)),""!==Fe.AccessNames[a.Access]&&(s+=Fe.AccessNames[a.Access]),null===a.ArgType?s+="untyped":(o=a.ArgType,2 in t&&(o=r.ResolveSimpleAliasType(o)),s+=this.GetTypeDescription(o,1 in t));s+=")"}return e.GetIsOfObject()&&(s=s+" "+Fe.ProcTypeModifiers[0]),e.GetIsNested()&&(s=s+" "+Fe.ProcTypeModifiers[1]),""!==Fe.cCallingConventions[e.CallingConvention]&&(s=s+";"+Fe.cCallingConventions[e.CallingConvention]),s},this.GetResolverResultDescription=function(e,t){var s=this,i="";function n(){return null!==e.LoTypeEl&&""!==e.LoTypeEl.FName?e.LoTypeEl.FName:s.GetBaseTypeNames(e.SubType)}var l=null,a=e.BaseType;return 3===a?r.GetElementTypeName(e.IdentEl)+" "+e.IdentEl.FName:30===a?"nil":(37===a?i="range of "+n():34===a?i="set of "+n():35===a?i="array of "+n():36===a?i="set/array literal of "+n():2===a?e.LoTypeEl.$class.ClassType()===Le?i="class of "+e.LoTypeEl.DestType.FName:e.LoTypeEl.$class.ClassType()===qt?i=e.LoTypeEl.DestType.FName:e.LoTypeEl.$class.ClassType()===Qt?i="type "+e.LoTypeEl.DestType.FName:e.LoTypeEl.$class.ClassType()===Ue?(l=e.LoTypeEl,0===rtl.length(l.Ranges)?null===l.ElType?i="array of const":(i="array of "+l.ElType.FName,this.IsOpenArray(l)&&(i="open "+i)):i="static array[] of "+l.ElType.FName):i=we.isPrototypeOf(e.LoTypeEl)?this.GetProcTypeDescription(e.LoTypeEl,{}):""!==e.LoTypeEl.FName?e.LoTypeEl.FName:e.LoTypeEl.ElementTypeName():i=1===a?e.LoTypeEl.FName:this.GetBaseTypeNames(e.BaseType),t||e.LoTypeEl===e.IdentEl||null===e.IdentEl||(i=e.IdentEl.FName+":"+i),i)},this.GetTypeDescription=function(e,t){var s=this,i="";return null===e?"untyped":(i=function(){var i="",n="",l=null,a=null,h=0,u=null,c=[];if(""===(i=e.FName))if(Ue.isPrototypeOf(e))i=rtl.length(e.Ranges)>0?"static array":null===e.ElType?"array of const":s.IsOpenArray(e)?"open array":"dynamic array";else if(Kt.isPrototypeOf(e)){if(l=e,o.isPrototypeOf(l.FData))return s.GetTypeDescription(l.FData.SpecializedType,!1);i=s.GetTypeDescription(l.DestType,!0)+"<";for(var p=0,f=l.Params.FCount-1;p<=f;p++)h=p,a=rtl.getObject(l.Params.Get(h)),De.isPrototypeOf(a)&&(i+=s.GetTypeDescription(a,!1)),h>0&&(i+=",");i+=">"}else i=r.GetElementTypeName(e);else if(ke.isPrototypeOf(e))if((h=s.GetTypeParameterCount(e))>0)i+=ot(s.GetTypeParameterCount(e));else if(R.isPrototypeOf(e.FData)&&null!==(u=e.FData).SpecializedFromItem&&r.IsValidIdent(e.FName,!1,!1)){c=u.SpecializedFromItem.Params,i+="<";for(var d=0,F=rtl.length(c)-1;d<=F;d++)h=d,i+=s.GetTypeDescription(c[h],t),h>0&&(i+=",");i+=">"}return t&&""!==(n=e.ParentPath())&&"."!==n&&(i=n+"."+i),i}(),e.$class.ClassType()===me?(ee.isPrototypeOf(e.FData)&&(i+="()"),i):i)},this.GetTypeDescription$1=function(e,t){var s="",i="";return s=this.GetTypeDescription(e.LoTypeEl,t),e.BaseType in rtl.createSet(34,35,36)&&(s=this.GetBaseTypeNames(e.BaseType)+" of "+s),null!==e.LoTypeEl&&e.IdentEl===e.LoTypeEl&&(s=""!==(i=r.GetElementTypeName(e.LoTypeEl))?i+" "+s:"type "+s),s},this.GetBaseDescription=function(e,t){return 2===e.BaseType?this.GetTypeDescription$1(e,t):29!==e.BaseType||this.IsBaseType(e.LoTypeEl,29,!1)?this.GetBaseTypeNames(e.BaseType):"^"+this.GetTypeDescription$1(e,t)},this.GetProcFirstImplEl=function(e){var t=null,s=null;if(t=null,null===e)return t;if(null===(s=null!==e.Body?e.Body.Body:null)){if(null===e.FData)return t;if(null===(e=rtl.as(e.FData,$).ImplProc))return t;if(null===e.Body)return t;if(null===(s=e.Body.Body))return t}return null===s.Elements||0===s.Elements.FCount?t:t=rtl.getObject(s.Elements.Get(0))},this.GetProcTemplateTypes=function(e){var t;return null===e.NameParts||null!==(t=rtl.getObject(e.NameParts.Get(e.NameParts.FCount-1)).Templates)&&0===t.FCount?null:t},this.GetProcName=function(e,t){var s="",i=null,r=0,n=0,l=null,a=null;if(null===e)return"(nil)";if(s=e.FName,t){if(null===(i=e.NameParts))return s;s="";for(var o=0,h=i.FCount-1;o<=h;o++)if((r=o)>0&&(s+="."),s+=(l=rtl.getObject(i.Get(r))).Name,null!==(a=l.Templates)&&a.FCount>0){for(var u=0,c=a.FCount-1;u<=c;u++)s+=0===(n=u)?"<":",",s+=rtl.getObject(l.Templates.Get(n)).FName;s+=">"}}return s},this.GetPasPropertyAncestor=function(e,t){var s=null;return s=null,null===e?s:t||null===e.VarType?null===e.FData?s:s=e.FData.AncestorProp:s},this.GetPasPropertyType=function(e){for(null;null!==e;){if(null!==e.VarType)return e.VarType;e=this.GetPasPropertyAncestor(e,!1)}return null},this.GetPasPropertyArgs=function(e){for(;null!==e;){if(null!==e.VarType)return e.FArgs;e=this.GetPasPropertyAncestor(e,!1)}return null},this.GetPasPropertyGetter=function(e){var t=null;for(t=null;null!==e;){if(null!==e.ReadAccessor)return t=rtl.as(e.ReadAccessor.FData,_).FDeclaration;e=this.GetPasPropertyAncestor(e,!1)}return t},this.GetPasPropertySetter=function(e){var t=null;for(t=null;null!==e;){if(null!==e.WriteAccessor)return t=rtl.as(e.WriteAccessor.FData,_).FDeclaration;e=this.GetPasPropertyAncestor(e,!1)}return t},this.GetPasPropertyIndex=function(e){var t=null;for(t=null;null!==e;){if(null!==e.IndexExpr)return t=e.IndexExpr;e=this.GetPasPropertyAncestor(e,!1)}return t},this.GetPasPropertyStoredExpr=function(e){var t=null;for(t=null;null!==e;){if(null!==e.StoredAccessor)return t=e.StoredAccessor;e=this.GetPasPropertyAncestor(e,!1)}return t},this.GetPasPropertyDefaultExpr=function(e){var t=null;for(t=null;null!==e;){if(null!==e.DefaultExpr)return t=e.DefaultExpr;if(e.IsNodefault)return null;e=this.GetPasPropertyAncestor(e,!1)}return t},this.GetPasClassAncestor=function(e,t){var s=null,i=null,n=null;if(s=null,null===e)return s;if(null===e.FData)return s;if(e.IsForward)i=rtl.as(e.FData,_).FDeclaration,s=e=rtl.as(r.NoNil(i),$e);else{if(!(0 in(n=rtl.as(e.FData,O)).Flags))return s;if(t){if(null===n.AncestorScope)return s;s=n.AncestorScope.FElement}else s=n.DirectAncestor}return s},this.GetParentProcBody=function(e){for(;null!==e;){if(Ne.isPrototypeOf(e))return e;e=e.FParent}return null},this.ProcHasImplElements=function(e){return null!==this.GetProcFirstImplEl(e)},this.IndexOfImplementedInterface=function(e,t){var s=null,i=0;if(null===t)return-1;t=this.ResolveAliasType(t,!0);for(var r=0,n=(s=e.Interfaces).FCount-1;r<=n;r++)if(i=r,this.ResolveAliasType(rtl.getObject(s.Get(i)),!0)===t)return i;return-1},this.GetLoop=function(e){for(;null!==e;){if(e.$class.ClassType()===Ct||e.$class.ClassType()===Tt||e.$class.ClassType()===Et)return e;e=e.FParent}return null},this.ResolveAliasType=function(e,t){for(var s=null,i=null;null!==e;)if((s=e.$class.ClassType())===qt)e=e.DestType;else if(s===Qt&&t)e=e.DestType;else if(s===$e&&e.IsForward&&_.isPrototypeOf(e.FData))e=rtl.as(r.NoNil(e.FData.FDeclaration),De);else{if(s!==Kt)return e;if(null!==(i=e).SubType)e=i.SubType;else{if(o.isPrototypeOf(i.FData))return i.FData.SpecializedType;e=i.DestType}}return null},this.ResolveAliasTypeEl=function(e){return De.isPrototypeOf(e)?this.ResolveAliasType(e,!0):null},this.ExprIsAddrTarget=function(e){var t=!1,s=null,i=null,r=null;if(t=!1,null===e)return t;if(!this.IsNameExpr(e))return t;for(;;){if((r=(s=e.FParent).$class.ClassType())===Lt){if(24===s.OpCode)return!0}else if(r===Bt){if(s.Right!==e)return t;if(27!==s.OpCode)return t}else{if(r!==Mt)return r===ve?t=(i=s).ReadAccessor===e||i.WriteAccessor===e||i.StoredAccessor===e:r===dt?s.Right!==e?t:3 in this.FCurrentParser.GetCurrentModeSwitches()||t:r===ls||t;if(s.Value!==e)return t}e=s}return t},this.IsNameExpr=function(e){return e.$class.ClassType()===Dt&&0===e.Kind},this.GetNameExprValue=function(e){return null===e?"":e.$class.ClassType()===Dt&&0===e.Kind?e.Value:""},this.GetNextDottedExpr=function(e){var t,s=null,i=null;if(t=null,null===e)return t;for(;;){if(!Bt.isPrototypeOf(e.FParent))return t;if(27!==(s=e.FParent).OpCode)return t;if(e===s.Right)e=s;else{e=s.Right;do{if((i=e.$class.ClassType())===Dt)return 0!==e.Kind&&this.RaiseNotYetImplemented(20170502163825,e,""),e;i===Bt?(27!==e.OpCode&&this.RaiseNotYetImplemented(20170502163718,e,""),e=e.Left):i===Mt&&(e.Kind in rtl.createSet(10,11)||this.RaiseNotYetImplemented(20170502163908,e,""),e=e.Value)}while(null!==e);this.RaiseNotYetImplemented(20170502163953,s,"")}}return t},this.GetRightMostExpr=function(e){var t=null;for(t=e;null!==t;){if(e=t,t.$class.ClassType()!==Bt)return t;if(27!==t.OpCode)return t;t=t.Right}return t},this.GetParamsOfNameExpr=function(e,t){var s,i=null,r=null,n=null;if(t.InlineSpec=null,t.Params=null,this.IsNameExpr(e)&&null!==(i=e.FParent)){if(i.$class.ClassType()===Ht){if((n=i).NameExpr!==e)return;if(t.InlineSpec=n,null===(i=(e=n).FParent))return}if(i.$class.ClassType()===Bt){if(27!==(r=i).OpCode||r.Right!==e)return;i=(e=r).FParent}i.$class.ClassType()===Mt&&(s=i).Value===e&&s.Kind in rtl.createSet(10,11)&&(t.Params=s)}},this.GetUsesUnitInFilename=function(e){var t="",s=null;Dt.isPrototypeOf(e)||this.RaiseXExpectedButYFound(20180221234828,"string literal",r.GetElementTypeName(e),e),s=this.fExprEvaluator.Eval(e,rtl.createSet(0));try{null===s&&this.RaiseXExpectedButYFound(20180222000004,"string literal",r.GetElementTypeName(e),e),8===s.Kind?t=s.S:this.RaiseXExpectedButYFound(20180222000122,"string literal",s.AsDebugString(),e)}finally{Ot({get:function(){return s},set:function(e){s=e}})}return t},this.GetPathEndIdent=function(e,t){var s=null,i=null;for(s=null,t&&Mt.isPrototypeOf(e)&&(e=e.Value);Bt.isPrototypeOf(e);){if(27!==(i=e).OpCode)return null;e=i.Right}return Dt.isPrototypeOf(e)&&0===e.Kind&&(s=e),s},this.GetNewInstanceExpr=function(e){var t,s=null;for(t=null;null!==e;){if(_.isPrototypeOf(e.FData)&&3 in e.FData.Flags)return e;if((s=e.$class.ClassType())===Bt){if(27!==e.OpCode)return t;e=e.Right}else{if(s!==Mt)return t;e=e.Value}}return t},this.ParentNeedsExprResult=function(e){var t=!1,s=null,i=null;return null!==e&&null!==e.FParent&&(t=!1,(s=(i=e.FParent).$class.ClassType())===Bt?t=i.Right!==e||(!(27===i.OpCode||0===i.OpCode&&Vt.isPrototypeOf(i.Left))||this.ParentNeedsExprResult(i)):s===Ht?t=this.ParentNeedsExprResult(i):s.InheritsFrom(Yt)||s===Qe||s===We||s===He||s===ls?t=!0:s===$e?t=i.GUIDExpr===e:s===ve?t=i.IndexExpr===e||i.DispIDExpr===e||i.DefaultExpr===e:s===xe?t=i.LibraryExpr===e||i.DispIDExpr===e:s===Ct||s===St||s===Tt?t=i.ConditionExpr===e:s===Nt?t=i.Expressions.IndexOf(e)>=0:s===yt?t=i.CaseExpr===e:s===bt?t=i.Expressions.IndexOf(e)>=0:s===Et?t=i.StartExpr===e||i.EndExpr===e:s===dt?t=i.Right===e:s===Rt&&(t=i.ExceptAddr===e),t)},this.GetReference_ConstructorType=function(e,t){var s,i=q.$new();return null===(s=rtl.as(e.Context,K).Typ)?this.RaiseNotYetImplemented(20190125205339,t,""):ze.isPrototypeOf(s)?r.SetResolverValueExpr(i,2,s,s,t,rtl.createSet(0)):(this.ComputeElement(s,i,rtl.createSet(4),null),i.ExprEl=t,i.Flags=rtl.createSet(0)),i},this.GetParamsValueRef=function(e){var t,s=null;if(t=null,null===e)return t;for(s=e.Value;null!==s;){if(_.isPrototypeOf(s.FData))return s.FData;if(s.$class.ClassType()===Ht)s=s.NameExpr;else{if(s.$class.ClassType()!==Bt||27!==s.OpCode)return t;s=s.Right}}return t},this.GetSetType=function(e){var t=null,s=null,i=null,r=null;if(t=null,34===e.BaseType){if(null===(s=e.IdentEl))return t;if((r=s.$class.ClassType())===He||r===it)i=s.VarType;else if(r===ve)i=this.GetPasPropertyType(s);else if(r===We)i=s.ArgType;else{if(!r.InheritsFrom(xe)||!Ve.isPrototypeOf(s.ProcType))return r===lt?s:t;i=s.ProcType.ResultEl.ResultType}i.$class.ClassType()===lt&&(t=i)}else 2===e.BaseType&&e.LoTypeEl.$class.ClassType()===lt&&(t=e.HiTypeEl.$class.ClassType()===lt?e.HiTypeEl:e.LoTypeEl);return t},this.IsDynArray=function(e,t){return null!==(e=this.ResolveAliasType(e,!0))&&e.$class.ClassType()===Ue&&(0===rtl.length(e.Ranges)&&(!(!t||!(5 in this.FOptions))||(null===e.FParent||e.FParent.$class.ClassType()!==We)))},this.IsOpenArray=function(e){return null!==e&&e.$class.ClassType()===Ue&&0===rtl.length(e.Ranges)&&null!==e.FParent&&e.FParent.$class.ClassType()===We},this.IsArrayOfConst=function(e){return null!==e&&e.$class.ClassType()===Ue&&null===e.ElType},this.GetArrayElType=function(e){var t=null;return null===(t=e.ElType)&&(t=this.GetTVarRec(e)),t},this.IsEmptyArrayExpr=function(e){return e.BaseType in rtl.createSet(34,36,35)&&0===e.SubType},this.IsClassMethod=function(e){var t;return null!==e&&((t=e.$class.ClassType())===ht||t===ut||t===ts||t===ss||t===ws)},this.IsClassField=function(e){var t=null;return!(e.$class.ClassType()!==He&&e.$class.ClassType()!==it||!rtl.neSet(rtl.intersectSet(rtl.createSet(4,5),e.VarModifiers),{}))&&((t=e.FParent.$class.ClassType())===$e||t===Me)},this.MethodIsStatic=function(e){return e.IsStatic()||e.$class.ClassType()===ht||e.$class.ClassType()===ut},this.IsMethod_SelfIsClass=function(e){var t;return null!==e&&(((t=e.$class.ClassType())===ts||t===ss||t===ws)&&!e.IsStatic())},this.IsHelperMethod=function(e){return xe.isPrototypeOf(e)&&$e.isPrototypeOf(e.FParent)&&null!==e.FParent.HelperForType},this.IsHelper=function(e){return null!==e&&e.$class.ClassType()===$e&&null!==e.HelperForType},this.IsExternalClass_Name=function(e,t){var s,i=null;if(s=!1,null===e)return s;for(;null!==e;){if(e.ExternalName===t)return!0;if(null===(i=rtl.as(e.FData,O).AncestorScope))return s;e=rtl.as(r.NoNil(i.FElement),$e)}return s},this.IsProcedureType=function(e,t){var s;return 2===e.BaseType&&(s=e.LoTypeEl,!!we.isPrototypeOf(s)&&((!t||0 in e.Flags)&&true))},this.IsArrayType=function(e){return 2===e.BaseType&&Ue.isPrototypeOf(e.LoTypeEl)},this.IsArrayExpr=function(e){var t,s=null;return s=null,null===e||4!==e.Kind?s:_.isPrototypeOf(e.FData)?(t=e.FData,Ue.isPrototypeOf(t.FDeclaration)&&(s=t.FDeclaration),s):s},this.IsArrayOperatorAdd=function(e){return null!==e&&e.$class.ClassType()===Bt&&1===e.OpCode&&this.ElHasModeSwitch(e,44)},this.IsTypeCast=function(e){var t,s,i=null,r=null;return t=!1,null===e||10!==e.Kind?t:(s=e.Value,this.IsNameExpr(s)&&_.isPrototypeOf(s.FData)?((r=(i=s.FData.FDeclaration).$class.ClassType())!==qt&&r!==Qt||(r=(i=this.ResolveAliasType(i,!0)).$class.ClassType()),r===we||r===Ve||(r===$e||r===Le||r===Ge||r===Me||r===Ue||r===Kt||r===je||(!(r!==me||!Z.isPrototypeOf(i.FData))||t))):t)},this.IsGenericTemplType=function(e){return 2===e.BaseType&&e.LoTypeEl.$class.ClassType()===je},this.GetTypeParameterCount=function(e){return null===e||null===e.GenericTemplateTypes?0:e.GenericTemplateTypes.FCount},this.GetGenericConstraintKeyword=function(e){var t;if(null===e||e.$class.ClassType()!==Dt)return 0;if(0!==(t=e).Kind)return 0;var s=Te(t.Value);return"record"===s?96:"class"===s?47:"constructor"===s?50:0},this.GetGenericConstraintErrorEl=function(e,t){return Yt.isPrototypeOf(e)||e.FParent===t?e:t},this.GetSpecializedEl=function(e,t,s){var i,n=null,l=null,a=null,h=0,u=0,c=null,p=[],f=q.$new(),d=null,m=null,C=null,S=null,T=!1,y=null,g=null,E=null;e.$class.ClassType()===Kt&&null!==e.FData&&this.RaiseNotYetImplemented(20190726142522,e,""),l=null,y=null,g=null,ke.isPrototypeOf(t)?(y=t,R.isPrototypeOf(t.FData)||this.RaiseMsg(20190726194316,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,this.GetTypeDescription(y,!1)),e),l=t.FData,!$e.isPrototypeOf(y)&&l.GenericStep<1&&this.RaiseMsg(20190807205038,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,this.GetTypeDescription(y,!1)),e),a=y.GenericTemplateTypes):xe.isPrototypeOf(t)?(g=t,$.isPrototypeOf(g.FData)||this.RaiseMsg(20190919132733,3001,rtl.getResStr(Ce,"sIdentifierNotFound"),Ye(18,g.FName),e),null!==(E=g.FData).DeclarationProc&&this.RaiseNotYetImplemented(20190920182602,e,""),(l=E).GenericStep<1&&this.RaiseMsg(20190920120649,3107,rtl.getResStr(Ce,"sTypeXIsNotYetCompletelyDefined"),Ye(18,r.GetElementDbgPath(g)),e),a=this.GetProcTemplateTypes(g)):this.RaiseNotYetImplemented(20190919132603,t,""),d=l.SpecializedItems,null===a&&this.RaiseMsg(20190905111703,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"generic templates",18,t.FName),e),a.FCount!==s.FCount&&this.RaiseMsg(20190905111704,3010,rtl.getResStr(Ce,"sXExpectedButYFound"),Ye(18,"type with "+Ae(s.FCount)+" generic template(s)",18,t.FName+ot(a.FCount)),e),p=rtl.arraySetLength(p,null,s.FCount),T=!0;for(var P=0,I=s.FCount-1;P<=I;P++)h=P,c=rtl.getObject(s.Get(h)),this.ComputeElement(c,f,rtl.createSet(4),null),p[h]=f.LoTypeEl,f.LoTypeEl!==rtl.getObject(a.Get(h))&&(T=!1);if(T)return t;for(null===d&&(d=be.$create("Create$3",[!0]),null!==l?l.SpecializedItems=d:this.RaiseNotYetImplemented(20190919133159,e,"")),h=d.GetCount()-1,m=null;h>=0;){for(m=d.GetItem(h),u=rtl.length(m.Params)-1;u>=0&&(this.IsSameType(m.Params[u],p[u],0)||!(this.CheckElTypeCompatibility(m.Params[u],p[u],0)>0));)u-=1;if(u<0)break;m=null,h-=1}return null===m&&(C=t.GetModule(),S=rtl.as(C.FData,F),m=rtl.as(S.Owner,re).CreateSpecializedItem(e,t,p)),i=m.FSpecializedEl,e.$class.ClassType()===Kt&&(n=o.$create("Create$1"),this.AddResolveData(e,n,1),n.SpecializedType=rtl.as(i,ke)),i},this.FinishGenericClassOrRecIntf=function(e){var t,s=null,i=0,r=null,n=ae.$new();if(t=rtl.as(e.FElement,ke),0!==e.GenericStep&&this.RaiseNotYetImplemented(20200219124544,t,""),e.GenericStep=1,null!==(s=e.SpecializedItems))for(var l=0,a=s.GetCount()-1;l<=a;l++)i=l,(r=s.GetItem(i)).GenericEl=t,0===r.Step&&(this.InitSpecializeScopes(t,n),this.SpecializeGenericIntf(r),this.RestoreSpecializeScopes(n))},this.FinishSpecializations=function(e){var t=null,s=0;if(null!==(t=e.SpecializedItems))for(var i=0,r=t.GetCount()-1;i<=r;i++)s=i,this.SpecializeGenericImpl(t.GetItem(s))},this.CheckPendingForwardProcs=function(e){var t=0,s=null,i=null,n=null,l=null;if(!this.IsElementSkipped(e))if(Xt.isPrototypeOf(e))for(var a=0,o=e.Declarations.FCount-1;a<=o;a++)t=a,s=rtl.getObject(e.Declarations.Get(t)),xe.isPrototypeOf(s)&&(i=s,r.ProcNeedsImplProc(i)&&null===i.FData.ImplProc&&this.RaiseMsg(20170216152219,3015,rtl.getResStr(Ce,"sForwardProcNotResolved"),Ye(18,r.GetElementTypeName(i),18,i.FName),i));else if(ze.isPrototypeOf(e)){if(n=e,$e.isPrototypeOf(n)){if(n.ObjKind in rtl.createSet(2,6))return;if(n.IsForward)return;if(n.IsExternal)return}if(null!==(l=rtl.as(n.FData,N)).SpecializedFromItem)return;1!==l.GenericStep&&this.RaiseNotYetImplemented(20190804115324,e,"");for(var h=0,u=n.Members.FCount-1;h<=u;h++)if(t=h,s=rtl.getObject(n.Members.Get(t)),xe.isPrototypeOf(s)){if((i=s).IsAbstract()||i.IsExternal())continue;null===i.FData.ImplProc&&this.RaiseMsg(20170216152221,3015,rtl.getResStr(Ce,"sForwardProcNotResolved"),Ye(18,r.GetElementTypeName(i),18,i.FName),i)}l.GenericStep=2,null!==l.SpecializedItems&&this.FinishSpecializations(l)}},this.IsFullySpecialized=function(e){var t,s,i=0;if(null!==e.GenericTemplateTypes&&e.GenericTemplateTypes.FCount>0)return!1;if(!R.isPrototypeOf(e.FData))return!0;if(null===(t=e.FData).SpecializedFromItem)return!0;s=t.SpecializedFromItem.Params;for(var r=0,n=rtl.length(s)-1;r<=n;r++)if(i=r,je.isPrototypeOf(s[i]))return!1;return true},this.IsFullySpecialized$1=function(e){var t,s,i=null,r=0;if(null===e.FData)return!1;if(null!==(i=e.FData).DeclarationProc&&(i=(e=i.DeclarationProc).FData),null!==(t=this.GetProcTemplateTypes(e))&&t.FCount>0)return!1;if(null===i.SpecializedFromItem)return!0;s=i.SpecializedFromItem.Params;for(var n=0,l=rtl.length(s)-1;n<=l;n++)if(r=n,je.isPrototypeOf(s[r]))return!1;return true},this.IsTGUID=function(e){var t=!1,s=null,i=null,r=0,n=0;if(t=!1,!nt(e.FName,"TGUID"))return t;if(nt(e.GetModule().FName,"system"))return!0;r=1;for(var l=0,a=(s=e.Members).FCount-1;l<=a;l++)if(n=l,(i=rtl.getObject(s.Get(n))).$class.ClassType()===He&&nt(i.FName,"D"+Ae(r))){if(4===r)return!0;r+=1}return t=!0},this.IsTGUIDString=function(e){var t=null,s=null,i=null;if(!(e.BaseType in r.btAllStrings))return!1;if(null!==e.ExprEl&&null!==e.LoTypeEl)return!0;if(null!==(i=e.IdentEl))for(t=(s=i.$class.ClassType()).InheritsFrom(He)?i.VarType:s===We?i.ArgType:s===$t?i.ResultType:null;null!==t&&(t.$class.ClassType()===qt||t.$class.ClassType()===Qt);){if(nt(t.FName,"TGUIDString"))return!0;t=t.DestType}return false},this.IsCustomAttribute=function(e){var t,s=!1,i=null,r=null;if(s=!1,null===e||e.$class.ClassType()!==$e)return s;if((i=e).IsExternal||1!==i.ObjKind)return s;for(;!nt(i.FName,"TCustomAttribute");){if(null===(r=rtl.as(i.FData,O)).AncestorScope)return s;i=r.AncestorScope.FElement}return st.isPrototypeOf(i.FParent)?(t=i.GetModule(),s=this.IsSystemUnit(t)):s},this.IsSystemUnit=function(e){var t=!1,s=null;return t=!1,null===e?t:!!nt(e.FName,"system")||(s=e.$class.ClassType()===Ze?e.ProgramSection:e.$class.ClassType()===et?e.LibrarySection:e.InterfaceSection,t=0===rtl.length(s.UsesClause))},this.GetAttributeCallsEl=function(e){var t=[],s=null,i=null,r=null,n=0;if(t=[],null===e)return t;if(O.isPrototypeOf(e.FData)&&null!=e.FData.SpecializedFromItem)t=this.GetAttributeCallsEl(e.FData.SpecializedFromItem.GenericEl);else{if(null===(s=e.FParent))return t;if((i=s.$class.ClassType()).InheritsFrom(Xt))r=s.Declarations;else{if(!i.InheritsFrom(ze))return t;r=s.Members}if((n=r.IndexOf(e))<0)return t;t=this.GetAttributeCalls(r,n)}return t},this.GetAttributeCalls=function(e,t){var s=[];function i(e,t){var i=0,r=0,n=0,l=[];for(i=t;i>0&&rtl.getObject(e.Get(i-1)).$class.ClassType()===_t;)i-=1;for(r=0;i<t;){l=rtl.getObject(e.Get(i)).Calls,s=rtl.arraySetLength(s,null,r+rtl.length(l));for(var a=0,o=rtl.length(l)-1;a<=o;a++)n=a,s[r]=l[n],r+=1;i+=1}}var r=null,n=null;if(s=[],r=rtl.getObject(e.Get(t)),i(e,t),r.$class.ClassType()===$e&&!r.IsForward)for(;;){if((t-=1)<1)break;if((n=rtl.getObject(e.Get(t))).$class.ClassType()===$e&&n.IsForward&&_.isPrototypeOf(n.FData)&&n.FData.FDeclaration===r){i(e,t);break}if(O.isPrototypeOf(n.FData)){if(null==n.FData.SpecializedFromItem)break;i(e,t)}}return s},this.ProcNeedsParams=function(e){return e.Args.FCount>0&&null===rtl.getObject(e.Args.Get(0)).ValueExpr},this.ProcHasSelf=function(e){var t=null;return!e.IsStatic()&&(!(t=e.FParent.$class.ClassType()).InheritsFrom(st)&&t!==Ne&&((t=e.$class.ClassType())!==ht&&t!==ut&&true))},this.CreateProcSelfArg=function(e){var t,s,i=null,r=null,n=null,l=null;e.IsStatic()||e.IsExternal()||e.$class.ClassType()!==ht&&e.$class.ClassType()!==ut&&null!==(t=(l=e.FData).ClassRecScope)&&(s=t.FElement,e.$class.ClassType()===ts||e.$class.ClassType()===ss?O.isPrototypeOf(t)&&null!==t.CanonicalClassOf?(i=this.CreateOwnedElement(We,"Self",e),l.SelfArg=i,i.Access=1,i.ArgType=t.CanonicalClassOf):this.RaiseInternalError(20190106121745,""):(i=this.CreateOwnedElement(We,"Self",e),l.SelfArg=i,(r=s).$class.ClassType()===$e&&null!==r.HelperForType&&(r=r.HelperForType),n=this.ResolveAliasType(r,!0),$e.isPrototypeOf(n)&&1===n.ObjKind?i.Access=1:i.Access=2,i.ArgType=r))},this.IsProcOverride=function(e,t){var s,i=null,r=null;if(s=!1,null===e)return s;if(null===t)return s;if(!(i=t).IsOverride())return s;if(!e.IsOverride()&&!e.IsVirtual())return s;do{if(e===(r=i.FData.OverriddenProc))return!0;i=r}while(null!==i);return s},this.IsProcOverload=function(e){return!!e.IsOverload()||(!!(e.IsOverride()&&$.isPrototypeOf(e.FData)&&2 in e.FData.Flags)||false)},this.GetTopLvlProc=function(e){var t=null;for(t=null;null!==e;)xe.isPrototypeOf(e)&&(t=e),e=e.FParent;return t},this.GetParentProc=function(e,t){var s=null,i=null;for(s=null;null!==e;){if(xe.isPrototypeOf(e))return s=e,t&&$.isPrototypeOf(e.FData)&&null!==(i=e.FData).DeclarationProc&&(s=i.DeclarationProc),s;e=e.FParent}return s},this.GetRangeLength=function(e){var t=0,s=null;t=0,null===(s=this.Eval(e,rtl.createSet(0),!0))&&this.RaiseNotYetImplemented(20170910210416,e,"");try{var i=s.Kind;10===i||11===i?t=s.RangeEnd-s.RangeStart+1:this.RaiseNotYetImplemented(20170910210554,e,"")}finally{Ot({get:function(){return s},set:function(e){s=e}})}return t},this.EvalRangeLimit=function(e,t,s,i){var n=null,l=null,a=null;n=null,null===(l=this.Eval(e,rtl.unionSet(t,rtl.createSet(0)),!0))&&this.RaiseNotYetImplemented(20170601191258,e,"");var o=l.Kind;if(10===o){var h=l.ElKind;1===h?(a=rtl.as(r.NoNil(l.ElType),Ge),n=s?hs.$create("CreateValue",[l.RangeStart,rtl.getObject(a.Values.Get(0))]):hs.$create("CreateValue",[l.RangeEnd,rtl.getObject(a.Values.Get(a.Values.FCount-1))])):2===h?n=s?us.$create("CreateValue",[l.RangeStart]):us.$create("CreateValue",[l.RangeEnd]):3===h?n=s?ds.$create("CreateValue",[String.fromCharCode(l.RangeStart)]):ds.$create("CreateValue",[String.fromCharCode(l.RangeEnd)]):4===h?n=s?fs.$create("CreateValue",[0!==l.RangeStart]):fs.$create("CreateValue",[0!==l.RangeEnd]):(Ot({get:function(){return l},set:function(e){l=e}}),this.RaiseNotYetImplemented(20170601195240,i,""))}else 11===o?n=s?Vs.$create("CreateValue",[l.RangeStart]):Vs.$create("CreateValue",[l.RangeEnd]):(Ot({get:function(){return l},set:function(e){l=e}}),this.RaiseNotYetImplemented(20170601195336,i,""));return Ot({get:function(){return l},set:function(e){l=e}}),n},this.EvalTypeRange=function(e,t){var s,i=null,r=null;if(i=null,(s=(e=this.ResolveAliasType(e,!0)).$class.ClassType())===Je){if(null!==(i=this.fExprEvaluator.Eval(e.RangeExpr,rtl.refSet(t)))&&null===i.IdentEl)return i.IdentEl=e,i}else{if(s===Ge)return(i=ns.$create("CreateValue",[1,e,0,e.Values.FCount-1])).IdentEl=e,i;if(s===me&&Z.isPrototypeOf(e.FData)){var n=(r=e.FData).BaseType;5===n?((i=ns.$create("Create$1")).ElKind=3,i.RangeStart=0,i.RangeEnd=65535):6===n?i=ns.$create("CreateValue",[3,null,0,65535]):15===n||16===n||17===n?i=ns.$create("CreateValue",[4,null,0,1]):19!==n&&20!==n&&21!==n&&22!==n&&25!==n&&26!==n&&24!==n&&23!==n&&28!==n&&27!==n&&14!==n||((i=ns.$create("Create$1")).ElKind=2,this.GetIntegerRange(r.BaseType,{p:i,get:function(){return this.p.RangeStart},set:function(e){this.p.RangeStart=e}},{p:i,get:function(){return this.p.RangeEnd},set:function(e){this.p.RangeEnd=e}}))}}return i},this.HasTypeInfo=function(e){var t=!1;if(t=!1,null===e)return t;if(Z.isPrototypeOf(e.FData))return!0;if(null===e.FParent)return t;if(De.isPrototypeOf(e.FParent)){if(!this.HasTypeInfo(e.FParent))return t}else{if(this.ElHasModeSwitch(e,53))return t;if(is.isPrototypeOf(e.FParent))return t}return t=!0},this.IsAnonymousElType=function(e){var t,s=!1,i="",n=0,l=0;if(s=!1,""===this.FAnonymousElTypePostfix)return s;for(i=e.FName,t=this.FAnonymousElTypePostfix.length,n=i.length;;){if((n-=t)>0){for(l=n;l<=t&&i.charAt(n+l-1)===this.FAnonymousElTypePostfix.charAt(l-1);)l+=1;if(l>t){s=!0;continue}}return s?s=r.IsValidIdent(pt(i,n+t),!1,!1):s}return s},this.GetActualBaseType=function(e){var t=e;return 5===t?this.FBaseTypeChar:7===t?this.FBaseTypeString:12===t?this.FBaseTypeExtended:e},this.GetCombinedBoolean=function(e,t,s){var i=0;if(e===t)return e;var r=e;return 15===r?i=t:16===r?15!==t&&(i=t):17===r?t in rtl.createSet(15,16)||(i=t):18===r?t in rtl.createSet(15,16,17)||(i=t):this.RaiseNotYetImplemented(20170420093805,s,""),i},this.GetCombinedInt=function(e,t,s){var i=0,r=0,n=0,l=!1,a=!1;return e.BaseType===t.BaseType?i:(this.GetIntegerProps(e.BaseType,{get:function(){return r},set:function(e){r=e}},{get:function(){return l},set:function(e){l=e}}),this.GetIntegerProps(t.BaseType,{get:function(){return n},set:function(e){n=e}},{get:function(){return a},set:function(e){a=e}}),r===n&&l!==a&&(r=Math.max(r,n)+1),i=this.GetIntegerBaseType(Math.max(r,n),l||a,s))},this.GetIntegerProps=function(e,t,s){var i=e;19===i?(t.set(8),s.set(!1)):20===i?(t.set(8),s.set(!0)):21===i?(t.set(16),s.set(!1)):22===i?(t.set(16),s.set(!0)):24===i?(t.set(23),s.set(!0)):23===i?(t.set(22),s.set(!1)):25===i?(t.set(32),s.set(!1)):26===i?(t.set(32),s.set(!0)):28===i?(t.set(53),s.set(!0)):27===i?(t.set(52),s.set(!1)):this.RaiseInternalError(20170420095727,"")},this.GetIntegerRange=function(e,t,s){var i=!1;i=!0,12===e&&(e=this.FBaseTypeExtended);var r=e;return 19===r?(t.set(0),s.set(255)):20===r?(t.set(-128),s.set(127)):21===r?(t.set(0),s.set(65535)):22===r?(t.set(-32768),s.set(32767)):25===r?(t.set(0),s.set(4294967295)):26===r?(t.set(-2147483648),s.set(2147483647)):10===r||24===r?(t.set(-16777216),s.set(16777216)):23===r?(t.set(0),s.set(16777216)):11===r||28===r?(t.set(-9007199254740991),s.set(9007199254740991)):27===r?(t.set(0),s.set(9007199254740991)):14===r?(t.set(-922337203685477),s.set(922337203685477)):i=!1,i},this.GetIntegerBaseType=function(e,t,s){var i=0;return e<=8&&(i=t?20:19,null!==this.GetBaseTypes(i))||e<=16&&(i=t?22:21,null!==this.GetBaseTypes(i))?i:e<=22&&!t&&null!==this.GetBaseTypes(23)?23:e<=23&&t&&null!==this.GetBaseTypes(24)?24:e<=32&&(i=t?26:25,null!==this.GetBaseTypes(i))?i:e<=52&&!t&&null!==this.GetBaseTypes(27)?27:e<=53&&t&&null!==this.GetBaseTypes(28)?28:(null!==s?this.RaiseRangeCheck(20170420100336,s):i=0,i)},this.GetSmallestIntegerBaseType=function(t,s){var i=0,r=0;return t>s&&(t=s),t<0?(r=s>-(t+1)?s:-(t+1))<=127?i=20:r<=32767?i=22:null!==this.GetBaseTypes(24)&&r<=16777216?i=24:r<=2147483647?i=26:null!==this.GetBaseTypes(28)&&r<=9007199254740991?i=28:(i=e.btIntDouble,null===this.GetBaseTypes(i)&&(i=this.FBaseTypeExtended)):(r=s)<=255?i=19:r<=65535?i=21:null!==this.GetBaseTypes(23)&&r<=16777216?i=23:r<=4294967295?i=25:null!==this.GetBaseTypes(27)&&r<=9007199254740991?i=27:(i=e.btIntDouble,null===this.GetBaseTypes(i)&&(i=this.FBaseTypeExtended)),i},this.GetCombinedChar=function(e,t,s){var i,n=0;return(i=this.GetActualBaseType(e.BaseType))===this.GetActualBaseType(t.BaseType)?i:(i in r.btAllChars||this.RaiseInternalError(20170420103128,""),(n=6)===this.FBaseTypeChar&&(n=5),n)},this.GetCombinedString=function(e,t,s){var i,r,n=0;if((i=this.GetActualBaseType(e.BaseType))===(r=this.GetActualBaseType(t.BaseType)))return i;var l=i;if(6===l){8===r?n=8:7===r||9===r?n=9:this.RaiseNotYetImplemented(20170420103808,s,"")}else if(7===l){6===r||9===r?n=9:8===r?n=8:this.RaiseNotYetImplemented(20170420121201,s,"")}else if(8===l){5===r||6===r||8===r?n=8:7===r||9===r?n=9:this.RaiseNotYetImplemented(20170420121532,s,"")}else 9===l?n=9:this.RaiseNotYetImplemented(20170420103153,s,"");return n===this.FBaseTypeChar?n=5:n===this.FBaseTypeString&&(n=7),n},this.IsElementSkipped=function(e){return null===e},this.GetFirstSection=function(e){var t,s=null;return s=null,null===(t=this.FRootElement)||(Ze.isPrototypeOf(t)?s=t.ProgramSection:et.isPrototypeOf(t)?s=t.LibrarySection:(s=t.InterfaceSection,e&&null===s&&(s=t.ImplementationSection))),s},this.GetLastSection=function(){var e,t=null;return t=null,null===(e=this.FRootElement)?t:t=Ze.isPrototypeOf(e)?e.ProgramSection:et.isPrototypeOf(e)?e.LibrarySection:null!==e.ImplementationSection?e.ImplementationSection:e.InterfaceSection},this.GetParentSection=function(e){for(;null!==e;){if(st.isPrototypeOf(e))return e;e=e.FParent}return null},this.FindUsedUnitInSection=function(e,t){var s,i=0;if(null===t)return null;s=t.UsesClause;for(var r=0,n=rtl.length(s)-1;r<=n;r++)if(s[i=r].Module===e)return s[i];return null},this.FirstSectionUsesUnit=function(e){var t,s=!1;return s=!1,null===(t=this.GetFirstSection(!1))?s:s=null!==this.FindUsedUnitInSection(e,t)},this.ImplementationUsesUnit=function(e,t){var s,i=!1;return i=!1,null===(s=this.FRootElement)||null===this.FindUsedUnitInSection(e,s.ImplementationSection)||t&&(i=!this.FirstSectionUsesUnit(e)),i};var n=[4,8,8,8,16,16,16,16,32,32];this.GetShiftAndMaskForLoHiFunc=function(t,s,i){var r=0;if(t>=e.btByte&&t<=e.btIntDouble){var l=r=3 in this.FCurrentParser.GetCurrentModeSwitches()?8:n[t-19];8===l?i.set(255):16===l?i.set(65535):32===l?i.set(4294967295):i.set(15),s&&(r=0)}else this.RaiseInternalError(20190130122300,""),r=-1;return r}}),this.GetTreeDbg=function(e,t){var s="";function i(e){t+=e,s=s+oe.LineEnding+Us(" ",t)}var n=0,l=0;if(null===e)return"nil";if(s=e.FName+":"+e.$classname+"=",Yt.isPrototypeOf(e)){if(e.$class.ClassType()!==Bt&&(s+=Fe.OpcodeStrings[e.OpCode]),e.$class.ClassType()===Lt)s+=r.GetTreeDbg(e.Operand,t);else if(e.$class.ClassType()===Bt)s=s+"Left={"+r.GetTreeDbg(e.Left,t)+"}"+Fe.OpcodeStrings[e.OpCode]+"Right={"+r.GetTreeDbg(e.Right,t)+"}";else if(e.$class.ClassType()===Dt)s+=e.Value;else if(e.$class.ClassType()===Gt)s+=zt(e.Value,"true","false");else if(e.$class.ClassType()===wt)s+="nil";else if(e.$class.ClassType()===Vt)s+="inherited";else if(e.$class.ClassType()===vs)s+="Self";else if(e.$class.ClassType()===Mt){if(i(2),s=s+r.GetTreeDbg(e.Value,t)+"(",(l=rtl.length(e.Params))>0){t+=2;for(var a=0,o=l-1;a<=o;a++)n=a,i(0),s+=r.GetTreeDbg(e.Params[n],t),n<l-1&&(s+=",");t-=2}s+=")"}else if(e.$class.ClassType()===Jt){if(s+="(",(l=rtl.length(e.Fields))>0){t+=2;for(var h=0,u=l-1;h<=u;h++)n=h,i(0),s=s+e.Fields[n].Name+":"+r.GetTreeDbg(e.Fields[n].ValueExp,t),n<l-1&&(s+=",");t-=2}s+=")"}else if(e.$class.ClassType()===Ut){if(s+="[",(l=rtl.length(e.Values))>0){t+=2;for(var c=0,p=l-1;c<=p;c++)n=c,i(0),s+=r.GetTreeDbg(e.Values[n],t),n<l-1&&(s+=",");t-=2}s+="]"}}else if(xe.isPrototypeOf(e))s+=r.GetTreeDbg(e.ProcType,t);else if(we.isPrototypeOf(e)){if(e.GetIsReference()&&(s=s+" "+Fe.ProcTypeModifiers[1]),s+="(",(l=e.Args.FCount)>0){t+=2;for(var f=0,d=l-1;f<=d;f++)n=f,i(0),s+=r.GetTreeDbg(rtl.getObject(e.Args.Get(n)),t),n<l-1&&(s+=";");t-=2}s+=")",xe.isPrototypeOf(e)&&Ve.isPrototypeOf(e.ProcType)&&(s=s+":"+r.GetTreeDbg(e.ProcType.ResultEl,t)),e.GetIsOfObject()&&(s=s+" "+Fe.ProcTypeModifiers[0]),e.GetIsNested()&&(s=s+" "+Fe.ProcTypeModifiers[1]),""!==Fe.cCallingConventions[e.CallingConvention]&&(s=s+"; "+Fe.cCallingConventions[e.CallingConvention])}else e.$class.ClassType()===$t?s+=r.GetTreeDbg(e.ResultType,t):e.$class.ClassType()===We?(""!==Fe.AccessNames[e.Access]&&(s+=Fe.AccessNames[e.Access]),null===e.ArgType?s+="untyped":s+=r.GetTreeDbg(e.ArgType,t)):e.$class.ClassType()===me&&ee.isPrototypeOf(e.FData)&&(s+=e.FData.Signature);return s},this.GetResolverResultDbg=function(e){var t,s="";return s="[bt="+r.ResBaseTypeNames[e.BaseType],0!==e.SubType&&(s=s+" Sub="+r.ResBaseTypeNames[e.SubType]),s=s+" Ident="+ye(e.IdentEl),s=(s=(t=r.ResolveSimpleAliasType(e.HiTypeEl))!==e.LoTypeEl?s+" LoType="+ye(e.LoTypeEl)+" HiTypeEl="+ye(t):s+" Type="+ye(e.LoTypeEl))+" Expr="+ye(e.ExprEl)+" Flags="+r.ResolverResultFlagsToStr(e.Flags)+"]"},this.ResolverResultFlagsToStr=function(e){var t="";for(var s in t="",e)""!==t&&(t+=","),t+=i[+s];return t="["+t+"]"},this.GetElementTypeName=function(e){var t,s="";return null===e?"?":((t=e.$class.ClassType())===Dt?s=Fe.ExprKindNames[e.Kind]:t===Lt?s="unary "+Fe.OpcodeStrings[e.OpCode]:t===Bt?s=Fe.ExprKindNames[e.Kind]:t===$e?s=Fe.ObjKindNames[e.ObjKind]:t===me?s=e.FName:""===(s=r.GetElementTypeName$1(t))&&(s=e.ElementTypeName()),s)},this.GetElementTypeName$1=function(e){return null===e?"nil":e===Dt?"primitive expression":e===Lt?"unary expression":e===Bt?"binary expression":e===Gt?"boolean const":e===wt?"nil":e===qt?"alias":e===Be?"pointer":e===Qt?"type alias":e===Le?"class of":e===Kt?"specialize":e===Ht?"inline-specialize":e===Je?"range":e===Ue?"array":e===Js?"file":e===Qe?"enum value":e===Ge?"enum type":e===lt?"set":e===Me?"record":e===$e?"class":e===We?"parameter":e===we?"procedural type":e===$t?"function result":e===Ve?"functional type":e===ms?"string[]":e===He?"var":e===ls?"export":e===it?"const":e===ve?"property":e===xe?"procedure":e===qe?"function":e===gs?"operator":e===ws?"class operator":e===_e?"constructor":e===ht?"class constructor":e===es?"destructor":e===ut?"class destructor":e===ts?"class procedure":e===ss?"class function":e===is?"anonymous procedure":e===rs?"anonymous function":e===Zt?"method resolution":e===Ke?"interfacesection":e===Xe?"implementation":e===Ns?"program section":e===xs?"library section":e.$classname},this.GetElementDbgPath=function(e){var t="";if(null===e)return"nil";for(t="";null!==e;)""!==t&&(t="."+t),t=""!==e.FName?e.FName+t:r.GetElementTypeName(e)+t,e=e.FParent;return t},this.ResolveSimpleAliasType=function(e){for(var t=null;null!==e;)if((t=e.$class.ClassType())===qt)e=e.DestType;else{if(t!==$e||!e.IsForward||!_.isPrototypeOf(e.FData))return e;e=rtl.as(r.NoNil(e.FData.FDeclaration),De)}return null},this.SetResolverIdentifier=function(e,t,s,i,r,n){if(Yt.isPrototypeOf(s))throw pe.$create("Create$1",["20170729101017"]);e.BaseType=t,e.SubType=0,e.IdentEl=s,e.HiTypeEl=r,e.LoTypeEl=i,e.ExprEl=null,e.Flags=rtl.refSet(n)},this.SetResolverTypeExpr=function(e,t,s,i,r){e.BaseType=t,e.SubType=0,e.IdentEl=null,e.HiTypeEl=i,e.LoTypeEl=s,e.ExprEl=null,e.Flags=rtl.refSet(r)},this.SetResolverValueExpr=function(e,t,s,i,r,n){e.BaseType=t,e.SubType=0,e.IdentEl=null,e.HiTypeEl=i,e.LoTypeEl=s,e.ExprEl=r,e.Flags=rtl.refSet(n)},this.ProcNeedsImplProc=function(e){var t=!1;return t=!0,!e.IsExternal()&&(e.IsForward()||e.FParent.$class.ClassType()===Ke?t:e.FParent.$class.ClassType()!==$e||e.IsAbstract()?t=!1:t)},this.ProcNeedsBody=function(e){var t=null;return!e.IsForward()&&!e.IsExternal()&&((t=e.FParent.$class.ClassType())!==Ke&&!t.InheritsFrom($e)&&true)},this.ProcHasGroupOverload=function(e){var t;return!!e.IsOverload()||(t=e.FData,$.isPrototypeOf(t)&&0 in t.Flags)},this.ClearHelperList=function(e){var t=0;if(0!==rtl.length(e.get())){for(var s=0,i=rtl.length(e.get())-1;s<=i;s++)t=s,rtl.free(e.get(),t);e.set([])}},this.ChompDottedIdentifier=function(e){var t=0,s=0;for(t=e.length,s=0;t>0;){var i=e.charAt(t-1);if("."===i){if(0===s)break}else">"===i?s+=1:"<"===i&&(s-=1);t-=1}return pt(e,t-1)},this.FirstDottedIdentifier=function(e){var t,s=0;for(s=1,t=e.length;;){if(s>t)return e;if(e.charCodeAt(s-1)in rtl.createSet(60,46))return pt(e,s-1);s+=1}return""},this.LastDottedIdentifier=function(e){var t=0,s=0,i=0;for(i=t=e.length,s=0;t>0;){var r=e.charAt(t-1);if("."===r){if(0===s)break}else">"===r?s+=1:"<"===r&&(s-=1,i=t-1);t-=1}return Fs(e,t+1,i-t)},this.IsDottedIdentifierPrefix=function(e,t){var s;return!((s=e.length)>t.length||0!==Pe(e,pt(t,s)))&&(t.length===s||"."===t.charAt(s+1-1))},this.GetFirstDotPos=function(e){var t,s=0,i=0;for(s=1,t=e.length,i=0;;){if(s>t)return-1;var r=e.charAt(s-1);if("."===r){if(0===i)return s}else"<"===r?i+=1:">"===r&&(i-=1);s+=1}return s},this.GetLastDotPos=function(e){var t=0,s=0;for(t=e.length,s=0;t>0;){var i=e.charAt(t-1);if("."===i){if(0===s)return t}else">"===i?s+=1:"<"===i&&(s-=1);t-=1}return t};var js=rtl.createSet(null,65,90,null,97,122,95),Hs=rtl.unionSet(js,rtl.createSet(null,48,57));this.IsValidIdent=function(e,t,s){var i,r=!1,n=!1,l=0;if((i=e.length)<1)return!1;n=!0;for(var a=1,o=i;a<=o&&(l=a,n?(r=e.charCodeAt(l-1)in js,n=!1):t&&"."===e.charAt(l-1)?s&&(r=l<i,n=!0):r=e.charCodeAt(l-1)in Hs,r);a++);return r},this.NoNil=function(e){if(null===e)throw pe.$create("Create$1",[""]);return e},this.dbgs$3=function(e){return s[e]}}),rtl.module("PasUseAnalyzer",["System","JS","Classes","SysUtils","Types","contnrs","PasTree","PScanner","PasResolveEval","PasResolver"],function(){"use strict";var e=this,t=null,s=null,i=null,r=null,n=null,l=pas.PasResolver,a=l.EPasResolve,o=pas.System,h=o.TObject,u=pas.SysUtils,c=u.Exception,p=pas.Classes.TFPList,f=u.FreeAndNil,d=pas.PasTree,F=d.TPasProperty,m=d.TPasType,C=d.TPasClassType,S=l.dbgs$3,T=u.IntToStr,y=pas.PasResolveEval,g=y.GetObjPath,E=d.TPasProcedure,P=d.TInitializationSection,I=d.TFinalizationSection,R=d.TPasUnresolvedSymbolRef,v=d.TInterfaceSection,A=l.TPasProcedureScope,N=l.TPasInitialFinalizationScope,x=y.GetObjName,b=d.TPasGenericType,O=l.TPasGenericScope,k=d.TPasVariable,$=d.TPasArgument,D=d.TPasResultElement,L=d.TPasResString,B=d.TPasExpr,M=d.TPasEnumValue,G=d.TPasMethodResolution,w=d.TPasModule,V=d.TPasUsesUnit,U=l.TPasResolverResult,J=d.TPasConst,j=d.TPasAliasType,H=d.TPasTypeAliasType,W=d.TPasEnumType,Y=d.TPasSetType,z=d.TPasRangeType,_=d.TPasArrayType,K=d.TPasPointerType,X=d.TPasAttributes,q=d.TPasClassOfType,Q=d.TPasRecordType,Z=d.TPasProcedureType,ee=d.TPasFunctionType,te=d.TPasSpecializeType,se=l.TPasSpecializeTypeData,ie=d.TPasGenericTemplateType,re=d.TPasMembersType,ne=d.TPasProgram,le=d.TPasLibrary,ae=l.TPasModuleScope,oe=d.TPasExportSymbol,he=d.TPasImplElement,ue=d.TPasImplBlock,ce=d.TPasImplSimple,pe=d.TPasImplAssign,fe=d.TPasImplAsmStatement,de=d.TPasImplBeginBlock,Fe=d.TPasImplCaseOf,me=d.TPasImplCaseStatement,Ce=d.TPasImplCaseElse,Se=d.TPasImplForLoop,Te=l.TPasForLoopScope,ye=d.TPasImplIfElse,ge=d.TPasImplCommand,Ee=d.TPasImplLabelMark,Pe=d.TPasImplRepeatUntil,Ie=d.TPasImplWhileDo,Re=d.TPasImplWithDo,ve=d.TPasImplExceptOn,Ae=d.TPasImplRaise,Ne=d.TPasImplTry,xe=l.TPRParentParams,be=l.TResolvedReference,Oe=l.TResolvedRefCtxAttrProc,ke=l.TPasRecordScope,$e=d.TBinaryExpr,De=d.TPasVariant,Le=l.TResElDataBuiltInProc,Be=d.TPrimitiveExpr,Me=d.TBoolConstExpr,Ge=d.TNilExpr,we=d.TUnaryExpr,Ve=d.TParamsExpr,Ue=d.TArrayValues,Je=d.TRecordValues,je=d.TInheritedExpr,He=d.TProcedureExpr,We=d.TInlineSpecializeExpr,Ye=d.TPasConstructor,ze=d.TPasDestructor,_e=l.TResElDataBaseType,Ke=l.TPasClassIntfMap,Xe=l.TPasClassScope,qe=d.TPasClassConstructor,Qe=d.TPasClassDestructor,Ze=u.LowerCase,et=u.CompareText,tt=o.VarRecs,st=u.RightStr,it=y.GetElementNameAndParams,rt=d.TImplementationSection,nt=d.TProgramSection,lt=d.TLibrarySection,at=pas.PScanner,ot=at.SafeFormat,ht=at.CreateMsgArgs;this.nPAParameterInOverrideNotUsed=4501,this.sPAParameterInOverrideNotUsed='Parameter "%s" not used',this.nPAFieldNotUsed=4502,this.sPAFieldNotUsed='Field "%s" not used',this.nPAFieldIsAssignedButNeverUsed=4503,this.sPAFieldIsAssignedButNeverUsed='Field "%s" is assigned but never used',this.nPAUnitNotUsed=5023,this.sPAUnitNotUsed='Unit "%s" not used in %s',this.nPAParameterNotUsed=5024,this.sPAParameterNotUsed='Parameter "%s" not used',this.nPALocalVariableNotUsed=5025,this.sPALocalVariableNotUsed='Local variable "%s" not used',this.nPAValueParameterIsAssignedButNeverUsed=5026,this.sPAValueParameterIsAssignedButNeverUsed='Value parameter "%s" is assigned but never used',this.nPALocalVariableIsAssignedButNeverUsed=5027,this.sPALocalVariableIsAssignedButNeverUsed='Local variable "%s" is assigned but never used',this.nPALocalXYNotUsed=5028,this.sPALocalXYNotUsed='Local %s "%s" not used',this.nPAPrivateFieldIsNeverUsed=5029,this.sPAPrivateFieldIsNeverUsed='Private field "%s" is never used',this.nPAPrivateFieldIsAssignedButNeverUsed=5030,this.sPAPrivateFieldIsAssignedButNeverUsed='Private field "%s" is assigned but never used',this.nPAPrivateMethodIsNeverUsed=5031,this.sPAPrivateMethodIsNeverUsed='Private method "%s" is never used',this.nPAFunctionResultDoesNotSeemToBeSet=5033,this.sPAFunctionResultDoesNotSeemToBeSet="Function result does not seem to be set",this.nPAPrivateTypeXNeverUsed=5071,this.sPAPrivateTypeXNeverUsed='Private type "%s" never used',this.nPAPrivateConstXNeverUsed=5072,this.sPAPrivateConstXNeverUsed='Private const "%s" never used',this.nPAPrivatePropertyXNeverUsed=5073,this.sPAPrivatePropertyXNeverUsed='Private property "%s" never used',rtl.createClass(this,"EPasAnalyzer",a,function(){t=this}),rtl.createClass(this,"TPAMessage",h,function(){s=this,this.$init=function(){h.$init.call(this),this.FRefCount=0,this.Id=0,this.MsgType=0,this.MsgNumber=0,this.MsgText="",this.MsgPattern="",this.Args=[],this.PosEl=null,this.Filename="",this.Row=0,this.Col=0},this.$final=function(){this.Args=void 0,this.PosEl=void 0,h.$final.call(this)},this.Create$1=function(){return this.FRefCount=1,this},this.Release=function(){if(0===this.FRefCount)throw c.$create("Create$1",[""]);this.FRefCount-=1,0===this.FRefCount&&this.$destroy("Destroy")}}),this.TPAIdentifierAccess={0:"paiaNone",paiaNone:0,1:"paiaRead",paiaRead:1,2:"paiaWrite",paiaWrite:2,3:"paiaReadWrite",paiaReadWrite:3,4:"paiaWriteRead",paiaWriteRead:4},rtl.createClass(this,"TPAElement",h,function(){i=this,this.$init=function(){h.$init.call(this),this.FElement=null,this.Access=0},this.$final=function(){this.FElement=void 0,h.$final.call(this)},this.SetElement=function(e){this.FElement!==e&&(this.FElement=e)},this.Destroy=function(){this.SetElement(null),h.Destroy.call(this)}}),rtl.createClass(this,"TPAOverrideList",h,function(){r=this,this.$init=function(){h.$init.call(this),this.FElement=null,this.FOverrides=null},this.$final=function(){this.FElement=void 0,this.FOverrides=void 0,h.$final.call(this)},this.GetOverrides=function(e){return rtl.getObject(this.FOverrides.Get(e))},this.SetElement=function(e){this.FElement!==e&&(this.FElement=e)},this.Create$1=function(){return this.FOverrides=p.$create("Create"),this},this.Destroy=function(){f({p:this,get:function(){return this.p.FOverrides},set:function(e){this.p.FOverrides=e}}),this.SetElement(null),h.Destroy.call(this)},this.Add=function(e){this.FOverrides.Add(e)},this.Count=function(){return this.FOverrides.FCount},this.IndexOf=function(e){return this.FOverrides.IndexOf(e)}}),rtl.createClass(this,"TPasAnalyzerKeySet",h,function(){n=this,this.$init=function(){h.$init.call(this),this.FItems=null,this.FCount=0,this.FItemToName=null,this.FKeyToName=null},this.$final=function(){this.FItems=void 0,this.FItemToName=void 0,this.FKeyToName=void 0,h.$final.call(this)},this.Create$1=function(e,t){return this.FItemToName=e,this.FKeyToName=t,this.FItems=new Object,this},this.Destroy=function(){this.FItems=null,h.Destroy.call(this)},this.Clear=function(){this.FItems=new Object,this.FCount=0},this.FreeItems=function(){var e,t=0;e=Object.getOwnPropertyNames(this.FItems);for(var s=0,i=rtl.length(e)-1;s<=i;s++)t=s,rtl.getObject(this.FItems[e[t]]).$destroy("Destroy");this.FItems=new Object,this.FCount=0},this.Add=function(e,t){if(t&&this.ContainsItem(e))throw c.$create("Create$1",["[20181101151755] TPasAnalyzerSet.Add duplicate"]);this.FItems["%"+this.FItemToName(e)]=e,this.FCount+=1},this.ContainsItem=function(e){return this.FItems.hasOwnProperty("%"+this.FItemToName(e))},this.ContainsKey=function(e){return this.FItems.hasOwnProperty("%"+this.FKeyToName(e))},this.FindItem=function(e){var t;return t="%"+this.FItemToName(e),this.FItems.hasOwnProperty(t)?this.FItems[t]:null},this.FindKey=function(e){var t;return t="%"+this.FKeyToName(e),this.FItems.hasOwnProperty(t)?this.FItems[t]:null},this.Count=function(){return this.FCount}}),this.TPasAnalyzerOption={0:"paoOnlyExports",paoOnlyExports:0,1:"paoImplReferences",paoImplReferences:1,2:"paoSkipGenericProc",paoSkipGenericProc:2},this.TPAUseMode={0:"paumElement",paumElement:0,1:"paumAllPasUsable",paumAllPasUsable:1,2:"paumAllExports",paumAllExports:2,3:"paumTypeInfo",paumTypeInfo:3},this.PAUseModeToPSRefAccess=[1,1,1,5],this.TPAOtherCheckedEl={0:"pocClassConstructor",pocClassConstructor:0},rtl.createClass(this,"TPasAnalyzer",h,function(){this.$init=function(){h.$init.call(this),this.FModeChecked=rtl.arraySetLength(null,null,4),this.FOtherChecked=rtl.arraySetLength(null,null,1),this.FOnMessage=null,this.FOptions={},this.FOverrideLists=null,this.FResolver=null,this.FScopeModule=null,this.FUsedElements=null},this.$final=function(){this.FModeChecked=void 0,this.FOtherChecked=void 0,this.FOnMessage=void 0,this.FOptions=void 0,this.FOverrideLists=void 0,this.FResolver=void 0,this.FScopeModule=void 0,this.FUsedElements=void 0,h.$final.call(this)},this.UseElType=function(t,s,i){null!==s&&(this.MarkImplScopeRef(t,s,e.PAUseModeToPSRefAccess[i]),this.UseType(s,i))},this.AddOverride=function(t,s){var i,n=null,l=null;if(null===(n=this.FOverrideLists.FindKey(t)))(n=r.$create("Create$1")).SetElement(t),this.FOverrideLists.Add(n,!1);else if(n.IndexOf(s)>=0)return!1;if(n.Add(s),i=!0,null!==this.FindElement(t))if(s.$class.ClassType()===F){if(m.isPrototypeOf(t)&&(l=this.FResolver.ResolveAliasTypeEl(t)).$class.ClassType()===C&&2===l.ObjKind)return this.UseVariable(s,1,!1),i;this.RaiseNotSupported(20180328221736,s,e.GetElModName(t))}else this.UseElement(s,0,!0);return i},this.SetOptions=function(e){rtl.eqSet(this.FOptions,e)||(this.FOptions=rtl.refSet(e))},this.UpdateAccess=function(e,t,s){if(t){var i=s.Access;0===i?s.Access=1:1===i||(2===i?s.Access=4:3===i||4===i||this.RaiseInconsistency(20170311183122,""))}if(e){var r=s.Access;0===r?s.Access=2:1===r?s.Access=3:2===r||3===r||4===r||this.RaiseInconsistency(20170311183127,"")}},this.OnUseScopeRef=function(e,t){for(;null!==e;){var s=e.Access;0===s||(1===s?this.UseElement(e.FElement,1,!1):2===s?this.UseElement(e.FElement,2,!1):3===s?this.UseElement(e.FElement,3,!1):4===s?(this.UseElement(e.FElement,2,!1),this.UseElement(e.FElement,1,!1)):5===s?this.UseTypeInfo(e.FElement):this.RaiseNotSupported(20180228191928,e.FElement,S(e.Access))),e=e.NextSameName}},this.RaiseInconsistency=function(e,s){throw t.$create("Create$1",["["+T(e)+"]: "+s])},this.RaiseNotSupported=function(e,s,i){var r="",n=null;throw r="["+T(e)+"]: Element="+g(s),""!==i&&(r=r+" "+i),(n=t.$create("Create$1",[r])).SetPasElement(s),n},this.FindTopImplScope=function(e){var t=null,s=null,i=null,r=null;for(t=null;null!==e;)(i=e.$class.ClassType()).InheritsFrom(E)?(null!==(s=e.FData).DeclarationProc&&(s=s.DeclarationProc.FData),null===(r=s.ImplProc)&&(r=s.FElement),null!==r.Body&&(t=s)):i!==P&&i!==I||(t=e.FData),e=e.FParent;return t},this.Add=function(e,t,s){var r=null;return null===e&&this.RaiseInconsistency(20170308093407,""),t&&this.PAElementExists(e)&&this.RaiseInconsistency(20170304201318,""),null===s&&(s=i),(r=s.$create("Create")).SetElement(e),this.FUsedElements.Add(r,!0),r},this.PAElementExists=function(e){return this.FUsedElements.ContainsKey(e)},this.CreateTree=function(){this.FUsedElements=n.$create("Create$1",[e.PAElement_ElToHashName,e.PasElementToHashName])},this.MarkElementAsUsed=function(t,s){var i=this;function r(e){return!i.PAElementExists(e)&&(i.Add(e,!0,null),true)}var n;if(null===t)return!1;if(null===(n=t.GetModule())){if(t.$class.ClassType()===R)return!1;this.RaiseInconsistency(20170308093540,e.GetElModName(t))}return null!==this.FScopeModule&&n!==this.FScopeModule?(r(n),!1):!this.PAElementExists(t)&&(this.Add(t,!1,s),null===this.FScopeModule&&this.IsIdentifier(t)&&r(n)&&this.UseModule(n,0),true)},this.ElementVisited=function(e,t){return null===e||(!!this.FModeChecked[t].ContainsItem(e)||(this.FModeChecked[t].Add(e,!1),false))},this.MarkImplScopeRef=function(e,t,s){var i,r=this;null!==t&&(t.FParent!==e&&1 in this.FOptions&&(i=null,null!==(i=r.FindTopImplScope(e))&&r.FindTopImplScope(t)!==i&&(""!==t.FName||v.isPrototypeOf(t))&&t!==i.FElement&&(A.isPrototypeOf(i)||N.isPrototypeOf(i)?i.AddReference(t,s):r.RaiseInconsistency(20180302142933,x(i)))))},this.IsGenericElement=function(e){var t=null;return(t=e.$class.ClassType()).InheritsFrom(E)?null!==e.NameParts:!!t.InheritsFrom(b)&&null!==e.GenericTemplateTypes},this.CanSkipGenericType=function(e){var t,s=this;if(null===this.FScopeModule)this.FResolver.IsFullySpecialized(e)||(null!==e.GenericTemplateTypes&&e.GenericTemplateTypes.FCount>0&&s.RaiseNotSupported(20190817151437,e,""),O.isPrototypeOf(e.FData)||s.RaiseNotSupported(20190826141320,e,x(e.FData)),null===(t=e.FData.SpecializedFromItem)&&s.RaiseNotSupported(20190826141352,e,""),null===t.FSpecializedEl&&s.RaiseNotSupported(20190826141516,e,""),null===t.FirstSpecialize&&s.RaiseNotSupported(20190826141649,e,""),s.RaiseNotSupported(20190826141540,e,"SpecializedAt:"+g(t.FirstSpecialize)+" "+s.FResolver.GetElementSourcePosStr(t.FirstSpecialize)));else if(null!==e.GenericTemplateTypes&&e.GenericTemplateTypes.FCount>0);else if(!this.FResolver.IsFullySpecialized(e))return!0;return false},this.CanSkipGenericProc=function(e){var t=this;var s=null,i=null;if(null===this.FScopeModule)this.FResolver.IsFullySpecialized$1(e)||function(){var s,i;null!==(s=t.FResolver.GetProcTemplateTypes(e))&&s.FCount>0&&t.RaiseNotSupported(20191016132828,e,""),A.isPrototypeOf(e.FData)||t.RaiseNotSupported(20191016132836,e,x(e.FData)),null===(i=e.FData.SpecializedFromItem)&&t.RaiseNotSupported(20191016133013,e,""),null===i.FSpecializedEl&&t.RaiseNotSupported(20191016133017,e,""),null===i.FirstSpecialize&&t.RaiseNotSupported(20191016133019,e,""),t.RaiseNotSupported(20191016133022,e,"SpecializedAt:"+g(i.FirstSpecialize)+" "+t.FResolver.GetElementSourcePosStr(i.FirstSpecialize))}();else if(null!==(s=this.FResolver.GetProcTemplateTypes(e))&&s.FCount>0){if(2 in this.FOptions)return!0}else{if(!this.FResolver.IsFullySpecialized$1(e))return!0;if(2 in this.FOptions)for(i=e.FParent;null!==i;){if(b.isPrototypeOf(i)&&null!==(s=i.GenericTemplateTypes)&&s.FCount>0)return!0;i=i.FParent}}return false},this.UseElement=function(e,t,s){var i=null;if(null!==e)for((i=e.$class.ClassType()).InheritsFrom(m)?this.UseType(e,0):i.InheritsFrom(k)?this.UseVariable(e,t,s):i===$?this.UseArgument(e,t):i===D?this.UseResultElement(e,t):i===L?this.UseResourcestring(e):i.InheritsFrom(E)?this.UseProcedure(e):i.InheritsFrom(B)?this.UseExpr(e):i===M?this.UseExpr(e.Value):i===G||i.InheritsFrom(w)||i===V||this.RaiseNotSupported(20170307090947,e,"");;){if(e=e.FParent,!m.isPrototypeOf(e))break;this.UseType(e,0)}},this.UseTypeInfo=function(e){var t=this;function s(s){null!==s&&(t.MarkImplScopeRef(e,s,5),t.UseTypeInfo(s))}var i=null,r=null,n=null,l=0,a=null,o=null,h=U.$new(),u=null,c=null,p=null,f=null,d=null,m=null;if(!this.ElementVisited(e,3)){if((i=e.$class.ClassType())===R);else if(i===k||i===J)s(e.VarType);else if(i===$)s(e.ArgType);else if(i===F){u=e;for(var S=0,T=(n=this.FResolver.GetPasPropertyArgs(u)).FCount-1;S<=T;S++)l=S,s(rtl.getObject(n.Get(l)).ArgType);s(this.FResolver.GetPasPropertyType(u)),this.UseElement(this.FResolver.GetPasPropertyGetter(u),1,!1),this.UseElement(this.FResolver.GetPasPropertySetter(u),1,!1),this.UseElement(this.FResolver.GetPasPropertyIndex(u),1,!1),this.UseElement(this.FResolver.GetPasPropertyStoredExpr(u),1,!1),this.UseElement(this.FResolver.GetPasPropertyDefaultExpr(u),1,!1)}else if(i===j||i===H)s(e.DestType);else if(i===W);else if(i===Y)s(e.EnumType);else if(i===z);else if(i===_){if(f=e,this.CanSkipGenericType(f))return;s(f.ElType);for(var y=0,g=rtl.length(f.Ranges)-1;y<=g;y++)l=y,a=f.Ranges[l],this.FResolver.ComputeElement(a,h,rtl.createSet(3),null),s(h.HiTypeEl)}else if(i===K)s(e.DestType);else if(i===C){if(p=e,this.CanSkipGenericType(p))return;if(2===p.ObjKind)for(var P=0,I=(r=p.Members).FCount-1;P<=I;P++)l=P,(a=rtl.getObject(r.Get(l))).$class.ClassType()!==X&&(this.IsGenericElement(a)||this.IsUsed(a)&&this.UseTypeInfo(a))}else if(i===q);else if(i===Q){if(m=e,this.CanSkipGenericType(m))return;for(var v=0,A=(r=m.Members).FCount-1;v<=A;v++)l=v,(a=rtl.getObject(r.Get(l))).$class.ClassType()!==X&&(this.IsGenericElement(a)||s(a));if(s(m.VariantEl),null!==m.Variants)for(var N=0,x=m.Variants.FCount-1;N<=x;N++)l=N,s(rtl.getObject(m.Variants.Get(l)))}else if(i.InheritsFrom(E))s(e.ProcType);else if(i.InheritsFrom(Z)){if(c=e,this.CanSkipGenericType(c))return;for(var b=0,O=c.Args.FCount-1;b<=O;b++)l=b,s(rtl.getObject(c.Args.Get(l)).ArgType);ee.isPrototypeOf(e)&&null!==e.ResultEl&&s(e.ResultEl.ResultType)}else if(i===D)s(e.ResultType);else if(i===te){d=e,se.isPrototypeOf(d.FData)&&s(e.FData.SpecializedType);for(var L=0,B=d.Params.FCount-1;L<=B;L++)l=L,o=rtl.getObject(d.Params.Get(l)),ie.isPrototypeOf(o)||s(o)}else i===ie?null===this.FScopeModule&&this.RaiseNotSupported(20190817110226,e,""):this.RaiseNotSupported(20170414153904,e,"");this.UseElement(e,0,!0),this.UseAttributes(e),re.isPrototypeOf(e.FParent)&&this.UseTypeInfo(e.FParent)}},this.UseAttributes=function(e){var t,s,i=0;s=this.FResolver.GetAttributeCallsEl(e),t=rtl.length(s)>0;for(var r=0,n=rtl.length(s)-1;r<=n;r++)i=r,this.UseExpr(s[i]);return t},this.UseModule=function(e,t){var s=this;function i(t){var i;null!==t&&(i=t.FData,s.UseScopeReferences(i.References),null===i.References&&s.IsImplBlockEmpty(t)||(s.PAElementExists(e)||s.Add(e,!0,null),s.UseImplBlock(t,!0)))}var r;return!this.ElementVisited(e,t)&&(t in rtl.createSet(2,1)&&(ne.isPrototypeOf(e)?this.UseSection(e.ProgramSection,t):le.isPrototypeOf(e)?this.UseSection(e.LibrarySection,t):this.UseSection(e.InterfaceSection,t)),i(e.InitializationSection),i(e.FinalizationSection),null!==(r=rtl.as(e.FData,ae)).FRangeErrorClass&&this.UseClassOrRecType(r.FRangeErrorClass,0),null!==r.FRangeErrorConstructor&&this.UseProcedure(r.FRangeErrorConstructor),0===t&&(this.PAElementExists(e)||this.Add(e,!0,null)),true)},this.UseSection=function(e,t){var s,i,r=0,n=null,l=null,a=null;if(0===t&&this.RaiseInconsistency(20170317172721,""),!this.ElementVisited(e,t)){s=2===t,1===t&&this.MarkElementAsUsed(e,null),i=e.UsesClause;for(var o=0,h=rtl.length(i)-1;o<=h;o++)if(r=o,w.isPrototypeOf(i[r].Module))if(n=i[r].Module,null===this.FScopeModule)this.UseModule(n,2);else{if(this.IsImplBlockEmpty(n.InitializationSection)&&this.IsImplBlockEmpty(n.FinalizationSection))continue;this.PAElementExists(n)||this.Add(n,!0,null),this.UseImplBlock(n.InitializationSection,!0),this.UseImplBlock(n.FinalizationSection,!0)}for(var u=0,c=e.Declarations.FCount-1;u<=c;u++)if(r=u,(a=(l=rtl.getObject(e.Declarations.Get(r))).$class.ClassType()).InheritsFrom(E)){if(s&&rtl.eqSet(rtl.intersectSet(rtl.createSet(4,10),l.FModifiers),{}))continue;this.UseProcedure(l)}else if(a.InheritsFrom(m)){if(s)continue;this.UseType(l,t)}else if(a.InheritsFrom(k)){if(s&&rtl.eqSet(rtl.intersectSet(rtl.createSet(3,2),l.VarModifiers),{}))continue;this.UseVariable(l,0,!0)}else if(a===L){if(s)continue;this.UseResourcestring(l)}else a===X||(a===oe?this.UseExportSymbol(l):this.RaiseNotSupported(20170306165213,l,""))}},this.UseImplBlock=function(e,t){var s=0,i=null;if(null!==e&&(!t||this.MarkElementAsUsed(e,null)))for(var r=0,n=e.Elements.FCount-1;r<=n;r++)s=r,i=rtl.getObject(e.Elements.Get(s)),he.isPrototypeOf(i)?this.UseImplElement(i):this.RaiseNotSupported(20170306195110,i,"")},this.UseImplElement=function(e){var t,s=null,i=null,r=0,n=0,l=null,a=null,o=null,h=null,u=null;if(null!==e)if((t=e.$class.ClassType())===ue)this.UseImplBlock(e,!1);else if(t===ce)this.UseExpr(e.Expr);else if(t===pe)this.UseExpr(e.Left),this.UseExpr(e.Right);else if(t===fe);else if(t===de)this.UseImplBlock(e,!1);else if(t===Fe){i=e,this.UseExpr(i.CaseExpr);for(var c=0,p=i.Elements.FCount-1;c<=p;c++)if(r=c,(o=rtl.getObject(i.Elements.Get(r))).$class.ClassType()===me){for(var f=0,d=(l=o).Expressions.FCount-1;f<=d;f++)n=f,this.UseExpr(rtl.as(rtl.getObject(l.Expressions.Get(n)),B));this.UseImplElement(l.Body)}else o.$class.ClassType()===Ce?this.UseImplBlock(o,!1):this.RaiseNotSupported(20170307195329,o,"")}else if(t===Se)s=e,this.UseExpr(s.VariableName),this.UseExpr(s.StartExpr),this.UseExpr(s.EndExpr),null!==(u=rtl.as(s.FData,Te))&&(this.MarkImplScopeRef(s,u.GetEnumerator,1),this.UseProcedure(u.GetEnumerator),this.MarkImplScopeRef(s,u.MoveNext,1),this.UseProcedure(u.MoveNext),this.MarkImplScopeRef(s,u.Current,1),this.UseVariable(u.Current,1,!1)),this.UseImplElement(s.Body);else if(t===ye)this.UseExpr(e.ConditionExpr),this.UseImplElement(e.IfBranch),this.UseImplElement(e.ElseBranch);else if(t===ge);else if(t===Ee);else if(t===Pe)this.UseImplBlock(e,!1),this.UseExpr(e.ConditionExpr);else if(t===Ie)this.UseExpr(e.ConditionExpr),this.UseImplElement(e.Body);else if(t===Re){for(var F=0,m=(a=e).Expressions.FCount-1;F<=m;F++)r=F,this.UseExpr(rtl.as(rtl.getObject(a.Expressions.Get(r)),B));this.UseImplElement(a.Body)}else if(t===ve)this.UseElType(e,e.TypeEl,0),this.UseImplElement(e.Body);else if(t===Ae){if(null!==e.ExceptObject)this.UseExpr(e.ExceptObject);else for(h=e.FParent;null!==h;){if(ve.isPrototypeOf(h)){this.UseVariable(h.VarEl,1,!1);break}h=h.FParent}this.UseExpr(e.ExceptAddr)}else t===Ne?(this.UseImplBlock(e,!1),this.UseImplBlock(e.FinallyExcept,!1),this.UseImplBlock(e.ElseBranch,!1)):this.RaiseNotSupported(20170307162715,e,"")},this.UseExpr=function(e){var t=this;var s,i=null,r=[],n=0,a=null,o=null,h=0,u=null,c=null;if(null!==e){if(i=null,be.isPrototypeOf(e.FData)){if(a=(i=e.FData).FDeclaration,h=i.Access,this.MarkImplScopeRef(e,a,l.ResolvedToPSRefAccess[h]),this.UseElement(a,h,!1),null!==i.Context&&i.Context.$class.ClassType()===Oe&&this.UseProcedure(i.Context.Proc),this.FResolver.IsNameExpr(e)){if(null!==i.WithExprScope&&ke.isPrototypeOf(i.WithExprScope.ClassRecScope))return void this.UseExprRef(e,i.WithExprScope.Expr,h,!1);k.isPrototypeOf(a)&&$e.isPrototypeOf(e.FParent)&&e.FParent.Right===e&&(Q.isPrototypeOf(a.FParent)||De.isPrototypeOf(a.FParent))&&this.UseExprRef(e.FParent,e.FParent.Left,h,!1)}if(7 in i.Flags&&this.UseRecordFields(e),R.isPrototypeOf(a)&&Le.isPrototypeOf(a.FData)){var p=a.FData.BuiltIn;if(7===p)return void function(){var s,i,r=null,n=null,l=xe.$new();if(t.FResolver.GetParamsOfNameExpr(e,l),null!==l.Params&&(s=l.Params.Params,!(rtl.length(s)<1))){for(r=e.FParent;null!==r&&!E.isPrototypeOf(r);)r=r.FParent;null!==r&&(n=r,ee.isPrototypeOf(n.ProcType)||t.RaiseNotSupported(20190825203504,e,""),null!==(i=rtl.as(n.FData,A)).DeclarationProc&&(n=i.DeclarationProc),r=n.ProcType.ResultEl,t.UseElement(r,2,!1))}}();if(28===p)return void function(){var s,i=xe.$new(),r=U.$new(),n=null,l=null,a=null;t.FResolver.GetParamsOfNameExpr(e,i),null===i.Params&&t.RaiseNotSupported(20190225150136,e,""),s=i.Params.Params,1!==rtl.length(s)&&t.RaiseNotSupported(20180226144217,e.FParent,""),t.FResolver.ComputeElement(s[0],r,rtl.createSet(1),null),null===r.IdentEl&&t.RaiseNotSupported(20180628155107,s[0],""),E.isPrototypeOf(r.IdentEl)&&ee.isPrototypeOf(r.IdentEl.ProcType)?(a=r.IdentEl,null!==(l=rtl.as(a.FData,A)).DeclarationProc&&(a=l.DeclarationProc),n=a.ProcType.ResultEl.ResultType,t.MarkImplScopeRef(e,n,5),t.UseTypeInfo(n)):(n=r.IdentEl,t.MarkImplScopeRef(e,n,5),t.UseTypeInfo(n))}();30===p&&null!==(o=rtl.as(this.FResolver.FRootElement.FData,ae)).FAssertClass&&this.UseElType(e,o.FAssertClass,0)}}if(this.UseExpr(e.Format1),this.UseExpr(e.Format2),(s=e.$class.ClassType())===Be||s===Me||s===Ge);else if(s===$e)if(1===(u=e).OpCode){for(c=u;c.$class.ClassType()===$e&&1===(u=c).OpCode;)c=u.Left;this.UseExpr(c);do{u=c.FParent,this.UseExpr(u.Right),c=u}while(c!==e)}else this.UseExpr(u.Left),this.UseExpr(u.Right);else if(s===we)this.UseExpr(e.Operand);else if(s===Ve){this.UseExpr(e.Value),r=e.Params;for(var f=0,d=rtl.length(r)-1;f<=d;f++)n=f,this.UseExpr(r[n])}else if(s===Ue){r=e.Values;for(var F=0,m=rtl.length(r)-1;F<=m;F++)n=F,this.UseExpr(r[n])}else if(s===Je)for(var C=0,S=rtl.length(e.Fields)-1;C<=S;C++)n=C,this.UseExpr(e.Fields[n].ValueExp);else s===je?this.UseInheritedExpr(e):s===He?this.UseProcedure(e.Proc):s===We?this.UseInlineSpecializeExpr(e):this.RaiseNotSupported(20170307085444,e,"")}},this.UseExprRef=function(e,t,s,i){var r,n=null,a=null,o=null,h=U.$new(),u=null;if((r=t.$class.ClassType())===$e)(a=t).OpCode in rtl.createSet(27,0)&&this.UseExprRef(e,a.Right,s,i);else if(r===Ve){var c=(o=t).Kind;10===c?this.FResolver.IsTypeCast(o)?this.UseExprRef(e,o.Params[0],s,i):this.UseExprRef(e,o.Value,s,i):11===c?(this.FResolver.ComputeElement(o.Value,h,{},null),this.FResolver.IsDynArray(h.LoTypeEl,!0)||this.UseExprRef(e,o.Value,s,i)):4===c||this.RaiseNotSupported(20170403173817,o,"")}else r===Be&&0===t.Kind?be.isPrototypeOf(t.FData)&&(n=t.FData,this.MarkImplScopeRef(e,n.FDeclaration,l.ResolvedToPSRefAccess[s]),this.UseElement(n.FDeclaration,s,i)):r===we?(u=t).OpCode in rtl.createSet(1,2,24,25,26)?this.UseExprRef(e,u.Operand,1,!1):this.RaiseNotSupported(20181015193334,t,d.OpcodeStrings[u.OpCode]):r===We?this.UseExprRef(e,t.NameExpr,s,i):(1!==s||r!==Be&&r!==Ge&&r!==Me&&r!==we)&&this.RaiseNotSupported(20170306102159,t,"")},this.UseInheritedExpr=function(e){var t,s=null,i=null,r=0,n=null;if(e.FParent.$class.ClassType()!==$e||0!==e.FParent.OpCode){for(s=e.FParent;!s.$class.InheritsFrom(E);)s=s.FParent;for(var l=0,a=(i=(null!==(t=rtl.as(s.FData,A)).DeclarationProc?t.DeclarationProc:s).ProcType.Args).FCount-1;l<=a;l++){r=l;var o=(n=rtl.getObject(i.Get(r))).Access;0===o||1===o||4===o?this.UseArgument(n,1):2===o?this.UseArgument(n,4):3===o?this.UseArgument(n,5):this.RaiseNotSupported(20171107175406,n,"")}}},this.UseInlineSpecializeExpr=function(e){for(var t=0,s=0,i=e.Params.FCount-1;s<=i;s++)t=s,this.UseType(rtl.getObject(e.Params.Get(t)),0);this.UseExpr(e.NameExpr)},this.UseScopeReferences=function(e){null!==e&&e.References.ForEachCall(rtl.createCallback(this,"OnUseScopeRef"),e.FScope)},this.UseProcedure=function(e){var t=this;var s,i=null,r=null,n="",l=null,a=null,o=null;if(null!==e&&null===(s=rtl.as(e.FData,A)).DeclarationProc&&!this.CanSkipGenericProc(e)&&this.MarkElementAsUsed(e,null)&&(re.isPrototypeOf(e.FParent)&&this.UseClassOrRecType(e.FParent,0),this.UseProcedureType(e.ProcType),this.UseScopeReferences(s.References),i=e,null!==s.ImplProc&&(i=s.ImplProc),null!==i.Body&&this.UseImplBlock(i.Body.Body,!1),e.IsOverride()&&null!==s.OverriddenProc&&this.AddOverride(s.OverriddenProc,e),(rtl.neSet(rtl.intersectSet(rtl.createSet(3,0),e.FModifiers),{})||e.FParent.$class.ClassType()===C&&2===e.FParent.ObjKind)&&function(e){var s=null,i=0,r=null;if(null!==(s=t.FOverrideLists.FindKey(e)))for(i=0;i<s.Count();)r=rtl.as(s.GetOverrides(i),E),t.UseProcedure(r),i+=1}(e),C.isPrototypeOf(e.FParent)&&(2===(o=(r=e.FParent.FData).FElement).ObjKind&&this.IsTypeInfoUsed(o)&&this.UseTypeInfo(e),(e.$class.ClassType()===Ye||e.$class.ClassType()===ze)&&null===r.AncestorScope)))for(n=e.$class.ClassType()===Ye?"AfterConstruction":"BeforeDestruction",l=r.FindLocalIdentifier(n);null!==l;){if((a=l.FElement).$class.ClassType()===E&&0===a.ProcType.Args.FCount){this.UseProcedure(a);break}l=l.NextSameIdentifier}},this.UseProcedureType=function(e){var t=0,s=null;if(this.MarkElementAsUsed(e,null)){this.CanSkipGenericType(e)&&this.RaiseNotSupported(20190817151651,e,"");for(var i=0,r=e.Args.FCount-1;i<=r;i++)t=i,s=rtl.getObject(e.Args.Get(t)),this.UseElType(e,s.ArgType,0),this.UseExpr(s.ValueExpr);ee.isPrototypeOf(e)&&this.UseElType(e,e.ResultEl.ResultType,0)}},this.UseType=function(e,t){var s=null,i=0,r=null;if(null!==e)if(s=e.$class.ClassType(),2===t)s!==Q&&s!==C||this.UseClassOrRecType(e,t);else{if(s===R)_e.isPrototypeOf(e.FData)||Le.isPrototypeOf(e.FData)||this.RaiseNotSupported(20170307101353,e,"");else if(s===j||s===H||s===q){if(!this.MarkElementAsUsed(e,null))return;this.UseElType(e,e.DestType,t),s===H&&this.UseExpr(e.Expr)}else if(s===_){if(r=e,this.CanSkipGenericType(r))return;if(!this.MarkElementAsUsed(r,null))return;for(var n=0,l=rtl.length(r.Ranges)-1;n<=l;n++)i=n,this.UseExpr(r.Ranges[i]);this.UseElType(e,r.ElType,t)}else if(s===Q||s===C)this.UseClassOrRecType(e,t);else if(s===W){if(!this.MarkElementAsUsed(e,null))return;for(var a=0,o=e.Values.FCount-1;a<=o;a++)i=a,this.UseElement(rtl.getObject(e.Values.Get(i)),1,!1)}else if(s===K){if(!this.MarkElementAsUsed(e,null))return;this.UseElType(e,e.DestType,t)}else if(s===z){if(!this.MarkElementAsUsed(e,null))return;this.UseExpr(e.RangeExpr)}else if(s===Y){if(!this.MarkElementAsUsed(e,null))return;this.UseElType(e,e.EnumType,t)}else if(s.InheritsFrom(Z)){if(this.CanSkipGenericType(e))return;this.UseProcedureType(e)}else s===te?this.UseSpecializeType(e,t):s===ie||this.RaiseNotSupported(20170306170315,e,"");1===t&&this.UseTypeInfo(e)}},this.UseClassOrRecType=function(e,t){var s=this;var i,r=0,n=null,l=!1,a=!1,o=null,h=null,u=null,c=0,p=null,f=null,d=null,S=null,y=null,g=null,P=null,I=null,R=null;l=!0;var v=t;if(2!==v){if(1===v){if(this.CanSkipGenericType(e))return;if(this.MarkElementAsUsed(e,null))this.ElementVisited(e,t);else{if(this.ElementVisited(e,t))return;l=!1}}else if(0===v){if(this.CanSkipGenericType(e))return;if(!this.MarkElementAsUsed(e,null))return}else this.RaiseInconsistency(20170414152143,T(t));if(null===this.FScopeModule||this.FScopeModule===e.GetModule()){if(I=null,h=null,a=!1,e.$class.ClassType()===C){if((I=e).IsForward)return u=rtl.as(I.FData,be),void this.UseClassOrRecType(rtl.as(u.FDeclaration,C),t);h=rtl.as(I.FData,Xe),l&&(this.UseElType(e,h.DirectAncestor,0),this.UseElType(e,I.HelperForType,0),this.UseExpr(I.GUIDExpr),2===I.ObjKind&&(!function(){var t=null,i=0,r=null;if(null!==(t=s.FOverrideLists.FindKey(e)))for(i=0;i<t.Count();)r=rtl.as(t.GetOverrides(i),F),s.UseVariable(r,1,!1),i+=1}(),0===I.InterfaceType&&null===I.AncestorType&&(a=!0)),1===I.ObjKind&&null!==this.FScopeModule&&null!==h.Interfaces&&function(t){var i=0,r=0,n=null,l=null;if(null!==t.Interfaces)for(var a=0,o=t.Interfaces.FCount-1;a<=o;a++)if(i=a,n=rtl.getObject(t.Interfaces.Get(i)),F.isPrototypeOf(n))s.UseVariable(n,1,!1);else if(Ke.isPrototypeOf(n)){l=n;do{if(null!==l.Intf&&s.UseClassOrRecType(l.Intf,0),null!==l.Procs)for(var h=0,u=l.Procs.FCount-1;h<=u;h++)r=h,s.UseProcedure(rtl.getObject(l.Procs.Get(r)));l=l.AncestorMap}while(null!==l)}else s.RaiseNotSupported(20180405190114,e,x(n))}(h))}else if(Q.isPrototypeOf(e)){if(1!==t&&this.FResolver.IsTGUID(e))for(var N=0,O=e.Members.FCount-1;N<=O;N++)r=N,n=rtl.getObject(e.Members.Get(r)),k.isPrototypeOf(n)&&this.UseVariable(n,0,!0)}else this.RaiseNotSupported(20181229103139,e,"");i=2!==t;for(var $=0,D=e.Members.FCount-1;$<=D;$++){if(r=$,R=(n=rtl.getObject(e.Members.Get(r))).$class.ClassType(),l&&R.InheritsFrom(E)){if(P=n,o=rtl.as(n.FData,A),null===this.FScopeModule&&!this.FResolver.IsFullySpecialized$1(P))continue;if(P.IsOverride()&&null!==o.OverriddenProc){if(this.AddOverride(o.OverriddenProc,n),null!==this.FScopeModule){this.UseProcedure(P);continue}}else if(P.$class.ClassType()===qe||P.$class.ClassType()===Qe){this.UseProcedure(P);continue}if(a){var L=Ze(n.FName);if("queryinterface"===L){if(2===P.ProcType.Args.FCount){this.UseProcedure(P);continue}}else if("_addref"===L){if(0===P.ProcType.Args.FCount){this.UseProcedure(P);continue}}else if("_release"===L&&0===P.ProcType.Args.FCount){this.UseProcedure(P);continue}}if(null!==P.MessageExpr){this.UseProcedure(P);continue}}else if(R===X)continue;if(i&&(4===n.Visibility||e.HasExtRTTI(n))){if(!l)continue;if(b.isPrototypeOf(n)&&!this.FResolver.IsFullySpecialized(n))continue;this.UseTypeInfo(n)}else{if(0===t)continue;if(n.Visibility in rtl.createSet(1,6))continue;if(n.Visibility in rtl.createSet(2,7)&&this.IsModuleInternal(e))continue;1===t&&(R===F?this.UseTypeInfo(n):R.InheritsFrom(m)&&this.UseType(n,t))}this.UseElement(n,0,!0)}if(l&&null!==h&&null!==(p=h.Interfaces))for(var B=0,M=p.FCount-1;B<=M;B++)if(r=B,d=rtl.getObject(p.Get(r)),F.isPrototypeOf(d))this.AddOverride(rtl.getObject(I.Interfaces.Get(r)),d);else if(Ke.isPrototypeOf(d))for(S=d;null!==S;){if(null!==(f=S.Procs))for(var G=0,w=f.FCount-1;G<=w;G++)c=G,null!==(y=rtl.getObject(f.Get(c)))&&(g=rtl.as(rtl.getObject(S.Intf.Members.Get(c)),E),this.AddOverride(g,y));S=S.AncestorMap}else this.RaiseNotSupported(20180328224632,I,x(d));this.UseAttributes(e)&&e.$class.ClassType()===C&&this.UseTypeInfo(e)}}},this.UseSpecializeType=function(e,t){var s=null,i=0;if(this.MarkElementAsUsed(e,null)){se.isPrototypeOf(e.FData)&&this.UseElType(e,e.FData.SpecializedType,t);for(var r=0,n=e.Params.FCount-1;r<=n;r++)i=r,s=rtl.getObject(e.Params.Get(i)),ie.isPrototypeOf(s)||this.UseElement(s,1,!1);this.UseElType(e,e.SubType,t)}},this.UseVariable=function(e,t,s){var i=this,r=null,n=!1,l=!1;function a(e,t){if(e){var s=r.Access;0===s?(r.Access=1,n=!0):1===s||(2===s?(r.Access=4,n=!0):3===s||4===s||i.RaiseInconsistency(20170311182420,""))}if(t){var a=r.Access;0===a?(r.Access=2,l=!0):1===a?(r.Access=3,l=!0):2===a||3===a||4===a||i.RaiseInconsistency(20170311182536,"")}}var o=null,h=0,u=!1,c=!1,p=!1,f=!1,d=null;if(null!==e){e.$class.ClassType()===F?(o=e,C.isPrototypeOf(o.FParent)&&2===(d=o.FParent).ObjKind&&this.IsTypeInfoUsed(d)&&(s=!0,this.UseTypeInfo(o))):o=null,u=!1,c=!1,s&&(null!==o?(p=null!==this.FResolver.GetPasPropertyGetter(o),f=null!==this.FResolver.GetPasPropertySetter(o),t=p?f?3:1:f?2:0):t=1);if(0===t||(1===t?u=!0:2===t?c=!0:3===t||4===t||5===t?(u=!0,c=!0):6===t?this.RaiseInconsistency(20170307153439,""):this.RaiseInconsistency(20170308120949,"")),n=!1,l=!1,this.MarkElementAsUsed(e,null)){if(r=this.FindElement(e),null!==e.Expr&&(r.Access=2),a(u,c),this.UseElType(e,e.VarType,0),this.UseExpr(e.Expr),this.UseExpr(e.LibraryName),this.UseExpr(e.ExportName),this.UseExpr(e.AbsoluteExpr),null!==o){for(var m=0,S=o.FArgs.FCount-1;m<=S;m++)h=m,this.UseElType(o,rtl.getObject(o.FArgs.Get(h)).ArgType,0);this.UseExpr(o.IndexExpr)}}else{if(null!==this.FScopeModule&&this.FScopeModule!==e.GetModule())return;if(null===(r=this.FindElement(e)))return;a(u,c)}null!==o&&(n&&this.UseElement(this.FResolver.GetPasPropertyGetter(o),1,!1),l&&this.UseElement(this.FResolver.GetPasPropertySetter(o),2,!1))}},this.UseResourcestring=function(e){this.MarkElementAsUsed(e,null)&&this.UseExpr(e.Expr)},this.UseExportSymbol=function(e){var t=null,s=null,i=null,r=null;this.MarkElementAsUsed(e,null)&&(be.isPrototypeOf(e.FData)&&null!==(s=(t=e.FData).FDeclaration)&&(this.UseElement(s,t.Access,!0),E.isPrototypeOf(s)?(i=s.ProcType,ee.isPrototypeOf(i)&&(r=i.ResultEl.ResultType,this.UseType(r,1))):k.isPrototypeOf(s)&&(r=s.VarType,this.UseType(r,1))),this.UseExpr(e.NameExpr),this.UseExpr(e.ExportName),this.UseExpr(e.ExportIndex))},this.UseArgument=function(e,t){var s=null,i=!1,r=!1;i=!1,r=!1;if(0===t||(1===t?i=!0:2===t?r=!0:3===t||4===t||5===t?(i=!0,r=!0):6===t?this.RaiseInconsistency(20170308121031,""):this.RaiseInconsistency(20170308121037,"")),this.MarkElementAsUsed(e,null))s=this.FindElement(e);else{if(null!==this.FScopeModule&&this.FScopeModule!==e.GetModule())return;null===(s=this.FindElement(e))&&this.RaiseNotSupported(20170308121928,e,"")}this.UpdateAccess(r,i,s)},this.UseResultElement=function(e,t){var s=!1,i=!1,r=null;s=!1,i=!1;if(0===t||(1===t?s=!0:2===t?i=!0:3===t||4===t||5===t?(s=!0,i=!0):6===t?this.RaiseInconsistency(20170308122319,""):this.RaiseInconsistency(20170308122324,"")),this.MarkElementAsUsed(e,null))r=this.FindElement(e);else{if(null!==this.FScopeModule&&this.FScopeModule!==e.GetModule())return;null===(r=this.FindElement(e))&&this.RaiseNotSupported(20170308122333,e,"")}this.UpdateAccess(i,s,r)},this.UseRecordFields=function(e){var t=this;function s(e){var s=U.$new();t.UseElement(e,1,!1),t.FResolver.ComputeElement(e.VarType,s,{},e),Q.isPrototypeOf(s.LoTypeEl)&&i(s.LoTypeEl)}function i(e){for(var t=null,r=0,n=null,l=0,a=(t=e.Members).FCount-1;l<=a;l++)r=l,(n=rtl.getObject(t.Get(r))).$class.ClassType()===k&&s(n);if(k.isPrototypeOf(e.VariantEl)&&s(e.VariantEl),null!==e.Variants)for(var o=0,h=e.Variants.FCount-1;o<=h;o++)r=o,i(rtl.getObject(e.Variants.Get(r)).Members)}var r=U.$new();this.FResolver.ComputeElement(e,r,{},null),Q.isPrototypeOf(r.LoTypeEl)&&i(r.LoTypeEl)},this.EmitElementHints=function(e){var t=null;null!==e&&((t=e.$class.ClassType()).InheritsFrom(k)?this.EmitVariableHints(e):t.InheritsFrom(m)?this.EmitTypeHints(e):t.InheritsFrom(E)?this.EmitProcedureHints(e):t===G||this.RaiseInconsistency(20170312093126,""))},this.EmitSectionHints=function(t){var s,i,r=null,n=null,l=null;if(null!==t){s=t.GetModule(),i=t.UsesClause;for(var a=0,o=rtl.length(i)-1;a<=o;a++)if(n=i[a],w.isPrototypeOf(n.Module)){if(r=n.Module,0===et(r.FName,"system"))continue;this.PAElementExists(r)||(null===(l=n.Expr)&&(l=n),this.EmitMessage(20170311191725,4,5023,e.sPAUnitNotUsed,tt(18,r.FName,18,s.FName),l))}this.EmitDeclarationsHints(t)}},this.EmitDeclarationsHints=function(t){for(var s=0,i=null,r=0,n=t.Declarations.FCount-1;r<=n;r++)if(s=r,i=rtl.getObject(t.Declarations.Get(s)),k.isPrototypeOf(i))this.EmitVariableHints(i);else if(m.isPrototypeOf(i))this.EmitTypeHints(i);else if(E.isPrototypeOf(i))this.EmitProcedureHints(i);else if(i.$class.ClassType()===X);else if(null===this.FindElement(i)){if(this.IsSpecializedGenericType(i))continue;this.EmitMessage(20170311231734,4,5028,e.sPALocalXYNotUsed,tt(18,i.ElementTypeName(),18,i.FName),i)}},this.EmitTypeHints=function(t){var s,i=0,r=null,n=null,l=null,a=null;if(null!==this.FindElement(t)){var o,h;if(l=null,(s=t.$class.ClassType())===Q)l=t.Members;else if(s===C){if(t.IsForward)return;l=t.Members}if(null!==l)for(var u=0,c=l.FCount-1;u<=c;u++)i=u,(r=rtl.getObject(l.Get(i))).$class.ClassType()!==X&&this.EmitElementHints(r)}else{if(this.IsSpecializedGenericType(t))return;if(O.isPrototypeOf(t.FData)&&null!==(a=t.FData.SpecializedItems))for(var p=0,f=a.GetCount()-1;p<=f;p++)if(i=p,n=a.GetItem(i).FSpecializedEl,null!==this.FindElement(n))return;if(o=t.FName,""!==(h=this.FResolver.FAnonymousElTypePostfix)&&st(o,h.length)===h)return;if(t.Visibility in rtl.createSet(1,6))this.EmitMessage(20170312000020,4,5071,e.sPAPrivateTypeXNeverUsed,tt(18,t.FullName()),t);else{if(C.isPrototypeOf(t)&&2===t.ObjKind)return;this.EmitMessage(20170312000025,4,5028,e.sPALocalXYNotUsed,tt(18,t.ElementTypeName(),18,it(t,3)),t)}}},this.EmitVariableHints=function(t){var s;if(null===(s=this.FindElement(t)))t.Visibility in rtl.createSet(1,6)?t.$class.ClassType()===J?this.EmitMessage(20170311234602,4,5072,e.sPAPrivateConstXNeverUsed,tt(18,t.FullName()),t):t.$class.ClassType()===F?this.EmitMessage(20170311234634,4,5073,e.sPAPrivatePropertyXNeverUsed,tt(18,t.FullName()),t):this.EmitMessage(20170311231412,4,5029,e.sPAPrivateFieldIsNeverUsed,tt(18,t.FullName()),t):t.$class.ClassType()===k?re.isPrototypeOf(t.FParent)?this.EmitMessage(20201229033108,4,4502,e.sPAFieldNotUsed,tt(18,t.FName),t):this.EmitMessage(20170311234201,4,5025,e.sPALocalVariableNotUsed,tt(18,t.FName),t):this.EmitMessage(20170314221334,4,5028,e.sPALocalXYNotUsed,tt(18,t.ElementTypeName(),18,t.FName),t);else if(2===s.Access){if(1 in t.VarModifiers||t.$class.ClassType()===F||C.isPrototypeOf(t.FParent)&&t.FParent.IsExternal)return;t.Visibility in rtl.createSet(1,6)?this.EmitMessage(20170311234159,4,5030,e.sPAPrivateFieldIsAssignedButNeverUsed,tt(18,t.FullName()),t):re.isPrototypeOf(t.FParent)?this.EmitMessage(20201229033618,4,4503,e.sPAFieldIsAssignedButNeverUsed,tt(18,t.FName),t):this.EmitMessage(20170311233825,4,5027,e.sPALocalVariableIsAssignedButNeverUsed,tt(18,t.FName),t)}},this.EmitProcedureHints=function(t){var s,i=null,r=0,n=null,l=null,a=null,o=null,h=null,u=null;if(a=null===(s=rtl.as(t.FData,A)).DeclarationProc?t:s.DeclarationProc,o=null===s.ImplProc?t:s.ImplProc,null===s.ClassRecScope||null===s.ClassRecScope.SpecializedFromItem)if(this.PAElementExists(a)){if(!rtl.neSet(rtl.intersectSet(rtl.createSet(2,9,12),a.FModifiers),{})&&!(rtl.neSet(rtl.intersectSet(rtl.createSet(9),o.FModifiers),{})||C.isPrototypeOf(t.FParent)&&2===t.FParent.ObjKind)){if(null===s.DeclarationProc){for(var c=0,p=(i=t.ProcType.Args).FCount-1;c<=p;c++)r=c,n=rtl.getObject(i.Get(r)),null===(l=this.FindElement(n))||0===l.Access?Z.isPrototypeOf(n.FParent)&&E.isPrototypeOf(n.FParent.FParent)&&rtl.neSet(rtl.intersectSet(rtl.createSet(0,3),n.FParent.FParent.FModifiers),{})?this.EmitMessage(20180625153623,4,4501,e.sPAParameterInOverrideNotUsed,tt(18,n.FName),n):this.EmitMessage(20170312094401,4,5024,e.sPAParameterNotUsed,tt(18,n.FName),n):2!==l.Access||n.Access in rtl.createSet(3,2)||this.EmitMessage(20170312095348,4,5026,e.sPAValueParameterIsAssignedButNeverUsed,tt(18,n.FName),n);ee.isPrototypeOf(t.ProcType)&&this.EmitFunctionResultHints(t)}null!==t.Body&&this.EmitDeclarationsHints(t.Body)}}else{if(null!==s.DeclarationProc)return;if(null!==s.SpecializedFromItem)return;if(null!==(h=s.SpecializedItems))for(var f=0,d=h.GetCount()-1;f<=d;f++)if(r=f,u=h.GetItem(r).FSpecializedEl,null!==this.FindElement(u))return;t.Visibility in rtl.createSet(1,6)?this.EmitMessage(20170312093348,4,5031,e.sPAPrivateMethodIsNeverUsed,tt(18,t.FullName()),t):this.EmitMessage(20170312093418,4,5028,e.sPALocalXYNotUsed,tt(18,t.ElementTypeName(),18,t.FName),t)}},this.EmitFunctionResultHints=function(t){var s,i,r=null,n=null,l=0,a=!1,o=null,h=null;if(s=t.GetFT(),null===(i=this.FindElement(s.ResultEl))||i.Access in rtl.createSet(0,1)){if(r=this.FResolver.ResolveAliasType(s.ResultEl.ResultType,!0),Q.isPrototypeOf(r)){a=!1;for(var u=0,c=(n=r.Members).FCount-1;u<=c;u++)if(l=u,rtl.getObject(n.Get(l)).$class.ClassType()===k){a=!0;break}if(!a)return}o=s.ResultEl,null!==(h=rtl.as(t.FData,A)).ImplProc&&null!==h.ImplProc.GetFT().ResultEl&&(o=h.ImplProc.GetFT().ResultEl),this.EmitMessage(20170313214038,4,5033,e.sPAFunctionResultDoesNotSeemToBeSet,[],o)}},this.Create$1=function(){var t=0,s=0;this.CreateTree();for(var i=0;i<=3;i++)t=i,this.FModeChecked[t]=e.CreatePasElementSet();for(var r=0;r<=0;r++)s=r,this.FOtherChecked[s]=e.CreatePasElementSet();return this.FOverrideLists=n.$create("Create$1",[e.PAOverrideList_ElToHashName,e.PasElementToHashName]),this},this.Destroy=function(){this.Clear(),f({p:this,get:function(){return this.p.FOverrideLists},set:function(e){this.p.FOverrideLists=e}}),f({p:this,get:function(){return this.p.FUsedElements},set:function(e){this.p.FUsedElements=e}});for(var e=0;e<=3;e++)f({a:e,p:this.FModeChecked,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}});for(var t=0;t<=0;t++)f({a:t,p:this.FOtherChecked,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}});h.Destroy.call(this)},this.Clear=function(){var e=0,t=0;this.FOverrideLists.FreeItems(),this.FUsedElements.FreeItems();for(var s=0;s<=3;s++)e=s,this.FModeChecked[e].Clear();for(var i=0;i<=0;i++)t=i,this.FOtherChecked[t].Clear()},this.AnalyzeModule=function(e){var t=0;null===this.FResolver&&this.RaiseInconsistency(20170314223032,"TPasAnalyzer.AnalyzeModule missing Resolver"),this.FUsedElements.Count()>0&&this.RaiseInconsistency(20170315153243,""),this.FScopeModule=e,t=ne.isPrototypeOf(e)||le.isPrototypeOf(e)?2:1,this.UseModule(e,t)},this.AnalyzeWholeProgram=function(e){null===this.FResolver&&this.RaiseInconsistency(20170315153201,"TPasAnalyzer.AnalyzeWholeProgram missing Resolver"),this.FUsedElements.Count()>0&&this.RaiseInconsistency(20170315153252,""),this.FScopeModule=null,this.UseModule(e,2),this.MarkElementAsUsed(e,null)},this.EmitModuleHints=function(e){e.$class.ClassType()===ne?this.EmitSectionHints(e.ProgramSection):e.$class.ClassType()===le?this.EmitSectionHints(e.LibrarySection):(this.EmitSectionHints(e.InterfaceSection),this.EmitSectionHints(e.ImplementationSection))},this.FindElement=function(e){return this.FUsedElements.FindKey(e)},this.FindUsedElement=function(e){var t=null;return this.IsIdentifier(e)?(E.isPrototypeOf(e)&&null!==(t=rtl.as(e.FData,A))&&null!==t.DeclarationProc&&(e=t.DeclarationProc),this.FindElement(e)):null},this.IsUsed=function(e){return null!==this.FindUsedElement(e)},this.IsTypeInfoUsed=function(e){return this.FModeChecked[3].ContainsItem(e)},this.IsModuleInternal=function(e){var t;if(null===e)return!0;if((t=e.$class.ClassType())===v)return!1;if(t===rt)return!0;if(t===nt||t===lt)return!0;if(this.IsExport(e))return!1;var s=e.Visibility;return 1===s||6===s||4!==s&&this.IsModuleInternal(e.FParent)},this.IsExport=function(e){return k.isPrototypeOf(e)?rtl.neSet(rtl.intersectSet(rtl.createSet(3,2),e.VarModifiers),{}):!!E.isPrototypeOf(e)&&rtl.neSet(rtl.intersectSet(rtl.createSet(4,10),e.FModifiers),{})},this.IsIdentifier=function(e){var t=null;return(t=e.$class.ClassType()).InheritsFrom(m)||t.InheritsFrom(k)||t.InheritsFrom(E)||t.InheritsFrom(w)||t===$||t===L},this.IsImplBlockEmpty=function(e){var t=!1;return t=!0,null===e||0===e.Elements.FCount?t:t=!1},this.IsSpecializedGenericType=function(e){return!(!b.isPrototypeOf(e)||!O.isPrototypeOf(e.FData)||null===e.FData.SpecializedFromItem)||false},this.EmitMessage=function(e,t,i,r,n,l){var a=null,o=null,h=null,u=null,c=null,p=0;if(t>=2){for(o=l;null!==o;){if(E.isPrototypeOf(o)){null!==(h=rtl.as(o.FData,A)).ImplProc&&(h=rtl.as(h.ImplProc.FData,A));var f=t;if(4===f){if(!(22 in h.BoolSwitches))return}else if(3===f){if(!(23 in h.BoolSwitches))return}else if(2===f&&!(24 in h.BoolSwitches))return;break}if(w.isPrototypeOf(o)){u=rtl.as(o.FData,ae);var d=t;if(4===d){if(!(22 in u.BoolSwitches))return}else if(3===d){if(!(23 in u.BoolSwitches))return}else if(2===d&&!(24 in u.BoolSwitches))return;break}o=o.FParent}if(null!==this.FResolver&&null!==this.FResolver.FCurrentParser&&null!==(c=this.FResolver.FCurrentParser.FScanner)){p=c.GetWarnMsgState(i);if(2===p)return;3===p&&(t=1)}}(a=s.$create("Create$1")).Id=e,a.MsgType=t,a.MsgNumber=i,a.MsgPattern=r,a.MsgText=ot(r,n),ht({p:a,get:function(){return this.p.Args},set:function(e){this.p.Args=e}},n),a.PosEl=l,a.Filename=l.SourceFilename,this.FResolver.$class.UnmangleSourceLineNumber(l.SourceLinenumber,{p:a,get:function(){return this.p.Row},set:function(e){this.p.Row=e}},{p:a,get:function(){return this.p.Col},set:function(e){this.p.Col=e}}),this.EmitMessage$1(a)},this.EmitMessage$1=function(e){if(null!=this.FOnMessage)try{this.FOnMessage(this,e)}finally{e.Release()}else e.Release()}}),this.PasElementToHashName=function(e){return""+e.FPasElementId},this.PAElement_ElToHashName=function(e){return""+e.FElement.FPasElementId},this.PAOverrideList_ElToHashName=function(e){return""+e.FElement.FPasElementId},this.CreatePasElementSet=function(){return n.$create("Create$1",[e.PasElementToHashName,null])},this.GetElModName=function(e){var t,s="";return null===e?"nil":(s=e.PathName()+":"+e.$classname,(t=e.GetModule())===e||null===t&&(s="NilModule."+s),s)}}),rtl.module("jsbase",["System","JS"],function(){"use strict";var e=pas.System.TObject;this.MinSafeIntDouble=-9007199254740991,this.MaxSafeIntDouble=9007199254740991,this.TJSType={0:"jstUNDEFINED",jstUNDEFINED:0,1:"jstNull",jstNull:1,2:"jstBoolean",jstBoolean:2,3:"jstNumber",jstNumber:3,4:"jstString",jstString:4,5:"jstObject",jstObject:5,6:"jstReference",jstReference:6,7:"jstCompletion",jstCompletion:7},rtl.createClass(this,"TJSValue",e,function(){this.$init=function(){e.$init.call(this),this.FValueType=0,this.FValue=void 0,this.FCustomValue=""},this.ClearValue=function(e){var t=this.FValueType;this.FValue=0===t?void 0:4===t?"":3===t?0:2!==t&&null,this.FValueType=e,this.FCustomValue=""},this.GetAsBoolean=function(){return 2===this.FValueType&&!(0==this.FValue)},this.GetAsNumber=function(){return 3===this.FValueType?rtl.getNumber(this.FValue):0},this.GetAsString=function(){return 4===this.FValueType?""+this.FValue:""},this.GetIsNull=function(){return 1===this.FValueType},this.GetIsUndefined=function(){return 0===this.FValueType},this.SetAsBoolean=function(e){this.ClearValue(2),this.FValue=e},this.SetAsNumber=function(e){this.ClearValue(3),this.FValue=e},this.SetAsString=function(e){this.ClearValue(4),this.FValue=e},this.SetIsNull=function(e){e?this.ClearValue(1):this.GetIsNull()&&this.ClearValue(0)},this.SetIsUndefined=function(e){e?this.ClearValue(0):this.GetIsUndefined()&&this.ClearValue(1)},this.Create$1=function(){return this.SetIsUndefined(!0),this},this.Destroy=function(){this.ClearValue(0),e.Destroy.call(this)}});var t=rtl.createSet(null,48,57,null,97,102,null,65,70);this.IsValidJSIdentifier=function(e,s){var i,r=!1,n=0,l=0;if(r=!1,""===e)return r;for(i=e.length,n=1;n<=i;){var a=e.charAt(n-1);if(a>="0"&&a<="9"){if(1===n)return r;n+=1}else if(a>="a"&&a<="z"||a>="A"&&a<="Z"||"_"===a||"$"===a)n+=1;else if("\\"===a){if(!s)return r;if((n+=1)>i)return r;if("x"===e.charAt(n-1)){if((n+=1)>i||!(e.charCodeAt(n-1)in t))return r;if((n+=1)>i||!(e.charCodeAt(n-1)in t))return r}else{if("u"!==e.charAt(n-1))return r;if((n+=1)>i)return r;if("{"===e.charAt(n-1)){for(l=0;;){if((n+=1)>i)return r;var o=e.charAt(n-1);if("}"===o)break;if(o>="0"&&o<="9")l=16*l+e.charCodeAt(n-1)-48;else if(o>="a"&&o<="f")l=16*l+e.charCodeAt(n-1)-97+10;else{if(!(o>="A"&&o<="F"))return r;l=16*l+e.charCodeAt(n-1)-65+10}if(l>65535)return r}if(l>=55296&&l<57344)return r;n+=1}else for(l=1;l<=4;l++)if((n+=1)>i||!(e.charCodeAt(n-1)in t))return r}}else if(""===a||""===a)n+=1;else if(a>=""&&a<=""||a>=""&&a<="")n+=1;else{if(a>="\ud800"&&a<="\udfff")return r;if(!(a>=""&&a<=""))return r;n+=1}}return r=!0},this.StrToJSString=function(e){return e},this.JSStringToString=function(e){return e}}),rtl.module("jstoken",["System"],function(){"use strict";this.TJSToken={0:"tjsUnknown",tjsUnknown:0,1:"tjsEOF",tjsEOF:1,2:"tjsWhiteSpace",tjsWhiteSpace:2,3:"tjsChar",tjsChar:3,4:"tjsString",tjsString:4,5:"tjsIdentifier",tjsIdentifier:5,6:"tjsNumber",tjsNumber:6,7:"tjsComment",tjsComment:7,8:"tjsREGEX",tjsREGEX:8,9:"tjsRESERVED",tjsRESERVED:9,10:"tjsANDAND",tjsANDAND:10,11:"tjsANDEQ",tjsANDEQ:11,12:"tjsBraceOpen",tjsBraceOpen:12,13:"tjsBraceClose",tjsBraceClose:13,14:"tjsSQuaredBraceOpen",tjsSQuaredBraceOpen:14,15:"tjsSQuaredBraceClose",tjsSQuaredBraceClose:15,16:"tjsCurlyBraceOpen",tjsCurlyBraceOpen:16,17:"tjsCurlyBraceClose",tjsCurlyBraceClose:17,18:"tjsCOMMA",tjsCOMMA:18,19:"tjsCOLON",tjsCOLON:19,20:"tjsDOT",tjsDOT:20,21:"tjsSEMICOLON",tjsSEMICOLON:21,22:"tjsASSIGN",tjsASSIGN:22,23:"tjsGT",tjsGT:23,24:"tjsLT",tjsLT:24,25:"tjsConditional",tjsConditional:25,26:"tjsPLUS",tjsPLUS:26,27:"tjsMINUS",tjsMINUS:27,28:"tjsMUL",tjsMUL:28,29:"tjsDIV",tjsDIV:29,30:"tjsPower",tjsPower:30,31:"tjsAnd",tjsAnd:31,32:"tjsOR",tjsOR:32,33:"tjsInv",tjsInv:33,34:"tjsMod",tjsMod:34,35:"tjsXOR",tjsXOR:35,36:"tjsNot",tjsNot:36,37:"tjsEQ",tjsEQ:37,38:"tjsGE",tjsGE:38,39:"tjsLE",tjsLE:39,40:"tjsLSHIFT",tjsLSHIFT:40,41:"tjsLSHIFTEQ",tjsLSHIFTEQ:41,42:"tjsMINUSEQ",tjsMINUSEQ:42,43:"tjsMINUSMINUS",tjsMINUSMINUS:43,44:"tjsMODEQ",tjsMODEQ:44,45:"tjsDIVEQ",tjsDIVEQ:45,46:"tjsXOREq",tjsXOREq:46,47:"tjsNE",tjsNE:47,48:"tjsOREQ",tjsOREQ:48,49:"tjsOROR",tjsOROR:49,50:"tjsPLUSEQ",tjsPLUSEQ:50,51:"tjsPLUSPLUS",tjsPLUSPLUS:51,52:"tjsURSHIFT",tjsURSHIFT:52,53:"tjsURSHIFTEQ",tjsURSHIFTEQ:53,54:"tjsRSHIFT",tjsRSHIFT:54,55:"tjsRSHIFTEQ",tjsRSHIFTEQ:55,56:"tjsSEQ",tjsSEQ:56,57:"tjsSNE",tjsSNE:57,58:"tjsMULEQ",tjsMULEQ:58,59:"tjsArrow",tjsArrow:59,60:"tjsEllipsis",tjsEllipsis:60,61:"tjsAWAIT",tjsAWAIT:61,62:"tjsBREAK",tjsBREAK:62,63:"tjsCASE",tjsCASE:63,64:"tjsCATCH",tjsCATCH:64,65:"tjsCLASS",tjsCLASS:65,66:"tjsCONST",tjsCONST:66,67:"tjsCONTINUE",tjsCONTINUE:67,68:"tjsDEBUGGER",tjsDEBUGGER:68,69:"tjsDEFAULT",tjsDEFAULT:69,70:"tjsDELETE",tjsDELETE:70,71:"tjsDO",tjsDO:71,72:"tjsELSE",tjsELSE:72,73:"tjsENUM",tjsENUM:73,74:"tjsEXPORT",tjsEXPORT:74,75:"tjsEXTENDS",tjsEXTENDS:75,76:"tjsFALSE",tjsFALSE:76,77:"tjsFINALLY",tjsFINALLY:77,78:"tjsFOR",tjsFOR:78,79:"tjsFUNCTION",tjsFUNCTION:79,80:"tjsIF",tjsIF:80,81:"tjsIMPORT",tjsIMPORT:81,82:"tjsIN",tjsIN:82,83:"tjsINSTANCEOF",tjsINSTANCEOF:83,84:"tjsLet",tjsLet:84,85:"tjsNEW",tjsNEW:85,86:"tjsNULL",tjsNULL:86,87:"tjsRETURN",tjsRETURN:87,88:"tjsSUPER",tjsSUPER:88,89:"tjsSWITCH",tjsSWITCH:89,90:"tjsTHIS",tjsTHIS:90,91:"tjsTHROW",tjsTHROW:91,92:"tjsTrue",tjsTrue:92,93:"tjsTRY",tjsTRY:93,94:"tjsTYPEOF",tjsTYPEOF:94,95:"tjsVAR",tjsVAR:95,96:"tjsVOID",tjsVOID:96,97:"tjsWHILE",tjsWHILE:97,98:"tjsWITH",tjsWITH:98,99:"tjsYield",tjsYield:99},this.TokenInfos=["unknown","EOF","whitespace","AnsiChar","String","identifier","number","comment","regular expression","reserved word","&&","&=","(",")","[","]","{","}",",",":",".",";","=",">","<","?","+","-","*","/","**","&","|","~","%","^","!","==",">=","<=","<<","<<=","-=","--","%=","/=","^=","!=","|=","||","+=","++",">>>",">>>=",">>",">>=","===","!==","*=","=>","...","await","break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","export","extends","false","finally","for","function","if","import","in","instanceof","let","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield"]}),rtl.module("jstree",["System","Classes","SysUtils","jsbase","jstoken"],function(){"use strict";var e=null,t=null,s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=null,R=null,v=null,A=null,N=null,x=null,b=null,O=null,k=null,$=null,D=null,L=null,B=null,M=null,G=null,w=null,V=pas.System.TObject,U=pas.Classes,J=U.TStringList,j=pas.SysUtils.FreeAndNil,H=pas.jsbase.TJSValue,W=U.TCollectionItem,Y=U.TCollection,z=pas.jstoken,_=U.TPersistent;rtl.createClass(this,"TJSObject",V,function(){e=this}),rtl.createClass(this,"TJSLabel",e,function(){this.$init=function(){e.$init.call(this),this.FName=""}}),rtl.createClass(this,"TJSFuncDef",e,function(){this.$init=function(){e.$init.call(this),this.FBody=null,this.FIsAsync=!1,this.FIsEmpty=!1,this.FName="",this.FParams=null,this.FResultType=null,this.FTypedParams=null,this.FGenericParams=null},this.$final=function(){this.FBody=void 0,this.FParams=void 0,this.FResultType=void 0,this.FTypedParams=void 0,this.FGenericParams=void 0,e.$final.call(this)},this.Create$1=function(){return this.FParams=J.$create("Create$1"),this.FTypedParams=M.$create("Create$2"),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FGenericParams},set:function(e){this.p.FGenericParams=e}}),j({p:this,get:function(){return this.p.FTypedParams},set:function(e){this.p.FTypedParams=e}}),j({p:this,get:function(){return this.p.FBody},set:function(e){this.p.FBody=e}}),j({p:this,get:function(){return this.p.FParams},set:function(e){this.p.FParams=e}}),j({p:this,get:function(){return this.p.FResultType},set:function(e){this.p.FResultType=e}}),V.Destroy.call(this)}}),rtl.createClass(this,"TJSElement",e,function(){t=this,this.GlobalFreeHook=null,this.$init=function(){e.$init.call(this),this.FLine=0,this.FColumn=0,this.FSource=""},this.Create$1=function(e,t,s){return this.FLine=e,this.FColumn=t,this.FSource=s,this},this.Destroy=function(){null!=this.GlobalFreeHook&&this.GlobalFreeHook(this),V.Destroy.call(this)}}),rtl.createClass(this,"TJSStatement",t,function(){s=this}),rtl.createClass(this,"TJSEmptyBlockStatement",s,function(){0}),rtl.createClass(this,"TJSEmptyStatement",s,function(){0}),rtl.createClass(this,"TJSLiteral",t,function(){this.$init=function(){t.$init.call(this),this.FValue=null},this.$final=function(){this.FValue=void 0,t.$final.call(this)},this.Create$1=function(e,s,i){return this.FValue=H.$create("Create$1"),t.Create$1.call(this,e,s,i),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FValue},set:function(e){this.p.FValue=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSRegularExpressionLiteral",t,function(){this.$init=function(){t.$init.call(this),this.FPattern=null,this.FPatternFlags=null},this.$final=function(){this.FPattern=void 0,this.FPatternFlags=void 0,t.$final.call(this)},this.Create$1=function(e,s,i){return t.Create$1.call(this,e,s,i),this.FPattern=H.$create("Create$1"),this.FPatternFlags=H.$create("Create$1"),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FPattern},set:function(e){this.p.FPattern=e}}),j({p:this,get:function(){return this.p.FPatternFlags},set:function(e){this.p.FPatternFlags=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSPrimaryExpression",t,function(){i=this}),rtl.createClass(this,"TJSPrimaryExpressionThis",i,function(){0}),rtl.createClass(this,"TJSPrimaryExpressionIdent",i,function(){this.$init=function(){i.$init.call(this),this.FName=""}}),rtl.createClass(this,"TJSArrayLiteralElement",W,function(){r=this,this.$init=function(){W.$init.call(this),this.FExpr=null,this.FElementIndex=0},this.$final=function(){this.FExpr=void 0,W.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FExpr},set:function(e){this.p.FExpr=e}}),W.Destroy.call(this)}}),rtl.createClass(this,"TJSArrayLiteralElements",Y,function(){n=this,this.GetE=function(e){return this.GetItem(e)},this.AddElement=function(){return this.Add()}}),rtl.createClass(this,"TJSArrayLiteral",t,function(){l=this,this.$init=function(){t.$init.call(this),this.FElements=null},this.$final=function(){this.FElements=void 0,t.$final.call(this)},this.GetCount=function(){return this.FElements.GetCount()},this.Create$1=function(e,s,i){return t.Create$1.call(this,e,s,i),this.FElements=n.$create("Create$1",[r]),this},this.AddElement=function(e){var t=null;(t=this.FElements.AddElement()).FElementIndex=this.FElements.GetCount()-1,t.FExpr=e},this.Destroy=function(){j({p:this,get:function(){return this.p.FElements},set:function(e){this.p.FElements=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSObjectLiteralElement",W,function(){a=this,this.$init=function(){W.$init.call(this),this.FExpr=null,this.FName=""},this.$final=function(){this.FExpr=void 0,W.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FExpr},set:function(e){this.p.FExpr=e}}),W.Destroy.call(this)}}),rtl.createClass(this,"TJSObjectLiteralElements",Y,function(){o=this,this.GetE=function(e){return this.GetItem(e)},this.AddElement=function(){return this.Add()}}),rtl.createClass(this,"TJSObjectLiteral",t,function(){this.$init=function(){t.$init.call(this),this.FElements=null},this.$final=function(){this.FElements=void 0,t.$final.call(this)},this.Create$1=function(e,s,i){return t.Create$1.call(this,e,s,i),this.FElements=o.$create("Create$1",[a]),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FElements},set:function(e){this.p.FElements=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSArguments",l,function(){0}),rtl.createClass(this,"TJSMemberExpression",t,function(){h=this,this.$init=function(){t.$init.call(this),this.FMExpr=null},this.$final=function(){this.FMExpr=void 0,t.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FMExpr},set:function(e){this.p.FMExpr=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSNewMemberExpression",h,function(){this.$init=function(){h.$init.call(this),this.FArgs=null},this.$final=function(){this.FArgs=void 0,h.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FArgs},set:function(e){this.p.FArgs=e}}),h.Destroy.call(this)}}),rtl.createClass(this,"TJSDotMemberExpression",h,function(){this.$init=function(){h.$init.call(this),this.FName=""}}),rtl.createClass(this,"TJSBracketMemberExpression",h,function(){this.$init=function(){h.$init.call(this),this.FName=null},this.$final=function(){this.FName=void 0,h.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FName},set:function(e){this.p.FName=e}}),h.Destroy.call(this)}}),rtl.createClass(this,"TJSCallExpression",t,function(){this.$init=function(){t.$init.call(this),this.FArgs=null,this.FExpr=null},this.$final=function(){this.FArgs=void 0,this.FExpr=void 0,t.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FExpr},set:function(e){this.p.FExpr=e}}),j({p:this,get:function(){return this.p.FArgs},set:function(e){this.p.FArgs=e}}),t.Destroy.call(this)},this.AddArg=function(e){this.FArgs.FElements.AddElement().FExpr=e},this.InsertArg=function(e,t){this.FArgs.FElements.Insert(e).FExpr=t}}),rtl.createClass(this,"TJSUnary",t,function(){u=this,this.$init=function(){t.$init.call(this),this.FA=null},this.$final=function(){this.FA=void 0,t.$final.call(this)},this.PrefixOperatorToken=function(){return 0},this.PostFixOperatorToken=function(){return 0},this.PrefixOperator=function(){var e,t="";return 0===(e=this.PrefixOperatorToken())?t="":(t=z.TokenInfos[e],e in rtl.createSet(94,96,70,91,61,99)&&(t+=" ")),t},this.PostFixOperator=function(){var e;return 0===(e=this.PostFixOperatorToken())?"":z.TokenInfos[e]},this.Destroy=function(){j({p:this,get:function(){return this.p.FA},set:function(e){this.p.FA=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSDeclarationStatement",t,function(){c=this}),this.TJSVarType={0:"vtVar",vtVar:0,1:"vtLet",vtLet:1,2:"vtConst",vtConst:2},rtl.createClass(this,"TJSVariableStatement",c,function(){this.$init=function(){c.$init.call(this),this.FA=null,this.FVarType=0},this.$final=function(){this.FA=void 0,c.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FA},set:function(e){this.p.FA=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSExpressionStatement",u,function(){0}),rtl.createClass(this,"TJSThrowStatement",u,function(){this.PrefixOperatorToken=function(){return 91}}),rtl.createClass(this,"TJSUnaryExpression",u,function(){p=this}),rtl.createClass(this,"TJSAwaitExpression",p,function(){this.PrefixOperatorToken=function(){return 61}}),rtl.createClass(this,"TJSUnaryPlusExpression",p,function(){this.PrefixOperatorToken=function(){return 26}}),rtl.createClass(this,"TJSUnaryMinusExpression",p,function(){this.PrefixOperatorToken=function(){return 27}}),rtl.createClass(this,"TJSUnaryInvExpression",p,function(){this.PrefixOperatorToken=function(){return 33}}),rtl.createClass(this,"TJSUnaryNotExpression",p,function(){this.PrefixOperatorToken=function(){return 36}}),rtl.createClass(this,"TJSUnaryPostPlusPlusExpression",p,function(){this.PostFixOperatorToken=function(){return 51}}),rtl.createClass(this,"TJSUnaryPostMinusMinusExpression",p,function(){this.PostFixOperatorToken=function(){return 43}}),rtl.createClass(this,"TJSUnaryBracketsExpression",p,function(){this.PrefixOperatorToken=function(){return 12},this.PostFixOperatorToken=function(){return 13}}),rtl.createClass(this,"TJSBinary",t,function(){f=this,this.$init=function(){t.$init.call(this),this.FA=null,this.FB=null},this.$final=function(){this.FA=void 0,this.FB=void 0,t.$final.call(this)},this.Destroy=function(){function e(e,t){var s=0,i=null,r=[];for(r=rtl.arraySetLength(r,null,8),s=0;f.isPrototypeOf(e);)i=e,s===rtl.length(r)&&(r=rtl.arraySetLength(r,null,2*s)),r[s]=i,s+=1,e=t?i.FA:i.FB;for(;s>0;)i=r[s-=1],j({p:i,get:function(){return this.p.FA},set:function(e){this.p.FA=e}}),j({p:i,get:function(){return this.p.FB},set:function(e){this.p.FB=e}})}f.isPrototypeOf(this.FA)&&e(this.FA,!0),f.isPrototypeOf(this.FB)&&e(this.FB,!1),j({p:this,get:function(){return this.p.FA},set:function(e){this.p.FA=e}}),j({p:this,get:function(){return this.p.FB},set:function(e){this.p.FB=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSStatementList",f,function(){0}),rtl.createClass(this,"TJSVariableDeclarationList",f,function(){0}),rtl.createClass(this,"TJSWithStatement",f,function(){0}),rtl.createClass(this,"TJSBinaryExpression",f,function(){d=this,this.OperatorToken=function(){return 0},this.OperatorString=function(){var e;return 0!==(e=this.OperatorToken())?z.TokenInfos[e]:""},this.AllowCompact=function(){return true}}),rtl.createClass(this,"TJSLogicalOrExpression",d,function(){this.OperatorToken=function(){return 49}}),rtl.createClass(this,"TJSLogicalAndExpression",d,function(){this.OperatorToken=function(){return 10}}),rtl.createClass(this,"TJSBitwiseAndExpression",d,function(){this.OperatorToken=function(){return 31}}),rtl.createClass(this,"TJSBitwiseOrExpression",d,function(){this.OperatorToken=function(){return 32}}),rtl.createClass(this,"TJSBitwiseXOrExpression",d,function(){this.OperatorToken=function(){return 35}}),rtl.createClass(this,"TJSEqualityExpression",d,function(){F=this}),rtl.createClass(this,"TJSEqualityExpressionEQ",F,function(){this.OperatorToken=function(){return 37}}),rtl.createClass(this,"TJSEqualityExpressionNE",F,function(){this.OperatorToken=function(){return 47}}),rtl.createClass(this,"TJSEqualityExpressionSEQ",F,function(){this.OperatorToken=function(){return 56}}),rtl.createClass(this,"TJSEqualityExpressionSNE",F,function(){this.OperatorToken=function(){return 57}}),rtl.createClass(this,"TJSRelationalExpression",d,function(){m=this}),rtl.createClass(this,"TJSRelationalExpressionLT",m,function(){this.OperatorToken=function(){return 24}}),rtl.createClass(this,"TJSRelationalExpressionGT",m,function(){this.OperatorToken=function(){return 23}}),rtl.createClass(this,"TJSRelationalExpressionLE",m,function(){this.OperatorToken=function(){return 39}}),rtl.createClass(this,"TJSRelationalExpressionGE",m,function(){this.OperatorToken=function(){return 38}}),rtl.createClass(this,"TJSRelationalExpressionIn",m,function(){this.OperatorToken=function(){return 82},this.AllowCompact=function(){return false}}),rtl.createClass(this,"TJSRelationalExpressionInstanceOf",m,function(){this.OperatorToken=function(){return 83},this.AllowCompact=function(){return false}}),rtl.createClass(this,"TJSShiftExpression",d,function(){C=this}),rtl.createClass(this,"TJSLShiftExpression",C,function(){this.OperatorToken=function(){return 40}}),rtl.createClass(this,"TJSRShiftExpression",C,function(){this.OperatorToken=function(){return 54}}),rtl.createClass(this,"TJSURShiftExpression",C,function(){this.OperatorToken=function(){return 52}}),rtl.createClass(this,"TJSAdditiveExpression",d,function(){S=this}),rtl.createClass(this,"TJSAdditiveExpressionPlus",S,function(){this.OperatorToken=function(){return 26}}),rtl.createClass(this,"TJSAdditiveExpressionMinus",S,function(){this.OperatorToken=function(){return 27}}),rtl.createClass(this,"TJSMultiplicativeExpression",d,function(){T=this}),rtl.createClass(this,"TJSMultiplicativeExpressionMul",T,function(){this.OperatorToken=function(){return 28}}),rtl.createClass(this,"TJSMultiplicativeExpressionDiv",T,function(){this.OperatorToken=function(){return 29}}),rtl.createClass(this,"TJSMultiplicativeExpressionMod",T,function(){this.OperatorToken=function(){return 34}}),rtl.createClass(this,"TJSPowerExpression",d,function(){this.OperatorToken=function(){return 30}}),rtl.createClass(this,"TJSCommaExpression",d,function(){this.OperatorToken=function(){return 18}}),rtl.createClass(this,"TJSConditionalExpression",t,function(){this.$init=function(){t.$init.call(this),this.FA=null,this.FB=null,this.FC=null},this.$final=function(){this.FA=void 0,this.FB=void 0,this.FC=void 0,t.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FB},set:function(e){this.p.FB=e}}),j({p:this,get:function(){return this.p.FA},set:function(e){this.p.FA=e}}),j({p:this,get:function(){return this.p.FC},set:function(e){this.p.FC=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSDebuggerStatement",s,function(){0}),rtl.createClass(this,"TJSAssignStatement",s,function(){y=this,this.$init=function(){s.$init.call(this),this.FExpr=null,this.FLHS=null},this.$final=function(){this.FExpr=void 0,this.FLHS=void 0,s.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FLHS},set:function(e){this.p.FLHS=e}}),j({p:this,get:function(){return this.p.FExpr},set:function(e){this.p.FExpr=e}}),t.Destroy.call(this)},this.OperatorToken=function(){return 0},this.OperatorString=function(){var e;return 0!==(e=this.OperatorToken())?z.TokenInfos[e]:""}}),rtl.createClass(this,"TJSSimpleAssignStatement",y,function(){this.OperatorToken=function(){return 22}}),rtl.createClass(this,"TJSMulEqAssignStatement",y,function(){this.OperatorToken=function(){return 58}}),rtl.createClass(this,"TJSDivEqAssignStatement",y,function(){this.OperatorToken=function(){return 45}}),rtl.createClass(this,"TJSAddEqAssignStatement",y,function(){this.OperatorToken=function(){return 50}}),rtl.createClass(this,"TJSSubEqAssignStatement",y,function(){this.OperatorToken=function(){return 42}}),rtl.createClass(this,"TJSVarDeclaration",t,function(){this.$init=function(){t.$init.call(this),this.FInit=null,this.FName="",this.FOwnsType=!1,this.FTyped=null},this.$final=function(){this.FInit=void 0,this.FTyped=void 0,t.$final.call(this)},this.Destroy=function(){this.FOwnsType&&j({p:this,get:function(){return this.p.FTyped},set:function(e){this.p.FTyped=e}}),j({p:this,get:function(){return this.p.FInit},set:function(e){this.p.FInit=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSIfStatement",s,function(){this.$init=function(){s.$init.call(this),this.FBFalse=null,this.FBTrue=null,this.FCond=null},this.$final=function(){this.FBFalse=void 0,this.FBTrue=void 0,this.FCond=void 0,s.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FCond},set:function(e){this.p.FCond=e}}),j({p:this,get:function(){return this.p.FBTrue},set:function(e){this.p.FBTrue=e}}),j({p:this,get:function(){return this.p.FBFalse},set:function(e){this.p.FBFalse=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSTargetStatement",s,function(){g=this,this.$init=function(){s.$init.call(this),this.FTargetName=""}}),rtl.createClass(this,"TJSBodyStatement",g,function(){E=this,this.$init=function(){g.$init.call(this),this.FBody=null},this.$final=function(){this.FBody=void 0,g.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FBody},set:function(e){this.p.FBody=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSCondLoopStatement",E,function(){P=this,this.$init=function(){E.$init.call(this),this.FCond=null},this.$final=function(){this.FCond=void 0,E.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FCond},set:function(e){this.p.FCond=e}}),E.Destroy.call(this)}}),rtl.createClass(this,"TJSWhileStatement",P,function(){I=this}),rtl.createClass(this,"TJSDoWhileStatement",I,function(){0}),rtl.createClass(this,"TJSForStatement",P,function(){this.$init=function(){P.$init.call(this),this.FIncr=null,this.FInit=null},this.$final=function(){this.FIncr=void 0,this.FInit=void 0,P.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FIncr},set:function(e){this.p.FIncr=e}}),j({p:this,get:function(){return this.p.FInit},set:function(e){this.p.FInit=e}}),P.Destroy.call(this)}}),rtl.createClass(this,"TJSForInStatement",E,function(){this.$init=function(){E.$init.call(this),this.FLhs=null,this.FList=null},this.$final=function(){this.FLhs=void 0,this.FList=void 0,E.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FList},set:function(e){this.p.FList=e}}),j({p:this,get:function(){return this.p.FLhs},set:function(e){this.p.FLhs=e}}),E.Destroy.call(this)}}),rtl.createClass(this,"TJSAliasElement",W,function(){R=this,this.$init=function(){W.$init.call(this),this.FName="",this.FAlias=""}}),rtl.createClass(this,"TJSAliasElements",Y,function(){v=this}),rtl.createClass(this,"TJSNamedImportElement",R,function(){A=this}),rtl.createClass(this,"TJSNamedImportElements",v,function(){N=this,this.GetE=function(e){return this.GetItem(e)}}),rtl.createClass(this,"TJSImportStatement",s,function(){this.$init=function(){s.$init.call(this),this.FDefaultBinding="",this.FExpression=null,this.FModuleName="",this.FNamedImports=null,this.FNameSpaceImport=""},this.$final=function(){this.FExpression=void 0,this.FNamedImports=void 0,s.$final.call(this)},this.GetHaveNamedImports=function(){return null!=this.FNamedImports},this.GetNamedImports=function(){return null===this.FNamedImports&&(this.FNamedImports=N.$create("Create$1",[A])),this.FNamedImports},this.Destroy=function(){j({p:this,get:function(){return this.p.FNamedImports},set:function(e){this.p.FNamedImports=e}}),j({p:this,get:function(){return this.p.FExpression},set:function(e){this.p.FExpression=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSExportNameElement",R,function(){x=this}),rtl.createClass(this,"TJSExportNameElements",v,function(){b=this,this.GetE=function(e){return this.GetItem(e)}}),rtl.createClass(this,"TJSExportStatement",s,function(){this.$init=function(){s.$init.call(this),this.FDeclaration=null,this.FIsDefault=!1,this.FModuleName="",this.FNamedExports=null,this.FNameSpaceExport=""},this.$final=function(){this.FDeclaration=void 0,this.FNamedExports=void 0,s.$final.call(this)},this.GetHaveNamedExports=function(){return null!=this.FNamedExports},this.GetNamedExports=function(){return null===this.FNamedExports&&(this.FNamedExports=b.$create("Create$1",[x])),this.FNamedExports},this.Destroy=function(){j({p:this,get:function(){return this.p.FNamedExports},set:function(e){this.p.FNamedExports=e}}),j({p:this,get:function(){return this.p.FDeclaration},set:function(e){this.p.FDeclaration=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSContinueStatement",g,function(){0}),rtl.createClass(this,"TJSBreakStatement",g,function(){0}),rtl.createClass(this,"TJSReturnStatement",s,function(){this.$init=function(){s.$init.call(this),this.FExpr=null},this.$final=function(){this.FExpr=void 0,s.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FExpr},set:function(e){this.p.FExpr=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSCaseElement",W,function(){O=this,this.$init=function(){W.$init.call(this),this.FBody=null,this.FExpr=null},this.$final=function(){this.FBody=void 0,this.FExpr=void 0,W.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FExpr},set:function(e){this.p.FExpr=e}}),j({p:this,get:function(){return this.p.FBody},set:function(e){this.p.FBody=e}}),W.Destroy.call(this)}}),rtl.createClass(this,"TJSCaseElements",Y,function(){k=this,this.GetC=function(e){return this.GetItem(e)},this.AddCase=function(){return this.Add()}}),rtl.createClass(this,"TJSSwitchStatement",g,function(){this.$init=function(){g.$init.call(this),this.FCases=null,this.FCond=null,this.FDefault=null},this.$final=function(){this.FCases=void 0,this.FCond=void 0,this.FDefault=void 0,g.$final.call(this)},this.Create$1=function(e,s,i){return t.Create$1.call(this,e,s,i),this.FCases=k.$create("Create$1",[O]),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FCases},set:function(e){this.p.FCases=e}}),j({p:this,get:function(){return this.p.FCond},set:function(e){this.p.FCond=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSLabeledStatement",u,function(){this.$init=function(){u.$init.call(this),this.FLabel=null},this.$final=function(){this.FLabel=void 0,u.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FLabel},set:function(e){this.p.FLabel=e}}),u.Destroy.call(this)}}),rtl.createClass(this,"TJSTryStatement",s,function(){$=this,this.$init=function(){s.$init.call(this),this.FBCatch=null,this.FBFinally=null,this.FBlock=null,this.FIdent=""},this.$final=function(){this.FBCatch=void 0,this.FBFinally=void 0,this.FBlock=void 0,s.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FBlock},set:function(e){this.p.FBlock=e}}),j({p:this,get:function(){return this.p.FBCatch},set:function(e){this.p.FBCatch=e}}),j({p:this,get:function(){return this.p.FBFinally},set:function(e){this.p.FBFinally=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSTryCatchFinallyStatement",$,function(){0}),rtl.createClass(this,"TJSTryCatchStatement",$,function(){0}),rtl.createClass(this,"TJSTryFinallyStatement",$,function(){0}),rtl.createClass(this,"TJSFunctionStatement",s,function(){this.$init=function(){s.$init.call(this),this.FFuncDef=null},this.$final=function(){this.FFuncDef=void 0,s.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FFuncDef},set:function(e){this.p.FFuncDef=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSFunctionBody",u,function(){0}),rtl.createClass(this,"TJSElementNode",W,function(){D=this,this.$init=function(){W.$init.call(this),this.FIsAmbient=!1,this.FIsExport=!1,this.FNode=null},this.$final=function(){this.FNode=void 0,W.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FNode},set:function(e){this.p.FNode=e}}),W.Destroy.call(this)},this.Assign=function(e){D.isPrototypeOf(e)?(this.FIsAmbient=e.FIsAmbient,this.FIsExport=e.FIsExport,this.FNode=e.FNode):_.Assign.call(this,e)}}),rtl.createClass(this,"TJSElementNodes",Y,function(){L=this,this.$init=function(){Y.$init.call(this),this.FClearNodes=!1,this.FNodeType=""},this.GetN=function(e){return this.GetItem(e)},this.Destroy=function(){this.FClearNodes&&this.ClearNodes(),Y.Destroy.call(this)},this.ClearNodes=function(){for(var e=0,t=0,s=this.GetCount()-1;t<=s;t++)e=t,this.GetN(e).FNode=null},this.AddNode=function(e,t){var s=null;return(s=this.Add()).FIsAmbient=e,s.FIsExport=t,s},this.InsertNode=function(e){return this.Insert(e)}}),rtl.createClass(this,"TJSTypedParam",D,function(){B=this,this.$init=function(){D.$init.call(this),this.FDestructured=null,this.FIsInferred=!1,this.FIsOptional=!1,this.FIsSpread=!1,this.FName=""},this.$final=function(){this.FDestructured=void 0,D.$final.call(this)},this.Assign=function(e){B.isPrototypeOf(e)&&(this.FDestructured=e.FDestructured,this.FIsInferred=e.FIsInferred,this.FIsOptional=e.FIsOptional,this.FIsSpread=e.FIsSpread,this.FName=e.FName),D.Assign.call(this,e)},this.Destroy=function(){j({p:this,get:function(){return this.p.FDestructured},set:function(e){this.p.FDestructured=e}}),D.Destroy.call(this)}}),rtl.createClass(this,"TJSTypedParams",L,function(){M=this,this.GetParams=function(e){return this.GetItem(e)},this.Create$2=function(){return Y.Create$1.call(this,B),this},this.AddParam=function(e){var t=null;return(t=rtl.as(this.Add(),B)).FName=e,t}}),rtl.createClass(this,"TJSSourceElements",t,function(){this.$init=function(){t.$init.call(this),this.FClasses=null,this.FEnums=null,this.FFunctions=null,this.FInterfaces=null,this.FModules=null,this.FNamespaces=null,this.FStatements=null,this.FTypes=null,this.FVars=null},this.$final=function(){this.FClasses=void 0,this.FEnums=void 0,this.FFunctions=void 0,this.FInterfaces=void 0,this.FModules=void 0,this.FNamespaces=void 0,this.FStatements=void 0,this.FTypes=void 0,this.FVars=void 0,t.$final.call(this)},this.Create$1=function(e,s,i){function r(e,t){var s=null;return(s=L.$create("Create$1",[D])).FNodeType=e,s.FClearNodes=t,s}return t.Create$1.call(this,e,s,i),this.FClasses=r("Classes",!0),this.FEnums=r("Enums",!0),this.FFunctions=r("Functions",!1),this.FInterfaces=r("Interfaces",!0),this.FModules=r("Modules",!0),this.FNamespaces=r("Namespaces",!0),this.FStatements=r("Statements",!1),this.FTypes=r("Types",!0),this.FVars=r("Vars",!0),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FVars},set:function(e){this.p.FVars=e}}),j({p:this,get:function(){return this.p.FTypes},set:function(e){this.p.FTypes=e}}),j({p:this,get:function(){return this.p.FNamespaces},set:function(e){this.p.FNamespaces=e}}),j({p:this,get:function(){return this.p.FModules},set:function(e){this.p.FModules=e}}),j({p:this,get:function(){return this.p.FInterfaces},set:function(e){this.p.FInterfaces=e}}),j({p:this,get:function(){return this.p.FFunctions},set:function(e){this.p.FFunctions=e}}),j({p:this,get:function(){return this.p.FEnums},set:function(e){this.p.FEnums=e}}),j({p:this,get:function(){return this.p.FClasses},set:function(e){this.p.FClasses=e}}),j({p:this,get:function(){return this.p.FStatements},set:function(e){this.p.FStatements=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSTypeDef",t,function(){G=this,this.$init=function(){t.$init.call(this),this.FTypeGuard=null,this.FExtendsCond=null,this.FExtendsTrue=null,this.FExtendsFalse=null},this.$final=function(){this.FTypeGuard=void 0,this.FExtendsCond=void 0,this.FExtendsTrue=void 0,this.FExtendsFalse=void 0,t.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.FTypeGuard},set:function(e){this.p.FTypeGuard=e}}),j({p:this,get:function(){return this.p.FExtendsCond},set:function(e){this.p.FExtendsCond=e}}),j({p:this,get:function(){return this.p.FExtendsTrue},set:function(e){this.p.FExtendsTrue=e}}),j({p:this,get:function(){return this.p.FExtendsFalse},set:function(e){this.p.FExtendsFalse=e}}),t.Destroy.call(this)}}),rtl.createClass(this,"TJSStructuredTypeDef",G,function(){w=this,this.$init=function(){G.$init.call(this),this.FTypeParams=null,this.FValues=null},this.$final=function(){this.FTypeParams=void 0,this.FValues=void 0,G.$final.call(this)},this.Create$1=function(e,s,i){return t.Create$1.call(this,e,s,i),this.FValues=L.$create("Create$1",[D]),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FTypeParams},set:function(e){this.p.FTypeParams=e}}),j({p:this,get:function(){return this.p.FValues},set:function(e){this.p.FValues=e}}),G.Destroy.call(this)}}),rtl.createClass(this,"TJSObjectTypeDef",w,function(){0})}),rtl.module("jswriter",["System","JS","SysUtils","Classes","jsbase","jstree"],function(){"use strict";var e=this,t=e.$impl,s=null,i=null,r=pas.System,n=r.TObject,l=r.StringOfChar,a=r.Copy,o=r.Pos,h=r.Frac,u=r.Delete,c=pas.SysUtils,p=c.LeftStr,f=r.val$8,d=r.Insert,F=r.val$6,m=c.IntToStr,C=pas.jstree,S=C.TJSArguments,T=pas.jsbase.IsValidJSIdentifier,y=C.TJSNewMemberExpression,g=C.TJSPrimaryExpression,E=C.TJSDotMemberExpression,P=C.TJSBracketMemberExpression,I=C.TJSCallExpression,R=C.TJSLiteral,v=C.TJSStatementList,A=C.TJSEmptyBlockStatement,N=C.TJSDoWhileStatement,x=C.TJSTryCatchFinallyStatement,b=C.TJSTryCatchStatement,O=C.TJSTryFinallyStatement,k=C.TJSForStatement,$=C.TJSSwitchStatement,D=C.TJSForInStatement,L=C.TJSWhileStatement,B=C.TJSContinueStatement,M=C.TJSBreakStatement,G=r.VarRecs,w=C.TJSSourceElements,V=C.TJSPrimaryExpressionThis,U=C.TJSPrimaryExpressionIdent,J=C.TJSLogicalOrExpression,j=C.TJSLogicalAndExpression,H=C.TJSBinaryExpression,W=C.TJSCommaExpression,Y=C.TJSBitwiseAndExpression,z=C.TJSBitwiseOrExpression,_=C.TJSBitwiseXOrExpression,K=C.TJSAdditiveExpressionPlus,X=C.TJSAdditiveExpressionMinus,q=C.TJSMultiplicativeExpressionMul,Q=C.TJSEmptyStatement,Z=C.TJSDebuggerStatement,ee=C.TJSArrayLiteral,te=C.TJSObjectLiteral,se=C.TJSMemberExpression,ie=C.TJSRegularExpressionLiteral,re=C.TJSLabeledStatement,ne=C.TJSFunctionBody,le=C.TJSVariableStatement,ae=C.TJSUnary,oe=C.TJSVariableDeclarationList,he=C.TJSWithStatement,ue=C.TJSBinary,ce=C.TJSConditionalExpression,pe=C.TJSAssignStatement,fe=C.TJSVarDeclaration,de=C.TJSIfStatement,Fe=C.TJSImportStatement,me=C.TJSExportStatement,Ce=C.TJSTargetStatement,Se=C.TJSReturnStatement,Te=C.TJSTryStatement,ye=C.TJSFunctionStatement,ge=c.Exception;rtl.createClass(this,"TTextWriter",n,function(){s=this,this.$init=function(){n.$init.call(this),this.FCurElement=null,this.FCurLine=0,this.FCurColumn=0,this.FLineBreak="",this.FOnWriting=null},this.$final=function(){this.FCurElement=void 0,this.FOnWriting=void 0,n.$final.call(this)},this.SetCurElement=function(e){this.FCurElement=e},this.Writing=function(){null!=this.FOnWriting&&this.FOnWriting(this)},this.Create$1=function(){return this.FCurLine=1,this.FCurColumn=1,this.FLineBreak=r.sLineBreak,this},this.Write=function(e){var t,s=0,i="\0",r=0;if(""===e)return s;for(this.Writing(),s=this.DoWrite(e),t=e.length,r=1;r<=t;){i=e.charAt(r-1);"\n"===i||"\r"===i?(this.FCurColumn=1,this.FCurLine+=1,(r+=1)<=t&&e.charCodeAt(r-1)in rtl.createSet(10,13)&&i!==e.charAt(r-1)&&(r+=1)):(this.FCurColumn+=1,r+=1)}return s},this.WriteLn=function(e){var t=0;return t=this.Write(e),t+=this.Write(this.FLineBreak)}}),rtl.createClass(this,"TBufferWriter",s,function(){this.$init=function(){s.$init.call(this),this.FBufPos=0,this.FCapacity=0,this.FBuffer=[]},this.$final=function(){this.FBuffer=void 0,s.$final.call(this)},this.GetAsString=function(){return this.FBufPos<rtl.length(this.FBuffer)&&(this.FBuffer.length=this.FBufPos),this.FBuffer.join("")},this.GetBufferLength=function(){return this.FBufPos},this.SetCapacity=function(e){this.FCapacity!==e&&(this.FCapacity=e)},this.DoWrite=function(e){var t;return 0===(t=2*e.length)||(this.FBuffer.push(e),this.FBufPos+=1,this.FCapacity=this.FBufPos),t},this.Create$2=function(e){return s.Create$1.call(this),this.SetCapacity(e),this}}),this.TJSEscapeQuote={0:"jseqSingle",jseqSingle:0,1:"jseqDouble",jseqDouble:1,2:"jseqBoth",jseqBoth:2},this.TWriteOption={0:"woCompact",woCompact:0,1:"woTabIndent",woTabIndent:1,2:"woEmptyStatementAsComment",woEmptyStatementAsComment:2,3:"woQuoteElementNames",woQuoteElementNames:3,4:"woCompactArrayLiterals",woCompactArrayLiterals:4,5:"woCompactObjectLiterals",woCompactObjectLiterals:5,6:"woCompactArguments",woCompactArguments:6},rtl.createClass(this,"TJSWriter",n,function(){this.$init=function(){n.$init.call(this),this.FCurIndent=0,this.FFreeWriter=!1,this.FIndentChar="\0",this.FIndentSize=0,this.FLastChar="\0",this.FLinePos=0,this.FOptions={},this.FSkipCurlyBrackets=!1,this.FSkipRoundBrackets=!1,this.FWriter=null},this.$final=function(){this.FOptions=void 0,this.FWriter=void 0,n.$final.call(this)},this.SetOptions=function(e){rtl.eqSet(this.FOptions,e)||(this.FOptions=rtl.refSet(e),1 in this.FOptions?this.FIndentChar="\t":this.FIndentChar=" ")},this.Error=function(e){throw i.$create("Create$1",[e])},this.Error$1=function(e,t){throw i.$create("CreateFmt",[e,t])},this.WriteIndent=function(){0===this.FLinePos&&this.FCurIndent>0&&(this.FLinePos=this.FWriter.Write(l(this.FIndentChar,this.FCurIndent)),this.FLastChar=this.FIndentChar)},this.Write=function(e){this.WriteIndent(),""!==e&&(this.FLinePos=this.FLinePos+this.FWriter.Write(e),this.FLastChar=e.charAt(e.length-1))},this.WriteLn=function(e){this.WriteIndent(),this.FWriter.WriteLn(e),this.FLastChar="\n",this.FLinePos=0};this.WriteValue=function(e){function s(e,t){var s,i=0,r=0;for(r=t.get(),s=e.length,i=0;r<=s;){var n=e.charAt(r-1);if("\t"===n)i+=4-i%4;else{if(" "!==n)break;i+=1}r+=1}return t.set(r),i}function i(e,t){var s;for(s=e.length;t<=s&&!(e.charCodeAt(t-1)in rtl.createSet(10,13));)t+=1;return t}function n(e,t){var s;for(s=e.length;t<=s;){var i=e.charAt(t-1);if("\n"===i||"\r"===i){t<s&&e.charCodeAt(t+1-1)in rtl.createSet(10,13)&&e.charAt(t-1)!==e.charAt(t+1-1)?t+=2:t+=1;break}t+=1}return t}var c="",C="",S="",T=0,y=0,g=0,E=0,P=0,I=0,R=0,v=0,A=0,N=0;if(""===e.FCustomValue){var x=e.FValueType;if(0===x)c="undefined";else if(1===x)c="null";else if(2===x)c=e.GetAsBoolean()?"true":"false";else{if(4===x)return S=e.GetAsString(),S=o('"',S)>0?"'"+this.EscapeString(S,0)+"'":'"'+this.EscapeString(S,1)+'"',void this.Write(S);if(3===x)if(N=e.GetAsNumber(),0===h(N)&&N>=-9007199254740991&&N<=9007199254740991)c=""+Math.round(N);else{if(" "===(c=rtl.floatToStr(N)).charAt(0)&&u({get:function(){return c},set:function(e){c=e}},1,1),(v=o("E",c))>2){P=v-2;var b=c.charAt(P-1);if("0"===b){for(;P>1&&"0"===c.charAt(P-1);)P-=1;"."===c.charAt(P-1)&&(P+=1),C=p(c,P)+a(c,v,c.length),f(C,{get:function(){return A},set:function(e){A=e}},{get:function(){return R},set:function(e){R=e}}),0===R&&A===N&&(c=C)}else if("9"===b){for(;P>1&&"9"===c.charAt(P-1);)P-=1;for(C=p(c,P)+a(c,v,c.length),"."===c.charAt(P-1)&&d("0",{get:function(){return C},set:function(e){C=e}},P+1);;){var O=C.charAt(P-1);if(O>="0"&&O<="8"){C=rtl.setCharAt(C,P-1,String.fromCharCode(C.charCodeAt(P-1)+1));break}if("9"===O&&(C=rtl.setCharAt(C,P-1,"0")),0===(P-=1)||!(C.charCodeAt(P-1)in rtl.createSet(null,48,57,46))){F(a(c,v+1,c.length),{get:function(){return I},set:function(e){I=e}},{get:function(){return R},set:function(e){R=e}}),0===R&&(C="1E"+m(I+1),"-"===c.charAt(0)&&(C="-"+C));break}}f(C,{get:function(){return A},set:function(e){A=e}},{get:function(){return R},set:function(e){R=e}}),0===R&&A===N&&(c=C)}else"0"===c.charAt(v-1-1)&&(C=t.LeftStr(c,v-2)+a(c,v,c.length),f(C,{get:function(){return A},set:function(e){A=e}},{get:function(){return R},set:function(e){R=e}}),0===R&&A===N&&(c=C))}if((v=o("E",c))>0&&(F(a(c,v+1,c.length),{get:function(){return I},set:function(e){I=e}},{get:function(){return R},set:function(e){R=e}}),0===R))if(0===I)u({get:function(){return c},set:function(e){c=e}},v,c.length);else if(I>=-6&&I<=6){if(u({get:function(){return c},set:function(e){c=e}},v,c.length),"0"===c.charAt(c.length-1)&&u({get:function(){return c},set:function(e){c=e}},c.length,1),"."===c.charAt(c.length-1)&&u({get:function(){return c},set:function(e){c=e}},c.length,1),C=c+"E"+m(I),(P=o(".",c))>0?u({get:function(){return c},set:function(e){c=e}},P,1):P=c.length+1,I<0){for(;I<0;)P>1&&c.charCodeAt(P-1-1)in rtl.createSet(null,48,57)?P-=1:d("0",{get:function(){return c},set:function(e){c=e}},P),I+=1;d(".",{get:function(){return c},set:function(e){c=e}},P),1!==P&&c.charCodeAt(P-1-1)in rtl.createSet(null,48,57)||d("0",{get:function(){return c},set:function(e){c=e}},P),"0"===c.charAt(c.length-1)&&u({get:function(){return c},set:function(e){c=e}},c.length,1)}else{for(;I>0;)P<=c.length&&c.charCodeAt(P-1)in rtl.createSet(null,48,57)?P+=1:d("0",{get:function(){return c},set:function(e){c=e}},P),I-=1;P<=c.length&&d(".",{get:function(){return c},set:function(e){c=e}},P)}c.length>C.length&&(c=C)}else c=t.LeftStr(c,v)+m(I),v>=4&&"0"===c.charAt(v-1-1)&&"."===c.charAt(v-2-1)&&u({get:function(){return c},set:function(e){c=e}},v-2,2)}}if(""!==c){var k=c.charAt(0);"+"===k?"+"===this.FLastChar&&this.Write(" "):"-"===k&&"-"===this.FLastChar&&this.Write(" "),this.Write(c)}}else{if(""===(S=e.FCustomValue))return;if((T=n(S,1))>S.length)return void this.Write(S);g=-1;do{E=s(S,{get:function(){return T},set:function(e){T=e}}),(g<0||g>E)&&(g=E),T=n(S,T)}while(!(T>S.length));for(T=1,s(S,{get:function(){return T},set:function(e){T=e}});;){if(T=i(S,y=T),this.Write(a(S,y,T-y)),T>S.length)break;this.Write(r.sLineBreak),T=n(S,T),E=s(S,{get:function(){return T},set:function(e){T=e}}),this.Write(l(this.FIndentChar,this.FCurIndent+E-g))}}},this.WriteRegularExpressionLiteral=function(e){this.Write("/"),this.Write(this.EscapeString(e.FPattern.GetAsString(),2)),this.Write("/"),null!=e.FPatternFlags&&this.Write(this.EscapeString(e.FPatternFlags.GetAsString(),2))};var s=["var","let","const"];this.WriteVariableStatement=function(e){this.Write(s[e.FVarType]+" "),this.FSkipRoundBrackets=!0,this.WriteJS(e.FA)},this.WriteEmptyBlockStatement=function(e){0 in this.FOptions?this.Write("{}"):(this.WriteLn("{"),this.Write("}"))},this.WriteEmptyStatement=function(e){2 in this.FOptions&&this.Write("/* Empty statement */")},this.WriteDebuggerStatement=function(e){this.Write("debugger")},this.WriteLiteral=function(e){this.WriteValue(e.FValue)},this.WriteArrayLiteral=function(e){var t,s,i,r,n=0,l="";if(l=["[]","()"][+(s=S.isPrototypeOf(e))],-1!==(t=e.FElements.GetCount()-1)){(r=!(i=0 in this.FOptions||!s&&4 in this.FOptions||s&&6 in this.FOptions)&&t>4)?(this.WriteLn(l.charAt(0)),this.Indent()):this.Write(l.charAt(0));for(var a=0,o=t;a<=o;a++)n=a,this.FSkipRoundBrackets=!0,this.WriteJS(e.FElements.GetE(n).FExpr),n<t&&(i?this.Write(","):r?this.WriteLn(","):this.Write(", "));r&&(this.WriteLn(""),this.Undent()),this.FWriter.SetCurElement(e),this.Write(l.charAt(1))}else this.Write(l)},this.WriteObjectLiteral=function(t){var s,i,r,n=0,l="",a=null;if(s=t.FElements.GetCount()-1,i=3 in this.FOptions,-1!==s){(r=0 in this.FOptions||5 in this.FOptions)?this.Write("{"):(this.WriteLn("{"),this.Indent());for(var o=0,h=s;o<=h;o++)n=o,a=t.FElements.GetE(n),this.FWriter.SetCurElement(a.FExpr),l=a.FName,!i&&T(l,!1)||l.length>1&&('"'===l.charAt(0)&&'"'===l.charAt(l.length-1)||"'"===l.charAt(0)&&"'"===l.charAt(l.length-1))||(l=e.QuoteJSString(l,"\0")),this.Write(l+": "),this.Indent(),this.FSkipRoundBrackets=!0,this.WriteJS(a.FExpr),n<s&&(r?this.Write(", "):this.WriteLn(",")),this.Undent();this.FSkipRoundBrackets=!1,r||(this.WriteLn(""),this.Undent()),this.FWriter.SetCurElement(t),this.Write("}")}else this.Write("{}")},this.WriteMemberExpression=function(e){var t,s=null;y.isPrototypeOf(e)&&this.Write("new "),t=e.FMExpr,g.isPrototypeOf(t)||E.isPrototypeOf(t)||P.isPrototypeOf(t)||I.isPrototypeOf(t)&&!y.isPrototypeOf(e)||R.isPrototypeOf(t)?(this.WriteJS(t),this.FWriter.SetCurElement(e)):(this.Write("("),this.WriteJS(t),this.FWriter.SetCurElement(e),this.Write(")")),E.isPrototypeOf(e)?(this.Write("."),this.Write(e.FName)):P.isPrototypeOf(e)?(this.Write("["),this.FSkipRoundBrackets=!0,this.WriteJS(e.FName),this.FWriter.SetCurElement(e),this.FSkipRoundBrackets=!1,this.Write("]")):y.isPrototypeOf(e)&&(null!=(s=e.FArgs)?(this.FWriter.SetCurElement(s),this.WriteArrayLiteral(s)):this.Write("()"))},this.WriteCallExpression=function(e){this.WriteJS(e.FExpr),null!=e.FArgs?(this.FWriter.SetCurElement(e.FArgs),this.WriteArrayLiteral(e.FArgs)):(this.FWriter.SetCurElement(e),this.Write("()"))},this.WriteSwitchStatement=function(e){var t,s=0,i=null;t=0 in this.FOptions,this.Write("switch ("),null!=e.FCond&&(this.FSkipRoundBrackets=!0,this.WriteJS(e.FCond),this.FWriter.SetCurElement(e),this.FSkipRoundBrackets=!1),t?this.Write(") {"):this.WriteLn(") {");for(var r=0,n=e.FCases.GetCount()-1;r<=n;r++)s=r,(i=e.FCases.GetC(s))===e.FDefault?this.Write("default"):(this.FWriter.SetCurElement(i.FExpr),this.Write("case "),this.FSkipRoundBrackets=!0,this.WriteJS(i.FExpr),this.FSkipRoundBrackets=!1),null!=i.FBody?(this.FSkipCurlyBrackets=!0,t?this.Write(": "):this.WriteLn(":"),this.Indent(),this.WriteJS(i.FBody),this.Undent(),v.isPrototypeOf(i.FBody)||A.isPrototypeOf(i.FBody)?t?s<e.FCases.GetCount()-1&&this.Write(" "):this.WriteLn(""):t?this.Write("; "):this.WriteLn(";")):t?this.Write(": "):this.WriteLn(":");this.FWriter.SetCurElement(e),this.Write("}")},this.WriteUnary=function(e){var t="";if(this.FSkipRoundBrackets=!1,""!==(t=e.$class.PrefixOperator())){var s=t.charAt(0);"+"===s?"+"===this.FLastChar&&this.Write(" "):"-"===s&&"-"===this.FLastChar&&this.Write(" "),this.Write(t)}if(this.WriteJS(e.FA),""!==(t=e.$class.PostFixOperator())){this.FWriter.SetCurElement(e);var i=t.charAt(0);"+"===i?"+"===this.FLastChar&&this.Write(" "):"-"===i&&"-"===this.FLastChar&&this.Write(" "),this.Write(t)}},this.WriteAssignStatement=function(e){var t="";this.WriteJS(e.FLHS),this.FWriter.SetCurElement(e),t=e.$class.OperatorString(),0 in this.FOptions||(t=" "+t+" "),this.Write(t),this.FSkipRoundBrackets=!0,this.WriteJS(e.FExpr),this.FSkipRoundBrackets=!1},this.WriteForInStatement=function(e){this.Write("for ("),null!=e.FLhs&&(this.WriteJS(e.FLhs),this.FWriter.SetCurElement(e)),this.Write(" in "),null!=e.FList&&(this.WriteJS(e.FList),this.FWriter.SetCurElement(e)),this.Write(") "),null!=e.FBody&&this.WriteJS(e.FBody)},this.WriteWhileStatement=function(e){N.isPrototypeOf(e)?(this.Write("do "),null!=e.FBody&&(this.FSkipCurlyBrackets=!1,this.WriteJS(e.FBody),this.FWriter.SetCurElement(e)),this.Write(" while ("),null!=e.FCond&&(this.FSkipRoundBrackets=!0,this.WriteJS(e.FCond),this.FWriter.SetCurElement(e),this.FSkipRoundBrackets=!1),this.Write(")")):(this.Write("while ("),null!=e.FCond&&(this.FSkipRoundBrackets=!0,this.WriteJS(e.FCond),this.FWriter.SetCurElement(e),this.FSkipRoundBrackets=!1),this.Write(") "),null!=e.FBody&&this.WriteJS(e.FBody))},this.WriteImportStatement=function(e){var t=0,s=null,i=!1;if(this.Write("import "),i=!1,""!==e.FDefaultBinding&&(this.Write(e.FDefaultBinding+" "),(""!==e.FNameSpaceImport||e.GetHaveNamedImports())&&this.Write(", "),i=!0),""!==e.FNameSpaceImport&&(this.Write("* as "+e.FNameSpaceImport+" "),i=!0),e.GetHaveNamedImports()){i=!0,this.Write("{ ");for(var r=0,n=e.GetNamedImports().GetCount()-1;r<=n;r++)t=r,s=e.GetNamedImports().GetE(t),t>0&&this.Write(", "),this.Write(s.FName+" "),""!==s.FAlias&&this.Write("as "+s.FAlias+" ");this.Write("} ")}i&&this.Write("from "),this.Write('"'+e.FModuleName+'"')},this.WriteExportStatement=function(e){var t=0,s=null;if(this.Write("export "),e.FIsDefault&&this.Write("default "),null!=e.FDeclaration)this.WriteJS(e.FDeclaration);else if(""!==e.FNameSpaceExport)"*"!==e.FNameSpaceExport?this.Write("* as "+e.FNameSpaceExport):this.Write("*"),""!==e.FModuleName&&this.Write(' from "'+e.FModuleName+'"');else if(e.GetHaveNamedExports()){this.Write("{ ");for(var i=0,r=e.GetNamedExports().GetCount()-1;i<=r;i++)t=i,s=e.GetNamedExports().GetE(t),t>0&&this.Write(", "),this.Write(s.FName),""!==s.FAlias&&this.Write(" as "+s.FAlias);this.Write(" }"),""!==e.FModuleName&&this.Write(' from "'+e.FModuleName+'"')}},this.WriteForStatement=function(e){this.Write("for ("),null!=e.FInit&&this.WriteJS(e.FInit),this.Write("; "),null!=e.FCond&&(this.FSkipRoundBrackets=!0,this.WriteJS(e.FCond),this.FSkipRoundBrackets=!1),this.Write("; "),null!=e.FIncr&&this.WriteJS(e.FIncr),this.FWriter.SetCurElement(e),this.Write(") "),null!=e.FBody&&this.WriteJS(e.FBody)},this.WriteIfStatement=function(e){var t,s,i,r=!1;s=0 in this.FOptions,this.Write("if ("),this.FSkipRoundBrackets=!0,this.WriteJS(e.FCond),this.FWriter.SetCurElement(e),this.FSkipRoundBrackets=!1,this.Write(")"),s||this.Write(" "),t=!this.IsEmptyStatement(e.FBTrue),i=!this.IsEmptyStatement(e.FBFalse),t&&((r=i&&!v.isPrototypeOf(e.FBTrue)&&!A.isPrototypeOf(e.FBTrue))&&(s?this.Write("{"):(this.WriteLn("{"),this.Indent())),this.WriteJS(e.FBTrue),r&&(s?this.Write("}"):(this.Undent(),this.WriteLn("}")))),i?(this.FWriter.SetCurElement(e.FBFalse),t?this.Write(" "):s?this.Write("{}"):this.WriteLn("{}"),this.Write("else "),this.WriteJS(e.FBFalse)):this.FWriter.SetCurElement(e)},this.WriteSourceElements=function(e){var t=this,s=!1;function i(e){var i=0,r=null;if(null!==e)for(var n=0,l=e.GetCount()-1;n<=l;n++)i=n,r=e.GetN(i).FNode,t.WriteJS(r),s?i<e.GetCount()-1?t.Write("; "):t.Write(";"):t.WriteLn(";")}s=0 in this.FOptions,i(e.FVars),i(e.FFunctions),i(e.FStatements)},this.WriteStatementList=function(e){var t=this,s=!1,i=null,r=[],n=0;function l(e){t.IsEmptyStatement(e)||(null!==i&&(";"!==t.FLastChar&&t.Write(";"),s?t.Write(" "):t.WriteLn("")),t.WriteJS(e),i=e)}function a(e){null!==e&&(n===rtl.length(r)&&(r=rtl.arraySetLength(r,null,n+8)),r[n]=e,n+=1)}function o(){return 0===n?null:r[n-=1]}var h,u=null,c=null;s=0 in this.FOptions,h=!this.FSkipCurlyBrackets,this.FSkipCurlyBrackets=!0,h&&(this.Write("{"),this.Indent(),s||this.WriteLn("")),i=null,n=0,u=e;for(;null!==u;)v.isPrototypeOf(u)?(c=u,v.isPrototypeOf(c.FA)?(a(c.FB),u=c.FA):(l(c.FA),v.isPrototypeOf(c.FB)?u=c.FB:(l(c.FB),u=null))):(l(u),u=null),null===u&&(u=o());null===i||s||(";"===this.FLastChar?this.WriteLn(""):this.WriteLn(";")),h&&(this.Undent(),this.FWriter.SetCurElement(e),this.Write("}"))},this.WriteTryStatement=function(e){var t;t=0 in this.FOptions,this.Write("try {"),this.IsEmptyStatement(e.FBlock)||(t||this.WriteLn(""),this.FSkipCurlyBrackets=!0,this.Indent(),this.WriteJS(e.FBlock),t||v.isPrototypeOf(e.FBlock)||this.WriteLn(""),this.Undent()),this.FWriter.SetCurElement(e),this.Write("}"),(x.isPrototypeOf(e)||b.isPrototypeOf(e))&&(this.Write(" catch"),""!==e.FIdent&&this.Write(" ("+e.FIdent+")"),t?this.Write(" {"):this.WriteLn(" {"),this.IsEmptyStatement(e.FBCatch)||(this.FSkipCurlyBrackets=!0,this.Indent(),this.WriteJS(e.FBCatch),this.Undent(),t||v.isPrototypeOf(e.FBCatch)||this.WriteLn("")),this.FWriter.SetCurElement(e),this.Write("}")),(x.isPrototypeOf(e)||O.isPrototypeOf(e))&&(t?this.Write(" finally {"):this.WriteLn(" finally {"),this.IsEmptyStatement(e.FBFinally)||(this.Indent(),this.FSkipCurlyBrackets=!0,this.WriteJS(e.FBFinally),this.Undent(),t||v.isPrototypeOf(e.FBFinally)||this.WriteLn("")),this.FWriter.SetCurElement(e),this.Write("}"))},this.WriteVarDeclaration=function(e){this.Write(e.FName),null!=e.FInit&&(this.Write(" = "),this.FSkipRoundBrackets=!0,this.WriteJS(e.FInit),this.FSkipRoundBrackets=!1)},this.WriteWithStatement=function(e){this.Write("with ("),this.FSkipRoundBrackets=!0,this.WriteJS(e.FA),this.FSkipRoundBrackets=!1,this.FWriter.SetCurElement(e),0 in this.FOptions?this.Write(") "):this.WriteLn(")"),this.Indent(),this.WriteJS(e.FB),this.Undent()},this.WriteVarDeclarationList=function(e){this.WriteJS(e.FA),null!=e.FB&&(this.Write(", "),this.WriteJS(e.FB))},this.WriteConditionalExpression=function(e){this.Write("("),this.FSkipRoundBrackets=!0,this.WriteJS(e.FA),this.Write(" ? "),null!==e.FB&&this.WriteJS(e.FB),this.Write(" : "),null!==e.FC&&this.WriteJS(e.FC),this.Write(")")},this.WriteFunctionBody=function(e){this.IsEmptyStatement(e.FA)||this.WriteJS(e.FA)},this.WriteFunctionDeclarationStatement=function(e){null!=e.FFuncDef&&this.WriteFuncDef(e.FFuncDef)},this.WriteLabeledStatement=function(e){null!=e.FLabel&&(this.Write(e.FLabel.FName),0 in this.FOptions?this.Write(": "):this.WriteLn(":")),this.WriteJS(e.FA)},this.WriteReturnStatement=function(e){null===e.FExpr?this.Write("return"):(this.Write("return "),this.FSkipRoundBrackets=!0,this.WriteJS(e.FExpr),this.FSkipRoundBrackets=!1)},this.WriteTargetStatement=function(e){var t;t=e.FTargetName,k.isPrototypeOf(e)?this.WriteForStatement(e):$.isPrototypeOf(e)?this.WriteSwitchStatement(e):D.isPrototypeOf(e)?this.WriteForInStatement(e):L.isPrototypeOf(e)?this.WriteWhileStatement(e):B.isPrototypeOf(e)?""!==t?this.Write("continue "+t):this.Write("continue"):M.isPrototypeOf(e)?""!==t?this.Write("break "+t):this.Write("break"):this.Error$1('Unknown target statement class: "%s"',G(18,e.$classname))},this.WriteFuncDef=function(e){var t,s,i=0,r=null,n=null,l=null;if(s=this.FWriter.FCurElement,t=0 in this.FOptions,e.FIsAsync&&this.Write("async "),this.Write("function "),""!==e.FName&&this.Write(e.FName),this.Write("("),(l=e.FTypedParams).GetCount()>0)for(var a=0,o=l.GetCount()-1;a<=o;a++)i=a,this.Write(l.GetParams(i).FName),i<l.GetCount()-1&&(t?this.Write(","):this.Write(", "));else for(var h=0,u=(n=e.FParams).GetCount()-1;h<=u;h++)i=h,this.Write(n.Get(i)),i<n.GetCount()-1&&(t?this.Write(","):this.Write(", "));this.Write(") {"),t||e.FIsEmpty||(this.WriteLn(""),this.Indent()),null!=e.FBody&&(this.FSkipCurlyBrackets=!0,this.WriteJS(e.FBody),null==(r=e.FBody.FA)||v.isPrototypeOf(r)||w.isPrototypeOf(r)||A.isPrototypeOf(r)||(";"!==this.FLastChar&&this.Write(";"),t?this.Write(" "):this.WriteLn(""))),this.FWriter.SetCurElement(s),t||this.Undent(),this.Write("}")},this.WritePrimaryExpression=function(t){V.isPrototypeOf(t)?this.Write("this"):U.isPrototypeOf(t)?this.Write(t.FName):this.Error$1(rtl.getResStr(e,"SErrUnknownJSClass"),G(18,t.$classname))},this.WriteBinary=function(e){var t=this,s=null,i="";function r(e){t.FSkipRoundBrackets=e.FB.$class.ClassType()===s&&(s===J||s===j),t.Write(i),t.WriteJS(e.FB),t.FWriter.SetCurElement(e)}var n,l=!1,a=null,o=null,h=[],u=0;if((n=!this.FSkipRoundBrackets)&&this.Write("("),this.FSkipRoundBrackets=!1,s=e.$class.ClassType(),a=e.FA,l=!1,i="",H.isPrototypeOf(e)&&(i=e.$class.OperatorString(),l=e.$class.AllowCompact()),l&&0 in this.FOptions||(W.isPrototypeOf(e)?i+=" ":i=" "+i+" "),!H.isPrototypeOf(a)||a.$class.ClassType()!==s||s!==J&&s!==j&&s!==Y&&s!==z&&s!==_&&s!==K&&s!==X&&s!==q)this.WriteJS(a),this.FWriter.SetCurElement(e);else{for(h=rtl.arraySetLength(h,null,8),u=0;H.isPrototypeOf(a)&&(o=a).$class.ClassType()===s;)u===rtl.length(h)&&(h=rtl.arraySetLength(h,null,2*u)),h[u]=o,u+=1,a=o.FA;for(this.WriteJS(a),this.FWriter.SetCurElement(e);u>0;)r(h[u-=1])}r(e),n&&this.Write(")")},this.IsEmptyStatement=function(e){return null===e||(e.$class.ClassType()===Q&&!(2 in this.FOptions)||false)},this.EscapeString=function(e,t){var s,i=0,r=0,n="",l=0;for(i=1,r=1,n="",s=e.length;i<=s;){if((l=e.charCodeAt(i-1))in rtl.createSet(null,0,31,34,39,92)||l>=65280||l>=55296&&l<=57343||5760===l||l>=8192&&l<=8202||8232===l||8287===l||12288===l){n+=a(e,r,i-r);var o=l;92===o?n+="\\\\":34===o?n+=0===t?'"':'\\"':39===o?n+=1===t?"'":"\\'":o>=0&&o<=7||11===o||o>=14&&o<=31?n=n+"\\x"+rtl.hexStr(l,2):8===o?n+="\\b":9===o?n+="\\t":10===o?n+="\\n":12===o?n+="\\f":13===o?n+="\\r":o>=55296&&o<=56319&&i<s?(l=e.charCodeAt(i+1-1))>=56320&&l<=57343?(n+=a(e,i,2),i+=1):n=n+"\\u"+rtl.hexStr(e.charCodeAt(i-1),4):n=n+"\\u"+rtl.hexStr(l,4),r=i+1}i+=1}return n+=a(e,r,i-1)},this.Create$1=function(e){return this.FWriter=e,this.FIndentChar=" ",this.FOptions={},this},this.Destroy=function(){this.FFreeWriter&&(rtl.free(this,"FWriter"),this.FWriter=null),n.Destroy.call(this)},this.WriteJS=function(t){var s=null;this.FWriter.SetCurElement(t),(s=t.$class.ClassType())===A?this.WriteEmptyBlockStatement(t):s===Q?this.WriteEmptyStatement(t):s===Z?this.WriteDebuggerStatement(t):s===R?this.WriteLiteral(t):s.InheritsFrom(g)?this.WritePrimaryExpression(t):s.InheritsFrom(ee)?this.WriteArrayLiteral(t):s===te?this.WriteObjectLiteral(t):s.InheritsFrom(se)?this.WriteMemberExpression(t):s===ie?this.WriteRegularExpressionLiteral(t):s===I?this.WriteCallExpression(t):s===re?this.WriteLabeledStatement(t):s===ne?this.WriteFunctionBody(t):s===le?this.WriteVariableStatement(t):s.InheritsFrom(ae)?this.WriteUnary(t):s===oe?this.WriteVarDeclarationList(t):s===v?this.WriteStatementList(t):s===he?this.WriteWithStatement(t):s.InheritsFrom(ue)?this.WriteBinary(t):s===ce?this.WriteConditionalExpression(t):s.InheritsFrom(pe)?this.WriteAssignStatement(t):s===fe?this.WriteVarDeclaration(t):s===de?this.WriteIfStatement(t):s===Fe?this.WriteImportStatement(t):s===me?this.WriteExportStatement(t):s.InheritsFrom(Ce)?this.WriteTargetStatement(t):s===Se?this.WriteReturnStatement(t):s.InheritsFrom(Te)?this.WriteTryStatement(t):s===ye?this.WriteFunctionDeclarationStatement(t):s===w?this.WriteSourceElements(t):null===t?this.Error(rtl.getResStr(e,"SErrNilNode")):this.Error$1(rtl.getResStr(e,"SErrUnknownJSClass"),G(18,t.$classname)),this.FSkipCurlyBrackets=!1},this.Indent=function(){this.FCurIndent+=this.FIndentSize},this.Undent=function(){this.FCurIndent>=this.FIndentSize?this.FCurIndent-=this.FIndentSize:this.FCurIndent=0}}),rtl.createClass(this,"EJSWriter",ge,function(){i=this}),this.QuoteJSString=function(e,t){var s,i="",r=0,n=0;for("\0"===t&&(t=o('"',e)>0?"'":'"'),i=""+t,s=e.length,r=0,n=0;r<s;)r+=1,e.charAt(r-1)===t&&(i=i+a(e,1+n,r-n)+t,n=r);return r!==n&&(i+=a(e,1+n,r-n)),i+=t},e.$implcode=function(){t.LeftStr=function(e,t){return a(e,1,t)},e.$resourcestrings={SErrUnknownJSClass:{org:"Unknown javascript element class : %s"},SErrNilNode:{org:"Nil node in Javascript"}}}},[]),rtl.module("JSSrcMap",["System","JS","Classes","SysUtils","fpjson"],function(){"use strict";var e=this,t=null,s=null,i=null,r=null,n=pas.SysUtils,l=n.Exception,a=pas.System,o=a.TObject,h=pas.Classes,u=h.TStringList,c=h.TFPList,p=n.FreeAndNil,f=a.VarRecs,d=pas.fpjson,F=d.TJSONObject,m=d.TJSONArray,C=d.TJSONNull,S=n.ERangeError;this.Base64Chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rtl.createClass(this,"EJSSourceMap",l,function(){t=this}),rtl.createClass(this,"TSourceMapSegment",o,function(){s=this,this.$init=function(){o.$init.call(this),this.Index=0,this.GeneratedLine=0,this.GeneratedColumn=0,this.SrcFileIndex=0,this.SrcLine=0,this.SrcColumn=0,this.NameIndex=0}}),rtl.createClass(this,"TSourceMapSrc",o,function(){i=this,this.$init=function(){o.$init.call(this),this.Filename="",this.TranslatedFilename="",this.Source=""}}),this.TSourceMapOption={0:"smoAddMonotonous",smoAddMonotonous:0,1:"smoAutoLineStart",smoAutoLineStart:1,2:"smoSafetyHeader",smoSafetyHeader:2,3:"smoAllowSrcLine0",smoAllowSrcLine0:3},this.DefaultSourceMapOptions=rtl.createSet(0,2),rtl.createClass(this,"TSourceMap",o,function(){rtl.createClass(this,"TStringToIndex",o,function(){r=this,this.$init=function(){o.$init.call(this),this.FItems=null},this.$final=function(){this.FItems=void 0,o.$final.call(this)},this.Create$1=function(){return this.FItems=new Object,this},this.Destroy=function(){this.FItems=null,o.Destroy.call(this)},this.Clear=function(){this.FItems=new Object},this.Add=function(e,t){this.FItems["%"+e]=t},this.FindValue=function(e){return this.FItems.hasOwnProperty("%"+e)?rtl.trunc(this.FItems["%"+e]):-1}},"TSourceMap.TStringToIndex"),this.$init=function(){o.$init.call(this),this.FGeneratedFilename="",this.FNames=null,this.FNameToIndex=null,this.FItems=null,this.FOptions={},this.FSorted=!1,this.FSourceRoot="",this.FSources=null,this.FSourceToIndex=null,this.FVersion=0},this.$final=function(){this.FNames=void 0,this.FNameToIndex=void 0,this.FItems=void 0,this.FOptions=void 0,this.FSources=void 0,this.FSourceToIndex=void 0,o.$final.call(this)},this.GetNames=function(e){return this.FNames.Get(e)},this.GetItems=function(e){return rtl.getObject(this.FItems.Get(e))},this.GetSourceContents=function(e){return rtl.getObject(this.FSources.Get(e)).Source},this.GetSourceFiles=function(e){return rtl.getObject(this.FSources.Get(e)).Filename},this.GetSourceTranslatedFiles=function(e){return rtl.getObject(this.FSources.Get(e)).TranslatedFilename},this.SetGeneratedFilename=function(e){this.FGeneratedFilename!==e&&(this.FGeneratedFilename=e)},this.SetSourceContents=function(e,t){rtl.getObject(this.FSources.Get(e)).Source=t},this.SetSourceTranslatedFiles=function(e,t){rtl.getObject(this.FSources.Get(e)).TranslatedFilename=t},this.Create$1=function(t){return this.FOptions=rtl.refSet(e.DefaultSourceMapOptions),this.FVersion=3,this.FNames=u.$create("Create$1"),this.FNameToIndex=r.$create("Create$1"),this.FItems=c.$create("Create"),this.FSources=c.$create("Create"),this.FSourceToIndex=r.$create("Create$1"),this.SetGeneratedFilename(t),this.FSorted=!0,this},this.Destroy=function(){this.Clear(),p({p:this,get:function(){return this.p.FSourceToIndex},set:function(e){this.p.FSourceToIndex=e}}),p({p:this,get:function(){return this.p.FSources},set:function(e){this.p.FSources=e}}),p({p:this,get:function(){return this.p.FItems},set:function(e){this.p.FItems=e}}),p({p:this,get:function(){return this.p.FNameToIndex},set:function(e){this.p.FNameToIndex=e}}),p({p:this,get:function(){return this.p.FNames},set:function(e){this.p.FNames=e}}),o.Destroy.call(this)},this.Clear=function(){var e=0;this.FGeneratedFilename="",this.FSourceToIndex.Clear();for(var t=0,s=this.FSources.FCount-1;t<=s;t++)e=t,rtl.getObject(this.FSources.Get(e)).$destroy("Destroy");this.FSources.Clear();for(var i=0,r=this.FItems.FCount-1;i<=r;i++)e=i,rtl.getObject(this.FItems.Get(e)).$destroy("Destroy");this.FItems.Clear(),this.FNameToIndex.Clear(),this.FNames.Clear(),this.FSourceRoot="",this.FSorted=!0},this.AddMapping=function(e,i,r,n,l,a){var o=null;function h(s){throw t.$create("CreateFmt",['%s (GeneratedLine=%d GeneratedCol=%d SrcFile="%s" SrcLine=%d SrcCol=%d Name="%s")',f(18,s,0,e,0,i,18,r,0,n,0,l,18,a)])}var u,c=null;return e<1&&h("invalid GeneratedLine"),i<0&&h("invalid GeneratedCol"),""===r?(0===this.Count()&&h("missing source file"),1!==n&&h("invalid SrcLine"),0!==l&&h("invalid SrcCol"),""!==a&&h("invalid Name")):(n<1&&(n<0||!(3 in this.FOptions))&&h("invalid SrcLine"),l<0&&h("invalid SrcCol")),(u=this.Count())>0&&((c=this.GetItems(u-1)).GeneratedLine>e||c.GeneratedLine===e&&c.GeneratedColumn>i)&&(0 in this.FOptions?h("GeneratedLine/Col not monotonous"):this.FSorted=!1),(o=s.$create("Create")).Index=this.FItems.FCount,o.GeneratedLine=e,o.GeneratedColumn=i,o.SrcFileIndex=""===r?-1:this.IndexOfSourceFile(r,!0),o.SrcLine=n,o.SrcColumn=l,o.NameIndex=""!==a?this.IndexOfName(a,!0):-1,this.FItems.Add(o),o},this.CreateMappings=function(){var t="",s=null;function i(e){s.push(e)}function r(e){s.push(e)}var n=0,l=0,a=0,o=0,h=0,u=0,c=0,p=0,f=0,d=null;t="",l=1,a=0,h=0,u=0,c=0,f=0,s=new Array;try{for(var F=0,m=this.Count()-1;F<=m;F++){if(n=F,l<(d=this.GetItems(n)).GeneratedLine){a=0;for(var C=l+1,S=d.GeneratedLine;C<=S;C++)o=C,r(";"),1 in this.FOptions&&(o<d.GeneratedLine||d.GeneratedColumn>0)&&(i(e.EncodeBase64VLQ(0-a)),a=0,i(e.EncodeBase64VLQ(0)),i(e.EncodeBase64VLQ(0)),i(e.EncodeBase64VLQ(0)),o===d.GeneratedLine&&r(","));l=d.GeneratedLine}else if(n>0){if(l===d.GeneratedLine&&a===d.GeneratedColumn)continue;r(",")}i(e.EncodeBase64VLQ(d.GeneratedColumn-a)),a=d.GeneratedColumn,d.SrcFileIndex<0||(i(e.EncodeBase64VLQ(d.SrcFileIndex-h)),h=d.SrcFileIndex,p=d.SrcLine-1,i(e.EncodeBase64VLQ(p-u)),u=p,i(e.EncodeBase64VLQ(d.SrcColumn-c)),c=d.SrcColumn,d.NameIndex<0||(i(e.EncodeBase64VLQ(d.NameIndex-f)),f=d.NameIndex))}t=s.join("")}finally{}return t},this.ToJSON=function(){var e,t=null,s=null,i=0,r=null;t=null,e=this.CreateMappings(),s=F.$create("Create$2");try{s.Add$5("version",this.FVersion),""!==this.FGeneratedFilename&&s.Add$3("file",this.FGeneratedFilename),""!==this.FSourceRoot&&s.Add$3("sourceRoot",this.FSourceRoot),r=m.$create("Create$2"),s.Add$7("sources",r);for(var n=0,l=this.SourceCount()-1;n<=l;n++)i=n,r.Add$3(this.GetSourceTranslatedFiles(i));for(i=this.SourceCount()-1;i>=0;){if(""!==this.GetSourceContents(i)){r=m.$create("Create$2"),s.Add$7("sourcesContent",r);for(var a=0,o=this.SourceCount()-1;a<=o;a++)i=a,""===this.GetSourceContents(i)?r.Add(C.$create("Create$1")):r.Add$3(this.GetSourceContents(i));break}i-=1}r=m.$create("Create$2"),s.Add$7("names",r);for(var h=0,u=this.NameCount()-1;h<=u;h++)i=h,r.Add$3(this.GetNames(i));s.Add$3("mappings",e),t=s}finally{null===t&&(s=rtl.freeLoc(s))}return t},this.SaveToStream=function(t){var s=null;s=this.ToJSON();try{2 in this.FOptions&&t.push(e.DefaultSrcMapHeader()),s.DumpJSON(t)}finally{s=rtl.freeLoc(s)}},this.IndexOfName=function(e,t){var s=0;return(s=this.FNameToIndex.FindValue(e))>=0||!t||(s=this.FNames.GetCount(),this.FNames.Add(e),this.FNameToIndex.Add(e,s)),s},this.IndexOfSourceFile=function(e,t){var s=0,r=null;return(s=this.FSourceToIndex.FindValue(e))>=0||!t||((r=i.$create("Create")).Filename=e,r.TranslatedFilename=e,s=this.FSources.FCount,this.FSources.Add(r),this.FSourceToIndex.Add(e,s)),s},this.Count=function(){return this.FItems.FCount},this.SourceCount=function(){return this.FSources.FCount},this.NameCount=function(){return this.FNames.GetCount()}}),this.DefaultSrcMapHeader=function(){return")]}'"+a.LineEnding},this.EncodeBase64VLQ=function(t){var s="";function i(){throw S.$create("Create$1",["EncodeBase64VLQ"])}var r=0;s="",t<0?((t=-t)>Math.floor(0xfffffffffffff)&&i(),t=rtl.shl(t,1)+1):(t>0xfffffffffffff&&i(),t=rtl.shl(t,1));do{r=31&t,(t=Math.floor(t/32))>0&&(r+=32),s+=e.Base64Chars.charAt(r+1-1)}while(0!==t);return s}}),rtl.module("Pas2JSUtils",["System","Classes","SysUtils"],function(){"use strict";var e=this,t=e.$impl,s=pas.System,i=s.Copy,r=pas.SysUtils.LowerCase,n=s.Delete;this.ChompPathDelim=function(e){var t="",i=0,r=0;if(t=e,""===e)return t;i=t.length,t.charCodeAt(0)in s.AllowDirectorySeparators?(r=1,i>=2&&t.charAt(1)===t.charAt(0)&&"\\"===s.PathDelim&&(r=2)):(r=0,"\\"===s.PathDelim&&i>=3&&t.charCodeAt(0)in rtl.createSet(null,97,122,null,65,90)&&":"===t.charAt(1)&&t.charCodeAt(2)in s.AllowDirectorySeparators&&(r=3));for(;i>r&&t.charCodeAt(i-1)in s.AllowDirectorySeparators;)i-=1;return i<t.length&&(t=rtl.strSetLength(t,i)),t},this.GetNextDelimitedItem=function(e,t,s){var r,n;for(n=s.get();s.get()<=e.length&&e.charAt(s.get()-1)!==t;)s.set(s.get()+1);return r=i(e,n,s.get()-n),s.get()<=e.length&&s.set(s.get()+1),r},this.NormalizeEncoding=function(e){for(var t="",s=0,i=(t=r(e)).length;i>=1;i--)s=i,"-"===t.charAt(s-1)&&n({get:function(){return t},set:function(e){t=e}},s,1);return t};this.SplitCmdLineParams=function(e,t,s){var i=0,r=0,n="";for(i=1;i<=e.length;){for(;i<=e.length&&e.charCodeAt(i-1)in rtl.createSet(32,9,10,13);)i+=1;if(i>e.length||"\0"===e.charAt(i-1))break;for(n="",r=0;i<=e.length;){var l=e.charAt(i-1);if("\0"===l)break;if("\\"===l)if(i+=1,s){if(i>e.length||"\0"===e.charAt(i-1))break;e.charCodeAt(i-1)<128&&(n+=e.charAt(i-1),i+=1)}else n+="\\";else if("'"===l){i+=1;var a=r;0===a?r=1:1===a?r=0:2===a&&(n+="'")}else if('"'===l){i+=1;var o=r;0===o?r=2:1===o?n+='"':2===o&&(r=0)}else if(" "===l||"\t"===l||"\n"===l||"\r"===l){if(0===r)break;n+=e.charAt(i-1),i+=1}else n+=e.charAt(i-1),i+=1}t.Add(n)}},e.$implcode=function(){t.InternalInit=function(){}},e.$init=function(){t.InternalInit()}},[]),rtl.module("pas2jsresstrfile",["System","SysUtils","fpjson"],function(){"use strict";var e=this,t=(e.$impl,null),s=pas.SysUtils,i=s.Exception,r=pas.System,n=r.TObject,l=pas.fpjson,a=l.TJSONObject,o=s.FreeAndNil,h=s.IsValidIdent,u=r.VarRecs;rtl.createClass(this,"EResourceStringsFile",i,function(){t=this}),rtl.createClass(this,"TResourceStringsFile",n,function(){this.$init=function(){n.$init.call(this),this.FCurrentUnit="",this.FStrings=null,this.FUnit=null},this.$final=function(){this.FStrings=void 0,this.FUnit=void 0,n.$final.call(this)},this.GetStringsCount=function(){var e=0,t=0;e=0;for(var s=0,i=this.FStrings.GetCount()-1;s<=i;s++)t=s,e+=this.FStrings.GetItem(t).GetCount();return e},this.Create$1=function(){return this.FStrings=a.$create("Create$2"),this.FUnit=null,this},this.Destroy=function(){this.FUnit=null,o({p:this,get:function(){return this.p.FStrings},set:function(e){this.p.FStrings=e}}),n.Destroy.call(this)},this.Clear=function(){this.FStrings.Clear()},this.StartUnit=function(s){var i;if(s!==this.FCurrentUnit){if(!h(s,!0,!0))throw t.$create("CreateFmt",[rtl.getResStr(e,"SErrInvalidUnitName"),u(18,s)]);-1!==(i=this.FStrings.IndexOfName(s,!1))?this.FUnit=rtl.as(this.FStrings.GetItem(i),a):(this.FUnit=a.$create("Create$2"),this.FStrings.Add(s,this.FUnit)),this.FCurrentUnit=s}},this.AddString=function(s,i){if(!h(s,!1,!1))throw t.$create("CreateFmt",[rtl.getResStr(e,"SErrInvalidStringName"),u(18,s)]);if(null===this.FUnit)throw t.$create("Create$1",[rtl.getResStr(e,"SErrNoCurrentUnit")]);this.FUnit.Add$3(s,i)},this.AsString=function(){return this.FStrings.FormatJSON(l.DefaultFormat,2)}}),e.$implcode=function(){e.$resourcestrings={SErrNoCurrentUnit:{org:"No current unit."},SErrInvalidUnitName:{org:'Invalid unit name: "%s"'},SErrInvalidStringName:{org:'Invalid TJSONStringType name: "%s"'}}}},[]),rtl.module("pas2jsresources",["System","Classes","SysUtils","Web","Pas2JSFS","jstree"],function(){"use strict";var e=null,t=pas.System,s=t.TObject,i=pas.SysUtils,r=i.ExtractFileExt,n=t.Copy,l=t.Pos,a=i.LowerCase;this.TResourceOutputMode={0:"romNone",romNone:0,1:"romJS",romJS:1,2:"romFile",romFile:2,3:"romExtraJS",romExtraJS:3},rtl.createClass(this,"TPas2jsResourceHandler",s,function(){e=this,this.$init=function(){s.$init.call(this),this.FCurrentUnitName="",this.FFS=null},this.$final=function(){this.FFS=void 0,s.$final.call(this)},this.GetFormat=function(e,t){var s="",i="";return""===(s=t.GetValue("format"))&&(""!==(i=r(e))&&"."===i.charAt(0)&&(i=n(i,2,i.length-1)),s=l(a(i),";png;jpg;jpeg;bmp;ico;")>0?"image/"+i:l(a(i),";htm;html;")>0?"text/html":l(a(i),";txt;lpr;pas;pp;")>0?"text/text":l(a(i),";js;")>0||l(a(i),";json;")>0?"application/javascript":"application/octet-stream"),s},this.Create$1=function(e){return this.FFS=e,this},this.OutputFileExtension=function(){return""},this.LoadFile=function(e){return this.FFS.LoadFile(e,!0)},this.GetFileAsBase64=function(e){var t;return t=this.LoadFile(e),window.atob(t.FSource)},this.StartUnit=function(e){this.FCurrentUnitName=e},this.ClearUnit=function(){this.FCurrentUnitName=""},this.DoneUnit=function(e){e||this.ClearUnit()},this.WriteJS=function(e,t){return t}}),rtl.createClass(this,"TNoResources",e,function(){this.HandleResource=function(e,t){},this.OutputMode=function(){return 0},this.GetResourceCount=function(){return 0},this.GetAsString=function(){return""}})}),rtl.module("pas2jshtmlresources",["System","Classes","SysUtils","pas2jsresources","Pas2JSFS"],function(){"use strict";var e=pas.pas2jsresources.TPas2jsResourceHandler,t=pas.SysUtils,s=t.Format,i=pas.System,r=i.VarRecs,n=pas.Classes.TStringList,l=t.ChangeFileExt,a=t.ExtractFileName,o=t.FreeAndNil,h=i.TObject;rtl.createClass(this,"THTMLResourceLinkHandler",e,function(){this.$init=function(){e.$init.call(this),this.FLinkType="",this.FPrefix="",this.FResources=null},this.$final=function(){this.FResources=void 0,e.$final.call(this)},this.GetResourceCount=function(){return this.FResources.GetCount()},this.GetAsString=function(){return this.FResources.GetTextStr()},this.CreateDataLink=function(e,t,i){return s('<link rel="%s" as="script" id="%s-%s" data-unit="%s" href="data:%s;base64,%s" />',r(18,this.FLinkType,18,this.FPrefix,18,e,18,this.FCurrentUnitName,18,t,18,i))},this.Create$1=function(t){return e.Create$1.call(this,t),this.FResources=n.$create("Create$1"),this.FPrefix="resource",this.FLinkType="preload",this},this.OutputMode=function(){return 2},this.OutputFileExtension=function(){return".html"},this.HandleResource=function(e,t){var s,i,r="";s=this.GetFileAsBase64(e),i=this.GetFormat(e,t),""===(r=t.GetValue("name"))&&(r=l(a(e),"")),this.FResources.Add(this.CreateDataLink(r,i,s))},this.ClearUnit=function(){e.ClearUnit.call(this),this.FResources.Clear()},this.DoneUnit=function(e){},this.Destroy=function(){o({p:this,get:function(){return this.p.FResources},set:function(e){this.p.FResources=e}}),h.Destroy.call(this)}})}),rtl.module("pas2jsjsresources",["System","Classes","SysUtils","pas2jsresources","Pas2JSFS"],function(){"use strict";var e=pas.pas2jsresources.TPas2jsResourceHandler,t=pas.SysUtils,s=t.ChangeFileExt,i=t.ExtractFileName,r=t.Format,n=pas.System,l=n.VarRecs,a=t.LowerCase,o=pas.Classes.TStringList,h=t.FreeAndNil,u=n.TObject;rtl.createClass(this,"TJSResourceHandler",e,function(){this.$init=function(){e.$init.call(this),this.FResources=null},this.$final=function(){this.FResources=void 0,e.$final.call(this)};this.GetResourceJSStatement=function(e,t){var n,o,h="";return o=this.GetFileAsBase64(e),n=this.GetFormat(e,t),""===(h=t.GetValue("name"))&&(h=s(i(e),"")),r('rtl.addResource({name: "%s", unit: "%s", format: "%s", encoding: "base64", data: "%s"});',l(18,a(h),18,a(this.FCurrentUnitName),18,n,18,o))},this.GetResourceCount=function(){return this.FResources.GetCount()},this.GetAsString=function(){var e="",t=0,s="",i="";e="";for(var r=0,n=this.FResources.GetCount()-1;r<=n;r++)t=r,this.FResources.GetNameValue(t,{get:function(){return s},set:function(e){s=e}},{get:function(){return i},set:function(e){i=e}}),e=e+i+"\n";return e},this.Create$1=function(t){return e.Create$1.call(this,t),this.FResources=o.$create("Create$1"),this},this.OutputMode=function(){return 3},this.OutputFileExtension=function(){return".js"},this.HandleResource=function(e,t){this.FResources.Add(this.FCurrentUnitName+"="+this.GetResourceJSStatement(e,t))},this.Destroy=function(){h({p:this,get:function(){return this.p.FResources},set:function(e){this.p.FResources=e}}),u.Destroy.call(this)}})}),rtl.module("FPPas2Js",["System","Classes","SysUtils","Math","contnrs","jsbase","jstree","jswriter","PasTree","PScanner","PasResolveEval","PasResolver"],function(){"use strict";var e=this,t=e.$impl,s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=null,R=null,v=null,A=null,N=null,x=null,b=null,O=null,k=null,$=null,D=null,L=pas.SysUtils,B=L.Exception,M=pas.PasTree,G=M.TPasElementBase,w=pas.System,V=w.TObject,U=pas.PasResolver,J=U.TPasModuleScope,j=L.FreeAndNil,H=L.LowerCase,W=U.TPasResHashList,Y=U.TPasIdentifier,z=pas.Classes,_=z.TFPList,K=U.TPasSectionScope,X=U.TPasInitialFinalizationScope,q=U.TPasClassScope,Q=U.TPasIdentifierScope,Z=U.TPasRecordScope,ee=U.TPasProcedureScope,te=z.TStringList,se=U.TPasArrayScope,ie=U.TPasProcTypeScope,re=U.TPasWithExprScope,ne=U.TResElDataBaseType,le=pas.PScanner,ae=le.TPascalScanner,oe=L.IntToStr,he=L.LeftStr,ue=w.Copy,ce=w.Insert,pe=w.VarRecs,fe=L.DecodeDate,de=L.Now,Fe=L.DecodeTime,me=L.Format,Ce=L.ExtractFileName,Se=M.TPasProcedure,Te=L.GetEnvironmentVariable,ye=L.CompareText,ge=U.TPasResolverHub,Ee=pas.PasResolveEval,Pe=Ee.GetObjPath,Ie=U.TPasResolver,Re=M.TProcedureExpr,ve=U.TResolvedReference,Ae=M.TPasClassType,Ne=M.TPasMembersType,xe=M.TPasProperty,be=M.TPasConst,Oe=M.TPasType,ke=M.TProcedureBody,$e=M.TPasClassFunction,De=U.GetElementDbgPath,Le=M.TImplementationSection,Be=M.TPasVariable,Me=M.TPasRecordType,Ge=Ee.GetObjName,we=U.TPasClassOrRecordScope,Ve=M.TPasVariant,Ue=U.TPasResolverResult,Je=M.TBinaryExpr,je=M.TParamsExpr,He=M.TPasExpr,We=M.TPasImplElement,Ye=M.TPasArgument,ze=M.TPasResultElement,_e=M.TPrimitiveExpr,Ke=M.TPasImplBlock,Xe=M.TPasFunctionType,qe=M.TPasFunction,Qe=M.TPasPointerType,Ze=M.TPasModule,et=M.TPasProgram,tt=M.TPasLibrary,st=M.TPasEnumType,it=M.TPasUnresolvedSymbolRef,rt=M.TPasRangeType,nt=Ee.ReleaseEvalValue,lt=L.SameText,at=U.GetElementTypeName,ot=M.TVariableModifier,ht=w.TGuid,ut=M.TPasImplExceptOn,ct=M.TPasSection,pt=M.TNilExpr,ft=M.TPasArrayType,dt=M.TPasClassProcedure,Ft=M.TPasConstructor,mt=M.TLibrarySection,Ct=U.NoNil,St=U.TResolvedRefCtxConstructor,Tt=M.TPasClassOfType,yt=L.Trim,gt=M.TPasGenericType,Et=M.TInterfaceSection,Pt=U.TPasGenericScope,It=U.SetResolverValueExpr,Rt=U.TPRFindData,vt=M.TPasSetType,At=M.TPasProcedureType,Nt=M.TPasGenericTemplateType,xt=U.SetResolverTypeExpr,bt=M.TPasSpecializeType,Ot=pas.jsbase,kt=Ot.StrToJSString,$t=Ee.TREVKind,Dt=L.TryStringToGUID,Lt=U.SetResolverIdentifier,Bt=Ne.TRTTIVisibility,Mt=pas.jstree,Gt=Mt.TJSSourceElements,wt=Mt.TJSDotMemberExpression,Vt=Mt.TJSPrimaryExpressionIdent,Ut=Mt.TJSSwitchStatement,Jt=M.TPasImplCaseStatement,jt=Mt.TJSBreakStatement,Ht=Mt.TJSStatementList,Wt=M.TPasAliasType,Yt=M.TPasTypeAliasType,zt=Mt.TJSObjectLiteral,_t=Mt.TJSSimpleAssignStatement,Kt=Mt.TJSVariableStatement,Xt=le.CreateMsgArgs,qt=M.TBoolConstExpr,Qt=M.TUnaryExpr,Zt=L.DeQuoteString,es=Mt.TJSLiteral,ts=w.Pos,ss=L.CompareStr,is=U.ResolveSimpleAliasType,rs=U.TPasSpecializeTypeData,ns=M.TPasEnumValue,ls=M.TPasDeclarations,as=Mt.TJSMemberExpression,os=Mt.TJSBracketMemberExpression,hs=Mt.TJSNewMemberExpression,us=Mt.TJSCallExpression,cs=Mt.TJSUnary,ps=Mt.TJSBinary,fs=Mt.TJSArrayLiteral,ds=Mt.TJSConditionalExpression,Fs=Mt.TJSAssignStatement,ms=Mt.TJSVarDeclaration,Cs=Mt.TJSIfStatement,Ss=Mt.TJSBodyStatement,Ts=Mt.TJSCondLoopStatement,ys=Mt.TJSForStatement,gs=Mt.TJSForInStatement,Es=Ot.JSStringToString,Ps=Mt.TJSFunctionStatement,Is=Mt.TJSFuncDef,Rs=Mt.TJSFunctionBody,vs=Mt.TJSArguments,As=w.Copy$1,Ns=Mt.TJSReturnStatement,xs=Mt.TJSUnaryPlusExpression,bs=Mt.TJSEmptyBlockStatement,Os=Mt.TJSVariableDeclarationList,ks=M.TPasStringType,$s=Mt.TJSTryFinallyStatement,Ds=Mt.TJSWhileStatement,Ls=Mt.TJSExportStatement,Bs=pas.jswriter,Ms=Bs.TBufferWriter,Gs=Bs.TJSWriter,ws=pas.Math,Vs=ws.IsInfinite,Us=Mt.TJSMultiplicativeExpressionDiv,Js=Mt.TJSUnaryNotExpression,js=Mt.TJSMultiplicativeExpressionMul,Hs=w.Trunc,Ws=ws.Floor,Ys=M.TPasDestructor,zs=M.TPasExportSymbol,_s=M.TRecordValues,Ks=Mt.TJSLogicalAndExpression,Xs=Mt.TJSEqualityExpressionSEQ,qs=M.TArrayValues,Qs=pas.contnrs.TObjectList,Zs=U.GetResolverResultDbg,ei=Mt.TJSRelationalExpressionGT,ti=Mt.TJSUnaryBracketsExpression,si=M.TInlineSpecializeExpr,ii=U.TResolvedRefCtxAttrProc,ri=M.TPasClassConstructor,ni=M.TPasClassDestructor,li=M.TPasAttributes,ai=U.TPasClassIntfMap,oi=M.TPasImplRaise,hi=M.TPasImplAssign,ui=M.TPasImplWhileDo,ci=M.TPasImplSimple,pi=M.TPasImplWithDo,fi=M.TPasImplForLoop,di=M.TPasImplAsmStatement,Fi=Mt.TJSAddEqAssignStatement,mi=Mt.TJSSubEqAssignStatement,Ci=Mt.TJSMulEqAssignStatement,Si=Mt.TJSDivEqAssignStatement,Ti=U.TResElDataBuiltInProc,yi=Mt.TJSThrowStatement,gi=Mt.TJSDoWhileStatement,Ei=Ee.TResEvalInt,Pi=Ee.TResEvalEnum,Ii=Mt.TJSEqualityExpressionSNE,Ri=U.TPasForLoopScope,vi=Mt.TJSAdditiveExpressionMinus,Ai=Mt.TJSRelationalExpressionGE,Ni=Mt.TJSRelationalExpressionLE,xi=Mt.TJSUnaryPostMinusMinusExpression,bi=Mt.TJSUnaryPostPlusPlusExpression,Oi=L.TrimRight,ki=Mt.TJSExpressionStatement,$i=U.TPasWithScope,Di=Ot.IsValidJSIdentifier,Li=Mt.TJSPrimaryExpressionThis,Bi=Mt.TJSWithStatement,Mi=M.TPasImplTryFinally,Gi=Mt.TJSTryCatchStatement,wi=Mt.TJSLogicalOrExpression,Vi=Mt.TJSEmptyStatement,Ui=M.TPasImplCaseElse,Ji=w.Delete,ji=Ee.TResEvalSet.TItem,Hi=Mt.TJSURShiftExpression,Wi=Mt.TJSBitwiseAndExpression,Yi=Mt.TJSLShiftExpression,zi=Mt.TJSRShiftExpression,_i=Mt.TJSAdditiveExpressionPlus,Ki=Mt.TJSEqualityExpressionNE,Xi=Mt.TJSEqualityExpressionEQ,qi=Mt.TJSContinueStatement,Qi=M.TPasImplTry,Zi=U.TResolverBaseType.btIntDouble,er=Mt.TJSAwaitExpression,tr=Mt.TJSMultiplicativeExpressionMod,sr=Mt.TJSRelationalExpressionLT,ir=Mt.TJSRelationalExpressionInstanceOf,rr=M.TInheritedExpr,nr=Mt.TJSBitwiseOrExpression,lr=Mt.TJSBitwiseXOrExpression,ar=Mt.TJSPowerExpression,or=Mt.TJSRelationalExpressionIn,hr=w.val$8,ur=w.val,cr=M.TPasResString,pr=Mt.TJSUnaryMinusExpression,fr=Mt.TJSUnaryInvExpression,dr=M.TPasLabels,Fr=M.TPasImplLabelMark,mr=M.TPasImplCommand,Cr=M.TPasPackage,Sr=M.TPasElement,Tr=M.TPasImplStatement,yr=M.TPasImplIfElse,gr=M.TPasImplRepeatUntil,Er=M.TPasImplBeginBlock,Pr=M.TInitializationSection,Ir=M.TFinalizationSection,Rr=M.TPasImplCaseOf,vr=L.UpperCase,Ar=M.TPasMethodResolution;this.nPasElementNotSupported=4001,this.nNotSupportedX=4002,this.nUnaryOpcodeNotSupported=4003,this.nBinaryOpcodeNotSupported=4004,this.nInvalidNumber=4005,this.nInitializedArraysNotSupported=4006,this.nMemberExprMustBeIdentifier=4007,this.nCantWriteSetLiteral=4008,this.nInvalidAbsoluteLocation=4009,this.nForInJSArrDefaultGetterNotExtBracketAccessor=4010,this.nMissingExternalName=4012,this.nVirtualMethodNameMustMatchExternal=4013,this.nPublishedNameMustMatchExternal=4014,this.nInvalidVariableModifier=4015,this.nAWaitOnlyInAsyncProcedure=4016,this.nNewInstanceFunctionMustBeVirtual=4017,this.nNewInstanceFunctionMustHaveTwoParameters=4018,this.nNewInstanceFunctionMustNotHaveOverloadAtX=4019,this.nBracketAccessorOfExternalClassMustHaveOneParameter=4020,this.nTypeXCannotBePublished=4021,this.nNestedInheritedNeedsParameters=4022,this.nFreeNeedsVar=4023,this.nDuplicateGUIDXInYZ=4024,this.nCantCallExtBracketAccessor=4025,this.nJSNewNotSupported=4026,this.nHelperClassMethodForExtClassMustBeStatic=4027,this.nDuplicateMessageIdXAtY=4029,this.nDispatchRequiresX=4030,this.nConstRefNotForXAsConst=4031,this.ExtClassBracketAccessor="[]",this.IsExtModePasClassInstance=1,this.IsExtModePasClass=2,this.ExtRTTIVisPrivate=0,this.ExtRTTIVisProtected=1,this.ExtRTTIVisPublic=2,this.ExtRTTIVisPublished=3,this.ExtRTTIVisPublicPublished=4,this.ExtRTTIVisStrictPrivate=5,this.ExtRTTIVisStrictProtected=6,this.ExtRTTIVisDefaultField=2,this.ExtRTTIVisDefaultMethod=2,this.ExtRTTIVisDefaultProperty=4,this.TPas2JSBuiltInName={0:"pbifnArray_Concat",pbifnArray_Concat:0,1:"pbifnArray_ConcatN",pbifnArray_ConcatN:1,2:"pbifnArray_Copy",pbifnArray_Copy:2,3:"pbifnArray_DeleteR",pbifnArray_DeleteR:3,4:"pbifnArray_Equal",pbifnArray_Equal:4,5:"pbifnArray_Insert",pbifnArray_Insert:5,6:"pbifnArray_Managed",pbifnArray_Managed:6,7:"pbifnArray_Length",pbifnArray_Length:7,8:"pbifnArray_Push",pbifnArray_Push:8,9:"pbifnArray_PushN",pbifnArray_PushN:9,10:"pbifnArray_Reference",pbifnArray_Reference:10,11:"pbifnArray_SetLength",pbifnArray_SetLength:11,12:"pbifnArray_Static_Clone",pbifnArray_Static_Clone:12,13:"pbifnAs",pbifnAs:13,14:"pbifnAsExt",pbifnAsExt:14,15:"pbifnBitwiseLongwordFix",pbifnBitwiseLongwordFix:15,16:"pbifnBitwiseNativeIntAnd",pbifnBitwiseNativeIntAnd:16,17:"pbifnBitwiseNativeIntOr",pbifnBitwiseNativeIntOr:17,18:"pbifnBitwiseNativeIntShl",pbifnBitwiseNativeIntShl:18,19:"pbifnBitwiseNativeIntShr",pbifnBitwiseNativeIntShr:19,20:"pbifnBitwiseNativeIntXor",pbifnBitwiseNativeIntXor:20,21:"pbifnCheckMethodCall",pbifnCheckMethodCall:21,22:"pbifnCheckVersion",pbifnCheckVersion:22,23:"pbifnClassAncestorFunc",pbifnClassAncestorFunc:23,24:"pbifnClassInstanceFree",pbifnClassInstanceFree:24,25:"pbifnClassInstanceNew",pbifnClassInstanceNew:25,26:"pbifnClassInitSpecialize",pbifnClassInitSpecialize:26,27:"pbifnCreateClass",pbifnCreateClass:27,28:"pbifnCreateClassExt",pbifnCreateClassExt:28,29:"pbifnCreateHelper",pbifnCreateHelper:29,30:"pbifnGetChar",pbifnGetChar:30,31:"pbifnGetNumber",pbifnGetNumber:31,32:"pbifnGetObject",pbifnGetObject:32,33:"pbifnGetResourcestring",pbifnGetResourcestring:33,34:"pbifnHelperNew",pbifnHelperNew:34,35:"pbifnIntf_AddRef",pbifnIntf_AddRef:35,36:"pbifnIntf_Release",pbifnIntf_Release:36,37:"pbifnIntfAddMap",pbifnIntfAddMap:37,38:"pbifnIntfAsClass",pbifnIntfAsClass:38,39:"pbifnIntfAsIntfT",pbifnIntfAsIntfT:39,40:"pbifnIntfCreate",pbifnIntfCreate:40,41:"pbifnIntfCreateTGUID",pbifnIntfCreateTGUID:41,42:"pbifnIntfExprRefsAdd",pbifnIntfExprRefsAdd:42,43:"pbifnIntfExprRefsCreate",pbifnIntfExprRefsCreate:43,44:"pbifnIntfExprRefsFree",pbifnIntfExprRefsFree:44,45:"pbifnIntfGetGUIDR",pbifnIntfGetGUIDR:45,46:"pbifnIntfGetIntfT",pbifnIntfGetIntfT:46,47:"pbifnIntfGuidRToStr",pbifnIntfGuidRToStr:47,48:"pbifnIntfIsClass",pbifnIntfIsClass:48,49:"pbifnIntfIsIntf",pbifnIntfIsIntf:49,50:"pbifnIntfToClass",pbifnIntfToClass:50,51:"pbifnIntfSetIntfL",pbifnIntfSetIntfL:51,52:"pbifnIntfSetIntfP",pbifnIntfSetIntfP:52,53:"pbifnIntfStrToGUIDR",pbifnIntfStrToGUIDR:53,54:"pbifnIntfQueryIntfIsT",pbifnIntfQueryIntfIsT:54,55:"pbifnIntfQueryIntfT",pbifnIntfQueryIntfT:55,56:"pbifnIs",pbifnIs:56,57:"pbifnIsExt",pbifnIsExt:57,58:"pbifnFloatToStr",pbifnFloatToStr:58,59:"pbifnValEnum",pbifnValEnum:59,60:"pbifnFreeLocalVar",pbifnFreeLocalVar:60,61:"pbifnFreeVar",pbifnFreeVar:61,62:"pbifnLibraryMain",pbifnLibraryMain:62,63:"pbifnOverflowCheckInt",pbifnOverflowCheckInt:63,64:"pbifnProcType_Create",pbifnProcType_Create:64,65:"pbifnProcType_CreateSafe",pbifnProcType_CreateSafe:65,66:"pbifnProcType_Equal",pbifnProcType_Equal:66,67:"pbifnProgramMain",pbifnProgramMain:67,68:"pbifnRaiseException",pbifnRaiseException:68,69:"pbifnRangeCheckArrayRead",pbifnRangeCheckArrayRead:69,70:"pbifnRangeCheckArrayWrite",pbifnRangeCheckArrayWrite:70,71:"pbifnRangeCheckChar",pbifnRangeCheckChar:71,72:"pbifnRangeCheckInt",pbifnRangeCheckInt:72,73:"pbifnRangeCheckGetCharAt",pbifnRangeCheckGetCharAt:73,74:"pbifnRangeCheckSetCharAt",pbifnRangeCheckSetCharAt:74,75:"pbifnRecordAssign",pbifnRecordAssign:75,76:"pbifnRecordClone",pbifnRecordClone:76,77:"pbifnRecordCreateType",pbifnRecordCreateType:77,78:"pbifnRecordEqual",pbifnRecordEqual:78,79:"pbifnRecordNew",pbifnRecordNew:79,80:"pbifnRTTIAddField",pbifnRTTIAddField:80,81:"pbifnRTTIAddFields",pbifnRTTIAddFields:81,82:"pbifnRTTIAddMethod",pbifnRTTIAddMethod:82,83:"pbifnRTTIAddProperty",pbifnRTTIAddProperty:83,84:"pbifnRTTIInherited",pbifnRTTIInherited:84,85:"pbifnRTTINewClass",pbifnRTTINewClass:85,86:"pbifnRTTINewClassRef",pbifnRTTINewClassRef:86,87:"pbifnRTTINewDynArray",pbifnRTTINewDynArray:87,88:"pbifnRTTINewEnum",pbifnRTTINewEnum:88,89:"pbifnRTTINewExtClass",pbifnRTTINewExtClass:89,90:"pbifnRTTINewInt",pbifnRTTINewInt:90,91:"pbifnRTTINewInterface",pbifnRTTINewInterface:91,92:"pbifnRTTINewMethodVar",pbifnRTTINewMethodVar:92,93:"pbifnRTTINewPointer",pbifnRTTINewPointer:93,94:"pbifnRTTINewProcSig",pbifnRTTINewProcSig:94,95:"pbifnRTTINewProcVar",pbifnRTTINewProcVar:95,96:"pbifnRTTINewRecord",pbifnRTTINewRecord:96,97:"pbifnRTTINewRefToProcVar",pbifnRTTINewRefToProcVar:97,98:"pbifnRTTINewSet",pbifnRTTINewSet:98,99:"pbifnRTTINewStaticArray",pbifnRTTINewStaticArray:99,100:"pbifnSetCharAt",pbifnSetCharAt:100,101:"pbifnSet_Clone",pbifnSet_Clone:101,102:"pbifnSet_Create",pbifnSet_Create:102,103:"pbifnSet_Difference",pbifnSet_Difference:103,104:"pbifnSet_Equal",pbifnSet_Equal:104,105:"pbifnSet_Exclude",pbifnSet_Exclude:105,106:"pbifnSet_GreaterEqual",pbifnSet_GreaterEqual:106,107:"pbifnSet_Include",pbifnSet_Include:107,108:"pbifnSet_Intersect",pbifnSet_Intersect:108,109:"pbifnSet_LowerEqual",pbifnSet_LowerEqual:109,110:"pbifnSet_NotEqual",pbifnSet_NotEqual:110,111:"pbifnSet_Reference",pbifnSet_Reference:111,112:"pbifnSet_SymDiffSet",pbifnSet_SymDiffSet:112,113:"pbifnSet_Union",pbifnSet_Union:113,114:"pbifnSpaceLeft",pbifnSpaceLeft:114,115:"pbifnStringSetLength",pbifnStringSetLength:115,116:"pbifnTrunc",pbifnTrunc:116,117:"pbifnUnitInit",pbifnUnitInit:117,118:"pbivnExceptObject",pbivnExceptObject:118,119:"pbivnIntfExprRefs",pbivnIntfExprRefs:119,120:"pbivnIntfGUID",pbivnIntfGUID:120,121:"pbivnIntfKind",pbivnIntfKind:121,122:"pbivnIntfMaps",pbivnIntfMaps:122,123:"pbivnIntfRefCnt",pbivnIntfRefCnt:123,124:"pbivnImplementation",pbivnImplementation:124,125:"pbivnImplCode",pbivnImplCode:125,126:"pbivnMessageInt",pbivnMessageInt:126,127:"pbivnMessageStr",pbivnMessageStr:127,128:"pbivnLibrary",pbivnLibrary:128,129:"pbivnLibraryVars",pbivnLibraryVars:129,130:"pbivnLocalModuleRef",pbivnLocalModuleRef:130,131:"pbivnLocalProcRef",pbivnLocalProcRef:131,132:"pbivnLocalTypeRef",pbivnLocalTypeRef:132,133:"pbivnLoop",pbivnLoop:133,134:"pbivnLoopEnd",pbivnLoopEnd:134,135:"pbivnLoopIn",pbivnLoopIn:135,136:"pbivnModule",pbivnModule:136,137:"pbivnModules",pbivnModules:137,138:"pbivnPtrClass",pbivnPtrClass:138,139:"pbivnPtrRecord",pbivnPtrRecord:139,140:"pbivnProcOk",pbivnProcOk:140,141:"pbivnProgram",pbivnProgram:141,142:"pbivnResourceStrings",pbivnResourceStrings:142,143:"pbivnResourceStringOrig",pbivnResourceStringOrig:143,144:"pbivnRTL",pbivnRTL:144,145:"pbivnRTTI",pbivnRTTI:145,146:"pbivnRTTIArray_Dims",pbivnRTTIArray_Dims:146,147:"pbivnRTTIArray_ElType",pbivnRTTIArray_ElType:147,148:"pbivnRTTIClassRef_InstanceType",pbivnRTTIClassRef_InstanceType:148,149:"pbivnRTTIEnum_EnumType",pbivnRTTIEnum_EnumType:149,150:"pbivnRTTIInt_MaxValue",pbivnRTTIInt_MaxValue:150,151:"pbivnRTTIInt_MinValue",pbivnRTTIInt_MinValue:151,152:"pbivnRTTIInt_OrdType",pbivnRTTIInt_OrdType:152,153:"pbivnRTTILocal",pbivnRTTILocal:153,154:"pbivnRTTIMemberAttributes",pbivnRTTIMemberAttributes:154,155:"pbivnRTTIMethodKind",pbivnRTTIMethodKind:155,156:"pbivnRTTIPointer_RefType",pbivnRTTIPointer_RefType:156,157:"pbivnRTTIProcFlags",pbivnRTTIProcFlags:157,158:"pbivnRTTIProc_InitSpec",pbivnRTTIProc_InitSpec:158,159:"pbivnRTTIProcVar_ProcSig",pbivnRTTIProcVar_ProcSig:159,160:"pbivnRTTIPropDefault",pbivnRTTIPropDefault:160,161:"pbivnRTTIPropIndex",pbivnRTTIPropIndex:161,162:"pbivnRTTIPropStored",pbivnRTTIPropStored:162,163:"pbivnRTTISet_CompType",pbivnRTTISet_CompType:163,164:"pbivnRTTITypeAttributes",pbivnRTTITypeAttributes:164,165:"pbivnRTTIExtClass_Ancestor",pbivnRTTIExtClass_Ancestor:165,166:"pbivnRTTIExtClass_JSClass",pbivnRTTIExtClass_JSClass:166,167:"pbivnSelf",pbivnSelf:167,168:"pbivnTObjectDestroy",pbivnTObjectDestroy:168,169:"pbivnWith",pbivnWith:169,170:"pbitnAnonymousPostfix",pbitnAnonymousPostfix:170,171:"pbitnIntDouble",pbitnIntDouble:171,172:"pbitnTI",pbitnTI:172,173:"pbitnTIClass",pbitnTIClass:173,174:"pbitnTIClassRef",pbitnTIClassRef:174,175:"pbitnTIDynArray",pbitnTIDynArray:175,176:"pbitnTIEnum",pbitnTIEnum:176,177:"pbitnTIExtClass",pbitnTIExtClass:177,178:"pbitnTIHelper",pbitnTIHelper:178,179:"pbitnTIInteger",pbitnTIInteger:179,180:"pbitnTIInterface",pbitnTIInterface:180,181:"pbitnTIMethodVar",pbitnTIMethodVar:181,182:"pbitnTIPointer",pbitnTIPointer:182,183:"pbitnTIProcVar",pbitnTIProcVar:183,184:"pbitnTIRecord",pbitnTIRecord:184,185:"pbitnTIRefToProcVar",pbitnTIRefToProcVar:185,186:"pbitnTISet",pbitnTISet:186,187:"pbitnTIStaticArray",pbitnTIStaticArray:187,188:"pbitnUIntDouble",pbitnUIntDouble:188},this.Pas2JSBuiltInNames=["arrayConcat","arrayConcatN","arrayCopy","arrayDeleteR","arrayEq","arrayInsert","arrayManaged","length","arrayPush","arrayPushN","arrayRef","arraySetLength","$clone","as","asExt","lw","and","or","shl","shr","xor","checkMethodCall","checkVersion","$ancestorfunc","$destroy","$create","$initSpec","createClass","createClassExt","createHelper","getChar","getNumber","getObject","getResStr","$new","_AddRef","_Release","addIntf","intfAsClass","intfAsIntfT","createInterface","createTGUID","ref","createIntfRefs","free","getIntfGUIDR","getIntfT","guidrToStr","intfIsClass","intfIsIntfT","intfToClass","setIntfL","setIntfP","strToGUIDR","queryIntfIsT","queryIntfT","is","isExt","floatToStr","valEnum","freeLoc","free","$main","oc","createCallback","createSafeCallback","eqCallback","$main","raiseE","rcArrR","rcArrW","rcc","rc","rcCharAt","rcSetCharAt","$assign","$clone","recNewT","$eq","$new","addField","addFields","addMethod","addProperty","$inherited","$Class","$ClassRef","$DynArray","$Enum","$ExtClass","$Int","$Interface","$MethodVar","$Pointer","newTIProcSig","$ProcVar","$Record","$RefToProcVar","$Set","$StaticArray","setCharAt","cloneSet","createSet","diffSet","eqSet","excludeSet","geSet","includeSet","intersectSet","leSet","neSet","refSet","symDiffSet","unionSet","spaceLeft","strSetLength","trunc","$init","$e","$ir","$guid","$kind","$intfmaps","R","$impl","$implcode","$msgint","$msgstr","library","vars","$lm","$lp","$lt","$l","$end","$in","$mod","pas","$class","$record","$ok","program","$resourcestrings","org","rtl","$rtti","dims","eltype","instancetype","enumtype","maxvalue","minvalue","ordtype","$r","attr","methodkind","reftype","flags","init","procsig","Default","index","stored","comptype","attr","ancestor","jsclass","$Self","tObjectDestroy","$with","$a","NativeInt","tTypeInfo","tTypeInfoClass","tTypeInfoClassRef","tTypeInfoDynArray","tTypeInfoEnum","tTypeInfoExtClass","tTypeInfoHelper","tTypeInfoInteger","tTypeInfoInterface","tTypeInfoMethodVar","tTypeInfoPointer","tTypeInfoProcVar","tTypeInfoRecord","tTypeInfoRefToProcVar","tTypeInfoSet","tTypeInfoStaticArray","NativeUInt"],this.JSReservedWords=["__extends","_super","anonymous","apply","array","await","bind","break","call","case","catch","class","constructor","continue","default","delete","do","each","else","enum","escape","eval","export","extends","false","for","function","getPrototypeOf","hasOwnProperty","if","implements","import","in","instanceof","interface","isPrototypeOf","let","new","null","package","private","propertyIsEnumerable","protected","prototype","public","return","static","super","switch","this","throw","toLocaleString","toString","true","try","undefined","var","while","with","yield"],this.JSReservedGlobalWords=["Array","ArrayBuffer","Boolean","DataView","Date","Error","EvalError","Float32Array","Float64Array","FormData","Generator","GeneratorFunction","Infinity","Int16Array","Int32Array","Int8Array","InternalError","JSON","Map","Math","NaN","Number","Object","Promise","Proxy","RangeError","ReferenceError","Reflect","RegExp","Set","String","Symbol","SyntaxError","TypeError","URIError","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray","WeakMap","WeakSet","arguments","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","isFinite","isNaN","parseFloat","parseInt","unescape","uneval","valueOf"],rtl.createClass(this,"EPas2JS",B,function(){s=this,this.$init=function(){B.$init.call(this),this.PasElement=null,this.MsgNumber=0,this.Args=[],this.Id=0,this.MsgType=0},this.$final=function(){this.PasElement=void 0,this.Args=void 0,B.$final.call(this)}}),this.TPasToJsPlatform={0:"PlatformBrowser",PlatformBrowser:0,1:"PlatformNodeJS",PlatformNodeJS:1,2:"PlatformElectron",PlatformElectron:2,3:"PlatformModule",PlatformModule:3},this.PasToJsPlatformNames=["Browser","NodeJS","Electron","Module"],this.TPasToJsProcessor={0:"ProcessorECMAScript5",ProcessorECMAScript5:0,1:"ProcessorECMAScript6",ProcessorECMAScript6:1},this.PasToJsProcessorNames=["ECMAScript5","ECMAScript6"],this.TPas2jsBaseType={0:"pbtNone",pbtNone:0,1:"pbtJSValue",pbtJSValue:1},this.Pas2jsBaseTypeNames=["None","JSValue"],this.TPas2jsBuiltInProc={0:"pbpDebugger",pbpDebugger:0,1:"pbpAWait",pbpAWait:1},this.Pas2jsBuiltInProcNames=["Debugger","AWait"],this.ClassVarModifiersType=rtl.createSet(4,5),this.LowJSBoolean=!1,this.HighJSBoolean=!0,rtl.createClass(this,"TPas2JsElementData",G,function(){this.$init=function(){G.$init.call(this),this.FElement=null,this.Owner=null,this.Next=null},this.$final=function(){this.FElement=void 0,this.Owner=void 0,this.Next=void 0,G.$final.call(this)},this.SetElement=function(e){var t=null;if(this.FElement!==e){if(null!==this.FElement){for(t=this.FElement;t.FData!==this;){if(!G.isPrototypeOf(t.FData))throw s.$create("Create$1",[""]);t=t.FData}t.FData=this.FData}if(this.FElement=e,null!==this.FElement){for(t=this.FElement;G.isPrototypeOf(t.FData);)t=t.FData;if(null!==t.FData)throw s.$create("Create$1",[""]);t.FData=this}}},this.Destroy=function(){this.SetElement(null),this.Next=null,this.Owner=null,V.Destroy.call(this)}}),rtl.createClass(this,"TPas2JSStoredLocalVar",G,function(){i=this,this.$init=function(){G.$init.call(this),this.Name="",this.Element=null},this.$final=function(){this.Element=void 0,G.$final.call(this)}}),this.TPas2JSModuleScopeFlag={0:"p2msfPromiseSearched",p2msfPromiseSearched:0},rtl.createClass(this,"TPas2JSModuleScope",J,function(){r=this,this.$init=function(){J.$init.call(this),this.FJSPromiseClass=null,this.FlagsJS={},this.SystemVarRecs=null,this.StoreJSLocalVars=[]},this.$final=function(){this.FJSPromiseClass=void 0,this.FlagsJS=void 0,this.SystemVarRecs=void 0,this.StoreJSLocalVars=void 0,J.$final.call(this)},this.SetJSPromiseClass=function(e){this.FJSPromiseClass!==e&&(this.FJSPromiseClass=e)},this.ClearStoreJSLocalVars=function(){for(var e=0,t=rtl.length(this.StoreJSLocalVars)-1;e<=t;e++)j({a:e,p:this.StoreJSLocalVars,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}});this.StoreJSLocalVars=[]},this.Destroy=function(){this.ClearStoreJSLocalVars(),this.SetJSPromiseClass(null),J.Destroy.call(this)}}),rtl.createClass(this,"TPas2jsElevatedLocals",V,function(){n=this,this.$init=function(){V.$init.call(this),this.FElevatedLocals=null},this.$final=function(){this.FElevatedLocals=void 0,V.$final.call(this)},this.InternalAdd=function(e){var t,s;s=H(e.Identifier),null!==(t=this.FElevatedLocals.Find(s))&&(e.NextSameIdentifier=t,this.FElevatedLocals.Remove(s)),this.FElevatedLocals.Add(s,e)},this.OnClear=function(e,t){for(var s=null;null!==e;)s=e,e=e.NextSameIdentifier,s=rtl.freeLoc(s)},this.Create$1=function(){return V.Create.call(this),this.FElevatedLocals=W.$create("Create$1"),this},this.Destroy=function(){this.FElevatedLocals.ForEachCall(rtl.createCallback(this,"OnClear"),null),this.FElevatedLocals=null,V.Destroy.call(this)},this.Find=function(e){return this.FElevatedLocals.Find(H(e))},this.Add=function(e,t){var s=null;return(s=Y.$create("Create")).Identifier=e,s.SetElement(t),this.InternalAdd(s),s}}),rtl.createClass(this,"TPas2JSPrecompiledJS",V,function(){l=this,this.$init=function(){V.$init.call(this),this.BodyJS="",this.EmptyJS=!1,this.GlobalJS=null,this.ShortRefs=null},this.$final=function(){this.GlobalJS=void 0,this.ShortRefs=void 0,V.$final.call(this)},this.AddShortRef=function(e){null===this.ShortRefs&&(this.ShortRefs=_.$create("Create")),this.ShortRefs.IndexOf(e)<0&&this.ShortRefs.Add(e)},this.Destroy=function(){j({p:this,get:function(){return this.p.GlobalJS},set:function(e){this.p.GlobalJS=e}}),j({p:this,get:function(){return this.p.ShortRefs},set:function(e){this.p.ShortRefs=e}}),V.Destroy.call(this)}}),rtl.createClass(this,"TPas2JSSectionScope",K,function(){a=this,this.$init=function(){K.$init.call(this),this.ElevatedLocals=null,this.Renamed=!1},this.$final=function(){this.ElevatedLocals=void 0,K.$final.call(this)},this.Create$1=function(){return K.Create$1.call(this),this.ElevatedLocals=n.$create("Create$1"),this},this.Destroy=function(){j({p:this,get:function(){return this.p.ElevatedLocals},set:function(e){this.p.ElevatedLocals=e}}),K.Destroy.call(this)}}),rtl.createClass(this,"TPas2JSInitialFinalizationScope",X,function(){o=this,this.$init=function(){X.$init.call(this),this.ImplJS=null},this.$final=function(){this.ImplJS=void 0,X.$final.call(this)},this.Destroy=function(){j({p:this,get:function(){return this.p.ImplJS},set:function(e){this.p.ImplJS=e}}),X.Destroy.call(this)}}),rtl.createClass(this,"TPas2JSClassScope",q,function(){h=this,this.$init=function(){q.$init.call(this),this.JSName="",this.NewInstanceFunction=null,this.GUID="",this.ElevatedLocals=null,this.MemberOverloadsRenamed=!1,this.DispatchField="",this.DispatchStrField="",this.MsgIntToProc=null,this.MsgStrToProc=null},this.$final=function(){this.NewInstanceFunction=void 0,this.ElevatedLocals=void 0,this.MsgIntToProc=void 0,this.MsgStrToProc=void 0,q.$final.call(this)},this.Create$1=function(){return Q.Create$1.call(this),this.ElevatedLocals=n.$create("Create$1"),this},this.Destroy=function(){j({p:this,get:function(){return this.p.ElevatedLocals},set:function(e){this.p.ElevatedLocals=e}}),j({p:this,get:function(){return this.p.MsgIntToProc},set:function(e){this.p.MsgIntToProc=e}}),j({p:this,get:function(){return this.p.MsgStrToProc},set:function(e){this.p.MsgStrToProc=e}}),q.Destroy.call(this)}}),rtl.createClass(this,"TPas2JSRecordScope",Z,function(){u=this,this.$init=function(){Z.$init.call(this),this.JSName="",this.MemberOverloadsRenamed=!1,this.Managed=!1}}),rtl.createClass(this,"TPas2JSProcedureScope",ee,function(){c=this,this.$init=function(){ee.$init.call(this),this.OverloadName="",this.JSName="",this.ResultVarName="",this.BodyOverloadsRenamed=!1,this.ImplJS=null},this.$final=function(){this.ImplJS=void 0,ee.$final.call(this)},this.AddGlobalJS=function(e){if(null===this.ImplJS)throw B.$create("Create$1",["[20201018120133] TPas2JSProcedureScope.AddGlobalJS"]);null===this.ImplJS.GlobalJS&&(this.ImplJS.GlobalJS=te.$create("Create$1")),this.ImplJS.GlobalJS.Add(e)},this.Destroy=function(){j({p:this,get:function(){return this.p.ImplJS},set:function(e){this.p.ImplJS=e}}),ee.Destroy.call(this)}}),rtl.createClass(this,"TPas2JSArrayScope",se,function(){p=this,this.$init=function(){se.$init.call(this),this.JSName="",this.Managed=!1}}),rtl.createClass(this,"TPas2JSProcTypeScope",ie,function(){f=this,this.$init=function(){ie.$init.call(this),this.JSName=""}}),rtl.createClass(this,"TPas2JSWithExprScope",re,function(){d=this,this.$init=function(){re.$init.call(this),this.WithVarName=""}}),rtl.createClass(this,"TPas2JSOverloadChgThisScope",Q,function(){F=this}),rtl.createClass(this,"TResElDataPas2JSBaseType",ne,function(){m=this,this.$init=function(){ne.$init.call(this),this.JSBaseType=0}}),this.msAllPas2jsModeSwitchesReadOnly=rtl.createSet(10,12,18,21,23,24,27,29,38,40,50,51),this.msAllPas2jsModeSwitches=rtl.unionSet(this.msAllPas2jsModeSwitchesReadOnly,rtl.createSet(3,2,15,20,25,34,52,39,44,47,53,45,49,54,55)),this.bsAllPas2jsBoolSwitchesReadOnly=rtl.createSet(7),this.bsAllPas2jsBoolSwitches=rtl.unionSet(this.bsAllPas2jsBoolSwitchesReadOnly,rtl.createSet(3,15,9,11,14,22,23,24,25,26,27)),this.vsAllPas2jsValueSwitchesReadOnly={},this.vsAllPas2jsValueSwitches=rtl.unionSet(this.vsAllPas2jsValueSwitchesReadOnly,rtl.createSet(0,1,2)),this.po_Pas2js=rtl.unionSet(U.po_Resolver,rtl.createSet(4,3,12,13,15,20)),this.btAllJSBaseTypes=rtl.createSet(5,6,7,9,11,14,15,16,17,18,19,20,21,22,25,26,27,28,29),this.bfAllJSBaseProcs=U.bfAllStandardProcs,this.btAllJSStrings=rtl.createSet(7,9),this.btAllJSChars=rtl.createSet(5,6),this.btAllJSStringAndChars=rtl.unionSet(this.btAllJSStrings,this.btAllJSChars),this.btAllJSFloats=rtl.createSet(11),this.btAllJSBooleans=rtl.createSet(15,16,17,18),this.btAllJSInteger=rtl.createSet(19,20,21,22,25,26,28,27,14),this.btAllJSValueSrcTypes=rtl.unionSet(rtl.unionSet(rtl.unionSet(rtl.unionSet(rtl.createSet(30,4,29,34),this.btAllJSInteger),this.btAllJSStringAndChars),this.btAllJSFloats),this.btAllJSBooleans),this.btAllJSValueTypeCastTo=rtl.unionSet(rtl.unionSet(rtl.unionSet(rtl.unionSet(this.btAllJSInteger,this.btAllJSStringAndChars),this.btAllJSFloats),this.btAllJSBooleans),rtl.createSet(29)),this.btAllJSRangeCheckTypes=rtl.unionSet(this.btAllJSInteger,this.btAllJSChars),this.btAllJSOverflowAddSubType=rtl.createSet(28,27,14),this.btAllJSOverflowMultType=rtl.createSet(25,26,28,27,14),this.DefaultPasResolverOptions=rtl.createSet(0,1,2,3,4,5,6,7,8),this.TPasToJsConverterOption={0:"coLowerCase",coLowerCase:0,1:"coSwitchStatement",coSwitchStatement:1,2:"coEnumNumbers",coEnumNumbers:2,3:"coUseStrict",coUseStrict:3,4:"coNoTypeInfo",coNoTypeInfo:4,5:"coEliminateDeadCode",coEliminateDeadCode:5,6:"coStoreImplJS",coStoreImplJS:6,7:"coRTLVersionCheckMain",coRTLVersionCheckMain:7,8:"coRTLVersionCheckSystem",coRTLVersionCheckSystem:8,9:"coRTLVersionCheckUnit",coRTLVersionCheckUnit:9,10:"coShortRefGlobals",coShortRefGlobals:10,11:"coObfuscateLocalIdentifiers",coObfuscateLocalIdentifiers:11},this.DefaultPasToJSOptions=rtl.createSet(0),rtl.createClass(this,"TPas2jsPasScanner",ae,function(){C=this,this.$init=function(){ae.$init.call(this),this.FCompilerVersion="",this.FResolver=null,this.FTargetPlatform=0,this.FTargetProcessor=0,this.GlobalConvOptsEnabled={},this.GlobalConvOptsDisabled={}},this.$final=function(){this.FResolver=void 0,this.GlobalConvOptsEnabled=void 0,this.GlobalConvOptsDisabled=void 0,ae.$final.call(this)},this.HandleInclude=function(t){var s=this,i=0;function r(e){var t=0,r="";if(i=4,""===e)e="''";else for(var n=e.length;n>=1;n--){t=n;var l=e.charAt(t-1);l>="\0"&&l<=""||""===l?(r="#"+oe(e.charCodeAt(t-1)),t>1&&(r="'"+r),t<e.length&&"#"!==e.charAt(t+1-1)&&(r+="'"),e=he(e,t-1)+r+ue(e,t+1,e.length)):(t===e.length&&(e+="'"),"'"===e.charAt(t-1)&&ce("'",{get:function(){return e},set:function(t){e=t}},t),1===t&&(e="'"+e))}s.SetCurTokenString(e)}var n=0,l=0,a=0,o=0,h=0,u=0,c=0,p=0,f=null;if(""!==t&&"%"===t.charAt(0)){if(t.length<3||"%"!==t.charAt(t.length-1))return r(""),this.DoLog$1(2,1028,rtl.getResStr(le,"SWarnIllegalCompilerDirectiveX"),pe(18,"$i "+t),!1),i;if(t.length>255)return r(""),this.DoLog$1(2,1028,rtl.getResStr(le,"SWarnIllegalCompilerDirectiveX"),pe(18,"$i "+ue(t,1,255)+"..."),!1),i;var d=H(t);if("%date%"===d)return fe(de(),{get:function(){return n},set:function(e){n=e}},{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}}),r(oe(n)+"/"+oe(l)+"/"+oe(a)),i;if("%time%"===d)return Fe(de(),{get:function(){return o},set:function(e){o=e}},{get:function(){return h},set:function(e){h=e}},{get:function(){return u},set:function(e){u=e}},{get:function(){return c},set:function(e){c=e}}),r(me("%2d:%2d:%2d",pe(0,o,0,h,0,u))),i;if("%pas2jstarget%"===d||"%fpctarget%"===d||"%pas2jstargetos%"===d||"%fpctargetos%"===d)return r(e.PasToJsPlatformNames[this.FTargetPlatform]),i;if("%pas2jstargetcpu%"===d||"%fpctargetcpu%"===d)return r(e.PasToJsProcessorNames[this.FTargetProcessor]),i;if("%pas2jsversion%"===d||"%fpcversion%"===d)return r(this.FCompilerVersion),i;if("%file%"===d)return r(this.FCurFilename),i;if("%filename%"===d)return r(Ce(this.FCurFilename)),i;if("%unit%"===d||"%module%"===d)return r(this.FCurModulename),i;if("%line%"===d)return r(oe(this.FCurRow)),i;if("%linenum%"===d)return function(e){i=6,s.SetCurTokenString(oe(e))}(this.FCurRow),i;if("%currentroutine%"===d){if(null!==this.FResolver)for(var F=this.FResolver.FScopeCount-1;F>=0;F--)if(p=F,f=this.FResolver.GetScopes(p),Se.isPrototypeOf(f.FElement)&&""!==f.FElement.FName)return r(f.FElement.FName),i;return r("<anonymous>"),i}return r(Te(ue(t,2,t.length-2))),i}return i=ae.HandleInclude.call(this,t)},this.DoHandleOptimization=function(e,t){var s=this;function i(e,i){var r=!1;r=!1;var n=H(t);""===n||"on"===n||"+"===n?r=!0:"off"===n||"-"===n?r=!1:s.Error$1(1032,rtl.getResStr(le,"SErrWrongSwitchToggle"),[]),i&&s.FSkipGlobalSwitches?s.DoLog$1(2,1029,rtl.getResStr(le,"SMisplacedGlobalCompilerSwitch"),[],!1):r?(s.GlobalConvOptsEnabled=rtl.includeSet(s.GlobalConvOptsEnabled,e),s.GlobalConvOptsDisabled=rtl.excludeSet(s.GlobalConvOptsDisabled,e)):(s.GlobalConvOptsDisabled=rtl.includeSet(s.GlobalConvOptsDisabled,e),s.GlobalConvOptsEnabled=rtl.excludeSet(s.GlobalConvOptsEnabled,e))}var r=H(e);"enumnumbers"===r?i(2,!0):"usestrict"===r?i(3,!0):"jsshortrefglobals"===r?i(10,!0):"jsobfuscatelocalidentifiers"===r?i(11,!0):this.DoLog$1(2,1028,rtl.getResStr(le,"SWarnIllegalCompilerDirectiveX"),pe(18,"optimization "+e),!1)},this.ReadNonPascalTillEndToken=function(e){var s=this,i=0,r=0,n=0,l="",a=0;function o(){s.FTokenPos=n}function h(){var e;0===(e=n-r)?s.SetCurTokenString(""):(s.SetCurTokenString(s.GetTokenString()+ue(s.FCurLine,r,e)),r=n)}function u(){return h(),e?(i=118,o(),s.SetCurToken(118),s.FetchLine(),!0):s.FetchLine()?(l=s.FCurLine,a=l.length,r=n=1,false):(i=0,s.SetCurToken(0),!0)}function c(){(n+=1)<=a&&l.charAt(n-1)>""&&(n+=1)}for(this.SetCurTokenString(""),l=this.FCurLine,a=l.length,n=this.FTokenPos,r=n;;){if(n>a&&u())return i;var p=l.charAt(n-1);if("\\"===p)c();else if("'"===p)for(n+=1;;){n>a&&this.Error(1002,rtl.getResStr(le,"SErrOpenString"));var f=l.charAt(n-1);if("\\"===f)c();else{if("'"===f){n+=1;break}if("\n"===f||"\r"===f)break;n+=1}}else if('"'===p)for(n+=1;;){n>a&&this.Error(1002,rtl.getResStr(le,"SErrOpenString"));var d=l.charAt(n-1);if("\\"===d)c();else{if('"'===d){n+=1;break}if("\n"===d||"\r"===d)break;n+=1}}else if("`"===p)for(n+=1;;){for(;n>a;)if(u())return e||this.Error(1002,rtl.getResStr(le,"SErrOpenString")),i;var F=l.charAt(n-1);if("\\"===F)c();else{if("`"===F){n+=1;break}n+=1}}else if("/"===p){if((n+=1)<=a&&"/"===l.charAt(n-1))do{n+=1}while(!(n>a||l.charCodeAt(n-1)in rtl.createSet(10,13)))}else if(p>="0"&&p<="9"||p>="A"&&p<="Z"||p>="a"&&p<="z"||"_"===p){if(0===ye(ue(l,n,3),"end")&&(n+3>a||!(l.charCodeAt(n+3-1)in t.IdentChars)))return h(),""!==this.GetTokenString()?(i=1,o(),this.SetCurToken(i),i):(i=58,this.SetCurTokenString(ue(l,n,3)),n+=3,o(),this.SetCurToken(i),i);for(;n<=a&&l.charCodeAt(n-1)in t.IdentChars;)n+=1}else n+=1}return i}}),rtl.createClass(this,"TPas2JSResolverHub",ge,function(){S=this,this.$init=function(){ge.$init.call(this),this.FJSDelaySpecialize=null},this.$final=function(){this.FJSDelaySpecialize=void 0,ge.$final.call(this)},this.GetJSDelaySpecializes=function(e){return rtl.getObject(this.FJSDelaySpecialize.Get(e))},this.Create$1=function(e){return ge.Create$1.call(this,e),this.FJSDelaySpecialize=_.$create("Create"),this},this.Destroy=function(){j({p:this,get:function(){return this.p.FJSDelaySpecialize},set:function(e){this.p.FJSDelaySpecialize=e}}),V.Destroy.call(this)},this.Reset=function(){ge.Reset.call(this),this.FJSDelaySpecialize.Clear()},this.AddJSDelaySpecialize=function(e){if(this.FJSDelaySpecialize.IndexOf(e)>=0)throw s.$create("Create$1",["TPas2JSResolverHub.AddJSDelaySpecialize "+Pe(e)]);this.FJSDelaySpecialize.Add(e)},this.JSDelaySpecializeCount=function(){return this.FJSDelaySpecialize.FCount}}),rtl.createClass(this,"TPas2JSResolver",Ie,function(){T=this,rtl.recNewT(this,"THasAnoFuncData",function(){y=this,this.Expr=null,this.$eq=function(e){return this.Expr===e.Expr},this.$assign=function(e){return this.Expr=e.Expr,this}}),rtl.recNewT(this,"THasElReadingDeclData",function(){g=this,this.Decl=null,this.El=null,this.$eq=function(e){return this.Decl===e.Decl&&this.El===e.El},this.$assign=function(e){return this.Decl=e.Decl,this.El=e.El,this}}),rtl.recNewT(this,"TPRFindExtSystemClass",function(){E=this,this.JSName="",this.ErrorPosEl=null,this.Found=null,this.ElScope=null,this.StartScope=null,this.$eq=function(e){return this.JSName===e.JSName&&this.ErrorPosEl===e.ErrorPosEl&&this.Found===e.Found&&this.ElScope===e.ElScope&&this.StartScope===e.StartScope},this.$assign=function(e){return this.JSName=e.JSName,this.ErrorPosEl=e.ErrorPosEl,this.Found=e.Found,this.ElScope=e.ElScope,this.StartScope=e.StartScope,this}}),this.cJSValueConversion=2e4,this.$init=function(){Ie.$init.call(this),this.FJSBaseTypes=rtl.arraySetLength(null,null,2),this.FJSBuiltInProcs=rtl.arraySetLength(null,null,2),this.FExternalNames=null,this.FFirstElementData=null,this.FLastElementData=null,this.FOverloadScopes=null},this.$final=function(){this.FJSBaseTypes=void 0,this.FJSBuiltInProcs=void 0,this.FExternalNames=void 0,this.FFirstElementData=void 0,this.FLastElementData=void 0,this.FOverloadScopes=void 0,Ie.$final.call(this)},this.InternalAdd=function(e){var t,s;s=e.Identifier,null!==(t=this.FExternalNames.Find(s))&&(e.NextSameIdentifier=t,this.FExternalNames.Remove(s)),this.FExternalNames.Add(s,e)},this.OnClearHashItem=function(e,t){for(var s=null;null!==e;)s=e,e=e.NextSameIdentifier,s=rtl.freeLoc(s)},this.OnHasAnonymousEl=function(e,t){null!==e&&null===t.Expr&&e.$class.ClassType()===Re&&(t.Expr=e)},this.OnHasElReadingDecl=function(e,t){var s=null;null===t.El&&ve.isPrototypeOf(e.FData)&&(s=e.FData).FDeclaration===t.Decl&&s.Access in U.rraAllRead&&(t.El=e)},this.OnFindExtSystemClass=function(e,t,s,i,r){var n;null===i.Found&&Ae.isPrototypeOf(e)&&(n=e).IsExternal&&(Ne.isPrototypeOf(n.FParent)||n.ExternalName===i.JSName&&(i.Found=n,i.ElScope=t,i.StartScope=s,r.set(!0)))},this.HasOverloadIndex=function(e,t){var s=null,i=null;if((s=e.$class.ClassType())===xe)return!1;if(s===be||s.InheritsFrom(Oe)){if(!t&&ke.isPrototypeOf(e.FParent))return!1;if(s===Ae&&e.IsForward)return!1}else if(s.InheritsFrom(Se)){if(e.IsOverride())return!0;if(4===e.Visibility)return!1;if(null!==(i=e.FData).DeclarationProc)return!1;if(null!==i.SpecializedFromItem)return!1}return true},this.GetOverloadIndex=function(e,t){var s=0,i=null;for(s=0;null!==e;)i=e.FElement,e=e.NextSameIdentifier,i===t?s=0:this.HasOverloadIndex(i,!1)&&(s+=1);return s},this.GetOverloadAt=function(e,t){var s=null,i=null,r=null,n=0;if(null===e)return null;for(n=0,r=e;null!==r;)i=r.FElement,r=r.NextSameIdentifier,this.HasOverloadIndex(i,!1)&&(n+=1);if(n<=t.get())return t.set(t.get()-1),null;for(r=e;null!==r;){if(this.HasOverloadIndex(r.FElement,!1)&&(n-=1,t.get()===n))return t.set(0),s=r;r=r.NextSameIdentifier}return s},this.GetOverloadIndex$1=function(e){var t,s=0,i=0,r=0,n=null,l=null,a=null,o=!1,h=null;if(s=0,!this.HasOverloadIndex(e,!0))return s;o=!1;for(var u=t=this.FOverloadScopes.FCount-1;u>=0;u--)if(i=u,(l=rtl.getObject(this.FOverloadScopes.Get(i))).$class.ClassType()!==F){if(i<t&&null!==(h=this.GetElevatedLocals(l))){for(n=h.Find(e.FName),r=0;null!==n;)a=n.FElement,n=n.NextSameIdentifier,a===e?r=0:r+=1;s+=r}o||(n=l.FindLocalIdentifier(e.FName),s+=this.GetOverloadIndex(n,e))}else o=!0;return o?s:(n=this.FindExternalName(e.FName),s+=this.GetOverloadIndex(n,e))},this.GetOverloadAt$1=function(e,t){var s,i=null,r=0,n=null,l=!1,a=null;i=null,l=!1;for(var o=s=this.FOverloadScopes.FCount-1;o>=0;o--)if(r=o,(n=rtl.getObject(this.FOverloadScopes.Get(r))).$class.ClassType()!==F){if(r<s&&null!==(a=this.GetElevatedLocals(n))&&(i=a.Find(e),null!==(i=this.GetOverloadAt(i,{get:function(){return t},set:function(e){t=e}}))))return i;if(!l&&(i=n.FindLocalIdentifier(e),null!==(i=this.GetOverloadAt(i,{get:function(){return t},set:function(e){t=e}}))))return i}else l=!0;return l?i:(i=this.FindExternalName(e),i=this.GetOverloadAt(i,{get:function(){return t},set:function(e){t=e}}))},this.GetElevatedLocals=function(e){var t;return(t=e.$class.ClassType())===a||t===h?e.ElevatedLocals:null},this.RenameOverload=function(t){var s,i=this,r=!1;function n(){return i.GetOverloadAt$1(t.FName,0).FElement}var l="",a=null,o=null;return 0===(s=this.GetOverloadIndex$1(t))?r=!1:(t.$class.ClassType()===$e&&t.FParent.$class.ClassType()===Ae&&t.FParent.FData.NewInstanceFunction===t&&(a=n(),this.RaiseMsg(20170324234324,4019,rtl.getResStr(e,"sNewInstanceFunctionMustNotHaveOverloadAtX"),pe(18,this.GetElementSourcePosStr(a)),t)),4===t.Visibility&&(a=n(),this.RaiseMsg(20170413220924,3009,rtl.getResStr(Ee,"sDuplicateIdentifier"),pe(18,a.FName,18,this.GetElementSourcePosStr(a)),t)),l=t.FName+"$"+oe(s),c.isPrototypeOf(t.FData)?((o=t.FData).OverloadName=l,null!==o.DeclarationProc&&this.RaiseInternalError(20180322233222,De(t)),null!==o.ImplProc&&(o.ImplProc.FData.OverloadName=l),null!==o.SpecializedFromItem&&this.RenameSpecialized(o.SpecializedFromItem)):t.FName=l,r=!0),r},this.RenameOverloadsInSection=function(e){var t,s=null,i=null;null!==e&&((i=rtl.as(e.FData,a)).Renamed&&this.RaiseNotYetImplemented(20200601231236,e,""),s=null,t=this.FOverloadScopes.FCount,e.$class.ClassType()===Le&&(s=this.FRootElement.InterfaceSection,this.PushOverloadScope(rtl.as(s.FData,Q))),this.PushOverloadScope(rtl.as(e.FData,Q)),this.RenameOverloads(e,e.Declarations),this.RenameSubOverloads(e.Declarations),this.RestoreOverloadScopeLvl(t),i.Renamed=!0)},this.RenameOverloads=function(e,t){for(var s=0,i=null,r=null,n=null,l=null,a=null,o=null,h=0,u=t.FCount-1;h<=u;h++)if(s=h,(o=(i=rtl.getObject(t.Get(s))).$class.ClassType()).InheritsFrom(Se)){if(r=i,null!==(n=rtl.as(r.FData,c)).DeclarationProc)continue;if(r.IsOverride()){null===n.OverriddenProc&&this.RaiseInternalError(20171205183502,""),""!==(l=n.OverriddenProc.FData).OverloadName&&(n.OverloadName=l.OverloadName,null!==n.ImplProc&&((a=n.ImplProc.FData).OverloadName=n.OverloadName,a.JSName=n.JSName));continue}if(r.IsExternal())continue;this.RenameOverload(r)}else o.InheritsFrom(Oe)?ke.isPrototypeOf(i.FParent)&&this.RenameOverload(i):(o===be||o.InheritsFrom(Be)&&i.FParent.$class.ClassType()===Ae)&&this.RenameOverload(i)},this.RenameSubOverloads=function(e){for(var t=0,s=0,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=0,p=e.FCount-1;u<=p;u++)t=u,(o=(i=rtl.getObject(e.Get(t))).$class.ClassType()).InheritsFrom(Se)?(r=i,null!==(n=(l=rtl.as(r.FData,c)).ImplProc)?a=n.FData:(n=r,a=l),null===(h=n.Body)||a.BodyOverloadsRenamed||(a.BodyOverloadsRenamed=!0,s=this.FOverloadScopes.FCount,null===a.ClassRecScope||Ne.isPrototypeOf(r.FParent)||this.PushOverloadClassOrRecScopes(a.ClassRecScope,!0),this.PushOverloadScope(a),this.RenameOverloads(h,h.Declarations),this.RenameSubOverloads(h.Declarations),this.PopOverloadScope(),this.RestoreOverloadScopeLvl(s))):o!==Ae&&o!==Me||this.RenameMembers(i)},this.RenameMembers=function(e){var t,s=null,i=null,r=null;if(t=this.FOverloadScopes.FCount,e.$class.ClassType()===Ae){if(e.IsForward)return;if((r=rtl.as(e.FData,h)).MemberOverloadsRenamed)return;r.MemberOverloadsRenamed=!0,s=r}else{if((i=rtl.as(e.FData,u)).MemberOverloadsRenamed)return;i.MemberOverloadsRenamed=!0,s=i}this.PushOverloadClassOrRecScopes(s,!1),this.RenameOverloads(e,e.Members),this.RenameSubOverloads(e.Members),this.RestoreOverloadScopeLvl(t)},this.RenameSpecialized=function(e){var t,s=null;null!==e&&(t=e.GenericEl.FName+"$G"+oe(e.Index+1),s=e.FSpecializedEl.FData,h.isPrototypeOf(s)||u.isPrototypeOf(s)||p.isPrototypeOf(s)||f.isPrototypeOf(s)?s.JSName=t:c.isPrototypeOf(s)||this.RaiseNotYetImplemented(20200906203342,e.FSpecializedEl,Ge(s)))},this.PushOverloadScopeSkip=function(){this.FOverloadScopes.Add(F.$create("Create$1"))},this.PushOverloadScope=function(e){this.FOverloadScopes.FCount>0&&rtl.getObject(this.FOverloadScopes.Get(this.FOverloadScopes.FCount-1))===e&&this.RaiseNotYetImplemented(20200602000045,e.FElement,""),this.FOverloadScopes.Add(e)},this.PushOverloadClassOrRecScopes=function(e,t){var s,i=null,r=null;for(s=this.FOverloadScopes.FCount;;){this.PushOverloadScopeSkip(),i=e;do{if(this.PushOverloadScope(i),!h.isPrototypeOf(i))break;i=i.AncestorScope}while(null!==i);if(!t)return s;if(r=e.FElement.FParent,!Ne.isPrototypeOf(r))return s;e=rtl.as(r.FData,we)}return s},this.PopOverloadScope=function(){var e,t=null;(e=this.FOverloadScopes.FCount-1)<0&&this.RaiseInternalError(20200723125456,""),(t=rtl.getObject(this.FOverloadScopes.Get(e))).$class.ClassType()===F&&(t=rtl.freeLoc(t)),this.FOverloadScopes.Delete(e)},this.RestoreOverloadScopeLvl=function(e){for(;this.FOverloadScopes.FCount>e;)this.PopOverloadScope()},this.ClearOverloadScopes=function(){if(null!==this.FOverloadScopes){for(;this.FOverloadScopes.FCount>0;)this.PopOverloadScope();j({p:this,get:function(){return this.p.FOverloadScopes},set:function(e){this.p.FOverloadScopes=e}})}},this.AddType=function(e){Ie.AddType.call(this,e),ke.isPrototypeOf(e.FParent)&&this.AddElevatedLocal(e)},this.AddRecordType=function(e,t){Ie.AddRecordType.apply(this,arguments),""===e.FName&&e.FParent.$class.ClassType()!==Ve&&this.RaiseNotYetImplemented(20190408224556,e,"anonymous record type"),ke.isPrototypeOf(e.FParent)&&this.AddElevatedLocal(e)},this.AddRecordVariant=function(t){this.RaiseMsg(20220323145350,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"variant record"),t)},this.AddClassType=function(e,t){Ie.AddClassType.call(this,e,t)},this.AddEnumType=function(e){Ie.AddEnumType.call(this,e),ke.isPrototypeOf(e.FParent)&&this.AddElevatedLocal(e)},this.ResolveImplAsm=function(e){e.FTokens},this.ResolveNameExpr=function(t,s,i){var r=this;var n=null;Ie.ResolveNameExpr.call(this,t,s,i),ve.isPrototypeOf(t.FData)&&(n=t.FData,0===ye(s,"free")?function(s){var i=null,n=null,l=Ue.$new(),a=null,o=null;if(r.IsTObjectFreeMethod(t)){if(null!==s.WithExprScope){if(null!==r.GetNewInstanceExpr(s.WithExprScope.Expr))return;r.RaiseMsg(20170517092407,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t)}if((o=t.FParent.$class.ClassType())===Je){if((i=t.FParent).Right===t&&27===i.OpCode||r.RaiseMsg(20170516151950,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t),1 in s.Flags||(je.isPrototypeOf(i.FParent)?He.isPrototypeOf(i.FParent.FParent)&&r.RaiseMsg(20170516161345,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t):We.isPrototypeOf(i.FParent)||r.RaiseMsg(20170516160347,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t)),n=i.Left,r.ComputeElement(n,l,{},null),0 in l.Flags||r.RaiseMsg(20170516152300,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t),1 in l.Flags||r.RaiseMsg(20170516152307,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t),null===(a=l.IdentEl)&&r.RaiseMsg(20170516152401,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t),a.$class.ClassType()===Ye)return;if(a.$class.ClassType()===Be||a.$class.ClassType()===be)return;if(a.$class.ClassType()===ze&&_e.isPrototypeOf(n))return;r.RaiseMsg(20170516152455,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t)}else if(o.InheritsFrom(Ke))return;r.RaiseMsg(20170516152454,4023,rtl.getResStr(e,"sFreeNeedsVar"),[],t)}}(n):ze.isPrototypeOf(n.FDeclaration)?function(e){var s=null,i=0,n=null,l=null,a=null;for(i=0,s=t,l=null;null!==s;){if(Se.isPrototypeOf(s)&&Xe.isPrototypeOf(s.ProcType)&&(i+=1,c.isPrototypeOf(s.FData)||r.RaiseInternalError(20181210231858,""),n=s.FData,a=qe.isPrototypeOf(n.DeclarationProc)?n.DeclarationProc.ProcType:s.ProcType,1===i)){if(a.ResultEl===e.FDeclaration)return;if(""!==n.ResultVarName)return;l=n}s=s.FParent}i<2&&r.RaiseNotYetImplemented(20171003112020,t,""),l.ResultVarName=U.ResolverResultVar+"$"+oe(i-1)}(n):this.IsExternalClassConstructor(n.FDeclaration)&&this.CheckExternalClassConstructor(n))},this.ResolveFuncParamsExpr=function(e,t){var s,i=null;Ie.ResolveFuncParamsExpr.call(this,e,t),s=e.Value,ve.isPrototypeOf(s.FData)&&(i=s.FData,this.IsExternalClassConstructor(i.FDeclaration)&&this.CheckExternalClassConstructor(i))},this.FinishInterfaceSection=function(e){Ie.FinishInterfaceSection.call(this,e),null===this.FOverloadScopes&&(this.FOverloadScopes=_.$create("Create"),this.RenameOverloadsInSection(e))},this.FinishTypeSectionEl=function(t){Ie.FinishTypeSectionEl.call(this,t),t.$class.ClassType()===Qe&&(this.ResolveAliasType(t.DestType,!0).$class.ClassType()===Me||this.RaiseMsg(20180423105726,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"pointer of "+t.DestType.FName),t))},this.FinishModule=function(e){var t=null;Ie.FinishModule.call(this,e),null===this.FOverloadScopes&&(this.FOverloadScopes=_.$create("Create"));try{(t=e.$class.ClassType())===Ze?this.RenameOverloadsInSection(e.ImplementationSection):t===et?this.RenameOverloadsInSection(e.ProgramSection):e.$class.ClassType()===tt?this.RenameOverloadsInSection(e.LibrarySection):this.RaiseNotYetImplemented(20170221000032,e,"")}finally{this.ClearOverloadScopes()}},this.FinishEnumType=function(e){var t=0,s=null;Ie.FinishEnumType.call(this,e);for(var i=0,r=e.Values.FCount-1;i<=r;i++)t=i,null!==(s=rtl.getObject(e.Values.Get(t))).Value&&this.RaiseNotYetImplemented(20180126202434,s,"enum const")},this.FinishSetType=function(t){var s,i=null,r=null;if(Ie.FinishSetType.call(this,t),(s=(i=this.ResolveAliasType(t.EnumType,!0)).$class.ClassType())!==st){if(s===it){if(ne.isPrototypeOf(i.FData)){if(i.FData.BaseType in rtl.createSet(15,19,20,22,21,5,6))return;this.RaiseMsg(2017111015e4,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"set of "+i.FName),t)}}else if(s===rt){r=this.Eval(i.RangeExpr,rtl.createSet(0),!0);try{if(10===r.Kind)return void(r.RangeEnd-r.RangeStart>65535&&this.RaiseMsg(20171110150159,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"set of "+i.FName),t));this.RaiseMsg(20171110145211,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"set of "+i.FName),t)}finally{nt({get:function(){return r},set:function(e){r=e}})}}this.RaiseMsg(20170415182320,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"set of "+i.FName),t)}},this.FinishRecordType=function(e){null!==e.Variants&&e.Variants.FCount>0&&this.RaiseMsg(20180104205309,3081,rtl.getResStr(Ee,"sXIsNotSupported"),pe(18,"variant record"),rtl.getObject(e.Variants.Get(0))),Ie.FinishRecordType.call(this,e)},this.FinishClassType=function(t){var s=null,i=null,r=null;if(Ie.FinishClassType.call(this,t),t.IsExternal&&(""===t.ExternalName&&this.RaiseMsg(20170321151109,4012,rtl.getResStr(e,"sMissingExternalName"),[],t),this.AddExternalPath(t.ExternalName,t),rtl.neSet(t.RTTIVisibility.Fields,{})&&this.RaiseNotYetImplemented(20250103153804,t,"RTTI for external class"),rtl.neSet(t.RTTIVisibility.Methods,{})&&this.RaiseNotYetImplemented(20250103153905,t,"RTTI for external class"),rtl.neSet(t.RTTIVisibility.Properties,{})&&this.RaiseNotYetImplemented(20250103153913,t,"RTTI for external class")),t.IsPacked()&&this.RaiseMsg(20180326155616,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"packed"),t),!t.IsForward){if(s=rtl.as(t.FData,h),2===t.ObjKind){if(t.InterfaceType in rtl.createSet(0,1)||this.RaiseMsg(20180326155612,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,M.InterfaceTypeNames[t.InterfaceType]),t),null!==t.GUIDExpr){r=this.Eval(t.GUIDExpr,rtl.createSet(0),!0);try{8===r.Kind?s.GUID=r.S:this.RaiseXExpectedButYFound(20180326160602,"string literal",t.GUIDExpr.ElementTypeName(),t.GUIDExpr)}finally{nt({get:function(){return r},set:function(e){r=e}})}}else s.GUID=this.GenerateGUID(t);for(i=s;;){if(null===(i=i.AncestorScope))break;lt(i.GUID,s.GUID)&&this.RaiseMsg(20180330232206,4024,rtl.getResStr(e,"sDuplicateGUIDXInYZ"),pe(18,s.GUID,18,t.FName,18,i.FElement.FName),t)}}j({p:s,get:function(){return this.p.MsgIntToProc},set:function(e){this.p.MsgIntToProc=e}}),j({p:s,get:function(){return this.p.MsgStrToProc},set:function(e){this.p.MsgStrToProc=e}})}},this.FinishArrayType=function(t){var s;Ie.FinishArrayType.call(this,t),s=this.ResolveAliasType(t.ElType,!0),this.IsManagedJSType(s)&&(rtl.length(t.Ranges)>0&&this.RaiseMsg(20250623180523,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"static array of COM-interface"),t),null===t.FData&&this.CreateScope(t,this.FScopeClass_Array),rtl.as(t.FData,p).Managed=!0)},this.FinishAncestors=function(t){var s=null,i=0,r=0,n=null,l=null,a=null,o=null;if(Ie.FinishAncestors.call(this,t),Me.isPrototypeOf(t.FParent)&&(t.ObjKind in rtl.unionSet(rtl.createSet(1),M.okAllHelpers)||this.RaiseNotYetImplemented(20190105143752,t,at(t)+" inside record")),null!==(n=t.FData)){n.DispatchField=this.FCurrentParser.FScanner.GetCurrentValueSwitch(1),n.DispatchStrField=this.FCurrentParser.FScanner.GetCurrentValueSwitch(2),s=t.Interfaces,o=te.$create("Create$1");try{for(var h=0,u=s.FCount-1;h<=u;h++)i=h,a=rtl.getObject(s.Get(i)),l=this.ResolveAliasType(a,!0).FData,(r=o.IndexOf(l.GUID))>=0&&this.RaiseMsg(20180330231220,4024,rtl.getResStr(e,"sDuplicateGUIDXInYZ"),pe(18,l.GUID,18,a.FName,18,o.GetObject(r).FName),t),o.AddObject(l.GUID,a)}finally{o=rtl.freeLoc(o)}}};var s=rtl.createSet(4,5,1,2),i=rtl.createSet(4,5,1,2),n={},l=rtl.createSet(1),C=rtl.createSet(1,2);this.FinishVariable=function(t){var r=this;function a(s){var i=0;for(var n=0;n<=6;n++)(i=n)in t.VarModifiers&&!(i in s)&&(ot[i],r.RaiseMsg(20170322134418,4015,rtl.getResStr(e,"sInvalidVariableModifier"),pe(18,M.VariableModifierNames[i]),t))}var o="",h=null,u=null,c=Ue.$new(),p=null,f=null,d=ht.$new();Ie.FinishVariable.call(this,t),h=t.FParent.$class.ClassType(),null!==t.AbsoluteExpr&&(1 in t.VarModifiers&&this.RaiseMsg(20171226105002,3052,rtl.getResStr(Ee,"sXModifierMismatchY"),pe(18,"absolute",18,"external"),t.AbsoluteExpr),u=t.AbsoluteExpr,this.ComputeElement(u,c,rtl.createSet(1),null),p=c.IdentEl,h===ke?ke.isPrototypeOf(p.FParent)||Ye.isPrototypeOf(p)||ze.isPrototypeOf(p)||this.RaiseMsg(20171226102424,4009,rtl.getResStr(e,"sInvalidAbsoluteLocation"),[],t.AbsoluteExpr):this.RaiseMsg(20170728133340,4015,rtl.getResStr(e,"sInvalidVariableModifier"),pe(18,"absolute"),t)),h===Ae?(a(s),t.FParent.IsExternal&&(4===t.Visibility&&this.RaiseMsg(20170413221516,3053,rtl.getResStr(Ee,"sSymbolCannotBePublished"),[],t),1 in t.VarModifiers||(t.$class.ClassType()!==Be&&t.$class.ClassType()!==be||(null!==t.ExportName&&this.RaiseMsg(20170322134321,4015,rtl.getResStr(e,"sInvalidVariableModifier"),pe(18,"export name"),t.ExportName),t.ExportName=_e.$create("Create$3",[t,2,"'"+t.FName+"'"]),this.FOwnedElements.Add(t.ExportName)),t.VarModifiers=rtl.includeSet(t.VarModifiers,1)),t.$class.ClassType()===be&&null!==t.Expr&&(t.IsConst=!0))):h===Me?(a(i),this.IsManagedJSType(t.VarType)&&this.RaiseMsg(20180404135105,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"COM-interface as record member"),t),t.$class.ClassType()===be&&null!==t.Expr&&1 in t.VarModifiers&&(t.IsConst=!0)):h===ke?(a(n),t.$class.ClassType()===be&&this.AddElevatedLocal(t)):h===ut?a(n):h===Le?a(l):h.InheritsFrom(ct)?a(C):this.RaiseNotYetImplemented(20170324151259,t,""),1 in t.VarModifiers&&(null!==t.LibraryName&&this.RaiseMsg(20170227094227,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"library"),t.ExportName),null===t.ExportName&&this.RaiseMsg(20170227100750,4012,rtl.getResStr(e,"sMissingExternalName"),[],t),o=this.ComputeConstString(t.ExportName,!0,!0),4===t.Visibility&&o!==t.FName&&this.RaiseMsg(20170407002940,4014,rtl.getResStr(e,"sPublishedNameMustMatchExternal"),[],t.ExportName),(ct.isPrototypeOf(t.FParent)||t.$class.ClassType()===be&&Se.isPrototypeOf(t.FParent))&&this.AddExternalPath(o,t.ExportName)),null!==t.VarType&&((f=this.ResolveAliasType(t.VarType,!0)).$class.ClassType()===Qe&&(this.ResolveAliasType(f.DestType,!0).$class.ClassType()===Me||this.RaiseMsg(20180423110113,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"pointer"),t)),null!==t.Expr&&(this.IsManagedJSType(f)&&(pt.isPrototypeOf(t.Expr)||this.RaiseMsg(20250623135850,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"initial value of managed type"),t.Expr)),f.$class.ClassType()===Me&&this.GetAssignGUIDString(f,t.Expr,d)))},this.FinishArgument=function(t){var s=null,i=null;Ie.FinishArgument.call(this,t),null!==t.ArgType&&((i=(s=this.ResolveAliasType(t.ArgType,!0)).$class.ClassType())===Qe&&(this.ResolveAliasType(s.DestType,!0).$class.ClassType()===Me||this.RaiseMsg(20180423110239,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"pointer"),t)),4===t.Access&&(i===Me||i===ft||this.LogMsg(20191215133912,2,4031,rtl.getResStr(e,"sConstRefNotForXAsConst"),pe(18,at(s)),t)))},this.FinishProcedureType=function(t){var s=null,i=0,r="",n=null,l=null,a=null,o=null,u=null,c=0,p=null,f=null,d=null;if(Ie.FinishProcedureType.call(this,t),Xe.isPrototypeOf(t)&&null!==(d=t).ResultEl&&(p=this.ResolveAliasType(d.ResultEl.ResultType,!0)).$class.ClassType()===Qe&&(this.ResolveAliasType(p.DestType,!0).$class.ClassType()===Me||this.RaiseMsg(20180423110824,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"pointer"),t)),Se.isPrototypeOf(t.FParent)){for(var F in s=t.FParent,0!==t.CallingConvention&&this.RaiseMsg(20170211214731,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,M.cCallingConventions[t.CallingConvention]),s),s.FModifiers)(i=+F)in rtl.createSet(0,2,3,5,6,7,8,9,10,12,13)||this.RaiseNotYetImplemented(20170208142159,t,"modifier "+M.ModifierNames[i]);for(var m in s.ProcType.Modifiers)(c=+m)in rtl.createSet(0,3,2,5)||this.RaiseNotYetImplemented(20170411171454,t,"modifier "+M.ProcTypeModifiers[c]);if(rtl.leSet(rtl.createSet(10,12),s.FModifiers)&&this.RaiseMsg(20170324150149,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,s.ElementTypeName(),18,"public, external"),s),null!==s.PublicName&&this.RaiseMsg(20170324150417,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"public name"),s.PublicName),null!==s.DispIDExpr&&this.RaiseMsg(20190303225224,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"dispid"),s.DispIDExpr),null!==s.MessageExpr&&(Ae.isPrototypeOf(s.FParent)&&1===s.FParent.ObjKind||this.RaiseMsg(20190303231445,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,"message",18,"at non class method"),s.MessageExpr),s.FParent.IsExternal&&this.RaiseMsg(20190304002235,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,"message",18,"in external class"),s.MessageExpr),this.AddMessageIdToClassScope(s,!0)),Ne.isPrototypeOf(s.FParent))if(l=s.FParent,a=rtl.as(l.FData,we),h.isPrototypeOf(a))if(u=a,(o=l).IsExternal)12 in s.FModifiers||(null!==s.LibrarySymbolName&&this.RaiseMsg(20170322142158,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,s.ElementTypeName(),18,"symbol name"),s.LibrarySymbolName),s.FModifiers=rtl.unionSet(s.FModifiers,rtl.createSet(12)),s.LibrarySymbolName=_e.$create("Create$3",[s,2,"'"+s.FName+"'"]),this.FOwnedElements.Add(s.LibrarySymbolName)),4===s.Visibility&&this.RaiseMsg(20170413221327,3053,rtl.getResStr(Ee,"sSymbolCannotBePublished"),[],s),(n=s.$class.ClassType())===Se||n===qe||n===dt||n===$e||(n===Ft?(s.IsVirtual()&&this.RaiseMsg(20170323100447,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,s.ElementTypeName(),18,"virtual,external"),s),this.ComputeConstString(s.LibrarySymbolName,!0,!0)):this.RaiseMsg(20170322163210,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,s.ElementTypeName()),s));else{var C=o.ObjKind;if(1===C)null===u.NewInstanceFunction&&s.$class.ClassType()===$e&&null!==u.AncestorScope&&u.AncestorScope.FElement.IsExternal&&s.Visibility in rtl.createSet(2,3,4)&&s.GetFT().ResultEl.ResultType===l&&rtl.eqSet(rtl.diffSet(s.FModifiers,rtl.createSet(0,9)),{})&&rtl.eqSet(rtl.intersectSet(s.ProcType.Modifiers,rtl.createSet(0)),rtl.createSet(0))&&(u.NewInstanceFunction=s,this.CheckNewInstanceFunction(u));else if(2===C)for(var S in s.FModifiers)(i=+S)in rtl.createSet(5,7)||this.RaiseMsg(20180329141108,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,s.ElementTypeName(),18,M.ModifierNames[i]),s);else 3!==C&&4!==C&&5!==C||((f=this.ResolveAliasType(o.HelperForType,!0)).$class.ClassType()===Ae&&f.IsExternal&&(this.IsClassMethod(s)&&!(2 in t.Modifiers)&&this.RaiseMsg(20190201165259,4027,rtl.getResStr(e,"sHelperClassMethodForExtClassMustBeStatic"),[],t),s.$class.ClassType()===Ft&&this.RaiseNotYetImplemented(20190206153655,t,"")),s.IsExternal()&&(Ne.isPrototypeOf(f)||this.RaiseMsg(20190314225457,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"external method in type helper"),t)))}else o=null,u=null;if(12 in s.FModifiers){for(i in s.IsOverride()&&this.RaiseMsg(20170321101715,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,s.ElementTypeName(),18,"override,external"),s),null!==s.LibraryExpr&&this.RaiseMsg(20170211220712,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"external library name"),s.LibraryExpr),null===s.LibrarySymbolName&&this.RaiseMsg(20170227095454,4012,rtl.getResStr(e,"sMissingExternalName"),pe(18,"missing external name"),s),rtl.createSet(9,13,15,8))i in s.FModifiers&&this.RaiseMsg(20170323100842,3016,rtl.getResStr(Ee,"sInvalidXModifierY"),pe(18,s.ElementTypeName(),18,M.ModifierNames[i]),s);r=this.ComputeConstString(s.LibrarySymbolName,!0,!0),s.IsVirtual()&&s.FName!==r&&this.RaiseMsg(20170321090049,4013,rtl.getResStr(e,"sVirtualMethodNameMustMatchExternal"),[],s.LibrarySymbolName),4===s.Visibility&&(s.FName!==r&&this.RaiseMsg(20170407002940,4014,rtl.getResStr(e,"sPublishedNameMustMatchExternal"),[],s.LibrarySymbolName),r===e.ExtClassBracketAccessor&&this.RaiseMsg(20170409211805,3053,rtl.getResStr(Ee,"sSymbolCannotBePublished"),[],s.LibrarySymbolName)),ct.isPrototypeOf(s.FParent)&&this.AddExternalPath(r,s.LibrarySymbolName)}}else t.CallingConvention in rtl.createSet(0,6)||this.RaiseMsg(20200516134717,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,M.cCallingConventions[t.CallingConvention]),t)},this.FinishProperty=function(t){var s,i,r,n,l,a,o=null,h=Ue.$new(),u=null;Ie.FinishProperty.call(this,t),(l=t.FParent.$class.ClassType())===Ae?t.FParent.IsExternal&&4===t.Visibility&&this.RaiseMsg(20170413221703,3053,rtl.getResStr(Ee,"sSymbolCannotBePublished"),[],t):l===Me||this.RaiseNotYetImplemented(20190105144817,t,""),s=this.GetPasPropertyGetter(t),r=this.IsExternalBracketAccessor(s),i=this.GetPasPropertySetter(t),n=this.IsExternalBracketAccessor(i),a=this.GetPasPropertyIndex(t),u=this.GetPasPropertyArgs(t),r&&(1===u.FCount&&null===a||this.RaiseMsg(20170403001743,4020,rtl.getResStr(e,"sBracketAccessorOfExternalClassMustHaveOneParameter"),[],t)),n&&(1===u.FCount&&null===a||this.RaiseMsg(20170403001806,4020,rtl.getResStr(e,"sBracketAccessorOfExternalClassMustHaveOneParameter"),[],t)),(r||n)&&((o=rtl.getObject(u.Get(0))).Access in rtl.createSet(0,1)||this.RaiseMsg(20170403090225,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,'default or "const"',18,M.AccessNames[o.Access]),t),this.ComputeElement(o,h,rtl.createSet(4),o),h.BaseType in rtl.unionSet(rtl.unionSet(rtl.unionSet(e.btAllJSInteger,e.btAllJSStringAndChars),e.btAllJSBooleans),e.btAllJSFloats)||this.RaiseMsg(20170403090628,3028,rtl.getResStr(Ee,"sIncompatibleTypesGotExpected"),pe(18,this.GetResolverResultDescription(h,!0),18,"string"),o))},this.FinishProcParamAccess=function(e,t){Ie.FinishProcParamAccess.call(this,e,t),this.FindCreatorArrayOfConst(e.Args,t)},this.FinishPropertyParamAccess=function(e,t){var s;Ie.FinishPropertyParamAccess.call(this,e,t),null===(s=this.GetPasPropertyArgs(t))&&this.RaiseNotYetImplemented(20190215210914,e,Ge(t)),this.FindCreatorArrayOfConst(s,e)},this.FinishExportSymbol=function(t){var s=Ue.$new(),i=null,r=null,n=null;mt.isPrototypeOf(t.FParent)||this.RaiseMsg(20210106224720,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"non library export"),t.ExportIndex),null!==t.ExportIndex&&this.RaiseMsg(20210106223403,4002,rtl.getResStr(e,"sNotSupportedX"),pe(18,"export index"),t.ExportIndex),Ie.FinishExportSymbol.call(this,t),this.ComputeElement(t,s,{},null),null===(i=s.IdentEl)&&this.RaiseMsg(20210106223620,3145,rtl.getResStr(Ee,"sSymbolCannotBeExportedFromALibrary"),[],t),ze.isPrototypeOf(i)&&(i=i.FParent.FParent),r=i.$class.ClassType(),null===i.FParent&&this.RaiseMsg(20220206142534,3145,rtl.getResStr(Ee,"sSymbolCannotBeExportedFromALibrary"),[],t),ct.isPrototypeOf(i.FParent)||Se.isPrototypeOf(i)&&i.IsStatic()||this.RaiseMsg(20210106224436,3145,rtl.getResStr(Ee,"sSymbolCannotBeExportedFromALibrary"),[],t),mt.isPrototypeOf(t.FParent)||this.RaiseMsg(20211022224239,3145,rtl.getResStr(Ee,"sSymbolCannotBeExportedFromALibrary"),[],t),r.InheritsFrom(Se)?((n=i).IsExternal()||n.IsAbstract())&&this.RaiseMsg(20211021225630,3145,rtl.getResStr(Ee,"sSymbolCannotBeExportedFromALibrary"),[],t):r===Be||r===be?1 in i.VarModifiers&&this.RaiseMsg(20211021225634,3145,rtl.getResStr(Ee,"sSymbolCannotBeExportedFromALibrary"),[],t):this.RaiseMsg(20210106223621,3145,rtl.getResStr(Ee,"sSymbolCannotBeExportedFromALibrary"),[],t)},this.ComputeArgumentExpr=function(e,t,s,i,r){var n=null,l=null;Ie.ComputeArgumentExpr.call(this,e,t,s,i,r),r&&t in rtl.createSet(0,1)&&(4===e.BaseType||this.IsJSBaseType$1(e,1,!0))&&Me.isPrototypeOf(i.LoTypeEl)&&(n=this.GetRightMostExpr(s),ve.isPrototypeOf(n.FData)&&((l=n.FData).Flags=rtl.includeSet(l.Flags,7)))},this.FindCreatorArrayOfConst=function(e,t){for(var s=0,i=null,r=0,n=e.FCount-1;r<=n;r++)s=r,i=rtl.getObject(e.Get(s)),this.IsArrayOfConst(i.ArgType)&&this.FindProc_ArrLitToArrayOfConst(t)},this.FindProc_ArrLitToArrayOfConst=function(e){var t,s,i,n,l=null,a=null,o=null;return t=this.FRootElement,null!==(l=(a=rtl.as(t.FData,r)).SystemVarRecs)||(null===(s=this.FindUsedUnitname("system",t))&&this.RaiseIdentifierNotFound(20190215211531,"System.VarRecs",e),null===s.InterfaceSection&&this.RaiseIdentifierNotFound(20190215211538,"System.VarRecs",e),null===(i=rtl.as(Ct(s.InterfaceSection.FData),K).FindLocalIdentifier("VarRecs"))&&this.RaiseIdentifierNotFound(20190215211551,"System.VarRecs",e),(o=i.FElement).$class.ClassType()!==qe&&this.RaiseXExpectedButYFound(20190215211559,"function System.VarRecs",at(o),e),l=o,a.SystemVarRecs=l,(n=rtl.as(l.ProcType,Xe)).Args.FCount>0&&this.RaiseXExpectedButYFound(20190215211953,"function System.VarRecs with 0 args",oe(n.Args.FCount),e),rtl.neSet(n.Modifiers,rtl.createSet(3))&&this.RaiseXExpectedButYFound(20190215212151,"function System.VarRecs; varargs","?",e),0!==n.CallingConvention&&this.RaiseXExpectedButYFound(20190215211824,"function System.VarRecs with default calling convention",M.cCallingConventions[n.CallingConvention],e)),l},this.FindSystemExternalClassType=function(e,t,s){var i,r=E.$new(),n=!1;return r.$assign(E.$new()),r.ErrorPosEl=s,r.JSName=t,n=!1,this.IterateGlobalElements(e,rtl.createCallback(this,"OnFindExtSystemClass"),r,{get:function(){return n},set:function(e){n=e}}),i=r.Found,null!==s&&null===i&&this.RaiseIdentifierNotFound(20200526095647,e+" = class external name '"+t+"'",s),i},this.FindTJSPromise=function(e){var t,s=null,i=null;return t=this.FRootElement,s=(i=rtl.as(t.FData,r)).FJSPromiseClass,0 in i.FlagsJS||(s=this.FindSystemExternalClassType("TJSPromise","Promise",e),i.SetJSPromiseClass(s),i.FlagsJS=rtl.includeSet(i.FlagsJS,0)),s},this.CheckExternalClassConstructor=function(t){var s=null;St.isPrototypeOf(t.Context)||this.RaiseMsg(20180511165144,4026,rtl.getResStr(e,"sJSNewNotSupported"),[],t.FElement),(s=t.Context.Typ).$class.ClassType()===Ae?s.IsExternal||this.RaiseMsg(20180511165316,4026,rtl.getResStr(e,"sJSNewNotSupported"),[],t.FElement):s.$class.ClassType()===Tt&&(s=this.ResolveAliasType(s.DestType,!0)).$class.ClassType()===Ae&&(s.IsExternal||this.RaiseMsg(20180511175309,4026,rtl.getResStr(e,"sJSNewNotSupported"),[],t.FElement))},this.CheckConditionExpr=function(e,t){1===t.BaseType&&this.IsJSBaseType$1(t,1,!1)||Ie.CheckConditionExpr.call(this,e,t)},this.CheckNewInstanceFunction=function(t){var s=null,i=null,r=null,n=Ue.$new();(s=t.NewInstanceFunction).IsVirtual()||this.RaiseMsg(20170324231040,4017,rtl.getResStr(e,"sNewInstanceFunctionMustBeVirtual"),[],s),(i=s.ProcType.Args).FCount<2&&this.RaiseMsg(20170324232247,4018,rtl.getResStr(e,"sNewInstanceFunctionMustHaveTwoParameters"),[],s.ProcType),0!==(r=rtl.getObject(i.Get(0))).Access&&this.RaiseMsg(20170324232655,3006,rtl.getResStr(Ee,"sIncompatibleTypeArgNo"),pe(9,"1",18,M.AccessNames[r.Access],18,"default (none)"),r),null===r.ArgType&&this.RaiseMsg(20170324233201,3006,rtl.getResStr(Ee,"sIncompatibleTypeArgNo"),pe(9,"1",18,"untyped",18,"String"),r),this.ComputeElement(r.ArgType,n,rtl.createSet(4),null),7!==n.BaseType&&this.RaiseMsg(20170324233348,3006,rtl.getResStr(Ee,"sIncompatibleTypeArgNo"),pe(9,"1",18,this.GetResolverResultDescription(n,!1),18,"String"),r),1!==(r=rtl.getObject(i.Get(1))).Access&&this.RaiseMsg(20170324233457,3006,rtl.getResStr(Ee,"sIncompatibleTypeArgNo"),pe(9,"2",18,M.AccessNames[r.Access],18,"const"),r),null!==r.ArgType&&this.RaiseMsg(20170324233508,3006,rtl.getResStr(Ee,"sIncompatibleTypeArgNo"),pe(9,"2",18,"type",18,"untyped"),r)},this.AddExternalName=function(e,t){var s=null;return(s=Y.$create("Create")).Identifier=e,s.SetElement(t),this.InternalAdd(s),s},this.FindExternalName=function(e){return this.FExternalNames.Find(e)},this.AddExternalPath=function(e,t){var s=0;if(""!==(e=yt(e))){for(this.AddExternalName(e,t),s=1;s<=e.length&&e.charCodeAt(s-1)in rtl.createSet(null,97,122,null,65,90,null,48,57,95,36);)s+=1;s>e.length||this.AddExternalName(he(e,s-1),t)}},this.AddElevatedLocal=function(e){var t=0,s=null,i=null,r=null;for(t=this.FScopeCount-1;t>=0;){if(i=this.GetScopes(t),c.isPrototypeOf(i)&&null!==(r=i).ClassRecScope&&(i=r.ClassRecScope),null!==(s=this.GetElevatedLocals(i)))return void s.Add(e.FName,e);t-=1}this.RaiseNotYetImplemented(20180420131358,e,"")},this.ClearElementData=function(){var e=null,t=null;for(e=this.FFirstElementData;null!==e;)t=e.Next,e=rtl.freeLoc(e),e=t;this.FFirstElementData=null,this.FLastElementData=null,this.FExternalNames.ForEachCall(rtl.createCallback(this,"OnClearHashItem"),null),this.FExternalNames.Clear()},this.GenerateGUID=function(e){var t,s="",i="",r=0,n=0,l=0,a=0,o=null,h=rtl.arraySetLength(null,0,16),u=null;i=e.PathName(),null!==(t=e.FData).AncestorScope&&(i=t.AncestorScope.GUID+i),u=te.$create("Create$1");for(var c=0,p=e.Members.FCount-1;c<=p;c++)r=c,o=rtl.getObject(e.Members.Get(r)),Se.isPrototypeOf(o)&&u.Add(o.FName);u.Sort();for(var f=0,d=u.GetCount()-1;f<=d;f++)r=f,i=i+","+u.Get(r);u=rtl.freeLoc(u),n=0,l=0;for(var F=1,m=i.length;F<=m;F++)r=F,a=(h[n]<<8)+h[n+1&15],a+=i.charCodeAt(r-1)<<11-l,h[n]=a>>>8&255,h[n+1&15]=255&a,(l+=5)>7&&(l-=8,n=n+1&15);for(h[6]=48+(15&h[6]),h[8]=128+(63&h[8]),s="{",r=0;r<=3;r++)s+=rtl.hexStr(h[r],2);for(s+="-",r=4;r<=5;r++)s+=rtl.hexStr(h[r],2);for(s+="-",r=6;r<=7;r++)s+=rtl.hexStr(h[r],2);for(s+="-",r=8;r<=9;r++)s+=rtl.hexStr(h[r],2);for(s+="-",r=10;r<=15;r++)s+=rtl.hexStr(h[r],2);return s+="}"},this.CheckCallAsyncFuncResult=function(e,t){var s,i=null,r=null;return null!==(s=this.GetPathEndIdent(e,!0))&&ve.isPrototypeOf(s.FData)&&(i=s.FData.FDeclaration,qe.isPrototypeOf(i)&&(r=i).IsAsync())?(this.ComputeResultElement(r.GetFT().ResultEl,t,{},s),!0):(t.$assign(Ue.$new()),false)},this.SpecializeGenericIntf=function(e){var t;Ie.SpecializeGenericIntf.call(this,e),this.RenameSpecialized(e),t=e.FSpecializedEl,gt.isPrototypeOf(t)&&this.IsFullySpecialized(t)&&null!==this.SpecializeParamsNeedDelay(e)&&this.FHub.AddJSDelaySpecialize(t)},this.SpecializeGenericImpl=function(e){var t;if(Ie.SpecializeGenericImpl.call(this,e),t=e.FSpecializedEl,Ne.isPrototypeOf(t)&&null===this.FOverloadScopes){this.FOverloadScopes=_.$create("Create");try{this.RenameMembers(t)}finally{this.ClearOverloadScopes()}}},this.SpecializeProcedure=function(e,t,s){var i,r=null;i=rtl.as(e.FData,c),r=rtl.as(t.FData,c),null===s&&(r.OverloadName=i.OverloadName,r.JSName=i.JSName),Ie.SpecializeProcedure.call(this,e,t,s)},this.SpecializeParamsNeedDelay=function(e){var t,s,i,r=null,n=null,l=null,a=0,o=null,h=null,u=null,c=null;if(t=null,null===e)return t;if(s=e.GenericEl,o=this.GetParentSection(s),!Et.isPrototypeOf(o))return t;r=null,c=null,i=e.Params;for(var p=0,f=rtl.length(i)-1;p<=f;p++)if(a=p,(l=this.ResolveAliasType(i[a],!1)).$class.ClassType()!==it){if(Pt.isPrototypeOf(l.FData)&&l.FData.GenericStep<1)return l;if((h=this.GetParentSection(l))!==o){if(n=h.GetModule(),null===r&&(r=o.GetModule()),n===r)return l;if(Le.isPrototypeOf(h))return l;if(null===c&&(c=this.GetResolver(r)),(u=this.GetResolver(n)).FFinishedInterfaceIndex>c.FFinishedInterfaceIndex||0===u.FFinishedInterfaceIndex)return l}}return t},this.IsSpecializedNonStaticMethod=function(e){var t=null;return!!Se.isPrototypeOf(e.FParent)&&(!(t=e.FParent).IsStatic()&&!t.IsExternal()&&(!!Ne.isPrototypeOf(t.FParent)&&(null!==t.FData.SpecializedFromItem&&true)))},this.AddJSBaseType=function(e,t){var s,i=null;return s=this.AddCustomBaseType(e,m),0!==t&&(this.FJSBaseTypes[t]=s),(i=s.FData).JSBaseType=t,i},this.CheckAssignCompatibilityCustom=function(t,s,i,r,n){var l=0,a=null,o=Ue.$new(),h=null,u=null,c="";if(l=2147483647,1===t.BaseType){if(it.isPrototypeOf(t.LoTypeEl)||this.RaiseInternalError(20170325114554,""),!m.isPrototypeOf(t.LoTypeEl.FData))return l;n.set(!0),1===t.LoTypeEl.FData.JSBaseType&&(0 in s.Flags?s.BaseType in e.btAllJSValueSrcTypes?l=2e4:1===s.BaseType?this.IsJSBaseType$1(s,1,!1)&&(l=0):2===s.BaseType?l=2e4:31===s.BaseType&&null===s.IdentEl&&(l=0):2===s.BaseType&&null!==s.IdentEl&&s.IdentEl.$class.ClassType()===Ae&&(l=2e4))}else if(2===t.BaseType)if(h=t.LoTypeEl,u=s.LoTypeEl,h.$class.ClassType()===ft&&0 in s.Flags){if(a=h,rtl.length(a.Ranges)>0)return l;if(2!==s.BaseType||u.$class.ClassType()!==ft)return l;this.ComputeElement(this.GetArrayElType(a),o,rtl.createSet(4),null),this.IsJSBaseType$1(o,1,!1)&&(n.set(!0),l=2e4)}else h.$class.ClassType()===Ae&&0 in s.Flags&&29===s.BaseType&&this.IsSameType(u,this.GetBaseTypes(29),0)&&(c=e.Pas2JSBuiltInNames[144]+"."+e.Pas2JSBuiltInNames[172],this.IsExternalClass_Name(h,c)&&(n.set(!0),l=1e4));return l},this.CheckTypeCastClassInstanceToClass=function(e,t,s){var i,r,n,l=0,a=null,o=null,u=0,c=null,p=null;if(30===e.BaseType)return 0;if(i=rtl.as(t.LoTypeEl,Ae),null===(r=rtl.as(i.FData,h)).AncestorScope)return 10001;if(null!==(n=r.SpecializedFromItem)&&(a=rtl.as(e.LoTypeEl,Ae),null!==(o=rtl.as(a.FData,h).SpecializedFromItem)&&o.GenericEl===n.GenericEl)){l=10001;for(var f=0,d=rtl.length(o.Params)-1;f<=d;f++)if(u=f,p=o.Params[u],c=n.Params[u],!(this.IsSameType(p,c,2)||this.IsJSBaseType(p,1)||this.IsJSBaseType(c,1))){l=2147483647;break}if(l<2147483647)return l}return l=2147483647},this.CheckEqualCompatibilityCustomType=function(t,s,i,r){var n=0;if(n=2147483647,1===t.BaseType){if(it.isPrototypeOf(t.LoTypeEl)||this.RaiseInternalError(20170330005841,""),!m.isPrototypeOf(t.LoTypeEl.FData))return n;1===t.LoTypeEl.FData.JSBaseType&&0 in t.Flags&&(0 in s.Flags?s.BaseType in e.btAllJSValueSrcTypes?n=2e4:1===s.BaseType?this.IsJSBaseType$1(s,1,!1)&&(n=0):2===s.BaseType&&(n=2e4):2===s.BaseType&&null!==s.IdentEl&&s.IdentEl.$class.ClassType()===Ae&&(n=2e4))}else{if(1===s.BaseType)return this.CheckEqualCompatibilityCustomType(s,t,i,r);this.RaiseInternalError(20170330005725,"")}return n},this.CheckForIn=function(e,t,s){var i=null,r=Ue.$new(),n=Ue.$new(),l=Ue.$new();if(1===s.BaseType){if(this.IsJSBaseType$1(s,1,!0))return t.BaseType in U.btAllStrings||this.RaiseXExpectedButYFound(20180423185800,"string",this.GetResolverResultDescription(t,!0),e.StartExpr),!0}else if(2===s.BaseType&&(i=s.LoTypeEl).$class.ClassType()===Ae&&i.IsExternal)return this.IsForInExtArray(e,t,s,r,n,l)||t.BaseType in U.btAllStrings||this.RaiseXExpectedButYFound(20180423191611,"string",this.GetResolverResultDescription(t,!0),e.StartExpr),!0;return false},this.ComputeUnaryNot=function(e,t,s){1===t.BaseType&&this.IsJSBaseType$1(t,1,!0)?It(t,15,this.GetBaseTypes(15),this.GetBaseTypes(15),e,rtl.createSet(0)):Ie.ComputeUnaryNot.call(this,e,t,rtl.refSet(s))},this.ComputeBinaryExprRes=function(e,t,s,i,r){var n=this;function l(s){It(t,s,n.GetBaseTypes(s),n.GetBaseTypes(s),e,rtl.createSet(0))}var a=null;if((1===i.BaseType||1===r.BaseType)&&(21===e.OpCode&&this.IsJSBaseType$1(i,1,!0))){if(Oe.isPrototypeOf(r.IdentEl)&&Ae.isPrototypeOf(this.ResolveAliasType(r.IdentEl,!0)))return void l(15);if(a=r.LoTypeEl,Tt.isPrototypeOf(a))return void l(15)}Ie.ComputeBinaryExprRes.call(this,e,t,rtl.refSet(s),i,r)},this.BI_Exit_OnGetCallCompatibility=function(e,t,s){var i=null,r=null,n=Ue.$new(),l=null;return je.isPrototypeOf(t)&&1===rtl.length(t.Params)&&(i=t,null!==(r=this.GetParentProc(t,!0))&&r.IsAsync()&&(l=i.Params[0],this.ComputeElement(l,n,{},null),0 in n.Flags&&2===n.BaseType&&Ae.isPrototypeOf(n.LoTypeEl)&&this.IsPromiseClass(n.LoTypeEl)))?3:Ie.BI_Exit_OnGetCallCompatibility.call(this,e,t,s)},this.BI_Val_OnGetCallCompatibility=function(e,t,s){var i,r=0,n=Ue.$new(),l=0,a=null;return r=Ie.BI_Val_OnGetCallCompatibility.apply(this,arguments),i=t.Params[1],this.ComputeElement(i,n,{},null),r=2147483647,37===(l=n.BaseType)&&(l=n.SubType),2===l&&((a=n.LoTypeEl.$class.ClassType())!==st&&a!==rt||(r=0)),2147483647===r?this.CheckRaiseTypeArgNo(20181214142349,2,i,n,"enum variable",s):r},this.BI_TypeInfo_OnGetCallResult=function(t,s,i){var r,n,l=Ue.$new(),a=null,o="",h=Rt.$new(),u=!1,c=0,p=null,f=null,d=null,F=null,C=null;if(r=s.Params[0],this.ComputeElement(r,l,rtl.createSet(1),null),null===l.LoTypeEl&&this.RaiseInternalError(20170413090726,""),31===l.BaseType&&qe.isPrototypeOf(l.IdentEl)&&(C=l.IdentEl.GetFT().ResultEl,this.ComputeResultElement(C,l,{},null),l.Flags=rtl.includeSet(l.Flags,0),null===l.LoTypeEl&&this.RaiseInternalError(20170421124923,"")),o="",(a=(p=l.LoTypeEl).$class.ClassType())===it)m.isPrototypeOf(p.FData)?1===p.FData.JSBaseType&&(o=e.Pas2JSBuiltInNames[172]):ne.isPrototypeOf(p.FData)&&((c=p.FData.BaseType)in rtl.unionSet(e.btAllJSInteger,rtl.createSet(14))?o=e.Pas2JSBuiltInNames[179]:c in rtl.createSet(7,5,11,15)?o=e.Pas2JSBuiltInNames[172]:29===c&&(o=e.Pas2JSBuiltInNames[182]));else if(2===l.BaseType){if(a===st)o=e.Pas2JSBuiltInNames[176];else if(a===vt)o=e.Pas2JSBuiltInNames[186];else if(a.InheritsFrom(At))o=p.GetIsReference()?e.Pas2JSBuiltInNames[185]:p.GetIsOfObject()?e.Pas2JSBuiltInNames[181]:e.Pas2JSBuiltInNames[183];else if(a===Me)o=e.Pas2JSBuiltInNames[184];else if(a===Ae){var S=p.ObjKind;1===S?o=p.IsExternal?e.Pas2JSBuiltInNames[177]:e.Pas2JSBuiltInNames[173]:2===S?o=e.Pas2JSBuiltInNames[180]:3===S||4===S||5===S?o=e.Pas2JSBuiltInNames[178]:this.RaiseNotYetImplemented(20180328195807,r,"")}else if(a===Tt)o=0 in l.Flags?e.Pas2JSBuiltInNames[173]:e.Pas2JSBuiltInNames[174];else if(a===ft)o=rtl.length(p.Ranges)>0?e.Pas2JSBuiltInNames[187]:e.Pas2JSBuiltInNames[175];else if(a===Qe)o=e.Pas2JSBuiltInNames[182];else if(a===Nt){if(d=p,rtl.length(d.Constraints)>0){F=d.Constraints[0];var T=this.GetGenericConstraintKeyword(F);if(96===T)o=e.Pas2JSBuiltInNames[184];else if(47===T||50===T)o=e.Pas2JSBuiltInNames[173];else if(Oe.isPrototypeOf(F)||this.RaiseNotYetImplemented(20191018180031,F,Pe(r)),p=this.ResolveAliasType(F,!0),Ae.isPrototypeOf(p)){var y=p.ObjKind;1===y?o=p.IsExternal?e.Pas2JSBuiltInNames[177]:e.Pas2JSBuiltInNames[173]:2===y?o=e.Pas2JSBuiltInNames[180]:this.RaiseNotYetImplemented(20200927100825,F,Pe(r))}else this.RaiseNotYetImplemented(20191018180131,F,Pe(r))}""===o&&(o=e.Pas2JSBuiltInNames[172])}}else 34===l.BaseType?vt.isPrototypeOf(l.IdentEl)&&(o=e.Pas2JSBuiltInNames[186]):37===l.BaseType?(this.ConvertRangeToElement(l),l.BaseType in e.btAllJSInteger?o=e.Pas2JSBuiltInNames[179]:l.BaseType in rtl.createSet(5,15)?o=e.Pas2JSBuiltInNames[172]:2===l.BaseType&&(a=(p=l.LoTypeEl).$class.ClassType())===st&&(o=e.Pas2JSBuiltInNames[176])):a===rt&&(l.BaseType in e.btAllJSInteger?o=e.Pas2JSBuiltInNames[179]:l.BaseType in rtl.createSet(5,15)&&(o=e.Pas2JSBuiltInNames[172]));""===o&&this.RaiseNotYetImplemented(20170413091852,r,""),n=this.StashSubExprScopes(),h.$assign(Rt.$new()),h.ErrorPosEl=s,u=!1,this.IterateElements(o,rtl.createCallback(this,"OnFindFirst"),h,{get:function(){return u},set:function(e){u=e}}),this.RestoreStashedScopes(n),Oe.isPrototypeOf(h.Found)&&(p=this.ResolveAliasType(h.Found,!0)).$class.ClassType()===Ae&&(f=h.Found).IsExternal&&f.ExternalName===e.Pas2JSBuiltInNames[144]+"."+o?xt(i,2,f,h.Found,rtl.createSet(0)):xt(i,29,this.GetBaseTypes(29),this.GetBaseTypes(29),rtl.createSet(0))},this.BI_Debugger_OnGetCallCompatibility=function(e,t,s){return je.isPrototypeOf(t)?this.CheckBuiltInMaxParamCount(e,t,0,s,""):0},this.BI_AWait_OnGetCallCompatibility=function(s,i,r){var n,l=this,a=0,o=null,h=Ue.$new(),u=Ue.$new(),c=null,p=null;function f(t){var s;return(s=t.GetIsAsync()||Xe.isPrototypeOf(t)&&Ae.isPrototypeOf(t.ResultEl.ResultType)&&l.IsPromiseClass(rtl.as(t.ResultEl.ResultType,Ae))||bt.isPrototypeOf(t.ResultEl.ResultType)&&l.IsPromiseClass(rtl.as(t.ResultEl.ResultType.DestType,Ae)))||r&&l.RaiseMsg(20201229232446,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,rtl.getResStr(e,"sAsyncFunctionOrPromise"),18,l.GetResolverResultDescription(h,!1)),i),s}if(a=2147483647,null===(c=this.GetParentProc(i,!0))||!c.IsAsync())return r&&this.RaiseMsg(20200519153349,4016,rtl.getResStr(e,"sAWaitOnlyInAsyncProcedure"),[],i),a;if(!this.CheckBuiltInMinParamCount(s,i,1,r))return a;if(o=(n=i).Params[0],this.ComputeElement(o,h,{},null),0 in h.Flags){if(2147483647===(a=this.CheckBuiltInMaxParamCount(s,n,1,r,"")))return a;if(p=h.LoTypeEl,ze.isPrototypeOf(h.IdentEl)){if(!f(h.IdentEl.FParent))return 2147483647}else if(2===h.BaseType&&At.isPrototypeOf(p)){if(!f(p))return 2147483647}else if(2===h.BaseType&&Se.isPrototypeOf(h.IdentEl)){if(!f(h.IdentEl.ProcType))return 2147483647}else{if(!r)return 2147483647;this.RaiseMsg(20201229224920,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"async function",18,this.GetResolverResultDescription(h,!1)),i)}}else if(31===h.BaseType){if(He.isPrototypeOf(i.FParent))return r&&this.RaiseMsg(20200523232827,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"async function",18,this.GetResolverResultDescription(h,!1)),i),a;a=this.CheckBuiltInMaxParamCount(s,n,1,r,"")}else{if(p=h.LoTypeEl,it.isPrototypeOf(p)&&ne.isPrototypeOf(p.FData));else{if(null===p||!Oe.isPrototypeOf(h.IdentEl))return this.CheckRaiseTypeArgNo(20200519151816,1,o,h,"jsvalue",r);if(2===h.BaseType&&Ae.isPrototypeOf(h.LoTypeEl)&&this.IsPromiseClass(h.LoTypeEl))return this.CheckRaiseTypeArgNo(20201120001741,1,o,h,"non Promise type",r)}if(rtl.length(n.Params)<2)return r&&this.RaiseMsg(20200520090749,3005,rtl.getResStr(Ee,"sWrongNumberOfParametersForCallTo"),pe(18,t.AwaitSignature2),n),2147483647;if(o=n.Params[1],this.CheckCallAsyncFuncResult(o,u)){if(2!==u.BaseType||!Ae.isPrototypeOf(u.LoTypeEl)||!this.IsPromiseClass(u.LoTypeEl))return h.Flags=rtl.createSet(0,1),h.IdentEl=null,a=this.CheckParamResCompatibility(o,u,h,1,r,!1)}else{if(this.ComputeElement(o,u,{},null),!(0 in u.Flags))return this.CheckRaiseTypeArgNo(20200520091707,2,o,u,"instance of TJSPromise",r);if(2===u.BaseType&&Ae.isPrototypeOf(u.LoTypeEl)&&this.IsPromiseClass(u.LoTypeEl));else if(this.IsJSBaseType$1(u,1,!1));else if(!Ye.isPrototypeOf(u.IdentEl)||null!==u.LoTypeEl)return this.CheckRaiseTypeArgNo(20200520091708,2,o,u,"TJSPromise",r)}a=this.CheckBuiltInMaxParamCount(s,n,2,r,t.AwaitSignature2)}return a},this.BI_AWait_OnGetCallResult=function(e,s,i){var r;r=s.Params[0],1===rtl.length(s.Params)&&this.CheckCallAsyncFuncResult(r,i)?2===i.BaseType&&Ae.isPrototypeOf(i.LoTypeEl)&&this.IsPromiseClass(i.LoTypeEl)&&this.RaiseMsg(20201229235932,3005,rtl.getResStr(Ee,"sWrongNumberOfParametersForCallTo"),pe(18,t.AwaitSignature2),r):(this.ComputeElement(r,i,{},null),i.IdentEl=null,i.Flags=rtl.includeSet(i.Flags,0))},this.BI_AWait_OnEval=function(e,t,s,i){var r,n=Ue.$new();i.set(null),1===rtl.length(t.Params)&&(r=t.Params[0],this.ComputeElement(r,n,{},null),i.set(this.Eval(r,rtl.refSet(s),!0)))},this.BI_AWait_OnFinishParamsExpr=function(e,t){var s,i,r=null,n=null,l=null,a=null,o=null,h=Ue.$new(),u=Ue.$new(),c=!1,p=!1,f=null;s=t.Params,rtl.length(s),i=s[0],this.FinishCallArgAccess(i,1),1===rtl.length(s)&&(null!==(r=this.GetPathEndIdent(i,!1))&&ve.isPrototypeOf(r.FData)?(l=(n=r.FData).FDeclaration,c=!1,Be.isPrototypeOf(l)||l.$class.ClassType()===Ye?(this.ComputeElement(l,h,rtl.createSet(2),null),this.IsProcedureType(h,!0)&&(c=!0)):Se.isPrototypeOf(l)&&(c=!0),c&&(n.Flags=rtl.excludeSet(n.Flags,2),n.Flags=rtl.includeSet(n.Flags,1))):(this.ComputeElement(i,u,{},null),p=!1,f=u.LoTypeEl,a=u.IdentEl,f.$class.ClassType()===Ae?p=this.IsPromiseClass(f):31===u.BaseType&&null===a&&At.isPrototypeOf(f)?p=f.GetIsAsync():Se.isPrototypeOf(a)?p=u.IdentEl.IsAsync():ze.isPrototypeOf(a)&&(o=a.FParent,Xe.isPrototypeOf(o)&&(p=o.GetIsAsync())),p||this.LogMsg(20201116000324,4,3144,rtl.getResStr(Ee,"sAwaitWithoutPromise"),[],i))),rtl.length(s)>1&&this.FinishCallArgAccess(s[1],1),rtl.length(s)>2&&this.RaiseNotYetImplemented(20200525142451,t,"")},this.IsPromiseClass=function(e){return this.IsExternalClass_Name(e,"Promise")},this.Create$3=function(){var t=0;Ie.Create$2.call(this),this.cInterfaceToTGUID=10002,this.cInterfaceToString=10001,this.FExternalNames=W.$create("Create$1"),this.FStoreSrcColumns=!0,this.FOptions=rtl.unionSet(this.FOptions,e.DefaultPasResolverOptions),this.FScopeClass_Class=h,this.FScopeClass_InitialFinalization=o,this.FScopeClass_Module=r,this.FScopeClass_Proc=c,this.FScopeClass_Record=u,this.FScopeClass_Array=p,this.FScopeClass_ProcType=f,this.FScopeClass_Section=a,this.FScopeClass_WithExpr=d;for(var s=1;s<=1;s++)t=s,this.AddJSBaseType(e.Pas2jsBaseTypeNames[t],t);return this.FAnonymousElTypePostfix=e.Pas2JSBuiltInNames[170],this.FBaseTypeChar=6,this.FBaseTypeString=9,this.FBaseTypeLength=28,this},this.Destroy=function(){this.ClearElementData(),this.FExternalNames=null,this.ClearOverloadScopes(),Ie.Destroy.call(this)},this.ClearBuiltInIdentifiers=function(){var e=0,t=0;Ie.ClearBuiltInIdentifiers.call(this);for(var s=0;s<=1;s++)e=s,this.FJSBaseTypes[e]=null;for(var i=0;i<=1;i++)t=i,this.FJSBuiltInProcs[t]=null},this.IsJSBaseType=function(t,s){return it.isPrototypeOf(t)&&0===ye(t.FName,e.Pas2jsBaseTypeNames[s])&&m.isPrototypeOf(t.FData)},this.IsJSBaseType$1=function(e,t,s){return!(1!==e.BaseType||!this.IsJSBaseType(e.LoTypeEl,t))&&((!s||0 in e.Flags)&&true)},this.AddObjFPCBuiltInIdentifiers=function(t,s){var i,r,n=0,l=0;if(i=rtl.diffSet(t,e.btAllJSBaseTypes),rtl.neSet(i,{}))for(var a in i)n=+a,this.RaiseInternalError(20170409180202,this.GetBaseTypeNames(n));if(r=rtl.diffSet(s,e.bfAllJSBaseProcs),rtl.neSet(r,{}))for(var o in r)l=+o,this.RaiseInternalError(20170409180246,U.ResolverBuiltInProcNames[l]);Ie.AddObjFPCBuiltInIdentifiers.call(this,rtl.diffSet(t,rtl.createSet(27,28)),s),27 in t&&this.AddBaseType(e.Pas2JSBuiltInNames[188],27),28 in t&&this.AddBaseType(e.Pas2JSBuiltInNames[171],28),this.FJSBuiltInProcs[0]=this.AddBuiltInProc(e.Pas2jsBuiltInProcNames[0],"procedure Debugger",rtl.createCallback(this,"BI_Debugger_OnGetCallCompatibility"),null,null,null,0,rtl.createSet(0)),this.FJSBuiltInProcs[1]=this.AddBuiltInProc(e.Pas2jsBuiltInProcNames[1],"function await(const Expr: T): T",rtl.createCallback(this,"BI_AWait_OnGetCallCompatibility"),rtl.createCallback(this,"BI_AWait_OnGetCallResult"),rtl.createCallback(this,"BI_AWait_OnEval"),rtl.createCallback(this,"BI_AWait_OnFinishParamsExpr"),0,rtl.createSet(0))},this.CheckTypeCastRes=function(t,s,i,r){var n=this,l=0;function a(e){return r&&n.RaiseIncompatibleTypeRes(e,3035,[],t,s,i),2147483647}var o=null,h=null,u=null,c=null;if(l=2147483647,0 in t.Flags){if(1===s.BaseType){if(u=s.LoTypeEl,it.isPrototypeOf(u)||this.RaiseInternalError(20170325142826,""),m.isPrototypeOf(u.FData))return 1===u.FData.JSBaseType&&(t.BaseType in e.btAllJSValueSrcTypes?l=3:1===t.BaseType?this.IsJSBaseType$1(t,1,!1)&&(l=0):2===t.BaseType&&(l=3)),l}else if(1===t.BaseType){if(c=t.LoTypeEl,it.isPrototypeOf(c)||this.RaiseInternalError(20170325143016,""),m.isPrototypeOf(c.FData))return 1===c.FData.JSBaseType&&(s.BaseType in e.btAllJSValueTypeCastTo||2===s.BaseType)&&(l=3),l}else if(2===s.BaseType)if((o=(u=s.LoTypeEl).$class.ClassType())===Ae){if((h=u).IsExternal)if(t.BaseType in e.btAllJSStringAndChars){if(this.IsExternalClass_Name(h,"String"))return 0}else if(35===t.BaseType){if(this.IsExternalClass_Name(h,"Array"))return 0}else if(2===t.BaseType)if((c=t.LoTypeEl).$class.ClassType()===ft){if(this.IsExternalClass_Name(h,"Array")||this.IsExternalClass_Name(h,"Object"))return 0}else if(c.$class.ClassType()===Me){if(this.IsExternalClass_Name(h,"Object"))return 0}else if(c.$class.ClassType()===Tt){if(this.IsExternalClass_Name(h,"Object"))return 0}else if(c.$class.InheritsFrom(At)){if(this.IsExternalClass_Name(h,"Function")||this.IsExternalClass_Name(h,"Object"))return 0}else if(c.$class.ClassType()===Ae&&c.IsExternal&&3 in this.FCurrentParser.GetCurrentModeSwitches()&&!(27 in this.FCurrentParser.FScanner.FCurrentBoolSwitches))return 2}else if(o===ft){if(2===t.BaseType&&(c=t.LoTypeEl).$class.ClassType()===Ae&&c.IsExternal&&(this.IsExternalClass_Name(c,"Array")||this.IsExternalClass_Name(c,"Object")))return 3}else if(o===Me){if(4!==t.BaseType)return 2===t.BaseType?(c=t.LoTypeEl)===u?2:a(20180503134526):a(20180503134528)}else if(o.InheritsFrom(At)&&2===t.BaseType&&(c=t.LoTypeEl).$class.ClassType()===Ae&&this.IsExternalClass_Name(c,"Function"))return 3}else if(Oe.isPrototypeOf(t.IdentEl)&&(c=this.ResolveAliasType(t.IdentEl,!0),2===s.BaseType&&(u=s.LoTypeEl).$class.ClassType()===Ae&&u.IsExternal&&"Object"===u.ExternalName&&(c.$class.ClassType()===Ae||c.$class.ClassType()===Me)))return 10001;return l=Ie.CheckTypeCastRes.call(this,t,s,i,r)},this.ExtractPasStringLiteral=function(t,s){var i=this,r="",n=0,l=0,a=0;function o(e){i.RaiseMsg(e,3147,rtl.getResStr(Ee,"sIllegalCharConst"),[],t)}function h(){var e=0,t="\0";if(e=0,(n+=1)>a&&o(20170207155121),"$"===s.charAt(n-1)){for(l=n+=1;n<=a;){var i=t=s.charAt(n-1);if(i>="0"&&i<="9")e=16*e+t.charCodeAt()-48;else if(i>="a"&&i<="f")e=16*e+t.charCodeAt()-97+10;else{if(!(i>="A"&&i<="F"))break;e=16*e+t.charCodeAt()-65+10}e>1114111&&o(20170207164657),n+=1}n===l&&o(20170207164956)}else{for(l=n;n<=a;){t=s.charAt(n-1);if(!(t>="0"&&t<="9"))break;(e=10*e+t.charCodeAt()-48)>1114111&&o(20170207171140),n+=1}n===l&&o(20170207171148)}return e}var u="\0",c=0,p=0;for(r="",""===s&&this.RaiseInternalError(20170207154543,""),n=1,a=s.length;n<=a;){var f=s.charAt(n-1);if("'"===f){for(l=n+=1;;){if(n>a&&o(20170207155120),"'"===(u=s.charAt(n-1))){if(n>l&&(r+=kt(ue(s,l,n-l))),l=n+=1,n>a||"'"!==s.charAt(n-1))break;r+="'",l=n+=1}else n+=1}n>l&&(r+=kt(ue(s,l,n-l)))}else if("#"===f)(c=h())>=55296&&c<=57343&&n<a&&"#"===s.charAt(n-1)?(p=h())>=56320&&p<57343?r+=e.CodePointToJSString(((1023&c)<<10)+(1023&p)+65536):r=r+e.CodePointToJSString(c)+e.CodePointToJSString(p):r+=e.CodePointToJSString(c);else if("^"===f){(n+=1)>a&&o(20181025125920);var d=u=s.charAt(n-1);d>="a"&&d<="z"?r+=String.fromCharCode(u.charCodeAt()-97+1):d>="A"&&d<="Z"?r+=String.fromCharCode(u.charCodeAt()-65+1):o(20170207160412),n+=1}else o(20170207154653)}return r},this.ComputeConstString=function(e,t,s){var i="",r=null;if(i="",null===e&&this.RaiseInternalError(20170215123600,""),null!==(r=this.Eval(e,rtl.createSet(2),t)))try{8===r.Kind?i=r.S:(i=$t[r.Kind],this.RaiseXExpectedButYFound(20170211221121,"string literal",i,e))}finally{nt({get:function(){return r},set:function(e){r=e}})}return s&&""===i&&this.RaiseXExpectedButYFound(20170321085318,"string literal","empty",e),i},this.CheckAssignExprRangeToCustom=function(e,t,s){1===e.BaseType&&(it.isPrototypeOf(e.LoTypeEl)||this.RaiseInternalError(20170902165913,""),m.isPrototypeOf(e.LoTypeEl.FData)&&(1===e.LoTypeEl.FData.JSBaseType||this.RaiseNotYetImplemented(20170902170153,s,"")))},this.CheckAssignCompatibilityClasses=function(e,t){var s=0,i=null,r=null,n=null,l=null,a=0,o=null,h=null;if(s=2147483647,e.IsExternal&&t.IsExternal&&(i=e.FData,r=t.FData,n=i.SpecializedFromItem,l=r.SpecializedFromItem,null!==n&&null!==l&&n.GenericEl===l.GenericEl)){s=0;for(var u=0,c=rtl.length(n.Params)-1;u<=c;u++)if(a=u,o=n.Params[a],h=l.Params[a],!this.IsSameType(o,h,2)&&!this.IsJSBaseType(o,1)){s=2147483647;break}}return s},this.HasStaticArrayCloneFunc=function(e){var t,s=!1,i=null;t=rtl.length(e.Ranges);return 0===t?s=!1:1===t?(i=this.ResolveAliasType(e.ElType,!0),s=ft.isPrototypeOf(i)?rtl.length(i.Ranges)>0:!!Me.isPrototypeOf(i)||!!vt.isPrototypeOf(i)):s=!0,s},this.IsTGUID=function(e){var t,s=null,i=null,r=0,n=0;if(t=!1,!lt(e.FName,"TGUID"))return t;n=1;for(var l=0,a=(s=e.Members).FCount-1;l<=a;l++)if(r=l,(i=rtl.getObject(s.Get(r))).$class.ClassType()===Be&&lt(i.FName,"D"+oe(n))){if(4===n)return!0;n+=1}return t},this.GetAssignGUIDString=function(e,t,s){var i=!1,r=null,n="";if(i=!1,null===t)return i;if(!this.IsTGUID(e))return i;r=this.Eval(t,rtl.createSet(2),!0);try{8===r.Kind?n=r.S:this.RaiseXExpectedButYFound(20180415092350,"GUID string literal",r.AsString(),t),Dt(n,s)||this.RaiseXExpectedButYFound(20180415092351,"GUID string literal",r.AsString(),t),i=!0}finally{nt({get:function(){return r},set:function(e){r=e}})}return i},this.CheckDispatchField=function(t,s){var i,r,n=null,l="",a=null,o=null,u=0,c=null,p=Ue.$new();if(1!==(a=t.ProcType.Args).FCount&&this.RaiseNotYetImplemented(20190311213959,t,""),null!==(i=rtl.getObject(a.Get(0))).ArgType){for(n=t.FData.ClassRecScope,l="";null!==n;){var f=s;if(1===f){if(""!==n.DispatchField){l=n.DispatchField;break}}else if(2===f){if(""!==n.DispatchStrField){l=n.DispatchStrField;break}}else this.RaiseNotYetImplemented(20190311213650,t,"");n=rtl.as(n.AncestorScope,h)}if(""!==l)if(r=this.ResolveAliasType(i.ArgType,!0),Ne.isPrototypeOf(r)){for(var d=0,F=(o=r.Members).FCount-1;d<=F;d++)if(u=d,c=rtl.getObject(o.Get(u)),lt(c.FName,l)){if(c.$class.ClassType()!==Be)return void this.LogMsg(20190311215218,2,4030,rtl.getResStr(e,"sDispatchRequiresX"),pe(18,'field variable "'+l+'"'),i);this.ComputeElement(c.VarType,p,rtl.createSet(4),i);var m=s;if(1===m){if(!(p.BaseType in e.btAllJSInteger))return void this.LogMsg(20190311215215,2,4030,rtl.getResStr(e,"sDispatchRequiresX"),pe(18,'integer field "'+l+'"'),i)}else if(2===m&&!(p.BaseType in e.btAllJSStrings))return void this.LogMsg(20190312125025,2,4030,rtl.getResStr(e,"sDispatchRequiresX"),pe(18,'string field "'+l+'"'),i);return c.FName!==l?void this.LogMsg(20190311221651,2,4030,rtl.getResStr(e,"sDispatchRequiresX"),pe(18,'field name to match exactly "'+l+'"'),i):void 0}this.LogMsg(20190311214710,2,4030,rtl.getResStr(e,"sDispatchRequiresX"),pe(18,'record field "'+l+'"'),i)}else this.LogMsg(20190311214257,2,4030,rtl.getResStr(e,"sDispatchRequiresX"),pe(18,"record type"),i)}},this.AddMessageStr=function(t,s,i){var r=0;if(null===t.get())t.set(te.$create("Create$1"));else for(var n=0,l=t.get().GetCount()-1;n<=l;n++)r=n,t.get().Get(r)===s&&this.RaiseMsg(20190303233647,4029,rtl.getResStr(e,"sDuplicateMessageIdXAtY"),pe(18,s,18,this.GetElementSourcePosStr(t.get().GetObject(r).MessageExpr)),i.MessageExpr);t.get().AddObject(s,i)},this.AddMessageIdToClassScope=function(e,t){var s,i,r=null;s=e.FParent.FData,i=e.MessageExpr,null===(r=this.Eval(i,rtl.createSet(0),!0))&&this.RaiseMsg(20190303225651,3124,rtl.getResStr(Ee,"sIllegalExpressionAfterX"),pe(18,"message modifier"),i);try{var n=r.Kind;8===n?(this.AddMessageStr({p:s,get:function(){return this.p.MsgStrToProc},set:function(e){this.p.MsgStrToProc=e}},r.S,e),t&&this.CheckDispatchField(e,2)):4===n?(this.AddMessageStr({p:s,get:function(){return this.p.MsgIntToProc},set:function(e){this.p.MsgIntToProc=e}},oe(r.Int),e),t&&this.CheckDispatchField(e,1)):this.RaiseXExpectedButYFound(20190303225849,"integer constant",r.AsString(),i)}finally{nt({get:function(){return r},set:function(e){r=e}})}},this.ComputeResultElement=function(e,t,s,i){var r=null,n=null;5 in s&&At.isPrototypeOf(e.FParent)&&(r=e.FParent,Se.isPrototypeOf(r.FParent)&&r.FParent.IsAsync()&&null!==(n=this.FindTJSPromise(null)))?Lt(t,2,e,n,n,rtl.createSet(0,1)):Ie.ComputeResultElement.call(this,e,t,rtl.refSet(s),i)},this.ComputeProcAsyncResult=function(e,t,s,i){var r;return null!==(r=this.FindTJSPromise(null))&&(Lt(t,2,e,r,r,rtl.createSet(0,1)),!0)},this.CheckEqualCompatibilityUserType=function(e,t,s,i){var r;return 2147483647===(r=Ie.CheckEqualCompatibilityUserType.call(this,e,t,s,i))||(ft.isPrototypeOf(e.LoTypeEl)&&rtl.length(e.LoTypeEl.Ranges)>0&&this.RaiseMsg(20200508103543,3081,rtl.getResStr(Ee,"sXIsNotSupported"),pe(18,"compare static array"),s),ft.isPrototypeOf(t.LoTypeEl)&&rtl.length(t.LoTypeEl.Ranges)>0&&this.RaiseMsg(20200508103544,3081,rtl.getResStr(Ee,"sXIsNotSupported"),pe(18,"compare static array"),s)),r},this.RaiseMsg=function(e,t,s,i,r){Ie.RaiseMsg.call(this,e,t,s,i,r)},this.GetOverloadName=function(e){var t,s="",i=null,r=null;return t=e.FData,Pt.isPrototypeOf(t)&&(c.isPrototypeOf(t)?null!==(i=t).SpecializedFromItem?(""===(s=(r=i.SpecializedFromItem.GenericEl).FData.OverloadName)&&(s=r.FName+"$"),s=s+"G"+oe(i.SpecializedFromItem.Index+1)):s=i.OverloadName:s=p.isPrototypeOf(t)||f.isPrototypeOf(t)||u.isPrototypeOf(t)||h.isPrototypeOf(t)?t.JSName:"",""!==s)?s:s=e.FName},this.GetBaseDescription=function(t,s){return 1===t.BaseType&&m.isPrototypeOf(t.LoTypeEl.FData)?e.Pas2jsBaseTypeNames[t.LoTypeEl.FData.JSBaseType]:Ie.GetBaseDescription.call(this,t,s)},this.HasTypeInfo=function(e){var t=!1;return(t=Ie.HasTypeInfo.call(this,e))?(ke.isPrototypeOf(e.FParent)&&(t=!1),t):t},this.HasExtRTTI=function(e){var t,s=null,i=0,r=null,n=Bt.$new();if(t=!1,n.$assign(e.RTTIVisibility),rtl.eqSet(n.Fields,{})&&rtl.eqSet(n.Methods,{})&&rtl.eqSet(n.Properties,{}))return t;for(var l=0,a=(s=e.Members).FCount-1;l<=a;l++)if(i=l,r=rtl.getObject(s.Get(i)),e.HasExtRTTI(r))return!0;return t},this.ProcHasImplElements=function(e){var t=!1,s=null;return(t=Ie.ProcHasImplElements.call(this,e))||(null!==(s=rtl.as(e.FData,c)).ImplProc&&(s=rtl.as(s.ImplProc.FData,c)),null!==s.ImplJS&&""!==s.ImplJS.BodyJS&&(t=!s.ImplJS.EmptyJS)),t},this.HasAnonymousFunctions=function(e){var t=y.$new();return null!==e&&(t.$assign(y.$new()),e.ForEachCall(rtl.createCallback(this,"OnHasAnonymousEl"),t),null!==t.Expr)},this.GetTopLvlProcScope=function(e){var t=null,s=null;for(t=null;null!==e;){if(Se.isPrototypeOf(e))return s=e,c.isPrototypeOf(s.FData)&&(t=s.FData),t;e=e.FParent}return t},this.ProcCanBePrecompiled=function(e){var t=null,s=null;if(null!==this.GetProcTemplateTypes(e))return!1;if(null!==rtl.as(e.FData,c).SpecializedFromItem)return!1;for(t=e;;){if(null===(t=t.FParent))return!0;if(Se.isPrototypeOf(t))return!1;if(gt.isPrototypeOf(t)){if(null!==(s=t.GenericTemplateTypes)&&s.FCount>0)return!1;if(null!==rtl.as(t.FData,Pt).SpecializedFromItem)return!1}}return!1},this.IsReadEqWrite=function(e){var t=!1,s=null,i=null,r=null,n=null;if(!(0 in e.Flags))return t;if(!(1 in e.Flags))return t;if(t=!1,i=e.IdentEl,2===e.BaseType&&null!==i){if((s=i.$class.ClassType())===Be||s===be||s===ze)return!0;if(s===Ye)return!0;if(s===xe){if(n=i,r=this.GetPasPropertyGetter(n),!Be.isPrototypeOf(r))return t;t=r===this.GetPasPropertySetter(n)}}return t},this.IsTObjectFreeMethod=function(e){var t,s=!1,i=null;return s=!1,null===e||e.$class.ClassType()!==_e?s:ve.isPrototypeOf(e.FData)?(t=e.FData,0!==ye(e.Value,"free")||(i=t.FDeclaration).$class.ClassType()!==Se||i.FParent.$class.ClassType()!==Ae||0!==ye(i.FParent.FName,"tobject")||12 in i.FModifiers||i.ProcType.Args.FCount>0?s:s=!0):s},this.IsManagedJSType=function(e){var t=!1;return t=!1,null===e||((e=this.ResolveAliasType(e,!0)).$class.ClassType()===Ae&&2===e.ObjKind&&0===e.InterfaceType?t=!0:ft.isPrototypeOf(e)?t=null!==e.FData&&rtl.as(e.FData,p).Managed:Me.isPrototypeOf(e)&&(t=rtl.as(e.FData,u).Managed)),t},this.IsExternalBracketAccessor=function(t){return!(!Se.isPrototypeOf(t)||null===t.LibrarySymbolName)&&this.ComputeConstString(t.LibrarySymbolName,!1,!1)===e.ExtClassBracketAccessor},this.IsExternalClassConstructor=function(e){var t=null;return!(e.$class.ClassType()!==Ft||!(12 in e.FModifiers)||null===(t=e.FParent)||t.$class.ClassType()!==Ae||!t.IsExternal)||false},this.IsForInExtArray=function(t,s,i,r,n,l){var a,o,h,u,c=!1,p=null,f=null,d=null;return c=!1,r.$assign(Ue.$new()),n.$assign(Ue.$new()),l.$assign(Ue.$new()),(p=i.LoTypeEl).$class.ClassType()===Ae&&p.IsExternal?null===(d=(f=p).FData.DefaultProperty)||1!==d.FArgs.FCount?c:(a=rtl.getObject(d.FArgs.Get(0))).Access in rtl.createSet(0,1)?(this.ComputeElement(a,r,{},null),r.BaseType in e.btAllJSInteger?(h=this.PushClassDotScope({get:function(){return f},set:function(e){f=e}},!0).FindIdentifier("length"),this.PopScope(),null!==h&&Be.isPrototypeOf(h.FElement)?(u=h.FElement,this.ComputeElement(u,n,{},null),this.IsSameType(n.LoTypeEl,r.LoTypeEl,0)?(c=!0,o=this.GetPasPropertyGetter(d),this.IsExternalBracketAccessor(o)||this.RaiseMsg(20180519141636,4010,rtl.getResStr(e,"sForInJSArrDefaultGetterNotExtBracketAccessor"),[],t.StartExpr),this.ComputeElement(d.VarType,l,{},null),l.Flags=rtl.includeSet(l.Flags,0),this.CheckAssignResCompatibility(s,l,t.VariableName,!0),c):c):c):c):c:c},this.IsHelperMethod=function(e){var t=!1;return(t=Ie.IsHelperMethod.call(this,e))?t=!e.IsExternal():t},this.IsHelperForMember=function(e){var t=null;return null!==e&&(null!==(t=e.FParent)&&t.$class.ClassType()===Ae&&null!==t.HelperForType&&(Se.isPrototypeOf(e)?e.IsExternal():!!Be.isPrototypeOf(e)&&1 in e.VarModifiers))},this.ImplBlockReadsDecl=function(e,t){var s=g.$new();return s.Decl=t,s.El=null,e.ForEachCall(rtl.createCallback(this,"OnHasElReadingDecl"),s),null!==s.El}}),this.TCtxAccess={0:"caRead",caRead:0,1:"caAssign",caAssign:1,2:"caByReference",caByReference:2},this.TCtxVarKind={0:"cvkNone",cvkNone:0,1:"cvkGlobal",cvkGlobal:1,2:"cvkCurType",cvkCurType:2,3:"cvkInstance",cvkInstance:3,4:"cvkHelperTemp",cvkHelperTemp:4},this.cvkAll=rtl.createSet(null,0,4),rtl.createClass(this,"TConvertContext",V,function(){P=this,this.$init=function(){V.$init.call(this),this.PasElement=null,this.JSElement=null,this.Resolver=null,this.Parent=null,this.IsGlobal=!1,this.Access=0,this.AccessContext=null,this.ScannerBoolSwitches={},this.ScannerModeSwitches={}},this.$final=function(){this.PasElement=void 0,this.JSElement=void 0,this.Resolver=void 0,this.Parent=void 0,this.AccessContext=void 0,this.ScannerBoolSwitches=void 0,this.ScannerModeSwitches=void 0,V.$final.call(this)},this.Create$1=function(e,t,s){return this.PasElement=e,this.JSElement=t,this.Parent=s,null!==this.Parent&&(this.Resolver=this.Parent.Resolver,this.Access=s.Access,this.AccessContext=s.AccessContext,this.ScannerBoolSwitches=rtl.refSet(s.ScannerBoolSwitches),this.ScannerModeSwitches=rtl.refSet(s.ScannerModeSwitches)),this},this.GetRootContext=function(){var e=null;for(e=this;null!==e.Parent;)e=e.Parent;return e},this.GetNonDotContext=function(){var e=null;for(e=this;b.isPrototypeOf(e);)e=e.Parent;return e},this.GetFunctionContext=function(){return this.GetContextOfType(v)},this.GetLocalName=function(e,t){return null!==this.Parent?this.Parent.GetLocalName(e,t):""},this.GetSelfContext=function(){var e=null,t=null,s=null;for(e=this;null!==e;){if(v.isPrototypeOf(e)&&(s=(t=e).ThisVar,Ne.isPrototypeOf(s.Element)&&s.Kind in rtl.createSet(1,2,3)))return t;e=e.Parent}return null},this.GetFuncContextOfPasElement=function(e){var t=null,s=null;Se.isPrototypeOf(e)&&null!==(s=e.FData).ImplProc&&(e=s.ImplProc),t=this;do{if(t.PasElement===e&&v.isPrototypeOf(t))return t;t=t.Parent}while(null!==t);return null},this.GetContextOfType=function(e){var t=null;t=this;do{if(e.isPrototypeOf(t))return t;t=t.Parent}while(null!==t);return null},this.GetMainSectionContext=function(){var e=null,t=null;t=this;do{N.isPrototypeOf(t)&&(e=t),t=t.Parent}while(null!==t);return e},this.CurrentModeSwitches=function(){return null===this.Resolver?rtl.refSet(le.OBJFPCModeSwitches):rtl.refSet(this.Resolver.FCurrentParser.GetCurrentModeSwitches())},this.GetGlobalFunc=function(){var e=null;for(e=this;null!==e;){if(e.IsGlobal&&null!==e.JSElement&&v.isPrototypeOf(e))return e;e=e.Parent}return null}}),rtl.createClass(this,"TRootContext",P,function(){I=this,this.$init=function(){P.$init.call(this),this.ResourceStrings=null,this.GlobalClassMethods=[]},this.$final=function(){this.ResourceStrings=void 0,this.GlobalClassMethods=void 0,P.$final.call(this)},this.AddGlobalClassMethod=function(e){this.GlobalClassMethods=rtl.arrayInsert(e,this.GlobalClassMethods,rtl.length(this.GlobalClassMethods))},this.Destroy=function(){V.Destroy.call(this)}}),rtl.createClass(this,"TFCLocalIdentifier",V,function(){R=this,this.$init=function(){V.$init.call(this),this.Element=null,this.Name="",this.Kind=0},this.$final=function(){this.Element=void 0,V.$final.call(this)},this.Create$1=function(e,t,s){return this.Name=e,this.Element=t,this.Kind=s,this}}),rtl.createClass(this,"TFunctionContext",P,function(){v=this,this.$init=function(){P.$init.call(this),this.LocalVars=[],this.ThisVar=null,this.IntfElReleases=null,this.ResultNeedsIntfRelease=!1,this.IntfExprReleaseCount=0,this.BodySt=null,this.TrySt=null,this.FinallyFirst=null,this.FinallyLast=null},this.$final=function(){this.LocalVars=void 0,this.ThisVar=void 0,this.IntfElReleases=void 0,this.BodySt=void 0,this.TrySt=void 0,this.FinallyFirst=void 0,this.FinallyLast=void 0,P.$final.call(this)},this.Create$1=function(e,t,s){return P.Create$1.call(this,e,t,s),this.ThisVar=R.$create("Create$1",["this",null,0]),this.LocalVars=rtl.arraySetLength(this.LocalVars,null,1),this.LocalVars[0]=this.ThisVar,this},this.Destroy=function(){j({p:this,get:function(){return this.p.IntfElReleases},set:function(e){this.p.IntfElReleases=e}});for(var e=0,t=rtl.length(this.LocalVars)-1;e<=t;e++)j({a:e,p:this.LocalVars,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}});this.ThisVar=null,V.Destroy.call(this)},this.AddLocalVar=function(e,t,i,r){var n,l,a=null,o=null;if(null!==this.FindLocalVar(e,!0)){if(r)e=this.CreateLocalIdentifier(e,t,i);else if(null===(a=this.FindLocalVar(e,!1)));else if(t===a.Element)throw s.$create("Create$1",['[20200608131330] "'+e+'" El='+Pe(t)])}else 1===i&&null!==(o=this.FindPrecompiledVar$1(t,!0))&&(e=o.Name);return l=rtl.length(this.LocalVars),this.LocalVars=rtl.arraySetLength(this.LocalVars,null,l+1),n=R.$create("Create$1",[e,t,i]),this.LocalVars[l]=n,n},this.AddLocalJSVar=function(e,t){return this.AddLocalVar(e,null,0,t)},this.Add_InterfaceRelease=function(e){null===this.IntfElReleases&&(this.IntfElReleases=_.$create("Create")),this.IntfElReleases.IndexOf(e)>=0||this.IntfElReleases.Add(e)},this.CreateLocalIdentifier=function(e,t,s){var i="",r=0,n=null;if(1===s&&null!==(n=this.FindPrecompiledVar$1(t,!0)))return n.Name;for(i=e,r=0;null!==this.FindLocalVar(i,!0)||1===s&&null!==this.FindPrecompiledVar(i,!0);)i=e+oe(r+=1);return i},this.GetLocalName=function(t,s){var i=this;function r(r,n){var l=!1;if(l=!1,""!==r.Name&&r.Element===t&&r.Kind in s){if("this"===r.Name&&n!==i)return l;if(rtl.neSet(s,e.cvkAll)&&i.FindLocalVar(r.Name,!0)!==r)return l;l=!0}return l}var n=null,l=null,a=0;if(null===t)return"";l=i;do{if(r(l.ThisVar,l))return"this";for(var o=0,h=rtl.length(l.LocalVars)-1;o<=h;o++)if(a=o,r(n=l.LocalVars[a],l))return n.Name;l=l.Parent.GetFunctionContext()}while(null!==l);return""},this.IndexOfLocalVar=function(e){for(var t=0,s=0,i=rtl.length(this.LocalVars)-1;s<=i;s++)if(t=s,this.LocalVars[t].Name===e)return t;return-1},this.FindLocalVar=function(e,t){var s,i=null;return(s=this.IndexOfLocalVar(e))>=0?this.LocalVars[s]:t&&null!==this.Parent?null===(i=this.Parent.GetFunctionContext())?null:i.FindLocalVar(e,!0):null},this.FindPrecompiledVar=function(e,t){var s=null;return t&&null!==this.Parent?null===(s=this.Parent.GetFunctionContext())?null:s.FindPrecompiledVar(e,!0):null},this.FindPrecompiledVar$1=function(e,t){var s=null;return t&&null!==this.Parent?null===(s=this.Parent.GetFunctionContext())?null:s.FindPrecompiledVar$1(e,!0):null}}),rtl.createClass(this,"TObjectContext",P,function(){A=this}),rtl.createClass(this,"TSectionContext",v,function(){N=this,this.$init=function(){v.$init.call(this),this.SrcElements=null,this.HeaderIndex=0,this.PrecompiledVars=[]},this.$final=function(){this.SrcElements=void 0,this.PrecompiledVars=void 0,v.$final.call(this)},this.Create$1=function(e,t,s){return v.Create$1.apply(this,arguments),this.IsGlobal=!0,this.SrcElements=rtl.as(t,Gt),this},this.AddHeaderStatement=function(e){null!==e&&(this.SrcElements.FStatements.InsertNode(this.HeaderIndex).FNode=e,this.HeaderIndex+=1)},this.FindPrecompiledVar=function(e,t){for(var s=null,i=0,r=0,n=rtl.length(this.PrecompiledVars)-1;r<=n;r++)if(i=r,(s=this.PrecompiledVars[i]).Name===e)return s;return t?s=v.FindPrecompiledVar.call(this,e,t):null},this.FindPrecompiledVar$1=function(e,t){for(var s=null,i=0,r=0,n=rtl.length(this.PrecompiledVars)-1;r<=n;r++)if(i=r,(s=this.PrecompiledVars[i]).Element===e)return s;return t?s=v.FindPrecompiledVar$1.call(this,e,t):null}}),rtl.createClass(this,"TInterfaceSectionContext",N,function(){x=this,this.$init=function(){N.$init.call(this),this.ImplContext=null,this.ImplHeaderStatements=null,this.ImplSrcElements=null,this.ImplHeaderIndex=0},this.$final=function(){this.ImplContext=void 0,this.ImplHeaderStatements=void 0,this.ImplSrcElements=void 0,N.$final.call(this)},this.Destroy=function(){var e=0,t=null;if(null!==this.ImplHeaderStatements){for(var s=0,i=this.ImplHeaderStatements.FCount-1;s<=i;s++)e=s,t=rtl.getObject(this.ImplHeaderStatements.Get(e)),t=rtl.freeLoc(t);j({p:this,get:function(){return this.p.ImplHeaderStatements},set:function(e){this.p.ImplHeaderStatements=e}})}v.Destroy.call(this)},this.AddImplHeaderStatement=function(e){null!==e&&(null!==this.ImplContext?this.ImplContext.AddHeaderStatement(e):null!==this.ImplSrcElements?(this.ImplSrcElements.FStatements.InsertNode(this.ImplHeaderIndex).FNode=e,this.ImplHeaderIndex+=1):(null===this.ImplHeaderStatements&&(this.ImplHeaderStatements=_.$create("Create")),this.ImplHeaderStatements.Add(e)))}}),rtl.createClass(this,"TDotContext",P,function(){b=this,this.$init=function(){P.$init.call(this),this.LeftResolved=Ue.$new(),this.JS=null},this.$final=function(){this.LeftResolved=void 0,this.JS=void 0,P.$final.call(this)}}),rtl.createClass(this,"TAssignContext",P,function(){O=this,this.$init=function(){P.$init.call(this),this.LeftResolved=Ue.$new(),this.RightResolved=Ue.$new(),this.RightSide=null,this.PropertyEl=null,this.Call=null},this.$final=function(){this.LeftResolved=void 0,this.RightResolved=void 0,this.RightSide=void 0,this.PropertyEl=void 0,this.Call=void 0,P.$final.call(this)},this.Create$1=function(e,t,s){return P.Create$1.call(this,e,t,s),this.Access=1,this.AccessContext=this,this}}),rtl.createClass(this,"TParamContext",P,function(){k=this,this.$init=function(){P.$init.call(this),this.Arg=null,this.Expr=null,this.ResolvedExpr=Ue.$new(),this.Setter=null,this.ReusingReference=!1},this.$final=function(){this.Arg=void 0,this.Expr=void 0,this.ResolvedExpr=void 0,this.Setter=void 0,P.$final.call(this)},this.Create$1=function(e,t,s){return P.Create$1.call(this,e,t,s),this.Access=1,this.AccessContext=this,this}}),this.DefaultJSWriterOptions=rtl.createSet(4,5,6),rtl.createClass(this,"TPasToJSConverterGlobals",V,function(){$=this,this.$init=function(){V.$init.call(this),this.FOwner=null,this.BuiltInNames=rtl.arraySetLength(null,"",189),this.RTLVersion=0,this.TargetPlatform=0,this.TargetProcessor=0},this.$final=function(){this.FOwner=void 0,this.BuiltInNames=void 0,V.$final.call(this)},this.Create$1=function(e){return this.FOwner=e,this.ResetBuiltInNames(),this},this.Reset=function(){this.RTLVersion=1,this.TargetPlatform=0,this.TargetProcessor=0,this.ResetBuiltInNames()},this.ResetBuiltInNames=function(){for(var t=0,s=0;s<=188;s++)t=s,this.BuiltInNames[t]=e.Pas2JSBuiltInNames[t]}}),this.TRefPathKind={0:"rpkPath",rpkPath:0,1:"rpkPathWithDot",rpkPathWithDot:1,2:"rpkPathAndName",rpkPathAndName:2},rtl.createClass(this,"TPasToJSConverter",V,function(){this.TMemberFunc={0:"mfInit",mfInit:0,1:"mfFinalize",mfFinalize:1},rtl.recNewT(this,"TCreateRefPathData",function(){D=this,this.El=null,this.Full=!1,this.Ref=null,this.$eq=function(e){return this.El===e.El&&this.Full===e.Full&&this.Ref===e.Ref},this.$assign=function(e){return this.El=e.El,this.Full=e.Full,this.Ref=e.Ref,this}}),this.pfVar=1,this.pfConst=2,this.pfOut=4,this.pfArray=8,this.pfStatic=1,this.pfVarargs=2,this.pfExternal=4,this.pfSafeCall=8,this.pfAsync=16,this.pfGetFunction=1,this.pfSetProcedure=2,this.pfStoredTrue=0,this.pfStoredFalse=4,this.pfStoredField=8,this.pfStoredFunction=12,this.pfHasIndex=16,this.pfClassProperty=32,this.TMethodKind={0:"mkProcedure",mkProcedure:0,1:"mkFunction",mkFunction:1,2:"mkConstructor",mkConstructor:2,3:"mkDestructor",mkDestructor:3,4:"mkClassProcedure",mkClassProcedure:4,5:"mkClassFunction",mkClassFunction:5},this.TOrdType={0:"otSByte",otSByte:0,1:"otUByte",otUByte:1,2:"otSWord",otSWord:2,3:"otUWord",otUWord:3,4:"otSLong",otSLong:4,5:"otULong",otULong:5,6:"otSIntDouble",otSIntDouble:6,7:"otUIntDouble",otUIntDouble:7},this.pas2js_vtInteger=0,this.pas2js_vtBoolean=1,this.pas2js_vtExtended=3,this.pas2js_vtPointer=5,this.pas2js_vtObject=7,this.pas2js_vtClass=8,this.pas2js_vtWideChar=9,this.pas2js_vtCurrency=12,this.pas2js_vtInterface=14,this.pas2js_vtUnicodeString=18,this.pas2js_vtNativeInt=19,this.pas2js_vtJSValue=20,this.$init=function(){V.$init.call(this),this.FGlobals=null,this.FOnIsElementUsed=null,this.FOnIsTypeInfoUsed=null,this.FOptions={},this.FReservedWords=[]},this.$final=function(){this.FGlobals=void 0,this.FOnIsElementUsed=void 0,this.FOnIsTypeInfoUsed=void 0,this.FOptions=void 0,this.FReservedWords=void 0,V.$final.call(this)},this.GetUseEnumNumbers=function(){return 2 in this.FOptions},this.GetUseLowerCase=function(){return 0 in this.FOptions},this.GetUseSwitchStatement=function(){return 1 in this.FOptions},this.GetBIName=function(e){return this.FGlobals.BuiltInNames[e]},this.AddGlobalClassMethod=function(e,t){var s=null;s=e.GetRootContext(),I.isPrototypeOf(s)||this.DoError(20190226232141,s.$classname),s.AddGlobalClassMethod(t)},this.CreatePrimitiveDotExpr=function(t,s){var i,r=null,n=null,l=null;return""===t&&this.RaiseInconsistency(20170402230134,s),(i=e.PosLast(".",t))>0?((n=null!==s?this.CreateElement(wt,s):wt.$create("Create$1",[0,0,""])).FName=ue(t,i+1,t.length),n.FMExpr=this.CreatePrimitiveDotExpr(he(t,i-1),s),r=n):((l=null!==s?this.CreateElement(Vt,s):Vt.$create("Create$1",[0,0,""])).FName=t,r=l),r},this.CreateSubDeclJSNameExpr=function(e,t,s,i){var r=null,n={},l="";return(r=e.$class.ClassType()).InheritsFrom(Oe)||r===be?n=rtl.createSet(1):r.InheritsFrom(Be)?(n=rtl.createSet(2),n=rtl.neSet(rtl.intersectSet(rtl.createSet(4,5),e.VarModifiers),{})?rtl.createSet(1):Ne.isPrototypeOf(e.FParent)?rtl.createSet(2):rtl.createSet(1)):n=ke.isPrototypeOf(e.FParent)?{}:rtl.createSet(1),rtl.neSet(n,{})&&(""===(l=this.GetLocalName(e.FParent,n,s))&&(l="this"),t="["===t.charAt(0)?l+t:l+"."+t),this.CreatePrimitiveDotExpr(t,i)},this.CreateSubDeclPasNameExpr=function(e,t,s,i){var r;return r=this.TransformToJSName(e,t,!1,s),this.CreateSubDeclJSNameExpr(e,r,s,i)},this.CreateSubDeclNameExpr=function(e,t,s){var i;return i=this.TransformElToJSName(e,t),this.CreateSubDeclJSNameExpr(e,i,t,s)},this.CreateIdentifierExpr=function(e,t){return this.CreatePrimitiveDotExpr(this.TransformElToJSName(e,t),e)},this.CreateIdentifierExpr$1=function(e,t,s,i){return this.CreatePrimitiveDotExpr(this.TransformToJSName(s,e,t,i),s)},this.CreateSwitchStatement=function(e,t){var s=null,i=null,r=null,n=null,l=!1,a=0,o=0,h=null,u=null,c=null,p=null;s=this.CreateElement(Ut,e),l=!1;try{s.FCond=this.ConvertExpression(e.CaseExpr,t);for(var f=0,d=e.Elements.FCount-1;f<=d;f++)if(a=f,r=rtl.getObject(e.Elements.Get(a)),Jt.isPrototypeOf(r)){i=null;for(var F=0,m=(n=r).Expressions.FCount-1;F<=m;F++)o=F,p=rtl.getObject(n.Expressions.Get(o)),(i=s.FCases.AddCase()).FExpr=this.ConvertExpression(p,t);u=null,null!==n.Body&&(u=this.ConvertElement(n.Body,t)),h=this.CreateElement(jt,n),null===u?u=h:Ht.isPrototypeOf(u)?(c=u,this.AddToStatementList({get:function(){return u},set:function(e){u=e}},{get:function(){return c},set:function(e){c=e}},h,n)):((c=this.CreateElement(Ht,n)).FA=u,c.FB=h,u=c),i.FBody=u}null!==e.ElseBranch&&((i=s.FCases.AddCase()).FBody=this.ConvertImplBlockElements(e.ElseBranch,t,!1),s.FDefault=i),l=!0}finally{l||(s=rtl.freeLoc(s))}return s},this.CreateTypeDecl=function(e,t){var s,i=null,r=null;return i=null,r=t,ke.isPrototypeOf(e.FParent)&&(r=t.GetGlobalFunc()),(s=e.$class.ClassType())===Ae?i=this.ConvertClassType(e,r):s===Tt?i=this.ConvertClassOfType(e,r):s===Me?i=this.ConvertRecordType(e,r):s===st?i=this.ConvertEnumType(e,r):s===vt?i=this.ConvertSetType(e,r):s===rt?i=this.ConvertRangeType(e,r):s===Wt||(s===Yt?i=this.ConvertTypeAliasType(e,r):s===Qe?i=this.ConvertPointerType(e,r):s===At||s===Xe?i=this.ConvertProcedureType(e,r):s===ft?i=this.ConvertArrayType(e,r):s===bt||this.RaiseNotSupported(e,t,20170208144053,"")),i},this.CreateVarDecl=function(e,t){var s=null,i=null,r=null,n=null,l=null;return s=null,null!==e.AbsoluteExpr||1 in e.VarModifiers||(A.isPrototypeOf(t)?((l=rtl.as(t.JSElement,zt).FElements.AddElement()).FName=this.TransformElToJSName(e,t),l.FExpr=this.CreateVarInit(e,t)):t.IsGlobal||Ne.isPrototypeOf(e.FParent)?(s=n=this.CreateElement(_t,e),n.FLHS=this.CreateSubDeclNameExpr(e,t,null),n.FExpr=this.CreateVarInit(e,t)):(null===(i=this.ConvertVariable(e,t))&&this.RaiseInconsistency(20180501114300,e),(r=this.CreateElement(Kt,e)).FA=i,s=r)),s},this.AddToSourceElements=function(e,t){for(var s=null,i=null;null!==t;)Ht.isPrototypeOf(t)?(i=(s=rtl.as(t,Ht)).FA,t=s.FB,s.FA=null,s.FB=null,j({get:function(){return s},set:function(e){s=e}})):(i=t,t=null),e.FStatements.AddNode(!1,!1).FNode=i},this.RemoveFromSourceElements=function(e,t){for(var s=null,i=0,r=(s=e.FStatements).GetCount()-1;r>=0;r--)i=r,s.GetN(i).FNode===t&&s.Delete(i)},this.SetGlobals=function(e){this.FGlobals!==e&&(null!==this.FGlobals&&this.FGlobals.FOwner===this&&j({p:this,get:function(){return this.p.FGlobals},set:function(e){this.p.FGlobals=e}}),this.FGlobals=e)},this.OnCreateReferencePathExpr=function(e,t,s){return this.CreateReferencePathExpr(s.El,t,s.Full,s.Ref)},this.DoError=function(e,t){var i=null;throw(i=s.$create("Create$1",[t])).Id=e,i.MsgType=1,i},this.DoError$2=function(e,t,i,r,n){var l=null;throw(l=s.$create("CreateFmt",[i,r])).PasElement=n,l.MsgNumber=t,l.Id=e,l.MsgType=1,Xt({p:l,get:function(){return this.p.Args},set:function(e){this.p.Args=e}},r),l},this.RaiseNotSupported=function(t,i,r,n){var l=null;throw l=s.$create("CreateFmt",[rtl.getResStr(e,"sPasElementNotSupported"),pe(18,Ge(t)+" ["+oe(r)+"]")]),""!==n&&(l.fMessage=l.fMessage+": "+n),l.PasElement=t,l.MsgNumber=4001,l.Args=rtl.arraySetLength(l.Args,"",1),l.Args[0]=t.$classname,l.Id=r,l.MsgType=1,l},this.RaiseIdentifierNotFound=function(e,t,i){var r=null;throw(r=s.$create("CreateFmt",[rtl.getResStr(Ee,"sIdentifierNotFound"),pe(18,e)])).PasElement=t,r.MsgNumber=3001,r.Args=rtl.arraySetLength(r.Args,"",1),r.Args[0]=e,r.Id=i,r.MsgType=1,r},this.RaiseInconsistency=function(e,t){var s="";throw s="TPasToJSConverter.RaiseInconsistency["+oe(e)+"]: you found a bug",null!==t&&(s+=De(t),""!==t.FName?s+=t.FName:s+=at(t),s=s+" at "+T.GetDbgSourcePosStr(t)),B.$create("Create$1",[s])},this.GetExpressionValueType=function(e,t){var s=0;if(qt.isPrototypeOf(e))s=2;else if(_e.isPrototypeOf(e)){var i=e.Kind;0===i?s=this.GetPasIdentValueType(e.FName,t):1===i?s=3:2===i||3===i?s=4:4===i?s=0:5===i?s=1:6===i?s=2:7===i||10===i||11===i||12===i||13===i?s=0:14===i&&(s=5)}else s=Qt.isPrototypeOf(e)?this.GetExpressionValueType(e.Operand,t):Je.isPrototypeOf(e)?function(e,t){return 0===e?t:e}(this.GetExpressionValueType(e.Left,t),this.GetExpressionValueType(e.Right,t)):0;return s},this.GetPasIdentValueType=function(e,t){return 0},this.ComputeConstString=function(e,t,s){var i="",r=null;null!==t.Resolver?i=t.Resolver.ComputeConstString(e,!1,s):(i="",_e.isPrototypeOf(e)?2===(r=e).Kind?(i=r.Value,i=Zt(i,"'")):this.RaiseNotSupported(r,t,20170215124733,""):this.RaiseNotSupported(e,t,20170322121331,""));return i},this.IsLiteralInteger=function(e,t){var s,i=null;if(s=!1,!es.isPrototypeOf(e))return s;if(3===(i=e.FValue).FValueType)try{if(t.set(Math.round(i.GetAsNumber())),t.get()===i.GetAsNumber())return!0}catch(e){}return s},this.IsLiteralNull=function(e){return es.isPrototypeOf(e)&&e.FValue.GetIsNull()},this.GetOverloadName=function(e,t){return null!==t.Resolver?t.Resolver.GetOverloadName(e):e.FName},this.CanClashWithGlobal=function(e){return e.$class.ClassType()===Ye||(!!ke.isPrototypeOf(e.FParent)||!!ut.isPrototypeOf(e.FParent))},this.TransformToJSName=function(e,t,s,i){var r="",n=0,l="\0";if(ts(".",t)>0&&this.RaiseInconsistency(20170203164711,e),r=this.GetUseLowerCase()?H(t):t,!this.IsReservedWord(r,s))return r;for(var a=1,o=r.length;a<=o;a++){n=a;l=r.charAt(n-1);if((l>="a"&&l<="z"||l>="A"&&l<="Z")&&(r=rtl.setCharAt(r,n-1,String.fromCharCode(32^l.charCodeAt())),!this.IsReservedWord(r,s)))return r}return this.RaiseNotSupported(e,i,20170203131832,""),r},this.TransformElToJSName=function(e,t){var s=null;return Se.isPrototypeOf(e)&&null!==e.LibrarySymbolName?this.ComputeConstString(e.LibrarySymbolName,t,!0):Be.isPrototypeOf(e)&&null!==e.ExportName?this.ComputeConstString(e.ExportName,t,!0):Oe.isPrototypeOf(e)?(s=null!==t.Resolver?t.Resolver.ResolveAliasType(e,!0):e).$class.ClassType()===Ae&&s.IsExternal?s.ExternalName:this.TransformToJSName(e,this.GetOverloadName(s,t),this.CanClashWithGlobal(s),t):this.TransformToJSName(e,this.GetOverloadName(e,t),this.CanClashWithGlobal(e),t)},this.TransformModuleName=function(e,t,s){var i="",r=0,n=0,l="",a="";if(t&&""!==(i=this.GetLocalName(e,rtl.createSet(1),s)))return i;if(e.$class.ClassType()===et)i=this.GetBIName(141);else if(e.$class.ClassType()===tt)i=this.GetBIName(128);else for(i="",l=e.FName,r=1;r<=l.length;){for(n=r;r<=l.length&&"."!==l.charAt(r-1);)r+=1;a=ue(l,n,r-n),""!==i&&(i+="."),i+=a=this.TransformToJSName(e,a,!1,s),r+=1}return t&&(i=ts(".",i)>0?this.GetBIName(137)+'["'+i+'"]':this.GetBIName(137)+"."+i,10 in this.FOptions&&(i=this.CreateGlobalAliasForeign(e,i,s))),i},this.IsReservedWord=function(t,s){var i=!1,r=0,n=0,l=0,a=0;if(i=!0,t===this.GetBIName(137))return i;if(t===this.GetBIName(144))return i;for(r=0,n=59;r<=n;)if(l=rtl.trunc((r+n)/2),(a=ss(t,e.JSReservedWords[l]))>0)r=l+1;else{if(!(a<0))return i;n=l-1}for(r=0,n=rtl.length(this.FReservedWords)-1;r<=n;)if(l=rtl.trunc((r+n)/2),(a=ss(t,this.FReservedWords[l]))>0)r=l+1;else{if(!(a<0))return i;n=l-1}if(s)for(r=0,n=52;r<=n;)if(l=rtl.trunc((r+n)/2),(a=ss(t,e.JSReservedGlobalWords[l]))>0)r=l+1;else{if(!(a<0))return i;n=l-1}return i=!1},this.GetTypeInfoName=function(t,s,i,r){var n="",l=null,a=0,o=0,h=null,u="";if(n="",null===(t=is(t))&&this.RaiseInconsistency(20170409172756,t),(l=t.$class.ClassType())===bt&&(rs.isPrototypeOf(t.FData)||this.RaiseInconsistency(20200220113319,t),l=(t=t.FData.SpecializedType).$class.ClassType()),t===s.PasElement&&!r){if(Ne.isPrototypeOf(t))return n=this.GetBIName(153);this.RaiseNotSupported(i,s,20170905150746,"cannot typeinfo itself")}if(l===it){if(""===t.FName&&this.DoError$2(20170905150752,4021,rtl.getResStr(e,"sTypeXCannotBePublished"),pe(18,"typeinfo of anonymous "+t.ElementTypeName()),i),ne.isPrototypeOf(t.FData)){var c=a=t.FData.BaseType;6===c?a=5:9===c?a=7:14===c&&(a=28);var p=a;if(20===p||19===p||22===p||21===p||26===p||25===p||28===p||27===p||7===p||5===p||11===p||15===p||29===p)return n=this.GetBIName(144)+"."+H(s.Resolver.GetBaseTypeNames(a));if(1===p&&m.isPrototypeOf(t.FData)&&1===(o=t.FData.JSBaseType))return n=this.GetBIName(144)+"."+H(e.Pas2jsBaseTypeNames[o])}}else if(l===st||l===vt||l===Ae||l===Tt||l===ft||l===At||l===Xe||l===Qe||l===Yt||l===Me||l===rt){for(h=is(t);;){if(n=""!==h.FName?h.FName+n:this.GetBIName(170)+n,null===(h=h.FParent))break;if((l=h.$class.ClassType())===Ae||l===Me)n="."+n;else if(!l.InheritsFrom(Oe)&&l!==Be&&l!==be&&l!==Ye&&l!==xe)break}if(ct.isPrototypeOf(h))return n}return""===(u=t.FName)&&(u=t.$classname),this.DoError$2(20170409173329,4021,rtl.getResStr(e,"sTypeXCannotBePublished"),pe(18,u),i),n},this.TransformArgName=function(t,s){var i="";return i=t.FName,0===ye(i,"Self")&&Se.isPrototypeOf(t.FParent)?""===(i=s.GetLocalName(t,e.cvkAll))&&this.RaiseNotSupported(t,s,20190205190114,Ge(t.FParent)):i=this.TransformToJSName(t,i,!0,s),i},this.CreateGlobalAliasForeign=function(e,t,s){var i,r="",n=null,l=null,a=null,o=null,h=null,u=null,c=null;return r=t,it.isPrototypeOf(e)||(i=e.GetModule())===(n=s.Resolver).FRootElement||(l=s.GetMainSectionContext(),a=s.GetFunctionContext(),(c=e.$class.ClassType()).InheritsFrom(Oe)?r=this.GetBIName(132):c.InheritsFrom(Se)?r=this.GetBIName(131):c===ns?r=this.GetBIName(132):c.InheritsFrom(Ze)?r=this.GetBIName(130):this.RaiseNotSupported(e,s,20200608160225,""),r=a.CreateLocalIdentifier(r,e,1),l.AddLocalVar(r,e,1,!0),6 in this.FOptions&&this.StoreImplJSLocal(e,s),n.ImplementationUsesUnit(i,!0)?(o=this.CreateLiteralNull(e),h=this.CreateVarStatement(r,o,e),this.AddHeaderStatement(h,e,l),(u=this.CreateElement(_t,e)).FLHS=this.CreatePrimitiveDotExpr(r,e),u.FExpr=this.CreatePrimitiveDotExpr(t,e),this.AddImplHeaderStatement(u,e,s)):(o=this.CreatePrimitiveDotExpr(t,e),h=this.CreateVarStatement(r,o,e),this.AddHeaderStatement(h,e,l))),r},this.CreateGlobalAliasNull=function(e,t,s){var i,r;return i=s.AddLocalVar(this.GetBIName(t),e,1,!0),r=this.CreateVarStatement(i.Name,this.CreateLiteralNull(e),e),this.AddHeaderStatement(r,e,s),i},this.CreateGlobalAlias_List=function(e,t){var s,i=0,r=null;if(null!==e&&0!==e.FCount){s=t.GetMainSectionContext();for(var n=0,l=e.FCount-1;n<=l;n++)i=n,r=rtl.getObject(e.Get(i)),this.CreateGlobalElPath(r,s)}},this.IsElementUsed=function(e){return null==this.FOnIsElementUsed||this.FOnIsElementUsed(this,e)},this.IsSystemUnit=function(e){return 0===ye(e.FName,"system")&&e.$class.ClassType()===Ze},this.HasTypeInfo=function(e,t){var s=!1;return s=!1,4 in this.FOptions||null===t.Resolver?s:t.Resolver.HasTypeInfo(e)&&(null==this.FOnIsTypeInfoUsed||this.FOnIsTypeInfoUsed(this,e))?s=!0:s},this.IsClassRTTICreatedBefore=function(e,t,s){var i,r=0,n=null,l=null,a=null,o=null;if(i=!1,(a=e.FParent)!==t.FParent)return!0;a.$class.InheritsFrom(ls)||this.RaiseInconsistency(20170412101457,e);for(var h=0,u=(n=a.Declarations).FCount-1;h<=u;h++){if(r=h,(o=rtl.getObject(n.Get(r)))===t)return i;if(o===e)return!0;if((l=o.$class.ClassType())===Ae){if(o.IsForward&&ve.isPrototypeOf(o.FData)&&o.FData.FDeclaration===e)return!0}else if(l===Tt&&s.Resolver.ResolveAliasType(o.DestType,!0)===e)return!0}return i},this.IsExprTemporaryVar=function(e){var t=null,s=null;if(ve.isPrototypeOf(e.FData)&&(t=e.FData,rtl.neSet(rtl.intersectSet(rtl.createSet(3,1),t.Flags),{})))return!0;if((s=e.$class.ClassType())===je){if(10===e.Kind)return!0}else if(s.InheritsFrom(Je))return!0;return false},this.IsExprPropertySetterConst=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=null;return Je.isPrototypeOf(e)&&27===(s=e).OpCode&&(e=s.Right),!!(ve.isPrototypeOf(e.FData)&&(i=e.FData,xe.isPrototypeOf(i.FDeclaration)&&(r=i.FDeclaration,n=t.Resolver.GetPasPropertySetter(r),Se.isPrototypeOf(n)&&(a=n.ProcType.Args).FCount>0&&(l=rtl.getObject(a.Get(a.FCount-1)),Ye.isPrototypeOf(l)&&l.Access in rtl.createSet(1,4)))))},this.FindAvailableLocalName=function(e,t){var s="",i="",r=0,n=!1;function l(e){var t=null,a=null,o=0;if(null!==e)if((t=e.$class.ClassType())===Vt)e.FName===i&&function(){var e="\0";if(n=!0,0===r&&1===i.length){var t=e=i.charAt(0);t>="a"&&t<="x"?i=String.fromCharCode(e.charCodeAt()+1):"z"===t&&(i="a"),i===s&&(i=s+oe(r=1))}else i=s+oe(r+=1)}();else if(t.InheritsFrom(as)){if(l(e.FMExpr),t===os)l(e.FName);else if(t===hs)for(var h=e.FArgs.FElements,u=0,c=h.GetCount()-1;u<=c;u++)o=u,l(h.GetE(o).FExpr)}else if(t===us){if(l((a=e).FExpr),null!==a.FArgs)for(var p=a.FArgs.FElements,f=0,d=p.GetCount()-1;f<=d;f++)o=f,l(p.GetE(o).FExpr)}else if(t.InheritsFrom(cs))l(e.FA);else if(t.InheritsFrom(ps))l(e.FA),l(e.FB);else if(t===fs)for(var F=e.FElements,m=0,C=F.GetCount()-1;m<=C;m++)o=m,l(F.GetE(o).FExpr);else if(t===ds)l(e.FA),l(e.FB),l(e.FC);else if(t.InheritsFrom(Fs))l(e.FLHS),l(e.FExpr);else if(t===ms)l(e.FInit);else if(t===zt)for(var S=e.FElements,T=0,y=S.GetCount()-1;T<=y;T++)o=T,l(S.GetE(o).FExpr);else if(t===Cs)l(e.FCond),l(e.FBTrue),l(e.FBFalse);else if(t.InheritsFrom(Ss))l(e.FBody),t.InheritsFrom(Ts)?(l(e.FCond),t===ys&&(l(e.FInit),l(e.FIncr))):t===gs&&(l(e.FLhs),l(e.FList));else if(t===Ut){l(e.FCond);for(var g=e.FCases,E=0,P=g.GetCount()-1;E<=P;E++){o=E;var I=g.GetC(o);l(I.FExpr),l(I.FBody)}if(null!==e.FDefault){var R=e.FDefault;l(R.FExpr),l(R.FBody)}}}if(null!==t&&(s=e.get(),i=s,r=0,n=!1,l(t),n)){do{n=!1,l(t)}while(n);e.set(Es(i))}},this.GetImplJSProcScope=function(e,t,s){return null!==t&&6 in this.FOptions&&null!==s.Resolver?s.Resolver.GetTopLvlProcScope(e):null},this.SpecializeNeedsDelay=function(e,t){var s,i,r,n=null,l=null,a=null,o=null,h=null,u=!1,c=null,p=null,f="",d=0;if(s=!1,null===(o=t.Resolver))return s;if(!Pt.isPrototypeOf(e.FData))return s;if(i=e.FData.SpecializedFromItem,null===o.SpecializeParamsNeedDelay(i))return s;if(this.HasTypeInfo(e,t))return!0;if(r=e.$class.ClassType(),e.$class.InheritsFrom(Ne)){if(u=r===Me,r===Ae&&(c=e,p=e.FData,2===c.ObjKind)){if(f="",null===p.AncestorScope&&!(4 in this.FOptions)){var F=c.InterfaceType;0===F?f="com":1===F||this.RaiseNotSupported(e,t,20200905132130,"")}if(!(2 in p.Flags||""!==f))return s}for(var m=0,C=(n=e.Members).FCount-1;m<=C;m++)if(d=m,l=rtl.getObject(n.Get(d)),this.IsElementUsed(l)&&Be.isPrototypeOf(l)){if(a=l,l.$class.ClassType()===be);else{if(l.$class.ClassType()!==Be)continue;if(!u&&rtl.eqSet(rtl.intersectSet(a.VarModifiers,rtl.createSet(4,5)),{}))continue}if((h=o.ResolveAliasType(a.VarType,!0)).$class.ClassType()===Me)return!0;if(h.$class.ClassType()===ft&&rtl.length(h.Ranges)>0)return!0}}return s},this.CreateElement=function(e,t){var s=null,i=0,r=0;return null!=t?(Ie.UnmangleSourceLineNumber(t.SourceLinenumber,{get:function(){return i},set:function(e){i=e}},{get:function(){return r},set:function(e){r=e}}),s=e.$create("Create$1",[i,r,t.SourceFilename])):s=e.$create("Create$1",[0,0,""]),s},this.CreateFreeOrNewInstanceExpr=function(e,t){var s,i=null,r=null,n=null,l=null,a=null,o="",h="",u=null;i=null,""===(s=rtl.as(e.FDeclaration,Se)).FName&&this.RaiseInconsistency(20170125191914,s),""===(l=rtl.as(s.FData,ee).ClassRecScope.FElement).FName&&this.RaiseInconsistency(20170125191923,l),r=this.CreateCallExpression(e.FElement);try{h=this.TransformElToJSName(s,t),l.$class.ClassType()===Me?(o=this.CreateReferencePath(s,t,1,!1,e)+this.GetBIName(79),(n=this.CreateCallExpression(e.FElement)).FExpr=this.CreatePrimitiveDotExpr(o,e.FElement),u=this.CreateDotNameExpr(e.FElement,n,h),r.FExpr=u):(o=3 in e.Flags?this.GetBIName(25):this.GetBIName(24),o=this.CreateReferencePath(s,t,1,!1,e)+o,r.FExpr=this.CreatePrimitiveDotExpr(o,e.FElement),a=this.CreateLiteralString(e.FElement,h),r.AddArg(a)),i=r}finally{null===i&&(r=rtl.freeLoc(r))}return i},this.CreateFunctionSt=function(e,t,s){var i,r=null;return i=r=this.CreateElement(Ps,e),r.FFuncDef=this.CreateFunctionDef(e,t,s),i},this.CreateFunctionDef=function(e,t,s){var i=null;return i=Is.$create("Create$1"),t&&(i.FBody=this.CreateElement(Rs,e),s&&(i.FBody.FA=this.CreateElement(Gt,e))),i},this.CreateProcedureCall=function(e,t,s,i){null===e.get()&&e.set(this.CreateElement(us,t)),(null!==t&&0!==rtl.length(t.Params)||null!==s&&0!==s.Args.FCount)&&(null===e.get().FArgs&&(e.get().FArgs=this.CreateElement(vs,t)),this.CreateProcedureCallArgs(e.get().FArgs.FElements,t,s,i))},this.CreateProcedureCallArgs=function(e,t,s,i){var r,n=null,l=0,a=null,o=null,h=null;if(l=0,r=(n=i.GetNonDotContext()).Access,o=null!==s?s.Args:null,null!==t)for(;l<rtl.length(t.Params);)h=null!==o&&l<o.FCount?rtl.getObject(o.Get(l)):null,a=this.CreateProcCallArg(t.Params[l],h,n),e.AddElement().FExpr=a,l+=1;if(null!==s)for(;l<o.FCount;)null===(h=rtl.getObject(o.Get(l))).ValueExpr&&(null===t?this.RaiseNotSupported(s,i,20201028203457,""):this.RaiseNotSupported(t,i,20170201193601,"")),i.Access=0,a=this.ConvertExpression(h.ValueExpr,n),e.AddElement().FExpr=a,l+=1;n.Access=r},this.CreateProcCallArg=function(t,s,i){var r=this,n=null,l=!1,a=!1,o=Ue.$new(),h=Ue.$new();function u(){return a||(a=!0,l=r.IsExprTemporaryVar(t)),l}var c,p,f={},d=!1,F=!1,m=null,C=null,S=null,T=null;if(n=null,null===s)return i.Access=0,n=this.ConvertExpression(t,i);if(s.Access in rtl.createSet(0,2,3,1,4)||this.DoError$2(20170213220927,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,M.AccessNames[s.Access]),t),(T=i.Resolver).ComputeElement(s,h,{},null),m=h.LoTypeEl,c=Me.isPrototypeOf(m),F=!1,(p=ft.isPrototypeOf(m))&&(F=T.IsManagedJSType(m)),f={},(d=s.Access in rtl.createSet(2,3)&&!c)?f=rtl.includeSet(f,1):T.IsProcedureType(h,!0)&&(f=rtl.includeSet(f,2)),T.ComputeElement(t,o,rtl.refSet(f),null),a=!1,null===s.ArgType&&Me.isPrototypeOf(o.LoTypeEl)&&(d=!1),d)n=this.CreateProcCallArgRef(t,Ue.$clone(o),s,i);else{if(i.Access=0,p){if(30===o.BaseType)return n=F?this.CreateLiteralNull(t):this.CreateElement(fs,t);o.BaseType in U.btAllStringAndChars?(n=this.ConvertExpression(t,i),n=this.CreateDotSplit(t,n)):n=this.CreateArrayInit(m,t,t,i)}else 31===o.BaseType&&At.isPrototypeOf(m)&&3 in i.CurrentModeSwitches()&&Se.isPrototypeOf(o.IdentEl)&&(n=this.CreateCallback(t,Ue.$clone(o),6===m.CallingConvention,i));if(null===n&&(n=this.ConvertExpression(t,i)),34===o.BaseType&&null!==o.IdentEl)0===s.Access&&(n=this.CreateReferencedSet(t,n));else if(14===h.BaseType)14!==o.BaseType&&(n=this.CreateMulNumber(t,n,1e4));else if(14===o.BaseType)14!==h.BaseType&&(n=this.CreateDivideNumber(t,n,1e4));else if(o.BaseType in U.btAllStrings)null===m||m.$class.ClassType()===Me&&T.IsTGUID(m)&&((S=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(53),t),S.AddArg(n),n=S);else if(2===o.BaseType)if((C=o.LoTypeEl).$class.ClassType()===ft)rtl.length(C.Ranges)>0?0!==s.Access||u()||(n=this.CreateCloneStaticArray(t,C,n,i)):0!==s.Access||2!==h.BaseType||!ft.isPrototypeOf(h.LoTypeEl)||Ye.isPrototypeOf(h.LoTypeEl.FParent)||u()||F||(n=this.CreateArrayRef(t,n));else if(C.$class.ClassType()===Ae){if(null===m);else if(h.BaseType in U.btAllStrings)2===C.ObjKind&&(n=this.CreateDotNameExpr(t,n,this.GetBIName(120)));else if(m.$class.ClassType()===Me)2===C.ObjKind&&T.IsTGUID(m)?((S=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(45),t),S.AddArg(n),n=S,0===s.Access&&(n=this.CreateRecordCallClone(t,m,n,i))):this.RaiseNotSupported(t,i,20180410160008,"");else if(m.$class.ClassType()===Ae){var y=C.ObjKind;if(1===y){var g=m.ObjKind;if(1===g);else if(2===g){S=this.CreateCallExpression(t);var E=m.InterfaceType;0===E?(S.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(55)]),S.AddArg(n),n=S,S.AddArg(this.CreateReferencePathExpr(m,i,!1,null)),n=S=this.CreateIntfRef(S,i,t)):1===E?(S.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(46)]),S.AddArg(n),n=S,S.AddArg(this.CreateReferencePathExpr(m,i,!1,null))):this.RaiseNotSupported(t,i,20180401230251,M.InterfaceTypeNames[m.InterfaceType])}else this.RaiseNotSupported(t,i,20180328134244,M.ObjKindNames[m.ObjKind])}else if(2===y){2===C.ObjKind||this.RaiseNotSupported(t,i,20180328134305,M.ObjKindNames[m.ObjKind])}else this.RaiseNotSupported(t,i,20180328134146,M.ObjKindNames[C.ObjKind])}}else if(C.$class.ClassType()===Me){if(h.BaseType in U.btAllStrings&&T.IsTGUID(C))return(S=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(47),t),S.AddArg(n),n=S;0===s.Access&&(n=this.CreateRecordCallClone(t,C,n,i))}else At.isPrototypeOf(o.LoTypeEl)&&At.isPrototypeOf(h.LoTypeEl)&&6===h.LoTypeEl.CallingConvention&&6!==o.LoTypeEl.CallingConvention&&(n=this.CreateSafeCallback(t,n,i))}return n},this.CreateProcCallArgRef=function(s,i,r,n){var l=this,a=null,o=null;function h(e,t){var s=null;null!==t.get()&&((s=o.FElements.AddElement()).FName=e,s.FExpr=t.get(),t.set(null))}function u(e){return 1 in i.Flags||(j({p:e,get:function(){return this.p.Setter},set:function(e){this.p.Setter=e}}),e.Setter=l.CreateRaisePropReadOnly(s)),e.Setter}var c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=0,R=0,v="",A="",N=null,x=null,b="",O=null,$=null,D=!1,L=!1,B=null,M=null;o=null,p=null,c=k.$create("Create$1",[s,null,n]),f=null,d=null,F=null,m=null,b=t.TempRefObjSetterArgName,T=null;try{if(c.Access=2,c.Arg=r,c.Expr=s,c.ResolvedExpr.$assign(i),p=this.ConvertExpression(s,c),c.ReusingReference)return a=p;o=this.CreateElement(zt,s),p.$class.ClassType()===Vt?(L=null!==(m=u(c)),v=p.FName,(I=e.PosLast(".",v))>0?(f=this.CreatePrimitiveDotExpr(he(v,I-1),s),F=this.CreatePrimitiveDotExpr("this."+t.TempRefGetPathName+"."+As(v,I+1),s),null===m&&(m=this.CreatePrimitiveDotExpr("this."+t.TempRefGetPathName+"."+As(v,I+1),s))):(F=p,p=null,null===m&&(m=this.CreatePrimitiveDotExpr(v,s))),L&&(c.Setter=null,m.$class.ClassType()===Vt&&(A=m.FName,R=e.PosLast(".",A),j({get:function(){return m},set:function(e){m=e}}),he(v,I)===he(A,R)?m=this.CreatePrimitiveDotExpr("this."+t.TempRefGetPathName+"."+As(A,I+1),s):(d=this.CreatePrimitiveDotExpr(he(A,R-1),s),m=this.CreatePrimitiveDotExpr("this."+t.TempRefSetPathName+"."+As(A,I+1),s))))):p.$class.ClassType()===wt?(null!==c.Setter&&this.RaiseNotSupported(s,n,20170214231900,""),f=(x=p).FMExpr,x.FMExpr=this.CreatePrimitiveDotExpr("this."+t.TempRefGetPathName,s),F=x,p=null,m=1 in i.Flags?this.CreatePrimitiveDotExpr("this."+t.TempRefGetPathName+"."+x.FName,s):u(c)):p.$class.ClassType()===os?(null!==c.Setter&&this.RaiseNotSupported(s,n,20170214215150,""),C=(N=p).FName,h(t.TempRefParamName,{get:function(){return C},set:function(e){C=e}}),f=N.FMExpr,N.FMExpr=this.CreatePrimitiveDotExpr("this."+t.TempRefGetPathName,s),N.FName=this.CreatePrimitiveDotExpr("this."+t.TempRefParamName,s),F=N,p=null,N=this.CreateElement(os,s),m=N,N.FMExpr=this.CreatePrimitiveDotExpr("this."+t.TempRefGetPathName,s),N.FName=this.CreatePrimitiveDotExpr("this."+t.TempRefParamName,s)):p.$class.ClassType()===us?(null!==c.Setter&&this.RaiseNotSupported(s,n,20190210094430,""),h(t.TempRefParamName,{get:function(){return p},set:function(e){p=e}}),p=null,F=this.CreatePrimitiveDotExpr("this."+t.TempRefParamName,s),m=this.CreatePrimitiveDotExpr("this."+t.TempRefParamName,s)):p.$class.ClassType()===es?(F=p,p=null,m=u(c),c.Setter=null):(h(t.TempRefParamName,{get:function(){return p},set:function(e){p=e}}),p=null,F=this.CreatePrimitiveDotExpr("this."+t.TempRefParamName,s),m=this.CreateRaisePropReadOnly(s)),m.$class.ClassType()===Vt||m.$class.ClassType()===wt||m.$class.ClassType()===os?(this.FindAvailableLocalName({get:function(){return b},set:function(e){b=e}},m),S=this.CreatePrimitiveDotExpr(b,s),O=i.LoTypeEl,(D=n.Resolver.IsManagedJSType(O))&&null!==r.ArgType?m=this.CreateAssignManagedVar(i,{get:function(){return m},set:function(e){m=e}},{get:function(){return S},set:function(e){S=e}},n,s):Me.isPrototypeOf(O)?((B=this.CreateCallExpression(s)).FExpr=this.CreateDotNameExpr(s,m,this.GetBIName(75)),B.AddArg(S),m=B):((y=this.CreateElement(_t,s)).FLHS=m,y.FExpr=S,m=y,D&&null===r.ArgType?($=n.GetFunctionContext(),ze.isPrototypeOf(i.IdentEl)?$.ResultNeedsIntfRelease=!0:$.Add_InterfaceRelease(i.IdentEl)):_t.isPrototypeOf(m)&&""!==b&&15 in n.ScannerBoolSwitches&&(T=function(t){var i=null;function a(e){return l.CreateRangeCheckCall_TypeRange(e,l.CreatePrimitiveDotExpr(t,s),n,s)}var o=Ue.$new(),h=null;return i=null,null===r.ArgType||(n.Resolver.ComputeElement(r,o,{},null),null===(h=o.LoTypeEl)||(o.BaseType in e.btAllJSRangeCheckTypes?i=a(h):2===o.BaseType?h.$class.ClassType()===st&&(i=a(h)):37===o.BaseType&&(o.SubType in e.btAllJSRangeCheckTypes||2===o.SubType)&&(i=a(h)))),i}(b)))):m.$class.ClassType()===us||this.RaiseInconsistency(20170213225940,s),h(t.TempRefGetPathName,{get:function(){return f},set:function(e){f=e}}),(g=o.FElements.AddElement()).FName=t.TempRefObjGetterName,E=this.CreateFunctionSt(s,!0,!1),g.FExpr=E,P=this.CreateElement(Ns,s),E.FFuncDef.FBody.FA=P,P.FExpr=F,F=null,h(t.TempRefSetPathName,{get:function(){return d},set:function(e){d=e}}),(g=o.FElements.AddElement()).FName=t.TempRefObjSetterName,E=this.CreateFunctionSt(s,!0,!1),g.FExpr=E,""!==b&&E.FFuncDef.FTypedParams.AddParam(b),null!==T&&((M=this.CreateElement(Ht,s)).FA=T,M.FB=m,m=M),E.FFuncDef.FBody.FA=m,m=null,a=o}finally{null===a&&(f=rtl.freeLoc(f),d=rtl.freeLoc(d),F=rtl.freeLoc(F),m=rtl.freeLoc(m),o=rtl.freeLoc(o),rtl.free(c,"Setter"),p=rtl.freeLoc(p)),c=rtl.freeLoc(c)}return a},this.CreateArrayEl=function(e,t){var s;return s=this.ConvertExpression(e,t),this.CreateArrayEl$1(e,s,t)},this.CreateArrayEl$1=function(e,t,s){var i=null,r=Ue.$new(),n=null,l=null,a=null;return i=t,s.Resolver.ComputeElement(e,r,rtl.createSet(2),null),null!==r.IdentEl&&(34===r.BaseType?i=this.CreateReferencedSet(e,i):2===r.BaseType&&((a=(l=r.LoTypeEl).$class.ClassType())===ft?(n=l,rtl.length(n.Ranges)>0&&(i=this.CreateCloneStaticArray(e,n,i,s))):a===Me&&(i=this.CreateRecordCallClone(e,l,i,s)))),i},this.CreateArgumentAccess=function(e,s,i){var r=this,n="";function l(e,t){var s=null;return s=r.CreateCallExpression(i),t.Call=s,s.FExpr=r.CreateDotNameExpr(i,r.CreatePrimitiveDotExpr(n,i),e),s.AddArg(t.RightSide),t.RightSide=null,s}var a,o,h=null,u=null;if(n=this.TransformArgName(e,s),a=s.Resolver.ResolveAliasType(e.ArgType,!0),o=Me.isPrototypeOf(a),1===s.Access){if(u=rtl.as(s.AccessContext,O),o)return null!==u.Call&&this.RaiseNotSupported(e,s,20190105174026,""),l(this.GetBIName(75),u);if(null===e.ArgType&&Me.isPrototypeOf(u.RightResolved.LoTypeEl)&&0 in u.RightResolved.Flags)return null!==u.Call&&this.RaiseNotSupported(e,s,20190311140048,""),l(this.GetBIName(75),u)}else if(o&&k.isPrototypeOf(s)&&4===s.ResolvedExpr.BaseType)return this.CreatePrimitiveDotExpr(n,i);if(e.Access in rtl.createSet(2,3)&&!o){var c=s.Access;if(0===c)return(h=this.CreateCallExpression(i)).FExpr=this.CreateDotNameExpr(i,this.CreatePrimitiveDotExpr(n,i),t.TempRefObjGetterName),h;if(1===c)return null!==(u=rtl.as(s.AccessContext,O)).Call&&this.RaiseNotSupported(e,s,20170214120606,""),l(t.TempRefObjSetterName,u);if(2===c)return rtl.as(s.AccessContext,k).ReusingReference=!0,this.CreatePrimitiveDotExpr(n,i);this.RaiseNotSupported(e,s,20170214120739,"")}return this.CreatePrimitiveDotExpr(n,i)},this.CreateUnaryPlus=function(e,t){var s=null;return(s=this.CreateElement(xs,t)).FA=e,s},this.CreateMemberExpression=function(e){var t=null,s=null,i=null,r=null,n="";rtl.length(e)<1&&this.DoError(20161024192715,"internal error: member expression needs at least one element"),r=null;for(var l=rtl.length(e)-1;l>=1;l--)""===(n=e[l])&&this.DoError(20190124114806,"internal error: member expression needs name"),"["===n.charAt(0)?(n="]"===n.charAt(n.length-1)?ue(n,2,n.length-2):ue(n,2,n.length-1),i=os.$create("Create$1",[0,0,""]),(s=Vt.$create("Create$1",[0,0,""])).FName=n,i.FName=s):(i=wt.$create("Create$1",[0,0,""])).FName=n,null===r?t=i:r.FMExpr=i,r=i;return(s=Vt.$create("Create$1",[0,0,""])).FName=e[0],null===r?t=s:r.FMExpr=s,t},this.CreateCallExpression=function(e){var t=null;return(t=this.CreateElement(us,e)).FArgs=this.CreateElement(vs,e),t},this.CreateCallCharCodeAt=function(e,t,s){var i=null;return(i=this.CreateCallExpression(s)).FExpr=this.CreateDotNameExpr(s,e,"charCodeAt"),0!==t&&i.FArgs.AddElement(this.CreateLiteralNumber(s,t)),i},this.CreateCallFromCharCode=function(e,t){var s=null;return(s=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression(["String","fromCharCode"]),s.AddArg(e),s},this.CreateUsesList=function(e,t){var s,i=null,r=0,n="",l=null,a=null;s=e.UsesClause,i=fs.$create("Create$1",[0,0,""]);for(var o=0,h=rtl.length(s)-1;o<=h;o++)r=o,a=rtl.as(s[r].Module,Ze),(this.IsElementUsed(a)||this.IsSystemUnit(a))&&(n=this.TransformModuleName(a,!1,t),l=this.CreateLiteralString(e,n),i.FElements.AddElement().FExpr=l);return i},this.AddToStatementList=function(e,t,s,i){var r=null;if(null!==s)if(Ht.isPrototypeOf(s))if(null===s.FA){if(null!==s.FB)throw B.$create("Create$1",["internal error: AddToStatementList add list A=nil, B<>nil, B="+s.FB.$classname]);j({get:function(){return s},set:function(e){s=e}})}else if(null===t.get())t.set(s),e.set(t.get());else for(null!==t.get().FB&&((r=this.CreateElement(Ht,i)).FA=t.get().FB,t.get().FB=r,t.set(r)),t.get().FB=s;Ht.isPrototypeOf(t.get().FB);)t.set(t.get().FB);else if(null===t.get())t.set(this.CreateElement(Ht,i)),e.set(t.get()),t.get().FA=s;else if(null===t.get().FB)t.get().FB=s;else{for(;Ht.isPrototypeOf(t.get().FB);)t.set(t.get().FB);(r=this.CreateElement(Ht,i)).FA=t.get().FB,t.get().FB=r,t.set(r),t.get().FB=s}},this.AddToStatementList$1=function(e,t,s){var i=null,r=null;for(i=e,r=e;Ht.isPrototypeOf(r.FB);)r=r.FB;this.AddToStatementList({get:function(){return i},set:function(e){i=e}},{get:function(){return r},set:function(e){r=e}},t,s)},this.PrependToStatementList=function(e,t,s){var i=null;null===e.get()?e.set(t):bs.isPrototypeOf(e.get())?(e.set(rtl.freeLoc(e.get())),e.set(t)):Ht.isPrototypeOf(e.get())?((i=this.CreateElement(Ht,s)).FA=t,i.FB=e.get(),e.set(i)):this.RaiseNotSupported(s,null,20181002154026,Ge(e.get()))},this.AddToVarStatement=function(e,t,s){var i=null;null===e.FA?e.FA=t:((i=this.CreateElement(Os,s)).FA=e.FA,i.FB=t,e.FA=i)},this.CreateValInit=function(t,s,i,r){var n,l=null,a=null,o=null,h=0,u=null,c=null;if(a=t,null!==(u=r.Resolver)&&(a=u.ResolveAliasType(a,!0)),null===a){if(null===s){if(null===u)return this.CreateLiteralUndefined(i);this.RaiseInconsistency(20170415185745,i)}return null===(l=this.ConvertExpression(s,r))&&this.RaiseNotSupported(s,r,20170415185927,""),l}if((n=a.$class.ClassType())===ft)l=this.CreateArrayInit(a,s,i,r);else if(n===Me)l=this.CreateRecordInit(a,s,i,r);else if(null!=s)l=this.ConvertExpression(s,r);else if(n===vt)l=this.CreateElement(zt,i);else if(n===rt&&null!==u){c=r.Resolver.Eval(a.RangeExpr.Left,rtl.createSet(0),!0);try{var p=c.Kind;l=4===p||5===p?this.CreateLiteralNumber(i,0):this.ConvertConstValue(c,r,i)}finally{nt({get:function(){return c},set:function(e){c=e}})}}else l=o=this.CreateElement(es,i),n===Qe||n===Ae||n===Tt||n===At||n===Xe?o.FValue.SetIsNull(!0):n===ks?o.FValue.SetAsString(""):n===st?o.FValue.SetAsNumber(0):n===it?ne.isPrototypeOf(a.FData)?(h=a.FData.BaseType)in e.btAllJSInteger?o.FValue.SetAsNumber(0):h in e.btAllJSFloats?o.FValue.FCustomValue="0.0":h in e.btAllJSChars?o.FValue.SetAsString("\0"):h in e.btAllJSStrings?o.FValue.SetAsString(""):h in e.btAllJSBooleans?o.FValue.SetAsBoolean(!1):h in rtl.createSet(30,29,31)?o.FValue.SetIsNull(!0):1===h&&m.isPrototypeOf(a.FData)?1===a.FData.JSBaseType&&o.FValue.SetIsUndefined(!0):this.RaiseNotSupported(t,r,20170208162121,""):null!==u?this.RaiseNotSupported(i,r,20170415190259,""):0===ye(a.FName,"longint")||0===ye(a.FName,"int64")||0===ye(a.FName,"real")||0===ye(a.FName,"double")||0===ye(a.FName,"single")?o.FValue.SetAsNumber(0):0===ye(a.FName,"boolean")?o.FValue.SetAsBoolean(!1):0===ye(a.FName,"string")||0===ye(a.FName,"char")?o.FValue.SetAsString(""):o.FValue.SetIsUndefined(!0):this.RaiseNotSupported(t,r,20170208161506,"");return null===l&&this.RaiseNotSupported(i,r,20170415190103,""),l},this.CreateVarInit=function(e,t){return this.CreateValInit(e.VarType,e.Expr,e,t)},this.CreateVarStatement=function(e,t,s){var i=null;return(i=this.CreateElement(Kt,s)).FA=this.CreateVarDecl$1(e,t,s),i},this.CreateVarDecl$1=function(e,t,s){var i=null;return(i=this.CreateElement(ms,s)).FName=e,i.FInit=t,i},this.CreateExternalBracketAccessorCall=function(t,s){var i,r,n=null,l=!1,a=null,o=null,h="",u=null;n=null,rtl.length(t.Params)<1&&this.RaiseInconsistency(20180511151259,t),ve.isPrototypeOf(t.Value.FData)||this.RaiseInconsistency(20180511144445,t),i=t.Value.FData,r=s.GetNonDotContext(),l=!1;try{o=this.ConvertExpression(t.Params[0],r),null!==i.WithExprScope?""===(h=rtl.as(i.WithExprScope,d).WithVarName)&&this.RaiseNotSupported(t,s,20190209092417,""):h="this",n=u=this.CreateElement(os,t),u.FName=o,u.FMExpr=this.CreatePrimitiveDotExpr(h,t),rtl.length(t.Params)>1&&((a=this.CreateElement(_t,t)).FLHS=n,n=a,a.FExpr=this.ConvertExpression(t.Params[1],r)),rtl.length(t.Params)>2&&this.DoError$2(20180511144047,4025,rtl.getResStr(e,"sCantCallExtBracketAccessor"),[],t),l=!0}finally{l||(n=rtl.freeLoc(n))}return n},this.CreateAssignStatement=function(e,t){var s=null,i=null,r=null;return s=null,i=this.ConvertExpression(e,t),null!==t.Call?(null!==t.RightSide&&(i=rtl.freeLoc(i),this.RaiseInconsistency(20170207215447,e)),s=i):((r=this.CreateElement(_t,t.PasElement)).FLHS=i,r.FExpr=t.RightSide,t.RightSide=null,s=r),s},this.CreateGetEnumeratorLoop=function(e,t){var s=this,i=null,r=null,n=null;function l(){var e=null;return(e=s.CreateElement(Vt,r)).FName=n.Name,e}var a,o,h,u,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=null,R=null,v=null,A=null,N=Ue.$new(),x=Ue.$new(),O=!1,k=!1;if(c=t.Resolver,O=!0,k=!1,null===(I=(a=e.FData).GetEnumerator)&&this.RaiseNotSupported(e,t,20171225104212,""),I.$class.ClassType()!==qe&&this.RaiseNotSupported(e,t,20171225104237,""),c.ComputeResultElement(I.GetFT().ResultEl,N,rtl.createSet(5),null),o=N.LoTypeEl,Ae.isPrototypeOf(o)){var $=o.ObjKind;if(1===$||3===$||4===$||5===$);else if(2===$){var D=o.InterfaceType;0===D?k=!0:1===D?O=!1:this.RaiseNotSupported(e.VariableName,t,20180328192842,"")}else this.RaiseNotSupported(e.VariableName,t,20180328192452,"")}null===(R=a.MoveNext)&&this.RaiseNotSupported(e,t,20171225104249,""),R.$class.ClassType()!==qe&&this.RaiseNotSupported(e,t,20171225104256,""),R.FParent.$class.ClassType()!==Ae&&this.RaiseNotSupported(e,t,20190208153949,""),null!==R.FParent.HelperForType&&this.RaiseNotSupported(e,t,20190208155015,""),null===(v=a.Current)&&this.RaiseNotSupported(e,t,20171225104306,""),v.$class.ClassType()!==xe&&this.RaiseNotSupported(e,t,20171225104316,""),v.FParent.$class.ClassType()!==Ae&&this.RaiseNotSupported(e,t,20190208154003,""),h=t.Resolver.ResolveAliasType(v.VarType,!0),u=Ae.isPrototypeOf(h)&&2===h.ObjKind&&0===h.InterfaceType,d=t.GetFunctionContext(),r=e,p=this.CreateElement(Ht,r),A=null;try{f=this.CreateElement(Kt,r),p.FA=f,r=e.StartExpr,c.IsHelperMethod(I)?y=this.CreateCallHelperMethod(I,e.StartExpr,t,!0):(F=this.ConvertExpression(e.StartExpr,t),(y=this.CreateElement(us,r)).FExpr=this.CreateDotExpression(r,F,this.CreateIdentifierExpr(I,t),!0)),n=d.AddLocalVar(this.GetBIName(135),e.VariableName,0,!0),f.FA=this.CreateVarDecl$1(n.Name,y,r),r=e.VariableName,g=null,O&&(g=this.CreateElement($s,r),p.FB=g),E=this.CreateElement(Ds,r),null!==g?g.FBlock=E:p.FB=E,y=this.CreateElement(us,r),E.FCond=y,y.FExpr=this.CreateDotExpression(r,l(),this.CreateIdentifierExpr(R,t),!1),S=null,T=null,A=null;try{S=this.ConvertExpression(e.VariableName,t),A=b.$create("Create$1",[e.StartExpr,null,t]),m=this.CreatePropertyGet(v,null,A,r),null!==A.JS&&this.RaiseNotSupported(e,t,20180509134302,Ge(A.JS)),T=this.CreateDotExpression(r,l(),m,!0),u?(c.ComputeElement(e.VariableName,x,{},null),E.FBody=this.CreateAssignManagedVar(x,{get:function(){return S},set:function(e){S=e}},{get:function(){return T},set:function(e){T=e}},t,e.VariableName),S=null,T=null):(P=this.CreateElement(_t,r),E.FBody=P,P.FLHS=S,S=null,P.FExpr=T,T=null)}finally{j({get:function(){return A},set:function(e){A=e}}),j({get:function(){return S},set:function(e){S=e}}),j({get:function(){return T},set:function(e){T=e}})}null!==e.Body&&null!==(C=this.ConvertElement(e.Body,t))&&((F=this.CreateElement(Ht,r)).FA=E.FBody,F.FB=C,E.FBody=F),r=e.StartExpr,null!==g&&(k?(y=this.CreateCallExpression(r),g.FBFinally=y,y.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(36)]),y.AddArg(l())):g.FBFinally=this.CreateCallRTLFreeLoc(l(),l(),r)),i=p}finally{A=rtl.freeLoc(A),null===i&&(p=rtl.freeLoc(p))}return i},this.CreateCallRTLFreeLoc=function(e,t,s){var i=null,r=null;return(i=this.CreateCallExpression(s)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(60)]),i.FArgs.AddElement(t),(r=this.CreateElement(_t,s)).FLHS=e,r.FExpr=i,r},this.CreateDotSplit=function(e,t){var s=null,i=null;return i=this.CreateCallExpression(e),s=this.CreateElement(wt,e),i.FExpr=s,s.FMExpr=t,s.FName="split",i.AddArg(this.CreateLiteralJSString(e,"")),i},this.CreateExportStatement=function(e,t,s,i){var r=null,n=null,l=null;return r=this.CreateElement(Ls,i),n=this.CreateElement(Kt,i),r.FDeclaration=n,n.FVarType=e,l=this.CreateElement(ms,i),n.FA=l,l.FName=t,l.FInit=s,r},this.CreatePrecompiledJS=function(t){var s="",i=null,r=null;r=null,i=Ms.$create("Create$2",[1e3]);try{(r=Gs.$create("Create$1",[i])).SetOptions(rtl.refSet(e.DefaultJSWriterOptions)),r.FIndentSize=2,r.FSkipCurlyBrackets=!0,r.FWriter.FLineBreak="\n",r.WriteJS(t),s=i.GetAsString()}finally{r=rtl.freeLoc(r),i=rtl.freeLoc(i)}return s},this.AddRTLVersionCheck=function(e,t){var s=null;(s=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(22)]),s.AddArg(this.CreateLiteralNumber(t,this.FGlobals.RTLVersion)),this.PrependToStatementList({p:e,get:function(){return this.p.BodySt},set:function(e){this.p.BodySt=e}},s,t)},this.CreateLiteralNumber=function(e,t){var s=null;return(s=this.CreateElement(es,e)).FValue.SetAsNumber(t),s},this.CreateLiteralFloat=function(e,t){var s=null,i=null,r=null;return Vs(t)?((i=this.CreateElement(Us,e)).FA=t<0?this.CreateLiteralNumber(e,-1):this.CreateLiteralNumber(e,1),i.FB=this.CreateLiteralNumber(e,0),s=i):((r=this.CreateElement(es,e)).FValue.SetAsNumber(t),s=r),s},this.CreateLiteralHexNumber=function(e,t,s){var i=null;return(i=this.CreateElement(es,e)).FValue.SetAsNumber(t),i.FValue.FCustomValue="0x"+rtl.hexStr(t,s),i},this.CreateLiteralString=function(e,t){var s=null;return(s=this.CreateElement(es,e)).FValue.SetAsString(t),s},this.CreateLiteralJSString=function(e,t){var s=null;return(s=this.CreateElement(es,e)).FValue.SetAsString(t),s},this.CreateLiteralBoolean=function(e,t){var s=null;return(s=this.CreateElement(es,e)).FValue.SetAsBoolean(t),s},this.CreateLiteralNull=function(e){var t=null;return(t=this.CreateElement(es,e)).FValue.SetIsNull(!0),t},this.CreateLiteralUndefined=function(e){var t=null;return(t=this.CreateElement(es,e)).FValue.SetIsUndefined(!0),t},this.CreateLiteralCustomValue=function(e,t){var s=null;return(s=this.CreateElement(es,e)).FValue.FCustomValue=t,s},this.CreateSetLiteralElement=function(t,s){var i=null,r=null,n=null,l="",a=Ue.$new(),o=null,h=null,u=null,c=0,p=null;if(null===(i=this.ConvertExpression(t,s))&&this.RaiseNotSupported(t,s,20170415192209,""),i.$class.ClassType()===es){var f=(r=i.FValue).FValueType;if(2===f)return n=!1===r.GetAsBoolean()?this.CreateLiteralNumber(t,0):this.CreateLiteralNumber(t,1),i=rtl.freeLoc(i),n;if(3===f)return i;if(4===f)return l=r.GetAsString(),i=rtl.freeLoc(i),1!==l.length&&this.DoError$2(20170415193254,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"char",18,"string"),t),i=this.CreateLiteralNumber(t,l.charCodeAt(0));this.RaiseNotSupported(t,s,20170415205955,"")}else if(i.$class.ClassType()===us&&(o=i,wt.isPrototypeOf(o.FExpr))){if("charCodeAt"===(h=o.FExpr).FName)return i;if("charAt"===h.FName)return h.FName="charCodeAt",i}return null!==(u=s.Resolver)&&(u.ComputeElement(t,a,{},null),37===(c=a.BaseType)&&(c=a.SubType),c in e.btAllJSStringAndChars?i=this.CreateCallCharCodeAt(i,0,t):c in e.btAllJSInteger||(2===c?(p=a.LoTypeEl.$class.ClassType())===st||p===rt||this.RaiseNotSupported(t,s,20170415191933,""):this.RaiseNotSupported(t,s,20170415191822,""))),i},this.CreateUnaryNot=function(e,t){var s=null;return(s=this.CreateElement(Js,t)).FA=e,s},this.ConvertCharLiteralToInt=function(e,t,s){var i="";4!==e.FValue.FValueType&&this.RaiseInconsistency(20171112020856,t),1!==(i=""!==e.FValue.FCustomValue?e.FValue.FCustomValue:e.FValue.GetAsString()).length&&this.RaiseNotSupported(t,s,20171112021003,""),e.FValue.SetAsNumber(i.charCodeAt(0))},this.ClonePrimaryExpression=function(e,t){var s=null;return(s=this.CreateElement(e.$class.ClassType(),t)).$class.ClassType()===Vt&&(s.FName=e.FName),s},this.CreateMulNumber=function(e,t,s){var i,r=null,n=null;if(es.isPrototypeOf(t)){var l=(n=t.FValue).FValueType;if(0===l)return n.SetAsNumber(NaN),t;if(1===l)return n.SetAsNumber(0),t;if(2===l)return n.GetAsBoolean()?n.SetAsNumber(s):n.SetAsNumber(0),t;if(3===l&&!isNaN(n.GetAsNumber())&&!Vs(n.GetAsNumber()))return n.SetAsNumber(n.GetAsNumber()*s),t}return i=r=this.CreateElement(js,e),r.FA=t,r.FB=this.CreateLiteralNumber(e,s),i},this.CreateDivideNumber=function(e,t,s){var i,r=null,n=null;if(0!==s&&es.isPrototypeOf(t)){var l=(n=t.FValue).FValueType;if(0===l)return n.SetAsNumber(NaN),t;if(1===l)return n.SetAsNumber(0),t;if(2===l)return n.GetAsBoolean()?n.SetAsNumber(1/s):n.SetAsNumber(0),t;if(3===l&&!isNaN(n.GetAsNumber())&&!Vs(n.GetAsNumber()))return n.SetAsNumber(n.GetAsNumber()/s),t}return i=r=this.CreateElement(Us,e),r.FA=t,r.FB=this.CreateLiteralNumber(e,s),i},this.CreateTruncFloor=function(e,t,s){var i,r=null,n=null;if(es.isPrototypeOf(t)){var l=(r=t.FValue).FValueType;if(0===l)return r.SetAsNumber(NaN),t;if(1===l)return r.SetAsNumber(0),t;if(2===l)return r.GetAsBoolean()?r.SetAsNumber(1):r.SetAsNumber(0),t;if(3===l)return isNaN(r.GetAsNumber())||Vs(r.GetAsNumber())||(s?r.SetAsNumber(Hs(r.GetAsNumber())):r.SetAsNumber(Ws(r.GetAsNumber()))),t}return i=n=this.CreateCallExpression(e),n.FExpr=s?this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(116),e):this.CreatePrimitiveDotExpr("Math.floor",e),n.AddArg(t),i},this.CreateDotNameExpr=function(e,t,s){var i=null;return(i=this.CreateElement(wt,e)).FMExpr=t,i.FName=s,i},this.CreateDotExpression=function(t,s,i,r){var n=null,l=null,a=null,o=null,h=!1,u=null;if(n=null,null===s&&this.RaiseInconsistency(20170201140827,t),null===i&&this.RaiseInconsistency(20170211192018,t),r&&this.IsInterfaceRef(i))return o=(u=i).FArgs.FElements.GetE(1).FExpr,u.FArgs.FElements.GetE(1).FExpr=this.CreateDotExpression(t,s,o,!1),n=u;h=!1;try{for(n=i,a=null;;)if(i.$class.ClassType()===us){if(a=i,null===(i=i.FExpr)){a.FExpr=s;break}}else if(i.$class.ClassType()===os){if(a=i,null===(i=i.FMExpr)){a.FMExpr=s;break}}else if(i.$class.ClassType()===wt){if(a=i,null===(i=i.FMExpr)){a.FMExpr=s;break}}else{if(i.$class.ClassType()===Vt){l=this.CreateElement(wt,t),n===i?n=l:os.isPrototypeOf(a)?a.FMExpr=l:us.isPrototypeOf(a)?a.FExpr=l:wt.isPrototypeOf(a)?a.FMExpr=l:(l=rtl.freeLoc(l),this.RaiseInconsistency(20170129141307,t)),l.FMExpr=s,l.FName=i.FName,j({get:function(){return i},set:function(e){i=e}});break}this.DoError$2(20161024191240,4007,rtl.getResStr(e,"sMemberExprMustBeIdentifier"),[],t)}h=!0}finally{h||(s=rtl.freeLoc(s),j({get:function(){return n},set:function(e){n=e}}))}return n},this.CreateOverflowCheckCall=function(e,t){var s=null;return(s=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(63),t),s.AddArg(e),s},this.CreateRangeCheckCall=function(e,t,s,i,r){var n=null;return(n=this.CreateCallExpression(r)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(i),r),n.AddArg(e),n.AddArg(this.CreateLiteralNumber(r,t)),n.AddArg(this.CreateLiteralNumber(r,s)),n},this.CreateRangeCheckCall_TypeRange=function(e,t,s,i){var r=null,n=null;r=null,n=s.Resolver.EvalTypeRange(e,rtl.createSet(0));try{if(null===n&&this.RaiseNotSupported(i,s,20180424111936,"range checking "+Ge(e)),10===n.Kind){var l=n.ElKind;1===l||2===l?r=this.CreateRangeCheckCall(t,n.RangeStart,n.RangeEnd,72,i):3===l?r=this.CreateRangeCheckCall(t,n.RangeStart,n.RangeEnd,71,i):4===l||this.RaiseNotSupported(i,s,20190220002007,"range checking "+n.AsDebugString())}else this.RaiseNotSupported(i,s,20180424112010,"range checking "+n.AsDebugString())}finally{nt({get:function(){return n},set:function(e){n=e}}),null===r&&(t=rtl.freeLoc(t))}return r},this.PrepareAssignDifferentIntegers=function(e,t){function s(e){return 2147483648*(4194303&rtl.trunc(e/2147483648))+(2147483647&e)}var i,r,n=null,l=null,a=0,o=0,h=0,u=0,c=0,p=null;if(n=t.Resolver,i=t.LeftResolved.BaseType,r=t.RightResolved.BaseType,n.GetIntegerRange(i,{get:function(){return o},set:function(e){o=e}},{get:function(){return h},set:function(e){h=e}})||this.RaiseNotSupported(e.Left,t,20210815195159,""),n.GetIntegerRange(r,{get:function(){return u},set:function(e){u=e}},{get:function(){return c},set:function(e){c=e}})||this.RaiseNotSupported(e.Right,t,20210815195228,""),!(o<=u&&h>=c)){l=n.Eval(e.Right,{},!0);try{if(null!==l){var f=l.Kind;if(4===f){if((a=l.Int)>=o&&a<=h)return}else if(5===f)if(l.UInt<=9007199254740991){if((a=l.UInt)>=o&&a<=h)return}else this.RaiseNotSupported(e.Right,t,20210815214534,"");else{if(13===f)return;this.RaiseNotSupported(e.Right,t,20210815204203,"right="+l.AsDebugString())}if(19===i?a&=255:20===i?(a&=255)>127&&(a-=256):21===i?a&=65535:22===i?(a&=65535)>32767&&(a-=65536):25===i?a&=4294967295:26===i?(a&=4294967295)>2147483647&&(a-=4294967296):(27===i||28===i)&&(a=s(a)),es.isPrototypeOf(t.RightSide)&&3===(p=t.RightSide).FValue.FValueType)return p.FValue.SetAsNumber(a),void(p.FValue.FCustomValue="");null!==t.RightSide&&rtl.free(t,"RightSide"),t.RightSide=this.CreateLiteralNumber(e.Right,a)}}finally{nt({get:function(){return l},set:function(e){l=e}})}}},this.CreateReferencePath=function(t,s,i,r,n){var l=this,a="",o=null;function h(e,t){""!==e.get()&&"["!==e.get().charAt(0)&&e.set("."+e.get()),e.set(t+e.get())}function u(e,t){if(t.$class.ClassType()===Ae&&t.IsExternal)for(;;){if(h(e,t.ExternalName),t.FParent.$class.ClassType()!==Ae)break;t=rtl.as(t.FParent,Ae)}else h(e,l.CreateGlobalTypePath(t,s))}function c(e){var t;return null!==e&&((t=e.$class.ClassType())===qe||t===Se||t===Ft||t===Ys)}function p(e){var t=null;if(null===(t=e.FParent)&&l.RaiseNotSupported(e,s,20191018125004,""),t.$class.ClassType()===Ae){if(t.IsExternal)return;a=""!==a?a+"."+l.GetBIName(138):l.GetBIName(138)}else t.$class.ClassType()===Me?a=""!==a?a+"."+l.GetBIName(139):l.GetBIName(139):l.RaiseNotSupported(e,s,20190106110525,"")}function f(e){var t=null,s=null;return t=e,ee.isPrototypeOf(e.FData)&&null!==(s=e.FData).DeclarationProc&&(t=s.DeclarationProc),t}function F(e,t){for(var s=null;null!==e;){if(e===t)return!0;if((s=e.$class.ClassType())===Ae)e=e.FData.DirectAncestor;else if(s===Wt||s===Yt)e=e.DestType;else{if(s!==bt)return!1;rs.isPrototypeOf(e.FData)?e=e.FData.SpecializedType:l.RaiseInconsistency(20191027172642,e)}}return false}function m(){var e=null,i=null;if((e=t.$class.ClassType()).InheritsFrom(Oe))return t.FParent.$class.ClassType()!==ke&&(a=l.CreateGlobalTypePath(t,s),!0);if(e.InheritsFrom(Se)){if(i=t,l.ProcCanHaveShortRef(i))return o.ProcHasSelf(i)&&o.RaiseNotYetImplemented(20201030233511,t,""),a=l.CreateStaticProcPath(i,s),!0}else if(e===ns)return a=l.CreateGlobalElPath(t,s),!0;return false}var C,S,T=null,y=null,g=null,E=null,P=null,I="",R=null,v=null,A={};if(a="",o=s.Resolver,Oe.isPrototypeOf(t)&&null!==s&&(t=o.ResolveAliasType(t,!0)),(v=t.$class.ClassType()).InheritsFrom(Be)&&null!==t.AbsoluteExpr&&null!==s.Resolver)return C=Ue.$new(),o.ComputeElement(t.AbsoluteExpr,C,rtl.createSet(1),null),l.CreateReferencePath(C.IdentEl,s,i,r,n);if(b.isPrototypeOf(s))E=s,null!==o&&(v.InheritsFrom(Be)?rtl.neSet(rtl.intersectSet(rtl.intersectSet(rtl.createSet(4,5),e.ClassVarModifiersType),t.VarModifiers),{})&&1===E.Access&&o.ResolvedElIsClassOrRecordInstance(E.LeftResolved)&&p(t):o.IsMethod_SelfIsClass(t)&&o.ResolvedElIsClassOrRecordInstance(E.LeftResolved)&&p(t));else if(function(){var e=!1;return e=!1,t.$class.ClassType()===Ye||(t.$class.ClassType()===ze||(null===o||(null===t.FParent&&l.RaiseNotSupported(t,s,20170203121306,Ge(t)),t.FParent.$class.ClassType()===ut||(ke.isPrototypeOf(t.FParent)?e=!0:e))))}());else{if(v.InheritsFrom(Se)&&null!==t.LibrarySymbolName&&!Ne.isPrototypeOf(t.FParent))return a=2===i?this.ComputeConstString(t.LibrarySymbolName,s,!0):"";if(v.InheritsFrom(Be)&&null!==t.ExportName&&!Ne.isPrototypeOf(t.FParent))return a=2===i?this.ComputeConstString(t.ExportName,s,!0):"";if(v===Ae&&t.IsExternal)return a=t.ExternalName,Ne.isPrototypeOf(t.FParent)&&u({get:function(){return a},set:function(e){a=e}},t.FParent),a;if(S=null,null===n||null===n.WithExprScope||(S=t.FParent).$class.ClassType()===Ae&&null!==S.HelperForType&&!o.IsHelperForMember(t)){if(null===t.FParent&&this.RaiseNotSupported(t,s,20170201172141,Ge(t)),10 in this.FOptions&&2===i&&m())return a;for(g=t=f(t);;){if(null===(y=g.FParent))break;if(ke.isPrototypeOf(y))break;if((y=f(y)).$class.ClassType()===Ae||y.$class.ClassType()===Me){if(y.$class.ClassType()===Ae&&null!==y.HelperForType){if(t!==g||!o.IsHelperForMember(g)){u({get:function(){return a},set:function(e){a=e}},y);break}(y=o.ResolveAliasType(y.HelperForType,!0)).$class.ClassType()===Ae||y.$class.ClassType()===Me||this.RaiseNotSupported(t,s,20190926091356,"")}if(r){u({get:function(){return a},set:function(e){a=e}},y);break}if(A=Be.isPrototypeOf(t)?rtl.neSet(rtl.intersectSet(t.VarModifiers,rtl.createSet(4,5)),{})?rtl.createSet(1,2,3):rtl.createSet(3):Se.isPrototypeOf(t)&&c(t)?rtl.createSet(2,3):rtl.createSet(1,2,3),rtl.neSet(A,rtl.createSet(1))&&null!==(R=s.GetSelfContext())&&F(R.ThisVar.Element,y)){if(""===(I=this.GetLocalName(R.ThisVar.Element,A,s))){1 in A||this.RaiseNotSupported(t,s,20200920214421,""),u({get:function(){return a},set:function(e){a=e}},y);break}c(R.PasElement)&&o.IsMethod_SelfIsClass(t)&&p(t),h({get:function(){return a},set:function(e){a=e}},I);break}if(""!==(I=this.GetLocalName(y,A,s))){h({get:function(){return a},set:function(e){a=e}},I);break}if(y.$class.ClassType()===Ae&&y.IsExternal){u({get:function(){return a},set:function(e){a=e}},y);break}if(10 in this.FOptions){u({get:function(){return a},set:function(e){a=e}},y);break}h({get:function(){return a},set:function(e){a=e}},I=this.TransformElToJSName(y,s))}else{if(""!==(I=this.GetLocalName(y,rtl.createSet(1),s))){h({get:function(){return a},set:function(e){a=e}},I);break}if(y.$class.ClassType()===Le){null===(T=y.GetModule())&&this.RaiseInconsistency(20161024192755,t),h({get:function(){return a},set:function(e){a=e}},this.TransformModuleName(T,!0,s)+"."+this.GetBIName(124));break}if(Ze.isPrototypeOf(y)){h({get:function(){return a},set:function(e){a=e}},this.TransformModuleName(y,!0,s));break}y.$class.ClassType()===st&&h({get:function(){return a},set:function(e){a=e}},y.FName)}g=y}}else""===(P=rtl.as(n.WithExprScope,d)).WithVarName&&this.RaiseNotSupported(P.Expr,s,20190209092506,Ge(t)),h({get:function(){return a},set:function(e){a=e}},P.WithVarName),!(1 in P.Flags)&&o.IsMethod_SelfIsClass(t)&&p(t)}if(1===i)""!==a&&(a+=".");else if(2===i){if(10 in this.FOptions&&m())return a;I=this.TransformElToJSName(t,s),""===a?a=I:""!==I&&I.charCodeAt(0)in rtl.createSet(91,40)?a+=I:a=a+"."+I}return a},this.CreateReferencePathExpr=function(e,t,s,i){var r,n=null;return r=this.CreateReferencePath(e,t,2,s,i),n=null!==i?i.FElement:null,this.CreatePrimitiveDotExpr(r,n)},this.CreateGlobalTypePath=function(e,t){var s;return s=t.Resolver.ResolveAliasType(e,!0),this.CreateGlobalElPath(s,t)},this.CreateStaticProcPath=function(e,t){var s="";return e.IsAbstract()||e.IsExternal()?this.RaiseNotSupported(e,t,20201101185117,""):e.IsStatic()||ct.isPrototypeOf(e.FParent)||null!==e.FData.SpecializedFromItem?s=this.CreateGlobalElPath(e,t):this.RaiseNotSupported(e,t,20200925104007,""),s},this.CreateGlobalElPath=function(e,t){var s,i="",r=null,n=null,l=null,a=null;if(a=t.Resolver,""!==(i=t.GetLocalName(e,rtl.createSet(1))))return 6 in this.FOptions&&this.StoreImplJSLocal(e,t),i;if(s=10 in this.FOptions,null!==(r=e.FParent))""===(i=t.GetLocalName(r,rtl.createSet(1)))?(l=r.$class.ClassType()).InheritsFrom(Oe)?i=this.CreateGlobalElPath(r,t):l.InheritsFrom(ct)?(n=r.GetModule(),i=this.TransformModuleName(n,!0,t),r.$class.ClassType()===Le&&n!==t.GetRootContext().PasElement.GetModule()&&(i=i+"."+this.GetBIName(124))):l.InheritsFrom(Ze)?i=this.TransformModuleName(r,!0,t):this.RaiseNotSupported(e,t,20200609230526,Pe(e)):6 in this.FOptions&&null===a.GetParentProcBody(r)&&this.StoreImplJSLocal(r,t),i=i+"."+this.TransformElToJSName(e,t);else{if(Ze.isPrototypeOf(e))return i=this.TransformModuleName(e,!0,t);this.RaiseNotSupported(e,t,20201010221704,Pe(e))}return s&&(i=this.CreateGlobalAliasForeign(e,i,t)),i},this.GetLocalName=function(e,t,s){var i="";if(6 in this.FOptions&&1 in t){if(""!==(i=s.GetLocalName(e,rtl.createSet(1))))return this.StoreImplJSLocal(e,s),i;if(rtl.eqSet(t,rtl.createSet(1)))return""}return i=s.GetLocalName(e,t)},this.ProcCanHaveShortRef=function(e){var t=null;return!e.IsExternal()&&!e.IsVirtual()&&((t=e.FParent.$class.ClassType())!==ke&&(!!t.InheritsFrom(ct)||(!!e.IsStatic()||(null!==e.FData.SpecializedFromItem||false))))},this.StoreImplJSLocal=function(e,t){var s=null,i=null,r=null,n=null;for(s=t;null!==s;)null!==(i=s.PasElement)&&(r=i.FData,c.isPrototypeOf(r)?null!==(n=r.ImplJS)&&n.AddShortRef(e):o.isPrototypeOf(r)&&null!==(n=r.ImplJS)&&n.AddShortRef(e)),s=s.Parent},this.StoreImplJSLocals=function(e,t){var s=0,r=0,n=null,l=null,a="";e.ClearStoreJSLocalVars(),e.StoreJSLocalVars=rtl.arraySetLength(e.StoreJSLocalVars,null,rtl.length(t.LocalVars)),r=0;for(var o=0,h=rtl.length(t.LocalVars)-1;o<=h;o++)s=o,null!==(n=t.LocalVars[s]).Element&&1===n.Kind&&(ke.isPrototypeOf(n.Element.FParent)||""!==(a=n.Name)&&"this"!==a&&a!==this.GetBIName(136)&&a!==this.GetBIName(124)&&((l=i.$create("Create")).Name=a,l.Element=n.Element,e.StoreJSLocalVars[r]=l,r+=1));e.StoreJSLocalVars=rtl.arraySetLength(e.StoreJSLocalVars,null,r)},this.RestoreImplJSLocals=function(e,t){t.PrecompiledVars=e.StoreJSLocalVars},this.CreateImplementationSection=function(e,t){var s,i=null,r=null,n=null,l=null,a=0;i=null,s=(l=this.CreateFunctionSt(e.ImplementationSection,!0,!0)).FFuncDef.FBody.FA,t.ImplSrcElements=s,r=N.$create("Create$1",[e.ImplementationSection,s,t]);try{if(t.ImplContext=r,null!==t.ImplHeaderStatements){for(var o=0,h=t.ImplHeaderStatements.FCount-1;o<=h;o++)a=o,n=rtl.getObject(t.ImplHeaderStatements.Get(a)),r.AddHeaderStatement(n),t.ImplHeaderStatements.Put(a,null);j({p:t,get:function(){return this.p.ImplHeaderStatements},set:function(e){this.p.ImplHeaderStatements=e}})}null!==e.ImplementationSection&&null!==this.ConvertDeclarations(e.ImplementationSection,r)&&this.RaiseInconsistency(20170910175032,e),t.ImplHeaderIndex=r.HeaderIndex,i=l}finally{t.ImplContext=null,r=rtl.freeLoc(r),null===i&&(l=rtl.freeLoc(l),t.ImplSrcElements=null)}return i},this.CreateInitSection=function(e,t,s){var i;if(i=rtl.as(s.GetRootContext(),I),(null!=e.InitializationSection||tt.isPrototypeOf(e)||rtl.length(i.GlobalClassMethods)>0)&&this.AddToSourceElements(t,this.ConvertInitializationSection(e,s)),null!=e.FinalizationSection)throw B.$create("Create$1",["TPasToJSConverter.ConvertInitializationSection: finalization section is not supported"])},this.CreateExportsSection=function(e,s,i){var r=this;function n(e,t,s,i,n){var l=null,a=null;(l=e.FElements.AddElement()).FName=t,a=r.CreateFunctionSt(n,!0,!1),l.FExpr=a,""!==s&&a.FFuncDef.FTypedParams.AddParam(s),a.FFuncDef.FBody.FA=i}var l=null,a=null,o=null,h=null,u=0,c=null,p="",f="",d=null,F=null,m=Ue.$new(),C=null,S=null,T=null,y=null,g=null,E=null,P=null;if(0!==(l=e.LibrarySection.ExportSymbols).FCount){a=i.Resolver,o=null;for(var I=0,R=l.FCount-1;I<=R;I++){if(u=I,null!==(c=rtl.as(rtl.getObject(l.Get(u)),zs)).NameExpr?(a.ComputeElement(c.NameExpr,m,rtl.createSet(3),null),F=m.IdentEl):(ve.isPrototypeOf(c.FData)||this.RaiseNotSupported(c,i,20211020142506,Ge(c.FData)),F=c.FData.FDeclaration),p=this.CreateReferencePath(F,i,2,!0,null),f="",null!==c.ExportName)null===(d=a.Eval(c.ExportName,rtl.createSet(0),!0))&&this.RaiseNotSupported(c.ExportName,i,20211020144200,""),8===d.Kind?f=d.S:(nt({get:function(){return d},set:function(e){d=e}}),this.RaiseNotSupported(c.ExportName,i,20211020144404,"")),nt({get:function(){return d},set:function(e){d=e}});else""===F.FName&&this.RaiseNotSupported(c,i,20211020144730,""),f=F.FName;F.$class.ClassType()===Be?(null===o&&(o=this.CreateExportStatement(2,this.GetBIName(129),this.CreateElement(zt,c),c),this.AddToSourceElements(s,o),C=this.CreateCallExpression(c),this.AddToSourceElements(s,C),C.FExpr=this.CreatePrimitiveDotExpr("Object.defineProperties",c),C.AddArg(this.CreatePrimitiveDotExpr(this.GetBIName(129),c)),S=this.CreateElement(zt,c),C.AddArg(S)),(y=S.FElements.AddElement()).FName=f,T=this.CreateElement(zt,c),y.FExpr=T,(g=T.FElements.AddElement()).FName="enumerable",g.FExpr=this.CreateLiteralBoolean(c,!0),(E=this.CreateElement(Ns,c)).FExpr=this.CreatePrimitiveDotExpr(p,c),n(T,"get","",E,c),(P=this.CreateElement(_t,c)).FLHS=this.CreatePrimitiveDotExpr(p,c),P.FExpr=this.CreatePrimitiveDotExpr(t.TempRefObjSetterArgName,c),n(T,"set",t.TempRefObjSetterArgName,P,c)):(h=this.CreateExportStatement(2,f,this.CreatePrimitiveDotExpr(p,c),c),this.AddToSourceElements(s,h))}}},this.AddRTLRun=function(e,t,s,i){var r=null;return r=this.CreateCallExpression(e),this.AddToSourceElements(s,r),r.FExpr=this.CreateMemberExpression([this.GetBIName(144),"run"]),""!==t&&r.AddArg(this.CreateLiteralString(e,t)),r},this.AddHeaderStatement=function(e,t,s){var i=null;null!==e&&(null===(i=s.GetMainSectionContext())&&this.RaiseNotSupported(t,s,20200606142555,""),i.AddHeaderStatement(e))},this.AddImplHeaderStatement=function(e,t,s){var i=null;null!==e&&(null===(i=s.GetContextOfType(x))&&this.RaiseNotSupported(t,s,20200606142555,""),i.AddImplHeaderStatement(e))},this.AddDelayedInits=function(e,t,s){var i,r=!1,n=null,l=0,a=null,o=null,h=null,u=null;if(r=!1,null===(i=s.Resolver))return r;u=null;for(var c=0,p=(n=rtl.as(i.FHub,S)).JSDelaySpecializeCount()-1;c<=p;c++)l=c,null!==(a=this.CreateDelaySpecializeInit(n.GetJSDelaySpecializes(l),s))&&(null===u&&(o=this.CreateElement(_t,e),this.AddToSourceElements(t,o),o.FLHS=this.CreateMemberExpression([this.GetBIName(136),this.GetBIName(125)]),h=this.CreateFunctionSt(e,!0,!0),o.FExpr=h,u=h.FFuncDef.FBody.FA),this.AddToSourceElements(u,a),r=!0);return r},this.CreateDelaySpecializeInit=function(e,t){var s,i=null,r="",n=null,l=null,a=null,o=null,h=null,u=null,c=null;if(i=null,!this.IsElementUsed(e))return i;if(t.Resolver.IsFullySpecialized(e)||this.RaiseNotSupported(e,t,20201202145045,"not fully specialized, probably a bug in the analyzer"),!this.SpecializeNeedsDelay(e,t))return i;if((s=e.$class.ClassType())===Me||s===Ae){if(s===Ae&&e.IsExternal)return i;r=this.CreateReferencePath(e,t,2,!1,null)+"."+this.GetBIName(26),(n=this.CreateCallExpression(e)).FExpr=this.CreatePrimitiveDotExpr(r,e),i=n}else if(s===At||s===Xe){if(!this.HasTypeInfo(e,t))return i;(l=this.CreateElement(wt,e)).FMExpr=this.CreateTypeInfoRef(e,t,e),l.FName=this.GetBIName(158),(n=this.CreateCallExpression(e)).FExpr=l,i=n}else if(s===ft){if(!this.HasTypeInfo(e,t))return i;if(o=e,h=(c=t.Resolver).ResolveAliasType(o.ElType,!1),u=c.ResolveAliasType(h,!0),rtl.length(o.Ranges)>0)for(;u.$class.ClassType()===ft;)o=u,0===rtl.length(o.Ranges)&&this.RaiseNotSupported(o,t,20200902155418,"static array of anonymous array"),h=c.ResolveAliasType(o.ElType,!1),u=c.ResolveAliasType(h,!0);(a=this.CreateElement(_t,e)).FLHS=this.CreateDotNameExpr(e,this.CreateTypeInfoRef(e,t,e),this.GetBIName(147)),a.FExpr=this.CreateTypeInfoRef(h,t,e),i=a}else this.RaiseNotSupported(e,t,20200831115251,"");return i},this.CreateReferencedSet=function(e,t){var s=null;return(s=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(111)]),s.AddArg(t),s},this.CreateRecordInit=function(e,t,s,i){var r=null,n=null,l=null,a=ht.$new();if(r=null,null!==t){if(null!==(n=i.Resolver)&&n.GetAssignGUIDString(e,t,a))return l=this.CreateGUIDObjLit(e,a,s,i),r=this.CreateRecordCallClone(s,e,l,i);_s.isPrototypeOf(t)&&(r=this.ConvertRecordValues(t,i)),null===r&&this.RaiseNotSupported(t,i,20161024192747,"")}else r=this.CreateRecordCallNew(s,e,i);return r},this.CreateRecordCallNew=function(e,t,s){var i,r=null;return i=this.CreateReferencePathExpr(t,s,!1,null),(r=this.CreateCallExpression(e)).FExpr=this.CreateDotNameExpr(e,i,this.GetBIName(79)),r},this.CreateRecordCallClone=function(t,s,i,r){var n,l=null,a=null,o=null,h=null;return l=this.CreateReferencePathExpr(s,r,!1,null),us.isPrototypeOf(i)&&(a=i.FExpr,wt.isPrototypeOf(a)&&(o=a,e.JSEquals(l,o.FMExpr)&&(o.FName===this.GetBIName(79)||o.FName===this.GetBIName(76))))?(l=rtl.freeLoc(l),i):((h=this.CreateCallExpression(t)).FExpr=this.CreateDotNameExpr(t,l,this.GetBIName(76)),n=h,null!==i&&h.AddArg(i),n)};this.CreateRecordFunctionNew=function(e,t,s){var i=null,r=null,n=null,l=null,a=null,o=null,h=0,u=null,c=null,p=null,f=null,d="";if(i=null,0===s.FCount)return i;r=this.CreateElement(_t,e);try{r.FLHS=this.CreateMemberExpression(["this",this.GetBIName(79)]),l=this.CreateFunctionSt(e,!0,!1),r.FExpr=l,a=l.FFuncDef,f=this.CreateElement(Gt,e),a.FBody.FA=f,(c=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression(["Object","create"]),c.AddArg(this.CreatePrimitiveDotExpr("this",e)),p=this.CreateVarStatement("r",c,e),this.AddToSourceElements(f,p);for(var F=0,m=s.FCount-1;F<=m;F++)h=F,u=rtl.getObject(s.Get(h)),n=this.CreateElement(_t,e),d=this.TransformElToJSName(u,t),n.FLHS=this.CreateMemberExpression(["r",d]),n.FExpr=this.CreateVarInit(u,t),this.AddToSourceElements(f,n);o=this.CreateElement(Ns,e),this.AddToSourceElements(f,o),o.FExpr=this.CreatePrimitiveDotExpr("r",e),i=r}finally{null===i&&(r=rtl.freeLoc(r))}return i};var n="b";this.CreateRecordFunctionEqual=function(e,t,s){var i=this,r=null,l=null;function a(e,t,s){var r=null;null===e.FExpr?e.FExpr=s:(r=i.CreateElement(Ks,t),null===l?(r.FA=e.FExpr,e.FExpr=r):(r.FA=l.FB,l.FB=r),r.FB=s,l=r)}var o=null,h=null,u=null,c=0,p=null,f=null,d=null,F=null,m=null,C="",S=null;r=null,S=t.Resolver,o=this.CreateElement(_t,e);try{o.FLHS=this.CreateMemberExpression(["this",this.GetBIName(78)]),f=this.CreateFunctionSt(e,!0,!1),o.FExpr=f,(h=f.FFuncDef).FTypedParams.AddParam(n),u=this.CreateElement(Ns,e),h.FBody.FA=u,l=null;for(var T=0,y=s.FCount-1;T<=y;T++)c=T,F=(p=rtl.getObject(s.Get(c))).VarType,null!==S&&(F=S.ResolveAliasType(F,!0)),C=this.TransformElToJSName(p,t),F.$class.ClassType()===Me?(a(u,p,m=this.CreateCallExpression(p)),m.FExpr=this.CreateMemberExpression(["this",C,this.GetBIName(78)]),m.AddArg(this.CreateMemberExpression([n,C]))):F.$class.ClassType()===vt?(a(u,p,m=this.CreateCallExpression(p)),m.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(104)]),m.AddArg(this.CreateMemberExpression(["this",C])),m.AddArg(this.CreateMemberExpression([n,C]))):At.isPrototypeOf(F)?(a(u,p,m=this.CreateCallExpression(p)),m.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(66)]),m.AddArg(this.CreateMemberExpression(["this",C])),m.AddArg(this.CreateMemberExpression([n,C]))):F.$class.ClassType()===ft&&rtl.length(F.Ranges)>0?(a(u,p,m=this.CreateCallExpression(p)),m.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(4)]),m.AddArg(this.CreateMemberExpression(["this",C])),m.AddArg(this.CreateMemberExpression([n,C]))):(a(u,p,d=this.CreateElement(Xs,p)),d.FA=this.CreateMemberExpression(["this",C]),d.FB=this.CreateMemberExpression([n,C]));null===u.FExpr&&(u.FExpr=this.CreateLiteralBoolean(e,!0)),r=o}finally{null===r&&(o=rtl.freeLoc(o))}return r};this.CreateRecordFunctionAssign=function(e,t,s){var i=null,r=null,n=null,l=null,a=null,o=null,h=0,u=null,c="",p=null,f=null,d=null,F=null,m=null,C=null;i=null,p=t.Resolver,r=this.CreateElement(_t,e);try{r.FLHS=this.CreateMemberExpression(["this",this.GetBIName(75)]),l=this.CreateFunctionSt(e,!0,!1),r.FExpr=l,(a=l.FFuncDef).FTypedParams.AddParam("s"),o=this.CreateElement(Gt,e),a.FBody.FA=o,f=null,F=null;for(var S=0,T=s.FCount-1;S<=T;S++)if(h=S,u=rtl.getObject(s.Get(h)),c=this.TransformElToJSName(u,t),C=this.CreateMemberExpression(["s",c]),null===p||(F=(f=p.ResolveAliasType(u.VarType,!0)).$class.ClassType())!==Me)if(n=this.CreateElement(_t,u),this.AddToSourceElements(o,n),n.FLHS=this.CreateSubDeclNameExpr(u,t,null),n.FExpr=C,F===ft)if(rtl.length(f.Ranges)>0)n.FExpr=this.CreateCloneStaticArray(u,f,C,t);else{if(p.IsManagedJSType(f)){m=this.CreateCallExpression(u),this.AddToSourceElements(o,m),m.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(52)]),m.AddArg(this.CreatePrimitiveDotExpr("this",u)),m.AddArg(this.CreatePrimitiveDotExpr(c,u)),m.AddArg(C);continue}n.FExpr=this.CreateArrayRef(u,C)}else F===vt&&(n.FExpr=this.CreateReferencedSet(u,C));else m=this.CreateCallExpression(u),this.AddToSourceElements(o,m),m.FExpr=this.CreateMemberExpression(["this",c,this.GetBIName(75)]),m.AddArg(C);d=this.CreateElement(Ns,e),this.AddToSourceElements(o,d),d.FExpr=this.CreatePrimitiveDotExpr("this",e),i=r}finally{null===i&&(r=rtl.freeLoc(r))}return i},this.CreateRecordRTTI=function(e,t,s,i,r){var n=null,l=null;l=this.CreateRTTINewType(e,this.GetBIName(96),!1,s,{get:function(){return n},set:function(e){n=e}}),null===n&&(l=rtl.freeLoc(l),this.RaiseInconsistency(20190105141430,e)),this.CreateRTTIMembers(e,t,s,i,r,l,!1)?l.AddArg(this.CreatePrimitiveDotExpr("this",e)):t===i?this.AddToSourceElements(t,l):t.FStatements.InsertNode(0).FNode=l},this.CreateDelayedInitMembersFunction=function(e,t,s,i){var r,n=null,l=null;return l=this.CreateElement(_t,e),this.AddToSourceElements(t,l),l.FLHS=this.CreatePrimitiveDotExpr("this."+this.GetBIName(26),e),r=this.CreateFunctionSt(e,!0,!0),l.FExpr=r,i.set(r.FFuncDef.FBody.FA),(n=v.$create("Create$1",[e,i.get(),s])).IsGlobal=!0,n.ThisVar.Element=e,n.ThisVar.Kind=2,n},this.CreateArrayConcat=function(e,t,s,i){var r=null,n=null,l=0,a=null,o=null,h=null;r=null,n=this.CreateCallExpression(t);try{l=i?8:0,2===e.BaseType?(h=(a=e.LoTypeEl).$class.ClassType(),a.$class.ClassType()===ft?(o=a,rtl.length(o.Ranges)>0&&(n.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(l)]),s.Resolver.HasStaticArrayCloneFunc(o)?n.AddArg(this.CreatePrimitiveDotExpr(this.CreateReferencePath(a,s,2,!1,null)+this.GetBIName(12),t)):n.AddArg(this.CreateLiteralString(t,"slice")))):h===Me?(n.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(l)]),n.AddArg(this.CreateReferencePathExpr(a,s,!1,null))):s.Resolver.IsManagedJSType(a)&&(n.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(l)]),n.AddArg(this.CreateLiteralString(a,this.GetBIName(123))))):34===e.BaseType&&(n.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(l)]),n.AddArg(this.CreateLiteralString(t,this.GetBIName(111)))),null===n.FExpr&&(l=i?9:1,n.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(l)])),r=n}finally{null===r&&(n=rtl.freeLoc(n))}return r},this.CreateArrayConcat$1=function(e,t,s,i){var r=Ue.$new(),n=null;return rtl.length(e.Ranges)>1&&this.RaiseNotSupported(t,s,20170331001021,""),(n=s.Resolver).ComputeElement(n.GetArrayElType(e),r,rtl.createSet(4),null),this.CreateArrayConcat(Ue.$clone(r),t,s,i)},this.CreateArrayInit=function(t,s,i,n){var l=this,a=null;function o(e){return e.$class.ClassType()===Je&&1===e.OpCode}var h,u,c=null,f=null,d=0,F=0,m=Ue.$new(),C=Ue.$new(),S=Ue.$new(),T=null,y=null,g=null,E=null,P="",I=null,R=null;if(R=n.Resolver,u=null!==(h=rtl.as(t.FData,p))&&h.Managed,null!=s)if(null===R&&this.DoError$2(20161024192739,4006,rtl.getResStr(e,"sInitializedArraysNotSupported"),[],t),R.ComputeElement(s,S,{},null),S.BaseType in rtl.createSet(36,35)||2===S.BaseType&&S.LoTypeEl.$class.ClassType()===ft)null===t.ElType?a=function(t){var s=null,i=null,a=null,h=Ue.$new();function u(e){i.RaiseMsg(e,3120,rtl.getResStr(Ee,"sWrongTypeXInArrayConstructor"),pe(18,i.GetResolverResultDescription(h,!1)),a)}var c,p,f,d=null,F=0,m=null;if(s=null,i=n.Resolver,o(t)&&i.RaiseMsg(20190215222435,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"array of const",18,at(t)),t),!je.isPrototypeOf(t)||4!==t.Kind)return l.ConvertExpression(t,n);if(f=(c=t).Params,0===rtl.length(f))return l.CreateElement(fs,c);null===(p=rtl.as(Ct(i.FRootElement.FData),r)).SystemVarRecs&&l.RaiseNotSupported(c,n,20190215215148,""),d=l.CreateCallExpression(c);try{d.FExpr=l.CreateReferencePathExpr(p.SystemVarRecs,n,!1,null);for(var C=0,S=rtl.length(f)-1;C<=S;C++){if(a=f[C],i.ComputeElement(a,h,{},null),0 in h.Flags)if(h.BaseType in rtl.createSet(19,20,21,22,26))F=0;else if(h.BaseType in rtl.createSet(25,27,28))F=19;else if(h.BaseType in e.btAllJSBooleans)F=1;else if(h.BaseType in e.btAllJSFloats)F=3;else if(h.BaseType in e.btAllJSChars)F=9;else if(h.BaseType in e.btAllJSStrings)F=18;else if(h.BaseType in rtl.createSet(30,29))F=5;else if(14===h.BaseType)F=12;else if(2===h.BaseType)if((m=h.LoTypeEl).$class.ClassType()===Ae){var T=m.ObjKind;1===T?F=7:2===T?F=14:u(20190215221106)}else m.$class.ClassType()===Tt?F=8:u(20190215221122);else 1===h.BaseType&&i.IsJSBaseType$1(h,1,!1)?F=20:u(20190215221457);else 2===h.BaseType&&Ae.isPrototypeOf(h.IdentEl)&&1===h.IdentEl.ObjKind?F=8:u(20190215221549);d.AddArg(l.CreateLiteralNumber(a,F)),d.AddArg(l.ConvertExpression(a,n))}s=d}finally{null===s&&(d=rtl.freeLoc(d))}return s}(s):(a=function e(s,r,a){var h=null,u=null,c=0;function p(e){var t=null,s=0,r=null;t=l.CreateElement(fs,i);for(var a=0,o=rtl.length(e)-1;a<=o;a++)s=a,r=l.CreateArrayEl(e[s],n),t.FElements.AddElement().FExpr=r;return t}var f=Ue.$new(),d=null,F=null;if(h=null,u=s,c=r+1,F=n.Resolver,r>=rtl.length(s.Ranges)-1&&(F.ComputeElement(F.GetArrayElType(s),f,rtl.createSet(4),null),2===f.BaseType&&f.LoTypeEl.$class.ClassType()===ft&&(u=f.LoTypeEl,c=0)),a.$class.ClassType()===qs)return p(a.Values);if(a.$class.ClassType()===je&&4===a.Kind)return p(a.Params);if(o(a)){d=l.CreateArrayConcat$1(t,a,n,!1);try{!function t(s,i){o(s.Left)?t(s.Left,i):i.AddArg(e(u,c,s.Left)),o(s.Right)?t(s.Right,i):i.AddArg(e(u,c,s.Right))}(a,d),h=d,F.IsManagedJSType(t)&&(h=l.CreateIntfRef(h,n,a))}finally{null===h&&(d=rtl.freeLoc(d))}return h}return l.ConvertExpression(a,n)}(t,0,s),u&&fs.isPrototypeOf(a)&&(0===a.GetCount()?(a=rtl.freeLoc(a),a=this.CreateLiteralNull(s)):(a=this.CreateArrayManaged(s,1,2,a),this.IsLiteralNull(a)||(a=this.CreateIntfRef(a,n,s)))));else if(S.BaseType in U.btAllStringAndChars){P=kt(R.ComputeConstString(s,!1,!0)),a=f=this.CreateElement(fs,s);for(var v=1,A=P.length;v<=A;v++)d=v,f.FElements.AddElement().FExpr=this.CreateLiteralJSString(s,P.charAt(d-1))}else 30===S.BaseType?a=u?this.CreateLiteralNull(s):this.CreateElement(fs,s):this.RaiseNotSupported(s,n,20170223133034,"");else if(0===rtl.length(t.Ranges))a=u?this.CreateLiteralNull(i):this.CreateElement(fs,i);else{null===R&&this.RaiseNotSupported(i,n,20170223113050,""),a=null,I=Qs.$create("Create$3",[!0]);try{for((c=this.CreateCallExpression(i)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(11)]),c.AddArg(this.CreateLiteralNull(i)),g=t;;){for(var N=0,x=rtl.length(g.Ranges)-1;N<=x;N++)d=N,T=g.Ranges[d],0===(F=R.GetRangeLength(T))&&(R.ComputeElement(T,m,rtl.createSet(3),null),this.RaiseNotSupported(T,n,20170223113318,Zs(m))),y=this.CreateLiteralNumber(i,F),I.Add$1(y);if(R.ComputeElement(R.GetArrayElType(g),C,rtl.createSet(4),null),!(ft.isPrototypeOf(C.LoTypeEl)&&(g=C.LoTypeEl,rtl.length(g.Ranges)>0)))break}E=Me.isPrototypeOf(C.LoTypeEl)?this.CreateReferencePathExpr(C.LoTypeEl,n,!1,null):this.CreateValInit(C.LoTypeEl,null,i,n),c.AddArg(E);for(var b=0,O=I.GetCount()-1;b<=O;b++)d=b,c.AddArg(I.GetItem(d));I.FFreeObjects=!1,I.Clear(),a=c}finally{I=rtl.freeLoc(I),null===a&&(c=rtl.freeLoc(c))}}return null===a&&this.RaiseInconsistency(20180617233317,s),a},this.CreateArrayRef=function(e,t){var s=null;return fs.isPrototypeOf(t)?t:((s=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(10)]),s.AddArg(t),s)},this.CreateCmpArrayWithNil=function(e,t,s){var i=null,r=null;return s in rtl.createSet(14,15)||this.RaiseInconsistency(20170401184819,e),(i=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(7)]),i.AddArg(t),(r=14===s?this.CreateElement(Xs,e):this.CreateElement(ei,e)).FA=i,r.FB=this.CreateLiteralNumber(e,0),r},this.CreateCloneStaticArray=function(e,t,s,i){var r=null,n=null,l="",a=null,o=0,h=null;if(fs.isPrototypeOf(s))return s;if(i.Resolver.HasStaticArrayCloneFunc(t))""===t.FName&&this.RaiseNotSupported(e,i,20180218230407,"copy anonymous multi dim static array"),a=i.GetFunctionContext(),l=this.CreateReferencePath(t,a,2,!1,null)+this.GetBIName(12),(n=this.CreateCallExpression(e)).FExpr=this.CreatePrimitiveDotExpr(l,e),n.AddArg(s),r=n;else{if(us.isPrototypeOf(s)&&(n=s,wt.isPrototypeOf(n.FExpr)&&"slice"===n.FExpr.FName&&null!==n.FArgs&&1===n.FArgs.FElements.GetCount()&&(h=n.FArgs.FElements.GetE(0).FExpr,this.IsLiteralInteger(h,{get:function(){return o},set:function(e){o=e}})&&0===o)))return n;(n=this.CreateCallExpression(e)).FExpr=this.CreateDotNameExpr(e,s,"slice"),n.AddArg(this.CreateLiteralNumber(e,0)),r=n}return r},this.CreateArrayManaged=function(e,t,s,i){var r=null;return(r=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(6)]),r.AddArg(this.CreateLiteralFloat(e,t)),(null!==i||s>0)&&r.AddArg(this.CreateLiteralFloat(e,s)),null!==i&&r.AddArg(i),r};var u=["$init","$final"];this.AddClassConDestructorFunction=function(t,s,i,r,n,l){var a=this,o=!1;function h(e){return!!a.IsElementUsed(e)||(!(!r||e.$class.ClassType()!==Se||0!==ye(e.FName,"AfterConstruction")&&0!==ye(e.FName,"BeforeDestruction"))||false)}function c(e,s,i,r){var n,l=null;null===s||o||(l=a.CreateCallExpression(t),n=a.CreateReferencePath(s,e,2,!1,null),l.FExpr=a.CreatePrimitiveDotExpr(n+"."+u[r]+".call",t),l.AddArg(a.CreatePrimitiveDotExpr("this",t)),a.AddToSourceElements(i,l))}var p=null,f=null,d=null,F=0,m=null,C=null,S=null,T=null,y=null,g=null,E=null;o=Ae.isPrototypeOf(n)&&n.IsExternal,f=this.CreateElement(Gt,t),d=v.$create("Create$1",[t,f,i]);try{d.ThisVar.Element=t,d.ThisVar.Kind=2,d.IsGlobal=!1;for(var P=0,I=t.Members.FCount-1;P<=I;P++)if(F=P,h(m=rtl.getObject(t.Members.Get(F)))){if(C=null,m.$class.ClassType()===Be&&rtl.eqSet(rtl.intersectSet(e.ClassVarModifiersType,m.VarModifiers),{}))if(0===l)C=this.CreateVarDecl(m,d);else{if(1 in m.VarModifiers)continue;g=(T=i.Resolver.ResolveAliasType(m.VarType,!0)).$class.ClassType(),i.Resolver.IsManagedJSType(T)&&(C=E=this.CreateCallExpression(t),E.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(52)]),E.AddArg(this.CreatePrimitiveDotExpr("this",t)),E.AddArg(this.CreateLiteralString(t,this.TransformElToJSName(m,d))),E.AddArg(this.CreateLiteralNull(t))),null!==C||g!==Me&&g!==Ae&&g!==Tt&&g!==vt&&g!==At&&g!==Xe&&g!==ft||(C=y=this.CreateElement(_t,t),y.FLHS=this.CreateSubDeclNameExpr(m,d,null),y.FExpr=this.CreateLiteralUndefined(t))}null!==C&&(0===l&&0===f.FStatements.GetCount()&&c(i,n,f,l),this.AddToSourceElements(f,C))}if(1===l&&f.FStatements.GetCount()>0&&c(i,n,f,l),null!==n&&!o&&0===f.FStatements.GetCount())return;p=this.CreateElement(ms,t),this.AddToSourceElements(s,p),p.FName="this."+u[l],S=this.CreateFunctionSt(t,!0,!1),p.FInit=S,S.FFuncDef.FBody.FA=f,f=null}finally{f=rtl.freeLoc(f),d=rtl.freeLoc(d)}},this.AddClassRTTI=function(e,t,s){var i=!1,r=null,n=null,l=[],a=null,o="",u=null,c=null;n=null,r=null;try{null!==rtl.as(e.FData,h).SpecializedFromItem&&!(4 in this.FOptions)&&s.Resolver.HasTypeInfo(e)&&(o=this.GetClassBIName(e,s),c=this.CreateRTTINewType(e,o,!0,s,{get:function(){return u},set:function(e){u=e}}),null!==u&&this.RaiseInconsistency(20200606134834,e),this.AddHeaderStatement(c,e,s)),r=this.CreateMemberExpression(["this",this.GetBIName(145)]),l=s.Resolver.GetAttributeCallsEl(e),i=null!==(n=this.CreateRTTIAttributes(l,e,s)),this.CreateRTTIMembers(e,t,s,t,s,r,i)&&(r=null),null!==n&&(a=this.CreateElement(_t,e),this.AddToSourceElements(t,a),a.FLHS=this.CreateMemberExpression([this.GetBIName(153),this.GetBIName(164)]),a.FExpr=n,n=null)}finally{n=rtl.freeLoc(n),r=rtl.freeLoc(r)}},this.AddClassConstructors=function(e,t){var s,i=0,r=null,n=null,l=null,a=null,o=null,h=null;s=e.GetRootContext(),n=null,l=null;try{for(var u=0,c=rtl.length(s.GlobalClassMethods)-1;u<=c;u++)i=u,r=s.GlobalClassMethods[i],a=this.ConvertProcedure(r,e),(h=this.CreateElement(ti,t)).FA=a,(o=this.CreateCallExpression(t)).FExpr=h,this.AddToStatementList({get:function(){return n},set:function(e){n=e}},{get:function(){return l},set:function(e){l=e}},o,t);this.PrependToStatementList({p:e,get:function(){return this.p.BodySt},set:function(e){this.p.BodySt=e}},n,t),n=null}finally{n=rtl.freeLoc(n)}},this.AddClassMessageIds=function(e,t,s,i){var r,n=null,l=0,a=null,o=null,h=null,u=null;r=e.FData;var c=i;if(126===c?n=r.MsgIntToProc:127===c?n=r.MsgStrToProc:this.RaiseNotSupported(e,s,20190304001209,this.GetBIName(i)),null!==n&&0!==n.GetCount()){a=this.CreateElement(_t,e),this.AddToSourceElements(t,a),a.FLHS=this.CreateMemberExpression(["this",this.GetBIName(i)]),o=this.CreateElement(zt,e),a.FExpr=o;for(var p=0,f=n.GetCount()-1;p<=f;p++)l=p,(h=o.FElements.AddElement()).FName=n.Get(l),u=n.GetObject(l),h.FExpr=this.CreateLiteralJSString(u,this.TransformElToJSName(u,s))}},this.CreateCallback=function(t,s,i,r){var n=null;function l(e){var t=Ue.$new();return r.Resolver.ComputeElement(e,t,{},null),!Ae.isPrototypeOf(t.IdentEl)&&!Tt.isPrototypeOf(t.LoTypeEl)}var a,o,h=null,u=null,c="",p="",f=!1,F=null,m=null,C=0,S=null,T=null,y=null,g=null;if(n=null,Se.isPrototypeOf(s.IdentEl)||this.RaiseInconsistency(20170215140756,t),m=r.Resolver,a=s.IdentEl,!m.ProcHasSelf(a))return n=this.CreateReferencePathExpr(a,r,!1,null),i&&(n=this.CreateSafeCallback(t,n,r)),n;o=m.IsHelperMethod(a),f=m.IsClassMethod(a)&&!m.MethodIsStatic(a),si.isPrototypeOf(t)&&(t=t.NameExpr),u=null,h=null;try{Je.isPrototypeOf(t)?(27!==(F=t).OpCode&&this.RaiseNotSupported(t,r,20190205230811,""),C=r.Access,r.Access=0,u=this.ConvertExpression(F.Left,r),r.Access=C,f&&(f=l(F.Left)),S=F.Right):m.IsNameExpr(t)?(S=t,ve.isPrototypeOf(t.FData)||this.RaiseNotSupported(t,r,20190205230915,""),T=t.FData,null!==(y=rtl.as(T.WithExprScope,d))?(""===(p=y.WithVarName)&&o&&this.RaiseNotSupported(S,r,20190209092355,""),f&&(f=l(y.Expr))):(null===(g=m.GetSelfScope(t))&&this.RaiseNotSupported(S,r,20190205230919,""),null!==g.SelfArg?p=this.GetLocalName(g.SelfArg,e.cvkAll,r):null!==g.ClassRecScope?(p=this.CreateReferencePath(g.ClassRecScope.FElement,r,2,!1,null),f=!1):this.RaiseNotSupported(S,r,20190206104558,Ge(a)),""===p&&(p="this"),f&&(f=l(g.SelfArg))),u=this.CreatePrimitiveDotExpr(p,S)):this.RaiseNotSupported(t,r,20190205230924,""),f&&(u=this.CreateDotExpression(t,u,this.CreatePrimitiveDotExpr(this.GetBIName(138),S),!1)),h=this.CreateCallExpression(t),p=i?this.GetBIName(65):this.GetBIName(64),h.FExpr=this.CreateMemberExpression([this.GetBIName(144),p]),h.AddArg(u),u=null,o?h.AddArg(this.CreateReferencePathExpr(a,r,!1,null)):10 in this.FOptions&&null!==a.FData.SpecializedFromItem?(c=this.CreateStaticProcPath(a,r),h.AddArg(this.CreatePrimitiveDotExpr(c,t))):(c=this.TransformElToJSName(a,r),h.AddArg(this.CreateLiteralString(t,c))),n=h}finally{null===n&&(u=rtl.freeLoc(u),h=rtl.freeLoc(h))}return n},this.CreateSafeCallback=function(e,t,s){var i=null,r=null,n=null;return i=t,us.isPrototypeOf(t)?(r=t,wt.isPrototypeOf(r.FExpr)&&(n=r.FExpr,Vt.isPrototypeOf(n.FMExpr)&&n.FMExpr.FName===this.GetBIName(144)&&n.FName===this.GetBIName(64)&&(n.FName=this.GetBIName(65)))):(i=r=this.CreateCallExpression(e),r.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(65)]),wt.isPrototypeOf(t)?(n=t,r.AddArg(n.FMExpr),n.FMExpr=null,r.AddArg(this.CreateLiteralJSString(e,n.FName)),t=rtl.freeLoc(t)):(r.AddArg(this.CreateLiteralNull(e)),r.AddArg(t))),i},this.CreatePropertyGet=function(e,t,s,i){var r,n=null,l=null,a=null,o="",h=null;if(r=(l=s.Resolver).GetPasPropertyGetter(e),h=null!==t&&ve.isPrototypeOf(t.FData)?t.FData:null,qe.isPrototypeOf(r)){if(l.IsHelperMethod(r))return null===t&&this.RaiseNotSupported(i,s,20190208111355,Ge(e)),n=this.CreateCallHelperMethod(r,t,s,!1);a=this.CreateCallExpression(i);try{a.FExpr=this.CreateReferencePathExpr(r,s,!1,h),n=this.AppendPropertyReadArgs(a,e,s,i)}finally{null===n&&(a=rtl.freeLoc(a))}}else o=this.CreateReferencePath(r,s,2,!1,h),n=this.CreatePrimitiveDotExpr(o,i);return n},this.AppendPropertyAssignArgs=function(e,t,s,i){var r,n=null,l=null;if(s.Call=e,s.PropertyEl=t,null!==(r=(n=s.Resolver).GetPasPropertyIndex(t))){l=n.Eval(r,rtl.createSet(0),!0);try{e.AddArg(this.ConvertConstValue(l,s,i))}finally{nt({get:function(){return l},set:function(e){l=e}})}}return e.AddArg(s.RightSide),s.RightSide=null,e},this.AppendPropertyReadArgs=function(e,t,s,i){var r,n,l=null,a=null;if(null!==(r=(l=s.Resolver).GetPasPropertyIndex(t))){a=l.Eval(r,rtl.createSet(0),!0);try{e.AddArg(this.ConvertConstValue(a,s.GetFunctionContext(),i))}finally{nt({get:function(){return a},set:function(e){a=e}})}}return n=l.GetPasPropertyType(t),l.IsManagedJSType(n)&&(e=this.CreateIntfRef(e,s,i)),e},this.CreateRaisePropReadOnly=function(e){var t,s=null;return t=s=this.CreateCallExpression(e),s.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(68)]),s.AddArg(this.CreateLiteralJSString(e,"EPropReadOnly")),t},this.CreateTypeInfoRef=function(e,t,s){var i,r=null,n="",l=null,a=null;return e=is(e),bt.isPrototypeOf(e)&&(e=e.FData.SpecializedType),(i=this.GetTypeInfoName(e,t,s,!1))===this.GetBIName(153)||he(i,this.GetBIName(144).length+1)===this.GetBIName(144)+"."?r=this.CreatePrimitiveDotExpr(i,e):(l=e.GetModule(),n=this.TransformModuleName(l,!0,t),(a=this.CreateElement(os,e)).FMExpr=this.CreateMemberExpression([n,this.GetBIName(145)]),a.FName=this.CreateLiteralString(e,i),r=a),r},this.CreateRTTIArgList=function(e,t,s){var i=null,r=null,n=0;if(i=null,0===t.FCount)i=this.CreateElement(fs,e);else try{r=this.CreateElement(fs,e);for(var l=0,a=t.FCount-1;l<=a;l++)n=l,this.AddRTTIArgument(rtl.getObject(t.Get(n)),r,s);i=r}finally{null===i&&(r=rtl.freeLoc(r))}return i},this.AddRTTIArgument=function(e,t,s){var i,r=null,n=0,l=null,a=null;a=s.Resolver,r=this.CreateElement(fs,e),t.FElements.AddElement().FExpr=r,i=this.TransformToJSName(e,e.FName,!0,s),r.FElements.AddElement().FExpr=this.CreateLiteralString(e,i),n=0,null===e.ArgType?r.FElements.AddElement().FExpr=this.CreateLiteralNull(e):""===e.ArgType.FName&&e.ArgType.$class.ClassType()===ft?(n+=8,l=e.ArgType,r.FElements.AddElement().FExpr=this.CreateTypeInfoRef(a.GetArrayElType(l),s,e)):r.FElements.AddElement().FExpr=this.CreateTypeInfoRef(e.ArgType,s,e);var o=e.Access;0===o||(1===o||4===o?n+=2:2===o?n+=1:3===o?n+=4:this.RaiseNotSupported(e,s,20170409192127,M.AccessNames[e.Access])),n>0&&(r.FElements.AddElement().FExpr=this.CreateLiteralNumber(e,n))},this.GetClassBIName=function(e,t){var s="";var i=e.ObjKind;return 1===i?s=function(){var t=!1,s=null;for(s=e,t=!1;!t&&null!=s;)t=s.IsExternal,s=Wt.isPrototypeOf(s.AncestorType)?rtl.as(s.AncestorType.DestType,Ae):rtl.as(s.AncestorType,Ae);return t}()?this.GetBIName(89):this.GetBIName(85):2===i?s=this.GetBIName(91):this.RaiseNotSupported(e,t,20190128102749,""),s},this.CreateRTTINewType=function(e,t,s,i,r){var n,l,a=null,o="",h=null,u=null,c=[],p=null,f=null;a=null,r.set(null),u=i.Resolver,null===(l=e.GetModule())&&this.RaiseInconsistency(20170418115552,e),n=this.TransformModuleName(l,!0,i),h=this.CreateCallExpression(e);try{h.FExpr=this.CreateMemberExpression([n,this.GetBIName(145),t]),o=this.GetTypeInfoName(e,i,e,!0),h.AddArg(this.CreateLiteralString(e,o)),Yt.isPrototypeOf(e)&&h.AddArg(this.CreateTypeInfoRef(e.DestType,i,e)),s||(r.set(this.CreateElement(zt,e)),h.AddArg(r.get()),c=u.GetAttributeCallsEl(e),null!==(p=this.CreateRTTIAttributes(c,e,i))&&((f=r.get().FElements.AddElement()).FName=this.GetBIName(164),f.FExpr=p)),a=h}finally{null===a&&(h=rtl.freeLoc(h))}return a},this.CreateRTTIAttributes=function(e,t,s){var i=null,r=null,n=null,l=0,a=null,o=null,h=null,u=null,c=null,p=null,f="",d=[],F=null,m=null;i=null,h=s.Resolver,r=null;try{for(var C=0,S=rtl.length(e)-1;C<=S;C++)if(a=e[l=C],je.isPrototypeOf(a)&&(a=a.Value),Je.isPrototypeOf(a)&&27===a.OpCode&&(a=a.Right),h.IsNameExpr(a)||this.RaiseNotSupported(a,s,20190222182742,Ge(a)),null!==(u=rtl.as(a.FData,ve))&&!(c=rtl.as(u.FDeclaration,Ae)).IsAbstract()&&(ii.isPrototypeOf(u.Context)||this.RaiseNotSupported(a,s,20190223085831,Ge(a)),!(p=u.Context.Proc).IsAbstract()&&(null!==rtl.as(p.FParent,Ae).HelperForType&&h.RaiseMsg(20190223220134,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"class method",18,"helper method"),a),f=this.TransformElToJSName(p,s),null===r&&(r=this.CreateElement(fs,t)),r.AddElement(this.CreateReferencePathExpr(c,s,!1,null)),r.AddElement(this.CreateLiteralString(t,f)),n=null,a=e[l],je.isPrototypeOf(a)))){d=a.Params;for(var T=0,y=rtl.length(d)-1;T<=y;T++){if(o=d[T],null!==(F=h.Eval(o,{},!0)))try{m=this.ConvertConstValue(F,s,t)}finally{nt({get:function(){return F},set:function(e){F=e}})}else m=this.ConvertExpression(o,s);null===n&&(n=this.CreateElement(fs,t),r.AddElement(n)),n.AddElement(m)}}i=r}finally{null===i&&(r=rtl.freeLoc(r))}return i},this.GetExtRTTIVisibilityParam=function(e,t){var s=0,i=Ne.VisibilityToExtRTTI[e.Visibility];return 0===i?s=6===e.Visibility?5:0:1===i?s=7===e.Visibility?6:1:2===i?s=2:3===i&&(s=3 in t?3:4),s},this.CreateRTTIMemberField=function(e,t,s,i){var r=this,n=null,l=null,a=null,o=null,h=0;function u(){a.AddArg(r.CreateLiteralNumber(l,h))}var c,p,f="",d=null,F=[];n=null,d=i.Resolver,null!==(p=(l=rtl.getObject(t.Get(s))).VarType)&&""===p.FName&&(function(e){var i=0,n=null;for(i=s-1;i>=0;){if(n=rtl.getObject(t.Get(i)),Be.isPrototypeOf(n)&&n.VarType===e&&r.IsElementUsed(n))return!0;i-=1}return!1}(p)||this.CreateRTTIAnonymous(p,i)),c=this.CreateTypeInfoRef(p,i,l),o=null,h=this.GetExtRTTIVisibilityParam(l,e.RTTIVisibility.Fields),a=this.CreateCallExpression(l);try{a.FExpr=this.CreateMemberExpression([this.GetBIName(153),this.GetBIName(80)]),f=this.TransformElToJSName(l,i),a.AddArg(this.CreateLiteralString(l,f)),a.AddArg(c),2!==h&&u(),F=d.GetAttributeCalls(t,s),rtl.length(F)>0&&function(e,t){var s=null;null!==t&&(null===o&&(2===h&&u(),o=r.CreateElement(zt,l),a.AddArg(o)),(s=o.FElements.AddElement()).FName=e,s.FExpr=t)}(this.GetBIName(154),this.CreateRTTIAttributes(F,l,i)),n=a,a=null}finally{a=rtl.freeLoc(a)}return n},this.CreateRTTIMemberMethod=function(e,t,s,i){var r=this,n=null,l=null,a=null,o=null,h=null,u=0,c=0;function p(){c>-1&&h.AddArg(r.CreateLiteralNumber(l,c)),c=-1}var f,d,F,m="",C=null,S=0,T=null,y=null,g=null,E=null,P=null,I=[];if(n=null,l=rtl.getObject(t.Get(s)),P=i.Resolver,l.IsOverride()&&4===(y=rtl.as(l.FData,ee)).OverriddenProc.Visibility&&(g=rtl.as(y.OverriddenProc.FData,ee),E=rtl.as(g.ClassRecScope.FElement,Ae),this.HasTypeInfo(E,i)))return n;if(l.$class.ClassType()===ri||l.$class.ClassType()===ni)return n;a=null,o=null;try{(h=this.CreateCallExpression(l)).FExpr=this.CreateMemberExpression([this.GetBIName(153),this.GetBIName(82)]),m=this.TransformElToJSName(l,i),h.AddArg(this.CreateLiteralString(l,m)),(C=l.$class.ClassType())===Se?S=0:C===qe?S=1:C===Ft?S=2:C===Ys?S=3:C===dt?S=4:C===$e?S=5:this.RaiseNotSupported(l,i,20170409190242,""),h.AddArg(this.CreateLiteralNumber(l,S)),h.AddArg(this.CreateRTTIArgList(l,l.ProcType.Args,i)),2!==(c=this.GetExtRTTIVisibilityParam(l,e.RTTIVisibility.Methods))&&p(),o=null,u=0,l.IsStatic()&&(u+=1),3 in l.ProcType.Modifiers&&(u+=2),5 in l.ProcType.Modifiers&&(u+=16),l.IsExternal()&&(u+=4),I=P.GetAttributeCalls(t,s),C.InheritsFrom(qe)&&(T=l.GetFT().ResultEl,null!==(o=this.CreateTypeInfoRef(T.ResultType,i,T))&&(p(),h.AddArg(o))),null===o&&(u>0||rtl.length(I)>0)&&(p(),h.AddArg(this.CreateLiteralNull(l))),(u>0||rtl.length(I)>0)&&h.AddArg(this.CreateLiteralNumber(l,u)),rtl.length(I)>0&&(f=this.GetBIName(154),d=this.CreateRTTIAttributes(I,l,i),F=null,null!==d&&(null===a&&(p(),a=r.CreateElement(zt,l),h.AddArg(a)),(F=a.FElements.AddElement()).FName=f,F.FExpr=d)),n=h}finally{null===n&&(h=rtl.freeLoc(h))}return n},this.CreateRTTIMemberProperty=function(e,t,s,i){var r=this,n=null,l=null,a=null,o=null,h=0;function u(){a.AddArg(r.CreateLiteralNumber(l,h))}function c(e){return r.TransformElToJSName(e,i)}function p(e,t){var s=null;null!==t&&(null===o&&(4===h&&u(),o=r.CreateElement(zt,l),a.AddArg(o)),(s=o.FElements.AddElement()).FName=e,s.FExpr=t)}var f="",d=0,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=Ue.$new(),R=Ue.$new(),v=null,A=null,N=null,x=null,b=[];n=null,l=rtl.getObject(t.Get(s)),x=i.Resolver,o=null;try{if((a=this.CreateCallExpression(l)).FExpr=this.CreateMemberExpression([this.GetBIName(153),this.GetBIName(83)]),f=this.TransformToJSName(l,l.FName,!1,i),a.AddArg(this.CreateLiteralString(l,f)),d=0,F=x.GetPasPropertyGetter(l),Se.isPrototypeOf(F)&&(d+=1),m=x.GetPasPropertySetter(l),Se.isPrototypeOf(m)&&(d+=2),g=x.GetPasPropertyStoredExpr(l),null!==(E=x.GetPasPropertyIndex(l))&&(d+=16),P=x.GetPasPropertyDefaultExpr(l),null!==g)if(x.ComputeElement(g,I,rtl.createSet(1),null),Se.isPrototypeOf(I.IdentEl))d+=12;else{if(15===I.BaseType&&null!==I.ExprEl&&null!==(v=x.Eval(g,{},!0)))try{3!==v.Kind&&this.RaiseInconsistency(20170924082845,l),g=null,v.B?d+=0:d+=4}finally{nt({get:function(){return v},set:function(e){v=e}})}null!==g&&(d+=8)}if(l.GetIsClass()&&(d+=32),a.AddArg(this.CreateLiteralNumber(l,d)),y=x.GetPasPropertyType(l),x.ComputeElement(y,R,rtl.createSet(4),null),null!==(S=this.CreateTypeInfoRef(y,i,l))?a.AddArg(S):a.AddArg(this.CreateLiteralNull(l)),null===F?a.AddArg(this.CreateLiteralString(l,"")):a.AddArg(this.CreateLiteralString(l,c(F))),null===m?a.AddArg(this.CreateLiteralString(l,"")):a.AddArg(this.CreateLiteralString(l,c(m))),4!==(h=this.GetExtRTTIVisibilityParam(l,e.RTTIVisibility.Properties))&&u(),null!==(E=x.GetPasPropertyIndex(l))){N=x.Eval(E,rtl.createSet(0),!0);try{p(this.GetBIName(161),this.ConvertConstValue(N,i,l))}finally{nt({get:function(){return N},set:function(e){N=e}})}}if(null!==g&&(C=rtl.as(g.FData,ve).FDeclaration,p(this.GetBIName(162),this.CreateLiteralString(l,c(C)))),null!==P){A=x.Eval(P,rtl.createSet(0),!1);try{T=null,R.BaseType in rtl.createSet(34,36)&&(T=this.CreateValInit(y,P,P,i)),null===T&&(T=this.ConvertConstValue(A,i,l)),p(this.GetBIName(160),T)}finally{nt({get:function(){return A},set:function(e){A=e}})}}b=x.GetAttributeCalls(t,s),rtl.length(b)>0&&p(this.GetBIName(154),this.CreateRTTIAttributes(b,l,i)),n=a}finally{null===n&&(a=rtl.freeLoc(a))}return n},this.CreateRTTIAnonymous=function(e,t){var s,i,r=null;""!==e.FName&&this.RaiseNotSupported(e,t,20170905162324,"inconsistency"),null===(s=t.GetGlobalFunc())&&this.RaiseNotSupported(e,t,20181229130835,""),Gt.isPrototypeOf(s.JSElement)||this.RaiseNotSupported(e,t,20181229130926,""),i=s.JSElement,e.$class.ClassType()===ft&&(r=this.ConvertArrayType(e,t),this.AddToSourceElements(i,r))},this.CreateRTTIAnonymousArray=function(e,t){var s,i=null,r="",n=null,l=null,a=null,o=null,h=null,u=null,c=null,f=null,d=0,F=null,m=0;i=null,a=t.Resolver,s=null!==rtl.as(e.FData,p)&&this.SpecializeNeedsDelay(e,t),r=rtl.length(e.Ranges)>0?this.GetBIName(99):this.GetBIName(87),n=this.CreateRTTINewType(e,r,!1,t,{get:function(){return l},set:function(e){l=e}});try{if(o=a.ResolveAliasType(e.ElType,!1),h=a.ResolveAliasType(o,!0),rtl.length(e.Ranges)>0)for((u=l.FElements.AddElement()).FName=this.GetBIName(146),c=this.CreateElement(fs,e),u.FExpr=c,f=e,d=0;;)if(F=f.Ranges[d],m=a.GetRangeLength(F),c.AddElement(this.CreateLiteralNumber(F,m)),(d+=1)===rtl.length(f.Ranges)){if(h.$class.ClassType()!==ft)break;f=h,0===rtl.length(f.Ranges)&&this.RaiseNotSupported(f,t,20170411222315,"static array of anonymous array"),o=a.ResolveAliasType(f.ElType,!1),h=a.ResolveAliasType(o,!0),d=0}s||((u=l.FElements.AddElement()).FName=this.GetBIName(147),u.FExpr=this.CreateTypeInfoRef(o,t,e)),i=n}finally{null===i&&(n=rtl.freeLoc(n))}return i};this.CreateRTTIMembers=function(e,t,s,i,r,n,l){var a=this,o=!1;function h(){var s;o||(o=!0,s=a.CreateVarStatement(a.GetBIName(153),n,e),t===i?a.AddToSourceElements(t,s):t.FStatements.InsertNode(0).FNode=s)}var u=0,p=0,f=null,d=null,F=null,m=null,C=null;if(o=!1,C=s.Resolver,e.$class.ClassType()===Me)u=2;else if(e.$class.ClassType()===Ae){u=2===e.ObjKind?1:0}else this.RaiseNotSupported(e,s,20190223211808,Ge(e));s.AddLocalJSVar(this.GetBIName(153),!1),l&&h();for(var S=0,T=(m=e.Members).FCount-1;S<=T;S++){if(p=S,F=null,(d=(f=rtl.getObject(m.Get(p))).$class.ClassType()).InheritsFrom(Oe)&&this.HasTypeInfo(f,r))C.IsAnonymousElType(f)&&d.InheritsFrom(ft)&&(F=this.CreateRTTIAnonymousArray(f,r));else{var y=u;if(0===y){if(4===f.Visibility);else if(!e.HasExtRTTI(f))continue}else if(1===y);else if(2===y)if(f.Visibility in rtl.createSet(1,6)){if(!e.HasExtRTTI(f))continue}else if(f.$class.ClassType()===be)continue;if(!this.IsElementUsed(f))continue;if(d===Be)F=this.CreateRTTIMemberField(e,m,p,r);else if(d.InheritsFrom(Se)){if(null!==C.GetProcTemplateTypes(f))continue;if(null!==rtl.as(f.FData,c).SpecializedFromItem)continue;F=this.CreateRTTIMemberMethod(e,m,p,r)}else d===xe?F=this.CreateRTTIMemberProperty(e,m,p,r):d.InheritsFrom(Oe)||d===li||this.DoError$2(20190105142236,3053,rtl.getResStr(Ee,"sSymbolCannotBePublished"),[],f)}null!==F&&(o||h(),this.AddToSourceElements(i,F))}return o},this.AddIntfDelegations=function(e,t,s,i,r){var n=0,l=null,a=Ue.$new(),o=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y="",g=null;m=r.Resolver,C=null,g=null;try{for(var E=0,P=rtl.length(t.Implements)-1;E<=P;E++)if(n=E,l=t.Implements[n],m.ComputeElement(l,a,rtl.createSet(1),null),Oe.isPrototypeOf(a.IdentEl)||this.RaiseInconsistency(20180327183019,l),o=a.IdentEl,p=rtl.as(m.ResolveAliasType(o,!0),Ae),""===(d=rtl.as(p.FData,h)).GUID&&this.RaiseInconsistency(20180327184912,l),!(s.IndexOf(d.GUID)>=0)){s.Add(d.GUID),(f=i.FElements.AddElement()).FName=d.GUID,F=this.CreateFunctionSt(e,!0,!1),f.FExpr=F,S=this.CreateElement(Ns,t),F.FFuncDef.FBody.FA=S,u=m.GetPasPropertyType(t),m.ComputeElement(u,a,rtl.createSet(4),null),Oe.isPrototypeOf(a.IdentEl)||this.RaiseInconsistency(20180327190201,t),c=m.ResolveAliasType(a.IdentEl,!0),Ae.isPrototypeOf(c)||this.RaiseInconsistency(20180327190442,t),null!==g&&j({get:function(){return g},set:function(e){g=e}}),(g=v.$create("Create$1",[t,S,r])).ThisVar.Element=e,g.ThisVar.Kind=3,m.GetPasPropertyArgs(t).FCount>0&&this.RaiseNotSupported(t,r,20180327191159,""),C=this.CreatePropertyGet(t,null,g,t);var I=c.ObjKind;if(1===I){var R=p.InterfaceType;0===R?y=this.GetBIName(55):1===R?y=this.GetBIName(46):this.RaiseNotSupported(t,r,20180406085319,M.InterfaceTypeNames[p.InterfaceType]),T=this.CreateCallExpression(t),S.FExpr=T,T.FExpr=this.CreateMemberExpression([this.GetBIName(144),y]),T.AddArg(C),C=null,T.AddArg(this.CreateReferencePathExpr(p,g,!1,null))}else if(2===I){var A=p.InterfaceType;0===A?C=this.IsInterfaceRef(C)?this.RemoveIntfRef(C,g):this.CreateAddRef(C,t):1===A||this.RaiseNotSupported(t,g,20180406085053,M.InterfaceTypeNames[p.InterfaceType]),S.FExpr=C,C=null}else this.RaiseNotSupported(t,g,20180327190538,M.ObjKindNames[c.ObjKind])}}finally{g=rtl.freeLoc(g),C=rtl.freeLoc(C)}},this.CreateGUIDObjLit=function(e,t,s,i){var r=this,n=null,l=0,a=null;function o(e){for(var t=null;l<a.FCount;)if(t=rtl.getObject(a.Get(l)),l+=1,Be.isPrototypeOf(t)){if(lt(t.FName,e))return t;r.RaiseInconsistency(20180415094721,s)}return r.RaiseInconsistency(20210306223031,s),t}var h=null,u=null,c=null;for(a=e.Members,n=this.CreateElement(zt,s),l=0,u=o("D1"),(h=n.FElements.AddElement()).FName=this.TransformElToJSName(u,i),h.FExpr=this.CreateLiteralHexNumber(s,t.D1,8),u=o("D2"),(h=n.FElements.AddElement()).FName=this.TransformElToJSName(u,i),h.FExpr=this.CreateLiteralHexNumber(s,t.D2,4),u=o("D3"),(h=n.FElements.AddElement()).FName=this.TransformElToJSName(u,i),h.FExpr=this.CreateLiteralHexNumber(s,t.D3,4),u=o("D4"),(h=n.FElements.AddElement()).FName=this.TransformElToJSName(u,i),c=this.CreateElement(fs,s),h.FExpr=c,l=0;l<=7;l++)c.AddElement(this.CreateLiteralHexNumber(s,t.D4[l],2));return n},this.CreateAssignManagedVar=function(e,t,s,i,r){var n=this,l=null;function a(e,t){var s=null;null!==(s=i.GetFuncContextOfPasElement(e))?ze.isPrototypeOf(t)?s.ResultNeedsIntfRelease=!0:s.Add_InterfaceRelease(t):n.RaiseInconsistency(20180401164150,r)}var o=null,h=null,u=null,c=null,p=!1,f=!1;l=null,p=!1;try{f=!1,this.IsInterfaceRef(s.get())&&(s.set(this.RemoveIntfRef(s.get(),i)),f=!0),l=o=this.CreateCallExpression(r),wt.isPrototypeOf(t.get())?(o.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(52)]),o.AddArg(t.get().FMExpr),t.get().FMExpr=null,o.AddArg(this.CreateLiteralJSString(r,t.get().FName)),j(t),o.AddArg(s.get()),s.set(null),f&&o.AddArg(this.CreateLiteralBoolean(r,!0))):os.isPrototypeOf(t.get())?(o.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(52)]),o.AddArg(t.get().FMExpr),t.get().FMExpr=null,o.AddArg(t.get().FName),t.get().FName=null,j(t),o.AddArg(s.get()),s.set(null),f&&o.AddArg(this.CreateLiteralBoolean(r,!0))):Vt.isPrototypeOf(t.get())?(o.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(51)]),(u=this.CreateElement(Vt,r)).FName=t.get().FName,o.AddArg(u),o.AddArg(s.get()),s.set(null),f&&o.AddArg(this.CreateLiteralBoolean(r,!0)),(h=this.CreateElement(_t,r)).FLHS=t.get(),t.set(null),h.FExpr=o,l=h):this.RaiseNotSupported(r,i,20180401105030,Ge(t.get())),null!==(c=e.IdentEl)&&(c.$class.ClassType()===Be&&ke.isPrototypeOf(c.FParent)||c.$class.ClassType()===Ye&&At.isPrototypeOf(c.FParent)&&Se.isPrototypeOf(c.FParent.FParent)||c.$class.ClassType()===ze)&&a(c.FParent.FParent,c),p=!0}finally{p||(l=rtl.freeLoc(l))}return l},this.IsInterfaceRef=function(e){var t,s=!1,i=null;return s=!1,null===e||e.$class.ClassType()!==us||(i=e).FExpr.$class.ClassType()!==wt?s:s=(t=i.FExpr).FName===this.GetBIName(42)&&Vt.isPrototypeOf(t.FMExpr)&&t.FMExpr.FName===this.GetBIName(119)},this.CreateAddRef=function(e,t){var s=null;return(s=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(35)]),s.AddArg(e),s},this.CreateIntfRef=function(e,t,s){var i=null,r=null;return null===(i=t.GetFunctionContext())&&this.RaiseNotSupported(s,t,20180402183859,""),this.IsInterfaceRef(e)?e:(i.IntfExprReleaseCount+=1,(r=this.CreateCallExpression(s)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(119)+"."+this.GetBIName(42),s),r.AddArg(this.CreateLiteralNumber(s,i.IntfExprReleaseCount)),r.AddArg(e),r)},this.RemoveIntfRef=function(e,t){var s,i=null,r=null,n=null;return s=(i=e.FArgs.FElements.GetE(1)).FExpr,i.FExpr=null,i=e.FArgs.FElements.GetE(0),es.isPrototypeOf(i.FExpr)&&(r=i.FExpr.FValue,null!==(n=t.GetFunctionContext())&&n.IntfExprReleaseCount===r.GetAsNumber()&&(n.IntfExprReleaseCount-=1)),e=rtl.freeLoc(e),s},this.CreateFunctionTryFinally=function(e){null===e.TrySt&&(e.TrySt=this.CreateElement($s,e.PasElement),e.TrySt.FBlock=e.BodySt,e.BodySt=e.TrySt)},this.AddFunctionFinallySt=function(e,t,s){this.CreateFunctionTryFinally(s),this.AddToStatementList({p:s,get:function(){return this.p.FinallyFirst},set:function(e){this.p.FinallyFirst=e}},{p:s,get:function(){return this.p.FinallyLast},set:function(e){this.p.FinallyLast=e}},e,t),s.TrySt.FBFinally=s.FinallyFirst},this.AddFunctionFinallyRelease=function(e,t){var s,i=null;i=this.CreateCallExpression(e),this.AddFunctionFinallySt(i,e,t),s=this.GetBIName(36),i.FExpr=this.CreateMemberExpression([this.GetBIName(144),s]),i.AddArg(this.CreateReferencePathExpr(e,t,!1,null))},this.AddInFrontOfFunctionTry=function(e,t,s){var i=null,r=null;if(this.CreateFunctionTryFinally(s),s.BodySt===s.TrySt)(i=this.CreateElement(Ht,t)).FA=e,i.FB=s.TrySt,s.BodySt=i;else if(Ht.isPrototypeOf(s.BodySt)){for(r=s.BodySt;Ht.isPrototypeOf(r.FB);)r=r.FB;(i=this.CreateElement(Ht,t)).FA=e,i.FB=r.FB,r.FB=i}else this.RaiseInconsistency(20180402103144,t)},this.AddInterfaceReleases=function(e,t){var s=0,i=null,r=null,n=null;if(e.IntfExprReleaseCount>0&&((r=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(43)]),n=this.CreateVarStatement(this.GetBIName(119),r,t),this.AddInFrontOfFunctionTry(n,t,e),(r=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(119),this.GetBIName(44)]),this.AddFunctionFinallySt(r,t,e)),null!==e.IntfElReleases)for(var l=0,a=e.IntfElReleases.FCount-1;l<=a;l++)s=l,(i=rtl.getObject(e.IntfElReleases.Get(s))).$class.ClassType()===Be?this.AddFunctionFinallyRelease(i,e):i.$class.ClassType()===Ye&&0===i.Access?(r=this.CreateAddRef(this.CreateReferencePathExpr(i,e,!1,null),i),this.AddInFrontOfFunctionTry(r,t,e),this.AddFunctionFinallyRelease(i,e)):this.RaiseInconsistency(20180401165742,i)},this.AddInterfaceRelease_Result=function(e,t,s){var i,r=null,n=null,l=null;i=this.CreateVarStatement(this.GetBIName(140),this.CreateLiteralBoolean(s,!1),s),this.AddInFrontOfFunctionTry(i,s,e),r=this.CreateElement(_t,s),this.AddToStatementList$1(rtl.as(e.TrySt.FBlock,Ht),r,s),r.FLHS=this.CreatePrimitiveDotExpr(this.GetBIName(140),s),r.FExpr=this.CreateLiteralBoolean(s,!0),n=this.CreateElement(Cs,s),this.AddFunctionFinallySt(n,s,e),n.FCond=this.CreateUnaryNot(this.CreatePrimitiveDotExpr(this.GetBIName(140),s),s),l=this.CreateCallExpression(s),n.FBTrue=l,l.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(36)]),l.AddArg(this.CreatePrimitiveDotExpr(t,s))},this.AddClassSupportedInterfaces=function(e,t,s){var i=this;function r(e){return bt.isPrototypeOf(e)&&(e=rtl.as(e.FData,rs).SpecializedType),!!i.IsElementUsed(e)}function n(t,s,r,l){var a=0,o=null,h=null,u=null,c="",p="",f=null,d=null;if(f=t.Intf,null!==t.Procs)for(var F=0,m=t.Procs.FCount-1;F<=m;F++)a=F,o=rtl.getObject(t.Procs.Get(a)),Se.isPrototypeOf(o)&&(h=o,c=i.TransformElToJSName(h,l),u=rtl.as(rtl.getObject(f.Members.Get(a)),Se),(p=i.TransformElToJSName(u,l))!==c&&(null===r.get()&&(r.set(i.CreateElement(zt,e)),s.AddArg(r.get())),(d=r.get().FElements.AddElement()).FName=p,d.FExpr=i.CreateLiteralString(e,c)));null!==t.AncestorMap&&n(t.AncestorMap,s,r,l)}var l=null,a=null,o=0,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=!1,S=!1;S=!1,C=!1,h=e.FData;do{if(null!==h.Interfaces)for(var T=0,y=h.Interfaces.FCount-1;T<=y;T++)o=T,m=h.FElement,r(rtl.getObject(m.Interfaces.Get(o)))&&(S=!0,c=rtl.getObject(h.Interfaces.Get(o)),xe.isPrototypeOf(c)&&(C=!0));h=h.AncestorScope}while(null!==h);if(S){p=null,F=te.$create("Create$1");try{a=null,h=e.FData;do{if(null!==h.Interfaces)for(var g=0,E=h.Interfaces.FCount-1;g<=E;g++)if(o=g,m=h.FElement,r(rtl.getObject(m.Interfaces.Get(o))))if(C&&(p=this.CreateElement(_t,e),this.AddToSourceElements(t,p),p.FLHS=this.CreatePrimitiveDotExpr("this."+this.GetBIName(122),e),f=this.CreateElement(zt,e),p.FExpr=f,C=!1),c=rtl.getObject(h.Interfaces.Get(o)),ai.isPrototypeOf(c)){if(u=(d=c).Intf.FData,F.IndexOf(u.GUID)>=0)continue;F.Add(u.GUID),l=this.CreateCallExpression(e),this.AddToSourceElements(t,l),l.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(37),e),l.AddArg(this.CreatePrimitiveDotExpr("this",e)),l.AddArg(this.CreateReferencePathExpr(d.Intf,s,!1,null)),n(d,l,{get:function(){return a},set:function(e){a=e}},s)}else xe.isPrototypeOf(c)?this.AddIntfDelegations(e,c,F,f,s):this.RaiseNotSupported(e,s,20180326234026,Ge(c));h=h.AncestorScope}while(null!==h)}finally{F=rtl.freeLoc(F)}}},this.CreateCallHelperMethod=function(s,i,r,n){var l=this,a=null,o=null,h=null,u=null;function p(){var t=null,s=0,n="";return null!==h?t=l.CreatePrimitiveDotExpr(h.WithVarName,i):null!==u?(n=l.GetLocalName(u.SelfArg,e.cvkAll,r),t=l.CreatePrimitiveDotExpr(n,i)):null===o?(l.RaiseNotSupported(i,r,20190205172904,""),t=null):(s=r.Access,r.Access=0,t=l.ConvertExpression(o,r),r.Access=s),t}function f(s,i,n,a,o,h){var u;function c(e){return l.CreateRangeCheckCall_TypeRange(e,l.CreatePrimitiveDotExpr(o,s),r,s)}var p=null,f=null,d=null,F=null,m=null,C=null,S=null;return C=null,_t.isPrototypeOf(a)&&""!==o&&15 in r.ScannerBoolSwitches&&null!==(m=h.LoTypeEl)&&(h.BaseType in e.btAllJSRangeCheckTypes?C=c(m):2===h.BaseType?m.$class.ClassType()===st&&(C=c(m)):37===h.BaseType&&(h.SubType in e.btAllJSRangeCheckTypes||2===h.SubType)&&(C=c(m))),u=p=l.CreateElement(zt,s),null!==i&&((f=p.FElements.AddElement()).FName=t.TempRefGetPathName,f.FExpr=i),(f=p.FElements.AddElement()).FName=t.TempRefObjGetterName,d=l.CreateFunctionSt(s,!0,!1),f.FExpr=d,F=l.CreateElement(Ns,s),d.FFuncDef.FBody.FA=F,F.FExpr=n,(f=p.FElements.AddElement()).FName=t.TempRefObjSetterName,d=l.CreateFunctionSt(s,!0,!1),f.FExpr=d,""!==o&&d.FFuncDef.FTypedParams.AddParam(o),null!==C&&((S=l.CreateElement(Ht,s)).FA=C,S.FB=a,a=S),d.FFuncDef.FBody.FA=a,u}function F(e,i){var n=null,a=null;return null===o?n=function(e,s){var i,n=null,a=null,o="",h=null,u=null,c=null,d=!1;return Ye.isPrototypeOf(s.IdentEl)&&(u=s.IdentEl).Access in rtl.createSet(2,3)?l.CreatePrimitiveDotExpr(l.TransformArgName(u,r),e):(i=p(),1 in s.Flags?(c=s.LoTypeEl,d=r.Resolver.IsManagedJSType(c),n=p(),o=t.TempRefObjSetterArgName,l.FindAvailableLocalName({get:function(){return o},set:function(e){o=e}},n),a=l.CreatePrimitiveDotExpr(o,e),d?n=l.CreateAssignManagedVar(s,{get:function(){return n},set:function(e){n=e}},{get:function(){return a},set:function(e){a=e}},r,e):((h=l.CreateElement(_t,e)).FLHS=n,h.FExpr=a,n=h)):(o="",n=l.CreateRaisePropReadOnly(e)),f(e,null,i,n,o,s))}(e,i):xe.isPrototypeOf(i.IdentEl)?n=function(e,s){var i,n,a,h,u=null,c=null,p=null,d=null,F=null,m=null,C=null,S="",T="";return i=s.IdentEl,n=r.Access,r.Access=0,p=l.ConvertExpression(o,r),r.Access=n,a=s.LoTypeEl,h=r.Resolver.IsManagedJSType(a),d=null,S="",null===p?l.DoError$2(20190211105946,3059,rtl.getResStr(Ee,"sNoMemberIsProvidedToAccessProperty"),[],e):p.$class.ClassType()===es?(c=l.CreateRaisePropReadOnly(e),u=p):p.$class.ClassType()===wt?(d=(m=p).FMExpr,m.FMExpr=null,T=m.FName,m=rtl.freeLoc(m),u=l.CreateMemberExpression(["this",t.TempRefGetPathName,T]),S=t.TempRefObjSetterArgName,F=l.CreatePrimitiveDotExpr(S,e),c=4 in i.VarModifiers?l.CreateDotExpression(e,l.CreateReferencePathExpr(i.FParent,r,!1,null),l.CreatePrimitiveDotExpr(T,e),!1):l.CreateMemberExpression(["this",t.TempRefGetPathName,T]),h?c=l.CreateAssignManagedVar(s,{get:function(){return c},set:function(e){c=e}},{get:function(){return F},set:function(e){F=e}},r,e):((C=l.CreateElement(_t,e)).FLHS=c,c=C,C.FExpr=F)):p.$class.ClassType()===us?(d=p,u=l.CreateMemberExpression(["this",t.TempRefGetPathName]),(C=l.CreateElement(_t,e)).FLHS=l.CreateMemberExpression(["this",t.TempRefGetPathName]),c=C,S=t.TempRefObjSetterArgName,C.FExpr=l.CreatePrimitiveDotExpr(S,e)):l.RaiseNotSupported(e,r,20190210193605,Ge(p)),f(e,d,u,c,S,s)}(e,i):(null===(a=rtl.as(s.FData,c)).SelfArg&&l.RaiseNotSupported(e,r,20190209214906,Ge(s)),n=l.CreateProcCallArgRef(o,Ue.$clone(i),a.SelfArg,r)),n}var m,C=null,S=null,T=null,y=Ue.$new(),g=null,E=null,P=null,I="",R=null,v=null,A=!1,N=null,x=null,b=null,O=null,k=null,$=null,D=null;a=null,m=(C=r.Resolver).MethodIsStatic(s),h=null,u=null,E=i,N=null,$=null,o=null,g=null,R=null,O=null;try{if(n?(o=i,E=i,C.ComputeElement(o,y,{},null)):(P=i,si.isPrototypeOf(P)&&(P=P.NameExpr),Je.isPrototypeOf(P)?(27!==(T=P).OpCode&&this.RaiseNotSupported(P,r,20190201163152,""),o=T.Left,C.ComputeElement(o,y,{},null),E=T.Right,ve.isPrototypeOf(E.FData)&&(N=E.FData)):C.IsNameExpr(P)?(E=P,ve.isPrototypeOf(P.FData)||this.RaiseNotSupported(P,r,20190201163210,""),N=P.FData,null!==(h=rtl.as(N.WithExprScope,d))?C.ComputeElement(h.Expr,y,{},null):m?y.$assign(Ue.$new()):(null===(u=C.GetSelfScope(P))&&this.RaiseNotSupported(E,r,20190205171529,""),null===u.SelfArg&&this.RaiseNotSupported(E,r,20190205171902,Ge(u.FElement)),C.ComputeElement(u.SelfArg,y,{},null))):je.isPrototypeOf(P)?(E=P,ve.isPrototypeOf(P.FData)||this.RaiseNotSupported(P,r,20190208105144,""),(N=E.FData).FDeclaration.$class.ClassType()!==xe&&this.RaiseNotSupported(P,r,20190208105222,""),o=P.Value,C.ComputeElement(o,y,{},null)):(this.RaiseNotSupported(P,r,20190201163210,""),y.$assign(Ue.$new()))),S=y.LoTypeEl,v=y.IdentEl,A=!1,null!==N&&(A=s.$class.ClassType()===Ft&&!(3 in N.Flags),N.FDeclaration.$class.ClassType()===xe&&($=N.FDeclaration)),m?s.$class.ClassType()!==$e&&s.$class.ClassType()!==dt&&this.RaiseNotSupported(E,r,20190206151034,Ge(s)):s.$class.ClassType()===$e||s.$class.ClassType()===dt?(null===S&&this.RaiseNotSupported(E,r,20190201163453,Zs(y)),Ae.isPrototypeOf(v)?(y.IdentEl.IsExternal&&this.RaiseNotSupported(E,r,20190201165636,""),g=this.CreateReferencePathExpr(y.IdentEl,r,!1,null)):S.$class.ClassType()===Ae&&0 in y.Flags?(y.LoTypeEl.IsExternal&&this.RaiseNotSupported(E,r,20190201165656,""),g=p(),g=this.CreateDotExpression(E,g,this.CreatePrimitiveDotExpr(this.GetBIName(138),E),!1)):S.$class.ClassType()===Tt&&0 in y.Flags?g=p():this.RaiseNotSupported(E,r,20190201162601,Zs(y))):s.$class.ClassType()===qe||s.$class.ClassType()===Se||A?(Oe.isPrototypeOf(v)&&this.RaiseNotSupported(E,r,20190201170843,""),Ae.isPrototypeOf(S)&&0 in y.Flags&&1===S.ObjKind||Me.isPrototypeOf(S)&&0 in y.Flags?g=p():null!==v?(D=v.$class.ClassType())===Ye||D===Be||D===be||D===xe||D===ze||D===ns||D===Ae?g=F(E,y):this.RaiseNotSupported(E,r,20190209224904,Zs(y)):null!==y.ExprEl&&0 in y.Flags?g=F(E,y):this.RaiseNotSupported(E,r,20190131211753,"")):s.$class.ClassType()===Ft?(null===N&&this.RaiseNotSupported(E,r,20190206151234,""),3 in N.Flags||this.RaiseNotSupported(E,r,20190206151901,""),null===S||S.$class.ClassType()!==Ae&&S.$class.ClassType()!==Tt?(R=this.CreateCallExpression(E),I=this.CreateReferencePath(s.FParent,r,2,!1,null)+"."+this.GetBIName(34),R.FExpr=this.CreatePrimitiveDotExpr(I,E),I=this.TransformElToJSName(s,r),R.AddArg(this.CreateLiteralString(E,I))):(S.$class.ClassType()===Ae&&1!==S.ObjKind&&this.RaiseNotSupported(E,r,20190302154215,at(S)),R=this.CreateCallExpression(E),g=p(),R.FExpr=this.CreateDotExpression(E,g,this.CreatePrimitiveDotExpr(this.GetBIName(25),E),!1),g=null,R.AddArg(this.CreateReferencePathExpr(s,r,!1,null))),k=this.CreateElement(fs,E),R.AddArg(k),O=k.FElements):this.RaiseNotSupported(E,r,20190201162609,Ge(s)),null===R&&(null!==g||m||this.RaiseNotSupported(E,r,20190203171010,Zs(y)),R=this.CreateCallExpression(i),I=10 in this.FOptions&&null!==s.FData.SpecializedFromItem?this.CreateGlobalElPath(s,r):this.CreateReferencePath(s,r,2,!1,null),m||(I+=".call"),R.FExpr=this.CreatePrimitiveDotExpr(I,i),null!==g&&(R.AddArg(g),g=null),O=R.FArgs.FElements),null!==$){if(C.GetPasPropertyArgs($).FCount>0)return a=R,R=null,a;var L=r.Access;if(1===L)return a=this.AppendPropertyAssignArgs(R,$,r,E),R=null,a;if(0===L)return a=this.AppendPropertyReadArgs(R,$,r,E),R=null,a;this.RaiseNotSupported(E,r,20190207122708,"")}x=s.ProcType,b=je.isPrototypeOf(i.FParent)&&i.FParent.Value===i?i.FParent:null,this.CreateProcedureCallArgs(O,b,x,r),Xe.isPrototypeOf(x)&&C.IsManagedJSType(x.ResultEl.ResultType)&&(R=this.CreateIntfRef(R,r,E)),a=R,R=null}finally{R=rtl.freeLoc(R),g=rtl.freeLoc(g)}return a};var F="args";this.AddHelperConstructor=function(e,s,i){var r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=null,f=null,d=null,m=null,C=null,S=null,T="\0";if(null!==e.HelperForType&&(r=i.Resolver.ResolveAliasType(e.HelperForType,!0)).$class.ClassType()!==Ae){o=this.CreateElement(Gt,e),p=v.$create("Create$1",[e,o,i]);try{p.ThisVar.Element=e,p.ThisVar.Kind=2,p.IsGlobal=!0,d=this.CreateElement(Ns,e),this.AddToSourceElements(o,d),h=this.CreateCallExpression(e),d.FExpr=h,u=this.CreateElement(wt,e),h.FExpr=u,c=this.CreateElement(os,e),u.FMExpr=c,u.FName="apply",c.FMExpr=this.CreatePrimitiveDotExpr("this",e),c.FName=this.CreatePrimitiveDotExpr("fn",e),f=this.CreateValInit(r,null,e,p),r.$class.ClassType()===Me||((S=(C=this.CreateElement(zt,e)).FElements.AddElement()).FName="p",S.FExpr=f,f=C,(S=C.FElements.AddElement()).FName=t.TempRefObjGetterName,a=this.CreateFunctionSt(e,!0,!1),S.FExpr=a,m=this.CreateElement(Ns,e),a.FFuncDef.FBody.FA=m,m.FExpr=this.CreateMemberExpression(["this","p"]),(S=C.FElements.AddElement()).FName=t.TempRefObjSetterName,a=this.CreateFunctionSt(e,!0,!1),S.FExpr=a,T=t.TempRefObjSetterArgName,a.FFuncDef.FTypedParams.AddParam(T),n=this.CreateElement(_t,e),a.FFuncDef.FBody.FA=n,n.FLHS=this.CreateMemberExpression(["this","p"]),n.FExpr=this.CreatePrimitiveDotExpr(T,e)),h.AddArg(f),h.AddArg(this.CreatePrimitiveDotExpr(F,e)),n=this.CreateElement(_t,e),this.AddToSourceElements(s,n),n.FLHS=this.CreatePrimitiveDotExpr("this."+this.GetBIName(34),e),l=this.CreateFunctionSt(e,!0,!1),n.FExpr=l,l.FFuncDef.FTypedParams.AddParam("fn"),l.FFuncDef.FTypedParams.AddParam(F),l.FFuncDef.FBody.FA=o,o=null}finally{o=rtl.freeLoc(o),p=rtl.freeLoc(p)}}},this.ConvertImplBlockElements=function(e,t,s){var i=null,r=null,n=null,l=0,a=null,o=null;if(null!=e.Elements&&e.Elements.FCount>0){i=null;try{r=null,n=null;for(var h=0,u=e.Elements.FCount-1;h<=u;h++)l=h,a=rtl.getObject(e.Elements.Get(l)),null!==(o=this.ConvertElement(a,t))&&this.AddToStatementList({get:function(){return r},set:function(e){r=e}},{get:function(){return n},set:function(e){n=e}},o,a);i=r}finally{null===i&&(r=rtl.freeLoc(r))}}else i=s?null:this.CreateElement(bs,e);return i},this.ConvertBeginEndStatement=function(e,t,s){return this.ConvertImplBlockElements(e,t,s)},this.ConvertStatement=function(e,t){var s=null;return s=null,oi.isPrototypeOf(e)?s=this.ConvertRaiseStatement(e,t):hi.isPrototypeOf(e)?s=this.ConvertAssignStatement(e,t):ui.isPrototypeOf(e)?s=this.ConvertWhileStatement(e,t):ci.isPrototypeOf(e)?s=this.ConvertSimpleStatement(e,t):pi.isPrototypeOf(e)?s=this.ConvertWithStatement(e,t):ut.isPrototypeOf(e)?s=this.ConvertExceptOn(e,t):fi.isPrototypeOf(e)?s=this.ConvertForStatement(e,t):di.isPrototypeOf(e)?s=this.ConvertAsmStatement(e,t):this.RaiseNotSupported(e,t,20161024192759,""),s},this.ConvertAssignStatement=function(t,s){var i=this,r=null,n=!1,l=!1,a=!1,o=!1;function h(e,r){i.RaiseNotSupported(t,s,r,Zs(e.LeftResolved)+M.AssignKindNames[t.Kind]+Zs(e.RightResolved))}function u(){return l||(l=!0,n=i.IsExprTemporaryVar(t.Right)),n}function c(){return o||(o=!0,a=i.IsExprPropertySetterConst(t.Left,s)),a}function p(e,s,r,n){var l=null,a=null;return(a=i.CreateCallExpression(t)).FExpr=i.CreatePrimitiveDotExpr(i.GetBIName(144)+"."+i.GetBIName(n),t),e.$class.ClassType()===_t?(l=e,a.AddArg(e.FExpr),e.FExpr=a):(a.AddArg(e),l=a),a.AddArg(i.CreateLiteralNumber(t.Right,s)),a.AddArg(i.CreateLiteralNumber(t.Right,r)),l}function f(e,r){var n=null,l=null;n=e,null===(l=s.Resolver.EvalTypeRange(r,rtl.createSet(0)))&&i.RaiseNotSupported(t,s,20180424110758,"range checking "+Ge(r));try{if(10===l.Kind){var a=l.ElKind;1===a||2===a?n=p(e,l.RangeStart,l.RangeEnd,72):3===a?n=p(e,l.RangeStart,l.RangeEnd,71):4===a||i.RaiseNotSupported(t,s,20190220003746,"range checking "+l.AsDebugString())}else i.RaiseNotSupported(t,s,20180424111037,"range checking "+l.AsDebugString())}finally{nt({get:function(){return l},set:function(e){l=e}})}return n}var d=null,F=null,m=null,C={},S=!1,T=null,y=0,g=0,E=null,P=null,I=null,R=null,v=ht.$new();r=null,d=null,I=s.Resolver,o=!1,l=!1,m=O.$create("Create$1",[t,null,s]);try{if(null!==I&&(I.ComputeElement(t.Left,m.LeftResolved,rtl.createSet(1),null),C={},(S=I.IsProcedureType(m.LeftResolved,!1))&&(C=3 in s.CurrentModeSwitches()?rtl.includeSet(C,1):rtl.includeSet(C,2)),I.ComputeElement(t.Right,m.RightResolved,rtl.refSet(C),null),S&&3 in s.CurrentModeSwitches()&&31===m.RightResolved.BaseType&&Se.isPrototypeOf(m.RightResolved.IdentEl)?(E=m.LeftResolved.LoTypeEl,m.RightSide=this.CreateCallback(t.Right,Ue.$clone(m.RightResolved),6===E.CallingConvention,s)):30===m.RightResolved.BaseType?I.IsArrayType(m.LeftResolved)&&(I.IsManagedJSType(m.LeftResolved.LoTypeEl)?m.RightSide=this.CreateLiteralNull(t.Right):m.RightSide=this.CreateElement(fs,t.Right)):2===m.LeftResolved.BaseType&&((E=m.LeftResolved.LoTypeEl).$class.ClassType()===Me&&m.RightResolved.BaseType in U.btAllStrings&&(I.GetAssignGUIDString(E,t.Right,v)?(R=this.CreateGUIDObjLit(E,v,t,s),m.RightSide=R):this.RaiseNotSupported(t,s,20180415101516,"")),E.$class.ClassType()===ft&&(0!==t.Kind&&I.RaiseMsg(20201028212754,3003,rtl.getResStr(Ee,"sIllegalQualifier"),pe(18,M.AssignKindNames[t.Kind]),t),I.IsReadEqWrite(m.LeftResolved)&&(m.RightSide=this.ConvertDirectAssignArrayStatement(t,m))))),null===m.RightSide&&(m.RightSide=this.ConvertExpression(t.Right,s)),m.RightResolved.BaseType in rtl.createSet(34,36)&&null!==m.RightResolved.IdentEl)m.RightSide=this.CreateReferencedSet(t.Right,m.RightSide);else if(14===m.LeftResolved.BaseType)14===m.RightResolved.BaseType||(m.RightResolved.BaseType in e.btAllJSFloats?(m.RightSide=this.CreateMulNumber(t,m.RightSide,1e4),m.RightSide=this.CreateTruncFloor(t,m.RightSide,!0)):m.RightResolved.BaseType in e.btAllJSInteger?m.RightSide=this.CreateMulNumber(t,m.RightSide,1e4):this.RaiseNotSupported(t,s,20181016094542,Zs(m.RightResolved)));else if(14===m.RightResolved.BaseType)m.RightSide=this.CreateDivideNumber(t,m.RightSide,1e4);else if(m.LeftResolved.BaseType!==m.RightResolved.BaseType&&m.LeftResolved.BaseType in e.btAllJSInteger&&m.RightResolved.BaseType in e.btAllJSInteger)this.PrepareAssignDifferentIntegers(t,m);else if(m.RightResolved.BaseType in U.btAllStringAndChars)2===m.LeftResolved.BaseType&&ft.isPrototypeOf(m.LeftResolved.LoTypeEl)&&(m.RightSide=this.CreateDotSplit(t.Right,m.RightSide));else if(2===m.RightResolved.BaseType)if((P=m.RightResolved.LoTypeEl).$class.ClassType()===ft)rtl.length(P.Ranges)>0?u()||c()||(m.RightSide=this.CreateCloneStaticArray(t.Right,P,m.RightSide,s)):P.FParent.$class.ClassType()===Ye||2===m.LeftResolved.BaseType&&ft.isPrototypeOf(m.LeftResolved.LoTypeEl)&&(0!==t.Kind&&I.RaiseMsg(20201028213335,3003,rtl.getResStr(Ee,"sIllegalQualifier"),pe(18,M.AssignKindNames[t.Kind]),t),u()||c()||I.IsManagedJSType(m.LeftResolved.LoTypeEl)||(m.RightSide=this.CreateArrayRef(t.Right,m.RightSide)));else if(P.$class.ClassType()===Ae){if(m.LeftResolved.BaseType in U.btAllStrings)2===P.ObjKind&&(m.RightSide=this.CreateDotNameExpr(t,m.RightSide,this.GetBIName(120)));else if(2===m.LeftResolved.BaseType)if((E=m.LeftResolved.LoTypeEl).$class.ClassType()===Me)2===P.ObjKind&&lt(E.FName,"TGUID")?((T=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(45),t),T.AddArg(m.RightSide),m.RightSide=T):this.RaiseNotSupported(t,s,20180413194856,"");else if(E.$class.ClassType()===Ae){var A=E.ObjKind;if(1===A)1===P.ObjKind||h(m,20180327202735);else if(2===A){var N=P.ObjKind;if(1===N){P.IsExternal&&this.RaiseNotSupported(t.Right,s,20180327210004,"external class instance"),null===m.LeftResolved.LoTypeEl&&this.RaiseNotSupported(t.Right,s,20180327204021,""),T=this.CreateCallExpression(t.Right);var x=E.InterfaceType;0===x?(T.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(55)]),T.AddArg(m.RightSide),m.RightSide=T,T.AddArg(this.CreateReferencePathExpr(m.LeftResolved.LoTypeEl,s,!1,null)),T=this.CreateIntfRef(T,s,t),m.RightSide=T):1===x?(T.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(46)]),T.AddArg(m.RightSide),m.RightSide=T,T.AddArg(this.CreateReferencePathExpr(m.LeftResolved.LoTypeEl,s,!1,null))):this.RaiseNotSupported(t,s,20180401225931,M.InterfaceTypeNames[P.InterfaceType])}else 2===N||h(m,20180327203326)}else h(m,20180327203334)}}else P.$class.ClassType()===Me?m.LeftResolved.BaseType in U.btAllStrings&&I.IsTGUID(P)&&((T=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(47),t),T.AddArg(m.RightSide),m.RightSide=T):At.isPrototypeOf(P)&&(E=m.LeftResolved.LoTypeEl,At.isPrototypeOf(E)&&6===m.LeftResolved.LoTypeEl.CallingConvention&&Qt.isPrototypeOf(t.Right)&&24===t.Right.OpCode&&(m.RightSide=this.CreateSafeCallback(t.Right,m.RightSide,s)));if(d=this.ConvertExpression(t.Left,m),null!==m.Call)null!==m.RightSide&&this.RaiseInconsistency(20170207215544,t.Left),r=d;else{if(null===m.RightSide&&this.RaiseInconsistency(20180622211919,t),E=m.LeftResolved.LoTypeEl,2===m.LeftResolved.BaseType&&I.IsManagedJSType(E)&&null!==(r=this.CreateAssignManagedVar(m.LeftResolved,{get:function(){return d},set:function(e){d=e}},{p:m,get:function(){return this.p.RightSide},set:function(e){this.p.RightSide=e}},m,t)))return r;var b=t.Kind;0===b?F=this.CreateElement(_t,t):1===b?F=this.CreateElement(Fi,t):2===b?F=this.CreateElement(mi,t):3===b?F=this.CreateElement(Ci,t):4===b?F=this.CreateElement(Si,t):this.RaiseNotSupported(t,s,20161107221807,""),F.FExpr=m.RightSide,m.RightSide=null,F.FLHS=d,r=F,d=null,15 in s.ScannerBoolSwitches&&!es.isPrototypeOf(F.FExpr)&&(m.LeftResolved.BaseType in e.btAllJSInteger?it.isPrototypeOf(E)?(I.GetIntegerRange(m.LeftResolved.BaseType,{get:function(){return y},set:function(e){y=e}},{get:function(){return g},set:function(e){g=e}})||this.RaiseNotSupported(t.Left,s,20180119154120,""),r=p(r,y,g,72)):E.$class.ClassType()===rt&&(r=f(r,E)):m.LeftResolved.BaseType in e.btAllJSChars?r=f(r,E):2===m.LeftResolved.BaseType?E.$class.ClassType()===st&&(r=f(r,E)):37===m.LeftResolved.BaseType&&(m.LeftResolved.SubType in e.btAllJSRangeCheckTypes||2===m.LeftResolved.SubType)&&(r=f(r,E)))}}finally{null===r&&(d=rtl.freeLoc(d)),rtl.free(m,"RightSide"),m=rtl.freeLoc(m)}return r},this.ConvertDirectAssignArrayStatement=function(e,t){var s,i=null,r=null,n=null,l=null;(i=null,10===(s=e.Right).Kind)?(r=(l=s).Value,ve.isPrototypeOf(r.FData)&&(n=r.FData.FDeclaration,Ti.isPrototypeOf(n.FData)&&23===n.FData.BuiltIn&&(i=this.ConvertDirectAssignArrayConcat(e,l,t)))):9===s.Kind&&1===s.OpCode&&(i=this.ConvertDirectAssignArrayAdd(e,s,t));return i},this.ConvertDirectAssignArrayConcat=function(e,t,s){var i,r,n,l=null,a=null,o=null,h=null,u=null,c=null,p=0,f=null;if(l=null,r=e.Left,!ve.isPrototypeOf(r.FData))return l;if(n=r.FData,i=t.Params[0],ve.isPrototypeOf(i.FData)&&(o=i.FData,n.FDeclaration===o.FDeclaration)){if(u=s.Parent,1===rtl.length(t.Params))return l=this.ConvertExpression(i,u);if(2===rtl.length(t.Params)&&4===(a=t.Params[1]).Kind){if(h=a,0===rtl.length(h.Params))return l=this.ConvertExpression(i,u);try{(c=this.CreateArrayConcat$1(rtl.as(s.LeftResolved.LoTypeEl,ft),e,u,!0)).AddArg(this.ConvertExpression(i,u));for(var d=0,F=rtl.length(h.Params)-1;d<=F;d++)p=d,f=this.ConvertExpression(h.Params[p],u),c.AddArg(f);s.Resolver.IsManagedJSType(s.LeftResolved.LoTypeEl)&&(l=this.CreateIntfRef(l,s,e)),l=c}finally{null===l&&(c=rtl.freeLoc(c))}}}return l},this.ConvertDirectAssignArrayAdd=function(e,t,s){var i,r,n,l=null,a=null,o=null,h=null,u=0,c=null;if(l=null,i=t.Left,!ve.isPrototypeOf(i.FData))return l;if(n=i.FData.FDeclaration,!ve.isPrototypeOf(e.Left.FData))return l;if(n!==e.Left.FData.FDeclaration)return l;if(4===(r=t.Right).Kind){if(o=r,a=s.Parent,0===rtl.length(o.Params))return l=this.ConvertExpression(i,a);try{(h=this.CreateArrayConcat$1(rtl.as(s.LeftResolved.LoTypeEl,ft),e,a,!0)).AddArg(this.ConvertExpression(i,a));for(var p=0,f=rtl.length(o.Params)-1;p<=f;p++)u=p,c=this.ConvertExpression(o.Params[u],a),h.AddArg(c);l=h,s.Resolver.IsManagedJSType(s.LeftResolved.LoTypeEl)&&(l=this.CreateIntfRef(l,s,e))}finally{null===l&&(h=rtl.freeLoc(h))}}return l},this.ConvertRaiseStatement=function(e,t){var s=null,i=null;return s=null!==e.ExceptObject?this.ConvertExpression(e.ExceptObject,t):this.CreatePrimitiveDotExpr(this.GetBIName(118),e),(i=this.CreateElement(yi,e)).FA=s,i},this.ConvertIfStatement=function(e,t){var s=null,i=null,r=null,n=null,l=null;s=null,i=null,r=null,n=null;try{i=this.ConvertExpression(e.ConditionExpr,t),null!=e.IfBranch&&(r=this.ConvertElement(e.IfBranch,t)),null!=e.ElseBranch&&(n=this.ConvertElement(e.ElseBranch,t)),(l=this.CreateElement(Cs,e)).FCond=i,l.FBTrue=r,l.FBFalse=n,s=l}finally{null===s&&(j({get:function(){return i},set:function(e){i=e}}),j({get:function(){return r},set:function(e){r=e}}),j({get:function(){return n},set:function(e){n=e}}))}return s},this.ConvertWhileStatement=function(e,t){var s=null,i=null,r=null,n=!1;s=null,i=null,n=!1;try{s=this.ConvertExpression(e.ConditionExpr,t),i=null!=e.Body?this.ConvertElement(e.Body,t):this.CreateElement(bs,e),n=!0}finally{n||(j({get:function(){return i},set:function(e){i=e}}),j({get:function(){return s},set:function(e){s=e}}))}return(r=this.CreateElement(Ds,e)).FCond=s,r.FBody=i,r},this.ConvertRepeatStatement=function(e,t){var s=null,i=null,r=null,n=null;s=null,i=null,n=null;try{i=this.ConvertExpression(e.ConditionExpr,t),Js.isPrototypeOf(i)?(i=(n=i).FA,n.FA=null,n=rtl.freeLoc(n),n=null):i=this.CreateUnaryNot(i,e.ConditionExpr),n=this.ConvertImplBlockElements(e,t,!1),(r=this.CreateElement(gi,e)).FCond=i,r.FBody=n,s=r}finally{null===s&&(j({get:function(){return n},set:function(e){n=e}}),j({get:function(){return i},set:function(e){i=e}}))}return s};this.ConvertForStatement=function(t,s){var i=this,r=null,n=null;function l(t){var r=null,l=Ue.$new();if(r=i.ConvertExpression(t,s),es.isPrototypeOf(r)){var a=r.FValue.FValueType;if(2===a)r.FValue.SetAsNumber(r.FValue.GetAsBoolean()+0);else{if(3===a)return r;if(4===a)return i.ConvertCharLiteralToInt(r,t,s),r;r=rtl.freeLoc(r),i.RaiseNotSupported(t,s,20171112021222,"")}}else null!==n&&(n.ComputeElement(t,l,{},null),l.BaseType in U.btAllChars||37===l.BaseType&&l.SubType in U.btAllChars?r=i.CreateCallCharCodeAt(r,0,t):(l.BaseType in e.btAllJSBooleans||37===l.BaseType&&l.SubType in e.btAllJSBooleans)&&(r=i.CreateUnaryPlus(r,t)));return r}function a(e,t){var r=0,l=null;return null===e?0:(4===(l=n.fExprEvaluator.OrdValue(e,t)).Kind?r=l.Int:i.RaiseNotSupported(t,s,20171112133917,""),e!==l&&nt({get:function(){return l},set:function(e){l=e}}),r)}function o(e,t){return 2 in i.FOptions||t<0||t>=e.Values.FCount?Ei.$create("CreateValue",[t]):Pi.$create("CreateValue",[t,rtl.as(rtl.getObject(e.Values.Get(t)),ns)])}var h=null,u=Ue.$new(),c=Ue.$new(),p=null,f=null,d=null,F=0,m=0,C=!1,S=!1,T=!1,y=0,g=null;function E(e,t){var s=null;return(s=i.CreateElement(Ii,t)).FA=e,s.FB=i.CreateLiteralNumber(t,0),s}var P=null,I=null,R=null,v=null,A=null,N=null,x="",b="",O="",k=null,$=null,D=null,L=null,B=null;r=null,0!==s.Access&&this.RaiseInconsistency(20170213213740,t),n=s.Resolver,g=rtl.as(t.FData,Ri);var M=t.LoopType;0===M||1===M||(2===M?null===n&&this.RaiseNotSupported(t,s,20171112160707,""):this.RaiseNotSupported(t,s,20171110141937,"")),h=s.GetFunctionContext(),p=null,F=0,f=null,m=0,d=null,y=0,$=null;try{if(C=!0,S=!0,T=!1,null!==n&&!function(){var l,h=null,E=null,P=Ue.$new(),I=Ue.$new(),R=Ue.$new();l=!0,n.ComputeElement(t.VariableName,u,rtl.createSet(1),null),Be.isPrototypeOf(u.IdentEl)||ze.isPrototypeOf(u.IdentEl)||i.DoError$2(20170213214404,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"var",18,n.GetResolverResultDescription(u,!1)),t.VariableName);var v=t.LoopType;if(0===v||1===v)p=n.Eval(t.StartExpr,{},!1),F=a(p,t.StartExpr),f=n.Eval(t.EndExpr,{},!1),m=a(f,t.EndExpr);else if(2===v){if(null!==g.GetEnumerator)return r=i.CreateGetEnumeratorLoop(t,s),!1;if(n.ComputeElement(t.StartExpr,c,{},null),T=!0,null===(d=n.Eval(t.StartExpr,{},!1))&&Oe.isPrototypeOf(c.IdentEl)&&(E=n.ResolveAliasType(c.IdentEl,!0),ft.isPrototypeOf(E)?1===rtl.length(E.Ranges)&&(d=n.Eval(E.Ranges[0],rtl.createSet(0),!0)):vt.isPrototypeOf(E)&&(d=n.EvalTypeRange(E.EnumType,rtl.createSet(0)))),null!==d){var A=d.Kind;if(8===A)y=4,F=0,m=d.S.length-1,nt({get:function(){return d},set:function(e){d=e}});else if(10===A||12===A){if(12===d.Kind){if(0===rtl.length(d.Ranges))return!1;if(rtl.length(d.Ranges)>1){var N=d.ElKind;return 1===N||2===N?y=7:3===N?y=9:4===N&&(y=8),T=!1,C=7!==y,S=!1,l}}F=d.RangeStart,m=d.RangeEnd,T=!1,S=!1;var x=d.ElKind;1===x?2 in i.FOptions?y=0:(y=1,h=d.ElType,p=o(h,F),f=o(h,m)):2===x?y=0:3===x?y=3:4===x?y=2:i.RaiseNotSupported(t.StartExpr,s,20171113023419,"")}else i.RaiseNotSupported(t.StartExpr,s,20171112161527,"")}else if(0 in c.Flags)if(c.BaseType in U.btAllStrings)y=4,F=0;else if(1===c.BaseType){if(n.IsJSBaseType$1(c,1,!1))return y=10,T=!1,C=!1,S=!1,l}else if(2===c.BaseType)if((E=c.LoTypeEl).$class.ClassType()===ft)rtl.length(E.Ranges)<=1?(y=n.IsManagedJSType(u.LoTypeEl)?6:5,F=0):i.RaiseNotSupported(t.StartExpr,s,20171220010147,"");else if(E.$class.ClassType()===Ae&&E.IsExternal){if(!n.IsForInExtArray(t,u,c,P,I,R))return y=10,T=!1,C=!1,S=!1,l;y=5,F=0}else i.RaiseNotSupported(t.StartExpr,s,20171113012226,"");else{if(c.BaseType in rtl.createSet(34,36))return y=c.SubType in e.btAllJSBooleans?8:c.SubType in U.btAllChars?9:7,T=!1,C=!0,S=!1,l;i.RaiseNotSupported(t.StartExpr,s,20171220221747,"")}else i.RaiseNotSupported(t.StartExpr,s,20171112195629,"")}if(null!==f&&(S=!1,null!==p))if(F<=m)p.Kind in rtl.createSet(4,5,9)&&(C=!1);else if(5 in i.FOptions)return l;return l}())return r;if(null===h?(O="$in",x="$l",b="$end"):(O=T?h.AddLocalJSVar(this.GetBIName(135),!0).Name:"",x=C?h.AddLocalJSVar(this.GetBIName(133),!0).Name:"",b=S?h.AddLocalJSVar(this.GetBIName(134),!0).Name:""),$=P=y in rtl.createSet(7,8,9,10)?this.CreateElement(gs,t):this.CreateElement(ys,t),k=t,C||!S&&!T||(I=this.CreateElement(Ht,t),R=this.CreateElement(_t,t.VariableName),I.FA=R,I.FB=$,$=I,R.FLHS=this.ConvertExpression(t.VariableName,s),R.FExpr=null!==p?this.CreateLiteralNumber(t.StartExpr,F):this.ConvertExpression(t.StartExpr,s),k=t.StartExpr),P.$class.ClassType()===gs)C?((N=this.CreateElement(Kt,k)).FA=this.CreatePrimitiveDotExpr(x,k),P.FLhs=N):P.FLhs=this.ConvertExpression(t.VariableName,s),P.FList=this.ConvertExpression(t.StartExpr,s);else if(C||S||T){if(N=this.CreateElement(Kt,t),P.FInit=N,T&&(k=t.StartExpr,D=null!==d&&12!==d.Kind?this.ConvertConstValue(d,s,k):this.ConvertExpression(t.StartExpr,s),D=this.CreateVarDecl$1(O,D,k),this.AddToVarStatement(N,D,k)),C&&(k=t.StartExpr,D=null!==p||2===t.LoopType?this.CreateLiteralNumber(k,F):l(t.StartExpr),D=this.CreateVarDecl$1(x,D,k),this.AddToVarStatement(N,D,k)),S){if(null===(k=t.EndExpr)&&(k=t.StartExpr),null!==f)D=this.CreateLiteralNumber(k,m);else if(2===t.LoopType){var G=y;1===G||2===G||3===G?D=this.CreateLiteralNumber(k,m):4===G?((D=this.CreateElement(vi,k)).FA=this.CreatePrimitiveDotExpr(O+".length",k),D.FB=this.CreateLiteralNumber(k,1)):5===G||6===G?((L=this.CreateCallExpression(k)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(7),k),L.AddArg(this.CreatePrimitiveDotExpr(O,k)),(D=this.CreateElement(vi,k)).FA=L,D.FB=this.CreateLiteralNumber(k,1)):this.RaiseNotSupported(t.StartExpr,s,20171113015445,"")}else D=l(t.EndExpr);D=this.CreateVarDecl$1(b,D,k),this.AddToVarStatement(N,D,k)}}else R=this.CreateElement(_t,t.VariableName),P.FInit=R,R.FLHS=this.ConvertExpression(t.VariableName,s),R.FExpr=null!==p?this.CreateLiteralNumber(t.StartExpr,F):this.ConvertExpression(t.StartExpr,s),k=t.StartExpr;if(P.$class.ClassType()===ys&&(null!==t.EndExpr&&(k=t.EndExpr),A=t.Down()?this.CreateElement(Ai,k):this.CreateElement(Ni,k),P.FCond=A,A.FA=C?this.CreatePrimitiveDotExpr(x,k):this.ConvertExpression(t.VariableName,s),A.FB=S?this.CreatePrimitiveDotExpr(b,k):this.CreateLiteralNumber(k,m),v=t.Down()?this.CreateElement(xi,k):this.CreateElement(bi,k),P.FIncr=v,v.FA=C?this.CreatePrimitiveDotExpr(x,k):this.ConvertExpression(t.VariableName,s)),C&&(null===(k=t.Body)&&(k=t),k=t.VariableName,R=this.CreateElement(_t,k),P.FBody=R,R.FLHS=this.ConvertExpression(t.VariableName,s),R.FExpr=this.CreatePrimitiveDotExpr(x,k),null!==n))if(0!==y){var w=y;1===w||7===w?P.$class.ClassType()===gs&&(R.FExpr=this.CreateUnaryPlus(R.FExpr,k)):2===w||8===w?R.FExpr=E(R.FExpr,k):3===w||9===w?R.FExpr=this.CreateCallFromCharCode(R.FExpr,k):4===w?((L=this.CreateCallExpression(k)).FExpr=this.CreateDotNameExpr(k,this.CreatePrimitiveDotExpr(O,t.StartExpr),"charAt"),L.AddArg(R.FExpr),R.FExpr=L):5===w||6===w?((B=this.CreateElement(os,k)).FMExpr=this.CreatePrimitiveDotExpr(O,t.StartExpr),B.FName=R.FExpr,R.FExpr=B,6===y&&((L=this.CreateCallExpression(k)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(51)]),L.AddArg(this.ConvertExpression(t.VariableName,s)),L.AddArg(B),R.FExpr=L,null===u.IdentEl&&this.RaiseNotSupported(t.VariableName,s,20250625190022,"for-in variable"),h.Add_InterfaceRelease(u.IdentEl))):this.RaiseNotSupported(t.StartExpr,s,20171113002550,"")}else u.BaseType in U.btAllChars||37===u.BaseType&&u.SubType in U.btAllChars?R.FExpr=this.CreateCallFromCharCode(R.FExpr,k):(u.BaseType in e.btAllJSBooleans||37===u.BaseType&&u.SubType in e.btAllJSBooleans)&&(R.FExpr=E(R.FExpr,k));null!==t.Body&&(D=this.ConvertElement(t.Body,s),null===P.FBody?P.FBody=D:((I=this.CreateElement(Ht,t.Body)).FA=P.FBody,I.FB=D,P.FBody=I)),r=$}finally{nt({get:function(){return p},set:function(e){p=e}}),nt({get:function(){return f},set:function(e){f=e}}),nt({get:function(){return d},set:function(e){d=e}}),null===r&&($=rtl.freeLoc($))}return r},this.ConvertFinalizationSection=function(e,t){return this.RaiseNotSupported(e,t,20161024192519,""),null},this.ConvertInitializationSection=function(e,t){var s=this,i=null,r=null,n=null,a=null;function o(){var e=null,i=null;return null===(e=(i=r.FFuncDef).FBody)&&(e=s.CreateElement(Rs,a),i.FBody=e),null===n&&(n=v.$create("Create$1",[a,e,t])),e}var h,u,c,p="",f="",d=!1,F=null,m=null,C=null,S=0,T=0,y=null,g=null;i=null,null!==(u=e.InitializationSection)?(a=u,C=u.FData):(a=e,C=null),e.$class.ClassType()===et?(d=!0,p=this.GetBIName(67)):e.$class.ClassType()===tt?(d=!0,p=this.GetBIName(62)):(d=!1,p=this.GetBIName(117)),h=d&&7 in this.FOptions,c=rtl.as(t.GetRootContext(),I),n=null,F=this.CreateElement(_t,a);try{F.FLHS=this.CreateMemberExpression([this.GetBIName(136),p]),r=this.CreateFunctionSt(a,!1,!1),F.FExpr=r,m=r.FFuncDef.FBody,null!==u&&(null!==(g=C.ImplJS)?""!==(f=Oi(g.BodyJS))&&(m=o(),Ie.UnmangleSourceLineNumber(e.SourceLinenumber,{get:function(){return S},set:function(e){S=e}},{get:function(){return T},set:function(e){T=e}}),(y=es.$create("Create$1",[S,T,e.SourceFilename])).FValue.FCustomValue=kt(f),m.FA=y,10 in this.FOptions&&this.CreateGlobalAlias_List(g.ShortRefs,t)):(6 in this.FOptions&&null!==t.Resolver&&(g=l.$create("Create"),C.ImplJS=g),u.Elements.FCount>0?((m=o()).FA=this.ConvertImplBlockElements(u,n,!1),n.BodySt=m.FA,this.AddInterfaceReleases(n,a),m.FA=n.BodySt,null!==g&&(g.BodyJS=Oi(this.CreatePrecompiledJS(m.FA)),g.EmptyJS=""===g.BodyJS)):null!==g&&(g.EmptyJS=!0))),rtl.length(c.GlobalClassMethods)>0&&(m=o(),this.AddClassConstructors(n,e),m.FA=n.BodySt),h&&(m=o(),this.AddRTLVersionCheck(n,e),m.FA=n.BodySt),i=F}finally{n=rtl.freeLoc(n),null===i&&(F=rtl.freeLoc(F))}return i},this.ConvertSimpleStatement=function(e,t){var s,i=null,r=null;return null===(r=this.ConvertExpression(e.Expr,t))?null:((s=r.$class.ClassType())===ki||s===Ht?i=r:(i=this.CreateElement(ki,e)).FA=r,i)},this.ConvertWithStatement=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=null,o=Ue.$new(),h=null,u=null,c=null,p=null,f=null,F=0,m=!1,C=null,S=null,T=null,y=null;if(s=null,null!==(i=t.Resolver)){null===(r=t.GetContextOfType(v))&&this.RaiseInconsistency(20170212003759,e),S=null,T=null;try{n=rtl.as(e.FData,$i);for(var g=0,E=e.Expressions.FCount-1;g<=E;g++)F=g,a=rtl.getObject(e.Expressions.Get(F)),i.ComputeElement(a,o,{},null),Oe.isPrototypeOf(o.IdentEl)&&(y=o.LoTypeEl).$class.ClassType()!==Ae&&y.$class.ClassType()!==Me&&y.$class.ClassType()!==st||(c=this.ConvertExpression(a,t),l=rtl.as(n.ExpressionScopes.GetItem(F),d),Vt.isPrototypeOf(c)&&Di(c.FName,!1)?(l.WithVarName=c.FName,c=rtl.freeLoc(c)):Li.isPrototypeOf(c)?(l.WithVarName="this",c=rtl.freeLoc(c)):(l.WithVarName=r.AddLocalJSVar(this.GetBIName(169),!0).Name,C=this.CreateVarStatement(l.WithVarName,c,a),this.AddToStatementList({get:function(){return S},set:function(e){S=e}},{get:function(){return T},set:function(e){T=e}},C,a)));null!=e.Body&&(h=this.ConvertElement(e.Body,t),this.AddToStatementList({get:function(){return S},set:function(e){S=e}},{get:function(){return T},set:function(e){T=e}},h,e.Body)),s=S}finally{null===s&&j({get:function(){return S},set:function(e){S=e}})}}else{p=null,h=null!=e.Body?this.ConvertElement(e.Body,t):this.CreateElement(bs,e),m=!1;try{for(var P=0,I=e.Expressions.FCount-1;P<=I;P++)F=P,a=rtl.getObject(e.Expressions.Get(F)),u=this.ConvertExpression(a,t),f=this.CreateElement(Bi,a),null==s&&(s=f),null!=p&&(p.FB=f),(p=f).FA=u;m=!0}finally{m||(j({get:function(){return u},set:function(e){u=e}}),j({get:function(){return s},set:function(e){s=e}}))}p.FB=h}return s},this.ConvertTryStatement=function(e,t){var s=null,i=null,r=null,n=0,l=null,a=null,o=null;s=null,i=null;try{if(Mi.isPrototypeOf(e.FinallyExcept))(i=this.CreateElement($s,e)).FBlock=this.ConvertImplBlockElements(e,t,!0),i.FBFinally=this.ConvertImplBlockElements(e.FinallyExcept,t,!0);else if((i=this.CreateElement(Gi,e)).FBlock=this.ConvertImplBlockElements(e,t,!0),i.FIdent=this.GetBIName(118),(r=e.FinallyExcept).Elements.FCount>0&&ut.isPrototypeOf(rtl.getObject(r.Elements.Get(0)))){o=null;for(var h=0,u=r.Elements.FCount-1;h<=u;h++)n=h,l=rtl.as(rtl.getObject(r.Elements.Get(n)),ut),a=rtl.as(this.ConvertExceptOn(l,t),Cs),null===o?i.FBCatch=a:o.FBFalse=a,o=a;null!==e.ElseBranch?o.FBFalse=this.ConvertImplBlockElements(e.ElseBranch,t,!0):(o.FBFalse=this.CreateElement(yi,e),o.FBFalse.FA=this.CreatePrimitiveDotExpr(this.GetBIName(118),e))}else null!==e.ElseBranch&&this.RaiseNotSupported(e.ElseBranch,t,20170205003014,""),i.FBCatch=this.ConvertImplBlockElements(r,t,!0);s=i}finally{null===s&&(i=rtl.freeLoc(i))}return s},this.ConvertExceptOn=function(e,t){var s,i,r=null,n=null,l=null,a=null,o=null,h=null,u=null;r=null,s=t.Resolver.ResolveAliasType(e.TypeEl,!0),i=Ae.isPrototypeOf(s)&&s.IsExternal,n=this.CreateElement(Cs,e);try{i?((h=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(57)]),h.AddArg(this.CreatePrimitiveDotExpr(this.GetBIName(118),e)),h.AddArg(this.CreateReferencePathExpr(e.TypeEl,t,!1,null))):((o=this.CreateElement(wt,e)).FMExpr=this.CreateReferencePathExpr(e.TypeEl,t,!1,null),o.FName="isPrototypeOf",(h=this.CreateCallExpression(e)).FExpr=o,h.AddArg(this.CreatePrimitiveDotExpr(this.GetBIName(118),e))),n.FCond=h,null!==e.VarEl?(l=this.CreateElement(Ht,e.Body),a=l,n.FBTrue=l,u=this.CreateVarStatement(this.TransformElToJSName(e.VarEl,t),this.CreatePrimitiveDotExpr(this.GetBIName(118),e),e),l.FA=u,null!==e.Body&&this.AddToStatementList({get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}},this.ConvertElement(e.Body,t),e)):null!==e.Body&&(n.FBTrue=this.ConvertElement(e.Body,t)),r=n}finally{null===r&&(n=rtl.freeLoc(n))}return r},this.ConvertCaseOfStatement=function(e,t){var s=null,i=null,r=!1,n=!1,l=0,a=0,o=null,h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=Ue.$new(),P=null;if(n=!1,null!==(g=t.Resolver)&&(g.ComputeElement(e.CaseExpr,E,{},null),E.BaseType in U.btAllStrings&&(n=!0)),this.GetUseSwitchStatement()){r=!0;for(var I=0,R=e.Elements.FCount-1;I<=R;I++)if(l=I,s=rtl.getObject(e.Elements.Get(l)),Jt.isPrototypeOf(s)){for(var v=0,A=(i=s).Expressions.FCount-1;v<=A;v++)if(a=v,u=rtl.getObject(i.Expressions.Get(a)),Je.isPrototypeOf(u)&&7===u.Kind){r=!1;break}if(!r)break}if(r)return this.CreateSwitchStatement(e,t)}h=this.CreateElement(Ht,e),r=!1;try{null===(P=t.GetFunctionContext())&&this.RaiseNotSupported(e,t,20200608132048,""),f=P.AddLocalVar("$tmp",e.CaseExpr,0,!0),F=this.CreateElement(Kt,e.CaseExpr),h.FA=F,d=this.CreateElement(ms,e.CaseExpr),F.FA=d,d.FName=f.Name,d.FInit=this.ConvertExpression(e.CaseExpr,t),p=null;for(var N=0,x=e.Elements.FCount-1;N<=x;N++)if(l=N,s=rtl.getObject(e.Elements.Get(l)),Jt.isPrototypeOf(s)){i=s,c=this.CreateElement(Cs,s),null===p?h.FB=c:p.FBFalse=c,p=c;for(var b=0,O=i.Expressions.FCount-1;b<=O;b++)a=b,u=rtl.getObject(i.Expressions.Get(a)),Je.isPrototypeOf(u)&&7===u.Kind?(o=C=this.CreateElement(Ks,u),T=this.CreateElement(Ai,u),C.FA=T,T.FA=this.CreatePrimitiveDotExpr(f.Name,e.CaseExpr),T.FB=this.ConvertExpression(u.Left,t),S=this.CreateElement(Ni,u),C.FB=S,S.FA=this.CreatePrimitiveDotExpr(f.Name,e.CaseExpr),S.FB=this.ConvertExpression(u.Right,t),n&&((y=this.CreateElement(Xs,u)).FA=this.CreateDotNameExpr(u,this.CreatePrimitiveDotExpr(f.Name,e.CaseExpr),"length"),y.FB=this.CreateLiteralNumber(u,1),(C=this.CreateElement(Ks,u)).FA=y,C.FB=o,o=C)):(o=y=this.CreateElement(Xs,u),y.FA=this.CreatePrimitiveDotExpr(f.Name,e.CaseExpr),y.FB=this.ConvertExpression(u,t)),null===c.FCond?c.FCond=o:((m=this.CreateElement(wi,i)).FA=c.FCond,m.FB=o,c.FCond=m);null!==i.Body?c.FBTrue=this.ConvertElement(i.Body,t):c.FBTrue=this.CreateElement(Vi,i)}else Ui.isPrototypeOf(s)?(null===p&&this.RaiseNotSupported(s,t,20161128120802,"case-of needs at least one case"),p.FBFalse=this.ConvertImplBlockElements(e.ElseBranch,t,!0)):this.RaiseNotSupported(s,t,20161128113055,"");r=!0}finally{r||(h=rtl.freeLoc(h))}return h},this.ConvertAsmStatement=function(e,t){var s=null,i="",r=null,n=null,l=0,a=0,o=0,h=null;if(n=e.FTokens,""!==(i=yt(n.GetTextStr()))&&";"===i.charAt(i.length-1)&&Ji({get:function(){return i},set:function(e){i=e}},i.length,1),""===i)s=this.CreateElement(Vi,e);else{for(o=0;o<n.GetCount()&&""===yt(n.Get(o));)o+=1;Ie.UnmangleSourceLineNumber(e.SourceLinenumber,{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}}),o>0&&(a=1),(r=es.$create("Create$1",[l+o,a,e.SourceFilename])).FValue.FCustomValue=i,s=r,ts(";",i)>0&&((h=Ht.$create("Create$1",[r.FLine,r.FColumn,r.FSource])).FA=r,s=h)}return s},this.ConvertConstValue=function(e,t,s){var i=null,r=[],n=ji.$new(),l=null,a=0;i=null,null===e&&this.RaiseNotSupported(s,t,20170910211948,"");var o=e.Kind;if(2===o)i=this.CreateLiteralNull(s);else if(3===o)i=this.CreateLiteralBoolean(s,e.B);else if(4===o)i=this.CreateLiteralNumber(s,e.Int);else if(5===o)i=this.CreateLiteralNumber(s,e.UInt);else if(6===o)i=this.CreateLiteralFloat(s,e.FloatValue);else if(8===o)i=this.CreateLiteralJSString(s,e.S);else if(9===o)i=this.CreateReferencePathExpr(e.GetEnumValue(),t,!1,null);else if(12===o)if(He.isPrototypeOf(e.IdentEl))i=this.ConvertExpression(e.IdentEl,t);else{l=this.CreateCallExpression(s);try{l.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(102)]),r=e.Ranges;for(var h=0,u=rtl.length(r)-1;h<=u;h++)a=h,n.$assign(r[a]),n.RangeStart===n.RangeEnd?l.AddArg(this.CreateLiteralNumber(s,n.RangeStart)):(l.AddArg(this.CreateLiteralNull(s)),l.AddArg(this.CreateLiteralNumber(s,n.RangeStart)),l.AddArg(this.CreateLiteralNumber(s,n.RangeEnd)));i=l}finally{null===i&&(l=rtl.freeLoc(l))}}else this.RaiseNotSupported(s,t,20170910211951,"");return i},this.ConvertArrayValues=function(e,t){var s=null,i=0;s=this.CreateElement(fs,e);for(var r=0,n=rtl.length(e.Values)-1;r<=n;r++)i=r,s.AddElement(this.ConvertExpression(e.Values[i],t));return s},this.ConvertInheritedExpr=function(t,s){var i=this,r=null;function n(r,n,l,a){var o,h,u=null,c="",p=null,f=null,d=null,F=null;u=null,null===(h=s.GetSelfContext())&&i.RaiseInconsistency(20170418114702,t),o=i.GetLocalName(h.ThisVar.Element,rtl.createSet(2,3),s),n&&h!==s&&i.DoError$2(20170418204325,4022,rtl.getResStr(e,"sNestedInheritedNeedsParameters"),[],t),p=null;try{if(p=i.CreateCallExpression(r),Ae.isPrototypeOf(l.FParent)&&l.FParent.IsExternal){if(null===(F=rtl.as(h.ThisVar.Element,Ae)).FData&&i.RaiseInconsistency(20170323111252,F),null===(f=F.FData.AncestorScope)&&i.RaiseInconsistency(20170323111306,F),d=rtl.as(f.FElement,Ae),l.$class.ClassType()===Ft&&lt(l.FName,"new")&&s.Resolver.IsExternalClass_Name(l.FParent,"Function"))return c="this."+i.GetBIName(23),p.FExpr=i.CreatePrimitiveDotExpr(c,r),i.CreateProcedureCall({get:function(){return p},set:function(e){p=e}},a,l.ProcType,s),u=p;c=i.CreateReferencePath(d,s,2,!0,null)+"."+i.TransformElToJSName(l,s)}else c=i.CreateReferencePath(l,s,2,!0,null);0===l.ProcType.Args.FCount&&(n=!1),c+=n&&h===s?".apply":".call",p.FExpr=i.CreatePrimitiveDotExpr(c,r),p.AddArg(i.CreatePrimitiveDotExpr(o,r)),n?p.AddArg(i.CreatePrimitiveDotExpr("arguments",r)):i.CreateProcedureCall({get:function(){return p},set:function(e){p=e}},a,l.ProcType,s),qe.isPrototypeOf(l)&&!l.IsAsync()&&s.Resolver.IsManagedJSType(l.GetFT().ResultEl.ResultType)&&(p=i.CreateIntfRef(p,s,t)),u=p}finally{null===u&&(p=rtl.freeLoc(p))}return u}var l=null,a=null,o=null,h=null,u=null;if(r=null,Je.isPrototypeOf(t.FParent)&&0===t.FParent.OpCode&&t.FParent.Left===t){if(h=null,u=null,(l=t.FParent.Right).$class.ClassType()===_e){if(o=l,!(1 in(a=rtl.as(o.FData,ve)).Flags))return r=this.ConvertPrimitiveExpression(o,s);h=rtl.as(a.FDeclaration,Se)}else if(l.$class.ClassType()===je){if(10!==(u=l).Kind)return r=this.ConvertExpression(l,s);_e.isPrototypeOf(u.Value)?(o=u.Value,a=rtl.as(o.FData,ve),h=rtl.as(a.FDeclaration,Se)):this.DoError$2(20170418205802,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"inherited name()",18,u.Value.ElementTypeName()),u.Value)}else this.DoError$2(20170418205955,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"inherited name()",18,l.ElementTypeName()),l);null===h&&this.RaiseNotSupported(t,s,20170201190824,""),r=n(l,!1,h,u)}else{if(null===t.FData)return r;a=t.FData,h=rtl.as(a.FDeclaration,Se),r=n(t,!0,h,null)}return r},this.ConvertNilExpr=function(e,t){return this.CreateLiteralNull(e)},this.ConvertCharToInt=function(e,t,s){var i=null;return es.isPrototypeOf(e)&&4===e.FValue.FValueType?(this.ConvertCharLiteralToInt(e,t,s),i=e):i=this.CreateCallCharCodeAt(e,0,t),i},this.ConvertIntToInt=function(e,t,s,i,r){var n=null,l=null,a=0,o=0,h=null,u=null;if(n=e,l=r.Resolver,14===t?14!==s&&(n=this.CreateTruncFloor(i,this.CreateDivideNumber(i,n,1e4),!0)):14===s&&(n=this.CreateMulNumber(i,n,1e4)),28!==s&&!es.isPrototypeOf(n))if(15 in r.ScannerBoolSwitches)l.GetIntegerRange(s,{get:function(){return a},set:function(e){a=e}},{get:function(){return o},set:function(e){o=e}})||this.RaiseNotSupported(i,r,20180425131839,""),(h=this.CreateCallExpression(i)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(72),i),h.AddArg(n),n=h,h.AddArg(this.CreateLiteralNumber(i,a)),h.AddArg(this.CreateLiteralNumber(i,o));else{var c=s;19===c?19!==t&&(n=this.CreateBitWiseAnd(i,n,255,0)):20===c?20!==t&&(n=this.CreateBitWiseAnd(i,n,255,24)):21===c?t in rtl.createSet(19,21)||(n=this.CreateBitWiseAnd(i,n,65535,0)):22===c?t in rtl.createSet(20,22)||(n=this.CreateBitWiseAnd(i,n,65535,16)):25===c?t in rtl.createSet(19,21,25,23)||((u=this.CreateElement(Hi,i)).FA=n,u.FB=this.CreateLiteralNumber(i,0),n=u):26===c&&(t in rtl.createSet(20,22,26,24)||(n=this.CreateBitWiseAnd(i,n,4294967295,0)))}return n},this.CreateBitWiseAnd=function(e,t,s,i){var r=null,n=null,l="",a=0,o=null;if(r=n=this.CreateElement(Wi,e),n.FA=t,n.FB=this.CreateLiteralNumber(e,s),s>999999){for(l=rtl.hexStr(s,8),a=1;a<8&&"0"===l.charAt(a-1);)a+=1;l=ue(l,a,8),n.FB.FValue.FCustomValue="0x"+l}return i>0&&((o=this.CreateElement(Yi,e)).FA=r,r=o,o.FB=this.CreateLiteralNumber(e,i),(o=this.CreateElement(zi,e)).FA=r,r=o,o.FB=this.CreateLiteralNumber(e,i)),r},this.CreateBitWiseLongword=function(e,t){var s=null;return(s=this.CreateCallExpression(e)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(15),e),s.AddArg(t),s},this.ConvertParamsExpr=function(e,t){var s=null;s=null;var i=e.Kind;return 10===i?s=this.ConvertFuncParams(e,t):11===i?s=this.ConvertArrayParams(e,t):4===i?s=this.ConvertArrayOrSetLiteral(e,t):this.RaiseNotSupported(e,t,20170209103235,M.ExprKindNames[e.Kind]),s},this.ConvertArrayParams=function(s,i){var r=this,n=null,l=null;function a(e,t){r.DoError$2(e,3084,rtl.getResStr(Ee,"sIllegalQualifierAfter"),pe(9,"[",18,i.Resolver.GetResolverResultDescription(t,!0)),s)}function o(){var e=null;return(e=s.Value).$class.ClassType()===_e&&ve.isPrototypeOf(e.FData)?e.FData:null}function h(e){var t=null,s=!1,i=null,n=null;return t=r.ConvertExpression(e,l),s=!0,es.isPrototypeOf(t)&&3===(i=t.FValue).FValueType&&(i.SetAsNumber(i.GetAsNumber()-1),s=!1),s&&((n=r.CreateElement(vi,e)).FA=t,n.FB=r.CreateLiteralNumber(e,1),t=n),t}function u(e,t,i,a){var o=null,h=0,u=null,c=null,p="";if(!i.Resolver.IsExternalBracketAccessor(t))return!1;1!==i.Resolver.GetPasPropertyArgs(e).FCount&&r.RaiseInconsistency(20170403003753,e),o=r.CreateElement(os,s.Params[0]);try{u=s.Value,a&&(_e.isPrototypeOf(u)&&0===u.Kind&&ve.isPrototypeOf(u.FData)?(c=u.FData,""!==(p=r.CreateReferencePath(e,i,0,!1,c))&&(o.FMExpr=r.CreatePrimitiveDotExpr(p,u)),u=null):Je.isPrototypeOf(u)&&27===u.OpCode&&_e.isPrototypeOf(u.Right)&&0===u.Right.Kind?u=u.Left:r.RaiseNotSupported(s.Value,i,20170402225050,"")),null!==u&&null===o.FMExpr&&(h=i.Access,i.Access=0,o.FMExpr=r.ConvertExpression(u,i),i.Access=h),h=l.Access,l.Access=0,o.FName=r.ConvertExpression(s.Params[0],l),l.Access=h,n=o,o=null}finally{o=rtl.freeLoc(o)}return true}function c(e,t,i){var a=null,h=0,c=null,p=null,f=null,d=null,F=null,m=0,C=null,S=null,T=null,y=null,g=null,E=null,P=D.$new();n=null,F=null,y=t.Resolver,a=null;try{var I=t.Access;if(1===I?d=y.GetPasPropertySetter(e):0===I?d=y.GetPasPropertyGetter(e):r.RaiseNotSupported(s,t,20170213213317,""),u(e,d,t,!0))return;for(a=y.IsHelperMethod(d)?i?r.CreateCallHelperMethod(d,s.Value,t,!1):r.CreateCallHelperMethod(d,s,t,!1):r.CreateCallExpression(s),1===t.Access&&((F=rtl.as(t.AccessContext,O)).PropertyEl=e,F.Call=a),i&&null===a.FExpr&&(y.IsNameExpr(s.Value)||(Je.isPrototypeOf(s.Value)?(27!==(E=s.Value).OpCode&&r.RaiseNotSupported(s,t,20190116100510,""),P.El=d,P.Full=!1,P.Ref=o(),a.FExpr=r.ConvertSubIdentExprCustom(E,t,rtl.createCallback(r,"OnCreateReferencePathExpr"),P)):r.RaiseNotSupported(s,t,20190116100431,""))),null===a.FExpr&&(a.FExpr=r.CreateReferencePathExpr(d,t,!1,o())),p=a.FArgs.FElements,m=l.Access,T=y.GetPasPropertyArgs(e),h=0;h<T.FCount;)c=rtl.getObject(T.Get(h)),f=r.CreateProcCallArg(s.Params[h],c,l),p.AddElement().FExpr=f,h+=1;for(;h<T.FCount;)null===(c=rtl.getObject(T.Get(h))).ValueExpr&&r.RaiseInconsistency(20170206185126,c),t.Access=0,f=r.ConvertExpression(c.ValueExpr,l),p.AddElement().FExpr=f,h+=1;if(null!==(C=y.GetPasPropertyIndex(e))){S=y.Eval(C,rtl.createSet(0),!0);try{p.AddElement().FExpr=r.ConvertConstValue(S,l,s)}finally{nt({get:function(){return S},set:function(e){S=e}})}}null!==F&&(p.AddElement().FExpr=F.RightSide,F.RightSide=null),l.Access=m,0===t.Access&&(g=y.GetPasPropertyType(e),y.IsManagedJSType(g)&&(a=r.CreateIntfRef(a,t,s))),n=a}finally{null===n&&(null!==F&&F.Call===a&&(F.Call=null),a=rtl.freeLoc(a))}}var p=Ue.$new(),f=null,d=null,F=0,m=null,C=null;if(11!==s.Kind&&this.RaiseInconsistency(20170209113713,s),l=i.GetNonDotContext(),null===(m=i.Resolver)){rtl.length(s.Params)>1&&this.RaiseNotSupported(s,i,20170207151325,"Cannot convert 2-dim arrays"),d=this.CreateElement(os,s);try{F=i.Access,i.Access=0,d.FMExpr=this.ConvertExpression(s.Value,i),F=l.Access,l.Access=0,d.FName=this.ConvertExpression(s.Params[0],l),l.Access=F,n=d}finally{null===n&&(d=rtl.freeLoc(d))}return n}return m.ComputeElement(s.Value,p,{},null),ve.isPrototypeOf(s.FData)&&(C=s.FData,xe.isPrototypeOf(C.FDeclaration))?(function(e,t){var l=null,a=null,o=null,h=0,p=null,f=null,d=null;d=i.Resolver;var F=i.Access;if(1===F){if(u(t,p=d.GetPasPropertySetter(t),i,!1))return}else if(0===F){if(u(t,p=d.GetPasPropertyGetter(t),i,!1))return}else if(2===F){if(p=d.GetPasPropertyGetter(t),f=d.GetPasPropertySetter(t),d.IsExternalBracketAccessor(p)&&d.IsExternalBracketAccessor(f))return void(u(t,p,i,!1)||r.RaiseNotSupported(s,i,20170405090845,""));r.RaiseNotSupported(s,i,20170403000550,"")}else r.RaiseNotSupported(s,i,20170402233834,"");if(d.IsHelperMethod(p))c(t,i,!1);else{l=null,a=null,o=null;try{h=i.Access,i.Access=0,a=r.ConvertExpression(s.Value,i),i.Access=h,(l=b.$create("Create$1",[s.Value,a,i])).LeftResolved.$assign(e),c(t,l,!1),null!==l.JS&&r.RaiseNotSupported(s,i,20180509134226,Ge(l.JS)),o=n,n=null}finally{l=rtl.freeLoc(l),null===o&&(a=rtl.freeLoc(a))}n=r.CreateDotExpression(s,a,o,!0)}}(p,C.FDeclaration),n):(p.BaseType in e.btAllJSStrings?function(e){var l,a,o=null,u=null,c=null,p=null,f=null,d=0,F=null,m=null;n=null,a=15 in i.ScannerBoolSwitches&&i.Access in rtl.createSet(0,1),l=s.Params[0];var C=i.Access;if(1===C){null===(p=rtl.as(i.AccessContext,O)).RightSide&&r.RaiseInconsistency(20180123192020,s),f=null,u=null,o=null;try{(o=r.CreateCallExpression(s)).FExpr=a?r.CreateMemberExpression([r.GetBIName(144),r.GetBIName(74)]):r.CreateMemberExpression([r.GetBIName(144),r.GetBIName(100)]),d=i.Access,i.Access=0,o.AddArg(r.ConvertExpression(s.Value,i)),o.AddArg(h(l)),i.Access=d,o.AddArg(p.RightSide),p.RightSide=null,Ye.isPrototypeOf(e.IdentEl)?(m=e.IdentEl).Access in rtl.createSet(2,3)&&((u=r.CreateCallExpression(s.Value)).FExpr=r.CreateMemberExpression([r.TransformArgName(m,i),t.TempRefObjSetterName]),u.AddArg(o),p.Call=o,o=null,n=u):xe.isPrototypeOf(e.IdentEl)&&r.RaiseNotSupported(s,i,20180124115924,""),null===n&&((f=r.CreateElement(_t,s)).FExpr=o,p.Call=o,o=null,d=i.Access,i.Access=0,f.FLHS=r.ConvertExpression(s.Value,i),n=f)}finally{null===n&&(o=rtl.freeLoc(o),u=rtl.freeLoc(u),f=rtl.freeLoc(f))}}else if(0===C){o=r.CreateCallExpression(s);try{a&&!Je.IsRightSubIdent(s)?(o.FExpr=r.CreatePrimitiveDotExpr(r.GetBIName(144)+"."+r.GetBIName(73),s),o.AddArg(r.ConvertExpression(s.Value,i))):(c=r.CreateElement(wt,s),o.FExpr=c,c.FMExpr=r.ConvertExpression(s.Value,i),c.FName="charAt"),F=h(l),o.AddArg(F),n=o}finally{null===n&&(o=rtl.freeLoc(o))}}else r.RaiseNotSupported(s,i,20170213213101,"")}(p):xe.isPrototypeOf(p.IdentEl)&&m.GetPasPropertyArgs(p.IdentEl).FCount>0?c(p.IdentEl,i,!0):2===p.BaseType?(f=p.LoTypeEl).$class.ClassType()===ft?function(e){var t=null,a=null,o=0,h=0,u=null,c=null,p=0,f=[],d=0,F=null,m=null,C=null,S=!1,T=!1,y=!1,g=null,E=null,P=null,I=null,R=!1;n=null,u=null,c=null,I=_.$create("Create"),y=!1,T=!1;try{p=i.Access,i.Access=0,c=r.ConvertExpression(s.Value,i),i.Access=p,h=0;do{f=e.Ranges;for(var v=1,A=Math.max(rtl.length(f),1);v<=A;v++){if(o=v,F=s.Params[h],l.Access=0,u=r.ConvertExpression(F,l),l.Access=p,es.isPrototypeOf(u)||(y=!0),o<=rtl.length(f)){null===(C=l.Resolver.EvalRangeLimit(f[o-1],rtl.createSet(0),!0,s))&&r.RaiseNotSupported(F,l,20170910163341,"");try{d=0;var N=C.Kind;3===N?!1===C.B?es.isPrototypeOf(u)&&2===u.FValue.FValueType?u.FValue.GetAsBoolean()?u.FValue.SetAsNumber(1):u.FValue.SetAsNumber(0):u=r.CreateUnaryPlus(u,F):es.isPrototypeOf(u)&&2===u.FValue.FValueType?u.FValue.GetAsBoolean()?u.FValue.SetAsNumber(0):l.Resolver.fExprEvaluator.EmitRangeCheckConst(20170910203312,"false","true","true",F,1):((m=r.CreateElement(vi,F)).FA=r.CreateLiteralNumber(F,1),m.FB=u,u=m):9===N?d=C.Index:4===N?d=C.Int:8===N?(1!==C.S.length?l.Resolver.RaiseXExpectedButYFound(20170910213247,"char","string",F):d=C.S.charCodeAt(0),u=r.ConvertCharToInt(u,F,l)):r.RaiseNotSupported(F,l,20170910170446,""),0!==d&&(es.isPrototypeOf(u)&&3===u.FValue.FValueType?u.FValue.SetAsNumber(u.FValue.GetAsNumber()-d):d>0?((m=r.CreateElement(vi,F)).FA=u,m.FB=r.CreateLiteralNumber(F,d),u=m):((m=r.CreateElement(_i,F)).FA=u,m.FB=r.CreateLiteralNumber(F,-d),u=m))}finally{nt({get:function(){return C},set:function(e){C=e}})}}I.Add(u),u=null,(h+=1)>rtl.length(s.Params)&&r.RaiseInconsistency(20170206180553,s)}if(h===rtl.length(s.Params))break;e=rtl.as(i.Resolver.ResolveAliasType(e.ElType,!0),ft)}while(null!==e);if(S=y&&15 in i.ScannerBoolSwitches&&i.Access in rtl.createSet(0,1),P=null,R=!1,1===i.Access&&(null!==(P=rtl.as(i.AccessContext,O)).Call&&r.RaiseNotSupported(s,i,20180424192155,""),R=Me.isPrototypeOf(P.LeftResolved.LoTypeEl)),S&&!Je.IsRightSubIdent(s)){g=r.CreateCallExpression(s),n=g,0===i.Access||R?g.FExpr=r.CreatePrimitiveDotExpr(r.GetBIName(144)+"."+r.GetBIName(69),s):g.FExpr=r.CreatePrimitiveDotExpr(r.GetBIName(144)+"."+r.GetBIName(70),s),g.AddArg(c),c=null;for(var x=0,b=I.FCount-1;x<=b;x++)o=x,g.AddArg(rtl.getObject(I.Get(o)));I.Clear(),1===i.Access&&(R&&((E=r.CreateCallExpression(s)).FExpr=r.CreateDotNameExpr(s,g,r.GetBIName(75)),g=E),g.AddArg(P.RightSide),P.RightSide=null,P.Call=g,n=g)}else{(t=r.CreateElement(os,s)).FMExpr=c,c=null;for(var k=0,$=I.FCount-1;k<=$;k++)o=k,null!==t.FName&&(a=t,(t=r.CreateElement(os,s)).FMExpr=a),t.FName=rtl.getObject(I.Get(o));n=t,I.Clear(),R&&((E=r.CreateCallExpression(s)).FExpr=r.CreateDotNameExpr(s,n,r.GetBIName(75)),n=E,E.AddArg(P.RightSide),P.RightSide=null,P.Call=E)}T=!0}finally{if(!T){c=rtl.freeLoc(c);for(var D=0,L=I.FCount-1;D<=L;D++)o=D,rtl.getObject(I.Get(o)).$destroy("Destroy");u=rtl.freeLoc(u),n=rtl.freeLoc(n)}I=rtl.freeLoc(I)}}(f):a(20170206181220,p):a(20170206180222,p),n)},this.ConvertFuncParams=function(e,t){var s=this,i=null,r=null,n=null,l=null,a=null;var o,h=null,u=null,c=null,p=null,f=null,d=Ue.$new(),F=Ue.$new(),C=Ue.$new(),S=null,T=null,y=null,g="",E="",P=null,I=null,R=!1,v=null,A=null,N=null,x=null;if(i=null,10!==e.Kind&&this.RaiseInconsistency(20170209113515,e),r=t.Resolver,l=null,a=null,f=null,n=null,T=e.Value,!ve.isPrototypeOf(T.FData)&&null!==r&&Je.isPrototypeOf(T)&&27===T.OpCode&&(T=(n=T).Right),!ve.isPrototypeOf(T.FData)&&null!==r&&si.isPrototypeOf(T)&&(T=T.NameExpr),ve.isPrototypeOf(T.FData)){if(h=(u=T.FData).FDeclaration,Oe.isPrototypeOf(h)&&(h=r.ResolveAliasType(h,!0)),(y=h.$class.ClassType())===it){if(Ti.isPrototypeOf(h.FData)){var O=(c=h.FData).BuiltIn;if(1===O)i=this.ConvertBuiltIn_Length(e,t);else if(2===O)i=this.ConvertBuiltIn_SetLength(e,t);else if(3===O)i=this.ConvertBuiltIn_ExcludeInclude(e,t,!0);else if(4===O)i=this.ConvertBuiltIn_ExcludeInclude(e,t,!1);else if(7===O)i=this.ConvertBuiltIn_Exit(e,t);else if(8===O||9===O)i=this.ConvertBuiltIn_IncDec(e,t);else if(10===O)i=this.ConvertBuiltIn_Assigned(e,t);else if(11===O)i=this.ConvertBuiltIn_Chr(e,t);else if(12===O)i=this.ConvertBuiltIn_Ord(e,t);else if(13===O)i=this.ConvertBuiltIn_LowHigh(e,t,!0);else if(14===O)i=this.ConvertBuiltIn_LowHigh(e,t,!1);else if(15===O)i=this.ConvertBuiltIn_PredSucc(e,t,!0);else if(16===O)i=this.ConvertBuiltIn_PredSucc(e,t,!1);else if(17===O)i=this.ConvertBuiltIn_StrProc(e,t);else if(18===O)i=this.ConvertBuiltIn_StrFunc(e,t);else if(19===O)i=this.ConvertBuiltIn_WriteStr(e,t);else if(20===O)i=this.ConvertBuiltIn_Val(e,t);else if(21===O)i=this.ConvertBuiltIn_LoHi(e,t,!0);else if(22===O)i=this.ConvertBuiltIn_LoHi(e,t,!1);else if(23===O)i=this.ConvertBuiltIn_ConcatArray(e,t);else if(24===O)i=this.ConvertBuiltIn_ConcatString(e,t);else if(25===O)i=this.ConvertBuiltIn_CopyArray(e,t);else if(26===O)i=this.ConvertBuiltIn_InsertArray(e,t);else if(27===O)i=this.ConvertBuiltIn_DeleteArray(e,t);else if(28===O)i=this.ConvertBuiltIn_TypeInfo(e,t);else if(29===O)i=this.ConvertBuiltIn_GetTypeKind(e,t);else if(30===O){if(null===(i=this.ConvertBuiltIn_Assert(e,t)))return i}else if(31===O)i=this.ConvertBuiltIn_New(e,t);else if(32===O){if(null===(i=this.ConvertBuiltIn_Dispose(e,t)))return i}else if(33===O)i=this.ConvertBuiltIn_Default(e,t);else if(0===O){var k=c.FElement.FName;"Debugger"===k?i=this.ConvertBuiltIn_Debugger(e,t):"AWait"===k?i=this.ConvertBuiltIn_AWait(e,t):this.RaiseNotSupported(e,t,20181126101801,"built in custom proc "+c.FElement.FName)}else this.RaiseNotSupported(e,t,20161130164955,"built in proc "+U.ResolverBuiltInProcNames[c.BuiltIn]);return null===i&&this.RaiseInconsistency(20170210121932,e),i}if(ne.isPrototypeOf(h.FData))return i=this.ConvertTypeCastToBaseType(e,t,h.FData);this.RaiseNotSupported(e,t,20170325160624,"")}else{if(r.IsExternalClassConstructor(h))return S=null!==n?n.Left:null,i=this.ConvertExternalConstructor(S,u,e,t);if(r.IsTObjectFreeMethod(T))return null!==n?i=this.ConvertTObjectFree_Bin(n,T,t):this.RaiseNotSupported(e,t,20190115215224,""),i;if(y.InheritsFrom(Se)){if(p=h,r.IsHelperMethod(p))return i=this.CreateCallHelperMethod(p,e.Value,t,!1);if(r.IsExternalBracketAccessor(p))return this.CreateExternalBracketAccessorCall(e,t);f=p.ProcType}else{if(y===Ae||y===Tt||y===Me||y===st||y===rt||y===ft||y===Qe){if(S=e.Params[0],r.ComputeElement(S,F,{},null),I=F.LoTypeEl,y===Me&&4===F.BaseType&&Ye.isPrototypeOf(F.IdentEl))return E=this.TransformArgName(F.IdentEl,t),i=this.CreatePrimitiveDotExpr(E,e);if(y===Ae)if(r.IsExternalClass_Name(h,"Function")){if(He.isPrototypeOf(S)&&24===S.OpCode&&(r.ComputeElement(S.Operand,C,rtl.createSet(1),null),31===C.BaseType&&Se.isPrototypeOf(C.IdentEl)))return i=this.CreateReferencePathExpr(C.IdentEl,t,!1,null)}else if(r.IsExternalClass_Name(h,"Array")&&(i=function(i,n){var l,a,o=null,h=0,u=null,c=null,p=null;if(o=null,!je.isPrototypeOf(i))return o;if(4!==(l=i).Kind)return o;if(null!==(a=r.IsArrayExpr(l)))return s.CreateArrayInit(a,i,i,t);if(35===n.BaseType){p=s.CreateElement(fs,i);try{for(var f=0,d=rtl.length(l.Params)-1;f<=d;f++)h=f,c=l.Params[h],u=s.ConvertExpression(c,t),p.AddElement(u);o=p}finally{null===o&&(p=rtl.freeLoc(p))}}else s.RaiseNotSupported(e,t,20220331114026,"");return o}(S,F),null!==i))return i;if(i=this.ConvertExpression(S,t),y===rt){v=r.EvalTypeRange(h,rtl.createSet(0)),A=null;try{if(null===v&&this.RaiseNotSupported(e,t,20180424124708,""),null===(A=r.EvalTypeRange(F.LoTypeEl,{}))&&this.RaiseNotSupported(e,t,20180424125331,""),10===v.Kind){var $=v.ElKind;if(1===$||2===$){var D=A.Kind;if(10===D){var L=A.ElKind;1===L||2===L||this.RaiseNotSupported(e,t,20180424130705,"")}else 11===D||this.RaiseNotSupported(e,t,20180424125608,"")}else this.RaiseNotSupported(e,t,20180424125419,"")}else this.RaiseNotSupported(e,t,20180424124814,"")}finally{nt({get:function(){return A},set:function(e){A=e}}),nt({get:function(){return v},set:function(e){v=e}})}}else if(y===Ae&&Ae.isPrototypeOf(I)){var B=h.ObjKind;if(1===B){var G=I.ObjKind;if(1===G);else if(2===G){if(!h.IsExternal)return(l=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(50)]),l.AddArg(i),i=l,l.AddArg(this.CreateReferencePathExpr(h,t,!1,null)),i}else this.RaiseNotSupported(e,t,20180327221211,M.ObjKindNames[I.ObjKind])}else if(2===B){var w=I.ObjKind;if(1===w){var V=h.InterfaceType;return 0===V?((l=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(55)]),l.AddArg(i),i=l,l.AddArg(this.CreateReferencePathExpr(h,t,!1,null)),i=this.CreateIntfRef(i,t,e)):1===V?((l=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(46)]),l.AddArg(i),i=l,l.AddArg(this.CreateReferencePathExpr(h,t,!1,null))):this.RaiseNotSupported(e,t,20180416102614,M.InterfaceTypeNames[h.InterfaceType]),i}2===w||this.RaiseNotSupported(e,t,20180327221233,M.ObjKindNames[I.ObjKind])}else this.RaiseNotSupported(e,t,20180327221130,M.ObjKindNames[h.ObjKind])}return 27 in t.ScannerBoolSwitches?y!==Ae&&y!==Tt||(P=y===Tt?rtl.as(r.ResolveAliasType(h.DestType,!0),Ae):h,g=this.CreateReferencePath(P,t,2,!1,null),(l=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(14)]),l.AddArg(i),l.AddArg(this.CreatePrimitiveDotExpr(g,T)),P.IsExternal||(y===Tt?l.AddArg(this.CreateLiteralNumber(T,2)):l.AddArg(this.CreateLiteralNumber(T,1))),i=l):1===F.BaseType&&m.isPrototypeOf(I.FData)&&1===I.FData.JSBaseType&&(y===Ae&&!h.IsExternal||y===Tt||y===Me)&&((l=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(32)]),l.AddArg(i),i=l),i}if(y.InheritsFrom(Be))r.ComputeElement(h,d,rtl.createSet(4),null),At.isPrototypeOf(d.LoTypeEl)?f=d.LoTypeEl:this.RaiseNotSupported(e,t,20170217115244,"");else if(y===Ye)r.ComputeElement(h,d,rtl.createSet(4),null),At.isPrototypeOf(d.LoTypeEl)?f=d.LoTypeEl:this.RaiseNotSupported(e,t,20170328224020,"");else if(y===At||y===Xe){if(r.ComputeElement(T,C,rtl.createSet(1),null),Oe.isPrototypeOf(C.IdentEl)&&At.isPrototypeOf(r.ResolveAliasType(C.IdentEl,!0)))return S=e.Params[0],i=this.ConvertExpression(S,t);f=h}else this.RaiseNotSupported(e,t,20170215114337,"")}}rtl.neSet(rtl.intersectSet(rtl.createSet(3,4),u.Flags),{})&&function(i){var o=null,h=Ue.$new(),u=0,c=null,p=null;if(null!==n){r.ComputeElement(n.Left,h,{},null),u=t.Access,t.Access=0,null===(c=s.ConvertExpression(n.Left,t))&&s.RaiseInconsistency(20190116132530,e),t.Access=u,p=b.$create("Create$1",[n,c,t]);try{p.LeftResolved.$assign(h),l=s.CreateFreeOrNewInstanceExpr(i,p),null!==p.JS&&s.RaiseNotSupported(e,t,20190116132748,"")}finally{p=rtl.freeLoc(p),null===l&&(c=rtl.freeLoc(c))}s.CreateDotExpression(n,c,l,!0)!==l&&s.RaiseNotSupported(e,t,20190116133841,"")}null===l&&(l=s.CreateFreeOrNewInstanceExpr(i,t)),3 in i.Flags&&i.FDeclaration.FParent.$class.ClassType()===Ae?(o=s.CreateElement(fs,e),l.AddArg(o),a=o.FElements):a=l.FArgs.FElements}(u)}R=!1,Xe.isPrototypeOf(f)&&null!==r&&r.IsManagedJSType(f.ResultEl.ResultType)&&!f.GetIsAsync()&&(R=!0),null===l&&(l=this.CreateCallExpression(e),a=l.FArgs.FElements),o=t.Access;try{t.Access=0,null===l.FArgs?(l.FArgs=this.CreateElement(vs,e),a=l.FArgs.FElements):null===a&&this.RaiseInconsistency(20180720154413,e),null===l.FExpr&&(10 in this.FOptions&&r.IsSpecializedNonStaticMethod(f)?function(e,i){var r,o="",h=null,u=null;r=i.FParent,o=s.CreateStaticProcPath(r,t),l.FExpr=s.CreatePrimitiveDotExpr(o+".apply",e),null!==n?null===(h=s.ConvertExpression(n.Left,t))&&s.RaiseNotSupported(n,t,20201030235816,""):ve.isPrototypeOf(e.FData)?(u=e.FData,o=s.CreateReferencePath(r,t,0,!1,u),null===(h=s.CreatePrimitiveDotExpr(o,e))&&s.RaiseNotSupported(n,t,20201031003202,"")):s.RaiseNotSupported(n,t,0xb7ba30c53aae,""),a.AddElement().FExpr=h}(T,f):l.FExpr=null!==n?this.ConvertSubIdentExprCustom(n,t,null,null):this.ConvertExpression(T,t)),this.CreateProcedureCallArgs(a,e,f,t),x=l.FArgs,0===a.GetCount()&&x.FElements.GetCount()>0&&(N=x.FElements.GetE(x.FElements.GetCount()-1),fs.isPrototypeOf(N.FExpr)||this.RaiseNotSupported(e,t,20180720161317,""),N.FExpr.FElements!==a&&this.RaiseNotSupported(e,t,20180720161324,""),N=rtl.freeLoc(N)),0===x.FElements.GetCount()&&(x=rtl.freeLoc(x),l.FArgs=null),R&&(l=this.CreateIntfRef(l,t,e)),i=l}finally{t.Access=o,null===i&&(l=rtl.freeLoc(l))}return i},this.ConvertExternalConstructor=function(t,s,i,r){var n=null,l=null,a="",o=null,h=Ue.$new(),u=0,c=null,p=null,f=null;n=null,f=r.Resolver,o=null,a="",c=null;try{if(l=rtl.as(s.FDeclaration,Ft),p=s.FElement,0===ye(l.FName,"new"))null!==l.LibrarySymbolName&&(a=this.ComputeConstString(l.LibrarySymbolName,r,!0),lt(a,"new")||(c=this.CreatePrimitiveDotExpr(a,p))),null===c&&null!==t&&(null!==f&&(f.ComputeElement(t,h,{},null),3===h.BaseType&&(t=null)),null!==t&&(u=r.Access,r.Access=0,c=this.ConvertExpression(t,r),r.Access=u)),null===c&&(null!==s.WithExprScope?""===(a=rtl.as(s.WithExprScope,d).WithVarName)&&this.RaiseNotSupported(i,r,20190209092049,""):a=rtl.as(l.FParent,Ae).ExternalName,""===a&&this.DoError$2(20180511163944,4026,rtl.getResStr(e,"sJSNewNotSupported"),[],i),c=this.CreatePrimitiveDotExpr(a,p));else{if(a="",null!==f&&(a=f.ComputeConstString(l.LibrarySymbolName,!0,!0)),"{}"===a)return n=this.CreateElement(zt,p);c=this.CreateReferencePathExpr(l,r,!0,null)}(o=this.CreateElement(hs,p)).FMExpr=c,c=null,o.FArgs=this.CreateElement(vs,p),null!==i&&this.CreateProcedureCallArgs(o.FArgs.FElements,i,l.ProcType,r),n=o,o=null}finally{c=rtl.freeLoc(c),o=rtl.freeLoc(o)}return n},this.ConvertTObjectFree_Bin=function(e,t,s){var i=this,r=null;function n(t,s){var r=null;return(r=i.CreateCallExpression(e.Right)).FExpr=i.CreateMemberExpression([i.GetBIName(144),i.GetBIName(61)]),r.FArgs.AddElement(t),r.FArgs.AddElement(s),r}var l=null,a=null,o=null,h=null,u=null,c=null,p=null,f="",d=null,F=null;r=null,l=this.ConvertExpression(e.Left,s);try{if(Vt.isPrototypeOf(l))f=l.FName,ts(".",f)>0&&this.RaiseInconsistency(20170516173832,e.Left),h=l,u=this.ClonePrimaryExpression(l,e.Left),r=this.CreateCallRTLFreeLoc(u,h,t);else if(wt.isPrototypeOf(l))a=(c=l).FMExpr,c.FMExpr=null,o=this.CreateLiteralJSString(e.Right,c.FName),j({get:function(){return l},set:function(e){l=e}}),r=n(a,o);else if(os.isPrototypeOf(l))a=(p=l).FMExpr,p.FMExpr=null,o=p.FName,p.FName=null,j({get:function(){return l},set:function(e){l=e}}),r=n(a,o);else if(us.isPrototypeOf(l)){F=O.$create("Create$1",[e.Left,null,s]);try{(d=this.CreateCallExpression(e.Left)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(60)]),d.FArgs.AddElement(l),l=null,F.RightSide=d,s.Resolver.ComputeElement(e.Left,F.LeftResolved,rtl.createSet(1),null),F.RightResolved.$assign(F.LeftResolved),r=this.CreateAssignStatement(e.Left,F)}finally{rtl.free(F,"RightSide"),F=rtl.freeLoc(F)}}else this.RaiseNotSupported(e.Left,s,20170516164659,"invalid scope for Free")}finally{null===r&&(l=rtl.freeLoc(l))}return r},this.ConvertTObjectFree_With=function(e,t){var s,i=null,r=null,n=null;return i=null,null===(s=rtl.as(e.FData.WithExprScope,d))&&this.RaiseInconsistency(20181027133210,e),null!==t.Resolver.GetNewInstanceExpr(s.Expr)?(""===s.WithVarName&&this.RaiseNotSupported(e,t,20190209092220,""),r=this.CreatePrimitiveDotExpr(s.WithVarName,s.Expr),n=this.CreatePrimitiveDotExpr(s.WithVarName,s.Expr),i=this.CreateCallRTLFreeLoc(n,r,e)):(this.RaiseInconsistency(20170517092248,e),i)},this.ConvertTypeCastToBaseType=function(t,s,i){var r,n,l=null,a=Ue.$new(),o=0,h=null;function u(){var e=null;return 1===a.BaseType&&((e=a.LoTypeEl).$class.ClassType()===it&&(!!m.isPrototypeOf(e.FData)&&(h=e.FData,o=h.JSBaseType,true)))}var c=null,p=null,f=null,d=null,F=null,C=0,S=null,T=0,y=null,g=Ue.$new();if(l=null,n=t.Params[0],(S=s.Resolver).ComputeElement(n,a,{},null),h=null,o=0,T=a.BaseType,y=a.LoTypeEl,37===T&&(T=a.SubType,S.ComputeElement(y.RangeExpr.Left,g,rtl.createSet(3),null),y=g.LoTypeEl),T===(r=i.BaseType))return l=this.ConvertExpression(n,s);if(r in e.btAllJSInteger){if(T in e.btAllJSInteger)return l=this.ConvertExpression(n,s),l=this.ConvertIntToInt(l,T,r,t,s);if(T in e.btAllJSBooleans)return l=this.ConvertExpression(n,s),(p=this.CreateElement(ds,t)).FA=l,p.FB=14===r?this.CreateLiteralNumber(t,1e4):this.CreateLiteralNumber(t,1),p.FC=this.CreateLiteralNumber(t,0),l=p;if(T in e.btAllJSChars)return l=this.ConvertExpression(n,s),l=this.ConvertCharToInt(l,t,s),l=this.ConvertIntToInt(l,21,r,t,s);if(2===T){if(y.$class.ClassType()===st)return l=this.ConvertExpression(n,s),14===r&&(l=this.CreateMulNumber(n,l,1e4)),l}else if(u()){if(1===o)return l=this.ConvertExpression(n,s),14===r&&(l=this.CreateMulNumber(n,l,1e4)),l=this.CreateTruncFloor(t,l,!0)}else if(14===r&&T in e.btAllJSFloats)return l=this.ConvertExpression(n,s),l=this.CreateMulNumber(n,l,1e4)}else if(r in e.btAllJSBooleans){if(T in e.btAllJSBooleans)return l=this.ConvertExpression(n,s);if(T in e.btAllJSInteger)return l=this.ConvertExpression(n,s),(c=this.CreateElement(Ki,t)).FA=l,c.FB=this.CreateLiteralNumber(t,0),l=c;if(u()&&1===o)return l=this.ConvertExpression(n,s),(d=this.CreateElement(Js,t)).FA=this.CreateElement(Xi,t),d.FA.FA=l,d.FA.FB=this.CreateLiteralBoolean(t,!1),l=d}else if(r in e.btAllJSFloats){if(T in rtl.unionSet(e.btAllJSFloats,e.btAllJSInteger))return l=this.ConvertExpression(n,s),14===a.BaseType&&(l=this.CreateDivideNumber(t,l,1e4)),l;if(u()&&1===o)return l=this.ConvertExpression(n,s),(f=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(31)]),f.AddArg(l),l=f}else if(r in e.btAllJSStrings){if(T in e.btAllJSStringAndChars)return l=this.ConvertExpression(n,s);if(29===T)return l=this.ConvertExpression(n,s);if(u()&&1===o)return l=this.ConvertExpression(n,s),(F=this.CreateElement(_i,t)).FA=this.CreateLiteralString(t,""),F.FB=l,l=F}else if(r in rtl.createSet(5,6)){if(T in rtl.createSet(5,6))return l=this.ConvertExpression(n,s);if(T in e.btAllJSInteger||2===T&&y.$class.ClassType()===st)return l=this.ConvertExpression(n,s),this.IsLiteralInteger(l,{get:function(){return C},set:function(e){C=e}})&&C>=0&&C<=65535?(j({get:function(){return l},set:function(e){l=e}}),l=this.CreateLiteralJSString(n,String.fromCharCode(C))):l=this.CreateCallFromCharCode(l,t),l;if(T in rtl.unionSet(U.btArrayRangeTypes,rtl.createSet(37))||u()&&1===o)return l=this.ConvertExpression(n,s),this.IsLiteralInteger(l,{get:function(){return C},set:function(e){C=e}})?C>=0&&C<=65535?(j({get:function(){return l},set:function(e){l=e}}),l=this.CreateLiteralJSString(n,String.fromCharCode(C))):l=this.CreateCallFromCharCode(l,t):((f=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(30)]),f.AddArg(l),l=f),l}else if(29===r)if(u()){if(1===o)return l=this.ConvertExpression(n,s)}else{if(T in e.btAllJSStrings)return l=this.ConvertExpression(n,s);if(2===T)return l=this.ConvertExpression(n,s)}else if(1===r&&m.isPrototypeOf(i)&&1===(o=i.JSBaseType))return l=this.ConvertExpression(n,s);return this.RaiseNotSupported(t,s,20170325161150,""),l},this.ConvertArrayOrSetLiteral=function(t,s){var i=this,r=null,n=null,l=null;function a(e){n.AddArg(i.CreateSetLiteralElement(e,l))}var o=0,h=null,u=null,c=null;if(4!==t.Kind&&this.RaiseInconsistency(20170209112737,t),0!==s.Access&&this.DoError$2(20170209112926,4008,rtl.getResStr(e,"sCantWriteSetLiteral"),[],t),null!==(u=s.Resolver)&&null!==(c=u.IsArrayExpr(t)))return r=this.CreateArrayInit(c,t,t,s);if(0===rtl.length(t.Params))r=this.CreateElement(zt,t);else{r=null,l=s.GetNonDotContext(),n=this.CreateCallExpression(t);try{n.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(102)]);for(var p=0,f=rtl.length(t.Params)-1;p<=f;p++)o=p,(h=t.Params[o]).$class.ClassType()===Je&&7===h.Kind?(n.AddArg(this.CreateLiteralNull(h)),a(h.Left),a(h.Right)):a(h);r=n}finally{null===r&&(n=rtl.freeLoc(n))}}return r},this.ConvertBuiltIn_Length=function(e,t){var s,i,r=null,n=null,l=Ue.$new(),a=[],o=null,h=0;return r=null,i=e.Params[0],t.Resolver.ComputeElement(i,l,{},null),2===l.BaseType&&ft.isPrototypeOf(l.LoTypeEl)?(a=l.LoTypeEl.Ranges,rtl.length(a)>0?(rtl.length(a)>1&&this.RaiseNotSupported(e,t,20170223131042,""),n=a[0],h=t.Resolver.GetRangeLength(n),r=this.CreateLiteralNumber(e,h)):(r=this.ConvertExpression(e.Params[0],t),(o=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(7)]),o.AddArg(r),r=o)):(s=this.ConvertExpression(i,t),r=this.CreateDotNameExpr(e,s,"length"))},this.ConvertBuiltIn_SetLength=function(t,s){var i,r,n=null,l=null,a=Ue.$new(),o=Ue.$new(),h=null,u=null,c=null,f=null,d=null,F=0,m=null,C=0,S=null,T=null,y=null,g=!1;if(n=null,i=t.Params[0],0!==s.Access&&this.RaiseInconsistency(20170213213621,t),(m=s.Resolver).ComputeElement(i,a,rtl.createSet(1),null),r=a.LoTypeEl,ft.isPrototypeOf(r)){h=r,f=O.$create("Create$1",[t,null,s]),S=null;try{m.ComputeElement(i,f.LeftResolved,rtl.createSet(1),null),f.RightResolved.$assign(a),u=this.CreateCallExpression(t),f.RightSide=u,u.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(11)]),u.AddArg(this.ConvertExpression(i,s));for(var E=3,P=rtl.length(t.Params);E<=P;E++)F=E,d=m.ResolveAliasType(m.GetArrayElType(h),!0),h=rtl.as(d,ft);for(g=null!==(y=rtl.as(h.FData,p))&&y.Managed,d=m.ResolveAliasType(m.GetArrayElType(h),!0);d.$class.ClassType()===ft&&rtl.length(d.Ranges)>0;){h=rtl.as(d,ft);for(var I=0,R=rtl.length(h.Ranges)-1;I<=R;I++)F=I,l=h.Ranges[F],0===(C=m.GetRangeLength(l))&&(m.ComputeElement(l,o,rtl.createSet(3),null),this.RaiseNotSupported(l,s,20190614171520,Zs(o))),T=this.CreateLiteralNumber(t,C),null===S&&(S=Qs.$create("Create$3",[!0])),S.Add$1(T);d=m.ResolveAliasType(m.GetArrayElType(h),!0)}c=d.$class.ClassType()===Me?this.CreateReferencePathExpr(d,s,!1,null):g?this.CreateLiteralJSString(i,this.GetBIName(123)):this.CreateValInit(d,null,i,s),u.AddArg(c);for(var v=1,A=rtl.length(t.Params)-1;v<=A;v++)F=v,u.AddArg(this.ConvertExpression(t.Params[F],s));if(null!==S){u.AddArg(this.CreateLiteralJSString(t,"s"));for(var N=0,x=S.GetCount()-1;N<=x;N++)F=N,u.AddArg(S.GetItem(F));S.FFreeObjects=!1}n=this.CreateAssignStatement(i,f)}finally{rtl.free(f,"RightSide"),f=rtl.freeLoc(f),S=rtl.freeLoc(S)}}else if(a.BaseType in e.btAllJSStrings){f=O.$create("Create$1",[t,null,s]);try{m.ComputeElement(i,f.LeftResolved,rtl.createSet(1),null),f.RightResolved.$assign(f.LeftResolved),u=this.CreateCallExpression(t),f.RightSide=u,u.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(115)]),u.AddArg(this.ConvertExpression(i,s)),u.AddArg(this.ConvertExpression(t.Params[1],s)),n=this.CreateAssignStatement(i,f)}finally{rtl.free(f,"RightSide"),f=rtl.freeLoc(f)}}else this.RaiseNotSupported(t.Value,s,20170130141026,"setlength "+Zs(a));return n},this.ConvertBuiltIn_ExcludeInclude=function(e,t,s){var i,r=null,n=null,l=null,a="";r=null,i=e.Params[0],l=O.$create("Create$1",[e,null,t]);try{t.Resolver.ComputeElement(i,l.LeftResolved,rtl.createSet(1),null),l.RightResolved.$assign(l.LeftResolved),n=this.CreateCallExpression(e),l.RightSide=n,a=s?this.GetBIName(107):this.GetBIName(105),n.FExpr=this.CreateMemberExpression([this.GetBIName(144),a]),n.AddArg(this.ConvertExpression(i,t)),n.AddArg(this.ConvertExpression(e.Params[1],t)),r=this.CreateAssignStatement(i,l)}finally{rtl.free(l,"RightSide"),l=rtl.freeLoc(l)}return r},this.ConvertBuiltInContinue=function(e,t){return this.CreateElement(qi,e)},this.ConvertBuiltInBreak=function(e,t){return this.CreateElement(jt,e)},this.ConvertBuiltIn_Exit=function(e,t){var s,i=null,r=null,n=null,l="",a=null,o=null,h=null,u=null,p=null,f=!1,d=!1,F=null,m=null,C=null;for(r=e.FParent;null!==r&&!Se.isPrototypeOf(r);)r=r.FParent;if(l="",F=null,d=!1,null!==(s=r)?(null===(u=(n=rtl.as(s.FData,c)).DeclarationProc)&&(u=s),Xe.isPrototypeOf(u.ProcType)&&(""===(l=n.ResultVarName)&&(l=U.ResolverResultVar),F=u.ProcType.ResultEl,m=t.Resolver.ResolveAliasType(F.ResultType,!0),d=t.Resolver.IsManagedJSType(m))):u=null,a=t.GetFunctionContext(),i=this.CreateElement(Ns,e),je.isPrototypeOf(e)&&rtl.length(e.Params)>0){if(f=!1,""!==l)for(r=e.FParent;r!==s;){if(Qi.isPrototypeOf(r)&&(p=r,Mi.isPrototypeOf(p.FinallyExcept)&&t.Resolver.ImplBlockReadsDecl(p.FinallyExcept,F))){f=!0;break}r=r.FParent}d?(a.ResultNeedsIntfRelease=!0,(C=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(51)]),C.AddArg(this.CreatePrimitiveDotExpr(l,e)),C.AddArg(this.ConvertExpression(e.Params[0],t)),(o=this.CreateElement(_t,e)).FLHS=this.CreatePrimitiveDotExpr(l,e),o.FExpr=C,i.FExpr=this.CreatePrimitiveDotExpr(l,e),(h=this.CreateElement(Ht,e)).FA=o,h.FB=i,i=h):f?((o=this.CreateElement(_t,e)).FLHS=this.CreatePrimitiveDotExpr(l,e),o.FExpr=this.ConvertExpression(e.Params[0],t),i.FExpr=this.CreatePrimitiveDotExpr(l,e),(h=this.CreateElement(Ht,e)).FA=o,h.FB=i,i=h):i.FExpr=this.ConvertExpression(e.Params[0],t)}else""!==l&&(i.FExpr=this.CreatePrimitiveDotExpr(l,e));return null!==a&&a.ResultNeedsIntfRelease&&((o=this.CreateElement(_t,e)).FLHS=this.CreatePrimitiveDotExpr(this.GetBIName(140),e),o.FExpr=this.CreateLiteralBoolean(e,!0),(h=this.CreateElement(Ht,e)).FA=o,h.FB=i,i=h),i},this.ConvertBuiltIn_IncDec=function(e,s){var i,r,n=null,l=null,a=null,o=Ue.$new(),h=null,u=null,c=null,p=null,f=null,d=null;n=null,a=(d=s.Resolver).GetRightMostExpr(e.Value),_e.isPrototypeOf(a)||this.RaiseNotSupported(a,s,20200620113218,""),r=0===ye(a.Value,"inc"),a=e.Params[0],d.ComputeElement(a,o,{},null),u=1===rtl.length(e.Params)?this.CreateLiteralNumber(e,1):this.ConvertExpression(e.Params[1],s),i=e.Value,l=null,c=null,f=null,h=null;try{if(Ye.isPrototypeOf(o.IdentEl)){if(o.IdentEl.Access in rtl.createSet(2,3))return(c=this.CreateCallExpression(i)).FExpr=this.CreateDotNameExpr(i,this.CreateIdentifierExpr(o.IdentEl,s),t.TempRefObjSetterName),p=r?this.CreateElement(_i,i):this.CreateElement(vi,i),c.AddArg(p),p.FA=this.CreateElement(us,i),p.FA.FExpr=this.CreateDotNameExpr(i,this.CreateIdentifierExpr(o.IdentEl,s),t.TempRefObjGetterName),p.FB=u,u=null,n=c}else xe.isPrototypeOf(o.IdentEl)&&this.RaiseNotSupported(a,s,20170501151316,"");f=O.$create("Create$1",[a,null,s]),d.ComputeElement(a,f.LeftResolved,rtl.createSet(1),null),It(f.RightResolved,f.LeftResolved.BaseType,f.LeftResolved.LoTypeEl,f.LeftResolved.HiTypeEl,a,rtl.createSet(0)),f.RightSide=u,u=null,h=this.ConvertExpression(a,f),null!==f.Call?this.RaiseNotSupported(e,s,20181101154351,""):null===f.RightSide&&this.RaiseInconsistency(20180622211919,e),(l=r?this.CreateElement(Fi,i):this.CreateElement(mi,i)).FLHS=h,h=null,l.FExpr=f.RightSide,f.RightSide=null,n=l}finally{u=rtl.freeLoc(u),null===n&&(l=rtl.freeLoc(l),c=rtl.freeLoc(c),h=rtl.freeLoc(h)),null!==f&&(rtl.free(f,"RightSide"),f=rtl.freeLoc(f))}return n},this.ConvertBuiltIn_Assigned=function(e,t){var s,i=null,r=null,n=Ue.$new(),l=null,a=null,o=null;return i=null,null===t.Resolver&&this.RaiseInconsistency(20170210105235,e),s=e.Params[0],t.Resolver.ComputeElement(s,n,rtl.createSet(2),null),29===n.BaseType?(i=this.ConvertExpression(s,t),(r=this.CreateElement(Ki,e)).FA=i,r.FB=this.CreateLiteralNull(e),i=r):2===n.BaseType&&((l=n.LoTypeEl.$class.ClassType())===Ae||l===Tt||l.InheritsFrom(At)?(i=this.ConvertExpression(s,t),(r=this.CreateElement(Ki,e)).FA=i,r.FB=this.CreateLiteralNull(e),i=r):l===ft?(i=this.ConvertExpression(s,t),a=this.CreateElement(ei,e),(o=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(7)]),o.AddArg(i),a.FA=o,a.FB=this.CreateLiteralNumber(e,0),i=a):this.RaiseNotSupported(e,t,20170328124606,"")),i},this.ConvertBuiltIn_Chr=function(t,s){var i,r=null,n=Ue.$new();return r=null,null===s.Resolver&&this.RaiseInconsistency(20170325185847,t),i=t.Params[0],s.Resolver.ComputeElement(i,n,{},null),n.BaseType in e.btAllJSInteger?(r=this.ConvertExpression(i,s),r=this.CreateCallFromCharCode(r,t)):(this.DoError$2(20170325185906,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"integer",18,s.Resolver.GetResolverResultDescription(n,!1)),i),r)},this.ConvertBuiltIn_Ord=function(t,s){var i=this,r=null;function n(e,r){var n=null,l=null,a=null;if(n=null,a=null,null===(l=e.Eval(r,{},!0)))return n;try{if((a=e.fExprEvaluator.OrdValue(l,t))===l&&(l=null),null!==a)return n=i.ConvertConstValue(a,s,t)}finally{nt({get:function(){return l},set:function(e){l=e}}),nt({get:function(){return a},set:function(e){a=e}})}return n}var l,a=Ue.$new(),o=Ue.$new(),h=null,u=null,c=null,p=null,f=null,d=null,F=null,m=0,C=null;if(r=null,null===(F=s.Resolver)&&this.RaiseInconsistency(20170210105235,t),l=t.Params[0],F.ComputeElement(l,a,{},null),37===(m=a.BaseType)&&(m=a.SubType),m in rtl.createSet(5,6)){if(je.isPrototypeOf(l)){if(11===(c=l).Kind&&(h=c.Value,s.Resolver.ComputeElement(h,o,{},null),o.BaseType in e.btAllJSStrings)){p=this.ConvertExpression(h,s),u=null;try{(u=this.CreateCallExpression(t)).FExpr=this.CreateDotNameExpr(t,p,"charCodeAt"),f=this.CreateElement(vi,l),u.AddArg(f),1!==rtl.length(c.Params)&&this.RaiseInconsistency(20170405231706,t),f.FA=this.ConvertExpression(c.Params[0],s),f.FB=this.CreateLiteralNumber(l,1),r=u}finally{null===r&&(u=rtl.freeLoc(u))}return r}}else if(null!==(r=n(F,l)))return r;return r=this.ConvertExpression(l,s),r=this.CreateCallCharCodeAt(r,0,t)}return m in e.btAllJSBooleans?null!==(r=n(F,l))?r:(r=this.ConvertExpression(l,s),(d=this.CreateElement(_i,t)).FA=r,d.FB=this.CreateLiteralNumber(t,0),r=d):m in e.btAllJSInteger?null!==(r=n(F,l))?r:r=this.ConvertExpression(l,s):2!==m||(C=a.LoTypeEl.$class.ClassType())!==st&&C!==rt?(this.DoError$2(20170210105339,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"enum",18,s.Resolver.GetResolverResultDescription(a,!1)),l),r):r=this.ConvertExpression(l,s)},this.ConvertBuiltIn_LowHigh=function(e,t,s){var i=this,r=null;function n(e){var n=null;n=s?rtl.getObject(e.Values.Get(0)):rtl.getObject(e.Values.Get(e.Values.FCount-1)),r=i.CreateReferencePathExpr(n,t,!1,null)}var l,a=Ue.$new(),o=null,h=[],u=null,c=null,p=null,f=0,d=0,F=0;r=null,null===t.Resolver&&this.RaiseInconsistency(20170210120659,e),l=e.Params[0],t.Resolver.ComputeElement(l,a,{},null),37===(F=a.BaseType)&&(F=a.SubType);var m=F;if(2===m){if((o=a.LoTypeEl).$class.ClassType()===rt)return r=s?this.ConvertElement(o.RangeExpr.Left,t):this.ConvertElement(o.RangeExpr.Right,t);if(o.$class.ClassType()===st)return n(o),r;if(o.$class.ClassType()===vt){if(null!==o.EnumType)return n(o=o.EnumType),r}else if(o.$class.ClassType()===ft){if(h=o.Ranges,s){if(0===rtl.length(h))return r=this.CreateLiteralNumber(e,0);null===(u=t.Resolver.EvalRangeLimit(h[0],rtl.createSet(0),!0,e))&&this.RaiseNotSupported(e,t,20170910160817,"");try{r=this.ConvertConstValue(u,t,l)}finally{nt({get:function(){return u},set:function(e){u=e}})}return r}if(0===rtl.length(h))return r=this.ConvertExpression(l,t),(c=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(7)]),c.AddArg(r),(p=this.CreateElement(vi,e)).FA=c,p.FB=this.CreateLiteralNumber(e,1),r=p;null===(u=t.Resolver.EvalRangeLimit(h[0],rtl.createSet(0),!1,e))&&this.RaiseNotSupported(e,t,20170910161555,"");try{r=this.ConvertConstValue(u,t,l)}finally{nt({get:function(){return u},set:function(e){u=e}})}return r}}else{if(15===m||16===m||17===m||18===m)return r=s?this.CreateLiteralBoolean(e,!1):this.CreateLiteralBoolean(e,!0);if(5===m||6===m)return r=s?this.CreateLiteralJSString(e,"\0"):this.CreateLiteralJSString(e,"");if(m>=19&&m<=Zi){if((o=a.LoTypeEl).$class.ClassType()===it){if(ne.isPrototypeOf(o.FData))return t.Resolver.GetIntegerRange(a.BaseType,{get:function(){return f},set:function(e){f=e}},{get:function(){return d},set:function(e){d=e}}),r=s?this.CreateLiteralNumber(e,f):this.CreateLiteralNumber(e,d)}else if(o.$class.ClassType()===rt){u=t.Resolver.EvalRangeLimit(o.RangeExpr,rtl.createSet(0),s,e);try{var C=u.Kind;return 4===C?r=this.CreateLiteralNumber(e,u.Int):5===C?r=this.CreateLiteralNumber(e,u.UInt):this.RaiseNotSupported(e,t,20170925214317,""),r}finally{nt({get:function(){return u},set:function(e){u=e}})}}this.RaiseNotSupported(e,t,20170925214351,"")}else if(34===m||36===m){if((o=a.LoTypeEl).$class.ClassType()===st)return n(o),r}else if(7===m)return s?r=this.CreateLiteralNumber(e,1):(r=this.ConvertExpression(l,t),r=this.CreateDotNameExpr(e,r,"length")),r}return this.DoError$2(20170210110717,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"enum or array",18,t.Resolver.GetResolverResultDescription(a,!1)),l),r},this.ConvertBuiltIn_PredSucc=function(t,s,i){var r=this,n=null,l=Ue.$new(),a=null;function o(e){r.DoError$2(e,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"enum",18,s.Resolver.GetResolverResultDescription(l,!1)),t.Params[0])}function h(e){var l,a=null;l=r.ConvertExpression(e,s),(a=i?r.CreateElement(vi,t):r.CreateElement(_i,t)).FA=l,a.FB=r.CreateLiteralNumber(t,1),n=a}function u(){n=i?r.CreateLiteralBoolean(t,!1):r.CreateLiteralBoolean(t,!0)}var c,p=null;if(n=null,null===s.Resolver&&this.RaiseInconsistency(20170210120648,t),c=t.Params[0],s.Resolver.ComputeElement(c,l,{},null),a=l.LoTypeEl,l.BaseType in e.btAllJSInteger)return h(c),n;if(l.BaseType in e.btAllJSBooleans)return u(),n;if(l.BaseType in e.btAllJSChars)return function(e){var l,a=null,o=null;l=r.ConvertExpression(e,s),a=r.CreateCallCharCodeAt(l,0,t),(o=i?r.CreateElement(vi,t):r.CreateElement(_i,t)).FA=a,o.FB=r.CreateLiteralNumber(t,1),a=r.CreateCallFromCharCode(o,t),n=a}(c),n;if(2===l.BaseType){if(a.$class.ClassType()===st)return h(c),n;o(20180424115902)}else if(37===l.BaseType){if(l.SubType in e.btAllJSInteger)return h(c),n;if(l.SubType in e.btAllJSBooleans)return h(c),n;if(2===l.SubType)if(a.$class.ClassType()===rt){if(null!==(p=s.Resolver.EvalTypeRange(a,rtl.createSet(0))))try{var f=p.Kind;if(10===f){var d=p.ElKind;if(1===d||2===d)return h(c),n;if(3===d)o(20180424115736);else{if(4===d)return u(),n;o(20180424115959)}}else{if(11===f)return h(c),n;o(20180424115757)}}finally{nt({get:function(){return p},set:function(e){p=e}})}}else o(20180424115934)}return o(20170210120039),n},this.ConvertBuiltIn_StrProc=function(e,t){var s=null,i=null,r=null,n=null;s=null,i=O.$create("Create$1",[e,null,t]);try{r=e.Params[1],t.Resolver.ComputeElement(r,i.LeftResolved,rtl.createSet(1),null),i.RightSide=this.ConvertBuiltInStrParam(e.Params[0],t,!1,!0),n=t.Resolver.GetBaseTypes(7),It(i.RightResolved,7,n,n,e,rtl.createSet(0)),s=this.CreateAssignStatement(r,i)}finally{rtl.free(i,"RightSide"),i=rtl.freeLoc(i)}return s},this.ConvertBuiltIn_StrFunc=function(e,t){var s=null,i=0,r=null,n=null,l=null,a=null;s=null,n=null,l=null;try{for(var o=0,h=rtl.length(e.Params)-1;o<=h;o++)i=o,r=e.Params[i],l=this.ConvertBuiltInStrParam(r,t,!0,0===i),null===n?n=l:((a=this.CreateElement(_i,r)).FA=n,a.FB=l,n=a),l=null;s=n}finally{l=rtl.freeLoc(l),null===s&&(n=rtl.freeLoc(n))}return s},this.ConvertBuiltInStrParam=function(t,s,i,r){var n=this,l=null,a=null;function o(){var e=null;(e=n.CreateElement(_i,t)).FA=n.CreateLiteralString(t,""),e.FB=a,a=e}var h=null,u=Ue.$new(),c=Ue.$new(),p=!1,f=null,d=null,F=null,m=0,C=null;l=null,(h=s.Resolver).ComputeElement(t,u,{},null),a=null,f=null,d=null;try{if(p=!1,37===(m=u.BaseType)&&(m=u.SubType),m in rtl.diffSet(rtl.unionSet(e.btAllJSBooleans,e.btAllJSInteger),rtl.createSet(14)))p=!0,a=this.ConvertExpression(t,s);else{if(m in rtl.unionSet(e.btAllJSFloats,rtl.createSet(14)))return(f=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(58)]),F=this.ConvertExpression(t,s),14===u.BaseType&&(F=this.CreateDivideNumber(t,F,1e4)),f.AddArg(F),null!==t.Format1&&f.AddArg(this.ConvertExpression(t.Format1,s)),null!==t.Format2&&f.AddArg(this.ConvertExpression(t.Format2,s)),l=f,f=null,l;i&&m in e.btAllJSStringAndChars?a=this.ConvertExpression(t,s):2===m?((C=u.LoTypeEl).$class.ClassType()===rt&&(h.ComputeElement(C.RangeExpr.Left,c,rtl.createSet(3),null),C=c.LoTypeEl),C.$class.ClassType()===st?((d=this.CreateElement(os,t)).FMExpr=this.CreateReferencePathExpr(C,s,!1,null),d.FName=this.ConvertExpression(t,s),a=d,d=null):this.RaiseNotSupported(t,s,20170320123827,"")):this.RaiseNotSupported(t,s,20170320093001,"")}null!==t.Format1?(p&&o(),(f=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(114)]),f.AddArg(a),a=null,f.AddArg(this.ConvertExpression(t.Format1,s)),a=f,f=null):r&&p&&o(),l=a}finally{f=rtl.freeLoc(f),d=rtl.freeLoc(d),null===l&&(a=rtl.freeLoc(a))}return l},this.ConvertBuiltIn_WriteStr=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=null,o=0;s=null,i=O.$create("Create$1",[e,null,t]);try{r=e.Params[0],t.Resolver.ComputeElement(r,i.LeftResolved,rtl.createSet(1),null);for(var h=1,u=rtl.length(e.Params)-1;h<=u;h++)o=h,l=this.ConvertBuiltInStrParam(e.Params[o],t,!1,!0),null===i.RightSide?i.RightSide=l:((a=this.CreateElement(_i,e)).FA=i.RightSide,i.RightSide=a,a.FB=l);n=t.Resolver.GetBaseTypes(7),It(i.RightResolved,7,n,n,e,rtl.createSet(0)),s=this.CreateAssignStatement(r,i)}finally{rtl.free(i,"RightSide"),i=rtl.freeLoc(i)}return s},this.ConvertBuiltIn_Val=function(e,s){var i,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p=Ue.$new(),f=Ue.$new(),d=null,F="",m=null,C=null,S=0,T=null;r=null,n=s.Resolver,i=e.Params,h=null,l=O.$create("Create$1",[e,null,s]);try{a=i[1],n.ComputeElement(a,l.LeftResolved,rtl.createSet(1),null),h=this.CreateCallExpression(e),l.RightSide=h,h.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(59)]),h.AddArg(this.ConvertExpression(i[0],s)),37===(S=l.LeftResolved.BaseType)&&(S=l.LeftResolved.SubType),2===S?((T=l.LeftResolved.LoTypeEl).$class.ClassType()===rt&&(n.ComputeElement(T.RangeExpr.Left,f,rtl.createSet(3),null),T=f.LoTypeEl),T.$class.ClassType()===st?(u=T,h.AddArg(this.CreateReferencePathExpr(u,s,!1,null))):this.RaiseNotSupported(i[1],s,20181214145226,Zs(l.LeftResolved))):this.RaiseNotSupported(i[1],s,20181214145125,Zs(l.LeftResolved)),o=i[2],s.Resolver.ComputeElement(o,p,rtl.createSet(1),null),m=null,Ye.isPrototypeOf(p.IdentEl)&&p.IdentEl.Access in rtl.createSet(2,3)&&(m=this.CreateDotNameExpr(o,this.CreateIdentifierExpr(p.IdentEl,s),t.TempRefObjSetterName),h.AddArg(m)),null===m&&((null===p.IdentEl||xe.isPrototypeOf(p.IdentEl))&&this.RaiseNotSupported(o,s,20181214154031,"property"),m=c=this.CreateFunctionSt(o,!0,!1),h.AddArg(m),d=this.CreateElement(_t,o),c.FFuncDef.FBody.FA=d,C=this.ConvertExpression(o,s),d.FLHS=C,F=t.TempRefObjSetterArgName,this.FindAvailableLocalName({get:function(){return F},set:function(e){F=e}},C),c.FFuncDef.FTypedParams.AddParam(F),d.FExpr=this.CreatePrimitiveDotExpr(F,o)),r=this.CreateAssignStatement(a,l)}finally{null!==O&&(rtl.free(l,"RightSide"),l=rtl.freeLoc(l))}return r},this.ConvertBuiltIn_LoHi=function(t,s,i){var r,n,l=null,a=Ue.$new(),o=0,h=0,u=null,c=null;l=null,null===s.Resolver&&this.RaiseInconsistency(20190129102200,t),r=t.Params[0],s.Resolver.ComputeElement(r,a,{},null),a.BaseType in e.btAllJSInteger||this.DoError$2(20190129121100,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"integer type",18,s.Resolver.GetResolverResultDescription(a,!1)),r),n=s.Resolver.GetShiftAndMaskForLoHiFunc(a.BaseType,i,{get:function(){return o},set:function(e){o=e}}),l=this.ConvertExpression(r,s),n>0&&(32===n?l=this.CreateTruncFloor(t,this.CreateDivideNumber(t,l,4294967296),!1):((u=this.CreateElement(zi,t)).FA=l,u.FB=this.CreateLiteralNumber(t,n),l=u));return(h=255===o?2:65535===o?4:4294967295===o?8:1)<8?((c=this.CreateElement(Wi,t)).FA=l,c.FB=this.CreateLiteralHexNumber(t,o,h),l=c):((u=this.CreateElement(Hi,t)).FA=l,u.FB=this.CreateLiteralNumber(t,0),l=u),l},this.ConvertBuiltIn_ConcatArray=function(e,t){var s,i,r=null,n=Ue.$new(),l=null,a=0,o=null,h=null,u=null,c=!1;if(r=null,s=e.Params,rtl.length(s)<1&&this.RaiseInconsistency(20170331000332,e),i=e.Params[0],(u=t.Resolver).ComputeElement(i,n,{},null),1===rtl.length(s))r=this.ConvertExpression(i,t),u.IsManagedJSType(n.LoTypeEl)||(r=this.CreateArrayRef(e,r));else{o=null,c=!1,ft.isPrototypeOf(n.LoTypeEl)?(l=n.LoTypeEl,o=this.CreateArrayConcat$1(l,e,t,!1),c=u.IsManagedJSType(l)):35===n.BaseType&&(n.BaseType=n.SubType,n.SubType=0,o=this.CreateArrayConcat(Ue.$clone(n),e,t,!1)),null===o&&this.RaiseNotSupported(i,t,20170331000846,"");try{for(var p=0,f=rtl.length(s)-1;p<=f;p++)a=p,h=this.CreateArrayEl(s[a],t),o.AddArg(h);r=o,c&&(r=this.CreateIntfRef(r,t,e))}finally{null===r&&(o=rtl.freeLoc(o))}}return r},this.ConvertBuiltIn_ConcatString=function(e,t){var s,i=null,r=null,n=null,l=0;if(s=e.Params,1===rtl.length(s))i=this.ConvertExpression(s[0],t);else{i=null,r=this.ConvertExpression(s[0],t),n=this.CreateCallExpression(e);try{n.FExpr=this.CreateDotNameExpr(s[0],r,"concat");for(var a=1,o=rtl.length(s)-1;a<=o;a++)l=a,n.AddArg(this.ConvertExpression(s[l],t));i=n}finally{null===i&&(n=rtl.freeLoc(n))}}return i},this.ConvertBuiltIn_CopyArray=function(e,t){var s=null,i=null,r=Ue.$new(),n=Ue.$new(),l=null,a=null,o=null,h=null,u=null,c=null,p=!1;s=null,u=t.Resolver,o=null;try{i=e.Params[0],u.ComputeElement(e,r,{},null),p=!1,2===r.BaseType&&r.LoTypeEl.$class.ClassType()===ft?(h=r.LoTypeEl,u.ComputeElement(u.GetArrayElType(h),n,rtl.createSet(4),null),p=u.IsManagedJSType(h)):35===r.BaseType&&(n.$assign(r),n.BaseType=n.SubType,n.SubType=0),a=null,2===n.BaseType?(l=(c=n.LoTypeEl).$class.ClassType())===Me?a=this.CreateReferencePathExpr(c,t,!1,null):l===Ae&&2===c.ObjKind&&0===c.InterfaceType&&(a=this.CreateLiteralString(e,this.GetBIName(123))):34===n.BaseType&&(a=this.CreateLiteralString(e,this.GetBIName(111))),null===a&&(a=this.CreateLiteralNumber(e,0)),(o=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(2)]),o.AddArg(a),o.AddArg(this.ConvertExpression(i,t)),1===rtl.length(e.Params)?o.AddArg(this.CreateLiteralNumber(e,0)):o.AddArg(this.ConvertExpression(e.Params[1],t)),rtl.length(e.Params)>=3&&o.AddArg(this.ConvertExpression(e.Params[2],t)),s=o,p&&(s=this.CreateIntfRef(s,t,e))}finally{null===s&&(o=rtl.freeLoc(o))}return s},this.ConvertBuiltIn_InsertArray=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=null,o=Ue.$new(),h=null,u=!1;s=null,n=t.Resolver,r=null;try{(r=this.CreateElement(_t,e)).FLHS=this.ConvertExpression(e.Params[1],t),i=this.CreateCallExpression(e),r.FExpr=i,i.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(5)]),l=e.Params[0],a=this.ConvertExpression(l,t),u=!1,n.ComputeElement(l,o,{},null),2===o.BaseType&&(h=o.LoTypeEl,u=n.IsManagedJSType(h),h.$class.ClassType()),i.AddArg(a),i.AddArg(this.ConvertExpression(e.Params[1],t)),i.AddArg(this.ConvertExpression(e.Params[2],t)),u&&i.AddArg(this.CreateLiteralJSString(e,this.GetBIName(123))),s=r}finally{null===s&&(r=rtl.freeLoc(r))}return s},this.ConvertBuiltIn_DeleteArray=function(e,t){var s,i=null,r=null,n=null,l=null,a=Ue.$new(),o=null;if(i=null,l=t.Resolver,s=e.Params[0],l.ComputeElement(s,a,{},null),l.IsManagedJSType(a.LoTypeEl)){o=null;try{(o=this.CreateElement(_t,e)).FLHS=this.ConvertExpression(s,t),n=this.CreateCallExpression(e),o.FExpr=n,n.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(3)]),n.AddArg(this.ConvertExpression(s,t)),n.AddArg(this.ConvertExpression(e.Params[1],t)),n.AddArg(this.ConvertExpression(e.Params[2],t)),i=o}finally{null===i&&(o=rtl.freeLoc(o))}}else{n=null;try{n=this.CreateCallExpression(e),r=this.ConvertExpression(e.Params[0],t),n.FExpr=this.CreateDotNameExpr(e,r,"splice"),n.AddArg(this.ConvertExpression(e.Params[1],t)),n.AddArg(this.ConvertExpression(e.Params[2],t)),i=n}finally{null===i&&(n=rtl.freeLoc(n))}}return i},this.ConvertBuiltIn_TypeInfo=function(e,t){var s,i=null,r=Ue.$new(),n=null,l=null,a=null;return i=null,s=e.Params[0],(a=t.Resolver).ComputeElement(s,r,rtl.createSet(1),null),31===r.BaseType&&qe.isPrototypeOf(r.IdentEl)&&(n=r.IdentEl.GetFT().ResultEl,a.ComputeResultElement(n,r,{},null),r.Flags=rtl.includeSet(r.Flags,0),r.IdentEl=n),null===(l=is(r.HiTypeEl))?this.RaiseNotSupported(e,t,20170413001544,""):Oe.isPrototypeOf(r.IdentEl)?i=this.CreateTypeInfoRef(r.IdentEl,t,s):!(0 in r.Flags)||l.$class.ClassType()!==Ae&&l.$class.ClassType()!==Tt||!Be.isPrototypeOf(r.IdentEl)&&r.IdentEl.$class.ClassType()!==Ye&&r.IdentEl.$class.ClassType()!==ze?i=this.CreateTypeInfoRef(l,t,s):(i=this.ConvertExpression(s,t),i=this.CreateDotNameExpr(e,i,this.GetBIName(145))),i},this.ConvertBuiltIn_GetTypeKind=function(e,t){var s=null,i=null,r=null;s=null,(i=t.Resolver).BI_GetTypeKind_OnEval(i.GetBuiltInProcs(29),e,rtl.createSet(0),{get:function(){return r},set:function(e){r=e}});try{Pi.isPrototypeOf(r)||this.RaiseNotSupported(e,t,20200826222729,Ge(r)),s=this.CreateLiteralNumber(e,r.Index)}finally{nt({get:function(){return r},set:function(e){r=e}})}return s},this.ConvertBuiltIn_Assert=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u="",c=null;if(s=null,!(3 in t.ScannerBoolSwitches))return s;a=null,i=this.CreateElement(Cs,e);try{c=e.Params[0],i.FCond=this.CreateUnaryNot(this.ConvertExpression(c,t),c),r=this.CreateElement(yi,c),i.FBTrue=r,l=null,ve.isPrototypeOf(e.FData)&&(a=e.FData,Ft.isPrototypeOf(a.FDeclaration)&&(l=a.FDeclaration),a=null),null!==l&&(a=ve.$create("Create$1"),n=rtl.as(e.GetModule().FData,J),a.SetDeclaration(n.FAssertClass),u=(u=this.CreateReferencePath(n.FAssertClass,t,2,!0,a))+"."+this.GetBIName(25),(h=this.CreateCallExpression(c)).FExpr=this.CreatePrimitiveDotExpr(u,c),h.AddArg(this.CreateLiteralString(c,this.TransformElToJSName(l,t))),r.FA=h,rtl.length(e.Params)>1&&(o=this.CreateElement(fs,e.Params[1]),h.AddArg(o),o.AddElement(this.ConvertExpression(e.Params[1],t)))),null===r.FA&&(rtl.length(e.Params)>1?r.FA=this.ConvertExpression(e.Params[1],t):r.FA=this.CreateLiteralJSString(e.Params[0],"assert failed")),s=i}finally{a=rtl.freeLoc(a),null===s&&(i=rtl.freeLoc(i))}return s},this.ConvertBuiltIn_New=function(e,t){var s,i=null,r=Ue.$new(),n=null,l=null,a=null,o=null,h=null;i=null,s=e.Params[0],(o=t.Resolver).ComputeElement(s,r,{},null),h=null,2===r.BaseType&&(l=r.LoTypeEl).$class.ClassType()===Qe&&(a=o.ResolveAliasType(l.DestType,!0)).$class.ClassType()===Me&&(h=a),null===h&&this.DoError$2(20180425011901,3028,rtl.getResStr(Ee,"sIncompatibleTypesGotExpected"),pe(18,o.GetResolverResultDescription(r,!0),18,"pointer of record"),s),n=O.$create("Create$1",[e,null,t]);try{o.ComputeElement(s,n.LeftResolved,rtl.createSet(1),null),n.RightResolved.$assign(n.LeftResolved),n.RightSide=this.CreateRecordCallNew(e,h,t),i=this.CreateAssignStatement(s,n)}finally{rtl.free(n,"RightSide"),n=rtl.freeLoc(n)}return i},this.ConvertBuiltIn_Dispose=function(e,t){var s,i=null,r=null,n=Ue.$new(),l=null,a=null,o=null,h=null;if(i=null,s=e.Params[0],(r=t.Resolver).ComputeElement(s,n,{},null),o=null,2===n.BaseType&&(l=n.LoTypeEl).$class.ClassType()===Qe&&(a=r.ResolveAliasType(l.DestType,!0)).$class.ClassType()===Me&&(o=a),null===o&&this.DoError$2(20180425012910,3028,rtl.getResStr(Ee,"sIncompatibleTypesGotExpected"),pe(18,r.GetResolverResultDescription(n,!0),18,"pointer of record"),s),!(1 in n.Flags))return null;h=O.$create("Create$1",[e,null,t]);try{r.ComputeElement(s,h.LeftResolved,rtl.createSet(1),null),h.RightResolved.$assign(h.LeftResolved),h.RightSide=this.CreateLiteralNull(e),i=this.CreateAssignStatement(s,h)}finally{rtl.free(h,"RightSide"),h=rtl.freeLoc(h)}return i},this.ConvertBuiltIn_Default=function(e,t){var s=this,i=null;var r,n=Ue.$new(),l=null,a=null,o=0,h=0,u=null;i=null,null===t.Resolver&&this.RaiseInconsistency(20180501011029,e),r=e.Params[0],t.Resolver.ComputeElement(r,n,{},null);var c=n.BaseType;if(15===c||16===c||17===c||18===c)return i=this.CreateLiteralBoolean(e,!1);if(5===c||6===c)return i=this.CreateLiteralJSString(e,"\0");if(7===c||9===c)return i=this.CreateLiteralJSString(e,"");if(c>=19&&c<=Zi){if((l=n.LoTypeEl).$class.ClassType()===it){if(ne.isPrototypeOf(l.FData))return t.Resolver.GetIntegerRange(n.BaseType,{get:function(){return o},set:function(e){o=e}},{get:function(){return h},set:function(e){h=e}}),i=this.CreateLiteralNumber(e,o)}else if(l.$class.ClassType()===rt){a=t.Resolver.EvalRangeLimit(l.RangeExpr,rtl.createSet(0),!0,e);try{var p=a.Kind;return 4===p?i=this.CreateLiteralNumber(e,a.Int):5===p?i=this.CreateLiteralNumber(e,a.UInt):this.RaiseNotSupported(e,t,20180501011646,""),i}finally{nt({get:function(){return a},set:function(e){a=e}})}}this.RaiseNotSupported(e,t,20180501011649,"")}else{if(10===c||11===c)return(i=this.CreateLiteralNumber(e,0)).FValue.FCustomValue="0.0",i;if(14===c)return i=this.CreateLiteralNumber(e,0);if(2===c){if((u=(l=n.LoTypeEl).$class.ClassType())===st)return function(e){var r;r=rtl.getObject(e.Values.Get(0)),i=s.CreateReferencePathExpr(r,t,!1,null)}(l),i;if(u===vt)return i=this.CreateElement(zt,e);if(u===ft)return i=this.CreateArrayInit(l,null,e,t);if(u===Me)return i=this.CreateRecordInit(l,null,e,t);if(u===rt){a=t.Resolver.Eval(l.RangeExpr.Left,rtl.createSet(0),!0);try{i=this.ConvertConstValue(a,t,e)}finally{nt({get:function(){return a},set:function(e){a=e}})}}else if(u===Ae||u===Qe||u===Tt)return i=this.CreateLiteralNull(e)}else if(37===c){if(rt.isPrototypeOf(n.LoTypeEl)){a=t.Resolver.Eval(n.LoTypeEl.RangeExpr.Left,rtl.createSet(0),!0);try{i=this.ConvertConstValue(a,t,e)}finally{nt({get:function(){return a},set:function(e){a=e}})}return i}}else if(34===c)return i=this.CreateElement(zt,e)}return this.DoError$2(20180501011723,3010,rtl.getResStr(Ee,"sXExpectedButYFound"),pe(18,"record",18,t.Resolver.GetResolverResultDescription(n,!1)),r),i},this.ConvertBuiltIn_Debugger=function(e,t){return this.CreateLiteralCustomValue(e,"debugger")},this.ConvertBuiltIn_AWait=function(e,t){var s,i=null,r=null;return 1===rtl.length(e.Params)?i=e.Params[0]:2===rtl.length(e.Params)?i=e.Params[1]:this.RaiseNotSupported(e,t,20200519233919,""),s=this.ConvertExpression(i,t),(r=this.CreateElement(er,e)).FA=s,r},this.ConvertRecordValues=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=Ue.$new(),o=null,h=0,u=[],c=null,p=null,f=null,d=!1,F=null,m=null,C="";s=null,i=t.Resolver,r=_.$create("Create"),d=!1;try{n=null,null!==i?(i.ComputeElement(e,a,{},null),2===a.BaseType&&a.LoTypeEl.$class.ClassType()===Me||this.RaiseNotSupported(e,t,20180429210932,""),n=a.LoTypeEl,s=m=this.CreateRecordCallClone(e,n,null,t),o=this.CreateElement(zt,e),m.AddArg(o)):s=o=this.CreateElement(zt,e),u=e.Fields;for(var S=0,T=rtl.length(u)-1;S<=T;S++)c=u[h=S],l=rtl.as(c.NameExp.FData,ve),f=rtl.as(l.FDeclaration,Be),r.Add(f),F=o.FElements.AddElement(),"["===(C=this.TransformElToJSName(f,t)).charAt(0)&&(C="]"===C.charAt(C.length-1)?ue(C,2,C.length-2):ue(C,2,C.length-1)),F.FName=C,F.FExpr=this.CreateValInit(f.VarType,c.ValueExp,c.NameExp,t);if(null!==n)for(var y=0,g=n.Members.FCount-1;y<=g;y++)h=y,(p=rtl.getObject(n.Members.Get(h))).$class.ClassType()===Be&&(f=p,rtl.neSet(rtl.intersectSet(rtl.createSet(4,5),f.VarModifiers),{})||r.IndexOf(f)>=0||this.IsElementUsed(f)&&((F=o.FElements.AddElement()).FName=this.TransformElToJSName(f,t),F.FExpr=this.CreateValInit(f.VarType,f.Expr,f,t)));d=!0}finally{r=rtl.freeLoc(r),d||(s=rtl.freeLoc(s))}return s};var y=[null,_i,vi,js,Us,Us,tr,null,Hi,Yi,null,null,null,null,Xs,Ii,sr,ei,Ni,Ai,null,ir,null,null,null,null,null,null];this.ConvertBinaryExpression=function(t,s){var i=this,r=null,n=Ue.$new(),l=Ue.$new();function a(e){i.RaiseNotSupported(t,s,e,Zs(n)+M.ExprKindNames[t.Kind]+Zs(l))}function o(){return 25===n.BaseType&&l.BaseType<=25||25===l.BaseType&&n.BaseType<=25}function h(e,s,r){var n=null;return(n=i.CreateElement(r,t)).FA=e,n.FB=s,i.CreateBitWiseLongword(t,n)}var u,c=null,p=null,f=null,d=null,F=!1,m=null,C={},S={},T=null,g=null,E=null;r=null,T=s.Resolver;var P=t.OpCode;if(1===P)return r=this.ConvertBinaryExpressionMultiAdd(t,s);if(27===P)return r=this.ConvertSubIdentExpression(t,s);if(0===P&&rr.isPrototypeOf(t.Left))return r=this.ConvertInheritedExpr(t.Left,s);u=s.Access,s.Access=0,m=null,f=null,d=null;try{if(f=this.ConvertExpression(t.Left,s),d=this.ConvertExpression(t.Right,s),null!==T&&(S=rtl.refSet(s.CurrentModeSwitches()),C={},t.OpCode in rtl.createSet(14,15)&&(3 in S||(C=rtl.createSet(2))),T.ComputeElement(t.Left,n,rtl.refSet(C),null),C={},t.OpCode in rtl.createSet(14,15)&&!(3 in S)&&(C=30===n.BaseType||T.IsProcedureType(n,!0)?rtl.createSet(2):{}),T.ComputeElement(t.Right,l,rtl.refSet(C),null),null!==(r=this.ConvertBinaryExpressionRes(t,s,n,l,{get:function(){return f},set:function(e){f=e}},{get:function(){return d},set:function(e){d=e}}))))return r;if(null===(p=y[t.OpCode])){var I=t.OpCode;if(22===I){if(m=this.CreateCallExpression(t),g=n.LoTypeEl,E=l.LoTypeEl,Ae.isPrototypeOf(g))if(Ae.isPrototypeOf(E)){var R=g.ObjKind;if(1===R){var v=E.ObjKind;if(1===v)l.LoTypeEl.IsExternal?m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(14),t):m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(13),t);else if(2===v){var A=E.InterfaceType;if(0===A)return m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(55),t),m.AddArg(f),m.AddArg(d),r=m=this.CreateIntfRef(m,s,t);1===A?m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(46),t):this.RaiseNotSupported(t,s,20180401225752,"")}else a(20180327214535)}else if(2===R){var N=E.ObjKind;1===N?m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(38),t):2===N?0===g.InterfaceType?m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(39),t):m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(13),t):a(20180327214545)}else a(20180327214559)}else Tt.isPrototypeOf(E)&&(m.FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(13),t));return m.AddArg(f),m.AddArg(d),r=m}if(11===I){if(null!==T){if(F=n.BaseType in e.btAllJSInteger||l.BaseType in e.btAllJSInteger){if(n.BaseType in rtl.createSet(28,27)&&l.BaseType in rtl.createSet(28,27))return(m=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(16)]),m.AddArg(f),m.AddArg(d),r=m;if(o())return r=h(f,d,Wi)}}else F=3===this.GetExpressionValueType(t.Left,s)||3===this.GetExpressionValueType(t.Right,s);p=F?Wi:Ks}else if(12===I){if(null!==T){if(F=n.BaseType in e.btAllJSInteger||l.BaseType in e.btAllJSInteger){if(n.BaseType in rtl.createSet(28,27)||l.BaseType in rtl.createSet(28,27))return(m=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(17)]),m.AddArg(f),m.AddArg(d),r=m;if(o())return r=h(f,d,nr)}}else F=3===this.GetExpressionValueType(t.Left,s)||3===this.GetExpressionValueType(t.Right,s);p=F?nr:wi}else if(13===I){if(null!==T){if(F=n.BaseType in e.btAllJSInteger||l.BaseType in e.btAllJSInteger){if(n.BaseType in rtl.createSet(28,27)||l.BaseType in rtl.createSet(28,27))return(m=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(20)]),m.AddArg(f),m.AddArg(d),r=m;if(o())return r=h(f,d,lr)}}else F=3===this.GetExpressionValueType(t.Left,s)||3===this.GetExpressionValueType(t.Right,s);p=lr}else 7===I?p=ar:null===p&&this.DoError$2(20161024191244,4004,rtl.getResStr(e,"sBinaryOpcodeNotSupported"),pe(18,M.OpcodeStrings[t.OpCode]),t)}if(null===r&&null!==p)if((c=this.CreateElement(p,t)).FA=f,f=null,c.FB=d,d=null,r=c,5===t.OpCode&&(r=this.CreateTruncFloor(t,r,!0)),14 in s.ScannerBoolSwitches&&null!==T){var x=t.OpCode;1===x||2===x?(n.BaseType in e.btAllJSOverflowAddSubType||l.BaseType in e.btAllJSOverflowAddSubType)&&(r=this.CreateOverflowCheckCall(r,t)):3===x&&(n.BaseType in e.btAllJSOverflowMultType||l.BaseType in e.btAllJSOverflowMultType)&&(r=this.CreateOverflowCheckCall(r,t))}}finally{s.Access=u,null===r&&(f=rtl.freeLoc(f),d=rtl.freeLoc(d))}return r},this.ConvertBinaryExpressionRes=function(t,s,i,r,n,l){var a=this,o=null,h=null;function u(e){a.RaiseNotSupported(t,s,e,Zs(i)+M.ExprKindNames[t.Kind]+Zs(r))}function c(){var e=null;return(e=a.CreateCallExpression(t)).FExpr=a.CreateMemberExpression([a.GetBIName(144),a.GetBIName(66)]),e.AddArg(n.get()),n.set(null),e.AddArg(l.get()),l.set(null),15===t.OpCode?a.CreateUnaryNot(e,t):e}function p(e){var i=null;i=a.CreateArrayConcat$1(e,t,s,!1),o=i,i.AddArg(n.get()),n.set(null),i.AddArg(l.get()),l.set(null),h.IsManagedJSType(e)&&(o=a.CreateIntfRef(o,s,t))}var f="",d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=Ue.$new(),E=0,P=0,I=null;if(o=null,h=s.Resolver,C=i.LoTypeEl,S=r.LoTypeEl,i.BaseType in rtl.createSet(34,36)&&r.BaseType in rtl.createSet(34,36)){var R=t.OpCode;return 1===R?f=this.GetBIName(113):2===R?f=this.GetBIName(103):3===R?f=this.GetBIName(108):23===R?f=this.GetBIName(112):14===R?f=this.GetBIName(104):15===R?f=this.GetBIName(110):19===R?f=this.GetBIName(106):18===R?f=this.GetBIName(109):this.DoError$2(20170209151300,4004,rtl.getResStr(e,"sBinaryOpcodeNotSupported"),pe(18,M.OpcodeStrings[t.OpCode]),t),(d=this.CreateCallExpression(t)).FExpr=this.CreateMemberExpression([this.GetBIName(144),f]),d.AddArg(n.get()),n.set(null),d.AddArg(l.get()),l.set(null),o=d}if(20===t.OpCode&&r.BaseType in rtl.createSet(34,36))return es.isPrototypeOf(n.get())&&3===n.get().FValue.FValueType||(j(n),n.set(this.CreateSetLiteralElement(t.Left,s))),(F=this.CreateElement(or,t)).FA=n.get(),n.set(null),F.FB=l.get(),l.set(null),o=F;if(1===t.OpCode&&2===i.BaseType&&i.LoTypeEl.$class.ClassType()===ft)return p(i.LoTypeEl),o;if(1===t.OpCode&&2===r.BaseType&&r.LoTypeEl.$class.ClassType()===ft)return p(r.LoTypeEl),o;if(1===t.OpCode&&35===i.BaseType)return It(g,i.SubType,i.LoTypeEl,i.HiTypeEl,t.Left,rtl.refSet(i.Flags)),d=this.CreateArrayConcat(Ue.$clone(g),t,s,!1),o=d,h.IsManagedJSType(i.LoTypeEl)&&(o=this.CreateIntfRef(o,s,t)),d.AddArg(n.get()),n.set(null),d.AddArg(l.get()),l.set(null),o;if(t.OpCode in rtl.createSet(9,8)){if(i.BaseType in rtl.createSet(28,27)){if(this.IsLiteralInteger(l.get(),{get:function(){return P},set:function(e){P=e}})){if(P>=54)return o=this.CreateLiteralNumber(t,0),j(n),j(l),o;if(P<=0)return o=n.get(),n.set(null),j(l),o;if(this.IsLiteralInteger(n.get(),{get:function(){return E},set:function(e){E=e}})){if((E=9===t.OpCode?rtl.shl(E,P):rtl.shr(E,P))>=0&&E<=9007199254740991)return n.get().FValue.SetAsNumber(E),o=n.get(),j(l),o}else if(8===t.OpCode)return o=this.CreateTruncFloor(t,this.CreateDivideNumber(t,n.get(),rtl.shl(1,P)),!1),n.set(null),j(l),o}return d=this.CreateCallExpression(t),o=d,9===t.OpCode?d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(18)]):d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(19)]),d.AddArg(n.get()),n.set(null),d.AddArg(l.get()),l.set(null),o}if(25===i.BaseType)return y=9===t.OpCode?Yi:Hi,(o=this.CreateElement(y,t)).FA=n.get(),n.set(null),o.FB=l.get(),l.set(null),o=this.CreateBitWiseLongword(t,o)}else if(14===i.BaseType||14===r.BaseType){var v=t.OpCode;if(1===v||2===v||14===v||15===v||16===v||17===v||18===v||19===v){var A=t.OpCode;return 1===A?y=_i:2===A?y=vi:14===A?y=Xs:15===A?y=Ii:16===A?y=sr:17===A?y=ei:18===A?y=Ni:19===A&&(y=Ai),o=this.CreateElement(y,t),14!==i.BaseType&&n.set(this.CreateMulNumber(t,n.get(),1e4)),o.FA=n.get(),n.set(null),14!==r.BaseType&&l.set(this.CreateMulNumber(t,l.get(),1e4)),o.FB=l.get(),l.set(null),14 in s.ScannerBoolSwitches&&t.OpCode in rtl.createSet(1,2)&&(o=this.CreateOverflowCheckCall(o,t)),o}if(3===v)return(o=this.CreateElement(js,t)).FA=n.get(),n.set(null),o.FB=l.get(),l.set(null),14===i.BaseType&&14===r.BaseType&&(o=this.CreateDivideNumber(t,o,1e4)),14 in s.ScannerBoolSwitches&&(o=this.CreateOverflowCheckCall(o,t)),o;if(4===v)return(o=this.CreateElement(Us,t)).FA=n.get(),n.set(null),o.FB=l.get(),l.set(null),14===i.BaseType&&14===r.BaseType&&(o=this.CreateMulNumber(t,o,1e4)),o=this.CreateTruncFloor(t,o,!0);7===v?(14===i.BaseType&&n.set(this.CreateDivideNumber(t,n.get(),1e4)),14===r.BaseType&&l.set(this.CreateDivideNumber(t,l.get(),1e4)),(d=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr("Math.pow",t),d.AddArg(n.get()),n.set(null),d.AddArg(l.get()),l.set(null),o=this.CreateMulNumber(t,d,1e4),o=this.CreateTruncFloor(t,o,!0)):this.RaiseNotSupported(t,s,20180422104215,"")}else if(29===i.BaseType||2===i.BaseType&&C.$class.ClassType()===Qe){var N=t.OpCode;14===N||15===N||this.DoError$2(20180423114054,3084,rtl.getResStr(Ee,"sIllegalQualifierAfter"),pe(18,M.OpcodeStrings[t.OpCode],18,h.GetResolverResultDescription(i,!0)),t)}else if(29===r.BaseType||2===r.BaseType&&S.$class.ClassType()===Qe){var x=t.OpCode;14===x||15===x||this.DoError$2(20180423114246,3085,rtl.getResStr(Ee,"sIllegalQualifierInFrontOf"),pe(18,M.OpcodeStrings[t.OpCode],18,h.GetResolverResultDescription(r,!0)),t)}else{if(21===t.OpCode){if(d=this.CreateCallExpression(t),o=d,d.AddArg(n.get()),n.set(null),m=Oe.isPrototypeOf(r.IdentEl)?h.ResolveAliasType(r.IdentEl,!0):null,Tt.isPrototypeOf(m)&&(j(l),m=h.ResolveAliasType(m.DestType,!0),l.set(this.CreateReferencePathExpr(m,s,!1,null))),1===i.BaseType)d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(57)]),d.AddArg(l.get()),l.set(null),Ae.isPrototypeOf(S)?d.AddArg(this.CreateLiteralNumber(t.Right,1)):Tt.isPrototypeOf(S)?d.AddArg(this.CreateLiteralNumber(t.Right,2)):u(20180119005904);else if(Ae.isPrototypeOf(S)&&S.IsExternal)d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(57)]),d.AddArg(l.get()),l.set(null);else if(Tt.isPrototypeOf(C))d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(56)]),d.AddArg(l.get()),l.set(null);else{if(Ae.isPrototypeOf(C)&&Ae.isPrototypeOf(S)){var b=C.ObjKind;if(1===b){var O=S.ObjKind;if(1===O);else{if(2===O){var k=S.InterfaceType;return 0===k?(d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(54)]),d.AddArg(l.get()),l.set(null)):1===k?(d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(46)]),d.AddArg(l.get()),l.set(null),T=this.CreateElement(Ii,t),o=T,T.FA=d,T.FB=this.CreateLiteralNull(t)):this.RaiseNotSupported(t,s,20180401225502,M.InterfaceTypeNames[S.InterfaceType]),o}u(20180327210501)}}else if(2===b){var $=S.ObjKind;if(1===$)return d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(48)]),d.AddArg(l.get()),l.set(null),o;if(2===$){if(0===C.InterfaceType)return d.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(49)]),d.AddArg(l.get()),l.set(null),o}else u(20180327210741)}else u(20180327210251)}d.FExpr=this.CreateDotNameExpr(t,l.get(),"isPrototypeOf"),l.set(null)}return o}if(t.OpCode in rtl.createSet(14,15)){if(h.IsProcedureType(i,!0)){if(30===r.BaseType);else if(h.IsProcedureType(r,!0)||h.IsJSBaseType$1(r,1,!0))return c()}else if(h.IsProcedureType(r,!0)){if(30===i.BaseType);else if(h.IsJSBaseType$1(i,1,!0))return c()}else if(30===i.BaseType){if(2===r.BaseType&&(S=r.LoTypeEl).$class.ClassType()===ft)return j(n),o=this.CreateCmpArrayWithNil(t,l.get(),t.OpCode),l.set(null),o}else if(i.BaseType in U.btAllStrings){if(2===r.BaseType)if((S=r.LoTypeEl).$class.ClassType()===Me){if(h.IsTGUID(S))return(d=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(41),t),d.AddArg(n.get()),n.set(d),(d=this.CreateCallExpression(t)).FExpr=this.CreateDotNameExpr(t,l.get(),this.GetBIName(78)),l.set(null),d.AddArg(n.get()),n.set(null),o=15===t.OpCode?this.CreateUnaryNot(d,t):d}else S.$class.ClassType()===Ae&&2===S.ObjKind&&l.set(this.CreateDotNameExpr(t.Left,l.get(),this.GetBIName(120)))}else if(2===i.BaseType)if((C=i.LoTypeEl).$class.ClassType()===Me){if(2===r.BaseType){if((S=r.LoTypeEl).$class.ClassType()===Me)return(d=this.CreateCallExpression(t)).FExpr=this.CreateDotNameExpr(t,n.get(),this.GetBIName(78)),n.set(null),d.AddArg(l.get()),l.set(null),o=15===t.OpCode?this.CreateUnaryNot(d,t):d;if(S.$class.ClassType()===Ae&&2===S.ObjKind&&h.IsTGUID(C))return(d=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(45),t),d.AddArg(l.get()),l.set(d),(d=this.CreateCallExpression(t)).FExpr=this.CreateDotNameExpr(t,n.get(),this.GetBIName(78)),n.set(null),d.AddArg(l.get()),l.set(null),o=15===t.OpCode?this.CreateUnaryNot(d,t):d}else if(r.BaseType in U.btAllStrings&&h.IsTGUID(C))return(d=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(41),t),d.AddArg(l.get()),l.set(d),(d=this.CreateCallExpression(t)).FExpr=this.CreateDotNameExpr(t,n.get(),this.GetBIName(78)),n.set(null),d.AddArg(l.get()),l.set(null),o=15===t.OpCode?this.CreateUnaryNot(d,t):d}else if(C.$class.ClassType()===Ae){if(r.BaseType in U.btAllStrings)2===C.ObjKind&&n.set(this.CreateDotNameExpr(t.Left,n.get(),this.GetBIName(120)));else if(2===r.BaseType&&(S=r.LoTypeEl).$class.ClassType()===Me&&2===C.ObjKind&&h.IsTGUID(S))return(d=this.CreateCallExpression(t)).FExpr=this.CreatePrimitiveDotExpr(this.GetBIName(144)+"."+this.GetBIName(45),t),d.AddArg(n.get()),n.set(d),(d=this.CreateCallExpression(t)).FExpr=this.CreateDotNameExpr(t,l.get(),this.GetBIName(78)),l.set(null),d.AddArg(n.get()),n.set(null),o=15===t.OpCode?this.CreateUnaryNot(d,t):d}else if(C.$class.ClassType()===ft){if(I=C,30===r.BaseType)return j(l),o=this.CreateCmpArrayWithNil(t,n.get(),t.OpCode),n.set(null),o;rtl.length(I.Ranges)>0&&h.RaiseMsg(20200508102656,3081,rtl.getResStr(Ee,"sXIsNotSupported"),pe(18,"compare static array"),t)}if(h.IsJSBaseType$1(i,1,!1)||h.IsJSBaseType$1(r,1,!1))return(o=14===t.OpCode?this.CreateElement(Xi,t):this.CreateElement(Ki,t)).FA=n.get(),n.set(null),o.FB=l.get(),l.set(null),o}}return o},this.ConvertBinaryExpressionMultiAdd=function(t,s){var i,r=null,n=null,l=null,a=null,o=null,h=null,u=Ue.$new(),c=Ue.$new(),p=Ue.$new(),f={},d=null;for(r=null,n=s.Resolver,l=t;l.$class.ClassType()===Je&&1===(a=l).OpCode;)(l=a.Left).FParent!==a&&(null!==n?this.RaiseNotSupported(a,s,20210321220458,""):null===l.FParent?l.SetParent(a):this.RaiseNotSupported(a,s,20210321221135,""));l===t&&this.RaiseNotSupported(t,s,20210321221047,""),i=s.Access,s.Access=0,o=null,h=null;try{for(o=this.ConvertExpression(l,s),f={},null!==n&&n.ComputeElement(l,u,rtl.refSet(f),null);;){if(a=l.FParent,h=this.ConvertExpression(a.Right,s),null!==n){if(n.ComputeElement(a.Right,c,rtl.refSet(f),null),null!==(r=this.ConvertBinaryExpressionRes(a,s,u,c,{get:function(){return o},set:function(e){o=e}},{get:function(){return h},set:function(e){h=e}}))&&(o=null,h=null,a===t))return r;n.ComputeBinaryExprRes(a,p,rtl.refSet(f),u,c)}if(null===r){if((d=this.CreateElement(_i,a)).FA=o,o=null,d.FB=h,h=null,r=d,14 in s.ScannerBoolSwitches&&null!==n){var F=t.OpCode;1===F||2===F?(u.BaseType in e.btAllJSOverflowAddSubType||c.BaseType in e.btAllJSOverflowAddSubType)&&(r=this.CreateOverflowCheckCall(r,a)):3===F&&(u.BaseType in e.btAllJSOverflowMultType||c.BaseType in e.btAllJSOverflowMultType)&&(r=this.CreateOverflowCheckCall(r,a))}if(a===t)return r}o=r,r=null,null!==n&&u.$assign(p),l=a}}finally{s.Access=i,null===r&&(o=rtl.freeLoc(o),h=rtl.freeLoc(h))}return r},this.ConvertSubIdentExpression=function(e,t){var s,i,r=null,n=null;return n=t.Resolver,r=e.Right,si.isPrototypeOf(r)&&(r=r.NameExpr),r.$class.ClassType()!==_e&&this.RaiseNotSupported(r,t,20190131162250,"Left="+Ge(e.Left)+" right="+Ge(r)),ve.isPrototypeOf(r.FData)||this.RaiseNotSupported(r,t,20190131162301,""),i=(s=r.FData).FDeclaration,n.IsTObjectFreeMethod(r)?this.ConvertTObjectFree_Bin(e,r,t):n.IsExternalClassConstructor(i)?(je.isPrototypeOf(e.FParent)&&e.FParent.Value===e&&this.RaiseNotSupported(e,t,20190116135818,""),this.ConvertExternalConstructor(e.Left,s,null,t)):this.ConvertSubIdentExprCustom(e,t,null,null)},this.ConvertSubIdentExprCustom=function(e,t,s,i){var r,n=0,l=null,a=null,o=null,h=null,u=Ue.$new(),c=null,p=null,f=null;if(h=t.Resolver,c=e.Right,si.isPrototypeOf(c)&&(c=c.NameExpr),c.$class.ClassType()!==_e&&this.RaiseNotSupported(c,t,20190131164529,""),ve.isPrototypeOf(c.FData)||this.RaiseNotSupported(c,t,20190131164530,""),(p=(r=c.FData).FDeclaration).$class.ClassType()===xe){var d=t.Access;1===d?null===(p=h.GetPasPropertySetter(p))&&this.DoError$2(20190211111137,3059,rtl.getResStr(Ee,"sNoMemberIsProvidedToAccessProperty"),[],c):0===d&&null===(p=h.GetPasPropertyGetter(p))&&this.DoError$2(20190211111038,3059,rtl.getResStr(Ee,"sNoMemberIsProvidedToAccessProperty"),[],c)}else if(p.$class.ClassType()===ns)return this.ConvertIdentifierExpr(c,"",t);if(1===t.Access&&h.IsClassField(p))return l=this.CreateReferencePathExpr(p.FParent,t,!1,null),this.CreateDotNameExpr(e,l,this.TransformElToJSName(p,t));if(Se.isPrototypeOf(p)&&(f=p,!h.ProcHasSelf(f)))return null!=s?s(c,t,i):this.ConvertIdentifierExpr(c,c.Value,t);if(l=null,h.IsHelper(p.FParent)){if(Be.isPrototypeOf(p)&&!(1 in p.VarModifiers))return null!=s?s(c,t,i):this.ConvertIdentifierExpr(c,c.Value,t);if(Se.isPrototypeOf(p)){if(!(f=p).IsExternal())return 2 in r.Flags?this.CreateReferencePathExpr(p,t,!1,null):this.CreateCallHelperMethod(f,e,t,!1)}else this.RaiseNotSupported(e,t,20190131170119,Ge(p))}if(null===l){if(null!==h?h.ComputeElement(e.Left,u,{},null):u.$assign(Ue.$new()),3===u.BaseType)return null!=s?s(c,t,i):this.ConvertIdentifierExpr(c,c.Value,t);n=t.Access,t.Access=0,null===(l=this.ConvertExpression(e.Left,t))&&this.RaiseNotSupported(e,t,20190116110446,""),t.Access=n}o=b.$create("Create$1",[e,l,t]),a=null;try{if(o.LeftResolved.$assign(u),a=null!=s?s(c,o,i):this.ConvertIdentifierExpr(c,c.Value,o),null!==o.JS)return l=null,a=null,o.JS}finally{null===a&&o.JSElement===l&&(l=rtl.freeLoc(l)),o=rtl.freeLoc(o)}return es.isPrototypeOf(a)?(l=rtl.freeLoc(l),a):this.CreateDotExpression(e,l,a,!0)},this.ConvertBoolConstExpression=function(e,t){return this.CreateLiteralBoolean(e,e.Value)},this.ConvertPrimitiveExpression=function(t,s){var i=null;function r(e){var t="",s=0;if(s=1,"$"===(t=e).charAt(0))for(;s<t.length;)"0"!==t.charAt(s-1)||!(t.charCodeAt(s+1-1)in rtl.createSet(null,48,57,null,65,70,null,97,102))||1!==s&&t.charCodeAt(s-1-1)in rtl.createSet(null,48,57,null,65,70,null,97,102)?s+=1:Ji({get:function(){return t},set:function(e){t=e}},s,1);else for(;s<t.length;)"0"!==t.charAt(s-1)||!(t.charCodeAt(s+1-1)in rtl.createSet(null,48,57))||1!==s&&t.charCodeAt(s-1-1)in rtl.createSet(46,null,48,57)?s+=1:Ji({get:function(){return t},set:function(e){t=e}},s,1);return t}var n=null,l=0,a=0,o=0,h=0,u="";i=null;var c=t.Kind;if(2===c)null!==s.Resolver?i=this.CreateLiteralJSString(t,s.Resolver.ExtractPasStringLiteral(t,t.Value)):(u=Zt(t.Value,"'"),i=this.CreateLiteralString(t,u));else if(3===c)i=this.CreateLiteralJSString(t,kt(t.Value));else if(1===c){var p=t.Value.charAt(0);if(p>="0"&&p<="9")hr(t.Value,{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}}),0!==a&&this.DoError$2(20161024191248,4005,rtl.getResStr(e,"sInvalidNumber"),pe(18,t.Value),t),(n=this.CreateLiteralNumber(t,l)).FValue.FCustomValue=r(t.Value);else if("$"===p||"&"===p||"%"===p){ur(t.Value,{get:function(){return h},set:function(e){h=e}},{get:function(){return o},set:function(e){o=e}}),0!==o&&this.DoError$2(20161024224442,4005,rtl.getResStr(e,"sInvalidNumber"),pe(18,t.Value),t),(l=h)!==h&&this.DoError$2(20161024230812,4005,rtl.getResStr(e,"sInvalidNumber"),pe(18,t.Value),t),n=this.CreateLiteralNumber(t,l),u=r(t.Value),u=ue(u,2,u.length);var f=t.Value.charAt(0);"$"===f?u="0x"+u:"&"===f?u=0===this.FGlobals.TargetProcessor?"":"0o"+u:"%"===f&&(u=0===this.FGlobals.TargetProcessor?"":"0b"+u),n.FValue.FCustomValue=u}else this.DoError$2(20161024223232,4005,rtl.getResStr(e,"sInvalidNumber"),pe(18,t.Value),t);i=n}else 0===c?i=this.ConvertIdentifierExpr(t,t.Value,s):this.RaiseNotSupported(t,s,20161024222543,"");return i},this.ConvertIdentifierExpr=function(t,s,i){var r=this,n=null,l=null,a=null;function o(e){var s=null,l=Ue.$new(),o=null,h=!1;s=null,Se.isPrototypeOf(e)?s=e.ProcType:(i.Resolver.ComputeElement(t,l,rtl.createSet(1),null),At.isPrototypeOf(l.LoTypeEl)?s=l.LoTypeEl:r.RaiseNotSupported(t,i,20170217005025,"")),h=!1,Xe.isPrototypeOf(s)&&!s.GetIsAsync()&&i.Resolver.IsManagedJSType(s.ResultEl.ResultType)&&(h=!0),o=null;try{r.CreateProcedureCall({get:function(){return o},set:function(e){o=e}},null,s,i),null!==a&&(null===o.FArgs&&(o.FArgs=r.CreateElement(vs,s)),o.InsertArg(0,a),a=null,b.isPrototypeOf(i)&&(i.JS=o)),o.FExpr=n,h&&(o=r.CreateIntfRef(o,i,t)),n=o}finally{n!==o&&(o=rtl.freeLoc(o),a=rtl.freeLoc(a))}}function h(){var e=null;null!==l&&Me.isPrototypeOf(l.LeftResolved.LoTypeEl)&&(e=r.CreateCallExpression(t),l.Call=e,e.FExpr=r.CreateDotNameExpr(t,n,r.GetBIName(75)),e.AddArg(l.RightSide),l.RightSide=null,n=e)}var u,p,f=null,d="",F=null,m=null,C=null,S=null,T=null,y=null,g=null,E=null,P=null,I=null,R=null;if(n=null,!ve.isPrototypeOf(t.FData))return null!==i.Resolver?this.RaiseIdentifierNotFound(s,t,20161024191306):n=this.CreateIdentifierExpr$1(s,!0,t,i),n;if(E=i.Resolver,f=(u=t.FData).FDeclaration,E.IsExternalClassConstructor(f))return n=this.ConvertExternalConstructor(null,u,null,i);if(E.IsExternalBracketAccessor(f)&&this.DoError$2(20180511154132,4025,rtl.getResStr(e,"sCantCallExtBracketAccessor"),[],t),rtl.neSet(rtl.intersectSet(rtl.createSet(3,4),u.Flags),{}))return F=this.CreateFreeOrNewInstanceExpr(u,i),n=F,(S=f.ProcType).Args.FCount>0&&(f.FParent.$class.ClassType()===Me?this.CreateProcedureCallArgs(F.FArgs.FElements,null,S,i):(T=this.CreateElement(fs,t),this.CreateProcedureCallArgs(T.FElements,null,S,i),F.AddArg(T))),n;if(null!==u.WithExprScope&&E.IsTObjectFreeMethod(t))return n=this.ConvertTObjectFree_With(t,i);if(C=null,l=null,a=null,p=1 in u.Flags,1===i.Access&&(l=rtl.as(i.AccessContext,O)),f.$class.ClassType()===Ye)return n=this.CreateArgumentAccess(f,i,t),p&&o(f),n;if(f.$class.ClassType()===xe){C=f;var v=i.Access;if(1===v){if(null!==l.Call&&this.RaiseNotSupported(t,i,20170206000310,""),f=E.GetPasPropertySetter(C),Se.isPrototypeOf(f))return E.IsHelperMethod(f)?n=this.CreateCallHelperMethod(f,t,i,!1):((F=this.CreateCallExpression(t)).FExpr=this.CreateReferencePathExpr(f,i,!1,u),n=this.AppendPropertyAssignArgs(F,C,l,t))}else if(0===v){if(n=this.CreatePropertyGet(C,t,i,t),us.isPrototypeOf(n))return n;if(!p)return n}else this.RaiseNotSupported(t,i,20170213212623,"")}if(E.IsClassField(f)&&i.Access in rtl.createSet(1,2))return I=this.CreateReferencePathExpr(f.FParent,i,!1,null),n=this.CreateDotNameExpr(t,I,this.TransformElToJSName(f,i)),h(),n;if(f.$class.ClassType()===be){if(f.IsConst&&null!==f.Expr){if(null!==(g=E.Eval(f.Expr,rtl.createSet(0),!0)))try{if(g.Kind in rtl.createSet(2,3,4,5,6,9))return n=this.ConvertConstValue(g,i,t)}finally{nt({get:function(){return g},set:function(e){g=e}})}if(1 in f.VarModifiers)return n=this.ConvertExpression(f.Expr,i),h(),n}}else{if(f.$class.ClassType()===cr)return F=this.CreateCallExpression(t),n=F,F.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(33)]),F.AddArg(this.CreatePrimitiveDotExpr(this.TransformModuleName(f.GetModule(),!0,i),t)),F.AddArg(this.CreateLiteralString(t,this.TransformElToJSName(f,i))),n;if(E.IsHelperMethod(f)&&!(2 in u.Flags))return n=this.CreateCallHelperMethod(f,t,i,!1);if(Ti.isPrototypeOf(f.FData)){var A=(m=f.FData).BuiltIn;if(5===A)n=this.ConvertBuiltInBreak(t,i);else if(6===A)n=this.ConvertBuiltInContinue(t,i);else if(7===A)n=this.ConvertBuiltIn_Exit(t,i);else if(0===A){"Debugger"===m.FElement.FName?n=this.ConvertBuiltIn_Debugger(t,i):this.RaiseNotSupported(t,i,20181126102554,"built in custom proc "+m.FElement.FName)}else this.RaiseNotSupported(t,i,20161130164955,"built in proc "+U.ResolverBuiltInProcNames[m.BuiltIn]);return null===n&&this.RaiseInconsistency(20170214120048,f),n}}try{if(Ze.isPrototypeOf(f))d=this.TransformModuleName(f,!0,i);else if(ze.isPrototypeOf(f))d=U.ResolverResultVar,R=rtl.as(f.FParent.FParent,Se),null!==(y=rtl.as(R.FData,c)).ImplProc&&(y=rtl.as(y.ImplProc.FData,c)),""!==y.ResultVarName&&(d=y.ResultVarName);else if(f.$class.ClassType()===ns){if(this.GetUseEnumNumbers())return n=this.CreateLiteralNumber(t,rtl.as(f.FParent,st).Values.IndexOf(f));d=this.CreateReferencePath(f,i,2,!0,null)}else f.$class.ClassType()===Ye?d=this.TransformArgName(f,i):Se.isPrototypeOf(f)?(R=f,d=10 in this.FOptions&&E.IsSpecializedNonStaticMethod(R.ProcType)?function(e,s){var n,l;return n=r.CreateStaticProcPath(e,i)+".apply",l=r.CreateReferencePath(e,i,0,!1,s),b.isPrototypeOf(i)?(a=i.JSElement,i.JSElement=null,""!==l&&(a=r.CreateDotNameExpr(t,a,l))):(""===l&&r.RaiseNotSupported(t,i,20201101022637,""),a=r.CreatePrimitiveDotExpr(l,t)),null===a&&r.RaiseNotSupported(t,i,20201101021136,""),n}(R,u):this.CreateReferencePath(f,i,2,!1,u)):d=this.CreateReferencePath(f,i,2,!1,u);if(""===d&&this.RaiseNotSupported(t,i,20180509134804,Ge(f)),null===n){if("["===d.charAt(0)&&"]"===d.charAt(d.length-1)&&b.isPrototypeOf(i)&&null!==i.JSElement)return p&&this.RaiseNotSupported(t,i,20180509134951,d),P=this.CreateElement(os,t),i.JS=P,P.FMExpr=i.JSElement,n=this.CreateLiteralCustomValue(t,ue(d,2,d.length-2)),P.FName=n,n;n=this.CreatePrimitiveDotExpr(d,t)}p&&o(f),h()}finally{a=rtl.freeLoc(a)}return n},this.ConvertUnaryExpression=function(t,s){var i=this,r=null;function n(r){var n=Ue.$new();null!==s.Resolver?(s.Resolver.ComputeElement(t.Operand,n,{},t),i.DoError$2(r,3085,rtl.getResStr(Ee,"sIllegalQualifierInFrontOf"),pe(18,M.OpcodeStrings[t.OpCode],18,s.Resolver.GetResolverResultDescription(n,!1)),t)):i.DoError$2(r,4003,rtl.getResStr(e,"sUnaryOpcodeNotSupported"),pe(18,M.OpcodeStrings[t.OpCode]),t)}function l(e){return e.$class.ClassType()===Me?(r=i.ConvertExpression(t.Operand,s),!0):false}var a=null,o=null,h=Ue.$new(),u=!1,c=!1,p=null,f=null;p=s.Resolver,r=null,a=null;var d=t.OpCode;if(1===d)o=this.ConvertExpression(t.Operand,s),(a=this.CreateUnaryPlus(o,t)).FA=o;else if(2===d)o=this.ConvertExpression(t.Operand,s),(a=this.CreateElement(pr,t)).FA=o;else if(10===d)if(o=this.ConvertExpression(t.Operand,s),u=!0,null!==p?(p.ComputeElement(t.Operand,h,{},null),u=h.BaseType in e.btAllJSInteger,c=25===h.BaseType):c=!1,u){if((a=this.CreateElement(fr,t)).FA=o,c)return this.CreateBitWiseLongword(t,a)}else a=this.CreateUnaryNot(o,t);else if(24===d){if(null===p&&n(20180423162321),p.ComputeElement(t.Operand,h,rtl.createSet(1),null),31===h.BaseType){if(Se.isPrototypeOf(h.IdentEl))return r=this.CreateCallback(t.Operand,Ue.$clone(h),!1,s)}else if(2===h.BaseType&&(f=h.LoTypeEl).$class.ClassType()===Me)return r=this.ConvertExpression(t.Operand,s)}else if(25===d){if(null===p&&n(20180423162350),p.ComputeElement(t.Operand,h,rtl.createSet(1),null),29===h.BaseType){if(l(f=h.LoTypeEl))return r}else if(2===h.BaseType&&(f=h.LoTypeEl).$class.ClassType()===Qe&&l(p.ResolveAliasType(f.DestType,!0)))return r}else if(26===d)return r=this.ConvertExpression(t.Operand,s);return null===a&&n(20180423162324),r=a},this.ConvertInlineSpecializeExpr=function(e,t){return this.ConvertExpression(e.NameExpr,t)},this.ConvertElement=function(e,t){var s=null,i=null;return null===e&&(s=null,this.RaiseInconsistency(20161024190203,e)),(i=e.$class.ClassType())===be?s=this.ConvertConst(e,t):i===xe?s=this.ConvertProperty(e,t):i===Be?s=this.ConvertVariable(e,t):i===cr?s=this.ConvertResString(e,t):i===zs?s=this.ConvertExportSymbol(e,t):i===dr?s=this.ConvertLabels(e,t):i===Fr?s=this.ConvertLabelMark(e,t):i.InheritsFrom(He)?s=this.ConvertExpression(e,t):i.InheritsFrom(ls)?s=this.ConvertDeclarations(e,t):i.InheritsFrom(Se)?s=this.ConvertProcedure(e,t):i.InheritsFrom(Ke)?s=this.ConvertImplBlock(e,t):i===mr?s=this.ConvertImplCommand(e,t):i.InheritsFrom(Ze)?s=this.ConvertModule(e,t):i===Cr?s=this.ConvertPackage(e,t):(s=null,this.RaiseNotSupported(e,t,20161024190449,"")),s},this.ConvertProperty=function(e,t){return null!==e.DispIDExpr&&this.RaiseNotSupported(e.DispIDExpr,t,20170215103029,"property dispid expression"),null},this.ConvertConst=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=null,o=null,h=null;return s=null,null!==e.AbsoluteExpr||1 in e.VarModifiers||(t.IsGlobal?A.isPrototypeOf(t)?((r=rtl.as(t.JSElement,zt).FElements.AddElement()).FName=this.TransformElToJSName(e,t),r.FExpr=this.CreateVarInit(e,t)):(s=i=this.CreateElement(_t,e),i.FLHS=this.CreateSubDeclNameExpr(e,t,null),i.FExpr=this.CreateVarInit(e,t)):(n=t.GetGlobalFunc(),Gt.isPrototypeOf(n.JSElement)||this.RaiseNotSupported(e,t,20170220153216,""),o=n.JSElement,null===(l=this.ConvertVariable(e,t))&&this.RaiseInconsistency(20180501114422,e),(a=this.CreateElement(Kt,e)).FA=l,this.AddToSourceElements(o,a),6 in this.FOptions&&null!==t.Resolver&&null!==(h=t.Resolver.GetTopLvlProc(t.PasElement))&&h.FData.AddGlobalJS(this.CreatePrecompiledJS(a)))),s},this.ConvertDeclarations=function(e,s){var i,r,n,l,o,h=this,u=null,p=null,f=null,d=null,F=null,m=null,C=null,S="",T=null,y=!1;function g(e,t){A.isPrototypeOf(s)||(s.IsGlobal&&Gt.isPrototypeOf(s.JSElement)?h.AddToSourceElements(s.JSElement,e):(h.AddToStatementList({get:function(){return p},set:function(e){p=e}},{get:function(){return f},set:function(e){f=e}},e,t),u=p))}function E(t){var i=null,r=null,n=null,l=null;i=s.Resolver.Eval(t.Expr,rtl.createSet(0),!0),null===T&&e.$class.ClassType()===Le&&(l=rtl.as(s.GetRootContext(),I),T=l.ResourceStrings),null===T&&((T=h.CreateElement(ms,e)).FName=h.GetBIName(136)+"."+h.GetBIName(142),y=!0,r=h.CreateElement(zt,e),T.FInit=r,(l=s.GetContextOfType(I)).ResourceStrings=T),(n=T.FInit.FElements.AddElement()).FName=h.TransformElToJSName(t,s),r=h.CreateElement(zt,t),n.FExpr=r,(n=r.FElements.AddElement()).FName=h.GetBIName(143),n.FExpr=h.ConvertConstValue(i,s,t),nt({get:function(){return i},set:function(e){i=e}})}function P(e,t){var i=0,r=null,n=null,l=null,a=null;a=s.Resolver;for(var o=0,u=e.FCount-1;o<=u;o++)if(i=o,r=rtl.getObject(e.Get(i)),h.IsElementUsed(r))if((n=r.$class.ClassType())===Ae||n===Me||n===st){if(n===Ae){if(r.IsForward)continue;if(!a.IsFullySpecialized(r))continue}else if(n===Me&&!a.IsFullySpecialized(r))continue;h.CreateGlobalAliasNull(r,132,t),n!==Ae&&n!==Me||P(r.Members,t)}else if(n.InheritsFrom(Se)){if((l=r).IsForward()||l.IsAbstract()||l.IsExternal())continue;if(null===l.FData.SpecializedFromItem)continue;if(!a.IsFullySpecialized$1(l))continue;h.CreateGlobalAliasNull(r,131,t)}}var R,x,b,O,k,$,D,L,B,M=null,G=null,w=0,V=null,J=null,j=null;u=null,r=(i=ke.isPrototypeOf(e)&&null!==e.Body)&&Xe.isPrototypeOf(e.FParent.ProcType),n=i&&di.isPrototypeOf(e.Body),l=i&&e.FParent.$class.ClassType()===Ft,o=r&&!n,null!==s.Resolver&&ct.isPrototypeOf(e)&&(R=e,b=null,O=null,k=null,x=rtl.as(R.FData,a),s.ScannerBoolSwitches=rtl.refSet(x.BoolSwitches),s.ScannerModeSwitches=rtl.refSet(x.ModeSwitches),N.isPrototypeOf(s)||h.RaiseNotSupported(R,s,20200606142828,Ge(s)),b=s,O=rtl.as(b.JSElement,Gt),b.HeaderIndex=O.FStatements.GetCount(),10 in h.FOptions&&R.$class.ClassType()!==Le&&(P(R.Declarations,s),Et.isPrototypeOf(R)&&null!==(k=R.FParent.ImplementationSection)&&P(k.Declarations,s))),p=null,f=null,C=null,S="",T=null,y=!1;try{o&&(L=null,B=null,L=rtl.as(e.FParent,Se),B=rtl.as(L.ProcType,Xe),C=B.ResultEl,D=rtl.as(L.FData,c),null!==C&&null!==C.ResultType||(L=D.DeclarationProc,B=rtl.as(L.ProcType,Xe),C=B.ResultEl),S=""!==D.ResultVarName?D.ResultVarName:U.ResolverResultVar,g(h.CreateVarStatement(S,h.CreateValInit(C.ResultType,null,C,s),C),C),u=p);for(var H=0,W=e.Declarations.FCount-1;H<=W;H++)if(w=H,V=rtl.getObject(e.Declarations.Get(w)),this.IsElementUsed(V)){if(M=null,(J=V.$class.ClassType())===be)M=this.ConvertConst(V,s);else if(J===Be)M=this.CreateVarDecl(V,s);else if(J.InheritsFrom(Oe))M=this.CreateTypeDecl(V,s);else if(J.InheritsFrom(Se)){if((d=V).IsForward())continue;if(null!==(F=d.FData).DeclarationProc&&!F.DeclarationProc.IsForward())continue;null!==F.DeclarationProc&&(d=F.DeclarationProc),M=this.ConvertProcedure(d,s)}else{if(J===cr){ct.isPrototypeOf(e)||this.RaiseNotSupported(V,s,20171004185348,""),E(V);continue}if(J===li)continue;if(J===zs)continue;this.RaiseNotSupported(rtl.as(V,Sr),s,20161024191434,"")}g(M,V)}i&&((m=e.Body).Elements.FCount>0||n)&&(G=this.ConvertElement(m,s),v.isPrototypeOf(s)&&((j=s).BodySt=G,this.AddInterfaceReleases(j,m),j.ResultNeedsIntfRelease&&this.AddInterfaceRelease_Result(j,S,m),G=j.BodySt),g(G,m)),o?($=null,($=h.CreateElement(Ns,C)).FExpr=h.CreatePrimitiveDotExpr(S,C),g($,C)):l&&function(){var i=null,r=null,n=null,l=null,a=null;(i=h.CreateElement(Ns,e)).FExpr=h.CreateElement(Li,e),null!==s.Resolver&&(l=e.FParent,F=rtl.as(l.FData,c),(a=rtl.as(F.ClassRecScope.FElement,Ne)).$class.ClassType()===Ae&&null!==a.HelperForType&&(r=s.Resolver.ResolveAliasType(a.HelperForType,!0),Ne.isPrototypeOf(r)||((n=h.CreateCallExpression(e)).FExpr=h.CreateDotExpression(e,i.FExpr,h.CreatePrimitiveDotExpr(t.TempRefObjGetterName,e),!1),i.FExpr=n))),g(i,e)}(),null!==T&&(y&&g(T,e),T=null)}finally{T=rtl.freeLoc(T)}return u},this.ConvertExportSymbol=function(e,t){return this.RaiseNotSupported(e,t,20161024192650,""),null},this.ConvertExpression=function(e,t){var s,i=null;return i=null,(s=e.$class.ClassType())===Qt?i=this.ConvertUnaryExpression(e,t):s===Je?i=this.ConvertBinaryExpression(e,t):s===_e?i=this.ConvertPrimitiveExpression(e,t):s===qt?i=this.ConvertBoolConstExpression(e,t):s===pt?i=this.ConvertNilExpr(e,t):s===rr?i=this.ConvertInheritedExpr(e,t):s===je?i=this.ConvertParamsExpr(e,t):s===Re?i=this.ConvertProcedure(e.Proc,t):s===_s?i=this.ConvertRecordValues(e,t):s===qs?i=this.ConvertArrayValues(e,t):s===si?i=this.ConvertInlineSpecializeExpr(e,t):this.RaiseNotSupported(e,t,20161024191314,""),i},this.ConvertImplBlock=function(e,t){var s=null;return s=null,Tr.isPrototypeOf(e)?s=this.ConvertStatement(e,t):e.$class.ClassType()===yr?s=this.ConvertIfStatement(e,t):e.$class.ClassType()===gr?s=this.ConvertRepeatStatement(e,t):e.$class.ClassType()===Er?s=this.ConvertBeginEndStatement(e,t,!0):e.$class.ClassType()===Pr?s=this.ConvertInitializationSection(e.FParent,t):e.$class.ClassType()===Ir?s=this.ConvertFinalizationSection(e,t):e.$class.ClassType()===Qi?s=this.ConvertTryStatement(e,t):e.$class.ClassType()===Rr?s=this.ConvertCaseOfStatement(e,t):this.RaiseNotSupported(e,t,20161024192156,""),s},this.ConvertImplCommand=function(e,t){return""!==e.Command&&this.RaiseNotSupported(e,t,20181013224809,e.Command),yr.isPrototypeOf(e.FParent)||this.RaiseNotSupported(e,t,20181013224929,Ge(e.FParent)),null},this.ConvertLabelMark=function(e,t){return this.RaiseNotSupported(e,t,20161024192857,""),null},this.ConvertLabels=function(e,t){return this.RaiseNotSupported(e,t,20161024192701,""),null},this.ConvertModule=function(e,t){var s,i=null,n=null,l=null,a=null,o=null,h=null,u=null,c=null,p="",f="",d=null,F=null,m=!1,C=!1,S=null,T=null,y=null,g=null,E=null;i=null,E=null!==t.Resolver?rtl.as(e.FData,r):null,s=this.CreateElement(Gt,e),i=s,d=null,C=!1;try{l=this.CreateCallExpression(e),this.AddToSourceElements(s,l),l.FExpr=this.CreateMemberExpression([this.GetBIName(144),"module"]),o=l.FArgs,l.FArgs=o,p=this.TransformModuleName(e,!1,t),o.FElements.AddElement().FExpr=this.CreateLiteralString(e,p),c=null,c=et.isPrototypeOf(e)?e.ProgramSection:tt.isPrototypeOf(e)?e.LibrarySection:e.InterfaceSection,o.FElements.AddElement().FExpr=this.CreateUsesList(c,t),h=this.CreateFunctionSt(e,!0,!0),o.AddElement(h),n=rtl.as(h.FFuncDef.FBody.FA,Gt),3 in this.FOptions&&this.AddToSourceElements(n,this.CreateLiteralString(e,"use strict")),(9 in this.FOptions||8 in this.FOptions&&this.IsSystemUnit(e))&&((a=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(22)]),a.AddArg(this.CreateLiteralNumber(e,this.FGlobals.RTLVersion)),this.AddToSourceElements(n,a)),F=null,(d=e.$class.ClassType()===Ze?x.$create("Create$1",[e,n,t]):N.$create("Create$1",[e,n,t])).ThisVar.Element=e,d.ThisVar.Kind=1,J.isPrototypeOf(e.FData)&&(d.ScannerBoolSwitches=rtl.refSet(e.FData.BoolSwitches)),f=this.GetBIName(136),d.AddLocalVar(f,e,1,!1),this.AddToSourceElements(n,this.CreateVarStatement(f,this.CreatePrimitiveDotExpr("this",e),e)),null!==E&&this.RestoreImplJSLocals(E,d),et.isPrototypeOf(e)?(null!=(S=e).ProgramSection&&this.AddToSourceElements(n,this.ConvertDeclarations(S.ProgramSection,d)),m=this.AddDelayedInits(S,n,d),this.CreateInitSection(S,n,d)):tt.isPrototypeOf(e)?(null!=(T=e).LibrarySection&&this.AddToSourceElements(n,this.ConvertDeclarations(T.LibrarySection,d)),m=this.AddDelayedInits(T,n,d),this.CreateInitSection(T,n,d)):(g=d,null!=e.ImplementationSection&&(F=this.CreateVarStatement(this.GetBIName(124),this.CreateMemberExpression([f,this.GetBIName(124)]),e),this.AddToSourceElements(n,F),g.AddLocalVar(this.GetBIName(124),e.ImplementationSection,1,!1)),null!=e.InterfaceSection&&this.AddToSourceElements(n,this.ConvertDeclarations(e.InterfaceSection,g)),u=this.CreateImplementationSection(e,g),(y=this.CreateElement(_t,e)).FLHS=this.CreateMemberExpression([f,this.GetBIName(125)]),y.FExpr=u,this.AddToSourceElements(n,y),this.CreateInitSection(e,n,g),u.FFuncDef.FBody.FA.FStatements.GetCount()>0?m=!0:(this.RemoveFromSourceElements(n,F),this.RemoveFromSourceElements(n,y),m=null!==e.ImplementationSection&&rtl.length(e.ImplementationSection.UsesClause)>0),m&&o.AddElement(this.CreateUsesList(e.ImplementationSection,t))),null!==E&&6 in this.FOptions&&this.StoreImplJSLocals(E,d),tt.isPrototypeOf(e)?(T=e,this.AddRTLRun(T,p,s,t),this.CreateExportsSection(T,s,t)):et.isPrototypeOf(e)&&this.FGlobals.TargetPlatform in rtl.createSet(1,3)&&this.AddRTLRun(e,"",s,t),C=!0}finally{d=rtl.freeLoc(d),C||j({get:function(){return i},set:function(e){i=e}})}return i},this.ConvertPackage=function(e,t){return this.RaiseNotSupported(e,t,20161024192555,""),null},this.ConvertProcedure=function(t,s){var i=this,r=null,n=null,a=null,o=null;function h(e,t){i.AddToStatementList({get:function(){return a},set:function(e){a=e}},{get:function(){return o},set:function(e){o=e}},e,t),n.FA=a}function u(e,t,s){var r;r=i.CreateArgumentAccess(e,s,e),h(i.CreateRangeCheckCall_TypeRange(t,r,s,e),e)}var c,p,f,d,F=null,m=0,C=0,S=0,T=0,y=null,g=null,E=null,P=null,I=null,R=null,A=null,N=null,x=null,b=null,O=null,k="",$="",D=Ue.$new(),L=null,B=null,M=null,G=null,w=null,V=0,U=null;if(r=null,t.IsAbstract())return r;if(t.IsExternal())return r;if(null!==(p=t.FData).DeclarationProc)return r;if(d=t.$class.ClassType()===ri||t.$class.ClassType()===ni,!(w=s.Resolver).IsFullySpecialized$1(t))return r;if(N=t,null!==p.ImplProc&&(N=p.ImplProc),null!==(U=(I=N.FData).ImplJS)){if(Ie.UnmangleSourceLineNumber(t.SourceLinenumber,{get:function(){return S},set:function(e){S=e}},{get:function(){return T},set:function(e){T=e}}),null!==U.GlobalJS){P=s.GetGlobalFunc(),Gt.isPrototypeOf(P.JSElement)||this.RaiseNotSupported(t,s,20180228231008,""),B=P.JSElement;for(var J=0,j=U.GlobalJS.GetCount()-1;J<=j;J++)C=J,(L=es.$create("Create$1",[S,T,t.SourceFilename])).FValue.FCustomValue=kt(U.GlobalJS.Get(C)),this.AddToSourceElements(B,L)}return 10 in this.FOptions&&this.CreateGlobalAlias_List(U.ShortRefs,s),(L=es.$create("Create$1",[S,T,t.SourceFilename])).FValue.FCustomValue=kt(U.BodyJS),r=L}6 in this.FOptions&&null!==w&&w.ProcCanBePrecompiled(t)&&(U=l.$create("Create"),I.ImplJS=U),y=null,s.IsGlobal&&(r=y=this.CreateElement(_t,N),y.FLHS=this.CreateSubDeclNameExpr(t,s,N),10 in this.FOptions&&""!==($=s.GetLocalName(t,rtl.createSet(1)))&&(g=this.CreateElement(_t,N),y.FExpr=g,(y=g).FLHS=this.CreatePrimitiveDotExpr($,t))),(F=(c=this.CreateFunctionSt(N,null!==N.Body,!1)).FFuncDef).FIsAsync=t.IsAsync()||N.IsAsync(),null!==y?y.FExpr=c:(r=c,""===t.FName||d||(F.FName=this.TransformElToJSName(t,s)));for(var H=0,W=t.ProcType.Args.FCount-1;H<=W;H++)m=H,R=rtl.getObject(t.ProcType.Args.Get(m)),F.FTypedParams.AddParam(this.TransformElToJSName(R,s));if(null!==(f=N.Body)){null===(x=f)&&(x=N),n=F.FBody,E=v.$create("Create$1",[N,F.FBody,s]);try{if(E.ScannerBoolSwitches=rtl.refSet(I.BoolSwitches),a=null,o=null,null!==p.ClassRecScope&&(V=0,A=null,s.IsGlobal?t.IsStatic()||d?b=null:(b=p.ClassRecScope.FElement,w.IsHelper(b)?(b=G=w.ResolveAliasType(b.HelperForType,!0),V=Ne.isPrototypeOf(G)?3:4):V=w.IsClassMethod(t)?2:3,A=null!==p.ImplProc?p.ImplProc.FData.SelfArg:p.SelfArg):b=null,E.ThisVar.Element=b,E.ThisVar.Kind=V,null!==b&&(27 in E.ScannerBoolSwitches&&V in rtl.createSet(1,3,2)&&(h(O=this.CreateCallExpression(x),x),O.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(21)]),O.AddArg(this.CreatePrimitiveDotExpr("this",x)),k=this.CreateReferencePath(p.ClassRecScope.FElement,s,2,!1,null),O.AddArg(this.CreatePrimitiveDotExpr(k,x))),N.Body.Functions.FCount>0||w.HasAnonymousFunctions(N.Body.Body)?(E.AddLocalVar(this.GetBIName(167),b,V,!1),h(this.CreateVarStatement(this.GetBIName(167),this.CreatePrimitiveDotExpr("this",N),N),x),null!==A&&b!==A&&E.AddLocalVar(this.GetBIName(167),A,V,!1)):null!==A&&b!==A&&E.AddLocalVar("this",A,V,!1))),null!==w)for(var Y=0,z=t.ProcType.Args.FCount-1;Y<=z;Y++)C=Y,null!==(R=rtl.getObject(t.ProcType.Args.Get(C))).ArgType&&(w.ComputeElement(R,D,rtl.createSet(4),null),null!==(M=D.LoTypeEl)&&(0===R.Access&&w.IsManagedJSType(M)&&E.Add_InterfaceRelease(R),15 in I.BoolSwitches&&(D.BaseType in e.btAllJSRangeCheckTypes?u(R,M,E):2===D.BaseType?M.$class.ClassType()===st&&u(R,M,E):37===D.BaseType&&(D.SubType in e.btAllJSRangeCheckTypes||2===D.SubType)&&u(R,M,E))));null!==f&&h(this.ConvertDeclarations(f,E),f)}finally{E=rtl.freeLoc(E)}}return null!==U&&(U.BodyJS=this.CreatePrecompiledJS(r),U.EmptyJS=null===f.Body),r},this.ConvertResString=function(e,t){return this.RaiseNotSupported(e,t,20161024192604,""),null},this.ConvertVariable=function(e,t){for(var s=null,i=0,r=0;r<=6;r++)(i=r)in e.VarModifiers&&!(i in rtl.createSet(4,1))&&this.RaiseNotSupported(e,t,20170208141622,"modifier "+M.VariableModifierNames[i]);return null!==e.LibraryName&&this.RaiseNotSupported(e,t,20170208141844,"library name"),null!==e.AbsoluteExpr&&this.RaiseNotSupported(e,t,20170208141926,"absolute"),(s=this.CreateElement(ms,e)).FName=this.TransformElToJSName(e,t),s.FInit=this.CreateVarInit(e,t),s},this.ConvertRecordType=function(e,t){var s=null,i=null,r=null,n=null,l=null,a="",o="",h=null,u=null,c=null,p=0,f=null,d=null,F=null,m=null,C=null,S=null,T=null,y=null,g=!1,E=!1,P=!1,I=null,R=null;if(s=null,""===e.FName&&this.RaiseNotSupported(e,t,20190105101258,"anonymous record"),!(i=t.Resolver).IsFullySpecialized(e))return s;c=null,S=null,T=null,y=null,r=null,n=null,g=!1;try{P=this.SpecializeNeedsDelay(e,t),(l=this.CreateCallExpression(e)).FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(77)]),ke.isPrototypeOf(e.FParent)?(Gt.isPrototypeOf(t.JSElement)||this.RaiseNotSupported(e,t,20190105104054,""),u=t.JSElement,o=this.TransformElToJSName(e,t),I=this.CreateVarStatement(o,l,e),this.AddToSourceElements(u,I),l.AddArg(this.CreateLiteralNull(e)),l.AddArg(this.CreateLiteralString(e,""))):(s=l,""===(a=null===e.FParent||ct.isPrototypeOf(e.FParent)&&e.FParent.$class.ClassType()!==Le?this.GetLocalName(e.GetModule(),rtl.createSet(1),t):this.GetLocalName(e.FParent,rtl.createSet(1),t))&&(a="this"),l.AddArg(this.CreatePrimitiveDotExpr(a,e)),l.AddArg(this.CreateLiteralString(e,this.TransformElToJSName(e,t)))),h=this.CreateFunctionSt(e,!0,!0),l.AddArg(h),u=h.FFuncDef.FBody.FA,(c=v.$create("Create$1",[e,u,t])).IsGlobal=!0,c.ThisVar.Element=e,c.ThisVar.Kind=1,10 in this.FOptions&&!ke.isPrototypeOf(e.FParent)&&(""===(o=t.GetLocalName(e,rtl.createSet(1)))&&this.RaiseNotSupported(e,t,20200926235501,""),6 in this.FOptions&&this.StoreImplJSLocal(e,t),(R=this.CreateElement(_t,e)).FLHS=this.CreatePrimitiveDotExpr(o,e),R.FExpr=this.CreatePrimitiveDotExpr("this",e),this.AddToSourceElements(u,R)),S=_.$create("Create"),T=_.$create("Create"),y=_.$create("Create"),E=!1,P&&(n=this.CreateDelayedInitMembersFunction(e,u,c,{get:function(){return r},set:function(e){r=e}}));for(var A=0,N=e.Members.FCount-1;A<=N;A++)if(p=A,f=rtl.getObject(e.Members.Get(p)),this.IsElementUsed(f)){if(d=f.$class.ClassType(),F=null,d===Be){if(m=f,rtl.neSet(rtl.intersectSet(m.VarModifiers,rtl.createSet(4,5)),{}))E=!0;else if(null!==i){if(T.Add(m),(C=i.ResolveAliasType(m.VarType,!0)).$class.ClassType()===ft){S.Add(m);continue}if(C.$class.ClassType()===Me){S.Add(m);continue}if(C.$class.ClassType()===vt){S.Add(m);continue}}F=this.CreateVarDecl(m,c)}else d===be?(F=this.ConvertConst(f,c),E=!0):d===xe?F=this.ConvertProperty(f,c):d.InheritsFrom(Oe)?(F=this.CreateTypeDecl(f,c),d!==Me&&d!==Ae||(E=!0)):d.InheritsFrom(Se)?d===ri||d===ni?this.AddGlobalClassMethod(c,f):y.Add(f):d===li||this.RaiseNotSupported(f,c,20190105105436,"");null!==F&&(P&&!Se.isPrototypeOf(f)?this.AddToSourceElements(r,F):this.AddToSourceElements(u,F))}E&&l.AddArg(this.CreateLiteralBoolean(e,!0)),S.FCount>0&&this.AddToSourceElements(u,this.CreateRecordFunctionNew(e,c,S)),this.AddToSourceElements(u,this.CreateRecordFunctionEqual(e,c,T)),this.AddToSourceElements(u,this.CreateRecordFunctionAssign(e,c,T));for(var x=0,b=y.FCount-1;x<=b;x++)p=x,f=rtl.getObject(y.Get(p)),F=this.ConvertProcedure(f,c),this.AddToSourceElements(u,F);null!==i&&this.HasTypeInfo(e,c)&&(P?this.CreateRecordRTTI(e,u,c,r,n):this.CreateRecordRTTI(e,u,c,u,c)),g=!0}finally{S=rtl.freeLoc(S),T=rtl.freeLoc(T),y=rtl.freeLoc(y),n=rtl.freeLoc(n),c=rtl.freeLoc(c),g||j({get:function(){return s},set:function(e){s=e}})}return s},this.ConvertClassType=function(t,s){var i=this,r=null,n=!1,l=!1;function a(e){return!!i.IsElementUsed(e)||(!(!n||e.$class.ClassType()!==Se||0!==ye(e.FName,"AfterConstruction")&&0!==ye(e.FName,"BeforeDestruction"))||false)}var o=null,u=null,c=null,p=null,f=null,d=null,F=null,m=null,C=0,S=null,T=null,y=null,g=null,E="",P="",I="",R="",A="",N="",x=null,b=null,O=!1,k=!1,$=!1,D=!1,L=!1,B=!1,G=null;if(r=null,o=s.Resolver,t.ObjKind in rtl.createSet(1,2,3,4,5)||this.RaiseNotSupported(t,s,20170927183645,""),ke.isPrototypeOf(t.FParent)&&this.RaiseNotSupported(t,s,20181231004355,""),!o.IsFullySpecialized(t))return r;if(t.IsForward)return this.ConvertClassForwardType(t,s);if(t.IsExternal)return this.ConvertExtClassType(t,s);n=!1,h.isPrototypeOf(t.FData)?(null!==(y=t.FData).AncestorScope?g=rtl.as(y.AncestorScope.FElement,Oe):(g=null,n=1===t.ObjKind&&lt(t.FName,"TObject")),j({p:y,get:function(){return this.p.MsgIntToProc},set:function(e){this.p.MsgIntToProc=e}}),j({p:y,get:function(){return this.p.MsgStrToProc},set:function(e){this.p.MsgStrToProc=e}}),L=this.SpecializeNeedsDelay(t,s)):(y=null,n=null===t.AncestorType&&1===t.ObjKind&&lt(t.FName,"TObject"),g=t.AncestorType,L=!1),m=null,u=null,c=null,p=this.CreateCallExpression(t);try{if(l=Ae.isPrototypeOf(g)&&g.IsExternal,$=o.IsExternalClass_Name(t,"Function"),(D=l||$)&&1!==t.ObjKind&&this.RaiseNotSupported(t,s,20200627083750,""),R=2===t.ObjKind?this.GetBIName(40):t.ObjKind in M.okAllHelpers?this.GetBIName(29):D?this.GetBIName(28):this.GetBIName(27),p.FExpr=this.CreateMemberExpression([this.GetBIName(144),R]),""===(P=null===t.FParent||ct.isPrototypeOf(t.FParent)&&t.FParent.$class.ClassType()!==Le?s.GetLocalName(t.GetModule(),rtl.createSet(1)):s.GetLocalName(t.FParent,rtl.createSet(1)))&&(P="this"),p.AddArg(this.CreatePrimitiveDotExpr(P,t)),N=this.TransformElToJSName(t,s),F=this.CreateLiteralString(t,N),p.AddArg(F),2===t.ObjKind&&(p.AddArg(this.CreateLiteralString(t,vr(y.GUID))),function(e){var r=null,n=0,l=null;r=i.CreateElement(fs,t),e.AddArg(r);for(var o=0,h=t.Members.FCount-1;o<=h;o++)n=o,l=rtl.getObject(t.Members.Get(n)),Se.isPrototypeOf(l)&&a(l)&&l.$class.ClassType()!==ri&&l.$class.ClassType()!==ni&&r.AddElement(i.CreateLiteralString(l,i.TransformElToJSName(l,s)))}(p)),E=null===g?"null":l?g.ExternalName:this.CreateReferencePath(g,s,2,!1,null),p.AddArg(this.CreatePrimitiveDotExpr(E,t)),D&&(null!==y.NewInstanceFunction?p.AddArg(this.CreateLiteralString(y.NewInstanceFunction,y.NewInstanceFunction.FName)):p.AddArg(this.CreateLiteralString(t,""))),O=!0,B=2 in y.Flags||this.HasTypeInfo(t,s)||o.HasExtRTTI(t),A="",2===t.ObjKind){if(null===y.AncestorScope&&!(4 in this.FOptions)){var w=t.InterfaceType;0===w?A="com":1===w||this.RaiseNotSupported(t,s,20180405093512,"")}O=B||""!==A||10 in this.FOptions}if(O){if(f=this.CreateFunctionSt(t,!0,!0),p.AddArg(f),d=f.FFuncDef.FBody.FA,(m=v.$create("Create$1",[t,d,s])).IsGlobal=!0,m.ThisVar.Element=t,m.ThisVar.Kind=1,10 in this.FOptions&&(""===(N=s.GetLocalName(t,rtl.createSet(1)))&&this.RaiseNotSupported(t,s,20200926232402,""),(b=this.CreateElement(_t,t)).FLHS=this.CreatePrimitiveDotExpr(N,t),b.FExpr=this.CreatePrimitiveDotExpr("this",t),this.AddToSourceElements(d,b)),""!==A&&((b=this.CreateElement(_t,t)).FLHS=this.CreatePrimitiveDotExpr("this."+this.GetBIName(121),t),b.FExpr=this.CreateLiteralString(t,A),this.AddToSourceElements(d,b)),L&&(c=this.CreateDelayedInitMembersFunction(t,d,m,{get:function(){return u},set:function(e){u=e}})),t.ObjKind in rtl.unionSet(rtl.createSet(1),M.okAllHelpers))for(var V=0,U=t.Members.FCount-1;V<=U;V++)if(C=V,a(T=rtl.getObject(t.Members.Get(C)))){if(x=T.$class.ClassType(),S=null,x===Be){if(!rtl.neSet(rtl.intersectSet(rtl.intersectSet(e.ClassVarModifiersType,T.VarModifiers),rtl.createSet(4,5)),{}))continue;if(null===(S=this.CreateVarDecl(T,m)))continue}else if(x===be)S=this.ConvertConst(T,m);else if(x===xe)S=this.ConvertProperty(T,m);else if(x.InheritsFrom(Oe))S=this.CreateTypeDecl(T,m);else{if(x.InheritsFrom(Se))continue;if(x===Ar)continue;if(x===li)continue;this.RaiseNotSupported(T,m,20161221233338,"")}null!==S&&(L&&!Se.isPrototypeOf(T)?this.AddToSourceElements(u,S):this.AddToSourceElements(d,S))}if(t.ObjKind in rtl.createSet(1)&&(this.AddClassConDestructorFunction(t,d,m,n,g,0),this.AddClassConDestructorFunction(t,d,m,n,g,1)),t.ObjKind in rtl.unionSet(rtl.createSet(1),M.okAllHelpers)){k=!1;for(var J=0,H=t.Members.FCount-1;J<=H;J++)if(C=J,a(T=rtl.getObject(t.Members.Get(C)))&&(S=null,x=T.$class.ClassType(),Se.isPrototypeOf(T))){if(G=T,n&&x===Ys)"Destroy"!==(I=this.TransformElToJSName(T,s))&&((b=this.CreateElement(_t,T)).FLHS=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(168)]),b.FExpr=this.CreateLiteralString(T,I),this.AddToSourceElements(d,b));else if(x===Ft)k=!0;else{if(x===ri||x===ni){this.AddGlobalClassMethod(s,G);continue}null!==G.MessageExpr&&null!==o&&o.AddMessageIdToClassScope(G,!1)}null!==(S=this.ConvertProcedure(G,m))&&this.AddToSourceElements(d,S)}k&&null!==t.HelperForType&&this.AddHelperConstructor(t,d,m)}null!==o&&(1===t.ObjKind&&this.AddClassSupportedInterfaces(t,d,m),this.AddClassMessageIds(t,d,m,126),this.AddClassMessageIds(t,d,m,127),B&&(L?this.AddClassRTTI(t,u,c):this.AddClassRTTI(t,d,m)))}(""!==y.JSName&&y.JSName!==t.FName||Ne.isPrototypeOf(t.FParent))&&p.AddArg(this.CreateLiteralString(t,this.GetTypeInfoName(t,s,t,!1))),r=p}finally{m=rtl.freeLoc(m),c=rtl.freeLoc(c),r!==p&&(p=rtl.freeLoc(p))}return r},this.ConvertClassForwardType=function(e,t){var s,i,r,n=null,l=null;return n=null,ke.isPrototypeOf(e.FParent)&&this.RaiseNotSupported(e,t,20181231004420,""),null!==e.GenericTemplateTypes&&e.GenericTemplateTypes.FCount>0?n:null!==t.Resolver&&ve.isPrototypeOf(e.FData)?(s=e.FData,i=rtl.as(s.FDeclaration,Ae),this.IsClassRTTICreatedBefore(i,e,t)?n:this.HasTypeInfo(i,t)?(r=this.GetClassBIName(i,t),n=this.CreateRTTINewType(i,r,!0,t,{get:function(){return l},set:function(e){l=e}}),null!==l&&this.RaiseInconsistency(20170412093427,e),n):n):n},this.ConvertClassOfType=function(e,t){var s=null,i=null,r=null,n=null,l=!1,a=null,o=null;if(s=null,!this.HasTypeInfo(e,t))return s;ke.isPrototypeOf(e.FParent)&&this.RaiseNotSupported(e,t,20181231004435,""),l=!1,n=this.CreateRTTINewType(e,this.GetBIName(86),!1,t,{get:function(){return i},set:function(e){i=e}}),s=n;try{(r=i.FElements.AddElement()).FName=this.GetBIName(148),o=rtl.as(t.Resolver.ResolveAliasType(e.DestType,!0),Ae),r.FExpr=this.CreateTypeInfoRef(o,t,e),this.IsClassRTTICreatedBefore(o,e,t)||(v.isPrototypeOf(t)||this.RaiseNotSupported(e,t,20170412102916,""),n=this.CreateRTTINewType(o,this.GetClassBIName(o,t),!0,t,{get:function(){return i},set:function(e){i=e}}),null!==i&&this.RaiseInconsistency(20170412102654,e),(a=this.CreateElement(Ht,e)).FA=n,a.FB=s,s=a),l=!0}finally{l||j({get:function(){return s},set:function(e){s=e}})}return s},this.ConvertExtClassType=function(e,t){var s,i=null,r=0,n=null,l=null,a=null,o=null,u=null,c=null;if(i=null,e.IsExternal||this.RaiseNotSupported(e,t,20191027183236,""),!t.Resolver.IsFullySpecialized(e))return i;if(!this.HasTypeInfo(e,t))return i;v.isPrototypeOf(t)||this.RaiseNotSupported(e,t,20191027182023,"typeinfo"),ke.isPrototypeOf(e.FParent)&&this.RaiseNotSupported(e,t,20191027182019,""),o=null!==(s=rtl.as(e.FData,h)).AncestorScope?rtl.as(s.AncestorScope.FElement,Ae):null,l=null;try{l=this.CreateRTTINewType(e,this.GetBIName(89),!1,t,{get:function(){return n},set:function(e){n=e}}),null!==o&&((a=n.FElements.AddElement()).FName=this.GetBIName(165),a.FExpr=this.CreateTypeInfoRef(o,t,e)),(a=n.FElements.AddElement()).FName=this.GetBIName(166),a.FExpr=this.CreateLiteralString(e,e.ExternalName),(u=this.CreateElement(Ht,e)).FA=l,i=u;for(var p=0,f=e.Members.FCount-1;p<=f;p++)r=p,c=rtl.getObject(e.Members.Get(r)),Ae.isPrototypeOf(c)&&!c.IsForward&&(u.FB=this.ConvertExtClassType(c,t),u=rtl.as(u.FB,Ht))}finally{null===i&&(l=rtl.freeLoc(l))}return i},this.ConvertEnumType=function(e,t){var s=null,i=null,r=0,n=null,l=null,a=null,o=null,h=null,u=null,c="",p=null,f=null,d=!1,F=0,m=null,C=null,S=null;s=null;for(var T=0,y=e.Values.FCount-1;T<=y;T++)r=T,null!==(n=rtl.getObject(e.Values.Get(r))).Value&&this.RaiseNotSupported(n.Value,t,20170208145221,"enum constant");d=!1,i=null,m=null,p=null,S=null,C=null;try{l=this.CreateElement(zt,e),A.isPrototypeOf(t)?((o=rtl.as(t.JSElement,zt).FElements.AddElement()).FName=this.TransformElToJSName(e,t),o.FExpr=l,s=l):ke.isPrototypeOf(e.FParent)?(c=this.TransformElToJSName(e,t),S=this.CreateVarStatement(c,l,e),Gt.isPrototypeOf(t.JSElement)?(m=t.JSElement,this.AddToSourceElements(m,S),v.isPrototypeOf(t)&&t.AddLocalVar(c,e,1,!1)):s=S):((u=this.CreateElement(_t,e)).FLHS=this.CreateSubDeclNameExpr(e,t,null),u.FExpr=l,s=u,10 in this.FOptions&&(""===(c=t.GetMainSectionContext().GetLocalName(e,rtl.createSet(1)))&&this.RaiseNotSupported(e,t,20200926232620,""),6 in this.FOptions&&this.StoreImplJSLocal(e,t),(u=this.CreateElement(_t,e)).FLHS=this.CreatePrimitiveDotExpr(c,e),u.FExpr=s,s=u)),i=A.$create("Create$1",[e,l,t]);for(var g=0,E=e.Values.FCount-1;g<=E;g++)r=g,n=rtl.getObject(e.Values.Get(r)),c=this.TransformElToJSName(n,t),(o=l.FElements.AddElement()).FName=oe(r),o.FExpr=this.CreateLiteralJSString(e,c),(o=l.FElements.AddElement()).FName=c,o.FExpr=this.CreateLiteralNumber(e,r);null!==m&&null!==(C=this.GetImplJSProcScope(e,m,t))&&C.AddGlobalJS(this.CreatePrecompiledJS(S)),this.HasTypeInfo(e,t)&&(v.isPrototypeOf(t)||this.RaiseNotSupported(e,t,20170411210045,"typeinfo"),F=this.GetOrdType(0,e.Values.FCount-1,e),p=this.CreateRTTINewType(e,this.GetBIName(88),!1,t,{get:function(){return a},set:function(e){a=e}}),(h=a.FElements.AddElement()).FName=this.GetBIName(151),h.FExpr=this.CreateLiteralNumber(e,0),(h=a.FElements.AddElement()).FName=this.GetBIName(150),h.FExpr=this.CreateLiteralNumber(e,e.Values.FCount-1),(h=a.FElements.AddElement()).FName=this.GetBIName(152),h.FExpr=this.CreateLiteralNumber(e,F),(h=a.FElements.AddElement()).FName=this.GetBIName(149),h.FExpr=this.CreateSubDeclNameExpr(e,t,null),null!==m?(this.AddToSourceElements(m,p),null!==C&&C.AddGlobalJS(this.CreatePrecompiledJS(p))):null===s?this.RaiseNotSupported(e,t,20190101130432,""):((f=this.CreateElement(Ht,e)).FA=s,s=f,f.FB=p),p=null),d=!0}finally{p=rtl.freeLoc(p),i=rtl.freeLoc(i),d||j({get:function(){return s},set:function(e){s=e}})}return s},this.ConvertSetType=function(t,s){var i=null,r=null,n=null,l=null;if(i=null,t.IsPacked&&this.DoError$2(20170222231613,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"packed"),t),!this.HasTypeInfo(t,s))return i;ke.isPrototypeOf(t.FParent)&&this.RaiseNotSupported(t,s,20181231112029,""),n=this.CreateRTTINewType(t,this.GetBIName(98),!1,s,{get:function(){return r},set:function(e){r=e}});try{(l=r.FElements.AddElement()).FName=this.GetBIName(163),l.FExpr=this.CreateTypeInfoRef(t.EnumType,s,t),i=n}finally{null===i&&(n=rtl.freeLoc(n))}return i},this.ConvertRangeType=function(e,t){var s=null,i=null,r=null,n=null,l=null,a=0,o=0,h=0,u=null,c=0;if(s=null,!this.HasTypeInfo(e,t))return s;ke.isPrototypeOf(e.FParent)&&this.RaiseNotSupported(e,t,20181231112029,""),n=null,l=null,r=null;try{n=t.Resolver.EvalRangeLimit(e.RangeExpr,rtl.createSet(0),!0,e),l=t.Resolver.EvalRangeLimit(e.RangeExpr,rtl.createSet(0),!1,e),4===n.Kind?(c=90,a=n.Int,o=l.Int):9===n.Kind?(c=88,a=n.Index,o=l.Index):this.RaiseNotSupported(e,t,20170925201628,""),h=this.GetOrdType(a,o,e),r=this.CreateRTTINewType(e,this.GetBIName(c),!1,t,{get:function(){return i},set:function(e){i=e}}),(u=i.FElements.AddElement()).FName=this.GetBIName(151),u.FExpr=this.CreateLiteralNumber(e,a),(u=i.FElements.AddElement()).FName=this.GetBIName(150),u.FExpr=this.CreateLiteralNumber(e,o),(u=i.FElements.AddElement()).FName=this.GetBIName(152),u.FExpr=this.CreateLiteralNumber(e,h),9===n.Kind&&((u=i.FElements.AddElement()).FName=this.GetBIName(149),u.FExpr=this.CreateSubDeclPasNameExpr(e,n.ElType.FName,t,null)),s=r}finally{nt({get:function(){return n},set:function(e){n=e}}),nt({get:function(){return l},set:function(e){l=e}}),null===s&&(r=rtl.freeLoc(r))}return s},this.ConvertTypeAliasType=function(e,t){var s=null,i=null;return s=null,this.HasTypeInfo(e,t)?(ke.isPrototypeOf(e.FParent)&&this.RaiseNotSupported(e,t,20181231112029,""),s=this.CreateRTTINewType(e,this.GetBIName(84),!1,t,{get:function(){return i},set:function(e){i=e}})):s},this.ConvertPointerType=function(e,t){var s=null,i=null,r=null,n=null;if(s=null,!this.HasTypeInfo(e,t))return s;ke.isPrototypeOf(e.FParent)&&this.RaiseNotSupported(e,t,20181231112029,""),r=this.CreateRTTINewType(e,this.GetBIName(93),!1,t,{get:function(){return i},set:function(e){i=e}});try{(n=i.FElements.AddElement()).FName=this.GetBIName(156),n.FExpr=this.CreateTypeInfoRef(e.DestType,t,e),s=r}finally{null===s&&(r=rtl.freeLoc(r))}return s},this.ConvertProcedureType=function(t,s){var i,r=null,n=null,l=null,a="",o=null,h=null,u=0,c=0,p=null,d=null,F=null,m=null,C=null,S=null;if(r=null,!s.Resolver.IsFullySpecialized(t))return r;if(t.GetIsNested()&&this.DoError$2(20170222231636,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"is nested"),t),t.CallingConvention in rtl.createSet(0,6)||this.DoError$2(20170222231532,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"calling convention "+M.cCallingConventions[t.CallingConvention]),t),!this.HasTypeInfo(t,s))return r;ke.isPrototypeOf(t.FParent)&&this.RaiseNotSupported(t,s,20181231112029,""),i=null!==rtl.as(t.FData,f)&&this.SpecializeNeedsDelay(t,s),a=t.GetIsReference()?this.GetBIName(97):t.GetIsOfObject()?this.GetBIName(92):this.GetBIName(95),n=this.CreateRTTINewType(t,a,!1,s,{get:function(){return p},set:function(e){p=e}}),C=null;try{d=p.FElements.AddElement(),l=this.CreateCallExpression(t),i?(d.FName=this.GetBIName(158),F=this.CreateFunctionSt(t,!0,!1),d.FExpr=F,(m=this.CreateElement(_t,t)).FLHS=this.CreatePrimitiveDotExpr("this."+this.GetBIName(159),t),m.FExpr=l,F.FFuncDef.FBody.FA=m,S=C=v.$create("Create$1",[t,m,s])):(S=s,d.FName=this.GetBIName(159),d.FExpr=l),l.FExpr=this.CreateMemberExpression([this.GetBIName(144),this.GetBIName(94)]),l.AddArg(this.CreateRTTIArgList(t,t.Args,S)),Xe.isPrototypeOf(t)&&(o=t.ResultEl,null!==(h=this.CreateTypeInfoRef(o.ResultType,S,o))&&l.AddArg(h)),u=0,3 in t.Modifiers&&(u+=2),5 in t.Modifiers&&(u+=16),6===t.CallingConvention&&(u+=8),u>0&&(Xe.isPrototypeOf(t)||l.AddArg(this.CreateLiteralNull(t)),l.AddArg(this.CreateLiteralNumber(t,u))),t.GetIsOfObject()&&((d=p.FElements.AddElement()).FName=this.GetBIName(155),t.$class.ClassType()===At?c=0:t.$class.ClassType()===Xe?c=1:this.RaiseNotSupported(t,s,20170411180848,""),d.FExpr=this.CreateLiteralNumber(t,c)),r=n}finally{C=rtl.freeLoc(C),null===r&&(n=rtl.freeLoc(n))}return r},this.ConvertArrayType=function(t,s){var i=this,r=null,n=0,l=null,a=null,o=0,h=null,u=null;function c(e){null===l&&(l=i.GetImplJSProcScope(t,a,s)),null!==l&&l.AddGlobalJS(i.CreatePrecompiledJS(e))}function p(){var e,t="";return t=(e=n%52)<26?String.fromCharCode(97+e):String.fromCharCode(65+e),n>=52&&(t+=oe(rtl.trunc(n/52))),n+=1,t}function f(e){var s=null;0===o?i.AddToSourceElements(h,e):null===u.FBody?u.FBody=e:((s=i.CreateElement(Ht,t)).FA=u.FBody,s.FB=e,u.FBody=s)}var d=null,F=null,m="",C=null,S=null,T=null,y=0,g=null,E=null,P=null,I=null,R=null,A=null,N=null,x=null,b=null,O=null,k=null,$="",D="",L="",B="",M="",G="",w=null,V=0,U=!1,J=null;if(r=null,!(d=s.Resolver).IsFullySpecialized(t))return r;if(0!==t.PackMode&&this.DoError$2(20170222231648,4001,rtl.getResStr(e,"sPasElementNotSupported"),pe(18,"packed"),t),l=null,a=null,Gt.isPrototypeOf(s.JSElement)&&(a=s.JSElement),d.HasStaticArrayCloneFunc(t)){A=null,F=null,E=null,k=null;try{n=0,$=p(),D=p(),L="",C=d.ResolveAliasType(t.ElType,!0),(E=this.CreateFunctionSt(t,!0,!0)).FFuncDef.FTypedParams.AddParam($),h=rtl.as(E.FFuncDef.FBody.FA,Gt),(k=v.$create("Create$1",[t,h,s])).IsGlobal=!0,V=rtl.length(t.Ranges)-1,U=it.isPrototypeOf(C)||rt.isPrototypeOf(C)||Ae.isPrototypeOf(C)&&C.ObjKind in rtl.createSet(1),u=null,U&&(V-=1);for(var j=0,H=V;j<=H;j++)if(o=j,S=t.Ranges[o],y=d.GetRangeLength(S),0===o?B=D:(M=B,B=p()),P=this.CreateElement(Kt,t),w=this.CreateElement(ms,t),P.FA=w,w.FName=B,w.FInit=this.CreateElement(fs,t),f(P),o>0&&((F=this.CreateElement(_t,t)).FExpr=w.FInit,w.FInit=F,A=this.CreateElement(os,t),F.FLHS=A,A.FMExpr=this.CreatePrimitiveDotExpr(M,t),A.FName=this.CreatePrimitiveDotExpr(L,t)),(F=this.CreateElement(_t,t)).FLHS=this.CreatePrimitiveDotExpr(B+".length",t),F.FExpr=this.CreateLiteralNumber(t,y),f(F),o>0&&(G=$,$=p(),A=this.CreateElement(os,t),P=this.CreateVarStatement($,A,t),A.FMExpr=this.CreatePrimitiveDotExpr(G,t),A.FName=this.CreatePrimitiveDotExpr(L,t),f(P)),L=p(),f(J=this.CreateElement(ys,t)),(u=J).FInit=this.CreateVarStatement(L,this.CreateLiteralNumber(t,0),t),I=this.CreateElement(sr,t),u.FCond=I,I.FA=this.CreatePrimitiveDotExpr(L,t),I.FB=this.CreateLiteralNumber(t,y),R=this.CreateElement(bi,t),u.FIncr=R,R.FA=this.CreatePrimitiveDotExpr(L,t),o===V){F=this.CreateElement(_t,t),u.FBody=F,A=this.CreateElement(os,t),F.FLHS=A,A.FMExpr=this.CreatePrimitiveDotExpr(B,t),A.FName=this.CreatePrimitiveDotExpr(L,t),(N=this.CreateElement(os,t)).FMExpr=this.CreatePrimitiveDotExpr($,t),N.FName=this.CreatePrimitiveDotExpr(L,t);try{b=null,U?(b=T=this.CreateCallExpression(t),T.FExpr=this.CreateDotNameExpr(t,N,"slice"),T.AddArg(this.CreateLiteralNumber(t,0))):ft.isPrototypeOf(C)?(0===rtl.length(C.Ranges)&&this.RaiseNotSupported(t,k,20180218223414,Ge(C)),b=this.CreateCloneStaticArray(t,C,N,k)):Me.isPrototypeOf(C)?b=this.CreateRecordCallClone(t,C,N,k):vt.isPrototypeOf(C)?b=this.CreateReferencedSet(t,N):this.RaiseNotSupported(t,k,20180218223618,Ge(C)),F.FExpr=b,N=null}finally{N=rtl.freeLoc(N)}}O=this.CreateElement(Ns,t),this.AddToSourceElements(h,O),O.FExpr=this.CreatePrimitiveDotExpr(D,t),m=this.GetOverloadName(t,s)+this.GetBIName(12),ke.isPrototypeOf(t.FParent)?x=this.CreateVarStatement(m,E,t):(x=F=this.CreateElement(_t,t),F.FLHS=this.CreateSubDeclPasNameExpr(t,m,s,null),F.FExpr=E),E=null,null!==a?this.AddToSourceElements(a,x):r=x,c(x),x=null}finally{E=rtl.freeLoc(E),x=rtl.freeLoc(x),k=rtl.freeLoc(k)}}if(!Ne.isPrototypeOf(s.PasElement)&&this.HasTypeInfo(t,s)){T=null;try{T=this.CreateRTTIAnonymousArray(t,s),null!==a?(this.AddToSourceElements(a,T),c(T)):null===r?r=T:((g=this.CreateElement(Ht,t)).FA=r,g.FB=T,r=g),T=null}finally{T=rtl.freeLoc(T)}}return r},this.GetOrdType=function(e,t,s){var i=0,r=0;return e<0?(r=t<-(e+1)?-(e+1):t)<143?i=0:r<36863?i=2:r<2415919103?i=4:r<=9007199254740991?i=6:this.DoError$2(20170925200802,3064,rtl.getResStr(Ee,"sRangeCheckError"),[],s):t<255?i=1:t<65535?i=3:t<4294967295?i=5:t<=9007199254740991?i=7:this.DoError$2(20170925201002,3064,rtl.getResStr(Ee,"sRangeCheckError"),[],s),i},this.Create$1=function(){return this.FOptions=rtl.refSet(e.DefaultPasToJSOptions),this},this.Destroy=function(){this.SetGlobals(null),V.Destroy.call(this)},this.ConvertPasElement=function(e,t){var s=null,i=null,r=null;null===this.FGlobals&&(this.FGlobals=$.$create("Create$1",[this])),null!==t&&null!==t.FCurrentParser&&C.isPrototypeOf(t.FCurrentParser.FScanner)&&(r=t.FCurrentParser.FScanner,this.FOptions=rtl.diffSet(rtl.unionSet(this.FOptions,r.GlobalConvOptsEnabled),r.GlobalConvOptsDisabled)),i=I.$create("Create$1",[e,null,null]);try{i.Resolver=t,s=e.$class.ClassType()===Er?this.ConvertBeginEndStatement(e,i,!1):this.ConvertElement(e,i)}finally{j({get:function(){return i},set:function(e){i=e}})}return s}}),this.CodePointToJSString=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55296+rtl.lw(e-65536>>>10))+String.fromCharCode(56320+(e-65536&1023))},this.PosLast=function(e,t){var s=0;for(s=t.length;s>0&&t.charAt(s-1)!==e;)s-=1;return s},this.JSEquals=function(t,s){var i=!1;if(null===t)return null===s;if(null===s)return!1;if(t.$class.ClassType()!==s.$class.ClassType())return!1;if(t.$class.ClassType()===Vt)return t.FName===s.FName;if(t.$class.ClassType()===Li);else if(t.$class.ClassType()===wt)i=e.JSEquals(t.FMExpr,s.FMExpr)&&t.FName===s.FName;else{if(t.$class.ClassType()!==os)return!1;i=e.JSEquals(t.FMExpr,s.FMExpr)&&t.FName===s.FName}return i},e.$resourcestrings={sPasElementNotSupported:{org:"Pascal element not supported: %s"},sNotSupportedX:{org:"Not supported: %s"},sUnaryOpcodeNotSupported:{org:'Unary OpCode not yet supported "%s"'},sBinaryOpcodeNotSupported:{org:'Binary OpCode not yet supported "%s"'},sInvalidNumber:{org:'Invalid number "%s"'},sInitializedArraysNotSupported:{org:"Initialized array variables not yet supported"},sMemberExprMustBeIdentifier:{org:"Member expression must be an identifier"},sCantWriteSetLiteral:{org:"Cannot write set literal"},sInvalidAbsoluteLocation:{org:"Invalid absolute location"},sForInJSArrDefaultGetterNotExtBracketAccessor:{org:"for-in-JS-array needs as default getter an external bracket accessor"},sMissingExternalName:{org:"Missing external name"},sVirtualMethodNameMustMatchExternal:{org:"Virtual method name must match external"},sInvalidVariableModifier:{org:'Invalid variable modifier "%s"'},sPublishedNameMustMatchExternal:{org:"Published name must match external"},sAWaitOnlyInAsyncProcedure:{org:"await only available in async procedure"},sAsyncFunctionOrPromise:{org:"async function or promise"},sNewInstanceFunctionMustBeVirtual:{org:"NewInstance function must be virtual"},sNewInstanceFunctionMustHaveTwoParameters:{org:"NewInstance function must have two parameters"},sNewInstanceFunctionMustNotHaveOverloadAtX:{org:"NewInstance function must not have overload at %s"},sBracketAccessorOfExternalClassMustHaveOneParameter:{org:"Bracket accessor of external class must have one parameter"},sTypeXCannotBePublished:{org:'Type "%s" cannot be published'},sNestedInheritedNeedsParameters:{org:"nested inherited needs parameters"},sFreeNeedsVar:{org:"Free needs a variable"},sDuplicateGUIDXInYZ:{org:"Duplicate GUID %s in %s and %s"},sCantCallExtBracketAccessor:{org:"cannot call external bracket accessor, use a property instead"},sJSNewNotSupported:{org:'Pascal class does not support the "new" constructor'},sHelperClassMethodForExtClassMustBeStatic:{org:"Helper class method for external class must be static"},sDuplicateMessageIdXAtY:{org:'Duplicate message id "%s" at %s'},sDispatchRequiresX:{org:"Dispatch requires %s"},sConstRefNotForXAsConst:{org:"ConstRef not yet implemented for %s. Treating as Const"}},e.$implcode=function(){t.TempRefObjGetterName="get",t.TempRefObjSetterName="set",t.TempRefObjSetterArgName="v",t.TempRefGetPathName="p",t.TempRefSetPathName="s",t.TempRefParamName="a",t.IdentChars=rtl.createSet(null,48,57,null,65,90,null,97,122,95),t.AwaitSignature2="function await(aType,TJSPromise):aType"}},[]),rtl.module("FPPJsSrcMap",["System","SysUtils","Math","jswriter","jstree","JSSrcMap","fpjson","Pas2JSUtils"],function(){"use strict";var e=pas.JSSrcMap.TSourceMap,t=pas.SysUtils,s=t.Exception,i=pas.jswriter,r=i.TBufferWriter,n=i.TTextWriter,l=pas.jstree,a=l.TJSStatementList,o=l.TJSEmptyBlockStatement,h=l.TJSEmptyStatement,u=t.SameText,c=t.ExtractFileExt,p=l.TJSLiteral,f=pas.System,d=f.TObject,F=f.Copy;rtl.createClass(this,"TPas2JSSrcMap",e,function(){this.$init=function(){e.$init.call(this),this.fRefCount=0,this.LocalFilename=""},this.AddRef=function(){this.fRefCount+=1},this.Release=function(){if(this.fRefCount<0)throw s.$create("Create$1",["TPas2JSSrcMap.Release"]);this.fRefCount-=1,this.fRefCount<0&&this.Free()}}),rtl.createClass(this,"TPas2JSMapper",r,function(){this.$init=function(){r.$init.call(this),this.FOnIsBinary=null,this.FPCUExt="",this.FDestFileName="",this.FSrcMap=null,this.FNeedMapping=!1,this.FGeneratedStartLine=0,this.FSrcFilename="",this.FSrcIsBinary=!1,this.FSrcLine=0,this.FSrcColumn=0},this.$final=function(){this.FOnIsBinary=void 0,this.FSrcMap=void 0,r.$final.call(this)},this.SetSrcMap=function(e){this.FSrcMap!==e&&(null!==this.FSrcMap&&this.FSrcMap.Release(),this.FSrcMap=e,null!==this.FSrcMap&&this.FSrcMap.AddRef())},this.SetCurElement=function(e){var t,s="";n.SetCurElement.call(this,e),(t=e.$class.ClassType())!==a&&t!==o&&t!==h&&(null!==e&&""!==(s=e.FSource)&&(this.FSrcFilename===s&&this.FSrcLine===e.FLine&&this.FSrcColumn===e.FColumn||(this.FNeedMapping=!0,this.SetSrcFilename(s),this.FSrcLine=e.FLine,this.FSrcColumn=e.FColumn)),this.FGeneratedStartLine<1&&(this.FGeneratedStartLine=this.FCurLine))},this.SetSrcFilename=function(e){this.FSrcFilename!==e&&(this.FSrcFilename=e,this.FSrcIsBinary=u(c(e),this.FPCUExt),this.FSrcIsBinary||null==this.FOnIsBinary||(this.FSrcIsBinary=this.FOnIsBinary(this,e)))},this.Writing=function(){var e="",t=0,s=0,i=0,r=0,l=0,a="";if(n.Writing.call(this),null!==this.FSrcMap&&(this.FGeneratedStartLine<1&&(this.FGeneratedStartLine=this.FCurLine),this.FNeedMapping&&""!==this.FSrcFilename&&(this.FSrcIsBinary?(a=this.FDestFileName,r=this.FCurLine,l=this.FCurColumn,this.FSrcLine=this.FCurLine,this.FSrcColumn=1):(a=this.FSrcFilename,r=this.FSrcLine,l=this.FSrcColumn),this.FNeedMapping=!1,this.FSrcMap.AddMapping(this.FCurLine,Math.max(0,this.FCurColumn-1),a,Math.max(0,r),Math.max(0,l-1),""),p.isPrototypeOf(this.FCurElement)&&""!==this.FCurElement.FValue.FCustomValue)))for(s=(e=this.FCurElement.FValue.FCustomValue).length,t=1,i=0;t<=s;){var o=e.charAt(t-1);"\n"===o||"\r"===o?(t<s&&e.charCodeAt(t+1-1)in rtl.createSet(10,13)&&e.charAt(t-1)!==e.charAt(t+1-1)?t+=2:t+=1,i+=1,this.FSrcMap.AddMapping(this.FCurLine+i,0,a,r+i,0,"")):t+=1}},this.Destroy=function(){this.SetSrcMap(null),d.Destroy.call(this)},this.SaveJSToStream=function(e,t,s){var i="",r=0;i=""!==t?"//# sourceMappingURL="+t+f.LineEnding:"";for(var n=0,l=this.GetBufferLength()-1;n<=l;n++)r=n,s.push(this.FBuffer[r]);""!==i&&s.push(i)},this.WriteFile=function(e,t){var s,i=0,r=0;if(""!==e){this.SetSrcFilename(t),this.FSrcLine=1,this.FSrcColumn=1,s=e.length,i=1;do{for(r=i;i<=s;){var n=e.charAt(i-1);if("\n"===n||"\r"===n){i<s&&e.charCodeAt(i+1-1)in rtl.createSet(10,13)&&e.charAt(i-1)!==e.charAt(i+1-1)?i+=2:i+=1;break}i+=1}this.FNeedMapping=!0,this.Write(F(e,r,i-r)),this.FSrcLine+=1}while(!(i>s))}}})}),rtl.module("Pas2jsLogger",["System","JS","Pas2JSUtils","Types","Classes","SysUtils","PasTree","PScanner","jstree","jsbase","jswriter","fpjson"],function(){"use strict";var e=this,t=null,s=null,i=null,r=null,n=pas.System,l=n.TObject,a=n.Writeln,o=pas.SysUtils,h=o.Exception,u=pas.jswriter.TTextWriter,c=o.Trim,p=o.LowerCase,f=pas.Classes.TFPList,d=o.FreeAndNil,F=o.IntToStr,m=pas.PScanner.SafeFormat,C=pas.fpjson.TJSONObject,S=pas.JS.isInteger,T=o.QuotedStr;this.ExitCodeErrorInternal=1,this.ExitCodeErrorInParams=2,this.ExitCodeErrorInConfig=3,this.ExitCodeFileNotFound=4,this.ExitCodeWriteError=5,this.ExitCodeSyntaxError=6,this.ExitCodeConverterError=7,this.DefaultLogMsgTypes=rtl.createSet(null,0,6),rtl.createClass(this,"TPas2jsStream",l,function(){t=this}),rtl.createClass(this,"TPas2jsFileStream",t,function(){s=this,this.Create$1=function(e,t){throw a("TPas2JSFileStream.Create TODO ",e," Mode=",t),h.$create("Create$1",["TPas2JSFileStream.Create"])},this.Destroy=function(){throw a("TPas2JSFileStream.Destroy TODO"),h.$create("Create$1",["TPas2JSFileStream.Destroy"])},this.Write=function(e){throw a('TPas2JSFileStream.Write TODO s="',e,'"'),h.$create("Create$1",["TPas2JSFileStream.Write"])}}),this.fmCreate=65280,this.fmShareDenyNone=64,rtl.createClass(this,"TPas2jsMessage",l,function(){i=this,this.$init=function(){l.$init.call(this),this.Number=0,this.Typ=0,this.Pattern=""}}),rtl.createClass(this,"TConsoleFileWriter",u,function(){r=this,this.Create$2=function(e){return u.Create$1.call(this),this.Write("Opening console log: "+e),this},this.DoWrite=function(e){var t;return t=e.length,this.WriteLn(e),t}}),rtl.createClass(this,"TPas2jsLogger",l,function(){this.$init=function(){l.$init.call(this),this.FDebugLog=null,this.FEncoding="",this.FIndent=0,this.FLastMsgCol=0,this.FLastMsgFile="",this.FLastMsgLine=0,this.FLastMsgNumber=0,this.FLastMsgTxt="",this.FLastMsgType=0,this.FLineLen=0,this.FMsgNumberDisabled=[],this.FMsg=null,this.FOnFormatPath=null,this.FOnLog=null,this.FOutputFile=null,this.FOutputFilename="",this.FShowMsgNumbers=!1,this.FShowMsgTypes={},this.FSorted=!1},this.$final=function(){this.FDebugLog=void 0,this.FMsgNumberDisabled=void 0,this.FMsg=void 0,this.FOnFormatPath=void 0,this.FOnLog=void 0,this.FOutputFile=void 0,this.FShowMsgTypes=void 0,l.$final.call(this)},this.GetMsgCount=function(){return this.FMsg.FCount},this.GetMsgNumberDisabled=function(e){return this.FindMsgNumberDisabled(e,!1)>=0},this.GetMsgs=function(e){return rtl.getObject(this.FMsg.Get(e))},this.FindMsgNumberDisabled=function(e,t){var s=0,i=0,r=0,n=0,l=0;for(i=0,r=rtl.length(this.FMsgNumberDisabled)-1,n=0;i<=r;)if(n=rtl.trunc((i+r)/2),e<(l=this.FMsgNumberDisabled[n]))r=n-1;else{if(!(e>l))return n;i=n+1}return t?(s=n,i>n&&(s+=1)):s=-1,s},this.SetEncoding=function(e){var t;t=c(p(e)),this.FEncoding!==t&&(this.FEncoding=t)},this.SetMsgNumberDisabled=function(e,t){var s,i=0;if(s=rtl.length(this.FMsgNumberDisabled),t){if((i=this.FindMsgNumberDisabled(e,!0))<s&&this.FMsgNumberDisabled[i]===e)return;this.FMsgNumberDisabled=rtl.arrayInsert(e,this.FMsgNumberDisabled,i)}else{if((i=this.FindMsgNumberDisabled(e,!1))<0)return;this.FMsgNumberDisabled.splice(i,1)}},this.SetOutputFilename=function(e){this.FOutputFilename!==e&&(this.CloseOutputFile(),this.FOutputFilename=e,""!==this.FOutputFilename&&this.OpenOutputFile())},this.DoLogRaw=function(e,t){var s="";s=e,null!==this.FDebugLog&&this.DebugLogWriteLn(s),null!==this.FOnLog?this.FOnLog(this,s):null!==this.FOutputFile?this.FOutputFile.Write(s+n.LineEnding):a(s)},this.CreateTextWriter=function(e){return r.$create("Create$2",[e])},this.Create$1=function(){return this.FMsg=f.$create("Create"),this.FShowMsgTypes=rtl.refSet(e.DefaultLogMsgTypes),this.FLineLen=78,this.FIndent=2,this},this.Destroy=function(){var e=0;this.CloseOutputFile(),this.CloseDebugLog();for(var t=0,s=this.FMsg.FCount-1;t<=s;t++)e=t,rtl.getObject(this.FMsg.Get(e)).$destroy("Destroy");d({p:this,get:function(){return this.p.FMsg},set:function(e){this.p.FMsg=e}}),this.FMsgNumberDisabled=[],l.Destroy.call(this)},this.RegisterMsg=function(e,t,s){var r=null;if(0===t)throw h.$create("Create$1",["internal error: TPas2jsLogger.RegisterMsg MsgNumber=0"]);(r=i.$create("Create")).Number=t,r.Typ=e,r.Pattern=s,this.FMsg.Add(r),this.FSorted=!1},this.FindMsg=function(e,t){var s=0,i=0,r=0,n=null;for(this.FSorted||this.Sort(),s=0,i=this.GetMsgCount()-1;s<=i;)if(r=rtl.trunc((s+i)/2),e<(n=this.GetMsgs(r)).Number)i=r-1;else{if(!(e>n.Number))return n;s=r+1}if(t)throw h.$create("Create$1",["invalid message number "+F(e)]);return null},this.Sort=function(){var t=0,s=null,i=null;if(this.FMsg.FCount>1){this.FMsg.Sort(e.CompareP2JMessage),s=rtl.getObject(this.FMsg.Get(0));for(var r=1,n=this.FMsg.FCount-1;r<=n;r++){if(t=r,i=rtl.getObject(this.FMsg.Get(t)),s.Number===i.Number)throw h.$create("Create$1",["duplicate message number "+F(i.Number)+'. 1st="'+s.Pattern+'" 2nd="'+i.Pattern+'"']);s=i}}this.FSorted=!0},this.LogRaw=function(e){this.ClearLastMsg(),this.DoLogRaw(e,!1)},this.LogRaw$1=function(e){this.LogRaw(this.$class.Concatenate(e))},this.LogLn=function(){this.LogRaw("")},this.LogPlain=function(e){var t="";this.ClearLastMsg(),"json"===this.FEncoding?(t=this.FormatJSONMsg(5,e,0,"",0,0),this.DoLogRaw(t,!0)):this.DoLogRaw(e,!1)},this.LogPlain$1=function(e){this.LogPlain(this.$class.Concatenate(e))},this.LogMsg=function(e,t,s,i,r,n){var l;l=this.FindMsg(e,!0),this.Log(l.Typ,m(l.Pattern,t),e,s,i,r,n)},this.Log=function(e,t,s,i,r,n,l){var a="";l&&!(e in this.FShowMsgTypes)||this.GetMsgNumberDisabled(s)||(a="json"===this.FEncoding?this.FormatJSONMsg(e,t,s,i,r,n):this.FormatMsg(e,t,s,i,r,n),this.FLastMsgType=e,this.FLastMsgNumber=s,this.FLastMsgTxt=t,this.FLastMsgFile=i,this.FLastMsgLine=r,this.FLastMsgCol=n,this.DoLogRaw(a,!1))},this.LogMsgIgnoreFilter=function(e,t){this.LogMsg(e,t,"",0,0,!1)},this.LogExceptionBackTrace=function(e){},this.MsgTypeToStr=function(e){return 0===e?"Fatal":1===e?"Error":2===e?"Warning":3===e?"Note":4===e?"Hint":5===e?"Info":6===e?"Debug":"Verbose"},this.FormatMsg=function(e,t,s,i,r,n){var l="";return l="",""!==i&&(null!=this.FOnFormatPath?l+=this.FOnFormatPath(i):l+=i,r>0&&(l+="("+F(r),n>0&&(l+=","+F(n)),l+=")"),""!==l&&(l+=" ")),l+=this.MsgTypeToStr(e)+": ",this.FShowMsgNumbers&&0!==s&&(l+="("+F(s)+") "),l+=t},this.FormatJSONMsg=function(e,t,s,i,r,n){var l="",a=null,o="";o=null!=this.FOnFormatPath?this.FOnFormatPath(i):i,a=C.$create("Create$3",[["message",t,"line",r,"col",n,"number",s,"filename",o,"type",this.MsgTypeToStr(e)]]);try{l=a.GetAsJSON()}finally{a=rtl.freeLoc(a)}return l},this.OpenOutputFile=function(){this.FOutputFile=this.CreateTextWriter(this.FOutputFilename)},this.Flush=function(){},this.CloseOutputFile=function(){null!==this.FOutputFile&&(this.Flush(),d({p:this,get:function(){return this.p.FOutputFile},set:function(e){this.p.FOutputFile=e}}))},this.Reset=function(){this.SetOutputFilename(""),this.FMsgNumberDisabled=[],this.FShowMsgNumbers=!1,this.FShowMsgTypes=rtl.refSet(e.DefaultLogMsgTypes)},this.ClearLastMsg=function(){this.FLastMsgType=5,this.FLastMsgNumber=0,this.FLastMsgTxt="",this.FLastMsgFile="",this.FLastMsgLine=0,this.FLastMsgCol=0};this.OpenDebugLog=function(){this.FDebugLog=s.$create("Create$1",["pas2jsdebug.log",65344])},this.CloseDebugLog=function(){d({p:this,get:function(){return this.p.FDebugLog},set:function(e){this.p.FDebugLog=e}})},this.DebugLogWriteLn=function(e){null!==this.FDebugLog&&(e+=n.LineEnding,this.FDebugLog.Write(e))},this.GetEncodingCaption=function(){var e="";return""===(e=this.FEncoding)&&(e="utf-8"),"utf8"===e&&(e="utf-8"),e},this.Concatenate=function(e){var t="",s=void 0;t="";for(var i=0,r=rtl.length(e)-1;i<=r;i++){var n=typeof(s=e[i]);if("boolean"===n)t+=s?"true":"false";else if("number"===n)S(s)?t+=""+rtl.trunc(s):t+=rtl.floatToStr(rtl.getNumber(s));else{if("string"!==n)continue;t+=""+s}}return t}}),this.CompareP2JMessage=function(e,t){return e.Number-t.Number},this.QuoteStr=function(e,t){return T(e,t)}}),rtl.module("Pas2jsPParser",["System","Classes","SysUtils","PParser","PScanner","PasTree","PasResolver","FPPas2Js","Pas2jsLogger"],function(){"use strict";var e=this,t=null,s=pas.PParser,i=s.TPasParser,r=pas.FPPas2Js,n=s.EParserError,l=r.TPas2JSResolver,a=pas.PasTree,o=a.TFinalizationSection,h=pas.PasResolver,u=h.TPasResolver,c=a.TPasModule,p=h.EPasResolve,f=pas.SysUtils,d=f.IntToStr,F=pas.System.Writeln,m=f.Exception;this.nFinalizationNotSupported=3001,this.sFinalizationNotSupported="Finalization section is not supported.",rtl.createClass(this,"TPas2jsPasParser",i,function(){t=this,this.$init=function(){i.$init.call(this),this.FLog=null},this.$final=function(){this.FLog=void 0,i.$final.call(this)},this.Create$2=function(e,t,s){return i.Create$1.call(this,e,t,s),this.SetOptions(rtl.unionSet(this.FOptions,r.po_Pas2js)),this},this.RaiseParserError=function(e,t){var s;throw s=this.FLog.FindMsg(e,!0),this.SetLastMsg(s.Typ,e,s.Pattern,t),n.$create("Create$2",[this.FLastMsg,this.FScanner.FCurFilename,this.FScanner.FCurRow,this.FScanner.GetCurColumn(),0])},this.ParseSubModule=function(e){e.set(null),this.NextToken(),this.SaveComments();var t=this.FCurToken;111===t?this.ParseUnit(e):78===t?this.ParseLibrary(e):this.CheckToken(111)}}),rtl.createClass(this,"TPas2jsCompilerResolver",l,function(){this.$init=function(){l.$init.call(this),this.FLog=null,this.FOnCheckSrcName=null,this.FOnFindModule=null,this.FP2JParser=null,this.Owner=null},this.$final=function(){this.FLog=void 0,this.FOnCheckSrcName=void 0,this.FOnFindModule=void 0,this.FP2JParser=void 0,this.Owner=void 0,l.$final.call(this)},this.CreateElement$2=function(e,s,i,r,n,l){var a;return e===o&&rtl.as(this.FCurrentParser,t).RaiseParserError(3001,[]),a=u.CreateElement$2.call(this,e,s,i,r,n,l),c.isPrototypeOf(a)&&this.FOnCheckSrcName(a),a},this.FindModule=function(e){throw p.$create("Create$1",["Call TPas2jsCompilerResolver.FindModule(name,expr,...) instead"])},this.FindUnit=function(e,t,s,i){return this.FOnFindModule(e,t,s,i)},this.UsedInterfacesFinished=function(e){}}),this.RegisterMessages=function(t){var s=0;s=-1,function(e,i,r){var n="";if(s>=0&&i!==s+1)throw n="gap in registered message numbers: "+d(s)+" "+d(i),F("Pas2jsPParser.RegisterMessages ",n),m.$create("Create$1",[n]);t.RegisterMsg(e,i,r),s=i}(1,3001,e.sFinalizationNotSupported)}}),rtl.module("Pas2jsUseAnalyzer",["System","Classes","PasUseAnalyzer","PasTree","PasResolver","FPPas2Js"],function(){"use strict";var e=pas.PasUseAnalyzer.TPasAnalyzer,t=pas.PasTree,s=t.TPasArrayType,i=pas.PasResolver,r=i.NoNil,n=pas.FPPas2Js,l=n.TPas2JSModuleScope,a=i.TResolvedReference,o=t.TPasProcedure,h=t.TPasConstructor,u=t.TPasProperty,c=t.TPasClassType,p=n.TPas2JSClassScope;rtl.createClass(this,"TPas2JSAnalyzer",e,function(){this.UseExpr=function(t){var i=this;function n(e){var n=0,a=null,o=null,h=null;if(null!==e)for(var u=0,c=e.FCount-1;u<=c;u++)if(n=u,null!==(a=rtl.getObject(e.Get(n)).ArgType)&&a.$class.ClassType()===s&&null===a.ElType){o=t.GetModule(),null===(h=rtl.as(r(o.FData),l).SystemVarRecs)&&i.RaiseNotSupported(20190216104347,t,""),i.MarkImplScopeRef(t,h,1),i.UseProcedure(h);break}}var c=null;null!==t&&(e.UseExpr.call(this,t),a.isPrototypeOf(t.FData)&&(c=t.FData.FDeclaration,o.isPrototypeOf(c)?(n(c.ProcType.Args),c.$class.ClassType()===h&&this.UseConstructor(c,t)):c.$class.ClassType()===u&&n(this.FResolver.GetPasPropertyArgs(c))))},this.UseConstructor=function(e,t){var s=null;if(e.FParent.$class.ClassType()===c){s=rtl.as(e.FParent.FData,p);do{if(null!==s.NewInstanceFunction){this.UseProcedure(s.NewInstanceFunction);break}s=rtl.as(s.AncestorScope,p)}while(null!==s)}}})}),rtl.module("Pas2jsCompiler",["System","JS","Classes","SysUtils","contnrs","jsbase","jstree","jswriter","JSSrcMap","fpjson","PScanner","PParser","PasTree","PasResolver","PasResolveEval","PasUseAnalyzer","Pas2JSUtils","pas2jsresstrfile","pas2jsresources","pas2jshtmlresources","pas2jsjsresources","FPPas2Js","FPPJsSrcMap","Pas2jsLogger","Pas2JSFS","Pas2jsPParser","Pas2jsUseAnalyzer"],function(){"use strict";var e,t,s=this,i=null,r=null,n=null,l=null,a=null,o=null,h=null,u=null,c=pas.PScanner,p=pas.FPPas2Js,f=pas.SysUtils,d=f.Exception,F=pas.System,m=F.TObject,C=pas.contnrs.TObjectList,S=f.FreeAndNil,T=pas.PasResolver,y=T.IsValidIdent,g=f.CompareText,E=F.Copy,P=f.LeftStr,I=c.EScannerError,R=pas.PParser.EParserError,v=T.EPasResolve,A=p.EPas2JS,N=c.EFileNotFoundError,x=pas.Pas2JSFS,b=x.EPas2jsFS,O=T.TPasResolver,k=pas.Pas2jsPParser,$=k.TPas2jsCompilerResolver,D=pas.Classes,L=D.TFPList,B=pas.Pas2jsUseAnalyzer.TPas2JSAnalyzer,M=p.TPas2jsPasScanner,G=k.TPas2jsPasParser,w=pas.PasTree,V=c.ExtractFilenameOnly,U=p.TPasToJSConverter,J=F.VarRecs,j=f.ExtractFilePath,H=w.TPasUnitModule,W=w.TPasModule,Y=pas.Pas2jsLogger,z=Y.QuoteStr,_=w.TPasProgram,K=w.TPasLibrary,X=T.TPasModuleScope,q=T.NoNil,Q=c.StrToModeSwitch,Z=c.SafeFormat,ee=c.TCondDirectiveEvaluator,te=f.LowerCase,se=f.Format,ie=F.TGuid,re=F.Delete,ne=pas.Pas2JSUtils,le=ne.GetNextDelimitedItem,ae=pas.PasResolveEval,oe=ae.ReleaseEvalValue,he=f.ExtractFileName,ue=w.TPasPackage,ce=f.ChangeFileExt,pe=f.IntToStr,fe=k.RegisterMessages,de=f.GetEnvironmentVariable,Fe=D.TStringList,me=ne.SplitCmdLineParams,Ce=F.Pos,Se=f.SameText,Te=f.UpperCase,ye=pas.jstree,ge=ye.TJSSourceElements,Ee=ye.TJSImportStatement,Pe=pas.FPPJsSrcMap,Ie=Pe.TPas2JSMapper,Re=pas.jswriter.TJSWriter,ve=Y.TPas2jsLogger,Ae=Pe.TPas2JSSrcMap,Ne=F.StringOfChar,xe=f.Trim,be=f.ExtractFileExt,Oe=ye.TJSPrimaryExpressionIdent,ke=ye.TJSDotMemberExpression,$e=ye.TJSSimpleAssignStatement,De=ne.NormalizeEncoding,Le=p.TPas2JSBuiltInName,Be=pas.jsbase.IsValidJSIdentifier,Me=f.CreateGUID,Ge=f.Now,we=f.FormatFloat,Ve=ae.GetObjName,Ue=c.FilenameIsAbsolute,Je=f.StringReplace,je=ne.ChompPathDelim,He=F.Writeln,We=pas.pas2jsresources.TNoResources,Ye=pas.pas2jshtmlresources.THTMLResourceLinkHandler,ze=pas.pas2jsjsresources.TJSResourceHandler,_e=p.TPasToJSConverterGlobals,Ke=p.TPas2JSResolverHub,Xe=pas.pas2jsresstrfile.TResourceStringsFile,qe=f.BoolToStr$1,Qe=c.TMacroDef;this.VersionMajor=3,this.VersionMinor=3,this.VersionRelease=1,this.VersionExtra="",this.DefaultConfigFile="pas2js.cfg",this.nOptionIsEnabled=101,this.sOptionIsEnabled='Option "%s" is %s',this.nSyntaxModeIs=102,this.sSyntaxModeIs="Syntax mode is %s",this.nModeswitchXisY=103,this.sModeswitchXisY="Modeswitch %s is %s",this.nNameValue=106,this.sNameValue="%s: %s",this.nReadingOptionsFromFile=107,this.sReadingOptionsFromFile="Reading options from file %s",this.nEndOfReadingConfigFile=108,this.sEndOfReadingConfigFile="End of reading config file %s",this.nInterpretingFileOption=109,this.sInterpretingFileOption="interpreting file option %s",this.nSourceFileNotFound=110,this.sSourceFileNotFound="source file not found %s",this.nFileIsFolder=111,this.sFileIsFolder="expected file, but found directory %s",this.nConfigFileSearch=112,this.sConfigFileSearch="Configfile search: %s",this.nHandlingOption=113,this.sHandlingOption="handling option %s",this.nQuickHandlingOption=114,this.sQuickHandlingOption="quick handling option %s",this.nOutputDirectoryNotFound=115,this.sOutputDirectoryNotFound="output directory not found: %s",this.nUnableToWriteFile=116,this.sUnableToWriteFile="Unable to write file %s",this.nWritingFile=117,this.sWritingFile="Writing file %s ...",this.nCompilationAborted=118,this.sCompilationAborted="Compilation aborted",this.nCfgDirective=119,this.sCfgDirective="cfg directive %s: %s",this.nUnitCycle=120,this.sUnitCycle="Unit cycle found %s",this.nOptionForbidsCompile=121,this.sOptionForbidsCompile='Option -Ju forbids to compile unit "%s"',this.nUnitNeedsCompileDueToUsedUnit=122,this.sUnitsNeedCompileDueToUsedUnit='Unit "%s" needs compile due to used unit "%s"',this.nUnitNeedsCompileDueToOption=123,this.sUnitsNeedCompileDueToOption='Unit "%s" needs compile due to option "%s"',this.nUnitNeedsCompileJSMissing=124,this.sUnitsNeedCompileJSMissing='Unit "%s" needs compile, js file missing "%s"',this.nUnitNeedsCompilePasHasChanged=125,this.sUnitsNeedCompilePasHasChanged='Unit "%s" needs compile, Pascal file has changed, js is %s',this.nParsingFile=126,this.sParsingFile="Parsing %s ...",this.nCompilingFile=127,this.sCompilingFile="Compiling %s ...",this.nExpectedButFound=128,this.sExpectedButFound='Illegal unit name: Expected "%s", but found "%s"',this.nLinesInFilesCompiled=129,this.sLinesInFilesCompiled="%s lines in %s files compiled, %s sec%s",this.nTargetPlatformIs=130,this.sTargetPlatformIs="Target platform is %s",this.nTargetProcessorIs=131,this.sTargetProcessorIs="Target processor is %s",this.nMessageEncodingIs=132,this.sMessageEncodingIs="Message encoding is %s",this.nUnableToTranslatePathToDir=133,this.sUnableToTranslatePathToDir="Unable to translate path %s to directory %s",this.nSrcMapSourceRootIs=134,this.sSrcMapSourceRootIs='source map "sourceRoot" is %s',this.nSrcMapBaseDirIs=135,this.sSrcMapBaseDirIs='source map "local base directory" is %s',this.nUnitFileNotFound=136,this.sUnitFileNotFound="unit file not found %s",this.nClassInterfaceStyleIs=137,this.sClassInterfaceStyleIs="Class interface style is %s",this.nHandlingEnvOpts=138,this.sHandlingEnvOpts="handling environment options %s",this.nPostProcessorInfoX=139,this.sPostProcessorInfoX="Post processor: %s",this.nPostProcessorRunX=140,this.sPostProcessorRunX="Run post processor: %s",this.nPostProcessorFailX=141,this.sPostProcessorFailX="Post processor failed: %s",this.nPostProcessorWarnX=142,this.sPostProcessorWarnX="Post processor: %s",this.nPostProcessorFinished=143,this.sPostProcessorFinished="Post processor finished",this.nRTLIdentifierChanged=144,this.sRTLIdentifierChanged="RTL identifier %s changed from %s to %s",this.nSkipNoConstResourcestring=145,this.sSkipNoConstResourcestring="Resource string %s is not a constant, not adding to resourcestrings file.",this.nUnknownOptimizationOption=146,this.sUnknownOptimizationOption="unknown -Oo option %s",this.nSubtargetConfigNotFound=147,this.sSubtargetConfigNotFound="Subtarget %s config file not found",this.TP2jsCompilerOption={0:"coSkipDefaultConfigs",coSkipDefaultConfigs:0,1:"coBuildAll",coBuildAll:1,2:"coShowLogo",coShowLogo:2,3:"coShowErrors",coShowErrors:3,4:"coShowWarnings",coShowWarnings:4,5:"coShowNotes",coShowNotes:5,6:"coShowHints",coShowHints:6,7:"coShowInfos",coShowInfos:7,8:"coShowLineNumbers",coShowLineNumbers:8,9:"coShowTriedUsedFiles",coShowTriedUsedFiles:9,10:"coShowConditionals",coShowConditionals:10,11:"coShowUsedTools",coShowUsedTools:11,12:"coShowDebug",coShowDebug:12,13:"coShowMessageNumbers",coShowMessageNumbers:13,14:"coOverflowChecks",coOverflowChecks:14,15:"coRangeChecks",coRangeChecks:15,16:"coObjectChecks",coObjectChecks:16,17:"coAssertions",coAssertions:17,18:"coAllowCAssignments",coAllowCAssignments:18,19:"coAllowMacros",coAllowMacros:19,20:"coWriteableConst",coWriteableConst:20,21:"coLowerCase",coLowerCase:21,22:"coUseStrict",coUseStrict:22,23:"coWriteDebugLog",coWriteDebugLog:23,24:"coWriteMsgToStdErr",coWriteMsgToStdErr:24,25:"coPrecompile",coPrecompile:25,26:"coEnumValuesAsNumbers",coEnumValuesAsNumbers:26,27:"coKeepNotUsedPrivates",coKeepNotUsedPrivates:27,28:"coKeepNotUsedDeclarationsWPO",coKeepNotUsedDeclarationsWPO:28,29:"coShortRefGlobals",coShortRefGlobals:29,30:"coObfuscateLocalIdentifiers",coObfuscateLocalIdentifiers:30,31:"coSourceMapCreate",coSourceMapCreate:31,32:"coSourceMapInclude",coSourceMapInclude:32,33:"coSourceMapFilenamesAbsolute",coSourceMapFilenamesAbsolute:33,34:"coSourceMapXSSIHeader",coSourceMapXSSIHeader:34},e=this.TP2jsRTLVersionCheck={0:"rvcNone",rvcNone:0,1:"rvcMain",rvcMain:1,2:"rvcSystem",rvcSystem:2,3:"rvcUnit",rvcUnit:3},this.TP2JSResourceStringFile={0:"rsfNone",rsfNone:0,1:"rsfUnit",rsfUnit:1,2:"rsfProgram",rsfProgram:2},t=this.TResourceMode={0:"Skip",Skip:0,1:"rmNone",rmNone:1,2:"rmHTML",rmHTML:2,3:"rmJS",rmJS:3},this.DefaultP2jsCompilerOptions=rtl.createSet(3,20,22,34),this.DefaultP2jsRTLVersionCheck=0,this.DefaultResourceMode=2,this.coShowAll=rtl.createSet(null,3,12),this.coAllOptimizations=rtl.createSet(null,26,30),this.coO0=rtl.createSet(27,28),this.coO1=rtl.createSet(26),this.coO2=rtl.unionSet(this.coO1,rtl.createSet(29)),this.p2jscoCaption=["Skip default configs","Build all","Show logo","Show errors","Show warnings","Show notes","Show hints","Show infos","Show line numbers","Show tried/used files","Show conditionals","Show used tools","Show debug","Show message numbers","Overflow checking","Range checking","Method call checking","Assertions","Allow C assignments","Allow macros","Allows typed constants to be writeable","Lowercase identifiers","Use strict","Write pas2jsdebug.log","Write messages to StdErr","Create precompiled units","Enum values as numbers","Keep not used private declarations","Keep not used declarations (WPO)","Create short local variables for globals","Obfuscate local identifiers","Create source map","Include Pascal sources in source map","Do not shorten filenames in source map","Prepend XSSI protection )]} to source map"],this.TP2jsMode={0:"p2jmObjFPC",p2jmObjFPC:0,1:"p2jmDelphi",p2jmDelphi:1},this.p2jscModeNames=["ObjFPC","Delphi"],this.p2jsMode_SwitchSets$a$clone=function(e){var t=[];t.length=2;for(var s=0;s<2;s++)t[s]=rtl.refSet(e[s]);return t},this.p2jsMode_SwitchSets=[rtl.unionSet(rtl.intersectSet(c.OBJFPCModeSwitches,p.msAllPas2jsModeSwitches),p.msAllPas2jsModeSwitchesReadOnly),rtl.unionSet(rtl.intersectSet(c.DelphiModeSwitches,p.msAllPas2jsModeSwitches),p.msAllPas2jsModeSwitchesReadOnly)],rtl.createClass(this,"EPas2jsMacro",d,function(){i=this}),rtl.createClass(this,"TPas2jsMacro",m,function(){r=this,this.$init=function(){m.$init.call(this),this.Name="",this.Description="",this.Value="",this.CanHaveParams=!1,this.OnSubstitute=null},this.$final=function(){this.OnSubstitute=void 0,m.$final.call(this)}}),rtl.createClass(this,"TPas2jsMacroEngine",m,function(){n=this,this.$init=function(){m.$init.call(this),this.fMacros=null,this.FMaxLevel=0},this.$final=function(){this.fMacros=void 0,m.$final.call(this)},this.GetMacros=function(e){return this.fMacros.GetItem(e)},this.Create$1=function(){return this.fMacros=C.$create("Create$3",[!0]),this.FMaxLevel=10,this},this.Destroy=function(){S({p:this,get:function(){return this.p.fMacros},set:function(e){this.p.fMacros=e}}),m.Destroy.call(this)},this.Count=function(){return this.fMacros.GetCount()},this.AddValue=function(e,t,s){var n=null;if(!y(e,!1,!1))throw i.$create("Create$1",['invalid macro name "'+e+'"']);if(this.IndexOf(e)>=0)throw i.$create("Create$1",['duplicate macro name "'+e+'"']);return(n=r.$create("Create")).Name=e,n.Description=t,n.Value=s,this.fMacros.Add$1(n),n},this.AddFunction=function(e,t,s,n){var l=null;if(!y(e,!1,!1))throw i.$create("Create$1",['invalid macro name "'+e+'"']);if(this.IndexOf(e)>=0)throw i.$create("Create$1",['duplicate macro name "'+e+'"']);return(l=r.$create("Create")).Name=e,l.Description=t,l.CanHaveParams=n,l.OnSubstitute=s,this.fMacros.Add$1(l),l},this.IndexOf=function(e){for(var t=0,s=0,i=this.Count()-1;s<=i;s++)if(t=s,0===g(this.GetMacros(t).Name,e))return t;return-1},this.FindMacro=function(e){var t;return(t=this.IndexOf(e))>=0?this.GetMacros(t):null},this.Substitute=function(e,t,s,r){var n=0,l=0,a=0,o=0,h="",u="",c=null;if(s>=this.FMaxLevel)throw i.$create("Create$1",['macro cycle detected: "'+e.get()+'"']);for(n=1;n<e.get().length;){if("$"===e.get().charAt(n-1)&&e.get().charCodeAt(n+1-1)in rtl.createSet(95,null,97,122,null,65,90)){for(l=n,n+=2;n<=e.get().length&&e.get().charCodeAt(n-1)in rtl.createSet(95,null,97,122,null,65,90,null,48,57);)n+=1;if(h=E(e.get(),l+1,n-l-1),null===(c=this.FindMacro(h))){if(!r)throw i.$create("Create$1",['macro not found "'+h+'" in "'+e.get()+'"']);u="$"+h}else{if(c.CanHaveParams&&n<=e.get().length&&"("===e.get().charAt(n-1))for(o=n+=1,a=1;;){if(n>e.get().length)throw i.$create("Create$1",['missing closing bracket ) in "'+e.get()+'"']);var p=e.get().charAt(n-1);if("("===p)a+=1;else if(")"===p){if(1===a){u=E(e.get(),o,n-o);break}a-=1}}else n<=e.get().length&&"$"===e.get().charAt(n-1)&&(n+=1);if(null!=c&&null!=c.OnSubstitute){if(!c.OnSubstitute(t,{get:function(){return u},set:function(e){u=e}},s+1))throw i.$create("Create$1",['macro "'+h+'" failed in "'+e.get()+'"'])}else u=c.Value}e.set(P(e.get(),l-1)+u+E(e.get(),n,e.get().length)),n=l}n+=1}}}),rtl.createClass(this,"ECompilerTerminate",d,function(){l=this}),this.TUsedBySection={0:"ubMainSection",ubMainSection:0,1:"ubImplSection",ubImplSection:1},this.TPas2jsReaderState={0:"prsNone",prsNone:0,1:"prsReading",prsReading:1,2:"prsWaitingForUsedUnits",prsWaitingForUsedUnits:2,3:"prsCanContinue",prsCanContinue:3,4:"prsFinished",prsFinished:4,5:"prsError",prsError:5},rtl.createClass(this,"TPCUSupport",m,function(){0}),rtl.recNewT(this,"TFindUnitInfo",function(){a=this,this.FileName="",this.UnitName="",this.isPCU=!1,this.isForeign=!1,this.$eq=function(e){return this.FileName===e.FileName&&this.UnitName===e.UnitName&&this.isPCU===e.isPCU&&this.isForeign===e.isForeign},this.$assign=function(e){return this.FileName=e.FileName,this.UnitName=e.UnitName,this.isPCU=e.isPCU,this.isForeign=e.isForeign,this}}),rtl.recNewT(this,"TLoadUnitInfo",function(){o=this,this.UseFilename="",this.UseUnitname="",this.InFilename="",this.NameExpr=null,this.InFileExpr=null,this.UseIsForeign=!1,this.IsPCU=!1,this.$eq=function(e){return this.UseFilename===e.UseFilename&&this.UseUnitname===e.UseUnitname&&this.InFilename===e.InFilename&&this.NameExpr===e.NameExpr&&this.InFileExpr===e.InFileExpr&&this.UseIsForeign===e.UseIsForeign&&this.IsPCU===e.IsPCU},this.$assign=function(e){return this.UseFilename=e.UseFilename,this.UseUnitname=e.UseUnitname,this.InFilename=e.InFilename,this.NameExpr=e.NameExpr,this.InFileExpr=e.InFileExpr,this.UseIsForeign=e.UseIsForeign,this.IsPCU=e.IsPCU,this}}),rtl.createClass(this,"TPas2JSCompilerSupport",m,function(){h=this,this.$init=function(){m.$init.call(this),this.FCompiler=null},this.$final=function(){this.FCompiler=void 0,m.$final.call(this)},this.Create$1=function(e){return this.FCompiler=e,this}}),rtl.createClass(this,"TPas2jsCompilerFile",h,function(){u=this,this.$init=function(){h.$init.call(this),this.FConverter=null,this.FFileResolver=null,this.FIsForeign=!1,this.FIsMainFile=!1,this.FJSFilename="",this.FJSModule=null,this.FLog=null,this.FNeedBuild=!1,this.FParser=null,this.FPasFileName="",this.FPasModule=null,this.FPasResolver=null,this.FPasUnitName="",this.FPCUFilename="",this.FPCUSupport=null,this.FReaderState=0,this.FResourceHandler=null,this.FScanner=null,this.FShowDebug=!1,this.FUnitFilename="",this.FUseAnalyzer=null,this.FUsedBy=rtl.arraySetLength(null,null,2)},this.$final=function(){this.FConverter=void 0,this.FFileResolver=void 0,this.FJSModule=void 0,this.FLog=void 0,this.FParser=void 0,this.FPasModule=void 0,this.FPasResolver=void 0,this.FPCUSupport=void 0,this.FResourceHandler=void 0,this.FScanner=void 0,this.FUseAnalyzer=void 0,this.FUsedBy=void 0,h.$final.call(this)},this.GetUsedBy=function(e,t){return rtl.getObject(this.FUsedBy[e].Get(t))},this.GetUsedByCount=function(e){return this.FUsedBy[e].FCount},this.HandleResources=function(e,t,s){this.FResourceHandler.StartUnit(this.FPasModule.FName),this.FResourceHandler.HandleResource(t,s)},this.OnConverterIsElementUsed=function(e,t){return null===this.FCompiler.FWPOAnalyzer||28 in this.FCompiler.FOptions?27 in this.FCompiler.FOptions||this.FUseAnalyzer.IsUsed(t):this.FCompiler.FWPOAnalyzer.IsUsed(t)},this.OnConverterIsTypeInfoUsed=function(e,t){return null===this.FCompiler.FWPOAnalyzer||28 in this.FCompiler.FOptions?27 in this.FCompiler.FOptions||this.FUseAnalyzer.IsTypeInfoUsed(t):this.FCompiler.FWPOAnalyzer.IsTypeInfoUsed(t)},this.OnPasResolverLog=function(e,t){var s;s=e,this.DoLogMsgAtEl(s.FLastMsgType,s.FLastMsg,s.FLastMsgNumber,s.FLastElement)},this.OnParserLog=function(e,t){var s,i=null;i=(s=e).FScanner,this.FLog.Log(s.FLastMsgType,s.FLastMsg,s.FLastMsgNumber,i.FCurFilename,i.FCurRow,i.GetCurColumn(),!0)},this.OnScannerLog=function(e,t){var s=null;s=e,this.FLog.Log(s.FLastMsgType,s.FLastMsg,s.FLastMsgNumber,s.FCurFilename,s.FCurRow,s.GetCurColumn(),!0)},this.OnUseAnalyzerMessage=function(e,t){this.FLog.Log(t.MsgType,t.MsgText,t.MsgNumber,t.Filename,t.Row,t.Col,!0)},this.HandleEParserError=function(e){this.FLog.Log(this.FParser.FLastMsgType,this.FParser.FLastMsg,this.FParser.FLastMsgNumber,e.FFilename,e.FRow,e.FColumn,!0),this.FCompiler.Terminate(6)},this.HandleEPasResolve=function(e){var t="",s=0,i=0;null!==e.FPasElement?(t=e.FPasElement.SourceFilename,this.FPasResolver.$class.UnmangleSourceLineNumber(e.FPasElement.SourceLinenumber,{get:function(){return s},set:function(e){s=e}},{get:function(){return i},set:function(e){i=e}})):(t=this.FScanner.FCurFilename,s=this.FScanner.FCurRow,i=this.FScanner.GetCurColumn()),this.FLog.Log(e.MsgType,e.fMessage,e.MsgNumber,t,s,i,!0),this.FCompiler.Terminate(6)},this.HandleEPas2JS=function(e){var t="",s=0,i=0;null!==e.PasElement?(t=e.PasElement.SourceFilename,this.FPasResolver.$class.UnmangleSourceLineNumber(e.PasElement.SourceLinenumber,{get:function(){return s},set:function(e){s=e}},{get:function(){return i},set:function(e){i=e}}),this.FLog.Log(e.MsgType,e.fMessage,e.MsgNumber,t,s,i,!0)):this.FLog.Log(e.MsgType,e.fMessage,e.MsgNumber,"",0,0,!0),this.FCompiler.Terminate(7)},this.HandleUnknownException=function(e){l.isPrototypeOf(e)||this.FLog.Log(0,"bug: uncaught "+e.$classname+": "+e.fMessage,0,"",0,0,!0),this.FLog.Log(0,e.$classname+": "+e.fMessage,0,"",0,0,!0),this.FCompiler.Terminate(1)},this.HandleException=function(e){this.FShowDebug&&this.FLog.LogExceptionBackTrace(e),I.isPrototypeOf(e)?(this.FLog.Log(this.FScanner.FLastMsgType,this.FScanner.FLastMsg,this.FScanner.FLastMsgNumber,this.FScanner.FCurFilename,this.FScanner.FCurRow,this.FScanner.GetCurColumn(),!0),this.FCompiler.Terminate(6)):R.isPrototypeOf(e)?this.HandleEParserError(e):v.isPrototypeOf(e)?this.HandleEPasResolve(e):A.isPrototypeOf(e)?this.HandleEPas2JS(e):N.isPrototypeOf(e)?(""===e.fMessage&&0===this.FLog.FLastMsgType||this.FLog.Log(0,e.fMessage,0,"",0,0,!0),this.FCompiler.Terminate(4)):b.isPrototypeOf(e)?(this.FLog.Log(0,e.fMessage,0,"",0,0,!0),this.FCompiler.Terminate(4)):null!=this.FPCUSupport&&this.FPCUSupport.HandleException(e)||this.HandleUnknownException(e)},this.HandleJSException=function(e,t){this.FCompiler.HandleJSException(e,t,!0)},this.DoLogMsgAtEl=function(e,t,s,i){var r=0,n=0,l="";null!==i?(l=i.SourceFilename,O.UnmangleSourceLineNumber(i.SourceLinenumber,{get:function(){return r},set:function(e){r=e}},{get:function(){return n},set:function(e){n=e}})):(l="",r=0,n=0),this.FLog.Log(e,t,s,l,r,n,!0)},this.RaiseInternalError=function(e,t){this.FCompiler.RaiseInternalError(e,t)},this.ReaderFinished=function(){this.FReaderState=4;try{this.FCompiler.RemoveReadingModule(this),23 in this.FCompiler.FOptions&&(this.FLog.DebugLogWriteLn("Pas-Module:"),this.FLog.DebugLogWriteLn(this.FPasModule.GetDeclaration(!0))),null==this.FPCUSupport||this.FPCUSupport.HasReader()||this.FUseAnalyzer.SetOptions(rtl.unionSet(this.FUseAnalyzer.FOptions,rtl.createSet(1))),this.FUseAnalyzer.AnalyzeModule(this.FPasModule),null!=this.FPCUSupport&&!this.FPCUSupport.HasReader()&&25 in this.FCompiler.FOptions&&this.FPCUSupport.WritePCU()}catch(t){if(l.isPrototypeOf(t)){var e=t;throw t}if(d.isPrototypeOf(t)){e=t;this.HandleException(e)}else this.HandleJSException('[20181031190529] TPas2jsCompilerFile.ReaderFinished File="'+this.FUnitFilename+'"',t)}},this.Create$2=function(e,t,s){var i=0;h.Create$1.call(this,e),this.FPasFileName=t,this.FPCUFilename=s,""!==this.FPasFileName?this.FUnitFilename=this.FPasFileName:this.FUnitFilename=this.FPCUFilename,this.FLog=this.FCompiler.FLog,this.FPasResolver=$.$create("Create$3"),this.FPasResolver.Owner=this,this.FPasResolver.FOnFindModule=rtl.createCallback(this,"OnResolverFindModule"),this.FPasResolver.FOnCheckSrcName=rtl.createCallback(this,"OnResolverCheckSrcName"),this.FPasResolver.FOnLog=rtl.createCallback(this,"OnPasResolverLog"),this.FPasResolver.FLog=this.FLog,this.FPasResolver.FHub=e.FResolverHub,this.FPasResolver.AddObjFPCBuiltInIdentifiers(p.btAllJSBaseTypes,p.bfAllJSBaseProcs),this.FIsMainFile=this.FCompiler.FFS.SameFileName(this.FCompiler.FMainSrcFile,this.FPasFileName);for(var r=0;r<=1;r++)i=r,this.FUsedBy[i]=L.$create("Create");return this.FUseAnalyzer=B.$create("Create$1"),this.FUseAnalyzer.FOnMessage=rtl.createCallback(this,"OnUseAnalyzerMessage"),this.FUseAnalyzer.FResolver=this.FPasResolver,this.FPCUSupport=this.CreatePCUSupport(),this},this.Destroy=function(){S({p:this,get:function(){return this.p.FPCUSupport},set:function(e){this.p.FPCUSupport=e}}),S({p:this,get:function(){return this.p.FUseAnalyzer},set:function(e){this.p.FUseAnalyzer=e}});for(var e=0;e<=1;e++)S({a:e,p:this.FUsedBy,get:function(){return this.p[this.a]},set:function(e){this.p[this.a]=e}});S({p:this,get:function(){return this.p.FJSModule},set:function(e){this.p.FJSModule=e}}),S({p:this,get:function(){return this.p.FConverter},set:function(e){this.p.FConverter=e}}),S({p:this,get:function(){return this.p.FParser},set:function(e){this.p.FParser=e}}),S({p:this,get:function(){return this.p.FScanner},set:function(e){this.p.FScanner=e}}),S({p:this,get:function(){return this.p.FFileResolver},set:function(e){this.p.FFileResolver=e}}),S({p:this,get:function(){return this.p.FPasResolver},set:function(e){this.p.FPasResolver=e}}),this.FPasModule=null,m.Destroy.call(this)},this.CreatePCUSupport=function(){return null},this.GetInitialModeSwitches=function(){return rtl.refSet(this.FCompiler.FModeSwitches)},this.IsUnitReadFromPCU=function(){return null!=this.FPCUSupport&&this.FPCUSupport.HasReader()},this.GetInitialBoolSwitches=function(){var e={};return e=rtl.createSet(7,9),6 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,22)),5 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,23)),4 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,24)),14 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,14)),15 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,15)),16 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,27)),17 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,3)),19 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,25)),20 in this.FCompiler.FOptions||(e=rtl.excludeSet(e,9)),rtl.refSet(e)},this.GetInitialConverterOptions=function(){var e={};e=rtl.refSet(p.DefaultPasToJSOptions),e=22 in this.FCompiler.FOptions?rtl.includeSet(e,3):rtl.excludeSet(e,3),26 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,2)),(29 in this.FCompiler.FOptions||this.IsUnitReadFromPCU())&&(e=rtl.includeSet(e,10)),30 in this.FCompiler.FOptions&&(e=rtl.includeSet(e,11)),e=21 in this.FCompiler.FOptions?rtl.includeSet(e,0):rtl.excludeSet(e,0);var t=this.FCompiler.FRTLVersionCheck;return 0===t||(1===t?e=rtl.includeSet(e,7):2===t?e=rtl.includeSet(e,8):3===t&&(e=rtl.includeSet(e,9))),e},this.CreateScannerAndParser=function(e){var t="",s=0,i=null;this.FFileResolver=e,null!==this.FScanner&&this.RaiseInternalError(20180707193258,this.FUnitFilename),this.FScanner=M.$create("Create$1",[this.FFileResolver]),this.FScanner.FLogEvents=rtl.refSet(this.FPasResolver.FScannerLogEvents),this.FScanner.FOnLog=rtl.createCallback(this,"OnScannerLog"),this.FScanner.FOnFormatPath=rtl.createCallback(this.FCompiler,"FormatPath"),this.FScanner.RegisterResourceHandler("*",rtl.createCallback(this,"HandleResources")),this.FParser=G.$create("Create$2",[this.FScanner,this.FFileResolver,this.FPasResolver]),this.FScanner.SetOptions(rtl.unionSet(this.FScanner.FOptions,rtl.createSet(11))),this.FScanner.SetAllowedModeSwitches(rtl.refSet(p.msAllPas2jsModeSwitches)),this.FScanner.SetReadOnlyModeSwitches(rtl.refSet(p.msAllPas2jsModeSwitchesReadOnly)),this.FScanner.SetCurrentModeSwitches(rtl.refSet(this.GetInitialModeSwitches())),this.FScanner.SetAllowedBoolSwitches(rtl.refSet(p.bsAllPas2jsBoolSwitches)),this.FScanner.SetReadOnlyBoolSwitches(rtl.refSet(p.bsAllPas2jsBoolSwitchesReadOnly)),this.FScanner.SetCurrentBoolSwitches(rtl.refSet(this.GetInitialBoolSwitches())),this.FScanner.SetAllowedValueSwitches(rtl.refSet(p.vsAllPas2jsValueSwitches)),this.FScanner.SetReadOnlyValueSwitches(rtl.refSet(p.vsAllPas2jsValueSwitchesReadOnly)),this.FScanner.SetCurrentValueSwitch(0,w.InterfaceTypeNames[this.FCompiler.FInterfaceType]),18 in this.FCompiler.FOptions&&this.FScanner.SetOptions(rtl.unionSet(this.FScanner.FOptions,rtl.createSet(2))),1===this.FCompiler.FResourceMode&&this.FScanner.SetOptions(rtl.unionSet(this.FScanner.FOptions,rtl.createSet(16)));for(var r=0,n=this.FCompiler.FDefines.GetCount()-1;r<=n;r++)s=r,null===(i=this.FCompiler.FDefines.GetObject(s))?this.FScanner.AddDefine(this.FCompiler.FDefines.Get(s),!1):this.FScanner.AddMacro(i.FName,i.FValue,!1);this.FScanner.FCompilerVersion=this.FCompiler.$class.GetVersion(!0),this.FScanner.FTargetPlatform=this.FCompiler.GetTargetPlatform(),this.FScanner.FTargetProcessor=this.FCompiler.GetTargetProcessor(),this.FScanner.FResolver=this.FPasResolver,this.FParser.FLogEvents=rtl.refSet(this.FPasResolver.FPParserLogEvents),this.FParser.FOnLog=rtl.createCallback(this,"OnParserLog"),this.FParser.FLog=this.FLog,this.FPasResolver.FP2JParser=this.FParser,this.FIsMainFile||(t=V(this.FUnitFilename),0===g(t,"system")&&this.FParser.FImplicitUses.Clear())},this.CreateConverter=function(){null===this.FConverter&&(this.FConverter=U.$create("Create$1"),this.FConverter.SetGlobals(this.FCompiler.FConverterGlobals),this.FConverter.FOptions=rtl.refSet(this.GetInitialConverterOptions()))},this.OnResolverFindModule=function(e,t,s,i){var r,n=null,l=null,h=a.$new(),u=o.$new();return n=null,l=null,0===g(V(this.FUnitFilename),e)&&this.FParser.RaiseParserError(120,J(18,e)),r=j(this.FPasFileName),h.$assign(this.FCompiler.GetUnitInfo(e,t,r,this.FPCUSupport)),""!==h.FileName&&(u.UseFilename=h.FileName,u.UseUnitname=h.UnitName,u.NameExpr=s,u.IsPCU=h.isPCU,h.isPCU?(u.InFilename="",u.InFileExpr=null,u.UseIsForeign=!1):(u.InFilename=t,u.InFileExpr=i,u.UseIsForeign=h.isForeign),l=this.FCompiler.LoadUsedUnit(o.$clone(u),this)),null!==l&&(n=l.FPasModule),n},this.OnResolverCheckSrcName=function(e){var t="",s="";if(e.$class.ClassType()===H||e.$class.ClassType()===W)if(t=e.FName,this.FIsMainFile)""===this.FPasUnitName&&(this.FPasUnitName=t,this.FCompiler.AddUsedUnit(this));else{if(s=V(this.FUnitFilename),0===g(t,s))return;this.FParser.RaiseParserError(128,J(18,s,18,t))}},this.OpenFile=function(e){this.FPasFileName=e;try{this.FScanner.OpenFile(this.FPasFileName)}catch(s){if(l.isPrototypeOf(s)){var t=s;throw s}if(d.isPrototypeOf(s)){t=s;this.HandleException(t)}else this.HandleJSException('[20181031190536] TPas2jsCompilerFile.OpenFile "'+e+'"',s)}},this.ReadUnit=function(){this.FShowDebug&&this.FLog.LogMsg(126,J(18,z(this.FUnitFilename,'"')),"",0,0,!0),null!==this.FPasModule&&this.FCompiler.RaiseInternalError(20180305190321,this.FUnitFilename),this.FReaderState=1;try{this.FCompiler.AddReadingModule(this),this.FPasResolver.FInterfaceOnly=this.FIsForeign,this.IsUnitReadFromPCU()?this.FPCUSupport.ReadUnit():(this.FIsMainFile?this.FParser.ParseMain({p:this,get:function(){return this.p.FPasModule},set:function(e){this.p.FPasModule=e}}):this.FParser.ParseSubModule({p:this,get:function(){return this.p.FPasModule},set:function(e){this.p.FPasModule=e}}),null===this.FParser.FCurModule?this.ReaderFinished():this.FReaderState=2)}catch(t){if(l.isPrototypeOf(t)){var e=t;throw t}if(d.isPrototypeOf(t)){e=t;this.HandleException(e)}else this.HandleJSException('[20181031190541] TPas2jsCompilerFile.ReadUnit File="'+this.FUnitFilename+'"',t)}1===this.FReaderState&&(this.FReaderState=5),null!==this.FPasModule&&null===this.FPasModule.FData&&(this.FPasModule.FData=this)},this.ReadContinue=function(){var e=!1;e=!0,this.FShowDebug&&this.FLog.LogPlain$1(J(18,'Debug: Continue reading unit "',18,this.FUnitFilename,18,'"...')),null===this.FPasModule&&this.FCompiler.RaiseInternalError(20180305190338,this.FUnitFilename),this.FReaderState=1;try{null!=this.FPCUSupport&&this.FPCUSupport.HasReader()?e=this.FPCUSupport.ReadContinue():(this.FParser.ParseContinue(),e=null===this.FParser.FCurModule),e?this.ReaderFinished():this.FReaderState=2}catch(e){if(l.isPrototypeOf(e)){var t=e;throw e}if(d.isPrototypeOf(e)){t=e;this.HandleException(t)}else this.HandleJSException('[20181031190545] TPas2jsCompilerFile.ReadContinue File="'+this.FUnitFilename+'"',e)}return 1===this.FReaderState&&(this.FReaderState=5),e},this.ReaderState=function(){var e=0,t=null;return 2===(e=this.FReaderState)&&(null!=this.FPCUSupport&&this.FPCUSupport.HasReader()?this.FPCUSupport.ReadCanContinue()&&(e=3):this.FParser.CanParseContinue({get:function(){return t},set:function(e){t=e}})&&(e=3)),e},this.CreateJS=function(){try{this.CreateConverter(),this.FConverter.FOnIsElementUsed=rtl.createCallback(this,"OnConverterIsElementUsed"),this.FConverter.FOnIsTypeInfoUsed=rtl.createCallback(this,"OnConverterIsTypeInfoUsed"),this.FJSModule=this.FConverter.ConvertPasElement(this.FPasModule,this.FPasResolver),1===this.FResourceHandler.$class.OutputMode()&&(this.FJSModule=this.FResourceHandler.WriteJS(this.FPasUnitName,this.FJSModule))}catch(t){if(l.isPrototypeOf(t)){var e=t;throw t}if(d.isPrototypeOf(t)){e=t;this.HandleException(e)}else this.HandleJSException('[20181031190549] TPas2jsCompilerFile.CreateJS File="'+this.FUnitFilename+'"',t)}},this.EmitModuleHints=function(){try{null!==this.FPCUSupport&&this.FPCUSupport.HasReader()||this.FUseAnalyzer.EmitModuleHints(this.FPasModule)}catch(t){if(l.isPrototypeOf(t)){var e=t;throw t}if(d.isPrototypeOf(t)){e=t;this.HandleException(e)}else this.HandleJSException('[20190226183324] TPas2jsCompilerFile.EmitModuleHints File="'+this.FUnitFilename+'"',t)}},this.GetPasMainUsesClause=function(){var e=[],t=null,s=null,i=null,r=null;return e=[],null===(t=this.GetCurPasModule())||(t.$class.ClassType()===W?null!==(s=t.InterfaceSection)&&(e=s.UsesClause):t.$class.ClassType()===_?null!==(i=t.ProgramSection)&&(e=i.UsesClause):t.$class.ClassType()===K&&null!==(r=t.LibrarySection)&&(e=r.UsesClause)),e},this.GetPasImplUsesClause=function(){var e,t=[];return t=[],null===(e=this.GetCurPasModule())||null!==e.ImplementationSection&&(t=e.ImplementationSection.UsesClause),t},this.GetCurPasModule=function(){return null!==this.FPasModule?this.FPasModule:null!==this.FPasResolver&&null!==this.FPasResolver.FRootElement?this.FPasResolver.FRootElement:null!==this.FParser?this.FParser.FCurModule:null},this.GetModuleName=function(){var e,t="";return""===(t=null!==(e=this.GetCurPasModule())?e.FName:"")&&(t=V(this.FUnitFilename)),t},this.GetFile=function(e){var t=null,s=null,i=null;return t=null,null===e||null===e.FData||(u.isPrototypeOf(e.FData)?t=e.FData:X.isPrototypeOf(e.FData)&&(s=e.FData,i=rtl.as(q(s.Owner),$),t=rtl.as(i.Owner,u))),t}}),rtl.createClass(this,"TPas2JSPostProcessorSupport",h,function(){0}),rtl.createClass(this,"TPas2JSConfigSupport",h,function(){this.$init=function(){h.$init.call(this),this.FConditionEval=null,this.FCurrentCfgFilename="",this.FCurrentCfgLineNumber=0},this.$final=function(){this.FConditionEval=void 0,h.$final.call(this)},this.CfgSyntaxError=function(e){this.FCompiler.FLog.Log(1,e,0,this.FCurrentCfgFilename,this.FCurrentCfgLineNumber,0,!0),this.FCompiler.Terminate(3)},this.ConditionEvalVariable=function(e,t,s){var i,r,n=null;return(i=this.FCompiler.FDefines.IndexOf(t))>=0?(null===(n=this.FCompiler.FDefines.GetObject(i))?s.set(c.CondDirectiveBool[1]):s.set(n.FValue),!0):0!==(r=Q(t))&&r in this.FCompiler.FModeSwitches?(s.set(c.CondDirectiveBool[1]),!0):false},this.ConditionEvalLog=function(e,t){this.CfgSyntaxError(Z(e.MsgPattern,t))},this.Create$1=function(e){return h.Create$1.call(this,e),this.FConditionEval=ee.$create("Create$1",[!1]),this.FConditionEval.FOnLog=rtl.createCallback(this,"ConditionEvalLog"),this.FConditionEval.FOnEvalVariable=rtl.createCallback(this,"ConditionEvalVariable"),this},this.Destroy=function(){S({p:this,get:function(){return this.p.FConditionEval},set:function(e){this.p.FConditionEval=e}}),m.Destroy.call(this)},this.LoadDefaultConfig=function(){var e;""!==(e=this.FindDefaultConfig())&&this.LoadConfig(e)};var e=rtl.createSet(null,97,122,null,65,90,95,null,48,57);this.LoadConfig=function(t){var s=this,i="",r=0,n=0,l=0;function a(){var t;for(l=n;n<=r&&(i.charCodeAt(n-1)in e||i.charAt(n-1)>"");)n+=1;for(t=E(i,l,n-l);n<=r&&i.charCodeAt(n-1)in rtl.createSet(32,9);)n+=1;return t}function o(e){s.FCompiler.FLog.LogMsg(119,J(18,z(i,'"'),18,e),s.FCurrentCfgFilename,s.FCurrentCfgLineNumber,1,!1)}var h="",u="",c="",p="",f=null,d=0,F=0,m=0,C=0;(this.FCompiler.GetShowDebug()||this.FCompiler.GetShowTriedUsedFiles())&&this.FCompiler.FLog.LogMsgIgnoreFilter(107,J(18,z(t,'"'))),d=0,F=0,C=0,f=null;try{for(h=this.FCurrentCfgFilename,this.FCurrentCfgFilename=t,m=this.FCurrentCfgLineNumber,f=this.GetReader(t);!f.IsEOF();)if(i=f.ReadLine(),this.FCurrentCfgLineNumber=f.FLineNumber,this.FCompiler.GetShowDebug()&&this.FCompiler.FLog.LogMsgIgnoreFilter(109,J(18,z(i,'"'))),""!==i){for(r=i.length,n=1;n<=r&&i.charCodeAt(n-1)in rtl.createSet(32,9);)n+=1;if(!(n>r))if(n<=r&&"#"===i.charAt(n-1)){if((n+=1)>r||i.charCodeAt(n-1)in rtl.createSet(0,9,32,45))continue;var S=u=te(a());"ifdef"===S||"ifndef"===S?(d+=1,0===C&&(c=a(),this.FCompiler.IsDefined(c)===("ifdef"===u)?this.FCompiler.GetShowDebug()&&o("true -> execute"):(this.FCompiler.GetShowDebug()&&o("false -> skip"),F=d,C=1))):"if"===S?(d+=1,0===C&&(p=E(i,n,i.length),this.FConditionEval.Eval(p)?this.FCompiler.GetShowDebug()&&o("true -> execute"):(this.FCompiler.GetShowDebug()&&o("false -> skip"),F=d,C=1))):"else"===S?(0===d&&this.CfgSyntaxError('"'+u+'" without #ifdef'),2===C&&d===F&&this.CfgSyntaxError('"there was already an #else'),1===C&&d===F?(this.FCompiler.GetShowDebug()&&o("execute"),F=0,C=0):0===C&&(this.FCompiler.GetShowDebug()&&o("skip"),C=2,F=d)):"elseif"===S?(0===d&&this.CfgSyntaxError('"'+u+'" without #ifdef'),1===C&&d===F?(p=E(i,n,i.length),this.FConditionEval.Eval(p)?(this.FCompiler.GetShowDebug()&&o("true -> execute"),F=0,C=0):this.FCompiler.GetShowDebug()&&o("false -> skip")):0===C&&(this.FCompiler.GetShowDebug()&&o("no test -> skip"),C=1)):"endif"===S?(0===d&&this.CfgSyntaxError('"'+u+'" without #ifdef'),(d-=1)<F&&(this.FCompiler.GetShowDebug()&&o("end block"),F=0,C=0)):"error"===S?this.FCompiler.ParamFatal("user defined: "+E(i,n,i.length)):0===C?this.CfgSyntaxError('unknown directive "#'+u+'"'):o("skipping unknown directive")}else 0===C&&(i=E(i,n,i.length),this.FCompiler.ReadParam(i,!1,!1))}}finally{this.FCurrentCfgFilename=h,this.FCurrentCfgLineNumber=m,f=rtl.freeLoc(f)}(this.FCompiler.GetShowDebug()||this.FCompiler.GetShowTriedUsedFiles())&&this.FCompiler.FLog.LogMsgIgnoreFilter(108,J(18,z(t,'"')))},this.LoadSubTargetConfig=function(e){var t;""===(t=this.FindSubtargetConfig(e))?(this.FCompiler.FLog.Log(0,se(s.sSubtargetConfigNotFound,J(18,e)),147,"",0,0,!0),this.FCompiler.Terminate(4)):this.LoadConfig(t)}}),rtl.createClass(this,"TPas2jsCompiler",m,function(){this.$init=function(){m.$init.call(this),this.FAllJSIntoMainJS=!1,this.FCompilerExe="",this.FConfigSupport=null,this.FConverterGlobals=null,this.FDefines=null,this.FFiles=null,this.FFS=null,this.FHasShownEncoding=!1,this.FHasShownLogo=!1,this.FInsertFilenames=null,this.FAppendFilenames=null,this.FInterfaceType=0,this.FLog=null,this.FMainFile=null,this.FMainJSFile="",this.FMainJSFileIsResolved=!1,this.FMainJSFileResolved="",this.FMainSrcFile="",this.FModeSwitches={},this.FNamespaces=null,this.FNamespacesFromCmdLine=0,this.FOptions={},this.FOwnsFS=!1,this.FParamMacros=null,this.FPostProcessorSupport=null,this.FPrecompileGUID=ie.$new(),this.FReadingModules=null,this.FResolverHub=null,this.FRTLVersionCheck=0,this.FSrcMapBaseDir="",this.FSrcMapSourceRoot="",this.FUnits=null,this.FWPOAnalyzer=null,this.FResourceMode=0,this.FResources=null,this.FResourceStrings=null,this.FResourceStringFile=0,this.FImports=null,this.FCurParam="",this.FResourceOutputFile="",this.FSubTarget=""},this.$final=function(){this.FConfigSupport=void 0,this.FConverterGlobals=void 0,this.FDefines=void 0,this.FFiles=void 0,this.FFS=void 0,this.FInsertFilenames=void 0,this.FAppendFilenames=void 0,this.FLog=void 0,this.FMainFile=void 0,this.FModeSwitches=void 0,this.FNamespaces=void 0,this.FOptions=void 0,this.FParamMacros=void 0,this.FPostProcessorSupport=void 0,this.FPrecompileGUID=void 0,this.FReadingModules=void 0,this.FResolverHub=void 0,this.FUnits=void 0,this.FWPOAnalyzer=void 0,this.FResources=void 0,this.FResourceStrings=void 0,this.FImports=void 0,m.$final.call(this)},this.AddInsertJSFilename=function(e){this.IndexOfInsertJSFilename(e)<0&&this.FInsertFilenames.Add(e)},this.AddAppendJSFilename=function(e){this.IndexOfAppendJSFilename(e)<0&&this.FAppendFilenames.Add(e)},this.AddNamespaces=function(e,t){var s=this,i=0;function r(e){var r=!1,n=0;if(r=!1,"-"===e.charAt(e.length-1)&&(re({get:function(){return e},set:function(t){e=t}},e.length,1),r=!0),!y(e,!0,!0))return!1;for(n=s.FNamespaces.GetCount()-1;n>=0&&0!==g(e,s.FNamespaces.Get(n));)n-=1;if(r)return n>=0&&(s.FNamespaces.Delete(n),s.FNamespacesFromCmdLine>n&&(s.FNamespacesFromCmdLine-=1)),!0;if(t){if(n>=0){if(n<=s.FNamespacesFromCmdLine)return!0;s.FNamespaces.Delete(n)}s.FNamespaces.Insert(s.FNamespacesFromCmdLine,e),s.FNamespacesFromCmdLine+=1}else{if(n>=0){if(n<=s.FNamespacesFromCmdLine+i)return!0;s.FNamespaces.Delete(n)}s.FNamespaces.Insert(s.FNamespacesFromCmdLine+i,e),i+=1}return true}var n="",l=0;for(l=1,i=0;l<=e.length;)if(""!==(n=le(e,";",{get:function(){return l},set:function(e){l=e}}))&&!r(n))return},this.AddUnitResourceStrings=function(e){var t=this,i=null;function r(s){null!=s&&null!=s.ResStrings&&(2===t.FResourceStringFile?function(t){for(var s=0,r=0,n=t.FCount-1;r<=n;r++)s=r,e.FUseAnalyzer.IsUsed(rtl.getObject(t.Get(s)))&&i.Add(t.Get(s))}(s.ResStrings):function(e){for(var t=0,s=0,r=e.FCount-1;s<=r;s++)t=s,i.Add(e.Get(t))}(s.ResStrings))}var n=0,l=null,a=null;1===this.FResourceStringFile&&this.FResourceStrings.Clear(),i=L.$create("Create");try{if(_.isPrototypeOf(e.FPasModule)?r(e.FPasModule.ProgramSection):K.isPrototypeOf(e.FPasModule)?r(e.FPasModule.LibrarySection):(r(e.FPasModule.InterfaceSection),r(e.FPasModule.ImplementationSection)),i.FCount>0){this.FResourceStrings.StartUnit(e.GetModuleName());for(var o=0,h=i.FCount-1;o<=h;o++){n=o,l=rtl.getObject(i.Get(n)),8===(a=e.FPasResolver.Eval(l.Expr,rtl.createSet(0),!1)).Kind?this.FResourceStrings.AddString(l.FName,a.S):this.FLog.Log(3,s.sSkipNoConstResourcestring,145,e.FPasFileName,0,0,!0),oe({get:function(){return a},set:function(e){a=e}})}}}finally{i=rtl.freeLoc(i)}},this.CreateFileWriter=function(e,t){var s=null,i=null,r="";return""===(r=t)&&(r=e.FJSFilename),(s=this.CreateJSMapper()).FDestFileName=r,this.GetSrcMapEnable()&&(i=this.CreateSrcMap(he(r)),s.SetSrcMap(i),i.Release(),i.FSourceRoot=this.FSrcMapSourceRoot,i.LocalFilename=e.FJSFilename,this.GetSrcMapXSSIHeader()?i.FOptions=rtl.unionSet(i.FOptions,rtl.createSet(2)):i.FOptions=rtl.diffSet(i.FOptions,rtl.createSet(2)),i.FOptions=rtl.unionSet(i.FOptions,rtl.createSet(3))),s},this.EmitJavaScript=function(e,t){var s=null;s=this.CreateJSWriter(t);try{s.SetOptions(rtl.refSet(p.DefaultJSWriterOptions)),s.FIndentSize=2;try{s.WriteJS(e.FJSModule)}catch(e){if(d.isPrototypeOf(e)){var i=e;this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(i),this.FLog.LogPlain("[20180204193420] Error while creating JavaScript "+this.FullFormatPath(t.FDestFileName)+": "+i.fMessage),this.Terminate(1)}else this.HandleJSException("[20181031190520] TPas2jsCompiler.WriteJSFiles Error while creating JavaScript",e,!0)}}finally{s=rtl.freeLoc(s)}},this.GetDefaultNamespace=function(){var e,t="";return t="",null===this.FMainFile||null===this.FMainFile.FPasModule||(e=this.FMainFile.FPasModule.$class.ClassType())!==_&&e!==K&&e!==ue||(t=this.FMainFile.FPasResolver.FDefaultNameSpace),t},this.GetFileCount=function(){return this.FFiles.Count()},this.GetResolvedMainJSFile=function(){return this.FMainJSFileIsResolved||(this.FMainJSFileResolved=this.ResolvedMainJSFile(),this.FMainJSFileIsResolved=!0),this.FMainJSFileResolved},this.GetShowDebug=function(){return 12 in this.FOptions},this.GetShowLogo=function(){return 2 in this.FOptions},this.GetShowTriedUsedFiles=function(){return 9 in this.FOptions},this.GetShowUsedTools=function(){return 11 in this.FOptions},this.GetSkipDefaultConfig=function(){return 0 in this.FOptions},this.GetSrcMapEnable=function(){return 31 in this.FOptions},this.GetSrcMapInclude=function(){return 32 in this.FOptions},this.GetSrcMapFilenamesAbsolute=function(){return 33 in this.FOptions},this.GetSrcMapXSSIHeader=function(){return 34 in this.FOptions},this.GetTargetPlatform=function(){return this.FConverterGlobals.TargetPlatform},this.GetTargetProcessor=function(){return this.FConverterGlobals.TargetProcessor},this.GetWriteDebugLog=function(){return 23 in this.FOptions},this.IndexOfInsertJSFilename=function(e){for(var t=0,s=0,i=this.FInsertFilenames.GetCount()-1;s<=i;s++)if(t=s,this.FFS.SameFileName(e,this.FInsertFilenames.Get(t)))return t;return-1},this.IndexOfAppendJSFilename=function(e){for(var t=0,s=0,i=this.FAppendFilenames.GetCount()-1;s<=i;s++)if(t=s,this.FFS.SameFileName(e,this.FAppendFilenames.Get(t)))return t;return-1},this.InsertCustomJSFiles=function(e){var t=0,s="",i=null,r=null;if(0!==this.FInsertFilenames.GetCount()){i=this.FFS.CreateResolver();try{for(var n=0,l=this.FInsertFilenames.GetCount()-1;n<=l;n++)t=n,""===(s=this.FFS.FindCustomJSFileName(this.FInsertFilenames.Get(t)))&&(this.FLog.LogMsg(206,J(18,this.FInsertFilenames.Get(t)),"",0,0,!0),this.Terminate(4)),""!==(r=this.LoadFile(s,!1)).FSource&&e.WriteFile(r.FSource,s)}finally{i=rtl.freeLoc(i)}}},this.AppendCustomJSFiles=function(e){var t=0,s="",i=null,r=null;if(0!==this.FAppendFilenames.GetCount()){i=this.FFS.CreateResolver();try{for(var n=0,l=this.FAppendFilenames.GetCount()-1;n<=l;n++)t=n,""===(s=this.FFS.FindCustomJSFileName(this.FAppendFilenames.Get(t)))&&(this.FLog.LogMsg(206,J(18,this.FAppendFilenames.Get(t)),"",0,0,!0),this.Terminate(4)),""!==(r=this.LoadFile(s,!1)).FSource&&e.WriteFile(r.FSource,s)}finally{i=rtl.freeLoc(i)}}},this.InsertImportSection=function(e){var t=null;if(0!==this.FImports.FStatements.GetCount()){t=this.CreateJSWriter(e);try{t.SetOptions(rtl.refSet(p.DefaultJSWriterOptions)),t.FIndentSize=2;try{t.WriteJS(this.FImports)}catch(t){if(d.isPrototypeOf(t)){var s=t;this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(s),this.FLog.LogPlain("[20210911104700] Error while creating JavaScript "+this.FullFormatPath(e.FDestFileName)+": "+s.fMessage),this.Terminate(1)}else this.HandleJSException("[20210911104700] TPas2jsCompiler.WriteJSFiles Error while creating JavaScript",t,!0)}}finally{t=rtl.freeLoc(t)}}},this.LoadUsedUnit=function(e,t){function i(e,t,s){var r=0,n=null;s.get().Add(e);for(var l=0,a=e.GetUsedByCount(0)-1;l<=a;l++){if(r=l,(n=e.GetUsedBy(0,r))===t)return s.get().Clear(),s.get().Add(n),s.get().Add(e),!0;if(!(s.get().IndexOf(n)>=0)&&i(n,t,s))return s.get().Add(e),!0}return false}var r=null;function n(){var n=0,l=null,a="";if(null===t.FPasModule.ImplementationSection){r.FUsedBy[0].Add(t),l=L.$create("Create");try{if(i(r,r,{get:function(){return l},set:function(e){l=e}})){a="";for(var o=0,h=l.FCount-1;o<=h;o++)(n=o)>0&&(a+=","),a+=rtl.getObject(l.Get(n)).GetModuleName();t.FPasResolver.RaiseMsg(20180223141537,120,s.sUnitCycle,J(18,a),e.NameExpr)}}finally{l=rtl.freeLoc(l)}}else r.FUsedBy[1].Add(t)}var l="",a=null;return null!==(r=this.FindFileWithUnitFilename(e.UseFilename))?(""!==r.FPasUnitName&&0!==g(r.FPasUnitName,e.UseUnitname)&&(this.FLog.LogPlain$1(J(18,'Debug: TPas2jsPasTree.FindUnit unitname MISMATCH aFile.PasUnitname="',18,r.FPasUnitName,9,'"',18," Self=",18,t.FFileResolver.FFS.FormatPath(t.FUnitFilename),18," Uses=",18,e.UseUnitname,18," IsForeign=",1,t.FIsForeign)),this.RaiseInternalError(20170504161412,"TPas2jsPasTree.FindUnit unit name mismatch")),n()):(""!==e.InFilename&&null!==(r=this.FindLoadedUnit(e.UseUnitname))&&t.FPasResolver.RaiseMsg(20180223141323,205,x.sDuplicateFileFound,J(18,e.UseFilename,18,r.FUnitFilename),e.InFileExpr),l="",t.FIsForeign||(l=this.FindUnitJSFileName(e.UseFilename)),this.LoadModuleFile(e.UseFilename,e.UseUnitname,{get:function(){return r},set:function(e){r=e}},e.IsPCU),r.FPasUnitName!==e.UseUnitname&&this.RaiseInternalError(20170922143329,"aFile.PasUnitName="+r.FPasUnitName+" UseUnitname="+e.UseUnitname),e.IsPCU?this.FFS.SameFileName(r.FPCUFilename,e.UseFilename)||this.RaiseInternalError(20180312122331,"aFile.PCUFilename="+r.FPCUFilename+" UseFilename="+e.UseFilename):this.FFS.SameFileName(r.FUnitFilename,e.UseFilename)||this.RaiseInternalError(20170922143330,"aFile.UnitFilename="+r.FUnitFilename+" UseFilename="+e.UseFilename),r===t&&t.FParser.RaiseParserError(120,J(18,e.UseUnitname)),this.AddUsedUnit(r),a=this.FindLoadedUnit(e.UseUnitname),r!==a&&(null===a?this.RaiseInternalError(20170922143405,"UseUnitname="+e.UseUnitname):this.RaiseInternalError(20170922143511,"UseUnitname="+e.UseUnitname+" Found="+a.FPasUnitName)),a=this.FindFileWithUnitFilename(e.UseFilename),r!==a&&(null===a?this.RaiseInternalError(20180224094625,"UseFilename="+e.UseFilename):this.RaiseInternalError(20180224094627,"UseFilename="+e.UseFilename+" Found="+a.FUnitFilename)),n(),r.FJSFilename=l,r.FIsForeign=e.UseIsForeign,r.ReadUnit()),r},this.OnMacroCfgDir=function(e,t,s){return t.set(j(this.FConfigSupport.FCurrentCfgFilename)),true},this.RemoveInsertJSFilename=function(e){var t;(t=this.IndexOfInsertJSFilename(e))>=0&&this.FInsertFilenames.Delete(t)},this.RemoveAppendJSFilename=function(e){var t;(t=this.IndexOfAppendJSFilename(e))>=0&&this.FAppendFilenames.Delete(t)},this.ResolvedMainJSFile=function(){var e,t,s="";return e=this.FFS.FDefaultOutputPath,t=this.FFS.FUnitOutputPath,"."===this.FMainJSFile?s="":""!==(s=this.FMainJSFile)?""===j(s)&&(""!==e?s=e+s:""!==t&&(s=t+s)):(s=ce(this.FMainSrcFile,".js"),""!==e?s=e+he(s):""!==t&&(s=t+he(s))),s},this.SetAllJSIntoMainJS=function(e){this.FAllJSIntoMainJS!==e&&(e&&(this.FMainJSFileIsResolved=!1),this.FAllJSIntoMainJS=e)},this.SetConverterGlobals=function(e){e!==this.FConverterGlobals&&(null!==this.FConverterGlobals&&this.FConverterGlobals.FOwner===this&&S({p:this,get:function(){return this.p.FConverterGlobals},set:function(e){this.p.FConverterGlobals=e}}),this.FConverterGlobals=e)},this.SetCompilerExe=function(e){""!==e&&(e=this.ExpandFileName(e)),this.FCompilerExe!==e&&(this.FCompilerExe=e)},this.SetFS=function(e){this.FFS!==e&&(this.FOwnsFS=!1,this.FFS=e)},this.SetMode=function(e){this.SetModeSwitches(s.p2jsMode_SwitchSets[e]);(0===e||1===e)&&this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(18)))},this.SetModeSwitches=function(e){rtl.eqSet(this.FModeSwitches,e)||(this.FModeSwitches=rtl.refSet(e))},this.SetOptions=function(e){rtl.eqSet(this.FOptions,e)||(this.FOptions=rtl.refSet(e),this.FLog.FShowMsgNumbers=13 in this.FOptions,this.FLog.FShowMsgTypes=rtl.refSet(this.GetShownMsgTypes()),this.FFS.SetOptionFromIndex(1,9 in this.FOptions))},this.SetShowDebug=function(e){this.FOptions=e?rtl.unionSet(this.FOptions,rtl.createSet(5,7,12)):rtl.excludeSet(this.FOptions,5)},this.SetShowFullPaths=function(e){this.FFS.SetOptionFromIndex(0,e)},this.SetShowLogo=function(e){this.SetOption(2,e)},this.SetShowTriedUsedFiles=function(e){this.FFS.SetOptionFromIndex(1,e),this.SetOption(9,e)},this.SetSkipDefaultConfig=function(e){this.SetOption(0,e)},this.SetSrcMapBaseDir=function(e){var t;t=this.FFS.ExpandDirectory(e),this.FSrcMapBaseDir!==t&&(this.FSrcMapBaseDir=t)},this.SetSrcMapEnable=function(e){this.SetOption(31,e)},this.SetSrcMapInclude=function(e){this.SetOption(32,e)},this.SetSrcMapFilenamesAbsolute=function(e){this.SetOption(33,e)},this.SetSrcMapXSSIHeader=function(e){this.SetOption(34,e)},this.SetTargetPlatform=function(e){var t;(t=this.FConverterGlobals.TargetPlatform)!==e&&(this.RemoveDefine(p.PasToJsPlatformNames[t]),this.FConverterGlobals.TargetPlatform=e,e in rtl.createSet(1,3)&&this.SetAllJSIntoMainJS(!0),this.AddDefinesForTargetPlatform())},this.SetTargetProcessor=function(e){var t;(t=this.FConverterGlobals.TargetProcessor)!==e&&(this.RemoveDefine(p.PasToJsProcessorNames[t]),this.FConverterGlobals.TargetProcessor=e,this.AddDefinesForTargetProcessor())},this.SetWriteMsgToStdErr=function(e){this.SetOption(24,e)},this.WriteJSToFile=function(e,t){var s=null,i=!1;try{s=new Array;try{i=""===this.FLog.FEncoding||"utf8"===this.FLog.FEncoding,t.SaveJSToStream(i,he(e),s),this.FFS.SaveToFile(s,t.FDestFileName)}finally{s=null}}catch(e){if(d.isPrototypeOf(e)){var r=e;this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(r),this.FLog.LogPlain("Error: "+r.fMessage),this.FLog.LogMsg(116,J(18,this.FullFormatPath(t.FDestFileName)),"",0,0,!0),this.Terminate(5)}else this.HandleJSException("[20181031190637] TPas2jsCompiler.WriteJSFiles",e,!0)}},this.WriteResourceStrings=function(e){var t=null,s="";this.FLog.LogMsg(117,J(18,this.FullFormatPath(e)),"",0,0,!1);try{t=new Array;try{s=this.FResourceStrings.AsString(),t.push(s),this.FFS.SaveToFile(t,e)}finally{t=null}}catch(t){if(d.isPrototypeOf(t)){var i=t;this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(i),this.FLog.LogPlain("Error: "+i.fMessage),this.FLog.LogMsg(116,J(18,this.FullFormatPath(e)),"",0,0,!0),this.Terminate(5)}else this.HandleJSException("[20181031190737] TPas2jsCompiler.WriteJSFiles",t,!0)}},this.WriteResources=function(e){var t=null,s="";this.FLog.LogMsg(117,J(18,this.FullFormatPath(e)),"",0,0,!1);try{t=new Array;try{s=this.FResources.GetAsString(),t.push(s),this.FFS.SaveToFile(t,e)}finally{t=null}}catch(t){if(d.isPrototypeOf(t)){var i=t;this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(i),this.FLog.LogPlain("Error: "+i.fMessage),this.FLog.LogMsg(116,J(18,this.FullFormatPath(e)),"",0,0,!0),this.Terminate(5)}else this.HandleJSException("[20181031190737] TPas2jsCompiler.WriteJSFiles",t,!0)}},this.WriteSrcMap=function(e,t){var s=null;this.FLog.LogMsg(117,J(18,this.FullFormatPath(e)),"",0,0,!(8 in this.FOptions)),this.FinishSrcMap(t.FSrcMap);try{s=new Array;try{t.FSrcMap.SaveToStream(s),this.FFS.SaveToFile(s,e)}finally{s=null}}catch(t){if(d.isPrototypeOf(t)){var i=t;this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(i),this.FLog.LogPlain("Error: "+i.fMessage),this.FLog.LogMsg(116,J(18,this.FullFormatPath(e)),"",0,0,!0),this.Terminate(5)}else this.HandleJSException("[20181031190737] TPas2jsCompiler.WriteJSFiles",t,!0)}},this.AddDefinesForTargetPlatform=function(){this.AddDefine(p.PasToJsPlatformNames[this.GetTargetPlatform()]),this.AddDefine$1("Pas2JSTargetOS",p.PasToJsPlatformNames[this.GetTargetPlatform()])},this.AddDefinesForTargetProcessor=function(){this.AddDefine(p.PasToJsProcessorNames[this.GetTargetProcessor()]),this.AddDefine$1("Pas2JSTargetCPU",p.PasToJsProcessorNames[this.GetTargetProcessor()]);var e=this.GetTargetProcessor();0===e?this.AddDefine$1("ECMAScript","5"):1===e&&this.AddDefine$1("ECMAScript","6")},this.AddReadingModule=function(e){this.FReadingModules.IndexOf(e)>=0||this.FReadingModules.Add(e)},this.RemoveReadingModule=function(e){this.FReadingModules.Remove(e)},this.RegisterMessages=function(){var e=this,t=0;function i(s,i,r){var n="";t>=0&&i!==t+1&&(n=i>t+1?"TPas2jsCompiler.RegisterMessages: gap in registered message numbers: "+pe(t+1)+" "+pe(i):"TPas2jsCompiler.RegisterMessages: not ascending order in registered message numbers: Last="+pe(t)+" New="+pe(i),e.RaiseInternalError(20170504161422,n)),e.FLog.RegisterMsg(s,i,r),t=i}t=-1,i(5,101,s.sOptionIsEnabled),i(5,102,s.sSyntaxModeIs),i(5,103,s.sModeswitchXisY),t=-1,i(5,104,x.sUsingPath),i(3,105,x.sFolderNotFound),i(5,106,s.sNameValue),i(5,107,s.sReadingOptionsFromFile),i(5,108,s.sEndOfReadingConfigFile),i(6,109,s.sInterpretingFileOption),i(0,110,s.sSourceFileNotFound),i(0,111,s.sFileIsFolder),i(5,112,s.sConfigFileSearch),i(6,113,s.sHandlingOption),i(6,114,s.sQuickHandlingOption),i(0,115,s.sOutputDirectoryNotFound),i(1,116,s.sUnableToWriteFile),i(5,117,s.sWritingFile),i(0,118,s.sCompilationAborted),i(6,119,s.sCfgDirective),i(1,120,s.sUnitCycle),i(1,121,s.sOptionForbidsCompile),i(5,122,s.sUnitsNeedCompileDueToUsedUnit),i(5,123,s.sUnitsNeedCompileDueToOption),i(5,124,s.sUnitsNeedCompileJSMissing),i(5,125,s.sUnitsNeedCompilePasHasChanged),i(5,126,s.sParsingFile),i(5,127,s.sCompilingFile),i(1,128,s.sExpectedButFound),i(5,129,s.sLinesInFilesCompiled),i(5,130,s.sTargetPlatformIs),i(5,131,s.sTargetProcessorIs),i(5,132,s.sMessageEncodingIs),i(1,133,s.sUnableToTranslatePathToDir),i(5,134,s.sSrcMapSourceRootIs),i(5,135,s.sSrcMapBaseDirIs),i(0,136,s.sUnitFileNotFound),i(5,137,s.sClassInterfaceStyleIs),i(5,138,s.sHandlingEnvOpts),i(5,139,s.sPostProcessorInfoX),i(5,140,s.sPostProcessorRunX),i(1,141,s.sPostProcessorFailX),i(2,142,s.sPostProcessorWarnX),i(5,143,s.sPostProcessorFinished),i(5,144,s.sRTLIdentifierChanged),i(3,145,s.sSkipNoConstResourcestring),i(2,146,s.sUnknownOptimizationOption),fe(this.FLog)},this.LoadConfig=function(e){this.FConfigSupport.LoadConfig(e)},this.ReadEnvironment=function(){var e="",t=null;if(""!==(e=de("PAS2JS_OPTS"))){this.GetShowDebug()&&this.FLog.LogMsgIgnoreFilter(138,J(18,"PAS2JS_OPTS=["+e+"]")),t=Fe.$create("Create$1");try{me(e,t,!1);var s=t.GetEnumerator();try{for(;s.MoveNext();)""!==(e=s.GetCurrent())&&this.ReadParam(e,!1,!1)}finally{s=rtl.freeLoc(s)}}finally{t=rtl.freeLoc(t)}}},this.ReadParam=function(e,t,s){var i=this;function r(){i.ParamFatal('unknown parameter "'+e+'". Use -h for help.')}var n,l="",a="",o="",h="",u=0,c=0,f="\0",d=0,F=0;if(this.GetShowDebug()&&(t?this.FLog.LogMsgIgnoreFilter(114,J(18,z(e,'"'))):this.FLog.LogMsgIgnoreFilter(113,J(18,z(e,'"')))),""!==e&&(this.FCurParam=e,this.FParamMacros.Substitute({get:function(){return e},set:function(t){e=t}},i,0,!0),""!==e)){!t||"-h"!==e&&"-?"!==e&&"--help"!==e||(this.WriteHelp(),this.Terminate(0)),n=e.length,u=1;var m=e.charAt(u-1);if("-"===m){(u+=1)>n&&r(),h=E(e,u+1,e.length);var C=e.charAt(u-1);if("i"===C)this.HandleOptionInfo(h),this.Terminate(0);else if("B"===C||"l"===C||"n"===C){this.ReadSingleLetterOptions(e,u,"Bln",{get:function(){return l},set:function(e){l=e}},{get:function(){return a},set:function(e){a=e}});for(var S=1,T=l.length;S<=T;S++){c=S;var g=l.charAt(c-1);"B"===g?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(1))):"l"===g?this.SetShowLogo(!0):"n"===g&&this.SetSkipDefaultConfig(!0)}for(var I=1,R=a.length;I<=R;I++){c=I;var v=a.charAt(c-1);"B"===v?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(1))):"l"===v?this.SetShowLogo(!1):"n"===v&&this.SetSkipDefaultConfig(!1)}}else if("C"===C)this.ReadCodeGenerationFlags(h,1);else if("d"===C)t||((c=Ce(":=",o=h))>0?(h=E(o,c+2,o.length),o=P(o,c-1),y(o,!1,!1)||this.ParamFatal('invalid define name (-d): "'+e+'"'),this.AddDefine$1(o,h)):(y(o,!1,!1)||this.ParamFatal('invalid define (-d): "'+e+'"'),this.AddDefine(o)));else if("F"===C)""===h&&r(),f=h.charAt(0),re({get:function(){return h},set:function(e){h=e}},1,1),this.HandleOptionPaths(f,h,s)||r();else if("I"===C)t||this.HandleOptionPaths("i",h,s)||r();else if("J"===C)""===h&&r(),f=h.charAt(0),re({get:function(){return h},set:function(e){h=e}},1,1),this.HandleOptionJ(f,h,t,s)||r();else if("M"===C)this.HandleOptionM(h,t)||r();else if("N"===C){""===h&&r(),"S"===h.charAt(0)?(this.FLog.Log(2,"obsolete option -NS, use -FN instead",0,"",0,0,!0),re({get:function(){return h},set:function(e){h=e}},1,1),this.HandleOptionPaths("N",h,s)):r()}else if("o"===C)""===h?this.ParamFatal("invalid empty output file (-o)"):".."===h?this.ParamFatal('invalid output file (-o) "'+h+'"'):"."===h||(h=this.ExpandFileName(h)),this.FMainJSFile=h;else if("O"===C)""===h&&r(),f=h.charAt(0),re({get:function(){return h},set:function(e){h=e}},1,1),this.HandleOptionOptimization(f,h)||r();else if("P"===C){for(var A=0;A<=1;A++)if(d=A,Se(h,p.PasToJsProcessorNames[d])){this.SetTargetProcessor(d),h="";break}""!==h&&this.ParamFatal('invalid target processor (-P) "'+h+'"')}else if("S"===C)(u+=1)<=n&&"I"===e.charAt(u-1)?(o=E(e,u,e.length),Se(o,"com")?this.FInterfaceType=0:Se(o,"corba")?this.FInterfaceType=1:this.ParamFatal('invalid interface style (-SI) "'+o+'"')):this.ReadSyntaxFlags(e,u);else if("t"===C)s||this.ParamFatal("subtarget -t parameter can only be passed as cmd line parameter"),u+=1,this.SetSubTarget(E(e,u,e.length));else if("T"===C){o=E(e,u+=1,e.length);for(var N=0;N<=3;N++)if(F=N,Se(o,p.PasToJsPlatformNames[F])){this.SetTargetPlatform(F),o="";break}""!==o&&this.ParamFatal('invalid target platform (-T) "'+o+'"')}else"u"===C?t||(y(h,!1,!1)||this.ParamFatal('invalid undefine (-u): "'+h+'"'),this.RemoveDefine(h)):"v"===C?(u+=1,this.ReadVerbosityFlags(e,u)):r()}else"@"===m?t||this.HandleOptionConfigFile(c,E(e,2,e.length)):t||(s||this.FConfigSupport.CfgSyntaxError("invalid parameter"),""!==this.FMainSrcFile&&this.ParamFatal('Only one Pascal file is supported, but got "'+this.FMainSrcFile+'" and "'+e+'".'),this.FMainSrcFile=this.ExpandFileName(e))}},this.ReadSingleLetterOptions=function(e,t,s,i,r){var n,l="\0",a=0;for(t>(n=e.length)&&this.ParamFatal('Invalid option "'+e+'"'),i.set(""),r.set("");t<=n;)"-"===(l=e.charAt(t-1))&&this.ParamFatal('Invalid option "'+e+'"'),Ce(l,s)<1&&this.ParamFatal('unknown option "'+e+'". Use -h for help.'),(t+=1)<=n&&"-"===e.charAt(t-1)?(Ce(l,r.get())<1&&r.set(l),(a=Ce(l,i.get()))>0&&re(i,a,1),t+=1):(Ce(l,i.get())<1&&i.set(l),(a=Ce(l,r.get()))>0&&re(r,a,1),t<=n&&"+"===e.charAt(t-1)&&(t+=1))},this.ReadCodeGenerationFlags=function(e,t){var s="",i="",r=0;this.ReadSingleLetterOptions(e,t,"orR",{get:function(){return s},set:function(e){s=e}},{get:function(){return i},set:function(e){i=e}});for(var n=1,l=s.length;n<=l;n++){r=n;var a=s.charAt(r-1);"o"===a?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(14))):"r"===a?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(15))):"R"===a&&this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(16)))}for(var o=1,h=i.length;o<=h;o++){r=o;var u=i.charAt(r-1);"o"===u?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(14))):"r"===u?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(15))):"R"===u&&this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(16)))}},this.ReadSyntaxFlags=function(e,t){var s="",i="",r=0;this.ReadSingleLetterOptions(e,t,"2acdmj",{get:function(){return s},set:function(e){s=e}},{get:function(){return i},set:function(e){i=e}});for(var n=1,l=s.length;n<=l;n++){r=n;var a=s.charAt(r-1);"2"===a?this.SetMode(0):"a"===a?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(17))):"c"===a?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(18))):"d"===a?this.SetMode(1):"m"===a?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(19))):"j"===a&&this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(20)))}for(var o=1,h=i.length;o<=h;o++){r=o;var u=i.charAt(r-1);"2"===u||("a"===u?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(17))):"c"===u?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(18))):"d"===u||("m"===u?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(19))):"j"===u&&this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(20)))))}},this.ReadVerbosityFlags=function(e,t){var i,r="",n="",l=0;if(!(t>(i=e.length)))if("m"!==e.charAt(t-1)){this.ReadSingleLetterOptions(e,t,"ewnhila0bctdqxvz",{get:function(){return r},set:function(e){r=e}},{get:function(){return n},set:function(e){n=e}});for(var a=1,o=r.length;a<=o;a++){l=a;var h=r.charAt(l-1);"e"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(3))):"w"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(4))):"n"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(5))):"h"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(6))):"i"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(7))):"l"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(8))):"a"===h?this.SetOptions(rtl.unionSet(this.FOptions,s.coShowAll)):"0"===h?this.SetOptions(rtl.unionSet(rtl.diffSet(this.FOptions,s.coShowAll),rtl.createSet(3))):"b"===h?this.SetShowFullPaths(!0):"c"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(10,7))):"t"===h?this.SetShowTriedUsedFiles(!0):"d"===h?this.SetShowDebug(!0):"q"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(13))):"x"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(11))):"v"===h?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(23))):"z"===h&&this.SetWriteMsgToStdErr(!0)}for(var u=1,c=n.length;u<=c;u++){l=u;var p=n.charAt(l-1);"e"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(3))):"w"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(4))):"n"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(5))):"h"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(6))):"i"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(7))):"l"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(8))):"a"===p||"0"===p||("b"===p?this.SetShowFullPaths(!1):"c"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(10))):"t"===p?this.SetShowTriedUsedFiles(!1):"d"===p?this.SetShowDebug(!1):"q"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(13))):"x"===p?this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(11))):"v"===p?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(23))):"z"===p&&this.SetWriteMsgToStdErr(!1))}}else for(;;){((t+=1)>i||!(e.charCodeAt(t-1)in rtl.createSet(null,48,57)))&&this.ParamFatal('missing number in "'+e+'"'),l=0;for(;t<=i&&e.charCodeAt(t-1)in rtl.createSet(null,48,57);)(l=10*l+e.charCodeAt(t-1)-48)>99999&&this.ParamFatal('Invalid -vm parameter in "'+e+'"'),t+=1;if(t<=i&&"-"===e.charAt(t-1)?(t+=1,this.FLog.SetMsgNumberDisabled(l,!1)):this.FLog.SetMsgNumberDisabled(l,!0),t>i)break;","!==e.charAt(t-1)&&this.ParamFatal('Invalid option "'+e+'"')}},this.SetSubTarget=function(e){this.FSubTarget!==e&&(this.FSubTarget=e,this.AddDefine$1("FPC_SUBTARGET",Te(e)),this.AddDefine("FPC_SUBTARGET_"+Te(e)))},this.CreateImportList=function(){return ge.$create("Create$1",[0,0,""])},this.CreateImportStatement=function(){return Ee.$create("Create$1",[0,0,""])},this.CreateJSMapper=function(){return Ie.$create("Create$2",[4096])},this.CreateJSWriter=function(e){return Re.$create("Create$1",[e])},this.CreateLog=function(){return ve.$create("Create$1")},this.CreateMacroEngine=function(){return n.$create("Create$1")},this.CreateSrcMap=function(e){return Ae.$create("Create$1",[e])},this.CreateOptimizer=function(){return B.$create("Create$1")},this.FormatPath=function(e){return this.FFS.FormatPath(e)},this.FullFormatPath=function(e){return z(this.FormatPath(e),'"')},this.WritePrecompiledFormats=function(){this.WriteHelpLine("   -JU: This pas2js does not support PCU files")};this.WriteHelpLine=function(e){var t=0,s=0,i=0,r=0,n=0,l=0;function a(){t=e.length,i=s=1,r=0,l=0}if(e.length<=78)this.FLog.LogRaw(e);else{for(a();s<=t;){var o=e.charAt(s-1);o>="a"&&o<="z"||o>="A"&&o<="Z"||o>="0"&&o<="9"||"_"===o||"-"===o||"."===o||","===o||'"'===o||"'"===o||"`"===o||o>=""&&o<=""?(i=s,s<t&&e.charCodeAt(s-1)in rtl.createSet(null,56320,57343)?s+=2:s+=1):(i=s,r=s,s+=1),(l+=1)>=78&&((0===r||r<rtl.trunc(39))&&(r=i),n=r-1,this.FLog.LogRaw(P(e,n)),re({get:function(){return e},set:function(t){e=t}},1,n),e=Ne(" ",12)+xe(e),a())}this.FLog.LogRaw(e)}},this.LoadFile=function(e,t){var s=null;try{s=this.FFS.LoadFile(e,t)}catch(e){if(!d.isPrototypeOf(e))throw e;var i=e;this.FLog.Log(1,i.fMessage,0,"",0,0,!0),this.Terminate(4)}return s},this.HandleLinkLibStatement=function(e,t,s,i,r){var n=null,l=null,a=null,o=null,h=null,u=null,c="";r.set(!0),""!==i&&this.ParamFatal("[20210919141030] linklib options not supported"),(n=this.CreateImportStatement()).FNameSpaceImport=s,""===be(c=t)&&(c+=".js"),n.FModuleName=c,(h=Oe.$create("Create$1",[0,0,""])).FName="pas",(o=ke.$create("Create$1",[0,0,""])).FName="$libimports",o.FMExpr=h,(a=ke.$create("Create$1",[0,0,""])).FName=s,a.FMExpr=o,(u=Oe.$create("Create$1",[0,0,""])).FName=s,(l=$e.$create("Create$1",[0,0,""])).FLHS=a,l.FExpr=u,this.FImports.FStatements.AddNode(!1,!1).FNode=n,this.FImports.FStatements.AddNode(!1,!1).FNode=l},this.CreateCompilerFile=function(e,t){return u.$create("Create$2",[this,e,t])},this.HandleOptionPCUFormat=function(e){this.ParamFatal("No support in this compiler for precompiled format "+e)},this.HandleOptionPaths=function(e,t,s){var i="";var r=e;return"N"===r?this.AddNamespaces(t,s):"r"===r?this.FLog.Log(3,"-Fr not yet implemented",0,"",0,0,!0):"e"===r?this.FLog.SetOutputFilename(t):""!==(i=this.FFS.HandleOptionPaths(e,t,s))&&this.ParamFatal(i),true},this.HandleOptionJ=function(e,t,s,i){var r=!1,n="",l="",a="",o=0,h=!1,u=0;r=!0;var c=e;if("c"===c)""===t?this.SetAllJSIntoMainJS(!0):"-"===t?this.SetAllJSIntoMainJS(!1):this.ParamFatal('invalid value (-Jc) "'+t+'"');else if("e"===c){n=De(t);"utf8"===n||"json"===n?this.FLog.FEncoding!==n&&(this.FLog.SetEncoding(n),this.FHasShownEncoding&&(this.FHasShownEncoding=!1,this.WriteEncoding())):this.ParamFatal('invalid encoding (-Je) "'+t+'"')}else if("a"===c||"i"===c)""===t?"a"===e?this.ParamFatal('missing append file "'+t+'"'):this.ParamFatal('missing insertion file "'+t+'"'):s||(""===t?r=!1:"-"===t.charAt(t.length-1)?(re({get:function(){return t},set:function(e){t=e}},t.length,1),""===t?r=!1:"i"===e?this.RemoveInsertJSFilename(t):this.RemoveAppendJSFilename(t)):"i"===e?this.AddInsertJSFilename(t):this.AddAppendJSFilename(t));else if("l"===c)this.SetOption(21,"-"!==t);else if("m"===c)if(""===t)this.SetSrcMapEnable(!0);else if("-"===t.charAt(0))"-"!==t?r=!1:this.SetSrcMapEnable(!1);else{var p=t;if("include"===p)this.SetSrcMapInclude(!0);else if("include-"===p)this.SetSrcMapInclude(!1);else if("absolute"===p)this.SetSrcMapFilenamesAbsolute(!0);else if("absolute-"===p)this.SetSrcMapFilenamesAbsolute(!1);else if("xssiheader"===p)this.SetSrcMapXSSIHeader(!0);else if("xssiheader-"===p)this.SetSrcMapXSSIHeader(!1);else if((o=Ce("=",t))<1)this.ParamFatal('unknown -Jm parameter "'+t+'"');else{n=P(t,o-1),re({get:function(){return t},set:function(e){t=e}},1,o);var f=n;"sourceroot"===f?this.FSrcMapSourceRoot=t:"basedir"===f?this.SetSrcMapBaseDir(t):this.ParamFatal('unknown -Jm parameter "'+n+'"')}this.SetSrcMapEnable(!0)}else if("o"===c)if(n=t,""===t&&this.ParamFatal("missing value of -Jo option"),Se(P(n,4),"rtl-")){for(o=5;o<=n.length&&n.charCodeAt(o-1)in rtl.createSet(null,97,122,null,65,90,null,48,57,95);)o+=1;(o>n.length||"="!==n.charAt(o-1))&&this.ParamFatal("expected -Jortl-name=value"),a="pbi"+E(n,5,o-5),n=E(n,o+1,255),u=rtl.valEnum(a,Le,function(e){o=e}),0!==o&&this.ParamFatal('unknown rtl identifier "'+a+'"'),Be(this.FConverterGlobals.BuiltInNames[u],!1)&&!Be(n,!1)&&this.ParamFatal("JavaScript identifier expected"),s||(this.FConverterGlobals.BuiltInNames[u]=n)}else{h=!0,(e=n.charAt(n.length-1)).charCodeAt()in rtl.createSet(43,45)&&(h="+"===e,re({get:function(){return n},set:function(e){n=e}},n.length,1));var d=te(n);"searchlikefpc"===d?this.FFS.SetOptionFromIndex(2,h):"usestrict"===d?this.SetOption(22,h):"checkversion=main"===d?this.FRTLVersionCheck=1:"checkversion=system"===d?this.FRTLVersionCheck=2:"checkversion=unit"===d?this.FRTLVersionCheck=3:r=!1}else"p"===c?(null==this.FPostProcessorSupport&&this.ParamFatal("-Jp: No postprocessor support available"),(r="cmd"===E(t,1,3))&&(re({get:function(){return t},set:function(e){t=e}},1,3),s||this.FPostProcessorSupport.AddPostProcessor(t))):"r"===c?(n=t,""===t?this.ParamFatal("missing value for -Jr option"):"none"===n?this.FResourceStringFile=0:"unit"===n?this.FResourceStringFile=1:"program"===n?this.FResourceStringFile=2:this.ParamFatal('invalid resource string file format (-Jr) "'+t+'"')):"R"===c?(0===(o=Ce("=",t))&&(o=t.length+1),""===(n=E(t,1,o-1))?this.ParamFatal("missing value for -JR option"):"none"===n?this.FResourceMode=1:"js"===n?this.FResourceMode=3:"html"===n&&(this.FResourceMode=2,n=E(t,o+1,t.length-o),this.FResourceOutputFile=n,""!==this.FResourceOutputFile&&""===be(this.FResourceOutputFile)&&(this.FResourceOutputFile=this.FResourceOutputFile+".html"))):"u"===c?s||""!==(l=this.FFS.AddForeignUnitPath(t,i))&&this.ParamFatal('invalid foreign unit path (-Ju) "'+l+'"'):"U"===c?this.HandleOptionPCUFormat(t):r=!1;return r},this.HandleOptionM=function(e,t){var s,i=!1,r=0;if(s=!0,""===e&&this.ParamFatal('invalid syntax mode (-M<x>) "'+e+'"'),t)return s;var n=te(e);if("delphi"===n)this.SetMode(1);else if("objfpc"===n)this.SetMode(0);else{"-"===e.charAt(e.length-1)?(e=P(e,e.length-1),i=!0):i=!1;for(var l=0;l<=56;l++)if((r=l)in p.msAllPas2jsModeSwitches&&Se(c.SModeSwitchNames[r],e)){if(r in this.FModeSwitches!==i)return s;if(!(r in p.msAllPas2jsModeSwitchesReadOnly))return i?this.SetModeSwitches(rtl.diffSet(this.FModeSwitches,rtl.createSet(r))):this.SetModeSwitches(rtl.unionSet(this.FModeSwitches,rtl.createSet(r))),s;this.ParamFatal('modeswitch is read only -M"'+e+'"')}this.ParamFatal('invalid syntax mode (-M) "'+e+'"')}return s},this.HandleOptionConfigFile=function(e,t){var s;""===t&&this.ParamFatal("invalid config file at param position "+pe(e)),s=this.ExpandFileName(t),this.FFS.FileExists(s)||this.ParamFatal('config file not found: "'+t+'"'),this.LoadConfig(s)},this.HandleOptionInfo=function(e){var t="";function i(e){""!==t&&(t+=" "),t+=e}var r,n=0,l="\0",a="\0",o=0,h=0,u="",f=0,d=0;if(t="",""===e)return this.WriteInfo(),void this.Terminate(0);for(n=1,r=e.length;n<=r;){var F=l=e.charAt(n-1);if("D"===F)i(s.GetCompiledDate());else if("V"===F)i(this.$class.GetVersion(!0));else if("W"===F)i(this.$class.GetVersion(!1));else if("S"===F){(n+=1)>r&&this.ParamFatal('missing info option after S in "'+e+'".');var m=a=e.charAt(n-1);"O"===m?i(s.GetCompiledTargetOS()):"P"===m?i(s.GetCompiledTargetCPU()):this.ParamFatal('unknown info option S"'+a+'" in "'+e+'".')}else if("T"===F){(n+=1)>r&&this.ParamFatal('missing info option after T in "'+e+'".');var C=a=e.charAt(n-1);"O"===C?i(p.PasToJsPlatformNames[this.GetTargetPlatform()]):"P"===C?i(p.PasToJsProcessorNames[this.GetTargetProcessor()]):this.ParamFatal('unknown info option S"'+a+'" in "'+e+'".')}else if("c"===F)for(var S=0;S<=1;S++)o=S,this.FLog.LogPlain(p.PasToJsProcessorNames[o]);else if("m"===F)for(d in rtl.diffSet(p.msAllPas2jsModeSwitches,c.AllLanguageModes))this.FLog.LogPlain(c.SModeSwitchNames[d]);else if("o"===F)this.FLog.LogPlain("EnumNumbers"),this.FLog.LogPlain("RemoveNotUsedPrivates"),this.FLog.LogPlain("RemoveNotUsedDeclarations"),this.FLog.LogPlain("ShortRefGlobals");else if("t"===F)for(var T=0;T<=3;T++)h=T,this.FLog.LogPlain(p.PasToJsPlatformNames[h]);else if("J"===F){this.FLog.LogPlain("-JoRTL-<x> identifiers:");for(var y=0;y<=188;y++)u=Le[f=y],re({get:function(){return u},set:function(e){u=e}},1,3),this.FLog.LogPlain("-JoRTL-"+u+"="+p.Pas2JSBuiltInNames[f])}else this.ParamFatal('unknown info option "'+l+'" in "'+e+'".');n+=1}""!==t&&this.FLog.LogPlain(t)},this.HandleOptionOptimization=function(e,t){var i=!1,r=!1;i=!0;var n=e;if("-"===n)this.SetOptions(rtl.unionSet(rtl.diffSet(this.FOptions,s.coAllOptimizations),s.coO0));else if("1"===n)this.SetOptions(rtl.unionSet(rtl.diffSet(this.FOptions,s.coAllOptimizations),s.coO1));else if("2"===n)this.SetOptions(rtl.unionSet(rtl.diffSet(this.FOptions,s.coAllOptimizations),s.coO2));else if("o"===n){""===t&&this.ParamFatal("missing -Oo option"),r=!0,(e=t.charAt(t.length-1)).charCodeAt()in rtl.createSet(43,45)?(r="+"===e,re({get:function(){return t},set:function(e){t=e}},t.length,1)):"no"===te(P(t,2))&&(r=!1,re({get:function(){return t},set:function(e){t=e}},1,2));var l=te(t);"enumnumbers"===l?this.SetOption(26,r):"removenotusedprivates"===l?this.SetOption(27,!r):"removenotuseddeclarations"===l?this.SetOption(28,!r):"shortrefglobals"===l?this.SetOption(29,r):"obfuscatelocalidentifiers"===l?this.SetOption(30,r):this.FLog.LogMsgIgnoreFilter(146,J(18,z(t,'"')))}else i=!1;return i},this.DoWriteJSFile=function(e,t,s){return false},this.Compile=function(e){var t=null,s=null,i=0,r=0,n=!1;null!==this.FMainFile&&this.RaiseInternalError(20170504192137,""),t=null,s=null,i=0,Me(this.FPrecompileGUID),n=!1;try{if(this.LoadModuleFile(this.FMainSrcFile,"",{p:this,get:function(){return this.p.FMainFile},set:function(e){this.p.FMainFile=e}},!1),null===this.FMainFile)return;this.FMainFile.ReadUnit(),this.ProcessQueue(),_.isPrototypeOf(this.FMainFile.FPasModule)&&this.OptimizeProgram(this.FMainFile),t=this.CreateSetOfCompilerFiles(0),this.MarkNeedBuilding(this.FMainFile,t,{get:function(){return i},set:function(e){i=e}}),i=t.Count(),S({get:function(){return t},set:function(e){t=e}}),t=this.CreateSetOfCompilerFiles(0),this.CreateJavaScript(this.FMainFile,t),S({get:function(){return t},set:function(e){t=e}}),t=this.CreateSetOfCompilerFiles(0),this.WriteJSFiles(this.FMainFile,null,t),S({get:function(){return t},set:function(e){t=e}}),0===this.GetExitCode()&&(r=86400*(Ge()-e),this.FLog.LogMsgIgnoreFilter(129,J(18,pe(this.FFS.FReadLineCounter),18,pe(i),18,we("0.0",r),9,"s")),n=!0)}finally{t=rtl.freeLoc(t),n||this.FLog.LogMsgIgnoreFilter(118,[]),s=rtl.freeLoc(s)}},this.ProcessQueue=function(){var e=0,t=null,s=!1,i=null;do{s=!1;for(var r=this.FReadingModules.FCount-1;r>=0;r--){if(e=r,3===(t=rtl.getObject(this.FReadingModules.Get(e))).ReaderState()){s=!0,t.ReadContinue(),3===t.ReaderState()&&this.RaiseInternalError(20180313130300,"File="+t.FUnitFilename+" ReadContinue buggy");break}t.IsUnitReadFromPCU()||null!==t.FParser.FCurModule||this.RaiseInternalError(20180306111410,"File="+t.FUnitFilename+" Parser.CurModule=nil")}}while(s);for(var n=0,l=this.FReadingModules.FCount-1;n<=l;n++)e=n,null===(t=rtl.getObject(this.FReadingModules.Get(e))).FPasResolver&&this.RaiseInternalError(20180313124125,t.FUnitFilename),t.IsUnitReadFromPCU()||null===t.FParser.FCurModule||this.RaiseInternalError(20180305185342,t.FUnitFilename),null===(i=t.FPasResolver.GetLastSection())&&this.RaiseInternalError(20180313124207,t.FUnitFilename),null!==i.PendingUsedIntf&&this.RaiseInternalError(20180313124226,t.FUnitFilename+" "+Ve(i)+" PendingUsedIntf="+Ve(i.PendingUsedIntf))},this.MarkNeedBuilding=function(e,t,s){var i=this;function r(t,r){e.FNeedBuild||(e.FNeedBuild=!0,s.set(s.get()+1),(i.GetShowDebug()||i.GetShowTriedUsedFiles())&&i.FLog.LogMsg(t,r,"",0,0,!1))}function n(n){var l=0,a=null,o=null;if(0!==rtl.length(n))for(var h=0,c=rtl.length(n)-1;h<=c;h++)l=h,o=rtl.as(n[l].Module,W),null===(a=u.GetFile(o))&&i.RaiseInternalError(20171214121631,o.FName),i.MarkNeedBuilding(a,t,s)&&(e.FNeedBuild||r(122,J(18,e.GetModuleName(),18,a.GetModuleName())))}return null!==t.FindItem(e)?e.FNeedBuild:(t.Add(e,!0),!(this.FAllJSIntoMainJS&&null!==this.FWPOAnalyzer&&!this.FWPOAnalyzer.IsUsed(e.FPasModule))&&(n(e.GetPasMainUsesClause()),n(e.GetPasImplUsesClause()),e.FNeedBuild||e.FIsForeign||(e.FIsMainFile?r(123,J(18,e.GetModuleName(),18,"<main source file>")):1 in this.FOptions?r(123,J(18,e.GetModuleName(),18,"-B")):this.FAllJSIntoMainJS?r(123,J(18,e.GetModuleName(),18,"-Jc")):""===e.FJSFilename||this.FFS.FileExists(e.FJSFilename)?""!==e.FJSFilename&&this.FFS.File1IsNewer(e.FUnitFilename,e.FJSFilename)&&r(125,J(18,e.GetModuleName(),18,this.FullFormatPath(e.FJSFilename))):r(124,J(18,e.GetModuleName(),18,this.FormatPath(e.FJSFilename)))),e.FNeedBuild&&e.FIsForeign&&(this.FLog.LogMsg(121,J(18,e.GetModuleName()),"",0,0,!0),this.Terminate(5)),e.FNeedBuild))},this.OptimizeProgram=function(e){this.FAllJSIntoMainJS&&(28 in this.FOptions||_.isPrototypeOf(e.FPasModule)&&(this.FWPOAnalyzer=this.CreateOptimizer(),this.FWPOAnalyzer.FResolver=e.FPasResolver,this.FWPOAnalyzer.SetOptions(rtl.unionSet(this.FWPOAnalyzer.FOptions,rtl.createSet(0))),this.FWPOAnalyzer.AnalyzeWholeProgram(e.FPasModule)))},this.CreateJavaScript=function(e,t){var s=this;function i(e){var i=0,r=null,n=null;if(0!==rtl.length(e))for(var l=0,a=rtl.length(e)-1;l<=a;l++)i=l,n=rtl.as(e[i].Module,W),null===(r=u.GetFile(n))&&s.RaiseInternalError(20171214121720,n.FName),s.CreateJavaScript(r,t)}null===e.FJSModule&&(t.ContainsItem(e)||(t.Add(e,!0),e.EmitModuleHints(),e.FNeedBuild&&(this.FLog.LogMsg(127,J(18,this.FullFormatPath(e.FUnitFilename)),"",0,0,!(8 in this.FOptions)),i(e.GetPasMainUsesClause()),i(e.GetPasImplUsesClause()),e.CreateJS())))},this.FinishSrcMap=function(e){var t="",i="",r="",n=null,l=0;r=""!==this.FSrcMapBaseDir?this.FSrcMapBaseDir:j(j(e.LocalFilename));for(var a=0,o=e.SourceCount()-1;a<=o;a++)l=a,""!==(t=e.GetSourceFiles(l))&&(this.GetSrcMapInclude()&&this.FFS.FileExists(t)&&(n=this.LoadFile(t,!1),e.SetSourceContents(l,n.FSource)),i=t,""===r||this.GetSrcMapFilenamesAbsolute()||this.FFS.TryCreateRelativePath(t,r,!0,!1,{get:function(){return i},set:function(e){i=e}})||(this.GetSrcMapInclude()||(this.FLog.Log(1,Z(s.sUnableToTranslatePathToDir,J(18,z(t,'"'),18,z(r,'"'))),133,"",0,0,!0),this.Terminate(7)),i=t),Ue(i)&&Se(this.FSrcMapSourceRoot,"file://")&&(i="file://"+i),"/"!==F.PathDelim&&(i=Je(i,F.PathDelim,"/",rtl.createSet(0))),t!==i&&e.SetSourceTranslatedFiles(l,i))},this.WriteSingleJSFile=function(e,t){var s=this;var i,r,n=null,l=!1,a=!1,o="",h="";n=t;try{(l=null===n)&&(n=this.CreateFileWriter(e,""),e.FIsMainFile&&!this.FAllJSIntoMainJS&&(this.InsertCustomJSFiles(n),3===this.FResources.$class.OutputMode()&&n.WriteFile(this.FResources.GetAsString(),this.GetResolvedMainJSFile()))),0!==this.FResourceStringFile&&this.AddUnitResourceStrings(e),this.FResources.DoneUnit(e.FIsMainFile),this.EmitJavaScript(e,n),(l||e.FIsMainFile)&&(e.FIsMainFile&&this.AppendCustomJSFiles(n),null!=this.FPostProcessorSupport&&this.FPostProcessorSupport.CallPostProcessors(e.FJSFilename,n),h=this.GetSrcMapEnable()?n.FDestFileName+".map":"",i=n.FDestFileName,""===(r=je(j(i)))||s.FFS.DirectoryExists(r)||(s.FLog.LogMsg(115,J(18,s.FullFormatPath(r)),"",0,0,!0),s.Terminate(4)),s.FFS.DirectoryExists(i)&&(s.FLog.LogMsg(111,J(18,s.FullFormatPath(i)),"",0,0,!0),s.Terminate(5)),a=this.DoWriteJSFile(e.FJSFilename,h,n),""===e.FJSFilename&&"."===this.FMainJSFile&&function(e){try{s.FLog.LogRaw(e.GetAsString())}finally{}}(n),this.FLog.LogMsg(117,J(18,this.FullFormatPath(n.FDestFileName)),"",0,0,!(8 in this.FOptions)),a||this.WriteJSToFile(h,n),(1===this.FResourceStringFile||e.FIsMainFile&&0!==this.FResourceStringFile)&&this.FResourceStrings.GetStringsCount()>0&&this.WriteResourceStrings(ce(n.FDestFileName,".jrs")),e.FIsMainFile&&2===this.FResources.$class.OutputMode()&&this.FResources.GetResourceCount()>0&&(""===(o=this.FResourceOutputFile)&&(o=ce(n.FDestFileName,"-res"+this.FResources.$class.OutputFileExtension())),this.WriteResources(o)),null!==n.FSrcMap&&this.WriteSrcMap(h,n))}finally{l&&(n=rtl.freeLoc(n))}},this.WriteJSFiles=function(e,t,s){var i=this;function r(e,t){var r=0,n=null,l=null;if(0!==rtl.length(t))for(var a=0,o=rtl.length(t)-1;a<=o;a++)r=a,l=rtl.as(t[r].Module,W),null===(n=u.GetFile(l))&&i.RaiseInternalError(20171214121720,l.FName),i.WriteJSFiles(n,e,s)}var n=null;if(null!==e.FJSModule&&e.FNeedBuild&&!s.ContainsItem(e)){s.Add(e,!0),n=t,this.FAllJSIntoMainJS&&null===n&&(n=this.CreateFileWriter(e,this.GetResolvedMainJSFile()),this.InsertCustomJSFiles(n),this.GetTargetPlatform()in rtl.createSet(1,3)&&this.InsertImportSection(n),3===this.FResources.$class.OutputMode()&&n.WriteFile(this.FResources.GetAsString(),this.GetResolvedMainJSFile()));try{r(n,e.GetPasMainUsesClause()),r(n,e.GetPasImplUsesClause()),this.WriteSingleJSFile(e,n)}finally{n!==t&&(n=rtl.freeLoc(n))}}},this.InitParamMacros=function(){this.FParamMacros.AddValue("Pas2jsFullVersion","major.minor.release<extra>",this.$class.GetVersion(!1)),this.FParamMacros.AddValue("Pas2jsVersion","major.minor.release",this.$class.GetVersion(!0)),this.FParamMacros.AddFunction("CfgDir","Use within a config file. The directory of this config file",rtl.createCallback(this,"OnMacroCfgDir"),!1)},this.ClearDefines=function(){for(var e=0,t=null,s=0,i=this.FDefines.GetCount()-1;s<=i;s++)e=s,t=this.FDefines.GetObject(e),t=rtl.freeLoc(t);this.FDefines.Clear()},this.RaiseInternalError=function(e,t){throw this.FLog.LogPlain("["+pe(e)+"] "+t),d.$create("Create$1",[t])},this.HandleJSException=function(e,t,s){var i=null,r=null;rtl.isObject(t)?(i=t,rtl.isExt(i,Error)?(i.stack&&He(i.stack),this.FLog.Log(0,e+": "+i.message,0,"",0,0,!0)):rtl.isExt(i,m)?d.isPrototypeOf(i)?(r=i,this.FLog.Log(0,e+": ("+r.$classname+") "+r.fMessage,0,"",0,0,!0)):this.FLog.Log(0,e+": ("+i.$classname+")",0,"",0,0,!0):this.FLog.Log(0,e+": "+t,0,"",0,0,!0)):this.FLog.Log(0,e+": "+t,0,"",0,0,!0),s&&this.Terminate(1)},this.GetExitCode=function(){return rtl.exitcode},this.SetExitCode=function(e){rtl.exitcode=e},this.SetWorkingDir=function(e){},this.CreateResourceSupport=function(){S({p:this,get:function(){return this.p.FResources},set:function(e){this.p.FResources=e}});var e=this.FResourceMode;1===e?this.FResources=We.$create("Create$1",[this.FFS]):2===e?this.FResources=Ye.$create("Create$1",[this.FFS]):3===e&&(this.FResources=ze.$create("Create$1",[this.FFS]))},this.Create$1=function(){return this.FOptions=rtl.refSet(s.DefaultP2jsCompilerOptions),this.FConverterGlobals=_e.$create("Create$1",[this]),this.FResolverHub=Ke.$create("Create$1",[this]),this.FNamespaces=Fe.$create("Create$1"),this.FDefines=Fe.$create("Create$1"),this.FInsertFilenames=Fe.$create("Create$1"),this.FAppendFilenames=Fe.$create("Create$1"),this.FImports=this.CreateImportList(),this.FLog=this.CreateLog(),this.FLog.FOnFormatPath=rtl.createCallback(this,"FormatPath"),this.FParamMacros=this.CreateMacroEngine(),this.RegisterMessages(),this.SetFS(this.CreateFS()),this.FOwnsFS=!0,this.FFiles=this.CreateSetOfCompilerFiles(0),this.FUnits=this.CreateSetOfCompilerFiles(1),this.FResourceMode=t.rmHTML,this.FResourceStrings=Xe.$create("Create$1"),this.FReadingModules=L.$create("Create"),this.InitParamMacros(),this.Reset(),this},this.Destroy=function(){var e=this;function t(){S({p:e,get:function(){return this.p.FResources},set:function(e){this.p.FResources=e}}),S({p:e,get:function(){return this.p.FImports},set:function(e){this.p.FImports=e}}),S({p:e,get:function(){return this.p.FResourceStrings},set:function(e){this.p.FResourceStrings=e}}),S({p:e,get:function(){return this.p.FNamespaces},set:function(e){this.p.FNamespaces=e}}),S({p:e,get:function(){return this.p.FWPOAnalyzer},set:function(e){this.p.FWPOAnalyzer=e}}),S({p:e,get:function(){return this.p.FInsertFilenames},set:function(e){this.p.FInsertFilenames=e}}),S({p:e,get:function(){return this.p.FAppendFilenames},set:function(e){this.p.FAppendFilenames=e}}),e.FMainFile=null,S({p:e,get:function(){return this.p.FUnits},set:function(e){this.p.FUnits=e}}),S({p:e,get:function(){return this.p.FReadingModules},set:function(e){this.p.FReadingModules=e}}),e.FFiles.FreeItems(),S({p:e,get:function(){return this.p.FFiles},set:function(e){this.p.FFiles=e}}),S({p:e,get:function(){return this.p.FPostProcessorSupport},set:function(e){this.p.FPostProcessorSupport=e}}),S({p:e,get:function(){return this.p.FConfigSupport},set:function(e){this.p.FConfigSupport=e}}),e.SetConverterGlobals(null),S({p:e,get:function(){return this.p.FResolverHub},set:function(e){this.p.FResolverHub=e}}),e.ClearDefines(),S({p:e,get:function(){return this.p.FDefines},set:function(e){this.p.FDefines=e}}),e.FLog.FOnFormatPath=null,e.FOwnsFS?S({p:e,get:function(){return this.p.FFS},set:function(e){this.p.FFS=e}}):e.FFS=null,S({p:e,get:function(){return this.p.FParamMacros},set:function(e){this.p.FParamMacros=e}})}if(this.GetShowDebug())try{t()}catch(e){if(d.isPrototypeOf(e)){var s=e;this.FLog.LogExceptionBackTrace(s)}else this.HandleJSException("[20181031190818] TPas2jsCompiler.Destroy",e,!0)}else t();S({p:this,get:function(){return this.p.FLog},set:function(e){this.p.FLog=e}}),m.Destroy.call(this)},this.Reset=function(){this.SetExitCode(0),this.FResolverHub.Reset(),S({p:this,get:function(){return this.p.FWPOAnalyzer},set:function(e){this.p.FWPOAnalyzer=e}}),this.FPrecompileGUID.$assign(ie.$new()),this.FNamespaces.Clear(),this.FNamespacesFromCmdLine=0,this.FMainFile=null,this.FUnits.Clear(),this.FReadingModules.Clear(),this.FFiles.FreeItems(),this.FInsertFilenames.Clear(),this.FAppendFilenames.Clear(),null!=this.FPostProcessorSupport&&this.FPostProcessorSupport.Clear(),this.FCompilerExe="",this.FSrcMapBaseDir="",this.FMainSrcFile="",this.FOptions=rtl.refSet(s.DefaultP2jsCompilerOptions),this.FRTLVersionCheck=e.rvcNone,this.FModeSwitches=rtl.refSet(s.p2jsMode_SwitchSets[0]),this.FConverterGlobals.Reset(),this.FConverterGlobals.RTLVersion=30301,this.FConverterGlobals.TargetPlatform=0,this.FConverterGlobals.TargetProcessor=0,this.FMainJSFileIsResolved=!1,this.FLog.Reset(),this.FLog.FShowMsgTypes=rtl.refSet(this.GetShownMsgTypes()),this.ClearDefines(),this.FDefines.SetSorted(!0),this.AddDefine("PAS2JS"),this.AddDefine$1("PAS2JS_FULLVERSION",pe(30301)),this.AddDefinesForTargetPlatform(),this.AddDefinesForTargetProcessor(),this.AddDefine("FPC_HAS_FEATURE_CLASSES"),this.AddDefine("FPC_HAS_FEATURE_INIT"),this.AddDefine("FPC_HAS_FEATURE_DYNARRAYS"),this.AddDefine("FPC_HAS_FEATURE_EXCEPTIONS"),this.AddDefine("FPC_HAS_FEATURE_EXITCODE"),this.AddDefine("FPC_HAS_FEATURE_INITFINAL"),this.AddDefine("FPC_HAS_FEATURE_RTTI"),this.AddDefine("FPC_HAS_FEATURE_SUPPORT"),this.AddDefine("FPC_HAS_FEATURE_UNICODESTRINGS"),this.AddDefine("FPC_HAS_FEATURE_WIDESTRINGS"),this.AddDefine("FPC_HAS_TYPE_DOUBLE"),this.AddDefine("FPC_HAS_UNICODESTRING"),this.AddDefine("FPC_UNICODESTRINGS"),this.AddDefine("FPC_WIDESTRING_EQUAL_UNICODESTRING"),this.AddDefine("STR_CONCAT_PROCS"),this.AddDefine("UNICODE"),""!==this.FSubTarget&&(this.AddDefine$1("FPC_SUBTARGET",this.FSubTarget),this.AddDefine("FPC_SUBTARGET_"+Te(this.FSubTarget))),this.FHasShownLogo=!1,this.FHasShownEncoding=!1,this.FFS.Reset()},this.ParamFatal=function(e){""!==this.FCurParam&&(e="parameter "+this.FCurParam+": "+e),null!=this.FConfigSupport&&""!==this.FConfigSupport.FCurrentCfgFilename?this.FLog.Log(0,e,0,this.FConfigSupport.FCurrentCfgFilename,this.FConfigSupport.FCurrentCfgLineNumber,0,!0):this.FLog.LogPlain$1(J(18,"Fatal: ",18,e)),this.Terminate(2)},this.Run=function(e,t,s,i){var r,n=0;r=Ge(),i&&this.Reset(),this.GetFileCount()>0&&this.RaiseInternalError(20170504161340,"internal error: TPas2jsCompiler.Run FileCount>0");try{this.SetWorkingDir(t),this.SetCompilerExe(e);for(var a=0,o=s.GetCount()-1;a<=o;a++)n=a,this.ReadParam(s.Get(n),!0,!0);this.GetWriteDebugLog()&&this.FLog.OpenDebugLog(),this.GetShowLogo()&&this.WriteLogo(),null==this.FConfigSupport||this.GetSkipDefaultConfig()||this.FConfigSupport.LoadDefaultConfig(),null!=this.FConfigSupport&&""!==this.FSubTarget&&this.FConfigSupport.LoadSubTargetConfig(this.FSubTarget),this.ReadEnvironment();for(var h=0,u=s.GetCount()-1;h<=u;h++)n=h,this.ReadParam(s.Get(n),!1,!0);this.CreateResourceSupport(),this.GetShowLogo()&&this.WriteLogo(),this.GetShowDebug()&&(this.WriteOptions(),this.WriteDefines()),(this.GetShowDebug()||this.GetShowUsedTools())&&this.WriteUsedTools(),(this.GetShowDebug()||this.GetShowTriedUsedFiles())&&this.WriteFoldersAndSearchPaths(),""===this.FMainSrcFile&&this.ParamFatal("No source file name in command line"),this.FFS.FileExists(this.FMainSrcFile)||this.ParamFatal('Pascal file not found: "'+this.FMainSrcFile+'"'),this.Compile(r)}catch(e){if(!l.isPrototypeOf(e)){if(d.isPrototypeOf(e)){c=e;throw this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(c),this.FLog.Log(0,c.fMessage,0,"",0,0,!0),e}throw this.GetShowDebug()&&this.FLog.LogExceptionBackTrace(null),this.HandleJSException("[20181031190933] TPas2jsCompiler.Run",e,!1),e}var c=e}},this.Terminate=function(e){throw this.SetExitCode(e),null!==this.FLog&&this.FLog.Flush(),l.$create("Create$1",["TPas2jsCompiler.Terminate"])},this.GetVersion=function(e){var t="";return t=pe(3)+"."+pe(3)+"."+pe(1),e||(t+=s.VersionExtra),t},this.WriteHelp=function(){var e=this;function t(t){e.WriteHelpLine(t)}var i=0,r=null;this.WriteLogo(),this.FLog.LogLn(),""!==this.FCompilerExe?t("Usage: "+this.FCompilerExe+" <your.pas>"):t("Usage: pas2js <your.pas>"),this.FLog.LogLn(),t("Options:"),t("Put + after a boolean switch option to enable it, - to disable it"),t("  @<x>   : Read compiler options from file <x> in addition to the default "+s.DefaultConfigFile),t("  -B     : Rebuild all"),t("  -d<x>  : Defines the symbol <x>. Optional: -d<x>:=<value>"),t("  -i<x>  : Write information and halt. <x> is a combination of the following:"),t("    -iD  : Write compiler date"),t("    -iSO : Write compiler OS"),t("    -iSP : Write compiler host processor"),t("    -iTO : Write target platform"),t("    -iTP : Write target processor"),t("    -iV  : Write short compiler version"),t("    -iW  : Write full compiler version"),t("    -ic  : Write list of supported JS processors usable by -P<x>"),t("    -im  : Write list of supported modeswitches usable by -M<x>"),t("    -io  : Write list of supported optimizations usable by -Oo<x>"),t("    -it  : Write list of supported targets usable by -T<x>"),t("    -iJ  : Write list of supported JavaScript identifiers -JoRTL-<x>"),t("  -C<x>  : Code generation options. <x> is a combination of the following letters:"),t("    o    : Overflow checking of integer operations"),t("    r    : Range checking"),t("    R    : Object checks. Verify method calls and object type casts."),t("  -F...   Set file names and paths:"),t("   -Fe<x>: Redirect output to file <x>. UTF-8 encoded."),t("   -FE<x>: Set main output path to <x>"),t("   -Fi<x>: Add <x> to include paths"),t("   -FN<x>: add <x> to namespaces. Namespaces with trailing - are removed."),t('            Delphi calls this flag "unit scope names".'),t("   -Fu<x>: Add <x> to unit paths"),t("   -FU<x>: Set unit output path to <x>"),t("  -I<x>  : Add <x> to include paths, same as -Fi"),t("  -J...  Extra options of pas2js"),t("   -Ja<x>: Append JS file <x> to main JS file. E.g. -Jamap.js. Can be given multiple times. To remove a file name append a minus, e.g. -Jamap.js-."),t("   -Jc   : Write all JavaScript concatenated into the output file"),t("   -Je<x>: Encode messages as <x>."),t("     -Jeconsole: Console codepage. This is the default."),t("     -Jesystem : System codepage. On non Windows console and system are the same."),t("     -Jeutf-8  : Unicode UTF-8. Default when using -Fe."),t("     -JeJSON   : Output compiler messages as JSON. Logo etc are outputted as-is."),t("   -Ji<x>: Insert JS file <x> into main JS file. E.g. -Jirtl.js. Can be given multiple times. To remove a file name append a minus, e.g. -Jirtl.js-."),t("   -Jl   : lower case identifiers"),t("   -Jm   : generate source maps"),t('     -Jmsourceroot=<x>: use x as "sourceRoot", prefix URL for source file names.'),t("     -Jmbasedir=<x>: write source file names relative to directory x, default is map file folder."),t("     -Jminclude: include Pascal sources in source map."),t("     -Jmabsolute: store absolute filenames, not relative."),t("     -Jmxssiheader: start source map with XSSI protection )]}', default."),t("     -Jm-: disable generating source maps"),t("   -Jo<x>: Enable or disable extra option. The x is case insensitive:"),t("     -JoSearchLikeFPC: search source files like FPC, default: search case insensitive."),t('     -JoUseStrict: add "use strict" to modules, default.'),t("     -JoCheckVersion-: do not add rtl version check, default."),t("     -JoCheckVersion=main: insert rtl version check into main."),t("     -JoCheckVersion=system: insert rtl version check into system unit init."),t("     -JoCheckVersion=unit: insert rtl version check into every unit init."),t("     -JoRTL-<y>=<z>: set RTL identifier y to value z. See -iJ."),t("   -Jr<x> Control writing of resource string file"),t("     -Jrnone: Do not write resource string file"),t("     -Jrunit: Write resource string file per unit with all resource strings"),t("     -Jrprogram: Write resource string file per program with all used resource strings in program"),t("   -JR<x> Control writing of linked resources"),t("     -JRnone: Skip resource directives"),t("     -JRjs: Write resources in Javascript structure"),t("     -JRhtml[=filename] : Write resources as preload links in HTML file (default is projectfile-res.html)"),t("   -Jpcmd<command>: Run postprocessor. For each generated js execute command passing the js as stdin and read the new js from stdout. This option can be added multiple times to call several postprocessors in succession."),t("   -Ju<x>: Add <x> to foreign unit paths. Foreign units are not compiled."),this.WritePrecompiledFormats(),t("  -l     : Write logo"),t("  -M<x>  : Set language mode or enable/disable a modeswitch"),t("    -MDelphi: Delphi 7 compatibility mode"),t("    -MObjFPC: FPC's Object Pascal compatibility mode (default)"),t("    -M<x>  : enable or disable modeswitch, see option -im"),t("    Each mode (as listed above) enables its default set of modeswitches."),t("    Other modeswitches are disabled and need to be enabled one by another."),t("  -NS<x> : obsolete: add <x> to namespaces. Same as -FN<x>"),t("  -n     : Do not read the default config files"),t('  -o<x>  : Change main JavaScript file to <x>, "." means stdout'),t("  -O<x>  : Optimizations:"),t("    -O-  : Disable optimizations"),t("    -O1  : Level 1 optimizations (quick and debugger friendly)"),t("    -O2  : Level 2 optimizations (Level 1 + not debugger friendly)"),t("    -Oo<x>: Enable or disable optimization. The x is case insensitive:"),t("      -OoEnumNumbers[-]: write enum value as number instead of name. Default in -O1."),t("      -OoRemoveNotUsedPrivates[-]: Default is enabled"),t("      -OoRemoveNotUsedDeclarations[-]: Default enabled for programs with -Jc"),t("      -OoRemoveNotUsedPublished[-] : Default is disabled"),t("      -OoShortRefGlobals[-]: Insert JS local var for types, modules and static functions. Default enabled in -O2"),t("  -P<x>  : Set target processor. Case insensitive:"),t("    -Pecmascript5: default"),t("    -Pecmascript6"),t("  -S<x>  : Syntax options. <x> is a combination of the following letters:"),t("    2    : Same as -Mobjfpc (default)"),t("    a    : Turn on assertions"),t("    c    : Support operators like C (*=,+=,/= and -=)"),t("    d    : Same as -Mdelphi"),t("    j    : Allows typed constants to be writeable (default)"),t("    m    : Enables macro replacements"),t("  -SI<x>  : Set interface style to <x>"),t("    -SIcom  : COM, reference counted interface (default)"),t("    -SIcorba: CORBA interface"),t("  -t<x>  : Set subtarget (searches for pas2js-<subtarget>.cfg"),t("  -T<x>  : Set target platform"),t("    -Tbrowser: default"),t("    -Tnodejs : add pas.run(), includes -Jc"),t("    -Telectron: experimental"),t("    -Tmodule : add pas.run(), includes -Jc"),t("  -u<x>  : Undefines the symbol <x>"),t("  -v<x>  : Be verbose. <x> is a combination of the following letters:"),t("    e    : Show errors (default)"),t("    w    : Show warnings"),t("    n    : Show notes"),t("    h    : Show hints"),t("    i    : Show info"),t("    l    : Show line numbers, needs -vi"),t("    a    : Show everything"),t("    0    : Show nothing (except errors)"),t("    b    : Show file names with full path"),t("    c    : Show conditionals"),t("    t    : Show tried/used files"),t("    d    : Show debug notes and info, enables -vni"),t("    q    : Show message numbers"),t("    x    : Show used tools"),t("    v    : Write pas2jsdebug.log with lots of debugging info"),t("    z    : Write messages to stderr, -o. still uses stdout."),t("  -vm<x>,<y>: Do not show messages numbered <x> and <y>."),t("  -?     : Show this help"),t("  -h     : Show this help"),this.FLog.LogLn(),t("Environment variable PAS2JS_OPTS is parsed after default config and before command line parameters."),this.FLog.LogLn(),t("Macros: Format is $Name, $Name$ or $Name()");for(var n=0,l=this.FParamMacros.Count()-1;n<=l;n++)i=n,r=this.FParamMacros.GetMacros(i),this.FLog.LogRaw$1(J(18,"  $",18,r.Name,18,qe(r.CanHaveParams,"()",""),18,": ",18,r.Description))},this.WriteLogo=function(){this.FHasShownLogo||(this.FHasShownLogo=!0,this.WriteVersionLine(),this.FLog.LogPlain("Copyright (c) 2025 Free Pascal team."),7 in this.FOptions&&this.WriteEncoding())},this.WriteEncoding=function(){this.FHasShownEncoding||(this.FHasShownEncoding=!0,this.FLog.LogMsgIgnoreFilter(132,J(18,this.FLog.GetEncodingCaption())))},this.WriteVersionLine=function(){var e="";e="Pas2JS Compiler version "+this.$class.GetVersion(!1),e+=" [2025/12/7] for Browser ECMAScript5",this.FLog.LogPlain(e),7 in this.FOptions&&this.WriteEncoding()},this.WriteOptions=function(){var e=0,t=0,i=0;for(i in this.WriteEncoding(),this.FLog.LogMsgIgnoreFilter(130,J(18,p.PasToJsPlatformNames[this.GetTargetPlatform()])),this.FLog.LogMsgIgnoreFilter(131,J(18,p.PasToJsProcessorNames[this.GetTargetProcessor()])),p.msAllPas2jsModeSwitches){var r=i;2===r?i in this.FModeSwitches&&this.FLog.LogMsgIgnoreFilter(102,J(18,s.p2jscModeNames[0])):3===r?i in this.FModeSwitches&&this.FLog.LogMsgIgnoreFilter(102,J(18,s.p2jscModeNames[1])):this.FLog.LogMsgIgnoreFilter(103,J(18,c.SModeSwitchNames[i],18,qe(i in this.FModeSwitches,"on","off")))}this.FLog.LogMsgIgnoreFilter(137,J(18,w.InterfaceTypeNames[this.FInterfaceType]));for(var n=0;n<=34;n++)e=n,this.FLog.LogMsgIgnoreFilter(101,J(18,s.p2jscoCaption[e],18,qe(e in this.FOptions,"enabled","disabled")));for(var l=0;l<=3;l++)t=l,this.FLog.LogMsgIgnoreFilter(101,J(18,x.p2jsfcoCaption[t],18,qe(t in this.FFS.FOptions,"enabled","disabled")));this.GetSrcMapEnable()&&(this.FLog.LogMsgIgnoreFilter(134,J(18,z(this.FSrcMapSourceRoot,'"'))),this.FLog.LogMsgIgnoreFilter(135,J(18,z(this.FSrcMapBaseDir,'"'))))},this.WriteDefines=function(){for(var e=0,t="",s=null,i=0,r=0,n=this.FDefines.GetCount()-1;r<=n;r++)e=r,t=this.FDefines.Get(e),null!==(s=this.FDefines.GetObject(e))?this.FLog.Log(5,Z(rtl.getResStr(c,"SLogMacroXSetToY"),J(18,t,18,z(s.FValue,'"'))),1030,"",0,0,!1):this.FLog.Log(5,Z(rtl.getResStr(c,"SLogMacroDefined"),J(18,t)),1026,"",0,0,!1);for(var l=0;l<=188;l++)i=l,p.Pas2JSBuiltInNames[i]!==this.FConverterGlobals.BuiltInNames[i]&&(t=Le[i],t=E(t,4,255),this.FLog.LogMsgIgnoreFilter(144,J(18,z(t,'"'),18,z(p.Pas2JSBuiltInNames[i],'"'),18,z(this.FConverterGlobals.BuiltInNames[i],'"'))))},this.WriteUsedTools=function(){null!=this.FPostProcessorSupport&&this.FPostProcessorSupport.WriteUsedTools()},this.WriteFoldersAndSearchPaths=function(){var e=0;this.FLog.LogMsgIgnoreFilter(106,J(18,"Compiler exe",18,z(this.FCompilerExe,'"'))),this.FFS.WriteFoldersAndSearchPaths();for(var t=0,s=this.FNamespaces.GetCount()-1;t<=s;t++)e=t,this.FLog.LogMsgIgnoreFilter(104,J(18,"Unit scope",18,this.FNamespaces.Get(e)));this.FLog.LogMsgIgnoreFilter(106,J(18,"Output file",18,z(this.FMainJSFile,'"')))},this.WriteInfo=function(){var e=this,t="";function i(s){""!==s&&(""===t?t=Ne(" ",e.FLog.FIndent):t+=",",t.length+s.length>e.FLog.FLineLen&&(e.FLog.LogPlain(t),t=Ne(" ",e.FLog.FIndent)),t+=s)}function r(){""!==t&&(e.FLog.LogPlain(t),t="")}var n=0;for(n in this.WriteVersionLine(),this.FLog.LogLn(),this.FLog.LogPlain("Compiler date      : "+s.GetCompiledDate()),this.FLog.LogPlain("Compiler CPU target: "+s.GetCompiledTargetCPU()),this.FLog.LogLn(),this.FLog.LogPlain("Supported targets (targets marked with '{*}' are under development):"),this.FLog.LogPlain$1(J(18,"  ",18,p.PasToJsPlatformNames[0],18,": webbrowser")),this.FLog.LogPlain$1(J(18,"  ",18,p.PasToJsPlatformNames[1],18,": Node.js")),this.FLog.LogPlain$1(J(18,"  ",18,p.PasToJsPlatformNames[2],18,": Electron app")),this.FLog.LogLn(),this.FLog.LogPlain("Supported CPU instruction sets:"),this.FLog.LogPlain("  ECMAScript5, ECMAScript6"),this.FLog.LogLn(),this.FLog.LogPlain("Recognized compiler and RTL features:"),t="",i("INITFINAL"),i("RTTI"),i("CLASSES"),i("EXCEPTIONS"),i("EXITCODE"),i("WIDESTRINGS"),i("RANDOM"),i("DYNARRAYS"),i("COMMANDARGS"),i("RESOURCES"),i("UNICODESTRINGS"),r(),this.FLog.LogLn(),this.FLog.LogPlain("Recognized modeswitches:"),t="",rtl.diffSet(p.msAllPas2jsModeSwitches,c.AllLanguageModes))i(c.SModeSwitchNames[n]);r(),this.FLog.LogLn(),this.FLog.LogPlain("Supported Optimizations:"),this.FLog.LogPlain("  EnumNumbers"),this.FLog.LogPlain("  RemoveNotUsedPrivates"),this.FLog.LogPlain("  ShortRefGlobals"),this.FLog.LogLn(),this.FLog.LogPlain("Supported Whole Program Optimizations:"),this.FLog.LogPlain("  RemoveNotUsedDeclarations"),this.FLog.LogLn(),this.FLog.LogPlain("This program comes under the Library GNU General Public License"),this.FLog.LogPlain("For more information read COPYING.FPC, included in this distribution"),this.FLog.LogLn(),this.FLog.LogPlain("Please report bugs in our bug tracker on:"),this.FLog.LogPlain("                 http://bugs.freepascal.org"),this.FLog.LogLn(),this.FLog.LogPlain("More information may be found on our WWW pages (including directions"),this.FLog.LogPlain("for mailing lists useful for asking questions or discussing potential"),this.FLog.LogPlain("new features, etc.):"),this.FLog.LogPlain("                 http://www.freepascal.org")},this.GetShownMsgTypes=function(){var e={};return e=rtl.createSet(0),3 in this.FOptions&&(e=rtl.includeSet(e,1)),4 in this.FOptions&&(e=rtl.includeSet(e,2)),5 in this.FOptions&&(e=rtl.includeSet(e,3)),6 in this.FOptions&&(e=rtl.includeSet(e,4)),7 in this.FOptions&&(e=rtl.includeSet(e,5)),12 in this.FOptions&&(e=rtl.includeSet(e,6)),e},this.AddDefine=function(e){this.FDefines.IndexOf(e)>=0||this.FDefines.Add(e)},this.AddDefine$1=function(e,t){var s,i=null;(s=this.FDefines.IndexOf(e))<0?this.FDefines.AddObject(e,Qe.$create("Create$1",[e,t])):null===(i=this.FDefines.GetObject(s))?this.FDefines.PutObject(s,Qe.$create("Create$1",[e,t])):i.FValue=t},this.RemoveDefine=function(e){var t,s=null;-1!==(t=this.FDefines.IndexOf(e))&&(s=this.FDefines.GetObject(t),s=rtl.freeLoc(s),this.FDefines.Delete(t))},this.IsDefined=function(e){return this.FDefines.IndexOf(e)>=0},this.SetOption=function(e,t){t?this.SetOptions(rtl.unionSet(this.FOptions,rtl.createSet(e))):this.SetOptions(rtl.diffSet(this.FOptions,rtl.createSet(e)))},this.GetUnitInfo=function(e,t,s,i){var r=this,n=a.$new(),l="",o="",h=!1,u="",c="";function p(e){var t=null;return""===l&&(null!==(t=r.FindLoadedUnit(e))?""!==t.FPasFileName?(l=t.FPasFileName,o=e):null!=i&&""!==t.FPCUFilename&&""===u&&(u=t.FPCUFilename,c=e):""!==(l=r.FFS.FindUnitFileName(e,"",s,{get:function(){return h},set:function(e){h=e}}))&&(o=e)),null!=i&&""===u&&""===l&&""!==(u=i.FindPCU(e))&&(c=e),!(""===l||null!=i&&""===u)}var f="",d="",F=0;if(n.$assign(a.$new()),l="",h=!1,o="",u="",c="",""===t){if(this.CheckUnitAlias({get:function(){return e},set:function(t){e=t}}),!p(e)&&Ce(".",e)<1){for(var m=0,C=this.FNamespaces.GetCount()-1;m<=C&&(F=m,""===(f=this.FNamespaces.Get(F))||!p(f+"."+e));m++);if((""===l||""===u)&&""!==(d=this.GetDefaultNamespace())){for(F=this.FNamespaces.GetCount()-1;F>=0&&!Se(this.FNamespaces.Get(F),d);)F-=1;F<0&&p(d+"."+e)}}}else""!==(l=this.FFS.FindUnitFileName(e,t,s,{get:function(){return h},set:function(e){h=e}}))&&(o=V(t)),""===l&&null!=i&&""===u&&""!==(u=i.FindPCU(e))&&(c=e);return""===l&&""!==u?(n.FileName=u,n.UnitName=c,n.isPCU=!0,n.isForeign=!1):""!==l&&(n.FileName=l,n.UnitName=o,n.isPCU=!1,n.isForeign=h),n},this.CheckUnitAlias=function(e){e.get()},this.FindFileWithUnitFilename=function(e){return""===e?null:this.FFiles.FindKey(e)},this.LoadModuleFile=function(e,t,s,i){var r=null,n="";s.set(null),this.FLog.LogMsg(126,J(18,this.FormatPath(e)),"",0,0,!(8 in this.FOptions)),""!==(n=e)&&(n=this.ExpandFileName(n)),s.set(this.FindFileWithUnitFilename(n)),null===s.get()&&(""!==n&&this.FFS.FileExists(n)||(i?this.FLog.LogMsg(136,J(18,z(e,'"')),"",0,0,!0):this.FLog.LogMsg(110,J(18,z(e,'"')),"",0,0,!0),this.Terminate(4)),this.FFS.DirectoryExists(n)&&(this.FLog.LogMsg(111,J(18,z(e,'"')),"",0,0,!0),this.Terminate(4)),i?s.set(this.CreateCompilerFile("",n)):s.set(this.CreateCompilerFile(n,"")),""!==t&&(0===g(V(e),t)?s.get().FPasUnitName=t:s.get().FPasUnitName=V(e)),this.FFiles.Add(s.get(),!0),s.get().FShowDebug=this.GetShowDebug(),s.get().FIsMainFile&&(s.get().FJSFilename=this.GetResolvedMainJSFile()),r=s.get().FPasResolver,8 in this.FOptions&&(r.FScannerLogEvents=rtl.unionSet(r.FScannerLogEvents,rtl.createSet(1))),10 in this.FOptions&&(r.FScannerLogEvents=rtl.unionSet(r.FScannerLogEvents,rtl.createSet(2))),rtl.neSet(rtl.intersectSet(rtl.createSet(8,7,12),this.FOptions),{})&&(r.FPParserLogEvents=rtl.unionSet(r.FPParserLogEvents,rtl.createSet(0,1))),s.get().FResourceHandler=this.FResources,s.get().CreateScannerAndParser(this.FFS.CreateResolver()),s.get().FScanner.FOnLinkLib=rtl.createCallback(this,"HandleLinkLibStatement"),this.GetShowDebug()&&this.FLog.LogPlain$1(J(18,'Debug: Opening file "',18,e,18,'"...')),i?(s.get().FFileResolver.SetBaseDirectory(j(e)),s.get().FPCUSupport.CreatePCUReader()):s.get().OpenFile(e))},this.FindUnitJSFileName=function(e){return this.FAllJSIntoMainJS?this.GetResolvedMainJSFile():this.FFS.FindUnitJSFileName(e)},this.FindLoadedUnit=function(e){return y(e,!0,!1)?this.FUnits.FindKey(e):null},this.AddUsedUnit=function(e){var t;""===e.FPasUnitName&&this.RaiseInternalError(20170504161347,'missing PasUnitName "'+e.FUnitFilename+'"'),null!==(t=this.FindLoadedUnit(e.FPasUnitName))?t!==e&&this.RaiseInternalError(20170504161354,'duplicate unit "'+t.FPasUnitName+'" "'+e.FUnitFilename+'" "'+t.FUnitFilename+'"'):this.FUnits.Add(e,!0)},this.ExpandFileName=function(e){return this.FFS.ExpandFileName(e)}}),this.GetCompiledDate=function(){return"2025/12/7"},this.GetCompiledTargetOS=function(){return te("Browser")},this.GetCompiledTargetCPU=function(){return te("ECMAScript5")}}),rtl.module("pas2jswebcompiler",["System","Classes","SysUtils","Pas2JSFS","PasUseAnalyzer","Pas2jsCompiler","FPPJsSrcMap","webfilecache"],function(){"use strict";var e=this.$impl,t=pas.Pas2jsCompiler.TPas2jsCompiler,s=pas.PasUseAnalyzer.TPasAnalyzerKeySet,i=pas.Pas2JSFS.EPas2jsFS,r=pas.System.VarRecs,n=pas.webfilecache.TPas2jsWebFS,l=pas.SysUtils.LowerCase;rtl.createClass(this,"TPas2JSWebcompiler",t,function(){this.GetWebFS=function(){return this.FFS},this.DoWriteJSFile=function(e,t,s){var i;return i=s.FBuffer.join(""),this.GetWebFS().SetFileContent(e,i),true},this.CreateSetOfCompilerFiles=function(t){var n=null,l=t;if(0===l)n=s.$create("Create$1",[e.Pas2jsCompilerFile_FilenameToKeyName,e.PtrFilenameToKeyName]);else{if(1!==l)throw i.$create("CreateFmt",["Internal Unknown key type: %d",r(0,t)]);n=s.$create("Create$1",[e.Pas2jsCompilerFile_UnitnameToKeyName,e.PtrUnitnameToKeyName])}return n},this.CreateFS=function(){return n.$create("Create$1")}}),this.$implcode=function(){e.Pas2jsCompilerFile_FilenameToKeyName=function(e){return l(e.FPasFileName)},e.PtrUnitnameToKeyName=function(e){return l(e)},e.Pas2jsCompilerFile_UnitnameToKeyName=function(e){return l(e.FPasUnitName)},e.PtrFilenameToKeyName=function(e){return l(e)}}},["JS"]),rtl.module("Rtl.BrowserLoadHelper",["System","Classes","SysUtils","JS","Web"],function(){"use strict";var e=null,t=pas.Classes,s=t.TLoadHelper,i=t.SetLoadHelperClass;rtl.createClass(this,"TBrowserLoadHelper",s,function(){e=this}),this.$init=function(){i(e)}}),rtl.module("browserconsole",["System","JS","Web","Rtl.BrowserLoadHelper","SysUtils"],function(){"use strict";var e=this,t=e.$impl,s=pas.System.SetWriteCallBack,i=pas.SysUtils.StringReplace;this.BrowserLineBreak="\n",this.DefaultMaxConsoleLines=25,this.DefaultConsoleStyle=".pasconsole { "+this.BrowserLineBreak+"font-family: courier;"+this.BrowserLineBreak+"font-size: 14px;"+this.BrowserLineBreak+"background: #FFFFFF;"+this.BrowserLineBreak+"color: #000000;"+this.BrowserLineBreak+"display: block;"+this.BrowserLineBreak+"}",this.ConsoleElementID="",this.ConsoleStyle="",this.MaxConsoleLines=0,this.ConsoleLinesToBrowserLog=!1,this.ResetConsole=function(){if(null!==t.LinesParent){for(;null!==t.LinesParent.firstElementChild;)t.LinesParent.removeChild(t.LinesParent.firstElementChild);t.AppendLine()}},this.InitConsole=function(){if(null!==t.ConsoleElement){if("body"!==t.ConsoleElement.nodeName.toLowerCase())for(;null!==t.ConsoleElement.firstElementChild;)t.ConsoleElement.removeChild(t.ConsoleElement.firstElementChild);t.StyleElement=document.createElement("style"),t.StyleElement.innerText=e.ConsoleStyle,t.ConsoleElement.appendChild(t.StyleElement),t.LinesParent=document.createElement("div"),t.ConsoleElement.appendChild(t.LinesParent)}},this.HookConsole=function(){t.ConsoleElement=null,""!==e.ConsoleElementID&&(t.ConsoleElement=document.getElementById(e.ConsoleElementID)),null===t.ConsoleElement&&(t.ConsoleElement=document.body),null!==t.ConsoleElement&&(e.InitConsole(),e.ResetConsole(),s(t.WriteConsole))},e.$implcode=function(){t.LastLine=null,t.StyleElement=null,t.LinesParent=null,t.ConsoleElement=null,t.AppendLine=function(){var s=0,i=null;for(s=0,i=t.LinesParent.firstChild;null!=i;)s+=1,i=i.nextSibling;for(;s>e.MaxConsoleLines;)s-=1,t.LinesParent.removeChild(t.LinesParent.firstChild);t.LastLine=document.createElement("div"),t.LastLine.className="pasconsole",t.LinesParent.appendChild(t.LastLine)},t.EscapeString=function(e){var t="";return t=i(e,"<","&lt;",rtl.createSet(0)),t=i(t,">","&gt;",rtl.createSet(0)),t=i(t," ","&nbsp;",rtl.createSet(0)),t=i(t,"\r\n","<br>",rtl.createSet(0)),t=i(t,"\n","<br>",rtl.createSet(0)),t=i(t,"\r","<br>",rtl.createSet(0))},t.WriteConsole=function(s,i){var r="";r=t.LastLine.innerHTML,r+=t.EscapeString(""+s),t.LastLine.innerHTML=r,i&&(e.ConsoleLinesToBrowserLog&&window.console.log(t.LastLine.innerText),t.AppendLine())}},e.$init=function(){e.ConsoleLinesToBrowserLog=!0,e.ConsoleElementID="pasjsconsole",e.ConsoleStyle=e.DefaultConsoleStyle,e.MaxConsoleLines=25,e.HookConsole()}},[]),rtl.module("program",["System","Classes","SysUtils","Web","JS","Types","webfilecache","pas2jswebcompiler","browserconsole"],function(){"use strict";var e=this,t=null,s=pas.Classes,i=s.TComponent,r=pas.System,n=r.Pos,l=r.Copy,a=pas.SysUtils,o=a.StrToIntDef,h=s.TStringList,u=a.Exception,c=a.IntToStr,p=pas.pas2jswebcompiler.TPas2JSWebcompiler,f=pas.browserconsole,d=pas.JS;rtl.createClass(this,"TWebCompiler",i,function(){t=this,this.$init=function(){i.$init.call(this),this.BRun=null,this.MSource=null,this.MLog=null,this.RFrame=null,this.PResult=null,this.FCompiler=null,this.FKnownFiles=null},this.$final=function(){this.BRun=void 0,this.MSource=void 0,this.MLog=void 0,this.RFrame=void 0,this.PResult=void 0,this.FCompiler=void 0,this.FKnownFiles=void 0,i.$final.call(this)},this.DoLog=function(e,t){var s=0,i=0,a=0,h=0,u="",c="";this.MLog.value=this.MLog.value+r.sLineBreak+t,1===n("main.pp(",t)&&(s=n("(",t),i=n(",",t),a=n(")",t),s>0&&i>s&&a>i&&(u=l(t,s+1,i-s-1),h=o(u,0),u=l(t,a+2,t.length),c=1===n("Error:",u)||1===n("Fatal:",u)?"error":1===n("Warning:",u)?"warning":1===n("Hint:",u)||1===n("Note:",u)?"hint":"",h>0&&""!==c&&window.addMarker(h,c,t)))},this.LoadDefaults=function(){var e=this;window.fetch("files.json").then(function(e){return e.text()}).then(function(t){var s,i=0;s=JSON.parse(""+t);for(var r=0,n=rtl.length(s)-1;r<=n;r++)i=r,e.FKnownFiles.Add(s[i]);return e.FCompiler.GetWebFS().LoadFiles$1(s,rtl.createCallback(e,"OnUnitLoaded")),window.appReady(),null})},this.OnUnitLoaded=function(e,t,s){""!==s?this.MLog.value=this.MLog.value+r.sLineBreak+'Error Loading "'+t+'": '+s:window.fileLoaded&&window.fileLoaded(t)},this.RunClick=function(t){var s,i=this;var n=null,l=!1,a="";s=!1,this.MLog.value="",window.clearMarkers(),this.FCompiler.GetWebFS().SetFileContent("main.pp",this.MSource.value),n=h.$create("Create$1");try{n.Add("-Tbrowser"),n.Add("-Jc"),n.Add("-Jirtl.js"),n.Add("-O1"),n.Add("main.pp");try{this.FCompiler.Run("","",n,!0)}catch(e){if(!u.isPrototypeOf(e))throw e;var o=e;this.MLog.value=this.MLog.value+r.sLineBreak+"Exception during compile: "+o.fMessage}if(this.MLog.value=this.MLog.value+r.sLineBreak+"Exit Code: "+c(this.FCompiler.GetExitCode()),function(e){for(var t=null;null!==i.PResult.firstElementChild;)i.PResult.removeChild(i.PResult.firstElementChild);t=document.createElement("div"),e?(t.setAttribute("class","alert alert-success alert-dismissible fade show m-0"),t.innerHTML="<strong>Success!</strong> Program compiled and running.",window.showRunTab&&window.showRunTab()):(t.setAttribute("class","alert alert-danger alert-dismissible fade show m-0"),t.innerHTML="<strong>Failure</strong> Compilation failed. Check logs.",window.showCompilerTab&&window.showCompilerTab()),i.PResult.appendChild(t)}(l=0===this.FCompiler.GetExitCode()),l){if(""===(a=this.FCompiler.GetWebFS().GetFileContent("main.js")))return window.alert("No source available"),s;a=e.SHTMLHead+a+r.LineEnding+e.SHTMLTail,this.RFrame.setAttribute("srcdoc",a)}}finally{n=rtl.freeLoc(n)}return s},this.LinkElements=function(){this.BRun=document.getElementById("btn-run"),this.BRun.onclick=rtl.createSafeCallback(this,"RunClick"),this.MSource=document.getElementById("memo-program-src"),this.MLog=document.getElementById("memo-compiler-output"),this.RFrame=document.getElementById("runarea"),this.PResult=document.getElementById("compile-result")},this.Create$1=function(e){return i.Create$1.apply(this,arguments),this.FKnownFiles=h.$create("Create$1"),this.FKnownFiles.SetSorted(!0),this.FKnownFiles.FDuplicates=0,this.FCompiler=p.$create("Create$1"),this.FCompiler.FLog.FOnLog=rtl.createCallback(this,"DoLog"),this.FCompiler.GetWebFS().FLoadBaseURL="sources",f.ConsoleStyle="",window.webCompilerApp=this,this},this.Destroy=function(){rtl.free(this,"FKnownFiles"),i.Destroy.call(this)},this.Execute=function(){this.LinkElements(),this.LoadDefaults()},this.AddSourceFile=function(e,t){var s;return(s=this.FCompiler.GetWebFS().SetFileContent(e,t))&&this.FKnownFiles.IndexOf(e)<0&&this.FKnownFiles.Add(e),s},this.LoadSourceFile=function(e,t){var s=this;window.fetch(e).then(function(e){return e.text()}).then(function(e){return s.AddSourceFile(t,""+e),null}).catch(function(t){return s.MLog.value=s.MLog.value+r.sLineBreak+"Error loading "+e+": "+t,null})},this.GetFileContent=function(e){var t="";try{t=this.FCompiler.GetWebFS().GetFileContent(e)}catch(e){t=""}return t},this.GetFileList=function(){var e=[],t=0;e=rtl.arraySetLength(e,"",this.FKnownFiles.GetCount());for(var s=0,i=this.FKnownFiles.GetCount()-1;s<=i;s++)e[t=s]=this.FKnownFiles.Get(t);return e};var s=this.$rtti;s.addMethod("AddSourceFile",1,[["AFileName",rtl.string],["AContent",rtl.string]],4,rtl.boolean),s.addMethod("LoadSourceFile",0,[["AURL",rtl.string],["AFileName",rtl.string]],4),s.addMethod("GetFileContent",1,[["AFileName",rtl.string]],4,rtl.string),s.addMethod("GetFileList",1,[],4,d.$rtti.TJSStringDynArray)}),this.SHTMLHead="<HTML>"+r.LineEnding+"<head>"+r.LineEnding+'  <meta charset="UTF-8">'+r.LineEnding+"  <Title>Pas2JS web compiler Program output</Title>"+r.LineEnding+'  <script type="application/javascript">'+r.LineEnding,this.SHTMLTail="   <\/script>"+r.LineEnding+"  <style>"+r.LineEnding+"    :root { --bg-color: #ffffff; --text-color: #000000; --header-color: #0056b3; --border-color: #eee; }"+r.LineEnding+"    @media (prefers-color-scheme: dark) { :root { --bg-color: #282a36; --text-color: #f8f8f2; --header-color: #bd93f9; --border-color: #44475a; } }"+r.LineEnding+'    body { background-color: var(--bg-color); color: var(--text-color); font-family: "Segoe UI", sans-serif; margin: 0; padding: 0; }'+r.LineEnding+"    .console-container { padding: 10px; min-height: 100vh; box-sizing: border-box; }"+r.LineEnding+"    .log-header { font-size: 0.8rem; color: var(--header-color); margin-bottom: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px; font-weight: bold; text-transform: uppercase; }"+r.LineEnding+'    #pasjsconsole { font-family: "Consolas", "Monaco", monospace; white-space: pre-wrap; }'+r.LineEnding+'    .pasconsole { font-family: "Consolas", "Monaco", monospace; font-size: 14px; background: transparent; color: var(--text-color); display: block; line-height: 1.4; border-bottom: 1px solid var(--border-color); }'+r.LineEnding+"  </style>"+r.LineEnding+"</head>"+r.LineEnding+"<body>"+r.LineEnding+'  <div class="console-container">'+r.LineEnding+'    <div class="log-header">Program Output</div>'+r.LineEnding+'    <div id="pasjsconsole"></div>'+r.LineEnding+"  </div>"+r.LineEnding+"<script>"+r.LineEnding+"  rtl.run();"+r.LineEnding+"<\/script>"+r.LineEnding+"</body>"+r.LineEnding+"</HTML>",e.$main=function(){t.$create("Create$1",[null]).Execute()}});